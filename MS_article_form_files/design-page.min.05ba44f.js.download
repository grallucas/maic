!function(){var t,n,e,i,r,o={26261:function(t,n,e){"use strict";e.d(n,{Vw:function(){return h},cS:function(){return c},cl:function(){return g},gV:function(){return d},iH:function(){return v},n5:function(){return l},oe:function(){return f},z_:function(){return m}});var i=e(63061);function r(t,n){return t?t+"."+n:n}function o(t,n,e,o,s){void 0===s&&(s=4),o&&t.push((0,i.dt)("".concat(r(n,e)),o,s))}function s(t,n,e,o){"boolean"==typeof o&&t.push((0,i.UL)("".concat(r(n,e)),o))}function a(t,n,e,o){"number"==typeof o&&t.push((0,i.Kq)("".concat(r(n,e)),o))}var u=function(t){var n="Activity.Result",e=[];return a(e,n,"Code",t.code),o(e,n,"Type",t.type),a(e,n,"Tag",t.tag),s(e,n,"IsExpected",t.isExpected),e.push((0,i.dt)("zC.Activity.Result","Office.System.Result")),e},c={contractName:"Office.System.Activity",getFields:function(t){var n="Activity",e=[];return o(e,n,"CV",t.cV),a(e,n,"Duration",t.duration),a(e,n,"Count",t.count),a(e,n,"AggMode",t.aggMode),s(e,n,"Success",t.success),t.result&&e.push.apply(e,u(t.result)),e.push((0,i.dt)("zC.Activity",this.contractName)),e}},l={getFields:function(t){var n="User",e=[];return o(e,n,"PrimaryIdentityHash",t.primaryIdentityHash),o(e,n,"PrimaryIdentitySpace",t.primaryIdentitySpace),o(e,n,"TenantId",t.tenantId,1),o(e,n,"TenantGroup",t.tenantGroup,1),s(e,n,"IsAnonymous",t.isAnonymous),e}},f={getFields:function(t,n){var e=[];return o(e,t,"Name",n.name),o(e,t,"State",n.state),e}},h={getFields:function(t){var n="UserAction",e=[];return a(e,n,"Id",t.id),o(e,n,"Name",t.name),o(e,n,"CommandSurface",t.commandSurface),o(e,n,"ParentName",t.parentName),o(e,n,"TriggerMethod",t.triggerMethod),a(e,n,"TimeOffsetMs",t.timeOffsetMs),e}},d={getFields:function(t){var n="App",e=[];return o(e,n,"Name",t.name,1),o(e,n,"Platform",t.platform,1),o(e,n,"Version",t.version,1),e}},m={getFields:function(t){var n="Session",e=[];return o(e,n,"Id",t.id,1),o(e,n,"EcsETag",t.ecsETag,1),e}},v={getFields:function(t){var n=[];return n.push((0,i.dt)("Pillar",t.pillar)),n.push((0,i.dt)("Veto",t.veto)),n.push((0,i.UL)("IsIntentional",t.isIntentional)),n.push((0,i.UL)("IsInternal",t.isInternal)),n.push((0,i.UL)("AlertOnPillar",t.alertOnPillar)),n.push((0,i.UL)("IsSessionEndingError",t.isSessionEndingError)),s(n,void 0,"InStaging",t.inStaging),n}},g={getFields:function(t){var n=[];return o(n,"Release","AudienceGroup",t.audienceGroup,1),n}}},63061:function(t,n,e){"use strict";function i(t,n,e){return u(t,1,n,e)}function r(t,n,e){return u(t,2,n,e)}function o(t,n,e){return u(t,3,n,e)}function s(t,n,e){return u(t,0,n,e)}function a(t,n,e){return u(t,4,n,e)}function u(t,n,e,i){return{name:t,dataType:n,value:e,classification:i||4}}e.d(n,{Kq:function(){return r},UL:function(){return i},b_:function(){return o},dt:function(){return s},xq:function(){return a}})},92560:function(t,n,e){"use strict";e.d(n,{H:function(){return a},kr:function(){return o},uf:function(){return s}});var i,r=(i=[],{fireEvent:function(t){i.forEach((function(n){return n(t)}))},addListener:function(t){t&&i.push(t)}});function o(){return r}function s(t,n,e){r.fireEvent({level:t,category:n,message:e})}function a(t,n,e){s(0,t,(function(){var t=e instanceof Error?e.message:"";return"".concat(n,": ").concat(t)}))}},97517:function(t,n,e){"use strict";e.d(n,{Dw:function(){return p},vE:function(){return g}});var i=function(){return i=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t},i.apply(this,arguments)};Object.create;Object.create;var r=e(92560),o={};function s(t,n){"Office."===t.substring(0,7)&&"."!==t[t.length-1]?o[t]?(n.ariaTenantToken&&(o[t].ariaTenantToken=n.ariaTenantToken),n.dnmToken&&(o[t].dnmToken=n.dnmToken)):o[t]=n:(0,r.uf)(0,0,(function(){return"Namespace: ".concat(t)}))}function a(t,n){for(var e=t.length;e>0;){var i=t.substr(0,e);if(o[i]){var r=o[i];return n.ariaTenantToken=r.ariaTenantToken,n.dnmToken=r.dnmToken,!0}e=t.lastIndexOf(".",e-1)}return!1}var u=9007199254740991,c=-u,l=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,f=/^[a-zA-Z0-9_\.]{1,95}$/;function h(t){if(!function(t){if(!t||t.length>98)return!1;return l.test(t)}(t.eventName))throw new Error("Invalid eventName");var n=t.eventContract;if(n){if(n.name&&!d(n.name))throw new Error("Invalid eventContract");m(n.dataFields)}m(t.dataFields)}function d(t){return f.test(t)}function m(t){t&&t.forEach((function(t){if("string"!=typeof t.name||!d(t.name))throw new Error("Invalid dataField name");2===t.dataType&&function(t){if("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t<c||t>u)throw new Error("Invalid integer ".concat(JSON.stringify(t)))}(t.value)}))}var v=e(63061);function g(t){var n={eventName:t.eventName,eventFlags:t.eventFlags||{},telemetryProperties:t.telemetryProperties?i({},t.telemetryProperties):{},dataFields:t.dataFields?t.dataFields.slice():[],timestamp:t.timestamp||(new Date).getTime()};return t.eventContract&&(n.eventContract={name:t.eventContract.name,dataFields:t.eventContract.dataFields.slice()}),n}var p=function(){function t(t,n,e){var r,o,s;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=e||{},t&&(this.telemetrySinks=t.telemetrySinks,(r=this.persistentDataFields).push.apply(r,t.persistentDataFields),this.config=i(i({},t.getConfig()),this.config),(o=this.partAFields).push.apply(o,t.partAFields)),n&&(s=this.persistentDataFields).push.apply(s,n)}return t.prototype.addEventContentType=function(t,n){t.push((0,v.Kq)("EventContent.Type",n))},t.prototype.sendTelemetryEvent=function(t){var n=g(t),e=n.telemetryProperties;e.nexusTenantToken=-1;var i=e.ariaTenantToken;if(!i&&(!a(n.eventName,e)&&!i))return void(0,r.uf)(0,0,(function(){return"No tenant token: "+t.eventName}));this.sendTelemetryEventInternal(n,1)},t.prototype.sendCustomerContent=function(t){var n=g(t),e=n.telemetryProperties,i=e.customerContentVersion;return(!i||i>2)&&(e.customerContentVersion=2),e.ariaTenantToken=void 0,e.nexusTenantToken=void 0,e.dnmToken=void 0,this.addEventContentType(n.dataFields,2),this.sendTelemetryEventInternal(n,2)},t.prototype.sendDirectNumericEvent=function(t){var n=g(t),e=n.telemetryProperties;if(!e.dnmToken&&(!a(n.eventName,e)&&!e.dnmToken))return void(0,r.uf)(0,0,(function(){return"No dnm token: "+n.eventName}));this.addEventContentType(n.dataFields,1),this.sendTelemetryEventInternal(n,3)},t.prototype.sendTelemetryEventInternal=function(t,n){if(2===n||!t.telemetryProperties.customerContentVersion&&!t.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([t,n]):(0,r.uf)(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(t,n)}catch(t){return void(0,r.H)(0,"SendTelemetryEvent",t)}this.telemetrySinks.forEach((function(e){try{3===n||2===n?e.sendNonStandardEvent&&e.sendNonStandardEvent(t,n):e.sendTelemetryEvent(t)}catch(t){}}))}else(0,r.uf)(0,0,(function(){return"Customer content"}))},t.prototype.processTelemetryEvent=function(t,n){var e,i,r;if(t.dataFields&&(null===(r=t.dataFields)||void 0===r||r.unshift((0,v.dt)("OTelJS.Version","4.13.14")),3!==n&&this.persistentDataFields&&(e=t.dataFields).unshift.apply(e,this.persistentDataFields)),this.partAFields.length>0){var o=t.eventContract||{name:"",dataFields:[]};(i=o.dataFields).push.apply(i,this.partAFields),t.eventContract=o}this.config.disableValidation||h(t)},t.prototype.addSink=function(t){this.telemetrySinks.push(t),this.flushQueue()},t.prototype.flushQueue=function(){var t=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var n=0,e=t;n<e.length;n++){var i=e[n],r=i[0],o=i[1];this.sendTelemetryEventInternal(r,o)}},t.prototype.setTenantToken=function(t,n,e){s(t,{ariaTenantToken:n,nexusTenantToken:e})},t.prototype.setDNMToken=function(t,n){s(t,{dnmToken:n})},t.prototype.cloneEvent=function(t){return g(t)},t.prototype.getConfig=function(){return this.config},t}()},56117:function(){function t(t){return $.expr.filters.visible(t)&&!$(t).parents().addBack().filter((function(){return"hidden"===$.css(this,"visibility")})).length}$.extend($.expr[":"],{focusable:function(n){
/*!
 * jQuery UI Core @VERSION
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */
return function(n,e){var i,r,o,s=n.nodeName.toLowerCase();return"area"===s?(r=(i=n.parentNode).name,!(!n.href||!r||"map"!==i.nodeName.toLowerCase())&&!!(o=$("img[usemap=#"+r+"]")[0])&&t(o)):(/input|select|textarea|button|object/.test(s)?!n.disabled:"a"===s&&n.href||e)&&t(n)}(n,!isNaN($.attr(n,"tabindex")))}})},31699:function(t){
/*! @license DOMPurify | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.2.2/LICENSE */
t.exports=function(){"use strict";function t(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}var n=Object.hasOwnProperty,e=Object.setPrototypeOf,i=Object.isFrozen,r=Object.freeze,o=Object.seal,s=Object.create,a="undefined"!=typeof Reflect&&Reflect,u=a.apply,c=a.construct;u||(u=function(t,n,e){return t.apply(n,e)}),r||(r=function(t){return t}),o||(o=function(t){return t}),c||(c=function(n,e){return new(Function.prototype.bind.apply(n,[null].concat(t(e))))});var l=w(Array.prototype.forEach),f=w(Array.prototype.pop),h=w(Array.prototype.push),d=w(String.prototype.toLowerCase),m=w(String.prototype.match),v=w(String.prototype.replace),g=w(String.prototype.indexOf),p=w(String.prototype.trim),b=w(RegExp.prototype.test),y=S(TypeError);function w(t){return function(n){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return u(t,n,i)}}function S(t){return function(){for(var n=arguments.length,e=Array(n),i=0;i<n;i++)e[i]=arguments[i];return c(t,e)}}function N(t,n){e&&e(t,null);for(var r=n.length;r--;){var o=n[r];if("string"==typeof o){var s=d(o);s!==o&&(i(n)||(n[r]=s),o=s)}t[o]=!0}return t}function C(t){var e=s(null),i=void 0;for(i in t)u(n,t,[i])&&(e[i]=t[i]);return e}var I=r(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),T=r(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","audio","canvas","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","video","view","vkern"]),k=r(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),x=r(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),F=r(["#text"]),P=r(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns"]),D=r(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),M=r(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),L=r(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),R=o(/\{\{[\s\S]*|[\s\S]*\}\}/gm),A=o(/<%[\s\S]*|[\s\S]*%>/gm),E=o(/^data-[\-\w.\u00B7-\uFFFF]/),O=o(/^aria-[\-\w]+$/),_=o(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),B=o(/^(?:\w+script|data):/i),H=o(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function q(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}var V=function(){return"undefined"==typeof window?null:window},z=function(t,n){if("object"!==(void 0===t?"undefined":G(t))||"function"!=typeof t.createPolicy)return null;var e=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(e=n.currentScript.getAttribute(i));var r="dompurify"+(e?"#"+e:"");try{return t.createPolicy(r,{createHTML:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function Q(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V(),n=function(t){return Q(t)};if(n.version="2.2.3",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;var e=t.document,i=t.document,o=t.DocumentFragment,s=t.HTMLTemplateElement,a=t.Node,u=t.NodeFilter,c=t.NamedNodeMap,w=void 0===c?t.NamedNodeMap||t.MozNamedAttrMap:c,S=t.Text,U=t.Comment,$=t.DOMParser,j=t.trustedTypes;if("function"==typeof s){var W=i.createElement("template");W.content&&W.content.ownerDocument&&(i=W.content.ownerDocument)}var K=z(j,e),J=K&&Ft?K.createHTML(""):"",Z=i,X=Z.implementation,Y=Z.createNodeIterator,tt=Z.getElementsByTagName,nt=Z.createDocumentFragment,et=e.importNode,it={};try{it=C(i).documentMode?i.documentMode:{}}catch(t){}var rt={};n.isSupported=X&&void 0!==X.createHTMLDocument&&9!==it;var ot=R,st=A,at=E,ut=O,ct=B,lt=H,ft=_,ht=null,dt=N({},[].concat(q(I),q(T),q(k),q(x),q(F))),mt=null,vt=N({},[].concat(q(P),q(D),q(M),q(L))),gt=null,pt=null,bt=!0,yt=!0,wt=!1,St=!1,Nt=!1,Ct=!1,It=!1,Tt=!1,kt=!1,xt=!0,Ft=!1,Pt=!0,Dt=!0,Mt=!1,Lt={},Rt=N({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","plaintext","script","style","svg","template","thead","title","video","xmp"]),At=null,Et=N({},["audio","video","img","source","image","track"]),Ot=null,_t=N({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),Bt=null,Ht=i.createElement("form"),Gt=function(t){Bt&&Bt===t||(t&&"object"===(void 0===t?"undefined":G(t))||(t={}),t=C(t),ht="ALLOWED_TAGS"in t?N({},t.ALLOWED_TAGS):dt,mt="ALLOWED_ATTR"in t?N({},t.ALLOWED_ATTR):vt,Ot="ADD_URI_SAFE_ATTR"in t?N(C(_t),t.ADD_URI_SAFE_ATTR):_t,At="ADD_DATA_URI_TAGS"in t?N(C(Et),t.ADD_DATA_URI_TAGS):Et,gt="FORBID_TAGS"in t?N({},t.FORBID_TAGS):{},pt="FORBID_ATTR"in t?N({},t.FORBID_ATTR):{},Lt="USE_PROFILES"in t&&t.USE_PROFILES,bt=!1!==t.ALLOW_ARIA_ATTR,yt=!1!==t.ALLOW_DATA_ATTR,wt=t.ALLOW_UNKNOWN_PROTOCOLS||!1,St=t.SAFE_FOR_TEMPLATES||!1,Nt=t.WHOLE_DOCUMENT||!1,Tt=t.RETURN_DOM||!1,kt=t.RETURN_DOM_FRAGMENT||!1,xt=!1!==t.RETURN_DOM_IMPORT,Ft=t.RETURN_TRUSTED_TYPE||!1,It=t.FORCE_BODY||!1,Pt=!1!==t.SANITIZE_DOM,Dt=!1!==t.KEEP_CONTENT,Mt=t.IN_PLACE||!1,ft=t.ALLOWED_URI_REGEXP||ft,St&&(yt=!1),kt&&(Tt=!0),Lt&&(ht=N({},[].concat(q(F))),mt=[],!0===Lt.html&&(N(ht,I),N(mt,P)),!0===Lt.svg&&(N(ht,T),N(mt,D),N(mt,L)),!0===Lt.svgFilters&&(N(ht,k),N(mt,D),N(mt,L)),!0===Lt.mathMl&&(N(ht,x),N(mt,M),N(mt,L))),t.ADD_TAGS&&(ht===dt&&(ht=C(ht)),N(ht,t.ADD_TAGS)),t.ADD_ATTR&&(mt===vt&&(mt=C(mt)),N(mt,t.ADD_ATTR)),t.ADD_URI_SAFE_ATTR&&N(Ot,t.ADD_URI_SAFE_ATTR),Dt&&(ht["#text"]=!0),Nt&&N(ht,["html","head","body"]),ht.table&&(N(ht,["tbody"]),delete gt.tbody),r&&r(t),Bt=t)},qt=function(t){h(n.removed,{element:t});try{t.parentNode.removeChild(t)}catch(n){t.outerHTML=J}},Vt=function(t,e){try{h(n.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){h(n.removed,{attribute:null,from:e})}e.removeAttribute(t)},zt=function(t){var n=void 0,e=void 0;if(It)t="<remove></remove>"+t;else{var r=m(t,/^[\r\n\t ]+/);e=r&&r[0]}var o=K?K.createHTML(t):t;try{n=(new $).parseFromString(o,"text/html")}catch(t){}if(!n||!n.documentElement){var s=(n=X.createHTMLDocument("")).body;s.parentNode.removeChild(s.parentNode.firstElementChild),s.outerHTML=o}return t&&e&&n.body.insertBefore(i.createTextNode(e),n.body.childNodes[0]||null),tt.call(n,Nt?"html":"body")[0]},Qt=function(t){return Y.call(t.ownerDocument||t,t,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT,(function(){return u.FILTER_ACCEPT}),!1)},Ut=function(t){return!(t instanceof S||t instanceof U||"string"==typeof t.nodeName&&"string"==typeof t.textContent&&"function"==typeof t.removeChild&&t.attributes instanceof w&&"function"==typeof t.removeAttribute&&"function"==typeof t.setAttribute&&"string"==typeof t.namespaceURI)},$t=function(t){return"object"===(void 0===a?"undefined":G(a))?t instanceof a:t&&"object"===(void 0===t?"undefined":G(t))&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},jt=function(t,e,i){rt[t]&&l(rt[t],(function(t){t.call(n,e,i,Bt)}))},Wt=function(t){var e=void 0;if(jt("beforeSanitizeElements",t,null),Ut(t))return qt(t),!0;if(m(t.nodeName,/[\u0080-\uFFFF]/))return qt(t),!0;var i=d(t.nodeName);if(jt("uponSanitizeElement",t,{tagName:i,allowedTags:ht}),("svg"===i||"math"===i)&&0!==t.querySelectorAll("p, br, form, table, h1, h2, h3, h4, h5, h6").length)return qt(t),!0;if(!$t(t.firstElementChild)&&(!$t(t.content)||!$t(t.content.firstElementChild))&&b(/<[/\w]/g,t.innerHTML)&&b(/<[/\w]/g,t.textContent))return qt(t),!0;if(!ht[i]||gt[i]){if(Dt&&!Rt[i]&&"function"==typeof t.insertAdjacentHTML)try{var r=t.innerHTML;t.insertAdjacentHTML("AfterEnd",K?K.createHTML(r):r)}catch(t){}return qt(t),!0}return"noscript"!==i&&"noembed"!==i||!b(/<\/no(script|embed)/i,t.innerHTML)?(St&&3===t.nodeType&&(e=t.textContent,e=v(e,ot," "),e=v(e,st," "),t.textContent!==e&&(h(n.removed,{element:t.cloneNode()}),t.textContent=e)),jt("afterSanitizeElements",t,null),!1):(qt(t),!0)},Kt=function(t,n,e){if(Pt&&("id"===n||"name"===n)&&(e in i||e in Ht))return!1;if(yt&&b(at,n));else if(bt&&b(ut,n));else{if(!mt[n]||pt[n])return!1;if(Ot[n]);else if(b(ft,v(e,lt,"")));else if("src"!==n&&"xlink:href"!==n&&"href"!==n||"script"===t||0!==g(e,"data:")||!At[t])if(wt&&!b(ct,v(e,lt,"")));else if(e)return!1}return!0},Jt=function(t){var e=void 0,i=void 0,r=void 0,o=void 0;jt("beforeSanitizeAttributes",t,null);var s=t.attributes;if(s){var a={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:mt};for(o=s.length;o--;){var u=e=s[o],c=u.name,l=u.namespaceURI;if(i=p(e.value),r=d(c),a.attrName=r,a.attrValue=i,a.keepAttr=!0,a.forceKeepAttr=void 0,jt("uponSanitizeAttribute",t,a),i=a.attrValue,!a.forceKeepAttr&&(Vt(c,t),a.keepAttr))if(b(/\/>/i,i))Vt(c,t);else{St&&(i=v(i,ot," "),i=v(i,st," "));var h=t.nodeName.toLowerCase();if(Kt(h,r,i))try{l?t.setAttributeNS(l,c,i):t.setAttribute(c,i),f(n.removed)}catch(t){}}}jt("afterSanitizeAttributes",t,null)}},Zt=function t(n){var e=void 0,i=Qt(n);for(jt("beforeSanitizeShadowDOM",n,null);e=i.nextNode();)jt("uponSanitizeShadowNode",e,null),Wt(e)||(e.content instanceof o&&t(e.content),Jt(e));jt("afterSanitizeShadowDOM",n,null)};return n.sanitize=function(i,r){var s=void 0,u=void 0,c=void 0,l=void 0,f=void 0;if(i||(i="\x3c!--\x3e"),"string"!=typeof i&&!$t(i)){if("function"!=typeof i.toString)throw y("toString is not a function");if("string"!=typeof(i=i.toString()))throw y("dirty is not a string, aborting")}if(!n.isSupported){if("object"===G(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof i)return t.toStaticHTML(i);if($t(i))return t.toStaticHTML(i.outerHTML)}return i}if(Ct||Gt(r),n.removed=[],"string"==typeof i&&(Mt=!1),Mt);else if(i instanceof a)1===(u=(s=zt("\x3c!----\x3e")).ownerDocument.importNode(i,!0)).nodeType&&"BODY"===u.nodeName||"HTML"===u.nodeName?s=u:s.appendChild(u);else{if(!Tt&&!St&&!Nt&&-1===i.indexOf("<"))return K&&Ft?K.createHTML(i):i;if(!(s=zt(i)))return Tt?null:J}s&&It&&qt(s.firstChild);for(var h=Qt(Mt?i:s);c=h.nextNode();)3===c.nodeType&&c===l||Wt(c)||(c.content instanceof o&&Zt(c.content),Jt(c),l=c);if(l=null,Mt)return i;if(Tt){if(kt)for(f=nt.call(s.ownerDocument);s.firstChild;)f.appendChild(s.firstChild);else f=s;return xt&&(f=et.call(e,f,!0)),f}var d=Nt?s.outerHTML:s.innerHTML;return St&&(d=v(d,ot," "),d=v(d,st," ")),K&&Ft?K.createHTML(d):d},n.setConfig=function(t){Gt(t),Ct=!0},n.clearConfig=function(){Bt=null,Ct=!1},n.isValidAttribute=function(t,n,e){Bt||Gt({});var i=d(t),r=d(n);return Kt(i,r,e)},n.addHook=function(t,n){"function"==typeof n&&(rt[t]=rt[t]||[],h(rt[t],n))},n.removeHook=function(t){rt[t]&&f(rt[t])},n.removeHooks=function(t){rt[t]&&(rt[t]=[])},n.removeAllHooks=function(){rt={}},n}return Q()}()},93641:function(t,n,e){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */
t.exports=function(){"use strict";function t(t){var n=typeof t;return null!==t&&("object"===n||"function"===n)}function n(t){return"function"==typeof t}var i=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},r=0,o=void 0,s=void 0,a=function(t,n){w[r]=t,w[r+1]=n,2===(r+=2)&&(s?s(S):C())};function u(t){s=t}function c(t){a=t}var l="undefined"!=typeof window?window:void 0,f=l||{},h=f.MutationObserver||f.WebKitMutationObserver,d="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),m="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function v(){return function(){return process.nextTick(S)}}function g(){return void 0!==o?function(){o(S)}:y()}function p(){var t=0,n=new h(S),e=document.createTextNode("");return n.observe(e,{characterData:!0}),function(){e.data=t=++t%2}}function b(){var t=new MessageChannel;return t.port1.onmessage=S,function(){return t.port2.postMessage(0)}}function y(){var t=setTimeout;return function(){return t(S,1)}}var w=new Array(1e3);function S(){for(var t=0;t<r;t+=2)(0,w[t])(w[t+1]),w[t]=void 0,w[t+1]=void 0;r=0}function N(){try{var t=Function("return this")().require("vertx");return o=t.runOnLoop||t.runOnContext,g()}catch(t){return y()}}var C=void 0;function I(t,n){var e=this,i=new this.constructor(x);void 0===i[k]&&j(i);var r=e._state;if(r){var o=arguments[r-1];a((function(){return z(r,i,o,e._result)}))}else q(e,i,t,n);return i}function T(t){var n=this;if(t&&"object"==typeof t&&t.constructor===n)return t;var e=new n(x);return _(e,t),e}C=d?v():h?p():m?b():void 0===l?N():y();var k=Math.random().toString(36).substring(2);function x(){}var F=void 0,P=1,D=2;function M(){return new TypeError("You cannot resolve a promise with itself")}function L(){return new TypeError("A promises callback cannot return that same promise.")}function R(t,n,e,i){try{t.call(n,e,i)}catch(t){return t}}function A(t,n,e){a((function(t){var i=!1,r=R(e,n,(function(e){i||(i=!0,n!==e?_(t,e):H(t,e))}),(function(n){i||(i=!0,G(t,n))}),"Settle: "+(t._label||" unknown promise"));!i&&r&&(i=!0,G(t,r))}),t)}function E(t,n){n._state===P?H(t,n._result):n._state===D?G(t,n._result):q(n,void 0,(function(n){return _(t,n)}),(function(n){return G(t,n)}))}function O(t,e,i){e.constructor===t.constructor&&i===I&&e.constructor.resolve===T?E(t,e):void 0===i?H(t,e):n(i)?A(t,e,i):H(t,e)}function _(n,e){if(n===e)G(n,M());else if(t(e)){var i=void 0;try{i=e.then}catch(t){return void G(n,t)}O(n,e,i)}else H(n,e)}function B(t){t._onerror&&t._onerror(t._result),V(t)}function H(t,n){t._state===F&&(t._result=n,t._state=P,0!==t._subscribers.length&&a(V,t))}function G(t,n){t._state===F&&(t._state=D,t._result=n,a(B,t))}function q(t,n,e,i){var r=t._subscribers,o=r.length;t._onerror=null,r[o]=n,r[o+P]=e,r[o+D]=i,0===o&&t._state&&a(V,t)}function V(t){var n=t._subscribers,e=t._state;if(0!==n.length){for(var i=void 0,r=void 0,o=t._result,s=0;s<n.length;s+=3)i=n[s],r=n[s+e],i?z(e,i,r,o):r(o);t._subscribers.length=0}}function z(t,e,i,r){var o=n(i),s=void 0,a=void 0,u=!0;if(o){try{s=i(r)}catch(t){u=!1,a=t}if(e===s)return void G(e,L())}else s=r;e._state!==F||(o&&u?_(e,s):!1===u?G(e,a):t===P?H(e,s):t===D&&G(e,s))}function Q(t,n){try{n((function(n){_(t,n)}),(function(n){G(t,n)}))}catch(n){G(t,n)}}var U=0;function $(){return U++}function j(t){t[k]=U++,t._state=void 0,t._result=void 0,t._subscribers=[]}function W(){return new Error("Array Methods must be provided an Array")}var K=function(){function t(t,n){this._instanceConstructor=t,this.promise=new t(x),this.promise[k]||j(this.promise),i(n)?(this.length=n.length,this._remaining=n.length,this._result=new Array(this.length),0===this.length?H(this.promise,this._result):(this.length=this.length||0,this._enumerate(n),0===this._remaining&&H(this.promise,this._result))):G(this.promise,W())}return t.prototype._enumerate=function(t){for(var n=0;this._state===F&&n<t.length;n++)this._eachEntry(t[n],n)},t.prototype._eachEntry=function(t,n){var e=this._instanceConstructor,i=e.resolve;if(i===T){var r=void 0,o=void 0,s=!1;try{r=t.then}catch(t){s=!0,o=t}if(r===I&&t._state!==F)this._settledAt(t._state,n,t._result);else if("function"!=typeof r)this._remaining--,this._result[n]=t;else if(e===nt){var a=new e(x);s?G(a,o):O(a,t,r),this._willSettleAt(a,n)}else this._willSettleAt(new e((function(n){return n(t)})),n)}else this._willSettleAt(i(t),n)},t.prototype._settledAt=function(t,n,e){var i=this.promise;i._state===F&&(this._remaining--,t===D?G(i,e):this._result[n]=e),0===this._remaining&&H(i,this._result)},t.prototype._willSettleAt=function(t,n){var e=this;q(t,void 0,(function(t){return e._settledAt(P,n,t)}),(function(t){return e._settledAt(D,n,t)}))},t}();function J(t){return new K(this,t).promise}function Z(t){var n=this;return i(t)?new n((function(e,i){for(var r=t.length,o=0;o<r;o++)n.resolve(t[o]).then(e,i)})):new n((function(t,n){return n(new TypeError("You must pass an array to race."))}))}function X(t){var n=new this(x);return G(n,t),n}function Y(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function tt(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var nt=function(){function t(n){this[k]=$(),this._result=this._state=void 0,this._subscribers=[],x!==n&&("function"!=typeof n&&Y(),this instanceof t?Q(this,n):tt())}return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.finally=function(t){var e=this,i=e.constructor;return n(t)?e.then((function(n){return i.resolve(t()).then((function(){return n}))}),(function(n){return i.resolve(t()).then((function(){throw n}))})):e.then(t,t)},t}();function et(){var t=void 0;if(void 0!==e.g)t=e.g;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;if(n){var i=null;try{i=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===i&&!n.cast)return}t.Promise=nt}return nt.prototype.then=I,nt.all=J,nt.race=Z,nt.resolve=T,nt.reject=X,nt._setScheduler=u,nt._setAsap=c,nt._asap=a,nt.polyfill=et,nt.Promise=nt,nt}()},2926:function(t,n,e){var i,r,o;r=[],i=function(){"use strict";function n(t,n){return void 0===n?n={autoBom:!1}:"object"!=typeof n&&(console.warn("Deprecated: Expected third argument to be a object"),n={autoBom:!n}),n.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function i(t,n,e){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){a(i.response,n,e)},i.onerror=function(){console.error("could not download file")},i.send()}function r(t){var n=new XMLHttpRequest;n.open("HEAD",t,!1);try{n.send()}catch(t){}return 200<=n.status&&299>=n.status}function o(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(e){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(n)}}var s="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof e.g&&e.g.global===e.g?e.g:void 0,a=s.saveAs||("object"!=typeof window||window!==s?function(){}:"download"in HTMLAnchorElement.prototype?function(t,n,e){var a=s.URL||s.webkitURL,u=document.createElement("a");n=n||t.name||"download",u.download=n,u.rel="noopener","string"==typeof t?(u.href=t,u.origin===location.origin?o(u):r(u.href)?i(t,n,e):o(u,u.target="_blank")):(u.href=a.createObjectURL(t),setTimeout((function(){a.revokeObjectURL(u.href)}),4e4),setTimeout((function(){o(u)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,e,s){if(e=e||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(n(t,s),e);else if(r(t))i(t,e,s);else{var a=document.createElement("a");a.href=t,a.target="_blank",setTimeout((function(){o(a)}))}}:function(t,n,e,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof t)return i(t,n,e);var o="application/octet-stream"===t.type,a=/constructor/i.test(s.HTMLElement)||s.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||o&&a)&&"object"==typeof FileReader){var c=new FileReader;c.onloadend=function(){var t=c.result;t=u?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=t:location=t,r=null},c.readAsDataURL(t)}else{var l=s.URL||s.webkitURL,f=l.createObjectURL(t);r?r.location=f:location.href=f,r=null,setTimeout((function(){l.revokeObjectURL(f)}),4e4)}});s.saveAs=a.saveAs=a,t.exports=a},void 0===(o="function"==typeof i?i.apply(n,r):i)||(t.exports=o)},16586:function(t,n,e){"use strict";e.d(n,{Z9:function(){return o},ZL:function(){return s},wT:function(){return r}});var i=(0,e(4851).Rm)((function(){try{if(window.trustedTypes&&window.trustedTypes.createPolicy)return window.trustedTypes.createPolicy("formsTrustedTypePolicy",{createScriptURL:function(t){return t},createScript:function(t){return t},createHTML:function(t){return t}})}catch(t){return null}}));function r(t){var n=i();return n?n.createScriptURL(t):t}function o(t){var n=i();return n?n.createScript(t):t}function s(t){var n=i();return n?n.createHTML(t):t}},59749:function(t,n,e){"use strict";e.d(n,{M5:function(){return r},kM:function(){return s},uq:function(){return o}});var i=e(16586);function r(t,n){t.src=(0,i.wT)(n)}function o(t){return new Worker((0,i.wT)(t))}function s(t,n){t.innerHTML=(0,i.ZL)(n)}},69065:function(t,n,e){"use strict";e.d(n,{$W:function(){return f},Mk:function(){return d},Ym:function(){return r},ZR:function(){return o},en:function(){return s},f0:function(){return l},hq:function(){return u},je:function(){return c},sL:function(){return h},zn:function(){return m}});function i(t){var n=[t.R,t.G,t.B].map((function(t){return(t/=255)<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}));return.2126*n[0]+.7152*n[1]+.0722*n[2]}function r(t){return(i({R:255,G:255,B:255})+.05)/(i(t)+.05)>4.5}function o(t){for(var n=46;!r(t)&&n>=25;){var e=c(t);e.V=.01*n,t=l(e),n--}return t}function s(t){return r(t)?{R:255,G:255,B:255}:{R:0,G:0,B:0}}function a(t){var n=t.toString(16);return 1===n.length?"0".concat(n):n}function u(t){return"#".concat(a(t.R)).concat(a(t.G)).concat(a(t.B))}function c(t){var n,e=t.R,i=t.G,r=t.B,o=Math.max(e,i,r),s=Math.min(e,i,r),a=o-s,u=0===o?0:a/o,c=o/255;switch(o){case s:n=0;break;case e:n=i-r+a*(i<r?6:0),n/=6*a;break;case i:n=r-e+2*a,n/=6*a;break;case r:n=e-i+4*a,n/=6*a}return{H:n,S:u,V:c}}function l(t){var n,e,i,r,o,s,a,u,c=t.H,l=t.S,f=t.V;switch(s=f*(1-l),a=f*(1-(o=6*c-(r=Math.floor(6*c)))*l),u=f*(1-(1-o)*l),r%6){case 0:n=f,e=u,i=s;break;case 1:n=a,e=f,i=s;break;case 2:n=s,e=f,i=u;break;case 3:n=s,e=a,i=f;break;case 4:n=u,e=s,i=f;break;case 5:n=f,e=s,i=a}return{R:Math.round(255*n),G:Math.round(255*e),B:Math.round(255*i)}}function f(t){t.startsWith("#")&&(t=t.substring(1)),3===t.length&&(t=t.split("").map((function(t){return t+t})).join(""));var n=parseInt(t,16);return{R:n>>16&255,G:n>>8&255,B:255&n}}function h(t){var n=f(t),e=c(n);return i(n)>186&&(e.V=.45,n=l(e)),u(n)}function d(t){var n=c(f(t));return u(l({H:n.H,S:n.S,V:n.V>=.1?n.V-.1:0}))}function m(t){var n,e=c(f(t));return n=e.S>.05?.05:0,u(l({H:e.H,S:n,V:.95}))}},80820:function(t,n,e){"use strict";e.d(n,{B7:function(){return u},Ej:function(){return f},NF:function(){return o},QC:function(){return s},UF:function(){return h},d0:function(){return l},ft:function(){return d},lP:function(){return g},lz:function(){return c},mr:function(){return i},oc:function(){return v},pN:function(){return r},ps:function(){return a},tu:function(){return m}});var i="#242424",r="#616161",o="#bdbdbd",s="#e0e0e0",a="#f0f0f0",u="#03787c",c="#026d70",l="#014446",f="#fff",h="transparent",d="#000",m=u,v=l,g="#e8f2f4"},32782:function(t,n,e){"use strict";var i=e(87363),r=i.Suspense;n.Z=function(t){var n=t.children,e=t.fallback;return i.createElement(r,{fallback:e||null},n)}},37944:function(t,n,e){"use strict";e.d(n,{H:function(){return s}});var i=e(59312),r=e(87363),o=e(70069),s=r.forwardRef((function(t,n){var e=t.$as,s=void 0===e?"span":e,a=t.$html,u=(0,i._T)(t,["$as","$html"]),c=s;return r.createElement(c,(0,i.pi)({},u,{dangerouslySetInnerHTML:{__html:(0,o.s)({$text:a})},ref:n}))}))},13729:function(t,n,e){"use strict";e.d(n,{XJ:function(){return a},ls:function(){return c},nP:function(){return u}});var i=e(66676);function r(t){switch((t||(0,i.K)()||"").toLowerCase()){case"fr":case"fr-ca":case"fr-fr":case"fr-be":case"fr-lu":case"fr-ch":return!0;default:return!1}}function o(t){switch((t||(0,i.K)()||"").toLowerCase()){case"it":case"it-it":case"it-ch":return!0;default:return!1}}function s(t){switch((t||(0,i.K)()||"").toLowerCase()){case"ko":case"ko-kr":return!0;default:return!1}}function a(t){return r(t)||o(t)||s(t)}function u(t){return r(t)?"https://go.microsoft.com/fwlink/?linkid=2121428":o(t)?"https://go.microsoft.com/fwlink/?linkid=2121429":s(t)?"https://go.microsoft.com/fwlink/?LinkId=521839":null}function c(t){return r(t)?"Accessibilité":o(t)?"Accessibilità":s(t)?"개인정보처리방침 및 위치정보이용약관":null}},36476:function(t,n,e){"use strict";e.d(n,{$B:function(){return a},_k:function(){return s}});var i=e(94978),r=e(9947),o="/cdn";function s(){var t=(0,r.k0)();return"cdnEndpoint"in t?t.cdnEndpoint:(0,i.Gw)("CdnEndPoint")}function a(t){var n=s();return function(t,n,e){if(!t)return"";var i=t.toLowerCase();if(!n)return i;return(e||o)+i}(t,(0,r.k0)().isCdnEnabled,n)}},78587:function(t,n,e){"use strict";e.d(n,{Go:function(){return c},Jn:function(){return a},oE:function(){return u}});var i=e(9947),r=e(36476),o="/FormsPro",s={defaultFolder:{css:"/css/dist/",js:"/Scripts/dists/"},vendorsFolder:{css:"/css/",js:"/Scripts/"}};function a(t){return t?(0,i.k0)().isCdnEnabled?(0,r.$B)(t):(0,i.k0)().addPrefixForProWhenNoCdn?o+t:t:""}function u(t,n){if(!t)return"";var e=t.split(".").pop();if("js"!==e&&"css"!==e)return t;var a=function(t,n){return(/^vendors\//i.test(t)?s.vendorsFolder:s.defaultFolder)[n]}(t,e)+t,u=(0,i.k0)().hashMapping,c=(0,i.k0)().isCdnEnabled;if(c&&void 0!==u){var l=u[t.toLowerCase()];if(void 0!==l){var f=a.replace(new RegExp(e+"$"),"".concat(l,".").concat(e));return(0,r.$B)(f)}}var h=a+(n?"?v="+(0,i.k0)().version:""),d=(0,i.k0)().ring;return!c&&d&&(h="".concat(h).concat(n?"&":"?","ring=").concat(d)),(0,i.k0)().addPrefixForProWhenNoCdn?o+h:h}function c(t){return t?(0,i.k0)().isCdnEnabled?(0,r.$B)(t.replace(/\/intl\//i,"/intl_cdn/")):(0,i.k0)().addPrefixForProWhenNoCdn?o+t:t:""}},86353:function(t,n,e){"use strict";e.d(n,{$K:function(){return m},DP:function(){return h},Tl:function(){return d}});var i,r,o=e(59312),s=e(9947),a=e(90710),u=e(60211),c={settings:"",configIds:"",etag:""},l=!1;function f(){if(!l){var t="Unknown",n=(0,u.yv)()?0:2,e={IntelligenceExp1:t,IntelligencePollContentExp:t,IntelligencePollEngageExp:t,IntelligencePollIntentExp:t,IntelligencePollResponseViewExp:t,IntelligencePollChoiceResultViewExp:t,IntelligenceAutoExpandSuggestQuestions:n,SurveyContentIteration:t,ThemeRanker:0,SmartConvertMVP2:n,TimedForm:0,TeamsPollCreateNewExp:0,SdxDataSyncExp:0,ThanyouPageV2:0,LeaveSiteDialog:0,FormsAssistantMVP1:0,ActionSuggestionExp:0,IntelligenceUserTier:0,MathQuestionExp:0,FREPlaygroundExp:0,ReuseQuestionExp:0,ThankYouPagePromotionV2:0,PlaygroundIterationExp:0,CreateFormImprovementExp:0,FormTitleEditGuidingExp:0,ShowTemplateForColdStart:0,FormsTutorExp:0,AddButtonUXExp:0,FooterBranding:0,LivePresentRefresh:0};i=(0,s.k0)().ecsConfigSettings||c,r=(0,o.pi)((0,o.pi)((0,o.pi)({},e),function(t){var n;try{n=JSON.parse(decodeURI(t||"{}"))}catch(t){n={}}return n}(i.settings)),function(){var t="fo",n=(0,a.NW)()[t];Array.isArray(n)&&(n=n[n.length-1]);var e={};n&&n.split(";").forEach((function(t){"!"!==t[0]?e[t]=!0:(t=t.substr(1),e[t]=!1)}));return e}()),l=!0}}function h(){return l||f(),i.configIds}function d(){return l||f(),r}function m(){return l||f(),"true"===i.isFirstRelease}},60211:function(t,n,e){"use strict";e.d(n,{kD:function(){return r},iI:function(){return p},Fc:function(){return s},rq:function(){return a},_7:function(){return b},Mr:function(){return m},bQ:function(){return v},j4:function(){return c},H5:function(){return w},Gd:function(){return S},yv:function(){return o},x8:function(){return u},A2:function(){return d},H:function(){return h},Ke:function(){return f},u7:function(){return l},a4:function(){return g}});var i=e(9947);function r(){return(0,i.k0)().environmentType}function o(){return t=r(),/.*Prod$/.test(t)||"CVTip"===t||"CVFastfood"===t||"USNat"===t||"USSec"===t;var t}function s(){return function(t){switch(t){case"WWProd":case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return"9188040d-6c67-4c5b-b112-36a304b66dad";default:return"4925308c-f164-4d2d-bc7e-0631132e9375"}}(r())}function a(){return function(t){switch(t){case"WWProd":case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return"72f988bf-86f1-41af-91ab-2d7cd011db47";default:return"f686d426-8d16-42db-81b7-ab578e110ccd"}}(r())}function u(){return"USGovProd"===(t=r())||"USDoDProd"===t||"USGovGccProd"===t||"USNat"===t||"USSec"===t;var t}function c(){return"USGovProd"===(t=r())||"USDoDProd"===t||"USNat"===t||"USSec"===t;var t}function l(){return"USGovGccProd"===r()}function f(){return"USGovProd"===r()}function h(){return"USDoDProd"===r()}function d(){return"USNat"===(t=r())||"USSec"===t;var t}function m(){return"USNat"===r()}function v(){return"USSec"===r()}function g(){return"WWProd"===(t=r())||"MSProd"===t||"CVProd"===t||"CVTip"===t||"CVFastfood"===t;var t}function p(){return function(t){switch(t){case"WWProd":case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return["89d8a01e-e5db-493e-8720-b820d953ef20","b6338c92-533e-4f6d-a327-994263712399"];default:return["f686d426-8d16-42db-81b7-ab578e110ccd"]}}(r())}function b(){return function(t){switch(t){case"WWProd":return"https://c.office.com";case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return"https://c1.microsoft.com";case"Int":return"https://c.office-int.com";default:return null}}(r())}function y(){return window.location.host.toLocaleLowerCase()}function w(){return y().indexOf("forms.microsoft")>=0}function S(){return y().indexOf(".forms.osi.office.net")>0}},96078:function(t,n,e){"use strict";e.d(n,{Z:function(){return r}});var i=e(60211);function r(){return(0,i.Mr)()?"https://graph.eaglex.ic.gov/v1.0":(0,i.bQ)()?"https://graph.microsoft.scloud/v1.0":(0,i.j4)()?"https://graph.microsoft.us/v1.0":(0,i.a4)()||(0,i.u7)()?"https://graph.microsoft.com/v1.0":"https://graph.microsoft-ppe.com/v1.0"}},94290:function(t,n,e){"use strict";e.d(n,{AO:function(){return D},CE:function(){return E},Eh:function(){return N},GF:function(){return L},HI:function(){return B},HQ:function(){return q},Ig:function(){return G},Kw:function(){return x},P_:function(){return F},QR:function(){return O},Rw:function(){return R},S0:function(){return M},W6:function(){return V},Wy:function(){return p},XF:function(){return w},_y:function(){return g},av:function(){return C},ft:function(){return _},gx:function(){return d},hj:function(){return v},iK:function(){return m},jM:function(){return I},lS:function(){return H},mF:function(){return A},rh:function(){return S},s0:function(){return P},uV:function(){return k}});var i,r=e(63795),o=e(9947),s=e(90710);!function(t){t[t.signup=1]="signup"}(i||(i={}));var a,u,c,l,f,h="delegatepage.aspx",d="auth_pvr",m="Token",v="platform",g="jsSdkVersion",p="id",b=null,y=!1;function w(){return c||N()}function S(){return f||(f=(0,s.NW)().appid)}function N(){var t=c||(0,s.NW)().Host||(0,s.$p)().Host;switch(t){case"Assignments":case"Bookings":case"EmbedTestPage":case"Excel":case"Excel_Win32":case"Fluid_Component":case"Loop":case"ODC":case"OneDrive":case"OneNote":case"OneNoteUwp":case"Outlook":case"Outlook_Web_App_Fluid":case"PowerPointContent":case"PowerPointTaskpane":case"ProjectShimla":case"Stream":case"StreamMobile":case"SupplyChainInsights":case"Teams":case"TeamsApproval":case"TeamsBot":case"TeamsPollTab":case"TeamsPollBubble":case"TeamsBotForLife":case"TeamsReports":case"TeamsTab":case"Union":case"Word_Web":case"Word_Web_Fluid":return t;default:return null}}function C(){return a||(0,s.NW)().groupId||(0,s.$p)().groupId}function I(){return u||(0,s.NW)().tid||(0,s.$p)().tid}function T(){return l}function k(){return!!N()||!!(0,o.k0)().isOembedSPO}function x(){var t=w();return("Teams"===t||"TeamsBot"===t||"TeamsPollTab"===t||"TeamsPollBubble"===t||"TeamsBotForLife"===t)&&"undefined"!=typeof microsoftTeams}function F(){return"TeamsPollTab"===w()&&"undefined"!=typeof microsoftTeams}function P(){return"Guest"===T()||"Anonymous"===T()}function D(){var t=w();return"Bookings"===t||"EmbedTestPage"===t||"Loop"===t||"PurView"===t||"SupplyChainInsights"===t||"Teams"===t||"TeamsApproval"===t||"TeamsReports"===t}function M(){return"Bookings"===w()}function L(){return"Assignments"===w()}function R(){return"Assignments"===w()&&(0,s.NW)().AssignmentsNewQuiz&&"true"===(0,s.NW)().AssignmentsNewQuiz.toLowerCase()}function A(){return"Union"===w()}function E(){return"/pages/assignmentsdesignpage.aspx"===window.location.pathname.toLowerCase()||"/pages/assignmentsresponsepage.aspx"===window.location.pathname.toLowerCase()}function O(){return x()||L()||"Stream"===w()||"StreamMobile"===w()||D()}function _(){return"PowerPointTaskpane"===w()||"PowerPointContent"===w()||"PowerPointLive"===w()}function B(){return-1!==window.location.pathname.indexOf("FluidFormPage")}function H(){if(null===b){var t=(0,r.Ee)(window.location.pathname,"/").toLowerCase();b=t.lastIndexOf(h)===t.length-h.length}return b}function G(){return y}function q(){return(0,s.NW)().cdsId}function V(){return(0,s.NW)().cdsRegion}},51531:function(t,n,e){"use strict";e.d(n,{o:function(){return r}});var i=e(9947);function r(){return(0,i.k0)().isOembedSPO}},66676:function(t,n,e){"use strict";e.d(n,{K:function(){return o},t:function(){return s}});var i=e(9947),r=e(90710);function o(){var t=(0,i.k0)().cultureInfo;return t&&t.Name||(0,r.NW)().lang}function s(){return document&&document.body&&"rtl"===document.body.getAttribute("dir")}},34221:function(t,n,e){"use strict";e.d(n,{n:function(){return i}});var i=(0,e(4851).$7)(0)},43209:function(t,n,e){"use strict";e.d(n,{C2:function(){return r},_B:function(){return o},aK:function(){return s}});var i="/formspro";function r(t){var n=t&&t.toLowerCase()||window.location.pathname.toLowerCase();switch(s()&&(n=n.substring(i.length)),n){case"/pages/designpage.aspx":case"/pages/teamsdesignpage.aspx":case"/pages/onenoteaddinpage.aspx":case"/pages/delegatepage.aspx":case"/pages/teamsmeetingpollpage.aspx":case"/pages/designpagev2.aspx":return"Design";case"/pages/responsepage.aspx":case"/pages/teamsresponsepage.aspx":return"Response";case"/pages/analysispage.aspx":return"Analyze";case"/pages/teamsconfigpage.aspx":return"TeamsConfig";case"/pages/shareformpage.aspx":return"ShareForm";case"/pages/responsepreviewpage.aspx":return"ResponsePreviewPage";case"/pages/adminphishingreviewpage.aspx":return"AdminPhishingReviewPage";case"/pages/fluidformpage.aspx":return"Fluid";case"/pages/filedownloadpage.aspx":return"FileDownload";case"/pages/responsedetailpage.aspx":return"ResponseDetailPage";default:return"Unknown"}}function o(){var t=window.location.host.toLocaleLowerCase();return t.indexOf("cus-000.forms.osi.office.net")>=0||t.indexOf("tip.forms.office.com")>=0||t.indexOf("tip.customervoice.microsoft.com")>=0}function s(){return!!window.location.pathname.toLocaleLowerCase().startsWith(i)}},68289:function(t,n,e){"use strict";e.d(n,{v:function(){return s}});var i=e(60211),r="https://forms.microsoft.com/",o="https://forms.office.com/";function s(){var t;switch((0,i.kD)()){case"USDoDProd":t="https://forms.osi.apps.mil/";break;case"USGovProd":t="https://forms.osi.office365.us/";break;case"USGovGccProd":t=(0,i.H5)()?r:o;break;case"WWProd":t=o;break;case"MSProd":t=r;break;case"USNat":t="https://forms.osi.eaglex.ic.gov/";break;case"USSec":t="https://forms.osi.microsoft.scloud/";break;default:t="https://"+window.location.host+"/"}return t}},56010:function(t,n,e){"use strict";e.d(n,{J$:function(){return a},OE:function(){return u},hp:function(){return s}});var i=e(9947),r=e(90710),o=e(60211);function s(){var t=(0,r.NW)().route;if(t){var n=t.toLowerCase();switch(n){case"groupforms":case"myforms":case"officehome":case"start":case"templates":return n;default:return"others"}}}function a(t){switch(t){case"MSProd":case"WWProd":case"USGovGccProd":return"https://www.office.com";case"USGovProd":return"https://www.office365.us";case"USDoDProd":return"https://www.ohome.apps.mil";default:return}}function u(t){var n=(0,i.k0)().userInfo.IsMsa?1:2,e=a((0,o.kD)()),r="".concat(e,"/launch/forms"),u="FormsDomain";if(e){if(t)return"".concat(r,"/groupforms?auth=").concat(n,"&groupId=").concat(t,"&from=").concat(u);var c=s();switch(c){case"appitems":case"myforms":return"".concat(r,"/").concat(c,"?auth=").concat(n,"&from=").concat(u);default:return"".concat(r,"?auth=").concat(n,"&from=").concat(u)}}}},58268:function(t,n,e){"use strict";e.d(n,{V9:function(){return a},YD:function(){return u},ZD:function(){return o},bR:function(){return c},dg:function(){return s}});var i=e(9947),r=e(60211),o="https://go.microsoft.com/fwlink/?linkid=866263",s="https://go.microsoft.com/fwlink/p/?LinkId=2083423";function a(){return(0,r.u7)()?"https://portal.office.com/account/#subscriptions":(0,r.Ke)()?"https://portal.office365.us/account/#subscriptions":(0,r.H)()?"https://portal.apps.mil/account/#subscriptions":(0,r.Mr)()?"https://admin.eaglex.ic.gov":(0,r.bQ)()?"https://admin.microsoft.scloud":s}function u(){return o}function c(){return(0,i.k0)().userInfo.IsMsa?u():a()}},29559:function(t,n,e){"use strict";e.d(n,{Dt:function(){return g},G6:function(){return v},K$:function(){return p},MG:function(){return b},c:function(){return y},fM:function(){return s},gn:function(){return d},i7:function(){return l},lZ:function(){return a},rA:function(){return u},tH:function(){return h},tq:function(){return o},un:function(){return f},vh:function(){return m},w1:function(){return c}});var i=e(94978);function r(){return navigator.userAgent.toLocaleLowerCase()}function o(){var t=r();return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iPad|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}function s(){return window.innerWidth}function a(){return o()&&u()}function u(){return s()<=640}function c(){var t=r();return-1!==t.indexOf("msie")||-1!==t.indexOf("trident/")}function l(){var t=r();return-1!==t.indexOf("chrome/")&&-1===t.indexOf("edge/")}function f(){return-1!==r().indexOf("edge/")}function h(){return-1!==r().indexOf("firefox/")}function d(){return/ip(hone|od|ad)/.test(r())&&!window.MSStream}function m(){var t=r(),n=-1!==t.indexOf("version/9")||-1!==t.indexOf("version/13");return-1!==t.indexOf("mac os x")&&n&&-1!==t.indexOf("safari")}function v(){return r().indexOf("safari")>-1}function g(){return!!r().match(/android/i)}function p(){return-1!==r().indexOf("tbs/")}function b(){return-1!==r().indexOf("micromessenger/")}function y(){return-1!==navigator.platform.toLowerCase().indexOf("win")}(0,i.QJ)("SearchEngineBotList")},79552:function(t,n,e){"use strict";e.d(n,{WP:function(){return o},Y8:function(){return s},xP:function(){return r}});var i=e(89904);function r(t,n){var e=t;return!(e||t||!(0,i.AX)(t))||a(n,e&&e.type,e&&e.statusCode)}function o(t,n){return a(n,t&&t.failureType,t&&t.statusCode)}function s(t){var n=t;if(n&&n.statusCode)return JSON.stringify({correlationId:n.correlationId,innerCode:n.innerCode,innerMessage:n.innerMessage,isServerError:n.isServerError,statusCode:n.statusCode,statusText:n.statusText,type:n.type});var e=t;return e&&e.message?JSON.stringify({message:e.message,name:e.name,stack:u(e.stack)}):u(JSON.stringify(t||""))}function a(t,n,e){switch(t){case"Information":case"FormsProInformation":return!0;case"Error":return!1;default:switch(n){case"Failure":return!1;case"ExpectedFailure":return!0;default:if(e>=0&&e<500)return!0}}return!1}function u(t){return t&&"string"==typeof t&&t.toLowerCase().indexOf("auth_upn")<0&&t.toLowerCase().indexOf("token")<0?t:t?"Sanitized error":""}},46407:function(t,n,e){"use strict";e.d(n,{FP:function(){return i},kC:function(){return r}});var i="Customized Theme",r="Default Theme";"https://".concat("cdn.hubblecontent.osi.office.net","/")},73909:function(t,n,e){"use strict";e.d(n,{Fp:function(){return a},Mb:function(){return l},W$:function(){return f},Wi:function(){return c},lc:function(){return u}});var i={af:"Afrikaans","am-et":"አማርኛ (ኢትዮጵያ)‎",ar:"العربية","as-in":"অসমীয়া (ভাৰত)‎","az-latn-az":"Azərbaycan (Azərbaycan)‎",bg:"Български","bn-in":"বাংলা (ভারত)‎","bs-latn-ba":"Bosanski (Bosna i Hercegovina)‎",ca:"Català","ca-es-valencia":"Valencià (Espanya)‎",cs:"Čeština","cy-gb":"Cymraeg (Y Deyrnas Unedig)‎",da:"Dansk",de:"Deutsch",el:"Ελληνικά","en-gb":"English (United Kingdom)‎","en-us":"English (United States)‎","es-ES":"Español (España, alfabetización internacional)","es-mx":"Español (México)‎",et:"Eesti",eu:"Euskara",fa:"فارسی",fi:"Suomi","fil-ph":"Filipino (Pilipinas)‎","fr-FR":"Français (France)","fr-ca":"Français (Canada)‎","ga-ie":"Gaeilge (Éire)‎",gd:"Gàidhlig",gl:"Galego",gu:"ગુજરાતી",he:"עברית",hi:"हिन्दी",hr:"Hrvatski",hu:"Magyar",id:"Indonesia",is:"íslenska",it:"Italiano",ja:"日本語",ka:"ქართული",kk:"қазақ тілі","km-kh":"ភាសាខ្មែរ (កម្ពុជា)‎",kn:"ಕನ್ನಡ",ko:"한국어",kok:"कोंकणी","lb-lu":"Lëtzebuergesch (Lëtzebuerg)‎",lo:"ລາວ",lt:"Lietuvių",lv:"Latviešu","mi-nz":"Te reo Māori (Aotearoa)‎",mk:"македонски",ml:"മലയാളം",mr:"मराठी",ms:"Melayu","mt-mt":"Malti (Malta)‎","nb-no":"Norsk bokmål (Norge)‎","ne-np":"नेपाली (नेपाल)‎",nl:"Nederlands","nn-no":"Nynorsk (Noreg)‎","or-in":"ଓଡ଼ିଆ (ଭାରତ)‎",pa:"ਪੰਜਾਬੀ",pl:"Polski","pt-br":"Português (Brasil)‎","pt-pt":"Português (Portugal)‎","quz-pe":"Runasimi (Perú)‎",ro:"Română",ru:"Pусский",sk:"Slovenčina",sl:"Slovenščina",sq:"Shqip","sr-cyrl-ba":"Cрпски (Босна и Херцеговина)‎","sr-cyrl-rs":"Cрпски (Србија)‎","sr-latn-rs":"Srpski (Srbija)‎",sv:"Svenska",ta:"தமிழ்",te:"తెలుగు",th:"ไทย",tr:"Türkçe",tt:"Татар",ug:"ئۇيغۇرچە",uk:"Українська",ur:"اُردو",vi:"Tiếng Việt","zh-Hans":"中文（简体）‎","zh-Hant":"中文（繁體）‎"},r={"tk-tm":"Türkmen dili (Türkmenistan)‎"},o=["ar","az","dv","fa","ff","he","ku","nqo","syr","ug","ur"],s=["ar-","he-"];function a(t){var n=t.toLowerCase();return-1!==o.indexOf(n)||!!s.find((function(t){return 0===n.indexOf(t)}))}function u(){return i}function c(){return r}function l(){return"en-us"}function f(t){var n={"ar-eg":"ar","ar-sa":"ar","bg-bg":"bg","ca-es":"ca","cs-cz":"cs","da-dk":"da","de-de":"de","el-gr":"el","es-ar":"es-ES","es-bo":"es-ES","es-cl":"es-ES","es-co":"es-ES","es-cr":"es-ES","es-do":"es-ES","es-ec":"es-ES","es-es":"es-ES","es-gt":"es-ES","es-pa":"es-ES","es-pe":"es-ES","es-pr":"es-ES","es-py":"es-ES","es-sv":"es-ES","es-us":"es-ES","es-uy":"es-ES","es-ve":"es-ES","et-ee":"et","eu-es":"eu","fi-fi":"fi","fr-dz":"fr-FR","fr-fr":"fr-FR","gl-es":"gl","he-il":"he","hi-in":"hi","hr-hr":"hr","hu-hu":"hu","id-id":"id","it-it":"it","ja-jp":"ja","kk-kz":"kk","ko-kr":"ko","lt-lt":"lt","lv-lv":"lv","ms-my":"ms","nl-nl":"nl","pl-pl":"pl","ro-ro":"ro","ru-ru":"ru","sk-sk":"sk","sl-si":"sl","sv-se":"sv","th-th":"th","tr-tr":"tr","uk-ua":"uk","vi-vn":"vi","zh-hans":"zh-Hans","zh-cn":"zh-Hans","zh-hant":"zh-Hant","zh-tw":"zh-Hant"};return n[t]?n[t]:t}},687:function(t,n,e){"use strict";e.d(n,{Df:function(){return P},ED:function(){return a},Fy:function(){return p},HJ:function(){return g},HR:function(){return C},LY:function(){return d},Mh:function(){return u},NI:function(){return I},NJ:function(){return h},Nj:function(){return N},P6:function(){return x},Rr:function(){return b},SL:function(){return w},Tl:function(){return f},Z1:function(){return k},Zf:function(){return _},bU:function(){return T},dD:function(){return F},g6:function(){return O},gC:function(){return L},gX:function(){return o},gj:function(){return A},gn:function(){return D},hN:function(){return R},hT:function(){return r},jm:function(){return M},jz:function(){return c},kA:function(){return l},nC:function(){return i},qx:function(){return m},vM:function(){return v},w_:function(){return y},xZ:function(){return E},yi:function(){return S},zn:function(){return s}});var i=function(){return 90},r=function(){return 4e3},o=function(){return 200},s=function(){return 4e3},a=function(){return 2e3},u=function(){return 1e3},c=function(){return 128},l=function(){return 1e3},f=function(){return 1e3},h=function(){return 4e3},d=function(){return 1e3},m=function(){return 50},v=function(){return 800},g=function(){return 600},p=function(){return 719},b=function(){return 320},y=function(){return 240},w=function(){return 120},S=function(){return 5242880},N=function(){return-1},C=function(){return 422},I=function(){return 10},T=function(){return 1},k=function(){return 375},x=function(){return 300},F=function(){return"AnalyzerToken"},P=function(){return 7},D=function(){return 20},M=function(){return 5242880},L=function(){return"yyyy-MM-dd"},R=function(){return 4e3},A=function(){return 40},E=function(){return 3e3},O=function(){return 10},_=function(){return 5}},9947:function(t,n,e){"use strict";e.d(n,{cm:function(){return a},k0:function(){return s}});var i=e(59312),r=e(9754),o=[];function s(){var t;return null!==(t=window.OfficeFormServerInfo)&&void 0!==t?t:{cultureInfo:{Name:navigator.language},environmentType:"WWProd",serverInfoFromPageHeaders:{},userInfo:{}}}function a(t){var n;n=(0,i.pi)((0,i.pi)({},window.OfficeFormServerInfo),t),window.OfficeFormServerInfo=n,o.forEach((function(t){"function"==typeof t&&t(window.OfficeFormServerInfo)})),t.ecsWebSettings&&(0,r.EG)(t.ecsWebSettings)}},14537:function(t,n,e){"use strict";e.d(n,{$u:function(){return c},JV:function(){return l},PW:function(){return r},Py:function(){return a},XH:function(){return s},cq:function(){return o}});var i={};function r(t){var n=u(t);return!(!n||!n.swCache)}function o(t){i[t]=!0}function s(t){return!i[t]}function a(t,n){n.method;var e=u(t);if(!e)return null;if(e.swCache){e.used=!0;var i=e.swCache;return e.reuse||(e.swCache=null),i}if(e.server){e.used=!0;i=e.server;return e.reuse||(e.server=null),i}return null}function u(t){var n=window.prefetcherPromiseMap;return n?n[t]:null}function c(t){var n=u(t);return n?n.correlationId:null}function l(t,n){var e=t.prefetcherId,i=t.prefetcherType,r=t.correlationId;window.prefetcherPromiseMap||(window.prefetcherPromiseMap={}),window.prefetcherPromiseMap[e]||(window.prefetcherPromiseMap[e]={server:null,swCache:null,correlationId:null,reuse:t.reuse}),window.prefetcherPromiseMap[e][i]=n,"server"===i&&(window.prefetcherPromiseMap[e].correlationId=r)}},41797:function(t,n,e){"use strict";function i(){return{context:{},iKey:"91531c5d891c486da00dddb1049c30a2-e90b69b1-4f29-40bb-8d25-66d7d26ede43-7437",disableAdvancedScans:!0}}e.d(n,{b:function(){return i}})},5809:function(t,n,e){"use strict";e.d(n,{DY:function(){return u},Lu:function(){return c},kI:function(){return a},zA:function(){return l}});var i=e(37076),r=e(5699),o=e(14327);function s(t){switch(t){case"WWProd":case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return"9188040d-6c67-4c5b-b112-36a304b66dad";default:return"4925308c-f164-4d2d-bc7e-0631132e9375"}}function a(t,n,e,o,a){var u=l(t),c=function(t,n,e,o,a){switch(t){case"Int":case"MSInt":case"CVInt":return r.uS;case"WWProd":case"MSProd":case"ProTip":case"CVTip":case"CVProd":case"CVFastfood":return o?r.$w:a?r.J9:function(t,n,e){if(t){var r=(0,i.kc)(t);return!!r.OrgId&&r.OrgId.toLowerCase()===s(e)}return function(t,n){return!!t&&t.toLowerCase()===s(n)}(n,e)}(n,e,t)?r.Tb:r.QA;case"USGovGccProd":return a?r.wc:r.f0;case"USGovProd":return r.lv;case"USDoDProd":return r.Hs;case"USNat":return r.bf;case"USSec":return r.zo;default:return r.Bv}}(t,n,e,o,a);return{EndpointUrl:u,AriaToken:c}}function u(t,n,e,i,s){var a,u=location.pathname.toLowerCase(),c=(0,o.Or)(u)?u:"[invalid_page_type]",l=((a={})[r.m0]=t.clientBuild,a[r.VZ]=n,a[r.iA]=e,a[r.Gy]=c,a[r.gU]=t.serverBuild,a[r.lV]=t.datacenter,a[r.L]=t.ring,a[r.Q_]=t.serverSessionId,a[r.iQ]=i?"Office FormsPro BrowserApp":s?"Office Forms Webdriver":"Office Forms BrowserApp",a);if(t.serverInfoFromPageHeaders){var f=t.serverInfoFromPageHeaders;l[r.nq]=f.routingBuild,l[r.ul]=f.routingDataCenter,l[r.Cm]=f.routingInstance,l[r.QM]=f.serverInstance}return l}function c(t,n,e){var i,o=t.userInfo,s=o.UserId,a=o.TenantId,u=o.IsMsa,c=o.PUID,l=((i={})[r.E1]=s,i[r.OP]=n,i[r.xM]=a,i);return a?(u?(l[r.rd]=c,l[r.i7]="MSAPUID"):(l[r.rd]=s,l[r.i7]="UserObjectId"),l[r.Qx]=a):l[r.gK]=e,l}function l(t){switch(t){case"USGovProd":return"https://tb.events.data.microsoft.com/OneCollector/1.0/";case"USDoDProd":return"https://pf.events.data.microsoft.com/OneCollector/1.0/";case"USNat":return"https://collector.azure.eaglex.ic.gov/OneCollector/1.0/";case"USSec":return"https://collector.azure.microsoft.scloud/OneCollector/1.0/"}return null}},82195:function(t,n,e){"use strict";e.d(n,{F:function(){return r},a:function(){return o}});var i=e(63061);function r(t,n,e,r,o){if(void 0!==e){var s=r,a=void 0;"boolean"==typeof e?a=(0,i.UL)(n,e,s):"number"==typeof e?a=Math.floor(e)===e?(0,i.Kq)(n,e,s):(0,i.b_)(n,e,s):"string"==typeof e&&(a=o?(0,i.xq)(n,e,s):(0,i.dt)(n,e,s)),a&&t.push(a)}}function o(t,n,e,i,o,s){r(t,n?n+"."+e:e,i,o,s)}},87260:function(t,n,e){"use strict";e.d(n,{I:function(){return r}});var i=e(73546);function r(){return new Promise((function(t){(0,i.j)().flushAndStop(t)}))}},94283:function(t,n,e){"use strict";e.d(n,{AC:function(){return s},OE:function(){return o},Tj:function(){return a},Zz:function(){return u}});var i=e(73546);function r(t){var n;t.$timestamp=null!==(n=t.$timestamp)&&void 0!==n?n:Date.now(),(0,i.j)().sendTelemetryEvent(t)}function o(t,n){r({$eventName:t,$eventType:2,$eventFlags:8,$eventData:n})}function s(t,n){r({$eventName:t,$eventType:8,$eventFlags:10,$eventData:n})}function a(t){r({$eventName:"",$eventType:5,$eventFlags:8,$eventData:t})}function u(t,n){r({$eventName:t,$eventType:6,$eventFlags:8,$eventData:n})}},916:function(t,n,e){"use strict";e.d(n,{o:function(){return u}});var i=e(49690),r=e(73546),o=e(85708),s=e(97265),a=e(2775),u=function(){function t(t,n){void 0===n&&(n=null),this.T={correlationId:n||(0,s.GW)(),duration:0,eventName:t,eventType:"qos_event",extraData:void 0,qosEventName:t},this.nt=null}return Object.defineProperty(t.prototype,"CorrelationId",{get:function(){return this.T.correlationId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ExtraData",{get:function(){return this.T.extraData},set:function(t){this.T.extraData=t},enumerable:!1,configurable:!0}),t.prototype.start=function(t){void 0===t&&(t=null),this.nt=t||(0,o.dg)();var n=this.rt(this.T,0);(0,r.j)().logData(n)},t.prototype.end=function(t){var n=this.rt(t,1);return(0,r.j)().logData(n),n.duration},t.prototype.log=function(t){var n=this.rt(t,2);(0,r.j)().logData(n)},t.prototype.rt=function(t,n){var e=(0,a.d9)(this.T);switch(null!==this.nt&&0!==n&&(e.duration=(0,o.dg)()-this.nt),t.extraData&&(e.extraData=t.extraData),n){case 0:e.qosEventStatus="Start";break;case 2:e.qosEventStatus=(0,i.x)(["Logging",t.resultCode]);break;case 1:e.qosEventStatus=t.resultType}return e.eventName=(0,i.x)([e.eventName,e.qosEventStatus]),e},t}()},41480:function(t,n,e){"use strict";e.d(n,{k:function(){return s}});var i,r=e(9947),o=e(97265);function s(){if(i)return i;var t=(0,r.k0)().serverSessionId;return i=t||(0,o.GW)()}},42922:function(t,n,e){"use strict";e.d(n,{G:function(){return a},U:function(){return s}});var i,r=e(37890),o=e(9754);function s(t){u().resolve(t||(0,o.dR)("EventCollectorUri"))}function a(){return u().promise()}function u(){return i||(i=new r.wU),i}},78606:function(t,n,e){"use strict";var i=e(83390),r=["ajax.aspnetcdn.com","alcdn.msauth.net","amcdn.msftauth.net","apis.google.com","appsforoffice.microsoft.com","cdn.forms.office.net","cdn.office.net","js.monitor.azure.com","mem.gfx.ms",".office365.com","www.microsoft.com"],o=["cdnjs.cloudflare.com","localhost"],s=["chrome-extension:"];!function(){try{window.trustedTypes&&window.trustedTypes.createPolicy&&!window.trustedTypes.defaultPolicy&&window.trustedTypes.createPolicy("default",{createScriptURL:function(t){if(function(t){var n=new URL(t,window.origin),e=(0,i.xW)();return o.some((function(t){return n.host.endsWith(t)}))&&!e?e:r.some((function(t){return n.host.endsWith(t)}))||n.host===window.location.host||s.some((function(t){return t===n.protocol}))}(t))return t}})}catch(t){}}()},75827:function(t,n,e){"use strict";e.d(n,{$O:function(){return o},y$:function(){return s}});var i=e(73252),r=e(9947);function o(){return(0,i.cr)("EnableECSInFirstRelease")}function s(){var t=(0,r.k0)().userReleaseTrackInfo;return t&&t.id?{tenantReleaseTrack:t.tenantReleaseTrack,userReleaseTrack:t.userReleaseTrack,isFirstRelease:t.isFirstRelease}:null}},83894:function(t,n,e){"use strict";e.d(n,{Ak:function(){return u},Wh:function(){return a},ZL:function(){return c},ro:function(){return s}});var i=e(60211),r=e(9947),o=function(){return(0,r.k0)().userInfo.TenantId};function s(t){return!(!(t=t||o())||t.toLowerCase()!==(0,i.Fc)())}function a(t){return!(!(t=t||o())||t.toLowerCase()!==(0,i.rq)())}function u(t){return(t=t||o())&&-1!==(0,i.iI)().indexOf(t.toLowerCase())}function c(t){return!(!(t=t||o())||"72f988bf-86f1-41af-91ab-2d7cd011db47"!==t.toLowerCase())}},262:function(t,n,e){"use strict";function i(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=t.map((function(t){return t&&t.trim()})).filter((function(t){return!!t})).join(" ");return e||t.some((function(t){return""===t}))||(e=void 0),e}e.d(n,{j:function(){return i}})},18693:function(t,n,e){"use strict";function i(t,n,e){var i=new Date;i.setTime(i.getTime()+e);var r="expires="+i.toUTCString();document.cookie="".concat(t,"=").concat(n,"; ").concat(r,"; ").concat("path=/")}function r(t){t+="=";var n=document.cookie.split(";").filter((function(n){return n.indexOf(t)>=0}));if(n.length>0){var e=n[0].trim();return e.substring(t.length,e.length)}return null}e.d(n,{d:function(){return i},e:function(){return r}})},72420:function(t,n,e){"use strict";function i(t){return"number"==typeof t}function r(t){return"string"==typeof t}e.d(n,{HD:function(){return r},hj:function(){return i}})},85708:function(t,n,e){"use strict";function i(){return Date.now||(Date.now=function(){return(new Date).getTime()}),Math.floor(Date.now())}e.d(n,{dg:function(){return i}})},83390:function(t,n,e){"use strict";e.d(n,{Xy:function(){return i},xW:function(){return r}});var i=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];if(r())switch(t){case 0:console.error.apply(console,n);break;case 1:console.warn.apply(console,n);break;case 2:console.log.apply(console,n);break;case 3:console.debug.apply(console,n)}},r=function(){return!1}},97265:function(t,n,e){"use strict";function i(){return t=[s()+s(),s(),s(),s(),s()+s()+s()].join("-"),n=parseInt(t.charAt(19),16),e=(n=3&n|8).toString(16),t=a(t,14,"4"),t=a(t,19,e);var t,n,e}function r(t){return/^[0-9a-fA-F\-]*$/.test(t)&&/^[^\-]{8}(\-[^\-]{4}){4}[^\-]{8}$/.test(t)}function o(t){var n=t.match(/[0-9a-fA-F]*/g),e="";return n.map((function(t){return e+=t})),!t||/^[0-]*$/.test(t)}function s(){return function(t,n,e){for(var i=t.length,r=e.length;i<n;i+=r)t=e+t;return t}(Math.floor(65536*Math.random()).toString(16),4,"0")}function a(t,n,e){return t.substring(0,n)+e+t.substring(n+1)}e.d(n,{Ew:function(){return o},GW:function(){return i},SD:function(){return r}})},85962:function(t,n,e){"use strict";function i(t){for(var n=0,e=0;e<t.length;e++)n=t.charCodeAt(e)+((n<<5)-n);return n}e.d(n,{u:function(){return i}})},81620:function(t,n,e){"use strict";e.d(n,{Es:function(){return l},F1:function(){return c},Uy:function(){return o},jL:function(){return a},vu:function(){return s},y:function(){return u}});var i=e(90710),r=e(2775);function o(t){return"string"==typeof t&&(t=document.querySelector(t)),t?window.getComputedStyle?parseInt(window.getComputedStyle(t).height):t.clientHeight:0}function s(t,n,e){void 0===e&&(e=!1);var o=t.indexOf("#"),s=-1===o?"":t.substr(o),a=(t=-1===o?t:t.substr(0,o)).indexOf("?"),u=-1===a?"":t.substr(a);t=-1===a?t:t.substr(0,a);var c={};return u&&(c=(0,i.cO)(u.substr(1))),(0,r.l7)(c,n),"".concat(t,"?").concat(e?function(t){var n="";t&&"object"==typeof t&&(n=Object.keys(t).reduce((function(n,e){return n.push("".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t[e]))),n}),[]).join("&"));return n}(c):$.param(c)).concat(s)}function a(t,n){if(t&&n)return t[n]||t[n.toLowerCase()]||void 0}function u(t,n,e){var i=t.indexOf("#"),r=-1===i?"":t.substr(i);t=-1===i?t:t.substr(0,i);var o=new RegExp("([?&])".concat(n,"=.*?(&|$)"),"i"),s=-1!==t.indexOf("?")?"&":"?";return(t=t.match(o)?t.replace(o,"$1".concat(n,"=").concat(e,"$2")):"".concat(t+s+n,"=").concat(e))+r}function c(t,n){void 0===n&&(n=!0);var e=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;");return n&&(e=e.replace(/'/g,"&apos;")),e}var l=function(t,n){var e=window.location.hash;if(!e||!e.startsWith("#"))return window.location.href;var i=new RegExp("^".concat(t,"=.*"),"i"),r=e.substring(1).split("&");return r.forEach((function(e,o){e.match(i)&&(r[o]="".concat(t,"=").concat(n))})),"".concat(window.location.origin).concat(window.location.search,"#").concat(r.join("&"))}},38174:function(t,n,e){"use strict";e.d(n,{Wz:function(){return i},y3:function(){return r}});function i(t,n){t&&t.focus({preventScroll:!!n})}function r(t){var n=t.nativeEvent&&t.nativeEvent.explicitOriginalTarget;return t.relatedTarget||n||document.activeElement}},15934:function(t,n,e){"use strict";function i(t){return/^(https ?\:\/\/)?((www\.)?youtube\.com|youtu\.?be)\/.+$/.test(t)}function r(t){return/^(https ?\:\/\/)?(?:msit|web)\.microsoftstream\.com\/.+$/.test(t)||/^(https ?\:\/\/)?(?:www\.)?(microsoft-my.sharepoint-df|microsoft.sharepoint)\.com\/.+$/.test(t)||/(https ?\:\/\/)[^\s]*.(sharepoint|sharepoint-df)\.com\/[^\s]*/.test(t)}function o(t){return i(t)||r(t)}function s(t){var n=document.createElement("a");return n.href=t,n.host&&n.host!==window.location.host}e.d(n,{K2:function(){return s},M4:function(){return r},eC:function(){return o},yk:function(){return i}})},92575:function(t,n,e){"use strict";e.d(n,{p:function(){return a}});var i=e(31699),r=e.n(i),o=e(59749),s=e(73252);function a(t,n){(0,o.kM)(t,function(t){if(!t)return"";if(!(0,s.cr)("EnableSanitizedHTML"))return t;try{return r().sanitize(t)}catch(n){return t}}(n))}},64459:function(t,n,e){"use strict";function i(t){try{return JSON.parse(t)}catch(n){return t}}e.d(n,{d:function(){return i}})},65274:function(t,n,e){"use strict";function i(t){var n=typeof t;return"function"===n||"object"===n&&!!t}function r(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return n.length<1||!i(t)||n.forEach((function(n){s(n).forEach((function(e){t[e]=n[e]}))})),t}function o(t){return i(t)?Array.isArray(t)?t.slice():r({},t):t}function s(t){return i(t)?Object.keys(t):[]}function a(t,n){Array.isArray(t)&&t.forEach(n),i(t)&&s(t).forEach((function(e){n(t[e],e)}))}function u(t,n,e,r){if(Array.isArray(t))return t.map((function(e,i){return u(e,n,i,t)}));if(i(t)){var o={};return s(t).forEach((function(e){o[e]=u(t[e],n,e,t)})),o}return n(t,e,r)}function c(t,n){return u(t,n)}e.d(n,{EL:function(){return f},Fh:function(){return c},S6:function(){return a},d9:function(){return o},l7:function(){return r}});var l,f=(l=0,function(t){return"".concat(t||"").concat(++l)});Date.now},23421:function(t,n,e){"use strict";e.d(n,{y:function(){return o}});var i=e(60211),r=e(18693),o=function(){function t(){this.ot=null}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.prototype.getMuid=function(){return this.ot},t.prototype.ensureMuid=function(){var n=this;return null==this.ut&&(this.ut=new Promise((function(e){var i=(0,r.e)("MUID");if(i)return n.ot=i,void e(n.ot);t.loadMuid((function(){null!=(i=(0,r.e)("MUID"))?(n.ot=i,e(n.ot)):e()}))}))),this.ut},t.loadMuid=function(t){var n=(0,i._7)();if(n){var e=document.createElement("img");e.style.display="none",e.src=n+"/c.gif",e.hidden=!0,e["aria-hidden"]="true",e.onload=e.onerror=t}else t()},t.instance=null,t}()},84475:function(t,n,e){"use strict";e.d(n,{A:function(){return s}});var i=e(90710),r=e(94290),o=e(9947);function s(){var t="ms-formweb";if((0,r.uV)()){var n=(0,r.Eh)();n&&(t="ms-"+n.toLowerCase()),(0,o.k0)().isOembedSPO&&(t="forms-webpart")}return(0,o.k0)().isSonarServer&&(t="ms-sonar"),(0,o.k0)().isAntiPhishingTool&&(t="ms-antiphishingtool"),"OST"===(0,i.NW)().Host&&(t="ms-ost"),t}},37890:function(t,n,e){"use strict";function i(t){return new Promise((function(n,e){t.then(n,e)}))}function r(t){var n=function(){return Promise.resolve(null)};return t?t.then(n,n):n()}function o(){return new Promise((function(){}))}var s;e.d(n,{Bx:function(){return r},Cb:function(){return s},Ks:function(){return c},Px:function(){return i},bC:function(){return a},eX:function(){return o},wU:function(){return u}}),function(t){t[t.Pending=0]="Pending",t[t.Resolved=1]="Resolved",t[t.Rejected=2]="Rejected"}(s||(s={}));var a=function(){function t(t){var n=this;t.then((function(){n.ct=s.Resolved}),(function(){n.ct=s.Rejected})),this.ht=t,this.ct=s.Pending}return t.prototype.promise=function(){return this.ht},t.prototype.states=function(){return this.ct},t}(),u=function(){function t(){var t=this;this.ht=new a(new Promise((function(n,e){t.bt=n,t.yt=e})))}return t.prototype.promise=function(){return this.ht.promise()},t.prototype.resolve=function(t){return this.bt(t),this},t.prototype.reject=function(t){return this.yt(t),this},t.prototype.states=function(){return this.ht.states()},t}();function c(t,n){var e,i=new Promise((function(t,i){e=setTimeout((function(){return i("Promise timed out")}),n)})),r=t.finally((function(){e&&clearTimeout(e)}));return Promise.race([r,i])}},90710:function(t,n,e){"use strict";function i(t,n){return void 0===n&&(n=!0),o(t||window.location.search.substring(1),n)}function r(t,n){return void 0===n&&(n=!0),o(t||window.location.hash.substring(1),n)}function o(t,n){void 0===n&&(n=!0);var e={};return t&&t.trim().split("&").forEach((function(t){var i=t.indexOf("=");-1===i&&(i=t.length);var r=t.substring(0,i).trim();if(r){var o=t.substring(i+1).trim();e[r]=n?decodeURIComponent(o).trim():o}})),e}function s(t,n){var e=function(t){var n=document.createElement("a");return n.href=t,n.search}(t),i=e.slice(1),r=new RegExp(n.join("=|")+"="),o=i.split("&"),s=[];o.forEach((function(t){t&&!1===r.test(t)&&s.push(t)}));var a=s.length?"?".concat(s.join("&")):"";return t.replace(e,a)}e.d(n,{$p:function(){return r},NW:function(){return i},cO:function(){return o},oW:function(){return s}})},88744:function(t,n,e){"use strict";function i(t,n){return function(e){t&&t(e),n&&n(e)}}e.d(n,{F:function(){return i}})},37043:function(t,n,e){"use strict";e.d(n,{Q:function(){return h},U:function(){return l}});var i=e(59312),r=e(14537),o=e(9947),s=e(18693),a=e(64459),u=e(84475),c=e(90710);function l(t){return t?(t.startsWith("t=")?"":"Bearer ")+t:""}function f(t){var n;if(t["x-ms-form-request-ring"])return t["x-ms-form-request-ring"];var e=(0,o.k0)();return"USGovGccProd"===e.environmentType?"gcc":null===(n=e.ring)||void 0===n?void 0:n.toLowerCase()}function h(t){var n=t.method,e=t.url,h=t.params,d=void 0===h?"":h,m=t.data,v=void 0===m?{}:m,g=t.timeout,p=void 0===g?0:g,b=t.headers,y=void 0===b?{}:b,w=t.correlationId,S=t.accessToken,N=t.blobResponse,C=t.ignoreCommonHeaders,I=t.prefetcherType,T=t.prefetcherId,k=new Promise((function(r,h){var m=t.req||new XMLHttpRequest;d&&(e+="?"+d),m.open(n,e),C||(y=function(t,n,e){var r=(0,o.k0)(),a=(0,c.NW)(void 0,!1),h=(0,c.$p)(void 0,!1).Token||a.Token||a.sharetoken,d={"content-type":"application/json","x-correlationid":n,"x-usersessionid":r.serverSessionId,"x-ms-form-request-source":(0,u.A)(),"x-ms-form-request-ring":f(t),"odata-maxverion":"4.0","odata-version":"4.0",__requestverificationtoken:r.antiForgeryToken,accept:"application/json"};if(h&&(d.shareinvitationkey=h),"ms-ost"===(0,u.A)()){var m=a.ostreporttime,v=a.ostsignature;m&&(d["x-ms-form-ostreporttime"]=m),v&&(d["x-ms-form-ostsignature"]=v)}var g=(0,s.e)("MUID");g&&(d["x-ms-form-muid"]=g);var p=(0,i.pi)((0,i.pi)({},d),t);return p.authorization=t.authorization||l(e),p}(y,w,S)),Object.keys(y).forEach((function(t){m.setRequestHeader(t,y[t])})),N&&(m.responseType="blob");var g=[y["x-fsw-cacheonly"],y["x-fsw-enable"]].every((function(t){return"1"===t}));v instanceof Blob||v instanceof ArrayBuffer?m.send(v):m.send(JSON.stringify(v)),p>0&&setTimeout(h,p),m.onreadystatechange=function(){if(m.readyState===XMLHttpRequest.DONE){var t=m.status;if(200===t||202===t||201===t){if(N)return r(m.response);if(g){var n=(0,a.d)(m.response);return void(n&&r(n))}return r(m.responseText&&JSON.parse(m.responseText))}if(204===t)return r(void 0);var i={response:{body:N||g?"":m.responseText,requestUri:e,statusCode:t,statusText:t.toString(),headers:e.startsWith(window.location.origin)?{"X-CorrelationId":m.getResponseHeader("X-CorrelationId"),"X-FailureReason":m.getResponseHeader("X-FailureReason"),"X-MSEdge-Ref":m.getResponseHeader("X-MSEdge-Ref"),"WWW-Authenticate":m.getResponseHeader("WWW-Authenticate"),"CARD-ACTION-STATUS":m.getResponseHeader("CARD-ACTION-STATUS")}:{}}};!g&&h(i)}}}));return I&&T&&(0,r.JV)(t,k),k}},18113:function(t,n,e){"use strict";e.d(n,{ZP:function(){return l},dZ:function(){return f},fq:function(){return h}});var i=e(59749),r=e(2775),o=["strong","em","u","sup","sub","a","i","b"],s=o.map((function(t){return"<".concat(t,">")})),a=o.map((function(t){return"</".concat(t,">")})),u=o.map((function(t){return"&lt;".concat(t,"&gt;")})),c=o.map((function(t){return"&lt;/".concat(t,"&gt;")}));function l(t){var n=function(t){var n=(0,r.YU)(t);return o.forEach((function(t,e){n=n.replaceAll(u[e],s[e]).replaceAll(c[e],a[e])})),n}(t);return function(t){var n=document.createElement("span");return(0,i.kM)(n,t),t=n.innerHTML}(n)}function f(t){return s.forEach((function(n){t=t.replaceAll(n,"")})),a.forEach((function(n){t=t.replaceAll(n,"")})),t}function h(t){return(t||"").replace(/(<ol>|<\/ol>|<ul>|<\/ul>|<li>|<\/li>)/gi,"")}},45331:function(t,n,e){"use strict";function i(t,n,e,i,r){if(r){var o=document.createElement("a");return o.href=t,o.target=n||"_blank",document.body.appendChild(o),o.click(),document.body.removeChild(o),null}return n||e||i?e||i?i?window.open(t,n,e,i):window.open(t,n,e):window.open(t,n):window.open(t)}e.d(n,{K:function(){return i}})},13877:function(t,n,e){"use strict";var i,r,o,s;e.d(n,{$o:function(){return l},G:function(){return f},ns:function(){return c},y1:function(){return d}});var a=null,u=null;function c(){return i||(i=l())instanceof m&&(i=f()),i}function l(){return r||(r=d()?window.localStorage:h()),r}function f(){return o||(o=function(){if(null==u)try{var t="officeforms.__storage_test__";window.sessionStorage.setItem(t,t),window.sessionStorage.removeItem(t),u=!0}catch(t){u=!1}return u}()?window.sessionStorage:h()),o}function h(){return s||(s=new m),s}function d(){if(null==a)try{var t="officeforms.__storage_test__";window.localStorage.setItem(t,t),window.localStorage.removeItem(t),a=!0}catch(t){a=!1}return a}var m=function(){function t(){}return t.prototype.clear=function(){},t.prototype.getItem=function(t){},t.prototype.key=function(t){return null},t.prototype.removeItem=function(t){},t.prototype.setItem=function(t,n){},t}()},63795:function(t,n,e){"use strict";e.d(n,{Ee:function(){return s},WU:function(){return r},bC:function(){return o},r3:function(){return a}});var i=e(83390);function r(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return t?((0,i.xW)()&&n.includes("<")&&n.includes(">")&&((0,i.Xy)(1,"Format string contains HTML tag. Consider to refactor the string and use formatStringToRender instead."),(0,i.Xy)(1,"Original string: ".concat(t))),t.replace(/{(\d+)}/g,(function(t,e){return void 0!==n[e]&&null!==n[e]?n[e].toString():t}))):t}function o(t){return t&&"function"==typeof t.normalize?t.normalize("NFC"):t}function s(t,n){if(null==t||0===t.length)return t;for(var e=t.length;--e>=0&&!(n.indexOf(t.charAt(e))<0););return t.substr(0,e+1)}var a=function(t,n){return!(!t||!n||"string"!=typeof t||"string"!=typeof n)&&t.toLowerCase().indexOf(n.toLowerCase())>=0}},49690:function(t,n,e){"use strict";function i(t,n){return void 0===n&&(n="."),t.filter((function(t){return!!t})).join(n)}e.d(n,{x:function(){return i}})},4851:function(t,n,e){"use strict";function i(t){var n,e=!1,i=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];return e?n:(e=!0,n=t.apply(void 0,i))};return i.reset=function(){e=!1,n=null},i}function r(t){var n=t;return function(t){return arguments.length&&(n=t),n}}e.d(n,{$7:function(){return r},Rm:function(){return i}})},70069:function(t,n,e){"use strict";e.d(n,{s:function(){return v}});var i,r=e(31699),o=e.n(r),s=e(73252),a=e(59312),u=e(92575),c=e(2775);function l(t){if(!t)return t;var n=document.createElement("div");return(0,u.p)(n,t),f(n),n.innerHTML}function f(t){var n;t&&(t.hasChildNodes&&t.hasChildNodes()?(0,c.S6)(t.childNodes,(function(t){f(t)})):"BR"===t.nodeName||t.textContent||null===(n=t.parentElement)||void 0===n||n.removeChild(t))}function h(t){if(!t)return"";var n=function(t){return t?t.replace(/(<\/?)(p|section|article|blockquote|nav|header|h1|h2|h3|h4|h5|h6)([^>]*>)/gi,"$1div$3"):t}(function(t){if(!t)return"";var n=t.replace(/\r/gi,"");return/<\/?[a-z][^>]*>/gi.test(n)?n.replace(/\n/gi," "):n.replace(/\n/gi,"<br>")}(o().sanitize(t))),e=l(n).split(/<div.*?>(.*?)<\/div>/gi).filter((function(t){return!!t}));return e.map((function(t,n){return n===e.length-1||function(t){var n=document.createElement("div");(0,u.p)(n,t);for(var e=n.lastChild;null==e?void 0:e.hasChildNodes();)e=e.lastChild;return"BR"===(null==e?void 0:e.nodeName)}(t)?t:t+"<br>"})).join("")}var d=[{PropertyName:"color",PropertyDisplayName:"color",AllowedValue:/\s?rgb\(/},{PropertyName:"fontSize",PropertyDisplayName:"font-size",AllowedValue:/(1.2|1|0.8|0.9|1.3)em/}];function m(t){if(t.hasAttribute("style")){for(var n,e=[],r=0,o=d;r<o.length;r++){var s=o[r],a=t.style[s.PropertyName];a&&s.AllowedValue.test(a)&&e.push("".concat(s.PropertyDisplayName,": ").concat(a,";"))}e.length&&((n=t.tagName)&&(i||(i="span|b|i|u".split("|")),i).includes(n.toLocaleLowerCase()))?t.setAttribute("style",e.join("")):t.removeAttribute("style")}}function v(t){var n=t.$isSanitizeRichTextHTMLBase,e=void 0!==n&&n,i=t.$removeLineBreaks,r=void 0!==i&&i,u=t.$text;if(e&&(u=function(t,n){void 0===n&&(n=!1),o().addHook("afterSanitizeAttributes",m);var e=["strong","em","u","b","i","ul","li","span","ol"],i=o().sanitize(h(t),{ALLOWED_ATTR:["style"],ALLOW_DATA_ATTR:!1,ALLOWED_TAGS:n?e:(0,a.ev)((0,a.ev)([],e,!0),["br"],!1)});return o().removeHook("afterSanitizeAttributes"),i}(u,r)),!u)return"";if(!(0,s.cr)("EnableSanitizedHTML"))return u;try{return o().sanitize(u)}catch(t){return u}}},48186:function(t,n,e){"use strict";function i(t){return null==t}e.d(n,{l:function(){return i}})},2775:function(t,n,e){"use strict";e.d(n,{CE:function(){return l},Kn:function(){return u},Ry:function(){return f},S6:function(){return r},XP:function(){return c},YU:function(){return s},d9:function(){return o},l7:function(){return a}});var i=e(12611),r=i.each,o=i.clone,s=i.escape,a=i.extend,u=i.isObject,c=i.keys,l=i.omit,f=(i.pick,i.object)},219:function(){"use strict";!function(){var t=function(){if(t.p)return t.p;var n,e,i=window.shellInfo,r=!1;if(i)r=!!(e=i.cdnEndpoint);else{var o=window.OfficeFormServerInfo||{};e=JSON.parse(decodeURIComponent(o.webSettings||"{}")).CdnEndPoint,r=o.isCdnEnabled}return r&&e&&location.search&&location.search.indexOf("nocdn=1")>-1&&(e="".concat(location.protocol,"//").concat(location.host,"/cdn")),n=r&&e?e+"/scripts/dists/":"".concat(location.protocol,"//").concat(location.host,"/Scripts/dists/"),t.p=n,t.isCdnEnabled=r,t.p};t.p=null,window.getChunkPath=t,window.replaceChunkSrc=function(t){t=t.toLowerCase();var n=window.OfficeFormServerInfo||window.shellInfo;return n&&n.ring&&!window.getChunkPath.isCdnEnabled?t+"?ring="+n.ring:t}}()},92528:function(t,n,e){"use strict";e.d(n,{y3:function(){return u},QY:function(){return a}});var i,r,o={$detectUserLoggedInAAD:"a",$getToken:"b",$lrpIoC:"c",$setIoCDelegator:"d"},s=new(e(37890).wU);function a(t){r=t}function u(){var t=function(){if("function"==typeof r)return r;var t=function(){i||(i={},Object.keys(o).forEach((function(t){var n=o[t];Object.defineProperty(i,t,{configurable:!1,enumerable:!0,get:function(){return window.formClientApi&&window.formClientApi[n]},set:function(){throw new Error("Please call setClientApi instead.")}})})));return i}().$getToken;if("function"==typeof t)return t;return}();return t?t().then((function(t){return s.resolve(t),t})).catch((function(t){throw s.reject(t),t})):Promise.reject("No addin access token getter is registered.")}},7614:function(t,n,e){"use strict";e.d(n,{r:function(){return l}});var i,r=e(42922),o=e(9947),s=e(72317),a=e(31442),u=e(21607),c=!1;function l(t){return i&&!c||(c=!1,i=(0,u.v9)(t).then((function(){return(0,a.$U)("RefreshInfo.Success"),(0,s.a)().Flighting.setFlights((0,o.k0)().flights),(0,r.U)(),!0})).catch((function(t){throw(0,a.$U)("RefreshInfo.Failed",{error:t}),c=!0,t}))),i}},67353:function(t,n,e){"use strict";e.d(n,{l8:function(){return D},LP:function(){return M},g$:function(){return P}});var i=e(94978),r=["https://forms.office.com","https://forms.office-int.com","https://forms.osi.apps.mil","https://forms.osi.office365.us","https://forms.microsoft.com","https://msit.microsoftstream.com","https://web.microsoftstream.com","https://microsoftapc.sharepoint.com","https://teams.microsoft.com","https://microsoft.sharepoint-df.com","https://www.onenote.com","https://sway.office.com","https://approvals.teams.microsoft.com","https://approvalsint.teams.microsoft.com","https://approvalsppe.teams.microsoft.com","https://approvals.gcc.teams.microsoft.com","https://healthcarestaging.teams.microsoft.com","https://healthcareppe.teams.microsoft.com","https://healthcaredev.teams.microsoft.com","https://healthcaredogfood.teams.microsoft.com","https://healthcare.teams.microsoft.com","https://outlook.office365.com","https://purview.azure-test.com","https://purview.azure.com","https://outlook-sdf.office.com","https://www.office.com","https://outlook.office.com","https://fa000000084.resources.office.net","https://fa000000096.resources.office.net","https://fluidhostwin32.azurewebsites.net","https://fluidhostwin32-dev.azurewebsites.net","https://dev.ch5.fluidpreview.office.net","https://dev.fluidpreview.office.net","https://fluidpreview.office.net","https://fluidhostwin32-staging.azurewebsites.net","https://office.com","https://reports.teams.microsoft.com","https://reports-ppe.teams.microsoft.com","https://reports-int.teams.microsoft.com","https://sci.local.dynamics.com","https://sci.test.dynamics.com","https://sci.us-cm100.gateway.test.cm.powerapps.com","https://ch5.fluidpreview.office.net","https://officefluidprdeployments.azurewebsites.net","https://df.loop.microsoft.com","https://dev.loop.microsoft.com","https://loop.microsoft.com","https://local.loop.microsoft.com","https://dev.whiteboard.microsoft.com","https://app.int.whiteboard.microsoft.com","https://whiteboard.office.com","https://whiteboard.microsoft.com","https://app.whiteboard.microsoft.com"];function o(t){return function(t){return-1!==r.indexOf(t.toLowerCase())}(t)||function(t){var n=(0,i.qA)("ParentOriginWhitelist");return!!n&&(-1!==n.indexOf(t.toLowerCase())||function(t,n){for(var e=0,i=n;e<i.length;e++){var r=i[e],o=t.length-r.length;if(o>=0&&-1!==t.indexOf(r,o))return!0}return!1}(t.toLowerCase(),n))}(t)}var s=e(4851),a=function(){function t(t,n){var e=this;this.handlers=[],this.wt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.handlers.reduce((function(n,e){if(e)return e.apply(void 0,t)}),void 0)},n&&this.subscribe(n),this.St=t,t(this.wt)}return t.prototype.subscribe=function(t){var n=this;return this.handlers.push(t),(0,s.Rm)((function(){var e=n.handlers.indexOf(t);e>-1&&n.handlers.splice(e,1)}))},t.prototype.subscribeAtFirst=function(t){var n=this;return this.handlers.unshift(t),(0,s.Rm)((function(){var e=n.handlers.indexOf(t);e>-1&&n.handlers.splice(e,1)}))},t.prototype.reset=function(){this.St(this.wt)},t}(),u=(0,s.Rm)((function(){return new a((function(t){window.onbeforeunload=t}),window.onbeforeunload)})),c=function(){function t(){this.Nt=!0}return t.getInstance=function(){return t._instance||(t._instance=new t)},t.prototype.blockUnload=function(){return this.Nt?u().subscribe((function(){return""})):function(){}},t.prototype.forceUnblockUnload=function(t){void 0===t&&(t=!1),u().subscribe((function(){return null})),u().reset(),this.Nt=!t},t}();function l(){return c.getInstance()}var f,h=e(94290),d=e(9947),m=e(916),v=e(37890),g=e(72317),p=e(31442),b=e(73252),y=e(20987),w=e(81620),S=e(47393),N=e(76669),C=e(46008),I=e(92528),T=e(7614),k=e(59469),x=0,F=null;function P(){window.formsRefreshAuthTokenCallbacks||(window.formsRefreshAuthTokenCallbacks=[]);return(0,k.W3)((function(){return(0,g.a)().AuthContext.hasUserLoggedIn()}),(function(){l().forceUnblockUnload(!0),(0,g.a)().AuthContext.signIn().then(S.iv)}))}function D(t,n){return new Promise((function(e,i){var r="detect-user-loggedIn-frame";if(window.formsDetectUserLoggedInCallback)i();else{var o="Msa"===t,s=o?"Auth.DetectUserLoggedInMSA":"Auth.DetectUserLoggedInAAD",a=new m.o(s);a.start();var u=(0,d.k0)(),c=u.signInLinkSilentMsa,l=u.signInLinkSilent,f=o?c:l;n&&(f=(0,w.y)(f,o?"username":"login_hint",encodeURIComponent(n))),window.formsDetectUserLoggedInCallback=function(t,n){window.formsDetectUserLoggedInCallback=void 0,a.end({resultType:n?"ExpectedFailure":"Success",extraData:{loggedIn:t}});var i=document.getElementById(r);null==i||i.remove(),e(t)},function(t,n){var e=document.createElement("iframe");return e.id=t,e.style.display="none",e.src=n,document.body.append(e),e}(r,f).contentWindow.addEventListener("load",(function(){window.setTimeout((function(){window.formsDetectUserLoggedInCallback&&window.formsDetectUserLoggedInCallback(!1,!0)}),5e3)}))}}))}function M(){if((0,y.dY)()||(0,y.LG)()||(0,y.Av)()){if(f||(f=new v.wU),!(0,y.LG)()&&!(0,y.Av)()&&F&&F.isAccessTokenFromHostValid()){var t=F.getAccessToken();return f.resolve(t),f.promise()}return f.states()!==v.Cb.Pending&&(f=new v.wU),function(){F=null,window.addEventListener("message",L,!1);var t="*";(0,b.cr)("FixEslintPostMessageError")&&(!(t=(0,C.LU)())||t&&!o(t))&&((0,p.$U)("Warning.HostOrigin.GetAccessTokenFromHost",{error:"Parent origin doesn't exist in whitelist",origin:t}),t="*");window.parent.postMessage("GetAccessTokenFromHost",t)}(),x=0,A(),f.promise()}return(0,C.xO)()?(0,I.y3)().then(null,(function(){return R()})):(0,h.mF)()?(0,N.l4)():R()}function L(t){if(t.data&&"string"==typeof t.data&&t.data.startsWith("FormsAccessTokenFromHost:"))try{var n="FormsAccessTokenFromHost:Bearer ",e=t.data.indexOf(n);if(-1!==e){var i=t.data.substring(e+n.length);F=new E(i)}}finally{window.removeEventListener("message",L,!1)}}function R(){return Promise.resolve(null)}function A(){if(null!=F){var t=F.getAccessToken();(0,T.r)(t).then((function(){return f.resolve(t)}))}else x<10?(x++,window.setTimeout(A,1e3)):(x=0,f.resolve(null))}var E=function(){function t(t){this.Ct=t;this.It=(new Date).getTime()+33e5}return t.prototype.getAccessToken=function(){return this.Ct},t.prototype.isAccessTokenFromHostValid=function(){return!!this.Ct&&(new Date).getTime()<this.It},t}()},59469:function(t,n,e){"use strict";e.d(n,{D1:function(){return h},W3:function(){return l},ad:function(){return d},hh:function(){return c},xO:function(){return f}});var i=e(59749),r=e(64459),o=e(9947),s=e(916),a=e(81620),u=e(47393);function c(t){if(401===(t&&t.response&&t.response.statusCode)){if(t&&t.response&&"Expired"===(0,a.jL)(t.response.headers,"X-FailureReason"))return!0;var n=t&&t.response&&(0,r.d)(t.response.body);if(711===(n&&n.error&&parseInt(n.error.code)))return!0}return!1}function l(t,n){var e=(0,o.k0)().signInLinkSilent,r=(0,o.k0)().signInLinkSilentMsa;return new Promise((function(a){if(window.formsRefreshAuthTokenCallbacks||(window.formsRefreshAuthTokenCallbacks=[]),window.formsRefreshAuthTokenCallbacks.push((function(t,e){!e&&t?a():n()})),!window.formsRefreshAuthTokenCallback){var u=new s.o("Auth.RefreshToken");u.start();var c=function(t,n){try{u.end({extraData:{loggedIn:t},resultType:n?"ExpectedFailure":"Success"});var e=document.querySelector("#refreshAuthTokenFrame");e&&e.parentNode.removeChild(e);var i=window.formsRefreshAuthTokenCallbacks;i&&(n?i&&i.length>0&&i[0](t,n):i.forEach((function(e){return e(t,n)})))}finally{window.formsRefreshAuthTokenCallback=void 0,window.formsRefreshAuthTokenCallbacks=void 0}};if(t()){var l=(0,o.k0)().userInfo.IsMsa?r:e,f=document.createElement("iframe");f.id="refreshAuthTokenFrame",f.setAttribute("style","display: none;"),(0,i.M5)(f,l);var h=function(){window.formsRefreshAuthTokenCallback&&window.formsRefreshAuthTokenCallback(!1,!0)};f.onload=function(){window.setTimeout(h,5e3)},window.setTimeout(h,5e3),window.formsRefreshAuthTokenCallback=c,document.body.appendChild(f)}else c(!1,!0)}}))}function f(t){if(401===(t&&t.response&&t.response.statusCode)){var n=t&&t.response&&(0,r.d)(t.response.body);if(718===(n&&n.error&&parseInt(n.error.code)))return!0}return!1}function h(t){if(401===(t&&t.response&&t.response.statusCode)){var n=t&&t.response&&(0,a.jL)(t.response.headers,"WWW-Authenticate");return n&&-1!==n.indexOf("invalid_token")}return!1}function d(){var t=window.location.href,n=t.replace(/^https:\/\/forms\.microsoft(-int)?\.com/,"https://forms.office$1.com");t!==n&&(0,u.mj)(n)}},49211:function(t,n,e){"use strict";e.d(n,{w:function(){return u}});var i=e(12611),r=e(29952),o=e(9947),s=e(72420),a=e(67661);function u(t,n){var e;if((0,s.HD)(t))e=t;else if(t){var u=t;if(u.isFieldReady(a.x.Schema.OwnerId)&&!u.IsGroupForm&&u.Model.OwnerId!==(0,o.k0)().userInfo.UserId)return!1;u.isFieldReady(a.x.Schema.Category)&&(e=u.Model.Category),u.isFieldReady(a.x.Schema.Type)&&!(0,r.Oy)()&&("approval"===u.Model.Type?e="Approval":"reports"===u.Model.Type&&(e="Reports"))}return!!e&&i.contains({"Loop Poll":["DisableEditForm"],Poll:["Settings.AllowResponderGetAllResponses","DisableEditForm","ResponsePage.PollView"],"Teams Poll":["DisableEditForm"],Approval:["DisableEditForm"],Reports:["DisableEditForm"]}[e],n)}},46571:function(t,n,e){"use strict";e.d(n,{Y:function(){return i},g:function(){return u}});var i,r,o=e(78587),s=e(9947),a=e(31442);function u(t){return function(t){return new Promise((function(n,e){void 0===r&&(r={DesignPage:(0,o.oE)((0,s.k0)().scriptName+".min.css",!0),DesignPageRtl:(0,o.oE)((0,s.k0)().scriptName+".rtl.min.css",!0),MobileDesignPage:(0,o.oE)((0,s.k0)().scriptName+".min.css",!0),MobileDesignPageRtl:(0,o.oE)((0,s.k0)().scriptName+".rtl.min.css",!0),ResponsePage:(0,o.oE)((0,s.k0)().responsePageCssName+"min.css",!0),ResponsePageRtl:(0,o.oE)((0,s.k0)().responsePageCssName+"rtl.min.css",!0)});var u=r[i[t]];if(!u)throw Error("No path for "+i[t]);var c=document.getElementsByTagName("head")[0];if(!c)return e(Error("No head element found!"));var l=document.createElement("link");l.rel="stylesheet",l.href=u;var f="form-page-css",h=document.getElementById(f),d=$(h).attr("href");if(d&&u.toLowerCase()===d.toLowerCase())return n();h&&c.removeChild(h),l.id=f,l.onload=function(t){return n()},l.onerror=function(){c.removeChild(l),(0,a.$U)("Error.CssLoadingError.FailedToLoadCss",{name:i[t],url:u}),e(Error("Failed to load css file: "+u))},c.appendChild(l)}))}(t)}!function(t){t[t.DesignPage=0]="DesignPage",t[t.DesignPageRtl=1]="DesignPageRtl",t[t.ResponsePage=2]="ResponsePage",t[t.ResponsePageRtl=3]="ResponsePageRtl",t[t.MobileDesignPage=4]="MobileDesignPage",t[t.MobileDesignPageRtl=5]="MobileDesignPageRtl"}(i||(i={}))},55411:function(t,n,e){"use strict";e.d(n,{HA:function(){return d},Kc:function(){return p},Pq:function(){return l},WT:function(){return c},_C:function(){return v},lz:function(){return g},sv:function(){return h},xi:function(){return m},y:function(){return f}});var i=e(96078),r=e(63795),o=e(60211),s=e(64290),a=e(73252),u=e(90710);function c(){return(0,a.cr)("EnableCustomerVoice")&&!(0,a.cr)("CustomerVoiceBlackList")}function l(){return window.location.host.toLocaleLowerCase().indexOf("customervoice.microsoft.us")>=0}function f(){var t=(0,o.kD)();return"CVInt"===t||"CVProd"===t||"CVTip"===t||"CVFastfood"===t||"CVDaily"===t||l()}function h(){return"/pages/mobiledesignpage.aspx"===window.location.pathname.toLowerCase()}function d(){return(0,s.pd)(i.Z,s.t1)}function m(){return(0,r.WU)("https://portal.{0}/account/#personalinfo",(0,o.yv)()?b((0,o.kD)(),!0):b("Int",!0))}function v(){return(0,r.WU)("https://account.{0}",(0,o.yv)()?y((0,o.kD)()):y("Trial"))}function g(t){return"lists."+b(t)}function p(){return(0,u.NW)().lang||null}function b(t,n){switch(void 0===n&&(n=!1),null==t&&(t=(0,o.kD)()),t){case"USNat":return n?"eaglex.ic.gov":"osi.eaglex.ic.gov";case"USSec":return n?"microsoft.scloud":"osi.microsoft.scloud";case"USDoDProd":return n?"apps.mil":"osi.apps.mil";case"USGovProd":return n?"office365.us":"osi.office365.us";case"USGovGccProd":return n?"office.com":"gcc.osi.office365.us";case"WWProd":case"MSProd":case"ProTip":case"CVProd":case"CVTip":case"CVFastfood":return"office.com";case"Trial":return"officeppe.com";default:return"office-int.com"}}function y(t){switch(null==t&&(t=(0,o.kD)()),t){case"WWProd":case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return"microsoft.com";case"Trial":return"microsoft-ppe.com";default:return"microsoft-int.com"}}},73252:function(t,n,e){"use strict";e.d(n,{VE:function(){return f},cr:function(){return d},$O:function(){return v},g:function(){return m},M0:function(){return l},E:function(){return b},_y:function(){return p},Gs:function(){return h},Be:function(){return y}});var i,r=e(9947),o=e(75827),s=e(83894),a=e(90710);!function(t){t[t.ResponsePage=1]="ResponsePage",t[t.TeamsResponsePage=2]="TeamsResponsePage",t[t.AssignmentResponsePage=4]="AssignmentResponsePage"}(i||(i={}));var u,c=e(72317);function l(){return g(i.ResponsePage)&&!p()}function f(){return g(i.ResponsePage|i.TeamsResponsePage|i.AssignmentResponsePage)&&!p()}function h(){return l()}function d(t){try{return(0,c.a)().Flighting.isEnabled(t)}catch(t){return!1}}function m(){return d("FirstReleaseClientEnabled")}function v(){return(0,o.$O)()}function g(t){return 0!=(u&t)}function p(){return!!(0,r.k0)().proEnabled&&d("FormsPro")}function b(){return!(0,s.ro)()}function y(){var t=(0,a.NW)(),n="1"===t.disablel1,e=t.origin,i=t.prevorigin,r="OfficeDotCom"===e||"OfficeDotComPrv"===e||"OfficeDotCom"===i||"OfficeDotComPrv"===i,o=d("DeprecateOfficeDotComTreatment");return!(n||!o&&r)}},94978:function(t,n,e){"use strict";e.d(n,{Gw:function(){return l},QJ:function(){return f},qA:function(){return h},vj:function(){return d}});var i,r=e(59312),o=e(4851),s=e(9947),a=e(9754),u={},c=(0,o.Rm)(a.kz);function l(t){var n,e;if(!window.OfficeFormServerInfo)return u[t]||"";if(void 0===i){try{i=JSON.parse(decodeURI((0,s.k0)().webSettings||"{}"))}catch(t){i={}}i=(0,r.pi)((0,r.pi)({},i),c())}return null!==(e=null!==(n=i[t])&&void 0!==n?n:u[t])&&void 0!==e?e:""}function f(t,n){void 0===n&&(n=null);var e=l(t);if(e)try{return JSON.parse(e)}catch(t){}return n}function h(t){var n=l(t);if(n)try{var e=JSON.parse(n);if(Array.isArray(e))return e}catch(t){return null}return null}function d(t,n){var e=l(t);if(e){var i=parseInt(e);if(!isNaN(i))return i}return n}function m(t,n){u[t]=n}m("CustomerVoiceTransitionCompletionDate","08/30/2020"),m("CustomerVoiceUrl","https://customervoice.microsoft-int.com")},57411:function(t,n,e){"use strict";e.d(n,{BP:function(){return m},EA:function(){return c},M5:function(){return h},eT:function(){return d},gq:function(){return f},p3:function(){return a},tE:function(){return l},x_:function(){return u}});var i=e(60211),r=e(37076),o=null,s=null;function a(t){o=t}function u(){return o&&o()}function c(t){s=t}function l(){return s&&s()}function f(){var t=(0,r.kc)(u()||"");return!!t.OrgId&&t.OrgId.toLowerCase()===(0,i.rq)()}function h(){var t=(0,r.kc)(u()||"");return!!t.OrgId&&t.OrgId.toLowerCase()===(0,i.Fc)()}function d(){var t=(0,r.kc)(u()||"");return!!t.OrgId&&-1!==(0,i.iI)().indexOf(t.OrgId.toLowerCase())}function m(){var t=u();return t&&(0,r.kc)(t)}},9754:function(t,n,e){"use strict";e.d(n,{EG:function(){return c},dR:function(){return u},kz:function(){return a}});var i,r=e(64459),o=e(9947);function s(t){var n=t||(0,o.k0)().ecsWebSettings||{};return"string"==typeof n&&(n=(0,r.d)(n)),"object"==typeof n&&!Array.isArray(n)&&n||(n={}),n}function a(t){var n=s(t),e={};return Object.keys(n).forEach((function(t){e[t]="string"!=typeof n[t]?JSON.stringify(n[t]):n[t]})),e}function u(t){return void 0===i&&(i=s()),i[t]}function c(t){i=s(t),!0}},7899:function(t,n,e){"use strict";e.d(n,{y:function(){return d},m:function(){return m}});var i=e(78587),r=e(9947),o=e(59749);var s,a,u,c,l,f={},h=(s=(0,r.k0)(),a=s.scriptSuffix,u=s.isCdnEnabled,c={"combined-design":u?"Vendors/combinedmin/design_v3.min.js":"Vendors/combined/design_v3_aabaaa2.js","combined-response":u?"Vendors/combinedmin/response_v2.min.js":"Vendors/combined/response_v2_5234a19.js",DataTables:"Vendors/DataTables."+a,Chart:"Vendors/Chart-2.6."+a,Clipboard:"Vendors/clipboard-1.7.1.min.js",ColorThief:"Vendors/color-thief/color-thief.min.js",D3:"Vendors/d3/d3."+a,ImmersiveReader:"Vendors/ImmersiveReader/immersive-reader-sdk.0.0.2.min.js",JQuery_RateIt:"Vendors/rating-1.1.0/jquery.rateit."+a,JQuery_QRCode:"Vendors/jquery.qrcode.min.js",MathJax:(l="".concat(window.location.origin,"/scripts/vendors/mathjax/MathJax.js?config=TeX-AMS_HTML"),l),MathQuill:"Vendors/mathquill/mathquill."+a,O365ShellBootstrap:v(),Mark:"Vendors/markjs-8.9.0/mark."+a,SignalR:"Vendors/SignalR/jquery.signalR-2.4.1.min.js",Sortable:"Vendors/sortablejs-1.8.4/Sortable.modified."+a},Object.keys(c).reduce((function(t,n){return t[n]=function(t,n){return g(t)?(0,i.oE)(n,!1):n||""}(n,c[n]),t}),{}));function d(t){return f[t]||(f[t]=function(t){return function(t,n,e){return new Promise((function(i,r){if(!t)throw Error("No script path for "+t);var s=document.getElementsByTagName("head")[0];if(!s)return r(Error("No head element found!"));var a=document.createElement("script");a.type="text/javascript",a.async=!0,(0,o.M5)(a,t),n&&e&&(a.crossOrigin="anonymous"),a.onload=function(){return i()},a.onerror=function(){s.removeChild(a),r(Error("Failed to load javascript file: "+t))},s.appendChild(a)}))}(h[t],(0,r.k0)().isCdnEnabled,g(t))}(t)),f[t]}function m(t){return Promise.all(t.map(d))}function v(){var t=(0,r.k0)(),n=t.o365ShellBootHost,e=t.o365ShellBootstrapperUrl;return n?e||n.concat("/api/shellbootstrapper/",(0,r.k0)().userInfo.IsMsa?"consumer":"business","/oneshell"):""}function g(t){return["MathJax","O365ShellBootstrap"].indexOf(t)<0}},17290:function(t,n,e){"use strict";function i(t){t.trigger("focus")}e.d(n,{x:function(){return i}})},77356:function(t,n,e){"use strict";e.d(n,{z:function(){return s}});var i=e(72377);var r=e(57411),o=e(94978);function s(t){(0,r.M5)()||i.Pv.Resolve("IThirdPartyLinkify").then((function(){return function(t){t.linkify();var n=/^[a-z0-9]\.|\.xxx/i,e=(0,o.Gw)("LinkifyEscapeRegex");e&&(n=new RegExp(e,"i"));t.find("a.linkified").each((function(t,e){$(e).text().match(n)&&$(e).contents().unwrap()}))}(t)}))}},51254:function(t,n,e){"use strict";e.d(n,{I0:function(){return u},WW:function(){return s},d6:function(){return c}});var i,r=e(37890),o=e(61018),s="ClientMSGraph.";function a(){i=new r.bC((0,o.d8)().getOD4BToken())}function u(){return i&&i.states()!==r.Cb.Rejected||a(),i.promise()}function c(t){return u().then(t).catch((function(n){if(n&&n.response&&401===n.response.statusCode)return(i&&i.states()===r.Cb.Pending||a(),i.promise()).then(t);throw n}))}"undefined"!=typeof FormsPro&&(FormsPro.sendRequestWithToken=c)},21607:function(t,n,e){"use strict";e.d(n,{Ip:function(){return d},RC:function(){return g},Yq:function(){return m},h6:function(){return h},sE:function(){return v},v9:function(){return p}});var i=e(9947),r=e(916),o=e(41480),s=e(84475),a=e(63795),u=e(77209),c=(e(64290),e(31442)),l=e(55411),f=e(9754);function h(t){var n;return t&&(n="lang="+t),function(t,n,e){return y(t,n,e,void 0)}("GetResourceStrings",n,void 0)}function d(){return h((0,l.Kc)())}function m(t){var n;return t&&"string"==typeof t&&(n=b(t)),y("GetRefreshedAntiForgeryToken",void 0,void 0,n).then((function(t){(0,i.cm)({antiForgeryToken:t})}))}function v(){return y("GetUserInfo",void 0,void 0,void 0).then((function(t){(0,i.cm)({userInfo:t})}))}function g(t){return y("GetThemes",void 0,JSON.stringify({name:t||""}),void 0)}function p(t){return t||(0,c.RF)("InvalidToken"),w("/Handlers/PageCommonHandler.ashx?method=GetCombined",void 0,b(t),"GetCombinedInfo").then((function(t){if(t){var n={ecsConfigSettings:t.ecsConfigSettings,flights:t.flight,userInfo:t.userInfo,environmentType:t.environmentType,ring:t.ring};t.antiForgeryToken&&(n.antiForgeryToken=t.antiForgeryToken),t.ecsWebSettings&&t.userInfo.UserId&&(n.ecsWebSettings=JSON.parse(t.ecsWebSettings)),(0,i.cm)(n),t.userInfo.UserId&&(0,f.EG)(n.ecsWebSettings)}}))}function b(t){return{Accept:"application/json",Authorization:(0,u.U)(t)}}function y(t,n,e,i){var r;return r="/"===window.location.pathname?"/Default.aspx/".concat(t):"".concat(window.location.pathname,"/").concat(t),n&&(r+="?"+n),w(r,e,i,(0,a.WU)("PageMethod.{0}",t)).then((function(t){return t.d}))}function w(t,n,e,i){return new Promise((function(a,u){var c=new r.o(i),l=new XMLHttpRequest;l.open("POST",t),l.setRequestHeader("content-type","application/json; charset=utf-8"),l.setRequestHeader("X-CorrelationId",c.CorrelationId),l.setRequestHeader("X-UserSessionId",(0,o.k)()||""),l.setRequestHeader("x-ms-form-request-source",(0,s.A)()),e&&Object.keys(e).forEach((function(t){l.setRequestHeader(t,e[t])})),c.start(),n?l.send(n):l.send(),l.onreadystatechange=function(){if(l.readyState===XMLHttpRequest.DONE){var n=l.status;200===n||202===n||201===n?(c.end({resultType:"Success",extraData:{status:l.statusText}}),a(l.responseText&&JSON.parse(l.responseText))):(c.end({resultType:"Failure",extraData:{url:t,message:l.statusText}}),u(l.statusText))}}}))}},24821:function(t,n,e){"use strict";e.d(n,{f:function(){return i}});var i=function(){function t(t){var n=this;this.prefetchPromise=new Promise((function(t,e){n.prefetchResolve=t,n.prefetchReject=e})),this.cache=t}return t.prototype.init=function(){if(this.cache)switch(this.cache.state){case 3:this.onPrefetchSucceed();break;case 4:this.onPrefetchFaied();break;case 2:this.cache.successCallback=this.onPrefetchSucceed.bind(this),this.cache.errorCallback=this.onPrefetchFaied.bind(this);break;default:this.fallBackToNormalBoot()}else this.fallBackToNormalBoot()},t.prototype.getPromise=function(){return this.prefetchPromise},t}()},22617:function(t,n,e){"use strict";e.d(n,{D:function(){return r}});var i=e(7645);function r(t,n){var e=null!=n?n:(0,i.pm)();switch(t){case"1001":return e.Error_Message_1001;case"10203":return e.Error_Message_10203;case"10204":return e.Error_Message_10204;case"10205":return e.Error_Message_10205;case"10206":return e.Error_Message_10206;case"10207":return e.Error_Message_10207;case"10208":return e.Error_Message_10208;case"10300":return e.Error_Message_10300;case"10301":return e.Error_Message_10301;case"1204":return e.Error_Message_1204;case"15001":return e.Error_Message_15001;case"15003":return e.Error_Message_15003;case"15429":return e.Error_Message_15429;case"1624":return e.Error_Message_1624;case"20000":return e.Error_Message_20000;case"20001":return e.Error_Message_20001;case"5001":return e.Error_Message_5001;case"5002":return e.Error_Message_5002;case"5003":return e.Error_Message_5003;case"5004":return e.Error_Message_5004;case"5005":return e.Error_Message_5005;case"5006":return e.Error_Message_5006;case"5109":return e.Error_Message_5109;case"5114":return e.Error_Message_5114;case"5117":return e.Error_Message_5117;case"5203":return e.Error_Message_5203;case"5204":return e.Error_Message_5204;case"5205":return e.Error_Message_5205;case"5206":return e.Error_Message_5206;case"5207":return e.Error_Message_5207;case"5208":return e.Error_Message_5208;case"5209":return e.Error_Message_5209;case"5302":return e.Error_Message_5302;case"532":return e.Error_Message_532;case"533":return e.Error_Message_533;case"534":return e.Error_Message_534;case"535":return e.Error_Message_535;case"536":return e.Error_Message_536;case"537":return e.Error_Message_537;case"5400":return e.Error_Message_5400;case"5401":return e.Error_Message_5401;case"5402":return e.Error_Message_5402;case"5403":return e.Error_Message_5403;case"5501":return e.Error_Message_5501;case"5503":return e.Error_Message_5503;case"5504":return e.Error_Message_5504;case"5510":return e.Error_Message_5510;case"5550":return e.Error_Message_5550;case"5551":return e.Error_Message_5551;case"5552":return e.Error_Message_5552;case"5553":return e.Error_Message_5553;case"5554":return e.Error_Message_5554;case"5556":return e.Error_Message_5556;case"5557":return e.Error_Message_5557;case"5558":return e.Error_Message_5558;case"5559":return e.Error_Message_5559;case"5560":return e.Error_Message_5560;case"5561":return e.Error_Message_5561;case"600":return e.Error_Message_600;case"601":return e.Error_Message_601;case"602":return e.Error_Message_602;case"603":return e.Error_Message_603;case"604":return e.Error_Message_604;case"605":return e.Error_Message_605;case"606":return e.Error_Message_606;case"607":return e.Error_Message_607;case"608":return e.Error_Message_608;case"609":return e.Error_Message_609;case"610":return e.Error_Message_610;case"6100":return e.Error_Message_6100;case"6102":return e.Error_Message_6102;case"6103":return e.Error_Message_6103;case"6105":return e.Error_Message_6105;case"611":return e.Error_Message_611;case"613":return e.Error_Message_613;case"614":return e.Error_Message_614;case"615":return e.Error_Message_615;case"620":return e.Error_Message_620;case"622":return e.Error_Message_622;case"624":return e.Error_Message_624;case"625":return e.Error_Message_625;case"6252":return e.Error_Message_6252;case"6254":return e.Error_Message_6254;case"636":return e.Error_Message_636;case"642":return e.Error_Message_642;case"645":return e.Error_Message_645;case"649":return e.Error_Message_649;case"650":return e.Error_Message_650;case"651":return e.Error_Message_651;case"652":return e.Error_Message_652;case"653":return e.Error_Message_653;case"654":return e.Error_Message_654;case"655":return e.Error_Message_655;case"656":return e.Error_Message_656;case"657":return e.Error_Message_657;case"658":return e.Error_Message_658;case"659":return e.Error_Message_659;case"660":return e.Error_Message_660;case"6611":return e.Error_Message_6611;case"6612":return e.Error_Message_6612;case"6613":return e.Error_Message_6613;case"6614":return e.Error_Message_6614;case"6624":return e.Error_Message_6624;case"6700":return e.Error_Message_6700;case"6701":return e.Error_Message_6701;case"6702":return e.Error_Message_6702;case"6705":return e.Error_Message_6705;case"674":return e.Error_Message_674;case"676":return e.Error_Message_676;case"700":return e.Error_Message_700;case"701":return e.Error_Message_701;case"702":return e.Error_Message_702;case"703":return e.Error_Message_703;case"704":return e.Error_Message_704;case"705":return e.Error_Message_705;case"707":return e.Error_Message_707;case"709":return e.Error_Message_709;case"710":return e.Error_Message_710;case"711":return e.Error_Message_711;case"712":return e.Error_Message_712;case"714":return e.Error_Message_714;case"715":return e.Error_Message_715;case"717":return e.Error_Message_717;case"720":return e.Error_Message_720;case"751":return e.Error_Message_751;case"752":return e.Error_Message_752;case"754":return e.Error_Message_754;case"755":return e.Error_Message_755;case"756":return e.Error_Message_756;case"812":return e.Error_Message_812;case"824":return e.Error_Message_824;default:return""}}},44286:function(t,n,e){"use strict";e.d(n,{U:function(){return r}});var i=e(7645);function r(t,n){var e=null!=n?n:(0,i.pm)();switch(t){case"Abstract_Shapes":return e.Theme_Name_Abstract_Shapes;case"Abstract_Streamers":return e.Theme_Name_Abstract_Streamers;case"Abstract_Streamers_2":return e.Theme_Name_Abstract_Streamers_2;case"Astronomy":return e.Theme_Name_Astronomy;case"Birthday_Balloon":return e.Theme_Name_Birthday_Balloon;case"Birthday_Cool":return e.Theme_Name_Birthday_Cool;case"Birthday_Dinosaur":return e.Theme_Name_Birthday_Dinosaur;case"Birthday_Doggy":return e.Theme_Name_Birthday_Doggy;case"Birthday_Sprinkle":return e.Theme_Name_Birthday_Sprinkle;case"Bright_Blue":return e.Theme_Name_Bright_Blue;case"Bright_Green":return e.Theme_Name_Bright_Green;case"CV_Black":return e.Theme_Name_CV_Black;case"CV_Blue":return e.Theme_Name_CV_Blue;case"CV_Dark_Blue":return e.Theme_Name_CV_Dark_Blue;case"CV_Dark_Green":return e.Theme_Name_CV_Dark_Green;case"CV_Dark_Grey":return e.Theme_Name_CV_Dark_Grey;case"CV_Dark_Orange":return e.Theme_Name_CV_Dark_Orange;case"CV_Dark_Purple":return e.Theme_Name_CV_Dark_Purple;case"CV_Dark_Teal":return e.Theme_Name_CV_Dark_Teal;case"CV_Green":return e.Theme_Name_CV_Green;case"CV_Light_Blue":return e.Theme_Name_CV_Light_Blue;case"CV_Light_Orange":return e.Theme_Name_CV_Light_Orange;case"CV_Orange":return e.Theme_Name_CV_Orange;case"CV_Purple":return e.Theme_Name_CV_Purple;case"CV_Sapphire":return e.Theme_Name_CV_Sapphire;case"CV_Teal":return e.Theme_Name_CV_Teal;case"CV_Yellow":return e.Theme_Name_CV_Yellow;case"Camera":return e.Theme_Name_Camera;case"Chemistry":return e.Theme_Name_Chemistry;case"City01":return e.Theme_Name_City01;case"City02":return e.Theme_Name_City02;case"Colorful_Pencils":return e.Theme_Name_Colorful_Pencils;case"Dark_Orange":return e.Theme_Name_Dark_Orange;case"GetTogethers_Book":return e.Theme_Name_GetTogethers_Book;case"GetTogethers_Celebration":return e.Theme_Name_GetTogethers_Celebration;case"GetTogethers_Game":return e.Theme_Name_GetTogethers_Game;case"GetTogethers_Movie":return e.Theme_Name_GetTogethers_Movie;case"GetTogethers_Sports":return e.Theme_Name_GetTogethers_Sports;case"Green_Round_Shapes":return e.Theme_Name_Green_Round_Shapes;case"Holidays_Calendar":return e.Theme_Name_Holidays_Calendar;case"Holidays_Cheers":return e.Theme_Name_Holidays_Cheers;case"Holidays_Doggy":return e.Theme_Name_Holidays_Doggy;case"Holidays_Fireworks":return e.Theme_Name_Holidays_Fireworks;case"Holidays_Snow":return e.Theme_Name_Holidays_Snow;case"Linellae":return e.Theme_Name_Linellae;case"Live_Blue_Light":return e.Theme_Name_Live_Blue_Light;case"Live_Blue_Orange_Square":return e.Theme_Name_Live_Blue_Orange_Square;case"Live_Empty_Office":return e.Theme_Name_Live_Empty_Office;case"Live_Mint_Wall_Room":return e.Theme_Name_Live_Mint_Wall_Room;case"Live_Study_Book":return e.Theme_Name_Live_Study_Book;case"Medium_Dark_Blue":return e.Theme_Name_Medium_Dark_Blue;case"Meeting":return e.Theme_Name_Meeting;case"Ocean":return e.Theme_Name_Ocean;case"Office":return e.Theme_Name_Office;case"Office2":return e.Theme_Name_Office2;case"Office_Stationery":return e.Theme_Name_Office_Stationery;case"Office_Stationery_2":return e.Theme_Name_Office_Stationery_2;case"Orange":return e.Theme_Name_Orange;case"Pink":return e.Theme_Name_Pink;case"Pomegranate":return e.Theme_Name_Pomegranate;case"Radiating_Lines":return e.Theme_Name_Radiating_Lines;case"Raspberry":return e.Theme_Name_Raspberry;case"Royal_Blue":return e.Theme_Name_Royal_Blue;case"Ski":return e.Theme_Name_Ski;case"Sky":return e.Theme_Name_Sky;case"SmallCard_CelebrationClaps":return e.Theme_Name_SmallCard_CelebrationClaps;case"SmallCard_HappyHour_Food":return e.Theme_Name_SmallCard_HappyHour_Food;case"SmallCard_Reunion_People":return e.Theme_Name_SmallCard_Reunion_People;case"SmallCard_TeamMorale_Hands":return e.Theme_Name_SmallCard_TeamMorale_Hands;case"SmallCard_Wedding_Flowers":return e.Theme_Name_SmallCard_Wedding_Flowers;case"Squares":return e.Theme_Name_Squares;case"Suggest_Abstract_Art":return e.Theme_Name_Suggest_Abstract_Art;case"Suggest_Adult_Group":return e.Theme_Name_Suggest_Adult_Group;case"Suggest_Adult_Man":return e.Theme_Name_Suggest_Adult_Man;case"Suggest_Adult_Woman":return e.Theme_Name_Suggest_Adult_Woman;case"Suggest_Airplane":return e.Theme_Name_Suggest_Airplane;case"Suggest_Application_Shopping":return e.Theme_Name_Suggest_Application_Shopping;case"Suggest_Balloon_Cloud":return e.Theme_Name_Suggest_Balloon_Cloud;case"Suggest_Balloon_Fun":return e.Theme_Name_Suggest_Balloon_Fun;case"Suggest_Banana_Blue":return e.Theme_Name_Suggest_Banana_Blue;case"Suggest_Basketball":return e.Theme_Name_Suggest_Basketball;case"Suggest_Beach_Sand":return e.Theme_Name_Suggest_Beach_Sand;case"Suggest_Beach_Water":return e.Theme_Name_Suggest_Beach_Water;case"Suggest_Birthday_Celebration":return e.Theme_Name_Suggest_Birthday_Celebration;case"Suggest_Birthday_Party":return e.Theme_Name_Suggest_Birthday_Party;case"Suggest_Blur_Education":return e.Theme_Name_Suggest_Blur_Education;case"Suggest_Blur_Man":return e.Theme_Name_Suggest_Blur_Man;case"Suggest_Book_Stack":return e.Theme_Name_Suggest_Book_Stack;case"Suggest_Breakfast_Fruit":return e.Theme_Name_Suggest_Breakfast_Fruit;case"Suggest_Brush_Paper":return e.Theme_Name_Suggest_Brush_Paper;case"Suggest_Business_Office":return e.Theme_Name_Suggest_Business_Office;case"Suggest_Business_People0":return e.Theme_Name_Suggest_Business_People0;case"Suggest_Business_Text0":return e.Theme_Name_Suggest_Business_Text0;case"Suggest_Cake_Candle":return e.Theme_Name_Suggest_Cake_Candle;case"Suggest_Cake_Hand":return e.Theme_Name_Suggest_Cake_Hand;case"Suggest_Candle_Birthday":return e.Theme_Name_Suggest_Candle_Birthday;case"Suggest_Candle_Flame":return e.Theme_Name_Suggest_Candle_Flame;case"Suggest_Car_Key":return e.Theme_Name_Suggest_Car_Key;case"Suggest_Car_Road":return e.Theme_Name_Suggest_Car_Road;case"Suggest_Car_Roadtrip":return e.Theme_Name_Suggest_Car_Roadtrip;case"Suggest_Car_Run":return e.Theme_Name_Suggest_Car_Run;case"Suggest_Celebration_Decoration":return e.Theme_Name_Suggest_Celebration_Decoration;case"Suggest_Celebration_Light":return e.Theme_Name_Suggest_Celebration_Light;case"Suggest_Chair_Seat":return e.Theme_Name_Suggest_Chair_Seat;case"Suggest_Chalk_Chalkboard":return e.Theme_Name_Suggest_Chalk_Chalkboard;case"Suggest_Chalkboard_Chalk":return e.Theme_Name_Suggest_Chalkboard_Chalk;case"Suggest_Chalkboard_Mathematics":return e.Theme_Name_Suggest_Chalkboard_Mathematics;case"Suggest_Chart_Man":return e.Theme_Name_Suggest_Chart_Man;case"Suggest_Child_Education":return e.Theme_Name_Suggest_Child_Education;case"Suggest_Child_People":return e.Theme_Name_Suggest_Child_People;case"Suggest_Child_Son":return e.Theme_Name_Suggest_Child_Son;case"Suggest_Child_Togetherness":return e.Theme_Name_Suggest_Child_Togetherness;case"Suggest_Children_Activity":return e.Theme_Name_Suggest_Children_Activity;case"Suggest_Children_Grass":return e.Theme_Name_Suggest_Children_Grass;case"Suggest_Children_Portrait":return e.Theme_Name_Suggest_Children_Portrait;case"Suggest_Christmas_Blur":return e.Theme_Name_Suggest_Christmas_Blur;case"Suggest_Christmas_Bow":return e.Theme_Name_Suggest_Christmas_Bow;case"Suggest_Christmas_Food0":return e.Theme_Name_Suggest_Christmas_Food0;case"Suggest_Christmas_Traditional":return e.Theme_Name_Suggest_Christmas_Traditional;case"Suggest_Citrus_Fruit":return e.Theme_Name_Suggest_Citrus_Fruit;case"Suggest_City_Map":return e.Theme_Name_Suggest_City_Map;case"Suggest_Classroom_Student":return e.Theme_Name_Suggest_Classroom_Student;case"Suggest_Classroom_Teacher":return e.Theme_Name_Suggest_Classroom_Teacher;case"Suggest_Climbing_Forest":return e.Theme_Name_Suggest_Climbing_Forest;case"Suggest_Climbing_Team":return e.Theme_Name_Suggest_Climbing_Team;case"Suggest_Clothes_Accessory":return e.Theme_Name_Suggest_Clothes_Accessory;case"Suggest_Clown_Party":return e.Theme_Name_Suggest_Clown_Party;case"Suggest_Coffee_Woman":return e.Theme_Name_Suggest_Coffee_Woman;case"Suggest_Color_Ball":return e.Theme_Name_Suggest_Color_Ball;case"Suggest_Colorful_Pencil":return e.Theme_Name_Suggest_Colorful_Pencil;case"Suggest_Competition_Athlete":return e.Theme_Name_Suggest_Competition_Athlete;case"Suggest_Composition_Business":return e.Theme_Name_Suggest_Composition_Business;case"Suggest_Composition_Paper1":return e.Theme_Name_Suggest_Composition_Paper1;case"Suggest_Composition_Paper2":return e.Theme_Name_Suggest_Composition_Paper2;case"Suggest_Computer_Calendar":return e.Theme_Name_Suggest_Computer_Calendar;case"Suggest_Computer_Table":return e.Theme_Name_Suggest_Computer_Table;case"Suggest_Concert_Music":return e.Theme_Name_Suggest_Concert_Music;case"Suggest_Cone_Group":return e.Theme_Name_Suggest_Cone_Group;case"Suggest_Cup_Indoors":return e.Theme_Name_Suggest_Cup_Indoors;case"Suggest_Cupcake_Candle":return e.Theme_Name_Suggest_Cupcake_Candle;case"Suggest_Cupcake_Unicorn":return e.Theme_Name_Suggest_Cupcake_Unicorn;case"Suggest_Curtain_Velvet":return e.Theme_Name_Suggest_Curtain_Velvet;case"Suggest_Desktop_Art":return e.Theme_Name_Suggest_Desktop_Art;case"Suggest_Desktop_Asphalt":return e.Theme_Name_Suggest_Desktop_Asphalt;case"Suggest_Diagram_Paper":return e.Theme_Name_Suggest_Diagram_Paper;case"Suggest_Donut":return e.Theme_Name_Suggest_Donut;case"Suggest_Education_Classroom1":return e.Theme_Name_Suggest_Education_Classroom1;case"Suggest_Education_Indoors":return e.Theme_Name_Suggest_Education_Indoors;case"Suggest_Education_School":return e.Theme_Name_Suggest_Education_School;case"Suggest_Family_Park":return e.Theme_Name_Suggest_Family_Park;case"Suggest_Family_Play":return e.Theme_Name_Suggest_Family_Play;case"Suggest_Fashion_Design":return e.Theme_Name_Suggest_Fashion_Design;case"Suggest_Father_Children":return e.Theme_Name_Suggest_Father_Children;case"Suggest_Festival_Flame":return e.Theme_Name_Suggest_Festival_Flame;case"Suggest_Flower_Plant":return e.Theme_Name_Suggest_Flower_Plant;case"Suggest_Food_Bag":return e.Theme_Name_Suggest_Food_Bag;case"Suggest_Food_Baking":return e.Theme_Name_Suggest_Food_Baking;case"Suggest_Food_Cheese":return e.Theme_Name_Suggest_Food_Cheese;case"Suggest_Food_Dough":return e.Theme_Name_Suggest_Food_Dough;case"Suggest_Food_Drink":return e.Theme_Name_Suggest_Food_Drink;case"Suggest_Food_Leaf0":return e.Theme_Name_Suggest_Food_Leaf0;case"Suggest_Food_Meal":return e.Theme_Name_Suggest_Food_Meal;case"Suggest_Food_Wood":return e.Theme_Name_Suggest_Food_Wood;case"Suggest_Food_Wood0":return e.Theme_Name_Suggest_Food_Wood0;case"Suggest_Foot":return e.Theme_Name_Suggest_Foot;case"Suggest_Fruit_Vegetable":return e.Theme_Name_Suggest_Fruit_Vegetable;case"Suggest_Fun_Color":return e.Theme_Name_Suggest_Fun_Color;case"Suggest_Gift1":return e.Theme_Name_Suggest_Gift1;case"Suggest_Gift_Balloon":return e.Theme_Name_Suggest_Gift_Balloon;case"Suggest_Gift_Color":return e.Theme_Name_Suggest_Gift_Color;case"Suggest_Gift_Pink":return e.Theme_Name_Suggest_Gift_Pink;case"Suggest_Gift_Purple":return e.Theme_Name_Suggest_Gift_Purple;case"Suggest_Glass_Tropical0":return e.Theme_Name_Suggest_Glass_Tropical0;case"Suggest_Graduation_Accomplishment1":return e.Theme_Name_Suggest_Graduation_Accomplishment1;case"Suggest_Graduation_Accomplishment2":return e.Theme_Name_Suggest_Graduation_Accomplishment2;case"Suggest_Graphic_Design_Architecture":return e.Theme_Name_Suggest_Graphic_Design_Architecture;case"Suggest_Grass_People":return e.Theme_Name_Suggest_Grass_People;case"Suggest_Hamburger_Food":return e.Theme_Name_Suggest_Hamburger_Food;case"Suggest_Hand_Woman":return e.Theme_Name_Suggest_Hand_Woman;case"Suggest_Hot_Air_Balloon1":return e.Theme_Name_Suggest_Hot_Air_Balloon1;case"Suggest_Hot_Air_Balloon2":return e.Theme_Name_Suggest_Hot_Air_Balloon2;case"Suggest_House_Architecture":return e.Theme_Name_Suggest_House_Architecture;case"Suggest_Hydrogen_Balloon":return e.Theme_Name_Suggest_Hydrogen_Balloon;case"Suggest_Indoors_Adult":return e.Theme_Name_Suggest_Indoors_Adult;case"Suggest_Indoors_Room":return e.Theme_Name_Suggest_Indoors_Room;case"Suggest_Indoors_Woman":return e.Theme_Name_Suggest_Indoors_Woman;case"Suggest_Kid_Park":return e.Theme_Name_Suggest_Kid_Park;case"Suggest_Laptop_Desktop":return e.Theme_Name_Suggest_Laptop_Desktop;case"Suggest_Library_College":return e.Theme_Name_Suggest_Library_College;case"Suggest_Literature_Knowledge":return e.Theme_Name_Suggest_Literature_Knowledge;case"Suggest_Live_Blue_Orange_Square":return e.Theme_Name_Suggest_Live_Blue_Orange_Square;case"Suggest_Live_Globe_Book":return e.Theme_Name_Suggest_Live_Globe_Book;case"Suggest_Live_Greenplant_Computer":return e.Theme_Name_Suggest_Live_Greenplant_Computer;case"Suggest_Live_Grid_Lights":return e.Theme_Name_Suggest_Live_Grid_Lights;case"Suggest_Live_Woman_Work":return e.Theme_Name_Suggest_Live_Woman_Work;case"Suggest_Love_Flower":return e.Theme_Name_Suggest_Love_Flower;case"Suggest_Man_Adult":return e.Theme_Name_Suggest_Man_Adult;case"Suggest_Man_Indoors":return e.Theme_Name_Suggest_Man_Indoors;case"Suggest_Man_People":return e.Theme_Name_Suggest_Man_People;case"Suggest_Many_Pencils":return e.Theme_Name_Suggest_Many_Pencils;case"Suggest_Meal_Food":return e.Theme_Name_Suggest_Meal_Food;case"Suggest_Medal":return e.Theme_Name_Suggest_Medal;case"Suggest_Moon_Sky":return e.Theme_Name_Suggest_Moon_Sky;case"Suggest_Mountain_Run":return e.Theme_Name_Suggest_Mountain_Run;case"Suggest_Movie_Show":return e.Theme_Name_Suggest_Movie_Show;case"Suggest_Music_Drum":return e.Theme_Name_Suggest_Music_Drum;case"Suggest_Music_People":return e.Theme_Name_Suggest_Music_People;case"Suggest_Music_Performance":return e.Theme_Name_Suggest_Music_Performance;case"Suggest_Nature_Grass":return e.Theme_Name_Suggest_Nature_Grass;case"Suggest_Neon_Food":return e.Theme_Name_Suggest_Neon_Food;case"Suggest_Note_Pen":return e.Theme_Name_Suggest_Note_Pen;case"Suggest_Orange_Desk":return e.Theme_Name_Suggest_Orange_Desk;case"Suggest_Outdoors_Nature":return e.Theme_Name_Suggest_Outdoors_Nature;case"Suggest_Package_Parachute":return e.Theme_Name_Suggest_Package_Parachute;case"Suggest_Paper_Indoors0":return e.Theme_Name_Suggest_Paper_Indoors0;case"Suggest_Paper_Plane":return e.Theme_Name_Suggest_Paper_Plane;case"Suggest_Parent_Boat":return e.Theme_Name_Suggest_Parent_Boat;case"Suggest_Parent_Wall":return e.Theme_Name_Suggest_Parent_Wall;case"Suggest_Party_Supply":return e.Theme_Name_Suggest_Party_Supply;case"Suggest_Pencil1":return e.Theme_Name_Suggest_Pencil1;case"Suggest_Pencil2":return e.Theme_Name_Suggest_Pencil2;case"Suggest_People_Adult0":return e.Theme_Name_Suggest_People_Adult0;case"Suggest_People_Adult1":return e.Theme_Name_Suggest_People_Adult1;case"Suggest_People_Airplane":return e.Theme_Name_Suggest_People_Airplane;case"Suggest_People_Boy":return e.Theme_Name_Suggest_People_Boy;case"Suggest_People_Group":return e.Theme_Name_Suggest_People_Group;case"Suggest_People_Idea":return e.Theme_Name_Suggest_People_Idea;case"Suggest_People_Indoors":return e.Theme_Name_Suggest_People_Indoors;case"Suggest_People_Portrait":return e.Theme_Name_Suggest_People_Portrait;case"Suggest_People_Sand":return e.Theme_Name_Suggest_People_Sand;case"Suggest_People_Silhouette":return e.Theme_Name_Suggest_People_Silhouette;case"Suggest_People_Walk":return e.Theme_Name_Suggest_People_Walk;case"Suggest_Piano_Keyboard":return e.Theme_Name_Suggest_Piano_Keyboard;case"Suggest_Pizza_Flavor":return e.Theme_Name_Suggest_Pizza_Flavor;case"Suggest_Pizza_Food":return e.Theme_Name_Suggest_Pizza_Food;case"Suggest_Pizza_Pepper":return e.Theme_Name_Suggest_Pizza_Pepper;case"Suggest_Pizza_Slice":return e.Theme_Name_Suggest_Pizza_Slice;case"Suggest_Pool_Ring":return e.Theme_Name_Suggest_Pool_Ring;case"Suggest_Popcorn_Movie":return e.Theme_Name_Suggest_Popcorn_Movie;case"Suggest_Product_Manufacture":return e.Theme_Name_Suggest_Product_Manufacture;case"Suggest_Pumpkin_Halloween":return e.Theme_Name_Suggest_Pumpkin_Halloween;case"Suggest_Rating_Phone":return e.Theme_Name_Suggest_Rating_Phone;case"Suggest_Red_Carpet":return e.Theme_Name_Suggest_Red_Carpet;case"Suggest_Red_Pepper":return e.Theme_Name_Suggest_Red_Pepper;case"Suggest_Room_Ball":return e.Theme_Name_Suggest_Room_Ball;case"Suggest_Room_Desktop":return e.Theme_Name_Suggest_Room_Desktop;case"Suggest_Room_Desktop2":return e.Theme_Name_Suggest_Room_Desktop2;case"Suggest_Room_People":return e.Theme_Name_Suggest_Room_People;case"Suggest_Rose_Flower":return e.Theme_Name_Suggest_Rose_Flower;case"Suggest_Rose_Line":return e.Theme_Name_Suggest_Rose_Line;case"Suggest_Round_Out_Color":return e.Theme_Name_Suggest_Round_Out_Color;case"Suggest_Seat_Chair":return e.Theme_Name_Suggest_Seat_Chair;case"Suggest_Shirt_Color":return e.Theme_Name_Suggest_Shirt_Color;case"Suggest_Shopping_Basket":return e.Theme_Name_Suggest_Shopping_Basket;case"Suggest_Shopping_Cart":return e.Theme_Name_Suggest_Shopping_Cart;case"Suggest_Shopping_Clothes":return e.Theme_Name_Suggest_Shopping_Clothes;case"Suggest_Skill_People":return e.Theme_Name_Suggest_Skill_People;case"Suggest_Sky_Balloon":return e.Theme_Name_Suggest_Sky_Balloon;case"Suggest_Smile_Rating":return e.Theme_Name_Suggest_Smile_Rating;case"Suggest_Soccer":return e.Theme_Name_Suggest_Soccer;case"Suggest_Spoon_Forks":return e.Theme_Name_Suggest_Spoon_Forks;case"Suggest_Sport_Chair":return e.Theme_Name_Suggest_Sport_Chair;case"Suggest_Sprinkles_Cake":return e.Theme_Name_Suggest_Sprinkles_Cake;case"Suggest_Stadium":return e.Theme_Name_Suggest_Stadium;case"Suggest_Street_Woman0":return e.Theme_Name_Suggest_Street_Woman0;case"Suggest_Street_Woman1":return e.Theme_Name_Suggest_Street_Woman1;case"Suggest_Student_School":return e.Theme_Name_Suggest_Student_School;case"Suggest_Studio_Table":return e.Theme_Name_Suggest_Studio_Table;case"Suggest_Study_Book":return e.Theme_Name_Suggest_Study_Book;case"Suggest_Study_Table":return e.Theme_Name_Suggest_Study_Table;case"Suggest_Sun_Sky":return e.Theme_Name_Suggest_Sun_Sky;case"Suggest_Swimming_Flamingo":return e.Theme_Name_Suggest_Swimming_Flamingo;case"Suggest_Symbol_Image":return e.Theme_Name_Suggest_Symbol_Image;case"Suggest_T_Shirt_Color":return e.Theme_Name_Suggest_T_Shirt_Color;case"Suggest_Table_Meeting":return e.Theme_Name_Suggest_Table_Meeting;case"Suggest_Table_Note":return e.Theme_Name_Suggest_Table_Note;case"Suggest_Table_Wedding":return e.Theme_Name_Suggest_Table_Wedding;case"Suggest_Table_Work":return e.Theme_Name_Suggest_Table_Work;case"Suggest_Table_Work2":return e.Theme_Name_Suggest_Table_Work2;case"Suggest_Tape_Weight":return e.Theme_Name_Suggest_Tape_Weight;case"Suggest_Team_Moral":return e.Theme_Name_Suggest_Team_Moral;case"Suggest_Team_Work":return e.Theme_Name_Suggest_Team_Work;case"Suggest_Tennis_Sport":return e.Theme_Name_Suggest_Tennis_Sport;case"Suggest_Time_Calendar0":return e.Theme_Name_Suggest_Time_Calendar0;case"Suggest_Traffic_Road":return e.Theme_Name_Suggest_Traffic_Road;case"Suggest_Travel_Landscape":return e.Theme_Name_Suggest_Travel_Landscape;case"Suggest_Travel_Mountain":return e.Theme_Name_Suggest_Travel_Mountain;case"Suggest_Vegetable_Green":return e.Theme_Name_Suggest_Vegetable_Green;case"Suggest_Velvet_Seat":return e.Theme_Name_Suggest_Velvet_Seat;case"Suggest_Vote_Hand":return e.Theme_Name_Suggest_Vote_Hand;case"Suggest_Water_Nature":return e.Theme_Name_Suggest_Water_Nature;case"Suggest_Water_Sea":return e.Theme_Name_Suggest_Water_Sea;case"Suggest_Water_Travel":return e.Theme_Name_Suggest_Water_Travel;case"Suggest_Wedding_Flower":return e.Theme_Name_Suggest_Wedding_Flower;case"Suggest_Wedding_Groom":return e.Theme_Name_Suggest_Wedding_Groom;case"Suggest_Winner_Stairs":return e.Theme_Name_Suggest_Winner_Stairs;case"Suggest_Woman_Adult":return e.Theme_Name_Suggest_Woman_Adult;case"Suggest_Woman_Indoors":return e.Theme_Name_Suggest_Woman_Indoors;case"Suggest_Woman_Indoors0":return e.Theme_Name_Suggest_Woman_Indoors0;case"Suggest_Woman_Indoors1":return e.Theme_Name_Suggest_Woman_Indoors1;case"Suggest_Woman_Lobby":return e.Theme_Name_Suggest_Woman_Lobby;case"Suggest_Woman_Man":return e.Theme_Name_Suggest_Woman_Man;case"Suggest_Woman_People0":return e.Theme_Name_Suggest_Woman_People0;case"Suggest_Woman_People2":return e.Theme_Name_Suggest_Woman_People2;case"Suggest_Woman_People3":return e.Theme_Name_Suggest_Woman_People3;case"Suggest_Wood_Desktop":return e.Theme_Name_Suggest_Wood_Desktop;case"Suggest_Wood_Flower":return e.Theme_Name_Suggest_Wood_Flower;case"Suggest_Wood_Food":return e.Theme_Name_Suggest_Wood_Food;case"Suggest_Wood_People":return e.Theme_Name_Suggest_Wood_People;case"Suggest_Zen_Balance":return e.Theme_Name_Suggest_Zen_Balance;case"Teal":return e.Theme_Name_Teal;case"Very_Peri":return e.Theme_Name_Very_Peri;case"Wedding_Beach":return e.Theme_Name_Wedding_Beach;case"Wedding_Classic":return e.Theme_Name_Wedding_Classic;case"Wedding_Modern":return e.Theme_Name_Wedding_Modern;case"Wedding_Romantic":return e.Theme_Name_Wedding_Romantic;case"Wedding_Rustic":return e.Theme_Name_Wedding_Rustic;default:return""}}},7645:function(t,n,e){"use strict";e.d(n,{D1:function(){return p},Re:function(){return y},ay:function(){return v},pm:function(){return d},r4:function(){return g}});var i,r,o,s=e(66676),a=e(43209),u=e(72377),c=e(35337),l=e(55411),f=e(21607),h={};function d(){return o}function m(t){o=(0,c.Y)(t)}function v(){return i||(i=new Promise((function(t,n){o?t(o):r?r.then((function(n){g(null),m(n),t(n)})):y().then((function(n){m(n),t(n)})).catch(n)}))),i}function g(t){r=t}function p(t){var n=h[t];return n||(h[t]=new Promise((function(n,e){y(t).catch((function(){return(0,f.h6)(t)})).then((function(t){n((0,c.Y)(t))}))})),n=h[t]),n}function b(t){return(t?(0,f.h6)(t):(0,f.Ip)()).then(c.Y)}function y(t){return(0,a.aK)()||(0,l.y)()?b(t):Promise.resolve().then((function(){t=t||(0,s.K)().toLowerCase();var n=u.Pv.Resolve("ILazyLoadResourceStringsFunc");return n(t).catch((function(){var e=null==t?void 0:t.split("-")[0];return t!==e?n(e).catch((function(){return n(void 0)})):n(void 0)}))})).catch((function(){return b(t)}))}},8435:function(t,n,e){"use strict";e.d(n,{eg:function(){return c},qI:function(){return a}});var i=e(16586),r=e(4851),o=e(90710);function s(){return window.shellInfo}function a(){var t,n=window.navigator;return window.URL&&"serviceWorker"in n&&u()&&"function"==typeof(null===(t=n.serviceWorker)||void 0===t?void 0:t.register)}var u=(0,r.Rm)((function(){var t=!0;try{window.eval((0,i.Z9)("async () => {}"))()}catch(n){t=!1}return t}));function c(){var t=(0,o.NW)().fsw,n=s();return!("0"===t||!n)&&n.swEnabled}},41317:function(t,n,e){"use strict";e.d(n,{BM:function(){return f},Rt:function(){return c},lx:function(){return h},nk:function(){return d}});var i,r,o=e(59312),s=e(78587),a=e(21607),u=e(43367);function c(){return r||(r=(0,u.getIoCLazyLoadThemes)()),r}function l(t){return i||(i=(0,a.RC)(t||(0,u.getIoCDefaultTheme)().Name).then(JSON.parse)),i}function f(t){return(0,o.mG)(this,void 0,Promise,(function(){return(0,o.Jh)(this,(function(n){switch(n.label){case 0:return[4,c()];case 1:return[2,d(n.sent()[t])||(0,u.getIoCDefaultTheme)()]}}))}))}function h(t){return(0,o.mG)(this,void 0,Promise,(function(){return(0,o.Jh)(this,(function(n){switch(n.label){case 0:return[4,l(t)];case 1:return[2,d(n.sent()[t])||(0,u.getIoCDefaultTheme)()]}}))}))}function d(t){if(!t)return t;var n=(0,o.pi)({},t),e=t.BackgroundImage,i=t.Thumbnail;return null!=e&&(/^\/Images\//i.test(e)||/^\/formsresources\//i.test(e))&&(n.BackgroundImage=(0,s.Jn)(e)),null!=i&&(/^\/Images\//i.test(i)||/^\/formsresources\//i.test(i))&&(n.Thumbnail=(0,s.Jn)(i)),n}},83830:function(t,n,e){"use strict";e.d(n,{v:function(){return u}});var i=e(60211),r=e(64290),o=e(55411),s="https://forms.microsoft.com/",a="https://forms.office.com/";function u(){var t;switch((0,i.kD)()){case"USNat":t="https://forms.osi.eaglex.ic.gov/";break;case"USSec":t="https://forms.osi.microsoft.scloud/";break;case"USDoDProd":t="https://forms.osi.apps.mil/";break;case"USGovProd":t="https://forms.osi.office365.us/";break;case"USGovGccProd":t=(0,i.H5)()?s:(0,o.Pq)()?"https://customervoice.microsoft.us/":a;break;case"WWProd":t=(0,r.pd)((function(){return a}),r.t1);break;case"MSProd":t=s;break;case"ProTip":t="https://tip.forms.office.com/";break;case"CVProd":t="https://customervoice.microsoft.com/";break;case"CVTip":t="https://tip.customervoice.microsoft.com/";break;case"CVFastfood":t="https://msit2.customervoice.microsoft.com/";break;default:t="https://"+window.location.host+"/"}return t}},43367:function(t,n,e){"use strict";e.r(n),e.d(n,{addIoCHeaderFontToSchemas:function(){return s},addIoCSurveyFontToSchemas:function(){return o},areIoCImageUploadButtonsEnabled:function(){return m},callIoCDeletePausedResponse:function(){return C},callIoCGetPausedResponse:function(){return S},callIoCSetLocaleItem:function(){return N},callIoCUpdatePR:function(){return w},callIoCUpdatePRForText:function(){return I},createChoiceQuestionRenderer:function(){return R},cvOnlyLanguageUtilityIoC:function(){return O},getIoCCreateCascadeQuestionRenderer:function(){return D},getIoCCreateFileUploadQuestionRenderer:function(){return F},getIoCCreateHeaderThemeRenderer:function(){return P},getIoCCustomLanguageFriendlyName:function(){return L},getIoCDefaultTheme:function(){return l},getIoCErrorPage:function(){return y},getIoCFlexPaneWidth:function(){return b},getIoCFooterElement:function(){return u},getIoCImagePickerLocalContainerClassName:function(){return p},getIoCLazyLoadThemes:function(){return c},getIoCMMediaPickerPaneText:function(){return d},getIoCMediaPickerPaneInfoContent:function(){return g},getIoCMediaPickerPaneTitle:function(){return v},getIoCModifiedTextField:function(){return a},getIoCPreviewSettingsPane:function(){return r},getIoCQuestionDelegatorClass:function(){return M},getIoCQuestionRendererFooter:function(){return A},getIoCThemeBackground:function(){return f},getIoCThemeStyle:function(){return h},getIocConditionalThankyouControl:function(){return T},getIocMessageContent:function(){return x},getIocThankYouMessageKey:function(){return k},handleSubmitButtonClickIoC:function(){return E}});var i=e(72377);function r(t){return _().createPreviewSettingPane(t)}function o(t){return _().addSurveyFontToSchemas(t)}function s(t){return _().addHeaderFontToSchemas(t)}function a(t,n){return _().getModifiedTextField(t,n)}function u(t){return _().getFooterElement(t)}function c(){return _().getLazyLoadThemes()}function l(){return _().getDefaultTheme()}function f(t){return _().getThemeBackground(t)}function h(t){return _().getThemeStyle(t)}function d(){return _().getMediaPickerPaneText()}function m(){return _().areImageUploadButtonsEnabled()}function v(){return _().getMediaPickerPaneTitle()}function g(){return _().getMediaPickerPaneInfoContent()}function p(){return _().getImagePickerLocalContainerClassName()}function b(){return _().getFlexPaneWidth()}function y(){return _().getErrorPage()}function w(t,n,e,i,r,o){return _().callUpdatePR(t,n,e,i,r,o)}function S(t,n){return _().callGetPausedResponse(t,n)}function N(t,n,e,i){return _().callSetLocaleItem(t,n,e,i)}function C(t,n){return _().callDeletePausedResponse(t,n)}function I(t,n,e,i,r){return _().callUpdatePRForTextQuestion(t,n,e,i,r)}function T(t){return _().getConditionalThankyouControl(t)}function k(t,n,e){return _().derivedThankYouMessageKey(t,n,e)}function x(t){return _().getMessageContent(t)}function F(t){return _().createFileUploadQuestionRenderer(t)}function P(t){return _().createHeaderThemeRenderer(t)}function D(t){return _().createCascadeQuestionRenderer(t)}function M(t){return _().getQuestionDelegatorClass(t)}function L(t){return _().getCustomLanguageFriendlyName(t)}function R(t){return _().createChoiceQuestionRenderer(t)}function A(t){return _().getQuestionRendererFooter(t)}function E(t,n){return _().handleSubmitButtonClick(t,n)}function O(){return _().cvOnlyLanguageUtility()}function _(){return i.Pv.Resolve("ICustomerVoiceUxFactory")}},9554:function(t,n,e){"use strict";e.d(n,{w:function(){return r}});var i=e(72377);function r(t){return i.Pv.Resolve("ICustomerVoiceTitleContainerFactory").titleContainerCreate(t)}},19194:function(t,n,e){"use strict";e.d(n,{e:function(){return f}});var i=e(22617),r=e(60211),o=e(13877),s="officeforms.uselegacylogindomain";function a(t){return(0,o.$o)().getItem(t)}function u(){var t=!!a(s);return(0,r.yv)()?t?"https://login.windows.net/":"https://login.microsoftonline.com/":"https://login.windows-ppe.net/"}var c=e(63795);var l=e(7645);function f(t){return function(t,n){var e="";if(t)if(t instanceof Error&&!t.hasOwnProperty("correlationId"))switch(t.name){case"LoginIECrossZoneError":e=(0,c.WU)(n.Error_Message_Client_LoginIECrossZoneError,window.location.origin,u());break;case"ThirdPartyCookieBlockedError":e=(0,c.WU)(n.Error_Message_Client_ThirdPartyCookieError,u());break;case"AuthNoStorageError":e=n.Error_Message_Client_AuthNoStorageError;break;case"AADAcquireTokenMfaCheckError":e=n.Error_Message_705;break;case"TeamSiteNoGroupError":e=n.Error_Message_Client_TeamSiteNoGroupError}else{var r=t;r.innerCode&&(e=(0,i.D)(String(r.innerCode),n)||(0,c.WU)(n.Error_Message_Default,r.innerCode))}return e}(t,(0,l.pm)())}},87941:function(t,n,e){"use strict";e.d(n,{jI:function(){return yt},U8:function(){return pt},Wr:function(){return bt}});var i,r,o,s,a=e(81380),u=e(60211),c=e(94290),l=e(54496),f=e(59122),h=e(59312),d=e(96078),m=e(9947),v=e(916),g=e(83894),p=e(59749),b=e(97265),y=e(45331),w=e(29559),S=function(){function t(){this.Tt=[]}return t.prototype.setFunctionToCall=function(t){var n=this;if(this.kt!==t)if(this.kt=t,t){var e=this.Tt;delete this.Tt,e&&e.length&&e.forEach((function(t){return n.kt.apply(void 0,t)}))}else this.Tt=this.Tt||[]},Object.defineProperty(t.prototype,"queue",{get:function(){return this.kt?this.kt:this.xt},enumerable:!1,configurable:!0}),t.prototype.xt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.Tt.push(t)},t}(),N=e(41420),C=new S,I=[];function T(t,n){if(k({eventName:t,eventType:"engagement_event",extraData:n}),!(0,u.x8)()&&"design"===(0,N.UE)()){!function(t){t&&i&&I.indexOf(t)>=0&&i.addUserActionSignal(t)}(n&&n.userActionSignal||t)}}function k(t){var n=(0,h.pi)((0,h.pi)({},t.extraData||{}),{neoDesignPage:!0,subpage:(0,N.UE)(),isMobile:(0,w.tq)()});t.extraData instanceof Error&&Object.getOwnPropertyNames(t.extraData).forEach((function(e){n[e]=t.extraData[e]})),t.extraData=n,C.queue(t)}!function(t){t[t.Design=0]="Design",t[t.Response=1]="Response"}(r||(r={}));var x="0000000000048191",F="https://forms.office.com/Pages/MsaTokenPage.aspx",P="https://graph.microsoft.com",D="".concat(P,"/Mail.Send ").concat(P,"/Files.ReadWrite.All ").concat(P,"/Group.Read.All");function M(t){var n=t.$renew,e=void 0!==n&&n,i=t.$throwable,r=void 0!==i&&i,o=t.$popup,s=void 0!==o&&o,a=t.$loginHint,u=void 0===a?"":a;return(0,h.mG)(this,void 0,void 0,(function(){var t,n;return(0,h.Jh)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,L(e,s,u)];case 1:return t=i.sent(),[2,"".concat(t.tokenType," ").concat(t.accessToken)];case 2:if(n=i.sent(),r)throw n;return[2,null];case 3:return[2]}}))}))}function L(t,n,e){return void 0===t&&(t=!1),void 0===n&&(n=!1),(0,h.mG)(this,void 0,Promise,(function(){var i,r;return(0,h.Jh)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,4,,7]),o&&!t?[3,2]:[4,R(n,e)];case 1:s.sent(),s.label=2;case 2:return[4,o];case 3:return[2,s.sent()];case 4:return i=s.sent(),r=i,T("MsaGraph.GetToken.Failure",i),o=null,"login_required"!==r.tokenError?[3,6]:[4,L(!0,!0,e)];case 5:return[2,s.sent()];case 6:return[2,Promise.reject(i)];case 7:return[2]}}))}))}function R(t,n){return void 0===t&&(t=!1),(0,h.mG)(this,void 0,Promise,(function(){var e;return(0,h.Jh)(this,(function(i){return e=(0,b.GW)(),[2,o=new Promise((function(i,r){var a,u=function(t,n){if(n)return(0,y.K)(t,"MicrosoftOfficeLyncWebAppHelp","width=400,height=500,menubar=no,status=no,scrollbars=no,titlebar=no,toolbar=no,resizable=yes");var e=document.createElement("iframe");return e.setAttribute("style","display: none;"),(0,p.M5)(e,t),document.body.appendChild(e),e}("https://login.live.com/oauth20_authorize.srf?response_type=token&response_mode=form_post&".concat(t?"":"prompt=none","&client_id=").concat(x,"&scope=").concat(D,"&redirect_uri=").concat(F,"&state=").concat(e).concat(n?"&login_hint="+n:""),t),c=function(n){if(void 0===n&&(n=null),window.clearTimeout(a),window.removeEventListener("message",l,!1),t){u&&u.close()}else document.body.removeChild(u);n?function(t){if(t){var n=Number(t.tokenExpiresIn)-60;window.clearTimeout(s),s=window.setTimeout((function(){o=null}),1e3*n)}}(n):o=null},l=function(t){var n=t.data;n.accessToken&&e===n.tokenState?(c(n),i(n)):(c(),r(n))};if(t&&!u)c(),r({tokenError:"popup_blocked",tokenErrorDescription:"Login popup is blocked"});else{window.addEventListener("message",l,!1);a=window.setTimeout((function(){c(),r({tokenError:"timeout",tokenErrorDescription:"Iframe doesn't load in 10 seconds"})}),1e4)}}))]}))}))}var A=e(73252),E=e(83830),O=e(37076),_=e(31442),B=e(47393),H=e(92528),G=e(72377);function q(){return(0,H.y3)().catch((function(){return null}))}var V=e(99437),z=e(14537),Q=e(79552);function U(t){var n=[2,16,32,64],e=t>=n.length?64:n[t];return 1e3*Math.min(e,64)*(.8+.4*Math.random())}var $=e(94978),j={},W={},K=null;var J=e(37043);var Z=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return 0===t.length?function(t){return t}:1===t.length?t[0]:t.reduce((function(t,n){return function(e){return t(n(e))}}))}((function(t){return function(n){return t(n).then((function(t){return t}),(function(t){var n=(0,V.QX)(t);return t&&t.authErrorType&&(n.authErrorType=t.authErrorType),Promise.reject(n)}))}}),(function(t){return function(n){return t((0,h.pi)((0,h.pi)({},n),{retryConfig:{retryCount:0}}))}}),(function(t){return function(n){var e=function(t,n){var e,i,r=t&&(0,z.Py)(t,n);if(r){var o=(0,z.PW)(t);e=(0,z.$u)(t),i=r.then((function(n){return!o||(0,z.XH)(t)?(!o&&(0,z.cq)(t),n):new Promise((function(){}))}))}return{$correlationId:e,$prefetcherPromise:i}}(n.prefetcherId,n),i=e.$correlationId,r=e.$prefetcherPromise;return n.prefetcherPromise=r,n.prefetcherId=null,n.correlationId||(n.correlationId=i),t(n)}}),(function(t){return function(n){var e,i=n.correlationId,r=n.qosEventName,o=n.qosExtraData,s=void 0===o?{}:o,a=n.getQosExtraDataOnSuccess,u=n.retryConfig,c=n.url,l=n.processQosInnerMessageOnFailureOrRetry,f=function(t){var n,e=t||{},i=e.qosEventName,r=e.qosThrottle,o=void 0!==r&&r,s=-1!==((0,$.Gw)("ThrottledQosEventNames")||[]).indexOf(i),a=0;return(o||s)&&(K||(K=setInterval((function(){Object.keys(j).forEach((function(t){j[t]=!0}))}),6e5)),void 0===j[i]||j[i]?(a=null!==(n=W[i])&&void 0!==n?n:0,j[i]=!1,W[i]=0):(a=-1,void 0!==W[i]?++W[i]:W[i]=1)),a}(n);return r&&""!==r&&!(f<0)&&((e=new v.o(r,i)).ExtraData=(0,h.pi)((0,h.pi)({},s),{SkippedCount:f}),e.start()),n.qos=e,n.correlationId=null==e?void 0:e.CorrelationId,t(n).then((function(t){if(!e)return t;s.resultCode=t&&t.response?t.response.statusCode:"",s.resultType="Success",s.retryCount=u.retryCount;var n=s;return a&&(n=(0,h.pi)((0,h.pi)({},s),a(t))),e.end({resultType:"Success",extraData:n}),t}),(function(t){return t&&e&&e.end(function(t,n,e,i){var r=(0,V.Lo)(t,n,i);return{resultCode:n&&n.response?n.response.statusCode:"",resultType:(0,Q.WP)(r)?"ExpectedFailure":"Failure",extraData:(0,h.pi)({ServiceError:r},e)}}(c,t,s,l)),Promise.reject(t)}))}}),(function(t){var n=this;return function(e){return(0,h.mG)(n,void 0,void 0,(function(){var n,i,r,o,s,a;return(0,h.Jh)(this,(function(u){switch(u.label){case 0:return n=e.ignoreAuthError,i=void 0!==n&&n,r=e.withoutToken,o=e.prefetcherPromise,s=e.accessToken,r||o||s?[3,2]:(a=e,[4,q()]);case 1:a.accessToken=u.sent(),u.label=2;case 2:return[2,function(){return t(e).then((function(t){return t}),(function(n){return i?Promise.reject(n):function(t){try{return(0,G.gX)(27).$authErrorHandler(t)}catch(t){return Promise.reject()}}(n).catch((function(t){return Promise.reject(n&&(0,h.pi)((0,h.pi)({},n),{authErrorType:t&&t.authErrorType}))})).then(q).then((function(n){return e.accessToken=n,e.ignoreAuthError=!0,t(e)})).catch((function(t){return Promise.reject(t||{})}))}))}()]}}))}))}}),(function(t){return function(n){var e=n.prefetcherPromise,i=n.qos,r=n.retryConfig,o=n.disableRetry,s=n.url,a=n.processQosInnerMessageOnFailureOrRetry,u=Date.now();return new Promise((function(c,l){var f=function(){(e||t(n)).then(c,(function(t){if(o)return l(t);e=null;var n=(0,V.Lo)(s,t,a),c=function(t,n){var e=t.statusCode,i=function(t,n){var e,i=t.statusCode,r=t.innerCode,o=!1,s=0;return 502===i?(e="Forms_Http_"+i,o=n<2):503===i?(e="Forms_Http_"+i,o=n<5,s=U(n)):504===i||0===i?(s=5e3,e="Forms_Http_"+i,o=n<6):6503===r||624===r||647===r?(e="CDB_Http_"+r,o=n<2):645===r||646===r?(e="CDB_Http_"+r,o=n<10,s=U(n)):6300===r&&(0,A.cr)("Retry6300")&&(e="CDB_Net_"+r,o=n<2),{resultCode:e,shouldRetry:o,retryInterval:s}}(t,n),r=i.resultCode,o=i.shouldRetry,s=i.retryInterval;500===e&&(r="Forms_Http_"+e,o=n<2);return{resultCode:r,shouldRetry:o,retryInterval:s}}(n,r.retryCount),h=c.resultCode,d=c.shouldRetry,m=c.retryInterval;if(i){var v=Date.now();i.log({resultCode:h,extraData:{RetryCount:r.retryCount,RetryInterval:m,ServiceError:n,Duration:Math.ceil((v-u)/1e3)}}),u=v}if(!d)return l(t);r.retryCount++,setTimeout(f,m)}))};f()}))}}))(J.Q);function X(t){return Z(t)}var Y,tt="",nt=!1;function et(t,n,e,i){return"".concat((0,E.v)(),"formapi/api/").concat(t,"/").concat(i?"groups":"users","/").concat(n,"/forms(").concat(e,")")}function it(t,n){return(0,g.ro)(t)?"".concat((0,d.Z)()):"".concat((0,E.v)(),n?"formapi/msgraph/v1.0":"msgraph/v1.0")}var rt=/^(?!bearer\s*bearer)(bearer)(\s{1,})(.{10,})$/i;function ot(){return(0,h.mG)(this,void 0,void 0,(function(){var t,n,e,i,r,o,s,a;return(0,h.Jh)(this,(function(u){switch(u.label){case 0:(t=new v.o("SDXExcelHelper.getMsaGraphTokenString")).start(),n=0,e={$renew:!0,$throwable:!0,$popup:!1,$loginHint:(0,m.k0)().userInfo.Email},i=!1,u.label=1;case 1:if(!(n++<2))return[3,9];u.label=2;case 2:return u.trys.push([2,7,,8]),i||Y?[4,dt()]:[3,4];case 3:return o=u.sent(),[3,6];case 4:return[4,M(e)];case 5:o=u.sent(),u.label=6;case 6:if(r=o,!rt.test(r))throw new Error("The MSA login info is invalid. ".concat(null==Y?void 0:Y.tokenError," ").concat(null==Y?void 0:Y.tokenErrorDescription));return t.end({resultType:"Success"}),[2,r];case 7:return s=u.sent(),a=s,n<2?(t.log({extraData:vt(s)}),nt?i=!0:"timeout"===a.tokenError&&(e.$popup=!0),[3,8]):(t.end({resultType:"ExpectedFailure",extraData:vt(s)}),[2,Promise.reject({innerCode:10222,innerMessage:s instanceof Error?s.message:a.tokenErrorDescription})]);case 8:return[3,1];case 9:return[2]}}))}))}function st(t,n,e,i,r){var o;return(0,h.mG)(this,void 0,Promise,(function(){var s,a,u,c,l,f,d,v,p;return(0,h.Jh)(this,(function(h){switch(h.label){case 0:return s=et(t,n,e,i),a="".concat(s,r?"/xl/reexportFormExcel2":"/xl/exportFormExcel2"),u={},c="undefined"!=typeof Intl?Intl.DateTimeFormat():null,l=null===(o=null==c?void 0:c.resolvedOptions())||void 0===o?void 0:o.timeZone,u.__TimezoneOffset=(new Date).getTimezoneOffset().toString(),u.__TimezoneId=l||"",u.__Locale=(0,m.k0)().cultureInfo.Name,(0,g.ro)(t)?(f=u,d="x-ms-form-msa-graph-token",[4,ot()]):[3,2];case 1:f[d]=h.sent(),h.label=2;case 2:return h.trys.push([2,4,,5]),[4,X({url:a,method:"GET",qosEventName:"Graph.ExportFormExcel2",getQosExtraDataOnSuccess:function(t){return{serverDocId:t.serverDocId,resourceId:t.resourceId}},headers:u})];case 3:return[2,h.sent()];case 4:throw v=h.sent(),403===(null==(p=v)?void 0:p.statusCode)&&(p.innerCode=707,p.type="ExpectedFailure"),p;case 5:return[2]}}))}))}function at(t,n,e,i,r){var o;return(0,h.mG)(this,void 0,Promise,(function(){var s,a,u,c,l,f,d;return(0,h.Jh)(this,(function(h){switch(h.label){case 0:return s=et(t,n,e,i),a="".concat(s,r?"/xl/reexportFormExcel":"/xl/exportFormExcel"),u={},c="undefined"!=typeof Intl?Intl.DateTimeFormat():null,l=null===(o=null==c?void 0:c.resolvedOptions())||void 0===o?void 0:o.timeZone,u.__TimezoneOffset=(new Date).getTimezoneOffset().toString(),u.__TimezoneId=l||"",u.__Locale=(0,m.k0)().cultureInfo.Name,(0,g.ro)(t)?(f=u,d="x-ms-form-msa-graph-token",[4,ot()]):[3,2];case 1:f[d]=h.sent(),h.label=2;case 2:return[2,X({url:a,method:"GET",qosEventName:"Graph.ExportFormExcel",headers:u,getQosExtraDataOnSuccess:function(t){return{serverDocId:t.serverDocId,resourceId:t.resourceId}}})]}}))}))}function ut(t,n,e,i){var r;return(0,h.mG)(this,void 0,Promise,(function(){var o,s,a;return(0,h.Jh)(this,(function(u){return o={},s="undefined"!=typeof Intl?Intl.DateTimeFormat():null,a=null===(r=null==s?void 0:s.resolvedOptions())||void 0===r?void 0:r.timeZone,o.__TimezoneOffset=(new Date).getTimezoneOffset().toString(),o.__TimezoneId=a||"",o.__Locale=(0,m.k0)().cultureInfo.Name,[2,X({url:"".concat(et(t,n,e,i),"/xl/getExcelFile"),method:"GET",qosEventName:"SDXExcel.GetExcelFile",headers:o})]}))}))}function ct(t,n,e,i,r,o){return(0,h.mG)(this,void 0,void 0,(function(){var s;return(0,h.Jh)(this,(function(a){return s={drive:r,driveItem:o},[2,X({url:"".concat(et(t,n,e,i),"/xl/sdxMetadata"),method:"PATCH",qosEventName:"SDXExcel.UpdateSdxMetadata",data:s})]}))}))}function lt(t,n,e,i){return(0,h.mG)(this,void 0,Promise,(function(){return(0,h.Jh)(this,(function(r){return[2,X({url:"".concat(et(t,n,e,i),"/xl/sdxMetadata"),method:"GET",qosEventName:"SDXExcel.GetSdxMetadata"})]}))}))}function ft(t,n,e,i,r){return(0,h.mG)(this,void 0,Promise,(function(){var o,s;return(0,h.Jh)(this,(function(a){switch(a.label){case 0:return o="".concat(function(t,n,e){return(0,g.ro)(t)?"".concat(it(t),"/me"):"".concat(it(t),"/").concat(t,"/").concat(e?"groups":"users","/").concat(n)}(t,n,e),"/drive/root:/").concat(i,":/content?@microsoft.graph.conflictBehavior=rename"),s="",(0,g.ro)(t)?[4,ot()]:[3,2];case 1:s=a.sent(),a.label=2;case 2:return[2,X({url:o,method:"PUT",qosEventName:"Graph.UploadExcelContent",headers:{contentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",authorization:s},data:r})]}}))}))}function ht(t,n,e){return(0,h.mG)(this,void 0,Promise,(function(){var i,r;return(0,h.Jh)(this,(function(o){switch(o.label){case 0:return i="".concat(it(t,!0),"/").concat(t,"/drives/").concat(n.id,"/items/").concat(e.id),r="",(0,g.ro)(t)?[4,ot()]:[3,2];case 1:r=o.sent(),o.label=2;case 2:return[2,X({url:i,method:"GET",qosEventName:"Graph.GetDriveItem",headers:{contentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",authorization:r}})]}}))}))}function dt(){return Y?Promise.resolve("".concat(Y.tokenType," ").concat(Y.accessToken)):(t=!1,n="",e="".concat(F,"?redirect=true"),i=encodeURIComponent(tt),r="https://login.live.com/oauth20_authorize.srf?response_type=token&response_mode=form_post&".concat(t?"":"prompt=none","&client_id=").concat(x,"&scope=").concat(D,"&redirect_uri=").concat(e,"&state=").concat(i).concat(n?"&login_hint="+n:""),(0,_.$U)("RedirectToExcelPage.RedirectToSSO"),(0,B.gB)(r),new Promise((function(t){})));var t,n,e,i,r}function mt(t){for(var n=atob(t),e=n.length,i=new Uint8Array(e),r=0;r<e;r++)i[r]=n.charCodeAt(r);return i.buffer}function vt(t){if(t){if(t instanceof Error)return{name:t.name,message:t.message};if(t.hasOwnProperty("tokenError")&&t.hasOwnProperty("tokenErrorDescription"))return{name:t.tokenError,message:t.tokenErrorDescription}}return{name:"UnknownError",message:""}}var gt=e(46008);function pt(t,n,e,i){void 0===e&&(e=!1);var r="RedirectToExcelPage.aspx?id=".concat(encodeURIComponent(t),"&forceReExport=false&isSdxDataSync=").concat(n,"&useClientRequest=").concat(e).concat(i?"&correlationId=".concat(i):"");return(0,f.K)(r)}function bt(t,n,e){if(void 0===e&&(e=!1),(0,c.Kw)()){var i=(0,a.o7)(t),r=n?function(t,n,e,i,r,o){return(0,h.mG)(this,void 0,Promise,(function(){var s,a,u,c;return(0,h.Jh)(this,(function(l){switch(l.label){case 0:return s=(0,O.kc)(t),tt=r.replace(/^\/+/,""),nt=!!i,Y=o,e?[3,2]:[4,((0,A.cr)("SDXDataSyncProtection")?at:st)(s.OrgId,s.OwnerId,t,s.IsGroupOwner,n)];case 1:case 4:return[2,l.sent().webUrl];case 2:return[4,lt(s.OrgId,s.OwnerId,t,s.IsGroupOwner)];case 3:return a=l.sent(),n||!a?[3,5]:[4,ht(s.OrgId,a.drive,a.driveItem)];case 5:return[4,ut(s.OrgId,s.OwnerId,t,s.IsGroupOwner)];case 6:return u=l.sent(),[4,ft(s.OrgId,s.OwnerId,s.IsGroupOwner,u.fileName,mt(u.fileContent))];case 7:return c=l.sent(),[4,ct(s.OrgId,s.OwnerId,t,s.IsGroupOwner,{id:c.parentReference.driveId},c)];case 8:return l.sent(),[2,c.webUrl]}}))}))}(t,!0,e):i.getOrNewExcelInOneDrive(t,!0);r.then((function(t){window.postMessage("formreexportsuccess",(0,gt.Zh)())}))}else{var o="RedirectToExcelPage.aspx?id=".concat(encodeURIComponent(t),"&forceReExport=true&isSdxDataSync=").concat(n,"&useClientRequest=").concat(e);(0,l.rG)(o)}}function yt(t,n){if(t&&!n&&!(0,u.j4)())return"WaitingForExport"}},20987:function(t,n,e){"use strict";e.d(n,{Es:function(){return a},Au:function(){return s},Fd:function(){return c},dY:function(){return u},LG:function(){return l},ft:function(){return f},_o:function(){return h},Av:function(){return d}});var i=e(60211),r=e(90710);function o(t,n){void 0===n&&(n=!1);var e=(0,r.NW)()[t];return""===e||(e?(Array.isArray(e)&&(e=e[0]),n?"false"!==e.toLowerCase():"true"===e.toLowerCase()):n)}function s(){return o("debug")}function a(){return o("d")}function u(){return o("oembedssotrial")&&(0,i.yv)()||o("oembedsso")||o("powerappembed")}function c(){return a()&&!(0,i.yv)()}function l(){return!!o("pptcontentsso")}function f(){return o("pptintegration")}function h(){return o("runtimeautorefresh")}function d(){return o("streamsso")}},37076:function(t,n,e){"use strict";e.d(n,{kc:function(){return o}});var i=16,r="$%@#";function o(t){var n=function(t){try{t=t.replace(/_/g,"/").replace(/-/g,"+");var n=atob(t.replace(/ /g,"")).split("").map((function(t){return t.charCodeAt(0)})),e=s(n.slice(0,i)),o=s(n.slice(i,32)),a=function(t,n){if(null==t||0===t.length)return t;var e=t.length;for(;--e>=0&&!(n.indexOf(t.charAt(e))<0););return t.substr(0,e+1)}(function(t){for(var n="",e=0;e<t.length;++e)n+=String.fromCharCode(t[e]);return n}(n.slice(32)),"."),u={},c=a.split(r);if(c.length>1){a=c[0];for(var l=1;l<c.length;l++){var f=c[l].split("=");f&&2===f.length&&(u[f[0]]=f[1])}}return{OrgId:e,OwnerId:o,TableId:a,MoreInfo:u}}catch(t){return{OrgId:null,OwnerId:null,TableId:null,MoreInfo:null}}}(t),e=!1,o="0";return n.MoreInfo&&("g"===n.MoreInfo.t&&(e=!0),n.MoreInfo.c&&(o=n.MoreInfo.c)),{OrgId:n.OrgId,OwnerId:n.OwnerId,TableId:n.TableId,IsGroupOwner:e,ContainerId:o}}function s(t){if(16!==t.length)return null;var n=function(t){for(var n="",e="",i=0;i<t.length;i++)n+=e=1===(e=t[i].toString(16)).length?"0"+e:e;return n}([].concat(t.slice(0,4).reverse(),t.slice(4,6).reverse(),t.slice(6,8).reverse(),t.slice(8)));return n=n.slice(0,8)+"-"+n.slice(8,12)+"-"+n.slice(12,16)+"-"+n.slice(16,20)+"-"+n.slice(20)}},42735:function(t,n,e){"use strict";var i=e(24497),r=e(48186);function o(t,n){return t=(0,i.gA)(t),n?t?$("<div/>").html(t).text():"":t}FormsPro.getTextFromHtml=o,FormsPro.encodeBranchingString=function(t){if((0,r.l)(t)||""===t.trim())return t;var n=t.replace(/&&/g,"__BR_AND_PAR__").replace(/\|\|/g,"__BR_OR_PAR__");return n=n.replace(/\(/g,"__BR_L_PAR__").replace(/\)/g,"__BR_R_PAR__")},FormsPro.decodeBranchingString=function(t){if((0,r.l)(t)||""===t.trim())return t;var n=t.replace(/__BR_L_PAR__/g,"(").replace(/__BR_R_PAR__/g,")");return n=n.replace(/__BR_AND_PAR__/g,"&&").replace(/__BR_OR_PAR__/g,"||")}},59122:function(t,n,e){"use strict";e.d(n,{K:function(){return o}});var i=e(94290),r=e(45331);function o(t,n,e,o){return(0,r.K)(t,n,e,o,(0,i.Kw)())}},28087:function(t,n,e){"use strict";e.d(n,{Lp:function(){return o},WN:function(){return r}});var i=function(t){var n=document.createElement("a");return n.href=t,n};function r(t){return i(t).href}function o(t){return i(t).hostname}},54496:function(t,n,e){"use strict";e.d(n,{IB:function(){return c},Nw:function(){return f},bq:function(){return h},n1:function(){return a},p2:function(){return u},rG:function(){return l}});var i=e(262),r=e(92575),o=e(88744),s=e(2775);function a(t,n,e,i,r){i=i||0,e=e||0;var o=n.height(),s=t.outerHeight();if(t.offset()&&n.offset()){var a=t.offset().top-n.offset().top;if(a<0)n.scrollTop(n.scrollTop()+a-(s+e>o?0:e));else{var u=Math.min(s,o),c=a+u-o;s+e+i<o?c=a+(u=s+i)-o:s+e<o&&(u=s+e,c=a-e),c>0&&(r?n.animate({scrollTop:n.scrollTop()+c},"fast"):n.scrollTop(n.scrollTop()+c))}}}function u(t,n){var e=(0,s.l7)({},t);for(var r in n)switch(r){case"className":case"aria-labelledby":case"aria-describedby":e[r]=(0,i.j)(e[r],n[r]);break;case"children":case"defaultValue":case"value":n.hasOwnProperty(r)&&(null!=e[r]?e[r]=[].concat(e[r],n[r]):e[r]=n[r]);break;case"style":null!=e[r]?(0,s.l7)(e[r],n[r]):e[r]=n[r];break;case"onCopy":case"onCut":case"onPaste":case"onCompositionEnd":case"onCompositionStart":case"onCompositionUpdate":case"onFocus":case"onBlur":case"onChange":case"onInput":case"onSubmit":case"onLoad":case"onError":case"onKeyDown":case"onKeyPress":case"onKeyUp":case"onAbort":case"onCanPlay":case"onCanPlayThrough":case"onDurationChange":case"onEmptied":case"onEncrypted":case"onEnded":case"onLoadedData":case"onLoadedMetadata":case"onLoadStart":case"onPause":case"onPlay":case"onPlaying":case"onProgress":case"onRateChange":case"onSeeked":case"onSeeking":case"onStalled":case"onSuspend":case"onTimeUpdate":case"onVolumeChange":case"onWaiting":case"onClick":case"onContextMenu":case"onDoubleClick":case"onDrag":case"onDragEnd":case"onDragEnter":case"onDragExit":case"onDragLeave":case"onDragOver":case"onDragStart":case"onDrop":case"onMouseDown":case"onMouseEnter":case"onMouseLeave":case"onMouseMove":case"onMouseOut":case"onMouseOver":case"onMouseUp":case"onSelect":case"onTouchCancel":case"onTouchEnd":case"onTouchMove":case"onTouchStart":case"onScroll":case"onWheel":e[r]=(0,o.F)(e[r],n[r]);break;default:void 0!==n[r]&&(e[r]=n[r])}return e}function c(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(e){(0===n.length||n.indexOf(e.keyCode)>=0)&&t(e)}}function l(t){var n="hiddeon-open-iframe",e=document.getElementById(n);e&&e.parentNode.removeChild(e),(e=document.createElement("iframe")).id=n,e.name=n,e.hidden=!0,document.body.appendChild(e),e.contentWindow.location.href=t}function f(t){var n=function(t){var n=["b"],e=n.map((function(t){return"<".concat(t,">")})),i=n.map((function(t){return"</".concat(t,">")})),r=n.map((function(t){return"&lt;".concat(t,"&gt;")})),o=n.map((function(t){return"&lt;/".concat(t,"&gt;")})),a=(0,s.YU)(t);return n.forEach((function(t,n){a=a.replaceAll(r[n],e[n]).replaceAll(o[n],i[n])})),a}(t);return h(n)}function h(t){var n=document.createElement("span");return(0,r.p)(n,t),n.innerHTML}},47393:function(t,n,e){"use strict";e.d(n,{iv:function(){return f},Gh:function(){return v},gB:function(){return c},sl:function(){return l},Mh:function(){return m},mj:function(){return d}});var i=e(83894),r=e(43209),o=e(9947),s=e(87260),a=e(81620);function u(t,n,e,i){return n?i:function(t,n){var e=encodeURIComponent(t);if(-1!==n.indexOf("/oidcLogin"))return(0,a.y)(n,"ru",e);return(0,a.y)(n,"state",e)}(t,e)}function c(t){return g().then((function(){window.location.assign(t)}))}function l(){return h(!1)}function f(){return h(!0)}function h(t){return g().then((function(){window.location.reload(t)}))}function d(t){return g().then((function(){window.location.replace(t)}))}function m(t){return g().then((function(){var n=window.location,e=n.origin+t+n.search+n.hash;window.location.replace(e)}))}function v(){var t=(0,o.k0)(),n=t.userInfo,e=(t.serverSessionId,t.signInLink),s=t.signInLinkMsa,a=window.location.href,c=n.IsMsa||(0,i.ro)(),l=["ResponseDetailPage","Response"].indexOf((0,r.C2)())>-1;return u(a,c&&!l,e,s)}function g(){return(0,s.I)()}},33447:function(t,n,e){"use strict";e.d(n,{J:function(){return i}});var i="⁣"},72467:function(t,n,e){"use strict";e.d(n,{AJ:function(){return h},AX:function(){return a},BF:function(){return c},Cu:function(){return o},Ed:function(){return r},f5:function(){return l},mp:function(){return u},uq:function(){return f},zE:function(){return s}});var i=e(72377);function r(){return i.Pv.Resolve("IMixin").getMixinFormMaster()}function o(){return i.Pv.Resolve("IMixin").getMixinImageInfoMaster()}function s(){return i.Pv.Resolve("IMixin").getMixinQuestionMaster()}function a(){return i.Pv.Resolve("IFormApiMixin").getMixinFormApi()}function u(){return i.Pv.Resolve("IMixin").getMixinFormElementManager()}function c(){return i.Pv.Resolve("IMixin").getMixinImageSettingsMaster()}function l(){return i.Pv.Resolve("IMixin").getMixinDesignPageUxStateMaster().getInstance()}function f(){return i.Pv.Resolve("IMixin").getMobileDesignPageUxStateMaster().getInstance()}function h(){return i.Pv.Resolve("IMixin").getFileUploadConfirmDialog()}},70578:function(t,n,e){"use strict";e.d(n,{D8:function(){return a},yI:function(){return u}});var i=e(72467),r=e(73293),o=e(25366),s=(e(31442),e(94978),e(43367));function a(t){return o.H.isDescriptiveElement(t.Type)?r.Jv.supportMobileDesign(t):(0,s.getIoCQuestionDelegatorClass)(t.Type).supportMobileDesign(t)}function u(){return"None"!==(0,i.uq)().Model.BottomView}},13886:function(t,n,e){"use strict";function i(t){var n=(t||"").trim().replace(/[,]/g,"");return $.isNumeric(n)}function r(t){var n=(t||"").trim().replace(/[,]/g,"");return $.isNumeric(n)?parseFloat(n).toString():""}function o(t){return Math.floor(t)===t}e.d(n,{Q5:function(){return r},U:function(){return o},ZR:function(){return i}})},77494:function(t,n,e){"use strict";e.d(n,{C_:function(){return a},Tl:function(){return u},b6:function(){return c},h_:function(){return v},o0:function(){return m},x4:function(){return f}});var i=e(64290),r=e(9947),o=e(81620),s=e(90710);function a(){if((0,r.k0)().isOembedSPO||(0,s.NW)().oembedocv){var t,n=(0,i.pd)((function(){return(0,o.Uy)(".office-form.office-form-theme-shadow")}),(function(){return(0,o.Uy)(".office-form-theme-shadow")||(0,o.Uy)(".office-form-title-container")+((0,o.Uy)(".office-form-body")||(0,o.Uy)(".office-form.thank-you-page-content"))})),e=(0,o.Uy)(".office-form-footer-container");if((0,s.NW)().oembedocv)(t=(n||0)+(e||0)+12)>0&&l("ResponsePage",t);else if(n&&e)l("ResponsePage",t=n+e+80+(0,o.Uy)(".office-form-new-bottom-bar"))}}function u(){if((0,r.k0)().isOembedSPO&&$(".analysis-page-content").height()){l("AnalysisPage",$(".analysis-page-content").height()+50)}}function c(t){(0,r.k0)().isOembedSPO&&l("ResponsePage",t)}function l(t,n){var e=(0,s.NW)().hostId;if(e)parent.postMessage("FormsPageHeight:".concat(e,":").concat(n.toString()),"*");else{var i=(0,s.NW)().id;parent.postMessage("".concat(t,"Height:").concat(i,":").concat(n.toString()),"*")}}function f(t){(0,r.k0)().isOembedSPO&&function(t,n){if(!(0,r.k0)().isOembedSPO)return;var e=(0,s.NW)().hostId;parent.postMessage("FormsInfo:".concat(e,":").concat(encodeURIComponent(t),":").concat(encodeURIComponent(n)),"*")}(t.Model.Title?t.Model.Title:"",t.Model.Description?t.Model.Description:"")}function h(t){if((0,r.k0)().isOembedSPO){var n=t&&(t.innerCode||t.message||""),e=(0,s.NW)().hostId;parent.postMessage("FormsError:".concat(e,":").concat(encodeURIComponent(n)),"*")}}var d=window.onerror;function m(t,n){(0,r.k0)().isOembedSPO&&(t&&n&&function(t){if(t){var n=(0,o.Uy)(".form-content"),e=t+200;e>n&&(e=n),c(e)}}((0,o.Uy)(t)+(0,o.Uy)(n)))}function v(){l("ResponsePage",(0,o.Uy)(".thank-you-page-root-container")+12)}window.onerror=function(t,n,e,i,r){h(r),d&&d.apply(this,arguments)}},25664:function(t,n,e){"use strict";e.d(n,{A8:function(){return u},VK:function(){return l},bx:function(){return a},cb:function(){return c}});var i=e(31442),r=e(94290),o=e(47393),s=e(34570);function a(){return new Promise((function(t){var n=location.href.indexOf("experienceType=");if(n>=0){(0,i.RF)("FoundExperienceType");var e=u(location.search,"experienceType"),r=window.location.pathname,a=r.toLowerCase().startsWith(s.t.toLowerCase()),c=location.href.substring(n).toLowerCase().indexOf("pro")>=0;a&&c||!a&&!c?window.history.replaceState(null,null,r+e):(r=c?s.t+r:r.substring(s.t.length),(0,o.mj)(location.origin+r+e))}}))}function u(t,n){var e=window.location.search.substring(1);return e&&(e=e.split("&").filter((function(t){return!t.startsWith(n+"=")})).join("&")),e?"?"+e:""}function c(t){return new Promise((function(n){var e=window.location.pathname,i=e.toLowerCase().startsWith(s.t.toLowerCase());if(!t==!i)return n();var r="";if(t?(e=s.t+e,r="experienceType=base"):(e=e.substring(s.t.length),r="experienceType=pro"),location.href.indexOf("experienceType=")>=0)(0,o.Mh)(e);else{r=0===location.search.length?"?"+r:"&"+r;var a=location.origin+e+location.search+r+location.hash;(0,o.mj)(a)}}))}function l(){if((0,r.uV)())return{name:"type",operator:"ne",value:"'survey'"}}},34570:function(t,n,e){"use strict";e.d(n,{t:function(){return i}});var i="/FormsPro"},41350:function(t,n,e){"use strict";e.d(n,{Y:function(){return o},u:function(){return r}});var i=e(12611),r=function(){function t(t,n){void 0===n&&(n=0),this.kt=t,this.Ft=n}return t.prototype.callOnceLater=function(){var t=this;0!==this.Ft&&null!=this.Pt&&this.clear(),null==this.Pt&&(this.Pt=window.setTimeout((function(){t.callImmediately()}),this.Ft))},t.prototype.flush=function(){null!=this.Pt&&(this.clear(),this.kt())},t.prototype.callImmediately=function(){null!=this.Pt&&this.clear(),this.kt()},t.prototype.clear=function(){clearTimeout(this.Pt),this.Pt=void 0},t}(),o=function(){function t(){this.Mt=[]}return t.prototype.register=function(t){this.Mt.push(t)},t.prototype.unregister=function(t){this.Mt=i.without(this.Mt,t)},Object.defineProperty(t.prototype,"trigger",{get:function(){return this.Lt},enumerable:!1,configurable:!0}),t.prototype.clear=function(){this.Mt=[]},t.prototype.Lt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.Mt.forEach((function(n){return n.apply(void 0,t)}))},t}()},76669:function(t,n,e){"use strict";e.d(n,{Km:function(){return T},l4:function(){return S},v3:function(){return N}});var i,r=e(94290),o=e(29559),s=e(916),a=e(31442),u=e(7614),c=e(59312),l=function(){function t(n){if(this.secureUUID=n,t.initialize(),!this.secureUUID||0===this.secureUUID.trim().length)throw Error("The union secure uuid is null or empty.")}return t.prototype.initializeNativeEventCallback=function(t){window.officeMobileHandleNativeEvent=t},t.initialize=function(){window.officeMobileHandleNativeMessage||(window.officeMobileHandleNativeMessage=function(t){if(!t)return"responseObject is Empty";if(!t.callbackId)return"CallbackId and message are Empty";var n=window.mOfficeMobileNativeCallbackMap.get(t.callbackId);return n?(window.mOfficeMobileNativeCallbackMap.delete(t.callbackId),n(t.args)):"Unable to find callback"}),window.mOfficeMobileNativeCallbackMap||(window.mOfficeMobileNativeCallbackMap=new Map)},t.prototype.updateAndGetAuthTokenCallback=function(n,e){var i=this;t.initialize();var r="".concat(Date.now().toString(),"-").concat(t.callbackIndex++);return window.mOfficeMobileNativeCallbackMap.set(r,(function(t){var r=null;return t?t.UUID!==i.secureUUID&&(r="uuid is not same with the expected secure uuid"):r="Args is empty",null!==r?e(r):t.isSuccess?n(t.response):e(t.response),r})),r},t.callbackIndex=1e3,t}(),f=function(t){function n(n){return t.call(this,n)||this}return(0,c.ZT)(n,t),n.prototype.getServerAuthToken=function(){var n=this;return new Promise((function(e,i){if(void 0!==window.OMWebViewJSInterface&&void 0!==window.OMWebViewJSInterface.getServerAuthToken){var r=t.prototype.updateAndGetAuthTokenCallback.call(n,e,i);window.OMWebViewJSInterface.getServerAuthToken(n.secureUUID,r)}else i("App Interface not found")}))},n}(l),h=function(t){function n(n){return t.call(this,n)||this}return(0,c.ZT)(n,t),n.prototype.getServerAuthToken=function(){var n=this;return new Promise((function(e,i){var r,o;if(void 0!==window.webkit&&void 0!==window.webkit.messageHandlers.AuthToken){var s=t.prototype.updateAndGetAuthTokenCallback.call(n,e,i);null===(o=null===(r=window.webkit.messageHandlers)||void 0===r?void 0:r.AuthToken)||void 0===o||o.postMessage({UUID:n.secureUUID,callbackId:s})}else i("App Interface not found")}))},n}(l);function d(){return window.webkit&&window.webkit.messageHandlers.PageLoadCompleted?i.IOS:window.OMWebViewJSInterface&&window.OMWebViewJSInterface.onPageLoadCompleted?i.Android:i.Unknown}!function(t){t[t.Android=0]="Android",t[t.IOS=1]="IOS",t[t.Unknown=2]="Unknown"}(i||(i={}));var m,v=function(){function t(){}return t.prototype.resolvePlatformAndgetInterface=function(t,n){var e=d();return this.getInterface(t,n,e)},t.prototype.getInterface=function(t,n,e){if("v1_0_0"===n)switch(+e){case i.Android:return new f(t);case i.IOS:return new h(t);default:return null}return null},t}(),g=function(){return function(t){if(this.secureUUID=t,!this.secureUUID||0===this.secureUUID.trim().length)throw Error("The union secure uuid is null or empty.")}}(),p=function(t){function n(n){return t.call(this,n)||this}return(0,c.ZT)(n,t),n.prototype.sendLinkViaApp=function(t,n){void 0!==window.OMWebViewJSInterface&&void 0!==window.OMWebViewJSInterface.sendLinkViaApp&&window.OMWebViewJSInterface.sendLinkViaApp(this.secureUUID,t,n)},n.prototype.exitWebView=function(){void 0!==window.OMWebViewJSInterface&&void 0!==window.OMWebViewJSInterface.exitWebView&&window.OMWebViewJSInterface.exitWebView(this.secureUUID)},n.prototype.onPageLoadCompleted=function(){void 0!==window.OMWebViewJSInterface&&void 0!==window.OMWebViewJSInterface.onPageLoadCompleted&&window.OMWebViewJSInterface.onPageLoadCompleted(this.secureUUID)},n}(g),b=function(t){function n(n){return t.call(this,n)||this}return(0,c.ZT)(n,t),n.prototype.sendLinkViaApp=function(t,n){var e,i;void 0!==window.webkit&&(null===(i=null===(e=window.webkit.messageHandlers)||void 0===e?void 0:e.SendLinkViaApp)||void 0===i||i.postMessage({UUID:this.secureUUID,link:t,app:n}))},n.prototype.exitWebView=function(){var t,n;void 0!==window.webkit&&(null===(n=null===(t=window.webkit.messageHandlers)||void 0===t?void 0:t.ExitWebView)||void 0===n||n.postMessage({UUID:this.secureUUID}))},n.prototype.onPageLoadCompleted=function(){var t,n;void 0!==window.webkit&&(null===(n=null===(t=window.webkit.messageHandlers)||void 0===t?void 0:t.PageLoadCompleted)||void 0===n||n.postMessage({UUID:this.secureUUID}))},n}(g),y=function(){function t(){}return t.prototype.resolvePlatformAndgetInterface=function(t,n){var e=d();return this.getInterface(t,n,e)},t.prototype.getInterface=function(t,n,e){if("v1_0_0"===n)switch(+e){case i.Android:return new p(t);case i.IOS:return new b(t);default:return null}return null},t}(),w=e(90710);function S(t){return void 0===t&&(t=!1),new Promise((function(n,e){var r,o=function(){var t=C(),n=I(),e=null;e=t===i.Unknown?(new v).resolvePlatformAndgetInterface(window.UnionUuid,n):(new v).getInterface(window.UnionUuid,n,t);e||(0,a.zU)("createGetTokenInterface",{errorInfo:k()});return e}(),c=new s.o("Union.GetToken");if(c.start(),!o)return x(c,r="the nativeInterface is null"),void e(r);o.getServerAuthToken().then((function(i){if(i){if(c.end({resultType:"Success"}),t)return void n(i);(0,u.r)(i).then((function(){return n(i)}))}else x(c,r="the token is null or empty"),e(r)}),(function(t){c.end({resultType:"ExpectedFailure"}),e({innerCode:10302,innerMessage:t,type:"ExpectedFailure"})}))}))}function N(){return new Promise((function(t,n){try{t(T().onPageLoadCompleted())}catch(t){(0,a.zU)("Union.onPageLoadCompletedFailed",{errorInfo:t.message}),n(t)}}))}function C(){var t=(0,w.NW)()[r.hj],n=i.Unknown;if(t)switch(t){case"Android":n=i.Android;break;case"IOS":n=i.IOS}else n=d();return n===i.Unknown&&(n=(0,o.Dt)()?i.Android:(0,o.gn)()?i.IOS:i.Unknown),n}function I(){var t=(0,w.NW)()[r._y];return t||"v1_0_0"}function T(){var t=C(),n=I(),e=null;return(e=t===i.Unknown?(new y).resolvePlatformAndgetInterface(window.UnionUuid,n):(new y).getInterface(window.UnionUuid,n,t))||(0,a.zU)("createNativeInterface",{errorInfo:k()}),e}function k(){var t=C(),n=I(),e=(0,w.NW)(),i=window.location.hash?(0,w.NW)(window.location.hash):null;return"platform:".concat(t,";version:").concat(n,";platformInUrl:").concat(null==e?void 0:e[r.hj],";")+"versionInUrl:".concat(null==e?void 0:e[r._y],";id:").concat(null==e?void 0:e[r.Wy],";")+"action:".concat(null==i?void 0:i["#Action"],";formId:").concat(null==i?void 0:i["#FormId"])}function x(t,n){t.end({resultType:"Failure",extraData:{error:n}})}!function(t){t[t.Mail=0]="Mail",t[t.Teams=1]="Teams"}(m||(m={}))},32557:function(t,n,e){"use strict";e.d(n,{pw:function(){return f},tC:function(){return d},lG:function(){return h}});var i=e(59312),r=e(41420),o=e(68289),s=e(56010),a=e(9947),u=e(61018),c=e(67661),l=e(57411);function f(){return new Promise((function(t){var n,e=(0,l.tE)();if(e)if(e.isFieldReady(e.Schema.PrivacyUrl)&&e.Model.PrivacyUrl&&(n=e.Model.PrivacyUrl),n)t(n);else{var i=(0,l.BP)();e.ensureFieldsReady([c.x.Schema.Settings]).then((function(){(0,u.d8)().getPrivacySettings(i&&i.OrgId,(0,a.k0)().userInfo.TenantId,e.SettingMaster.Model.IsAnonymous).then((function(n){return t(n&&n.privacyUrl)}),(function(n){return t(void 0)}))}))}else t(void 0)}))}function h(t){var n=(0,a.k0)().userInfo.IsMsa,e=(0,a.k0)().environmentType,i=n?1:2,r=(0,s.J$)(e);if(r){var o="".concat(r,"/launch/forms"),u=void 0;if(t)u="".concat(o,"/groupforms?auth=").concat(i,"&groupId=").concat(t);else{var c=(0,s.hp)();switch(c){case"myforms":u="".concat(o,"/").concat(c,"?auth=").concat(i);break;case"officehome":u="".concat(r,"?auth=").concat(i);break;default:u="".concat(o,"?auth=").concat(i)}}window.location.assign("".concat(u,"&from=").concat("FormsDomain"))}}function d(t){window.location.assign(function(t){var n=[];t&&n.push("groupid=".concat(t));var e=(0,i.pi)((0,i.pi)({},(0,r.NW)(location.search)),(0,r.NW)(location.hash));return e.origin&&n.push("origin=".concat(e.origin)),e.fromar&&n.push("fromar=".concat(e.fromar)),e.bf&&n.push("bf=".concat(e.bf)),"".concat((0,o.v)(),"Pages/DesignPageV2.aspx").concat(n.length>0?"?".concat(n.join("&")):"")}(t))}},1014:function(t,n,e){"use strict";e.d(n,{Qn:function(){return u},To:function(){return a}});var i=e(15934),r=e(94978),o=e(90710),s=e(46008);function a(t){return(0,i.yk)(t)?"YouTube":(0,i.M4)(t)?"Stream":"Other"}function u(t,n){return(0,s.Fp)()?(0,i.yk)(t)?c(t):(0,i.M4)(t)?function(t,n){if(-1===t.indexOf("sharepoint")){var e=t.indexOf("/video"),i=t.substring(t.indexOf("?")+1),s=(0,o.NW)(i),a=s.st?"st=".concat(s.st,"&amp;"):"",u=t.indexOf("?")>-1?t.slice(e,t.indexOf("?")):t.slice(e);return c="".concat(t.slice(0,e),"/embed").concat(u,"?").concat(a,"autoplay=false&amp;showinfo=true&amp;app=forms")}var c=null;if(-1===t.indexOf("layouts")&&t.indexOf("AllItems.aspx")>=0){var l=/teams\/[^\/]+\/(.+.aspx)/,f=(0,r.Gw)("VideoOfficeStreamUrl");f&&(l=new RegExp(f,"i"));var h=t.match(l);if(h&&2===h.length){var d=h[1];c="".concat(t.replace(d,"_layouts/15/embed.aspx"),"&correlationId=").concat(n,"&client_id=Forms")}}else{var m=function(t,n){return"/".concat(n,"/embed.aspx")};c="".concat(t.replace(/\/(_layouts\/15)\/([^\s]*).aspx/,m),"&correlationId=").concat(n,"&client_id=Forms")}return c}(t,n):void 0:c(t)}function c(t){var n=document.createElement("a");n.href=t;var e=n.pathname.split("/"),i=t.substring(t.indexOf("?")+1),r=(0,o.NW)(i),s=r.v||e[0]||e[1],a=r.t?"&start=".concat(r.t):"";return"https://www.youtube.com/embed/".concat(s,"?modestbranding=1&rel=0").concat(a)}},46008:function(t,n,e){"use strict";e.d(n,{$T:function(){return w},B6:function(){return T},Ei:function(){return k},Fp:function(){return p},I8:function(){return y},LQ:function(){return C},LU:function(){return S},Nu:function(){return I},X9:function(){return h},Zh:function(){return N},hu:function(){return f},ko:function(){return g},m$:function(){return m},rA:function(){return b},wM:function(){return d},xO:function(){return v}});var i=e(60211),r=e(94290),o=e(43209),s=e(29559),a=e(83894),u=e(2775),c=e(83830),l=e(90710);function f(t,n){if(!t&&!(0,i.yv)()&&!(0,i.Gd)()){var e=(new Error).stack;console.assert(t,n,e)}}function h(){return(0,u.CE)((0,l.NW)(),"embed","oembedsso","themecolor","preview")}function d(){return!!(0,l.NW)().embed}function m(){return!!(0,l.NW)().oembedsso&&!!(0,l.NW)().preview}function v(){return!(!(0,r.GF)()&&!g()&&"Fluid"!==(0,o.C2)())}function g(){return!(!(0,r.Kw)()||!(0,i.yv)()||"Analyze"===(0,o.C2)())}function p(){return!(0,a.ro)()&&!(0,i.x8)()}function b(t){return void 0===t&&(t=768),$(window).width()<=t}function y(t){var n=(0,u.d9)(t);return(0,u.S6)(n,(function(t,e){(0,u.Kn)(t)&&(n[e]=y(t))})),n}function w(t){return(0,u.XP)(t).filter($.isNumeric).map((function(n){return t[n]}))}function S(){var t=null,n=window.location!==window.parent.location?document.referrer:document.location.href;return n&&(t=new URL(n).origin),t}function N(){var t=(0,c.v)();return t.substring(0,t.length-1)}function C(){if((0,s.lZ)()){var t=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(t,"px"))}}function I(t){if("function"==typeof CustomEvent)window.setTimeout((function(){return window.dispatchEvent(new CustomEvent(t))}));else{var n=document.createEvent("CustomEvent");n.initEvent(t,!0,!0),document.createElement("element").dispatchEvent(n)}}function T(t){document.execCommand("print",!1,null)||window.print(),"function"==typeof t&&((0,s.G6)()?setTimeout((function(){t()}),3e3):t())}function k(t){return t}},70877:function(t,n,e){"use strict";e.d(n,{B9:function(){return a},N3:function(){return s},ax:function(){return c},eM:function(){return u}});var i=e(12611),r=e(15934),o=e(19976),s="officeforms.youtubebarstatus";function a(t,n){return!u(n)&&(0,r.yk)(t)}function u(t){return(0,o.a)().Model.FormsTenantSettings.bingImageSearch||t&&t.isFieldReady(t.Schema.TenantSwitches)&&1===t.Model.TenantSwitches}function c(t){if(!u(t)){var n=t.FormElementManager.TopQuestionMasters,e=t.FormElementManager.SectionMasters;return i.some(n,l)||i.some(e,l)}}function l(t){var n=t.Model.VideoInfo&&t.Model.VideoInfo.Url;return n&&(0,r.yk)(n)}},77209:function(t,n,e){"use strict";function i(t){return t?(t.startsWith("t=")||t.startsWith("Bearer")?"":"Bearer ")+t:""}e.d(n,{U:function(){return i}})},49306:function(t,n,e){"use strict";e.d(n,{F:function(){return a},I:function(){return u}});var i,r,o=e(31442),s=e(61018);function a(t,n){if(!r){var e=s.VY.getInstance().createDataProvider();(r=e.getDataClassificationLabelDetail(t,n)).catch((function(t){(0,o.zU)("TenantDataClassificationLevelDetailGetFailure",t)}))}return r}function u(){return i||(i=new Promise((function(t,n){$((function(){s.VY.getInstance().createDataProvider().getDataClassificationLabels().then(t,n)}))}))).catch((function(t){(0,o.zU)("TenantDataClassificationLevelsGetFailure",t)})),i}},23946:function(t,n,e){"use strict";e.d(n,{d:function(){return u}});var i=e(9947),r=e(72317),o=e(77209),s=e(46298),a=e(5892);function u(t,n){return(0,r.a)().AuthContext.getFormApiToken().then((function(e){var r;return t.headers=$.extend(!0,t.headers,(r=e||"",{__RequestVerificationToken:(0,i.k0)().antiForgeryToken,Accept:"application/json",Authorization:(0,o.U)(r),"Content-Type":"application/json"})),(0,s.lW)(t,n).then((function(t){return t?(0,a.EI)(t):Promise.reject("Data is null.")}),a.W3)}))}},66557:function(t,n,e){"use strict";e.d(n,{Ng:function(){return H},sK:function(){return E},UF:function(){return A},GO:function(){return B},nY:function(){return _},qH:function(){return O},sE:function(){return G}});var i,r,o,s,a,u,c,l,f,h,d,m,v,g,p,b,y,w=(0,e(4851).Rm)((function(){return"complete"===document.readyState?Promise.resolve():new Promise((function(t){document.addEventListener("readystatechange",(function(){"complete"===document.readyState&&t()}))}))})),S=e(94290),N=e(9947),C=e(83894),I=e(2775);function T(){return h}function k(){return d}function x(){return m}function F(){return g}function P(t,n){var e=(0,I.Ry)(t.map((function(t){var n=t.licenseName,e=t.skus;return[n.toUpperCase(),JSON.parse(e)]})));return function(t){for(var n in i)if(t.hasOwnProperty(i[n])){var e=t[i[n]];if(e&&e.length>0)return void(h=!0)}h=!1}(e),function(t){for(var n in r)if(t.hasOwnProperty(r[n])){var e=t[r[n]];if(e&&e.length>0)return d=!0,void parseInt(n)}d=!1}(e),function(t){for(var n in o)if(t.hasOwnProperty(o[n])&&(e=t[o[n]])&&e.length>0){v=!0,parseInt(n);break}for(var n in s)if(t.hasOwnProperty(s[n])&&(e=t[s[n]])&&e.length>0){parseInt(n);break}for(var n in a){var e;if(t.hasOwnProperty(a[n])&&(e=t[a[n]])&&e.length>0){parseInt(n);break}}}(e),function(t){m=!(!(0,C.ro)()||!t)}(n),function(t){for(var n in u)if(t.hasOwnProperty(u[n])){var e=t[u[n]];if(e&&e.length>0)return void(g=!0)}g=!1}(e),function(t){for(var n in c)t.hasOwnProperty(c[n])&&(e=t[c[n]])&&e.length>0&&(p=!0);for(var n in l)t.hasOwnProperty(l[n])&&(e=t[l[n]])&&e.length>0&&(y=!0);for(var n in f){var e;t.hasOwnProperty(f[n])&&(e=t[f[n]])&&e.length>0&&(b=!0)}}(e),e}function D(){var t=0;return T()&&(t=1),k()&&(t|=2),(0,C.Wh)()&&(t|=8),(0,C.ro)()&&(x()?t|=16:t|=4),F()&&(t|=64,p?t|=128:y?t|=256:b&&(t|=512)),t}!function(t){t[t.OFFICE_FORMS_PLAN_2=0]="OFFICE_FORMS_PLAN_2",t[t.OFFICE_FORMS_PLAN_3=1]="OFFICE_FORMS_PLAN_3"}(i||(i={})),function(t){t[t.FORMS_PLAN_E1=0]="FORMS_PLAN_E1",t[t.FORMS_PLAN_E3=1]="FORMS_PLAN_E3",t[t.FORMS_PLAN_E5=2]="FORMS_PLAN_E5",t[t.FORMS_PLAN_K=3]="FORMS_PLAN_K"}(r||(r={})),function(t){t[t.FORMS_GOV_E1=0]="FORMS_GOV_E1",t[t.FORMS_GOV_E3=1]="FORMS_GOV_E3",t[t.FORMS_GOV_E5=2]="FORMS_GOV_E5",t[t.FORMS_GOV_F1=3]="FORMS_GOV_F1"}(o||(o={})),function(t){t[t.FORMS_GCCHIGH_E1=0]="FORMS_GCCHIGH_E1",t[t.FORMS_GCCHIGH_E3=1]="FORMS_GCCHIGH_E3",t[t.FORMS_GCCHIGH_E5=2]="FORMS_GCCHIGH_E5",t[t.FORMS_GCCHIGH_F1=3]="FORMS_GCCHIGH_F1"}(s||(s={})),function(t){t[t.FORMS_DOD_E1=0]="FORMS_DOD_E1",t[t.FORMS_DOD_E3=1]="FORMS_DOD_E3",t[t.FORMS_DOD_E5=2]="FORMS_DOD_E5",t[t.FORMS_DOD_F1=3]="FORMS_DOD_F1"}(a||(a={})),function(t){t[t.FORMS_PRO=0]="FORMS_PRO",t[t.FORMS_PRO_USL=1]="FORMS_PRO_USL",t[t.FORMS_PRO_USL_GCC=2]="FORMS_PRO_USL_GCC",t[t.FORMS_PRO_CE=3]="FORMS_PRO_CE",t[t.FORMS_PRO_SERVICE=4]="FORMS_PRO_SERVICE",t[t.FORMS_PRO_FS=5]="FORMS_PRO_FS",t[t.FORMS_PRO_MARKETING=6]="FORMS_PRO_MARKETING",t[t.FORMS_PRO_PLAN=7]="FORMS_PRO_PLAN",t[t.FORMS_PRO_PS=8]="FORMS_PRO_PS",t[t.FORMS_PRO_SALESENT=9]="FORMS_PRO_SALESENT",t[t.FORMS_PRO_TALENT=10]="FORMS_PRO_TALENT",t[t.FORMS_PRO_OPERATIONS=11]="FORMS_PRO_OPERATIONS",t[t.FORMS_PRO_RELATIONSHIP_SALES=12]="FORMS_PRO_RELATIONSHIP_SALES",t[t.FORMS_PRO_CUSTOMER_INSIGHTS=13]="FORMS_PRO_CUSTOMER_INSIGHTS",t[t.FORMS_PRO_SERVICE_GCC=14]="FORMS_PRO_SERVICE_GCC",t[t.FORMS_PRO_FS_GCC=15]="FORMS_PRO_FS_GCC",t[t.FORMS_PRO_HUMAN_RESOURCES_GCC=16]="FORMS_PRO_HUMAN_RESOURCES_GCC",t[t.FORMS_PRO_PS_GCC=17]="FORMS_PRO_PS_GCC",t[t.FORMS_PRO_SALESENT_GCC=18]="FORMS_PRO_SALESENT_GCC",t[t.FORMS_PRO_CE_GCC=19]="FORMS_PRO_CE_GCC"}(u||(u={})),function(t){t[t.FORMS_PRO_USL=0]="FORMS_PRO_USL",t[t.FORMS_PRO_USL_GCC=1]="FORMS_PRO_USL_GCC"}(c||(c={})),function(t){t[t.FORMS_PRO_CE=0]="FORMS_PRO_CE",t[t.FORMS_PRO_SERVICE=1]="FORMS_PRO_SERVICE",t[t.FORMS_PRO_FS=2]="FORMS_PRO_FS",t[t.FORMS_PRO_MARKETING=3]="FORMS_PRO_MARKETING",t[t.FORMS_PRO_PLAN=4]="FORMS_PRO_PLAN",t[t.FORMS_PRO_PS=5]="FORMS_PRO_PS",t[t.FORMS_PRO_SALESENT=6]="FORMS_PRO_SALESENT",t[t.FORMS_PRO_TALENT=7]="FORMS_PRO_TALENT",t[t.FORMS_PRO_OPERATIONS=8]="FORMS_PRO_OPERATIONS",t[t.FORMS_PRO_RELATIONSHIP_SALES=9]="FORMS_PRO_RELATIONSHIP_SALES",t[t.FORMS_PRO_CUSTOMER_INSIGHTS=10]="FORMS_PRO_CUSTOMER_INSIGHTS",t[t.FORMS_PRO_SERVICE_GCC=11]="FORMS_PRO_SERVICE_GCC",t[t.FORMS_PRO_FS_GCC=12]="FORMS_PRO_FS_GCC",t[t.FORMS_PRO_HUMAN_RESOURCES_GCC=13]="FORMS_PRO_HUMAN_RESOURCES_GCC",t[t.FORMS_PRO_PS_GCC=14]="FORMS_PRO_PS_GCC",t[t.FORMS_PRO_SALESENT_GCC=15]="FORMS_PRO_SALESENT_GCC",t[t.FORMS_PRO_CE_GCC=16]="FORMS_PRO_CE_GCC"}(l||(l={})),function(t){t[t.FORMS_PRO=0]="FORMS_PRO"}(f||(f={}));e(64290);var M,L=e(31442),R=e(8759);function A(){return q().then(T,(function(){return!1}))}function E(){return q().then(k,(function(){return!1}))}function O(){return q().then((function(){return(0,C.ro)()&&!x()}),(function(){return!1}))}function _(){return q().then((function(){return!!v}),(function(){return!1}))}function B(){return q().then(F,(function(){return!1}))}function H(){return q().then(D,(function(){return 0}))}function G(){(0,R.sE)().then((function(t){P(t.licenses,t.isPaidUser)})).catch((function(t){(0,L.zU)("RefreshUserInfoFailed",t)}))}function q(){return M||(M=new Promise((function(t,n){w().then((function(){if((0,N.k0)().userInfo.UserId||(0,S.CE)()||(0,S.Kw)())try{var e=(0,N.k0)().userLicenseInfo;if(null==e?void 0:e.id){var i=P(e.licenses,e.isPaidUser);t(i)}else(0,R.bG)().then((function(n){var e=P(n.licenses,n.isPaidUser);t(e)})).catch(n)}catch(t){n(t)}else t({})}))}))).catch((function(t){(0,L.zU)("UserInfoGetFailure",t)})),M}},88807:function(t,n,e){"use strict";e.d(n,{L:function(){return f}});var i=e(73252),r=e(60211),o=e(51254),s=e(37076),a=e(81380),u=e(46298),c="GetDriveItem",l=(0,r.yv)()?"https://graph.microsoft.com/v1.0/":"https://graph.microsoft-ppe.com/v1.0/",f=function(){function t(t){this.At=t.Model.Id,t&&(this.Ot=(0,a.lK)(t))}return t.prototype.createFileUploadSession=function(t,n){return this.Ot.createUploadSession(this.At,t,n).then((function(t){if(null==t)throw new Error("no data return");return t}))},t.prototype.cancelOrDeleteUploadFile=function(t){return this.Ot.cancelOrDeleteUploadFile(t)},t.prototype.uploadBytesToSession=function(t,n,e,i,r,o){return(0,u.lW)({body:n,headers:{"Content-Range":"bytes ".concat(i,"-").concat(r,"/").concat(o),"Content-Type":"*/*"},method:"PUT",qosEventName:"FileUpload.UploadFile",requestUri:t.uploadUrl})},t.prototype.getFileFolder=function(t){var n=this;return(0,i.cr)("GetDriveItemFromFormApi")?(0,u.lW)({headers:{"Content-Type":"*/*"},method:"GET",isSensitiveUri:!0,qosEventName:o.WW+c+"FromFormAPI",requestUri:"/formapi/api/".concat(h(this.At),"/graphDriveItem/").concat(t)}).then((function(t){return t&&(t.WebUrl||t.webUrl)})):(0,o.d6)((function(e){return(0,u.lW)({headers:{Authorization:e,"Content-Type":"*/*"},method:"GET",isSensitiveUri:!0,qosEventName:o.WW+c,requestUri:"".concat(l).concat(h(n.At),"/drive/items/").concat(t)})})).then((function(t){return t.webUrl}))},t}();function h(t){var n=(0,s.kc)(t),e=n.OwnerId,i=n.OrgId,r=n.IsGroupOwner?"groups":"users";return"".concat(i,"/").concat(r,"/").concat(e)}},68246:function(t,n,e){"use strict";e.d(n,{A:function(){return u}});var i=e(69856),r=e(86353),o=e(9947),s=e(83830),a=e(23946),u=function(){function t(t,n,e,i){var o;this._t="".concat(t,"intelligence/api/"),this.Bt=n&&e&&i?"".concat(this._t).concat(n,"/").concat(i,"/").concat(e,"/"):"".concat(this._t);var s=(0,r.Tl)();this.Ht={IntelligenceExp1:null===(o=null==s?void 0:s.IntelligenceExp1)||void 0===o?void 0:o.replace(/"/g,"")}}return t.createIntelligenceProvider=function(n,e,i){return new t((0,s.v)(),e,i,3===n?"groups":"users")},t.prototype.getInsights=function(t,n,e){return(0,a.d)({method:"GET",qosEventName:"Intelligence.GetInsights",requestUri:this.Bt+"forms('".concat(t,"')/getinsights(").concat(n,",").concat(e,")")})},t.prototype.getCachedInsights=function(t){return(0,a.d)({method:"GET",qosEventName:"Intelligence.GetCachedInsights",requestUri:this.Bt+"forms('".concat(t,"')/getcachedinsights")})},t.prototype.getOrCalculateInteractiveInsights=function(t){return(0,a.d)({method:"GET",qosEventName:"Intelligence.GetInteractiveInsights",requestUri:this.Bt+"forms('".concat(t,"')/getorcalculateinteractiveinsights")})},t.prototype.getIntelligenceInsights=function(t,n,e,r,o){return void 0===e&&(e=i.K.Form),void 0===r&&(r=""),void 0===o&&(o=[]),(0,a.d)({body:JSON.stringify({ContextType:e,ContextId:r,ResponseCount:n,InsightTypes:o,Experiments:this.Ht}),method:"POST",qosEventName:"Intelligence.GetIntelligenceInsights",qosExtraData:{experiments:this.Ht},requestUri:this.Bt+"forms('".concat(t,"')/getIntelligenceInsights")})},t.prototype.getOptionToOptionSuggestion=function(t,n,e){return(0,a.d)({body:JSON.stringify({existingOptions:t,variation:e}),method:"POST",qosEventName:"Ingelligence.GetOptionToOptionSuggestion",qosExtraData:{feature:n,variation:e},requestUri:this.Bt+"getOptionToOptionSuggestion"})},t.prototype.getHistorySuggestion=function(t,n,e){var i=(0,o.k0)().userInfo,r=i&&i.TenantId,s=i&&i.UserId,u="".concat(this._t).concat(r,"/users/").concat(s,"/getHistoryFormSuggestion");return(0,a.d)({body:JSON.stringify({Text:t,FormId:n,IsQuiz:e}),method:"POST",qosEventName:"Ingelligence.GetHistorySuggestion",requestUri:u})},t.prototype.predictResponseTime=function(t){var n="".concat(this._t,"PredictResponseTime");return(0,a.d)({body:JSON.stringify(t),method:"POST",qosEventName:"Intelligence.PredictResponseTime",requestUri:n})},t.prototype.textAnalyze=function(t){return this.textAnalyzeWithFeatures(256,t)},t.prototype.textAnalyzeWithFeatures=function(t,n){if(!n){return Promise.resolve({Features:0,Results:[]})}return(0,a.d)({body:JSON.stringify({Features:t,Text:n,Experiments:this.Ht}),method:"POST",qosEventName:"Question.TextAnalysis",qosExtraData:{Features:t},requestUri:this.Bt+"textanalysis3"})},t.prototype.logUserSignal=function(t){return(0,a.d)({body:JSON.stringify(t),method:"POST",qosEventName:"Intelligence.LogUserSignal",requestUri:this._t+"LogUserSignal"})},t.prototype.askSuggestion=function(t){var n={Feature:null==t?void 0:t.Feature};return(0,a.d)({body:JSON.stringify(t),method:"POST",qosEventName:"Intelligence.AskSuggestion",qosExtraData:n,requestUri:this._t+"ask"})},t.prototype.askSuggetions=function(t){var n={Feature:null==t?void 0:t.Feature};return(0,a.d)({body:JSON.stringify(t),method:"POST",qosEventName:"Intelligence.AskSuggestions",qosExtraData:n,requestUri:this._t+"askSuggestions"})},t}()},22810:function(t,n,e){"use strict";e.d(n,{PR:function(){return a},ex:function(){return u},nT:function(){return l},o6:function(){return c}});var i=e(64459),r=e(55411),o=e(51254),s=e(46298);function a(t){return f("".concat((0,r.HA)(),"/users/").concat(t),"GetUser")}function u(t){return f("".concat((0,r.HA)(),"/groups/").concat(t),"GetGroup")}function c(t){return f("".concat((0,r.HA)(),"/me/checkMemberGroups"),"CheckMemberGroups","POST",'{"groupIds": ["'.concat(t,'"] }'))}function l(t){return f("".concat((0,r.HA)(),"/directory/deletedItems/").concat(t),"GetDeletedItem")}function f(t,n,e,r){return void 0===e&&(e="GET"),void 0===r&&(r=null),(0,o.d6)((function(i){var a={body:r,headers:{Authorization:i,"Content-Type":"application/json"},isSensitiveUri:!0,method:e,qosEventName:o.WW+n,requestUri:t};return(0,s.lW)(a,{disableLog:!0,disableXMsHeader:!0,skipExpiredTokenCheck:!0})})).then((function(t){return(0,i.d)(t)}))}},54438:function(t,n,e){"use strict";e.d(n,{m:function(){return a}});var i=e(81380),r=e(51586),o=function(){function t(t,n){this.Gt=[],this.qt=t,n=n||{},this.Vt=n.deferredTimeInMs||100,this.zt=n.maxCount||10}return t.prototype.insert=function(t){var n=this,e=new Promise((function(e,i){n.Gt.push({Arguments:t,Resolve:e,Reject:i})}));return this.Gt.length>=this.zt?this.Qt():void 0===this.Ut&&(this.Ut=window.setTimeout((function(){return n.Qt()}),this.Vt)),e},t.prototype.Qt=function(){var t=this.Gt;this.Gt=[],void 0!==this.Ut&&(window.clearTimeout(this.Ut),this.Ut=void 0),0!==t.length&&this.qt(t.map((function(t){return t.Arguments}))).then((function(n){if(t.length!==n.length)throw Error("All the elements needs to be listed in result array.");n.forEach((function(n,e){n.Succeeded?t[e].Resolve(n.Value):t[e].Reject(n.Error)}))})).catch((function(n){t.forEach((function(t){t.Reject(n)}))}))},t}(),s={};function a(t,n){return s.hasOwnProperty(n)||(s[n]=new o((function(t){return function(t,n){var e=t.length,o=(0,r.OM)(n);if(o)return(0,i.lK)(o).copyLocaleResources(n,t).then((function(){for(var t=[],n=0;n<e;++n)t.push({Succeeded:!0,Value:void 0});return t}),(function(t){for(var n=[],i=0;i<e;++i)n.push({Error:t,Succeeded:!1});return n}));return Promise.resolve(null)}(t,n)}))),s[n].insert(t)}},46298:function(t,n,e){"use strict";e.d(n,{lW:function(){return F},MM:function(){return D}});var i=e(59312),r=e(12611),o=e.n(r),s=e(37043),a=e(60211),u=e(79552),c=e(9947),l=e(916),f=e(41480),h=e(83894),d=e(84475),m=e(59469),v=e(94978),g=e(57411),p=e(21607);function b(t){for(var n={},e=0,i=t.getAllResponseHeaders().split(/\r?\n/);e<i.length;e++){var r=i[e];if(r){var o=r.indexOf(": "),s=r.substring(0,o),a=r.substring(o+2);n[s]=a}}return n}var y,w=e(47393),S=e(72317),N=(e(64290),e(44644)),C=e(99437),I=e(5892);var T={},k={},x=null;function F(t,n,e){var r,b;void 0===n&&(n={});var F=t.qosEventName,D=-1!==((0,v.Gw)("ThrottledQosEventNames")||[]).indexOf(F),R=!n.disableLog,A=-1;R&&!D||(x||(x=setInterval((function(){Object.keys(T).forEach((function(t){T[t]=!0}))}),6e5)),void 0===T[F]||T[F]?(R=!0,A=null!==(r=k[F])&&void 0!==r?r:0,T[F]=!1,k[F]=0):(R=!1,void 0!==k[F]?++k[F]:k[F]=1));if(R){b=null!=e?e:new l.o(F);var E=o().clone(t.qosExtraData);A>=0&&(E=(0,i.pi)({SkippedCount:A},E)),b.ExtraData=E,b.start(),t.headers["X-CorrelationId"]=b.CorrelationId,t.headers["X-UserSessionId"]=(0,f.k)()}n.disableXMsHeader||(t.headers["x-ms-form-request-source"]=(0,d.A)(),n.disableRequestRingHeader||(t.headers["x-ms-form-request-ring"]=(y||((0,c.k0)().ring&&!(0,a.x8)()&&(y=(0,c.k0)().ring.toLowerCase()),y="USGovGccProd"===(0,a.kD)()?"gcc":(0,h.ro)()||(0,g.M5)()?"msa":(0,h.Wh)()||(0,g.gq)()?"msft":(0,h.Ak)()||(0,g.eT)()?"fastfood":"business"),y)));var O=-1,_=new Promise((function(e,i){var r=function(){O++,function(t,n,e,i){void 0===i&&(i=!1);t.blobResponseType?M(t,n,i?e:r):L(t,n,i?e:r);function r(i){(0,m.hh)(i)?(0,S.a)().AuthContext.refreshToken().then((function(i){(0,p.Yq)(i).then((function(){t.headers.__RequestVerificationToken=(0,c.k0)().antiForgeryToken,i&&"string"==typeof i&&(t.headers.Authorization=(0,s.U)(i)),o().then((function(){return L(t,n,e)}))})).catch(w.sl)}),e):(0,m.xO)(i)?(0,m.ad)():(0,m.D1)(i)?(0,S.a)().AuthContext.signIn().then(w.iv):e(i)}function o(){return(0,c.k0)().userInfo.UserId?Promise.resolve():(0,p.sE)().catch((function(){}))}}(t,(function(t){e(t)}),(function(e){var o,s=t.isSensitiveUri?void 0:t.requestUri.toString(),a=(0,C.Lo)(s,e,n.processQosInnerMessageOnFailureOrRetry),u=a.statusCode,c=a.innerCode,l=!1,f=0;if(502===u?(o="Forms_Http_"+u,l=O<2):503===u?(o="Forms_Http_"+u,l=O<5,f=P(O,!1)):504===u||0===u?(f=5e3,o="Forms_Http_"+u,l=O<6):6503===c||624===c||647===c?(o="CDB_Http_"+c,l=O<2):645===c||646===c?((0,S.a)().RetryingRecoverableError=!0,o="CDB_Http_"+c,l=O<10,f=P(O,n.hasPrefetch)):6300===c&&(o="CDB_Net_"+c,l=O<2),!l)return i(e);b&&b.log({resultCode:o,extraData:{RetryCount:O,RetryInterval:f,ServiceError:a}}),setTimeout(r,f)}),n.skipExpiredTokenCheck)};r()}));return b?_.then((function(n){var e,i,r={resultCode:(null===(i=null===(e=null==n?void 0:n.response)||void 0===e?void 0:e.response)||void 0===i?void 0:i.statusCode)||"",resultType:"Success"};if("Form.Create"===t.qosEventName){var s=(0,I.EI)(n);r.extraData={FormId:s.id,Origin:(0,N.P)()||void 0,RetryCount:O||void 0,XLWorkbookId:s.xlWorkbookId||void 0},o().extend(r.extraData,t.qosExtraData)}else if("Response.Submit"===t.qosEventName){s=(0,I.EI)(n);r.extraData={responseId:s&&s.id},o().extend(r.extraData,t.qosExtraData)}return b.end(r),n})).catch((function(e){var i=t.isSensitiveUri?void 0:t.requestUri.toString(),r=(0,C.Lo)(i,e,n.processQosInnerMessageOnFailureOrRetry);throw b.end({resultCode:e&&e.response?e.response.statusCode:"",resultType:(0,u.WP)(r)?"ExpectedFailure":"Failure",extraData:{ServiceError:r,RetryCount:O||void 0}}),e})):_}function P(t,n){var e=[2,16,32,64],i=t>=e.length?64:e[t];return n&&(i*=2),1e3*Math.min(i,64)*(.8+.4*Math.random())}function D(t,n){return void 0===n&&(n={}),new Promise((function(n,e){M(t,n,e,!0)}))}function M(t,n,e,i){void 0===i&&(i=!1);var r=new XMLHttpRequest,o=t.requestUri;if(r.onreadystatechange=function(){if(null!=r&&4===r.readyState){var s=r.status,a=r.statusText;1223===s&&(s=204,a="No Content");var u=r.response;if(s>=200&&s<=299){if(i){var c=b(r);u={requestUri:o,statusCode:s,statusText:a,headers:c,body:u}}r=null,n(u)}else{c=b(r);r=null,e({message:"HTTP request failed",request:t,response:{requestUri:o,statusCode:s,statusText:a,headers:c,body:u}})}}},r.open(t.method||"GET",o,!0),r.responseType="blob",t.headers)for(var s in t.headers)r.setRequestHeader(s,t.headers[s]);r.send(t.body)}function L(t,n,e){odatajs.oData.request(t,n,e)}},61018:function(t,n,e){"use strict";e.d(n,{VY:function(){return N},d8:function(){return C},GA:function(){return I}});var i=e(60211),r=e(9947),o=e(55411),s=e(83830),a=e(72467),u=e(916),c=e(41480),l=e(97265),f=e(59469),h=e(21607),d=e(47393),m=e(72317),v=(e(64290),function(){function t(t){for(this._t=t.trim();"/"===this._t.charAt(this._t.length-1);)this._t=this._t.substr(0,this._t.length-1)}return t.prototype.$t=function(t){return this._t+"/"+t},t.prototype.deleteQuestionImage=function(t,n,e){var i=this;return g().then((function(r){return y(r,i.$t(b(t,n,e)))}))},t.prototype.uploadQuestionImage=function(t,n,e,i){var r=this;return g().then((function(o){return w(o,r.$t(b(t,n,e)),e,i)}))},t.prototype.deleteFormImage=function(t,n){var e=this;return g().then((function(i){return y(i,e.$t(p(t,n)))}))},t.prototype.uploadFormImage=function(t,n,e){var i=this;return g().then((function(r){return w(r,i.$t(p(t,n)),n,e)}))},t}());function g(){return(0,m.a)().AuthContext.getFormApiToken()}function p(t,n){return"forms('{0}')/{1}".format(t,n)}function b(t,n,e){return"forms('{0}')/questions('{1}')/{2}".format(t,n,e)}function y(t,n){var e=new u.o("Image.Delete");e.start();return S({methodName:"DELETE",url:n,headers:{Authorization:t?"Bearer "+t:"","X-CorrelationId":e.CorrelationId,"X-UserSessionId":(0,c.k)()},successHandler:function(){return e.end({resultType:"Success"})},errorHandler:function(t){var i={correlationId:e.CorrelationId,innerCode:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.code,statusCode:t.status,innerMessage:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.message,statusText:t.statusText};return e.end({resultType:"Failure",extraData:{imageUrl:n,error:i}}),i}})}function w(t,n,e,i){var r=new u.o("Image.Upload");r.start();return S({methodName:"PUT",url:n,headers:{Authorization:t?"Bearer "+t:"","Content-Type":i.ImageType,"Content-Disposition":"attachment; name={0}; filename={1}".format((0,l.GW)(),i.ImageName),"X-CorrelationId":r.CorrelationId,"X-UserSessionId":(0,c.k)()},successHandler:function(t){if(!t||!t.resourceId){var i={correlationId:r.CorrelationId,innerCode:5200,statusCode:0,innerMessage:"Upload image return bad response",statusText:"CollabDb bad response"};throw r.end({resultType:"Failure",extraData:{imageUrl:n,error:i,imageType:e}}),i}return r.end({resultType:"Success",extraData:{imageType:e}}),{altText:t.altText,contentType:t.contentType,fileIdentifier:t.fileIdentifier,originalFileName:t.originalFileName,resourceId:t.resourceId,resourceUrl:t.resourceUrl,height:t.height,width:t.width}},errorHandler:function(t){var e={correlationId:r.CorrelationId,innerCode:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.code,statusCode:t.status,innerMessage:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.message,statusText:t.statusText};return r.end({resultType:"Failure",extraData:{imageUrl:n,error:e}}),e},blob:i.ImageBlob})}function S(t){var n=t.methodName,e=t.url,i=t.headers,o=t.successHandler,s=t.errorHandler,a=t.data,u=t.blob,c=new XMLHttpRequest;return c.open(n,e),c.setRequestHeader("__RequestVerificationToken",(0,r.k0)().antiForgeryToken),Object.keys(i).forEach((function(t){c.setRequestHeader(t,i[t])})),a?(c.setRequestHeader("content-type","application/json; charset=utf-8"),c.send(a)):u?c.send(u):c.send(),new Promise((function(t,n){c.onreadystatechange=function(){if(c.readyState===XMLHttpRequest.DONE){var e=c.status;200===e||202===e||201===e||204===e?t(c.responseText&&JSON.parse(c.responseText)):n(c.statusText)}}})).then(o,(function(t){if(!(0,f.hh)(t))return s(t);(0,m.a)().AuthContext.refreshToken().then(h.Yq).then((function(){return S({methodName:n,url:e,headers:i,successHandler:o,errorHandler:s,data:a,blob:u})})).catch(d.sl)}))}var N=function(){function t(){if(t.instance)return t.instance;t.instance=this}return t.getInstance=function(){return new t},t.prototype.getOwnerServiceUrl=function(t,n,e){return 1===t?this.getFormApiServiceUrl():4===t?this.getFormApiServiceUrl()+"me/":n&&e?this.getFormApiServiceUrl()+n+(3===t?"/groups/":"/users/")+e+"/":null},t.prototype.createDataProvider=function(t,n,e){void 0===t&&(t=1),void 0===n&&(n=null),void 0===e&&(e=null);var i=(0,a.AX)();if(1===t)return this.defaultDataProvider||(this.defaultDataProvider=new i(this.getFormApiServiceUrl(),this.getFormApiServiceUrl())),this.defaultDataProvider;var r=this.getOwnerServiceUrl(t,n,e);return r&&new i(this.getFormApiServiceUrl(),r)},t.prototype.createImageProvider=function(t,n,e){if(void 0===t&&(t=1),void 0===n&&(n=null),void 0===e&&(e=null),1===t)return this.currentImageProvider||(this.currentImageProvider=new v(this.getFormApiServiceUrl())),this.currentImageProvider;var i=this.getOwnerServiceUrl(t,n,e);return i&&new v(i)},t.prototype.getFormApiServiceUrl=function(){return this.getServiceUrl("formapi/api/")},t.prototype.getCollabDBServiceUrl=function(){var t=(0,i.kD)();return(0,o.lz)(t)},t.prototype.getServiceUrl=function(t){return(0,s.v)()+t},t}();function C(){return N.getInstance().createDataProvider()}function I(t){return N.getInstance().createDataProvider(3,(0,r.k0)().userInfo.TenantId,t)}},99437:function(t,n,e){"use strict";e.d(n,{QX:function(){return s},mS:function(){return l},Lo:function(){return c}});var i=e(81620),r=e(94978),o=[];function s(t){var n,e=null==t?void 0:t.response,r={error:{code:"".concat(15001),message:"[PIIRisk: Full Response logging.] "}},o=e&&e.statusCode;try{(null==e?void 0:e.body)&&(r=JSON.parse(e.body))}catch(t){if(401===o){var s=(0,i.jL)(null==e?void 0:e.headers,"WWW-Authenticate");s&&-1!==s.indexOf("invalid_token")&&(r.error.code="".concat(701))}}var u=(null===(n=r.error)||void 0===n?void 0:n.code)&&parseInt(r.error.code);if(isNaN(u))switch(o){case 0:u=15001,r.error&&(r.error.message="HTTP status code is 0");break;case 429:u=15429}var c={correlationId:(0,i.jL)(null==e?void 0:e.headers,"X-CorrelationId"),headers:null==e?void 0:e.headers,statusCode:e&&e.statusCode,statusText:e&&e.statusText,innerMessage:r.error&&r.error.message,type:a(o,r),customizedMessage:r.error&&r.error["@ms.form.error.customizedMessage"],isServerError:!0,innerCode:u};return 15001!==u||c.statusCode||(0,i.jL)(null==e?void 0:e.headers,"X-MSEdge-Ref")||(c.type="ExpectedFailure"),c}function a(t,n){var e=n.error&&n.error["@ms.form.error.type"];if(!e){e=t>=0&&t<500?"ExpectedFailure":"Failure"}return e}var u=function(t){if(!t)return!1;for(var n=0,e=(i=void 0,s=void 0,i=(0,r.QJ)("WhiteListRequestUrlRegList"),s=null==i?void 0:i.map((function(t){return new RegExp(t,"i")})),o.concat(s||[]));n<e.length;n++){if(e[n].test(t))return!0}var i,s;return!1};function c(t,n,e){var r,o,a,c=s(n),l=c&&c.innerMessage||"",f={statusCode:n&&n.response?parseInt(n.response.statusCode):0,correlationId:(0,i.jL)(null===(r=null==n?void 0:n.response)||void 0===r?void 0:r.headers,"X-CorrelationId"),statusText:n&&n.response?n.response.statusText:"",innerCode:c?c.innerCode:-1,innerMessage:e?e(l):l,failureReason:(0,i.jL)(null===(o=null==n?void 0:n.response)||void 0===o?void 0:o.headers,"X-FailureReason"),failureType:c?c.type:void 0,afdRef:(0,i.jL)(null===(a=null==n?void 0:n.response)||void 0===a?void 0:a.headers,"X-MSEdge-Ref")};return u(t)&&(f.sourceUrl=t),f}var l=function(t){return""}},5892:function(t,n,e){"use strict";e.d(n,{D3:function(){return g},W3:function(){return m},EI:function(){return v}});var i=e(64459),r=e(47393),o=e(72317),s=e(45862),a=e(99437),u=e(94290),c=e(29559),l=e(9947),f=e(90710),h=e(31442);function d(t,n,e){return 401===t.statusCode&&!(0,u.ft)()&&((401!==t.statusCode||!(0,u.Kw)()||!(0,u.s0)())&&((401!==t.statusCode||!(0,u.HI)())&&(function(t){if(t){var n=void 0;switch(t.innerCode){case 702:n="Auth.NotOnboardedTenant";break;case 703:n="Auth.DisabledByTenantAdmin";break;case 705:n="Auth.UserNeedMultiFactorAuth"}n&&(0,h.$U)(n,{tenantId:(0,l.k0)().userInfo.TenantId})}}(t),(0,f.NW)().embed?(t.innerCode=10001,!1):(700===t.innerCode||701===t.innerCode)&&(!(0,u.mF)()||701!==t.innerCode&&700!==t.innerCode?(0,c.K$)()&&(0,c.MG)()&&(0,c.Dt)()?(t.innerCode=15003,!1):(n(),!0):(e({innerCode:701===t.innerCode?10300:10301}),!1)))))}function m(t){var n=(0,a.QX)(t);if(function(t){return d(t,(function(){(0,o.a)().AuthContext.signIn().then(r.iv)}),s.P)}(n))return new Promise((function(){}));throw n}function v(t){return g(t).value}function g(t){var n={status:0};if(null==t)n.value=t;else{var e=t,r=e["@odata.count"]&&parseInt(e["@odata.count"]);isNaN(r)||(n.count=r),n.value=(0,i.d)(void 0===e.value?t:e.value)}return n}},84950:function(t,n,e){"use strict";e.d(n,{l_:function(){return i},qe:function(){return a}});var i,r=e(66676),o=e(83830),s=e(23946);function a(t,n,e){void 0===e&&(e="");var i="".concat((0,o.v)(),"intelligence/api/")+"forms(".concat(t,")/LogUserActionSigsSignals"),a={UserActionSigsSignals:n,FormContent:e,Locale:(0,r.K)()};return(0,s.d)({body:JSON.stringify(a),method:"POST",qosEventName:"Intelligence.LogUserActionSigsSignals",requestUri:i})}!function(t){t[t.Form=0]="Form",t[t.Question=1]="Question",t[t.Response=2]="Response",t[t.ThemeSuggestion=3]="ThemeSuggestion",t[t.QuestionSuggestion=4]="QuestionSuggestion",t[t.HistorySuggestion=5]="HistorySuggestion",t[t.EstimatedTime=6]="EstimatedTime",t[t.Insights=7]="Insights"}(i||(i={}))},8759:function(t,n,e){"use strict";e.d(n,{yW:function(){return c},bG:function(){return u},W6:function(){return h},sE:function(){return f},j0:function(){return l}});var i=e(59312),r=e(61018),o=e(24821),s=function(t){function n(){var e=this;return n.instance?n.instance:((e=t.call(this,window.FormPrefetchCache&&window.FormPrefetchCache.userLicenseInfoCache)||this).init(),n.instance=e,e)}return(0,i.ZT)(n,t),n.getInstance=function(){return new n},n.prototype.onPrefetchSucceed=function(){try{var t=JSON.parse(this.cache.data);this.prefetchResolve(t)}catch(t){this.fallBackToNormalBoot()}},n.prototype.onPrefetchFaied=function(){this.fallBackToNormalBoot()},n.prototype.fallBackToNormalBoot=function(){var t=this;r.VY.getInstance().createDataProvider().getUserInfo().then((function(n){return t.prefetchResolve(n)})).catch((function(n){return t.prefetchReject(n)}))},n}(o.f),a=function(t){function n(){var e=this;return n.instance?n.instance:((e=t.call(this,window.FormPrefetchCache&&window.FormPrefetchCache.userReputationTierCache)||this).init(),n.instance=e,e)}return(0,i.ZT)(n,t),n.getInstance=function(){return new n},n.prototype.onPrefetchSucceed=function(){try{var t=JSON.parse(this.cache.data);this.prefetchResolve(t)}catch(t){this.fallBackToNormalBoot()}},n.prototype.onPrefetchFaied=function(){this.fallBackToNormalBoot()},n.prototype.fallBackToNormalBoot=function(){var t=this;r.VY.getInstance().createDataProvider().getUserReputationTier().then((function(n){return t.prefetchResolve(n)})).catch((function(n){return t.prefetchReject(n)}))},n}(o.f);function u(){return s.getInstance().getPromise()}function c(){return r.VY.getInstance().createDataProvider().getUserFeatureSettings()}function l(t){return r.VY.getInstance().createDataProvider().updateUserFeatureSettings(t)}function f(){return r.VY.getInstance().createDataProvider().refreshUserInfo()}function h(){return a.getInstance().getPromise()}},29295:function(t,n,e){"use strict";e.d(n,{J:function(){return r}});var i=e(87363);function r(t,n){return t.__lazyComponentClass||(t.__lazyComponentClass=i.lazy(n)),t.__lazyComponentClass}},30521:function(t,n,e){"use strict";e.d(n,{a:function(){return u}});var i=e(59312),r=e(87363),o=e(32782),s=e(43367),a=e(29295);function u(t){var n=(0,a.J)(u,s.getIoCErrorPage);return r.createElement(o.Z,null,r.createElement(n,(0,i.pi)({},t)))}},60299:function(t,n,e){"use strict";e.d(n,{V:function(){return u}});var i=e(59312),r=e(87363),o=e(32782),s=e(29295);function a(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(166).then(e.bind(e,4368))];case 1:return[2,{default:t.sent().TitleOverflowMenu}]}}))}))}function u(t){var n=(0,s.J)(u,a);return r.createElement(o.Z,null,r.createElement(n,(0,i.pi)({},t)))}},29952:function(t,n,e){"use strict";e.d(n,{Oy:function(){return o}});var i=e(94290),r=e(90710);function o(){var t,n=(0,i.XF)();return"embed"===(null===(t=(0,r.NW)().mode)||void 0===t?void 0:t.toLowerCase())||"TeamsApproval"===n||"TeamsReports"===n}},29774:function(t,n,e){"use strict";e.d(n,{G_:function(){return h},Im:function(){return m},Ws:function(){return d},hC:function(){return f}});var i=e(59312),r=e(87363),o=e(32782),s=e(29295);function a(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(904).then(e.bind(e,86490))];case 1:return[2,{default:t.sent().UserInteractionSuggestionCardV2}]}}))}))}function u(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(904).then(e.bind(e,33083))];case 1:return[2,{default:t.sent().UserInteractionQuestionSuggestionV2}]}}))}))}function c(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(904).then(e.bind(e,44234))];case 1:return[2,{default:t.sent().ShareAssistantCard}]}}))}))}function l(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(904).then(e.bind(e,54628))];case 1:return[2,{default:t.sent().ThemeSuggestionCard}]}}))}))}function f(t){var n=(0,s.J)(f,a);return r.createElement(o.Z,null,r.createElement(n,(0,i.pi)({},t)))}function h(t){var n=(0,s.J)(h,u);return r.createElement(o.Z,null,r.createElement(n,(0,i.pi)({},t)))}function d(t){var n=(0,s.J)(d,c);return r.createElement(o.Z,null,r.createElement(n,(0,i.pi)({},t)))}function m(t){var n=(0,s.J)(m,l);return r.createElement(o.Z,null,r.createElement(n,(0,i.pi)({},t)))}},22768:function(t,n,e){"use strict";e.d(n,{Rq:function(){return f},Sp:function(){return l},qS:function(){return h}});var i=e(59312),r=e(87363),o=e(32782),s=e(29295);function a(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(600).then(e.bind(e,54281))];case 1:return[2,{default:t.sent().MathjaxFormulaRenderer}]}}))}))}function u(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(600).then(e.bind(e,57596))];case 1:return[2,{default:t.sent().VirtualKeyboardControl}]}}))}))}function c(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(600).then(e.bind(e,92719))];case 1:return[2,{default:t.sent().FormulaDesigner}]}}))}))}function l(t){var n=(0,s.J)(l,u);return r.createElement(o.Z,null,r.createElement(n,(0,i.pi)({},t)))}function f(t){var n=(0,s.J)(f,a);return r.createElement(o.Z,null,r.createElement(n,(0,i.pi)({},t)))}function h(t){var n=(0,s.J)(h,c);return r.createElement(o.Z,null,r.createElement(n,(0,i.pi)({},t)))}},18260:function(t,n,e){"use strict";e.d(n,{HH:function(){return m},WL:function(){return u},vV:function(){return l},vw:function(){return h}});var i=e(59312),r=e(87363),o=e(32782),s=e(29295);function a(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(852).then(e.bind(e,56011))];case 1:return[2,{default:t.sent().PhishingReviewPageNavBar}]}}))}))}function u(t){var n=(0,s.J)(u,a);return r.createElement(o.Z,null,r.createElement(n,(0,i.pi)({},t)))}function c(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(852).then(e.bind(e,8397))];case 1:return[2,{default:t.sent().WarningBar}]}}))}))}function l(t){var n=(0,s.J)(l,c);return r.createElement(o.Z,null,r.createElement(n,(0,i.pi)({},t)))}function f(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(852).then(e.bind(e,23729))];case 1:return[2,{default:t.sent().PhishingPopUpMessage}]}}))}))}function h(t){var n=(0,s.J)(h,f);return r.createElement(o.Z,null,r.createElement(n,(0,i.pi)({},t)))}function d(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(852).then(e.bind(e,83344))];case 1:return[2,{default:t.sent().BlockUsingFormsWarningPage}]}}))}))}function m(){var t=(0,s.J)(m,d);return r.createElement(o.Z,null,r.createElement(t,null))}},83726:function(t,n,e){"use strict";e.d(n,{d:function(){return r}});var i=e(72377);function r(){return i.Pv.Resolve("IThirdPartyRateIt")}},35337:function(t,n,e){"use strict";e.d(n,{f:function(){return l},Y:function(){return u}});var i=e(59749),r=e(36476);function o(t){return function(t,n){var e=s(),i=e.domain,r=e.isCdn,o=e.ring,a=r?"":"?ring=".concat(o);return"".concat(i).concat(n).concat(t.toLowerCase()).concat(a)}(t,"/scripts/dists/")}var s=(0,e(4851).Rm)((function(){var t,n,e=window.shellInfo,i=!1;if(e)i=!!(t=e.cdnEndpoint),n=e.ring;else{var o=window.OfficeFormServerInfo;i=o.isCdnEnabled,t=(0,r._k)(),n=o.ring}return{isCdn:i=i&&!!t,domain:i?t:location.protocol+"//"+location.host,ring:n}})),a=JSON.parse('["af","am-et","ar","as-in","az-latn-az","be","bg","bn-in","bs-latn-ba","ca-es-valencia","ca","cs","cy-gb","da","de","el","en-gb","en-us","es-mx","es","et","eu","fa","fi","fil-ph","fr-ca","fr","ga-ie","gd","gl","gu","he","hi","hr","hu","hy","id","is","it","ja","ka","kk","km-kh","kn","ko","kok","lb-lu","lo","lt","lv","mi-nz","mk","ml","mr","ms","mt-mt","nb-no","ne-np","nl","nn-no","or-in","pa","pl","pt-br","pt-pt","quz-pe","","ro","ru","sk","sl","sq","sr-cyrl-ba","sr-cyrl-rs","sr-latn-rs","sv","ta","te","th","tr","tt","ug","uk","ur","uz-latn-uz","vi","zh-cn","zh-tw"]');function u(t){return t}function c(t){if("string"!=typeof t||!t)return"default";var n=t.toLowerCase();if(a.indexOf(n)>=0)return n;var e=n.replace(/-[^-]+$/,"");return e&&n!==e?c(e):"default"}function l(t){window.FormsLsMap=window.FormsLsMap||{},window.formsLsPromiseMap=window.formsLsPromiseMap||{},t=c(t);var n=window.FormsLsMap[t];if(n)return Promise.resolve(n);var e=window.formsLsPromiseMap[t];return e||(e=f(o("".concat("ls-sr",".").concat(t,".").concat("60aa62c01",".js"))).then((function(){return window.formsLsPromiseMap[t]=null,window.FormsLsMap[t]}),(function(){throw window.formsLsPromiseMap[t]=null,new Error("fail to download locstring")})).catch((function(t){return new Promise((function(){}))})),window.formsLsPromiseMap[t]=e,e)}function f(t,n){return void 0===n&&(n=0),new Promise((function(e,r){if(n>=2)r();else{var o=document.createElement("script");(0,i.M5)(o,t.toLowerCase()),o.type="text/javascript",o.async=!0,o.onload=function(){e()},o.onerror=function(){!function(){try{document.head.removeChild(o)}catch(t){}}(),e(f(t,n+1))};try{document.head.appendChild(o)}catch(t){r()}}}))}},24497:function(t,n,e){"use strict";e.d(n,{Mw:function(){return l},gA:function(){return c},v1:function(){return s},wg:function(){return u}});var i=e(92575),r=e(70069),o=e(64290);function s(t,n,e,i){var r=n?l(n,!0):n,o=c(n);a(t,e,r),a(t,i,o)}function a(t,n,e){t[n]=e||""}function u(t,n,e){return void 0===e&&(e=!1),n&&function(t,n){return"false"!==n||"false"===t}(t,n)?n:t||""}function c(t){var n={$isSanitizeRichTextHTMLBase:!0,$text:t};return(0,o.pd)((function(){return(0,r.s)(n)}),o.t1)}function l(t,n){return(0,o.pd)((function(){return h(t)}),o.t1)}var f,h=(f=document.createElement("div"),function(t){var n={$isSanitizeRichTextHTMLBase:!0,$text:t},e=(0,r.s)(n).replace(/\<br\>/gi,"\n");return e?((0,i.p)(f,e),f.innerText):""})},84154:function(t,n,e){"use strict";e.d(n,{Es:function(){return d},Vq:function(){return u},L0:function(){return l},Uo:function(){return m},Lo:function(){return I},ck:function(){return h},w$:function(){return N},iT:function(){return p},p3:function(){return v},BS:function(){return g},uY:function(){return y},CW:function(){return T},t9:function(){return b},gt:function(){return S},tE:function(){return k},lu:function(){return C}});var i=e(12611),r=e(26203);function o(t){return[].concat.apply([],t)}var s=e(19843);function a(t){return o(t.getResponses().map((function(t){return r.d.convertToArray(t.Answers)})))}function u(t,n){return o(t.getResponses().filter((function(t){return t.Id===n})).map((function(t){return r.d.convertToArray(t.Answers)})))}function c(t,n){var e=a(t),r=t.getWrappedForm().getQuestionById(n).SubQuestionMasters.map((function(t){return t.Model.Id}));return e.filter((function(t){return t.QuestionId===n||i.contains(r,t.QuestionId)}))}function l(t,n){var e=c(t,n);return e.filter((function(t){return e[0]&&t.QuestionId===e[0].QuestionId}))}function f(t){return i.reduce(t,(function(t,n){return t+(n&&n.Score?n.Score:0)}),0)}function h(t,n){return t.getResponses().filter((function(t){return t.Id===n}))[0]}function d(t,n,e){var r=h(t,n);if(r){var o=t.getWrappedForm().getQuestionById(e).SubQuestionMasters;if(o.length>0){var a=i.map(o,(function(t){return t.Model.Id})),u=i.filter(r.Answers,(function(t){return-1!==a.indexOf(t.QuestionId)}));return u[u.length-1]}return(0,s.Es)(r,e)}}function m(t,n){var e,r=u(t,n).map((function(t){return t.QuestionId})),o=t.getWrappedForm().FormElementManager.QuestionMasters.filter((function(t){var n=i.contains(r,t.Model.Id),e=t.SubQuestionMasters.length>0&&i.filter(t.SubQuestionMasters,(function(t){return i.contains(r,t.Model.Id)})).length>0;return n||e})),s=i.map(o,(function(t){return t.Model}));return e=s,i.reduce(e,(function(t,n){return t+(n&&n.Point?n.Point:0)}),0)}function v(t,n){return f(u(t,n))}function g(t,n){var e=function(t,n){return t.getQuestions().filter((function(t){return t.Id===n}))[0]}(t,n);return(e&&e.Point?e.Point:0)*l(t,n).length}function p(t,n){return f(c(t,n))}function b(t){var n=a(t),e=t.getQuestions().filter((function(t){return t.IsQuiz})),r=[];n.forEach((function(t){null!=i.find(e,(function(n){return t.QuestionId===n.Id}))&&r.push(t)}));var o=r.map((function(t){return t.Score}));return i.every(o,i.isNumber)}function y(t){return!a(t).every(T)}function w(){return new Date("0001-01-01T00:00:00Z")}function S(t){var n=new Date,e=t.getResponses().map((function(t){return t.ReleaseDate})).filter((function(t){return!!t}));return i.every(e,(function(t){return t<=n&&t>w()}))}function N(t){return null==t?void 0:t.Feedback}function C(t){var n=t.ReleaseDate;return n&&n<=new Date&&n>w()}function I(t){return t.getResponses().filter(C)}function T(t){return t.IsAutoGraded}function k(){var t=document.getElementById("grading-by-people-tab");return!!t&&"true"===t.getAttribute("aria-selected")}},19843:function(t,n,e){"use strict";e.d(n,{Ai:function(){return s},Es:function(){return o},Ov:function(){return a},gF:function(){return u}});var i=e(12611),r=e(7645);function o(t,n){var e=i.filter(t.Answers,(function(t){return t.QuestionId===n}))[0];if(e)return e}function s(t){var n=function(t){return-1===t.Responder.indexOf("@")}(t),e=n?void 0:t.ResponderName,i=n?void 0:t.Responder;return e?1===t.Id||(e=(0,r.pm)().DisplayFormat_DuplicateUserName.format(e,t.Id-1)):e=(0,r.pm)().DisplayFormat_AnonymousUserName.format((0,r.pm)().ResponderNameForAnonymousUser,t.Id-1),{name:e,email:i}}function a(t){var n=t.map(s).map((function(t){return t.email?"".concat(t.name," <").concat(t.email,">"):t.name})),e=i.countBy(n,(function(t){return t})),o=[];for(var a in e)if(e.hasOwnProperty(a)){var u=e[a],c=u>1?"".concat(a," (").concat(u,")"):a;o.push(c)}return o.join((0,r.pm)().GradingView_MultipleStudents_Separator)}function u(t,n){var e={},r={};return t.filter((function(t){return"Question.Choice"===t.Type||"Question.TextField"===t.Type})).forEach((function(t){var s=t.Type;t.IsMathQuiz&&(s+=".Math"),e[s]=e[s]||0,++e[s],i.each(n,(function(n){var e=o(n,t.Id);e&&e.IsAutoGraded&&(r[s]=r[s]||0,++r[s])}))})),{responderCount:n.length,autogradableQuestionCount:e,autogradedResponsesCount:r}}},94605:function(t,n,e){"use strict";e.d(n,{G:function(){return h}});var i=e(59312),r=e(72377),o=e(26203),s=e(39923),a=e(73252),u=e(73293),c=e(25366),l=e(53315),f={TargetQuestionId:s.J4.string(),ToTheEnd:s.J4.boolean()},h=function(t){function n(e){var i=t.call(this,e)||this;return i.jt=!1,i.Wt=!1,i.Kt="",i.Jt=function(t){return i.Zt()},e.MasterTreeReady.then((function(){i.Deleted||(n.normalize(i,{},!1),i.addRule({Name:"normalize",onChange:function(t){n.normalize(i,t.OldValues,!0)}}),i.observe((function(t){i.Deleted||i.Xt()})))})),i}return(0,i.ZT)(n,t),n.prototype.getElementMaster=function(){var t=this.Parent;do{if(t instanceof l.MF||t instanceof u.Jv)return t}while(t=t.Parent);return null},n.prototype.getTargetElementMaster=function(){if(this.Deleted)return null;var t=this.getElementMaster().Form.FormElementManager;if(!this.Model.TargetQuestionId)return null;var n=t.getElementMasterById(this.Model.TargetQuestionId);return n&&n.Deleted?null:n?(c.H.isSection(n.Model.Type)||t.findContainerSection(this.getElementMaster())===t.findContainerSection(n))&&n:n},n.prototype.resetToDefault=function(){var t=this;this.jt=!1,this.bulkEdit((function(){t.Model.ToTheEnd=null,t.Model.TargetQuestionId=null}))},n.prototype.isDefault=function(){return!this.Model.ToTheEnd&&!this.Model.TargetQuestionId},n.prototype.getBranchingResult=function(){var t=this.Model;return this.isValid()?t.ToTheEnd?{Type:"End"}:{Type:"Specified",TargetElement:this.getTargetElementMaster()}:{Type:"Next"}},n.prototype.hasSectionBranching=function(){var t=this.getElementMaster(),n=this.getTargetElementMaster();return c.H.isSection(t.Model.Type)||n&&c.H.isSection(n.Model.Type)},n.normalize=function(t,n,e){var i=t.Model;i.ToTheEnd?n.ToTheEnd&&i.TargetQuestionId||(i.TargetQuestionId=null):i.ToTheEnd=null,e&&t.Yt()},n.prototype.isValid=function(){return this.jt&&this.Kt===this.Model.TargetQuestionId||(this.Yt(),this.Xt()),this.Wt},n.prototype.Yt=function(){this.jt=!0,this.Kt=this.Model.TargetQuestionId,this.Wt=!(!this.Model.ToTheEnd&&!this.getTargetElementMaster());var t=this.Model.TargetQuestionId;!this.Wt&&t&&(0,a.M0)()&&(this.Wt=r.Pv.Resolve("IIncrementalLoadStrategy").has(t))},n.prototype.Xt=function(){var t=this.getTargetElementMaster(),n=this.tn;t!==n&&((n instanceof l.MF||n instanceof u.Jv)&&n.unobserve(this.Jt),this.tn=t,(t instanceof l.MF||t instanceof u.Jv)&&t.observe(this.Jt))},n.prototype.Zt=function(){if(this.tn.Deleted)this.Model.TargetQuestionId=null;else if(this.tn instanceof l.MF){var t=this.getElementMaster().Form.FormElementManager;t.findContainerSection(this.getElementMaster())!==t.findContainerSection(this.tn)&&(this.Model.TargetQuestionId=null)}},n}(o.d.createObjectMasterClass("BranchInfoMaster",f))},22707:function(t,n,e){"use strict";e.d(n,{Ai:function(){return g},cV:function(){return m},kR:function(){return v},yH:function(){return p}});var i=e(59312),r=e(12611),o=e(94978),s=e(26203),a=e(41293),u=e(55411),c=e(7645),l=(e(64290),e(85866)),f=e(9743),h=e(67661),d=e(81380),m=function(){function t(t,n){if(this.nn=t,this.Ot=(0,d.lK)(t),this.Ot){var e=this.Ot.getDesignForm;switch(this.nn.SyncContext){case f.y.SharedTimeForm:e=this.Ot.getSharedForm;break;case f.y.ResponseTimeForm:e=this.Ot.getRuntimeForm;break;case f.y.AnalysisTimeForm:e=this.Ot.getAnalysisTimeForm;break;case f.y.ResponseDetailTimeForm:e=this.Ot.getResponseDetailRuntimeForm;break;case f.y.AdminPhishingReviewForm:e=this.Ot.getAdminPhishingReviewForm}this.rn=e.bind(this.Ot)}}return t.prototype.add=function(t){return this.nn.SyncContext===f.y.LocalForm?new Promise((function(){})):this.nn.SyncContext===f.y.DesignTimeForm?this.Ot.createForm(t):void(0,a._y)("Trying to create a form without design type.")},t.prototype.delete=function(t){if(this.nn.SyncContext===f.y.DesignTimeForm)return this.sn(),this.Ot.deleteForm(this.nn.Model.Id);(0,a._y)("Trying to delete a form without design type.")},t.prototype.query=function(t){var n=this;if(!this.rn){return Promise.reject({innerCode:1001,type:"ExpectedFailure"})}var e=this.nn.isFieldReady(this.nn.Schema.Flags)&&v(this.nn.Model.Flags),o=this.cn(e),a=this.ln(t,o);return Promise.all(a).then((function(t){return r.extend.apply(r,(0,i.ev)([{}],t,!1))})).then((function(e){var i=s.d.getFieldSchemaInfo(n.nn.Schema.Flags).Attributes.SourceFieldName;return t.indexOf(i)>=0&&!v(e.flags)&&(e.archivedRowCount=0),e}))},t.prototype.update=function(t){if(this.nn.SyncContext===f.y.LocalForm)return new Promise((function(){}));if(this.nn.SyncContext!==f.y.DesignTimeForm)return Promise.resolve();var n=s.d.getFieldSchemaInfo(h.x.Schema.SoftDeleted).Attributes.SourceFieldName;if(n in t)t[n]===l.d.SoftDeleted&&this.sn();else if(this.nn.isFieldReady(h.x.Schema.SoftDeleted)&&this.nn.Model.SoftDeleted===l.d.SoftDeleted)return Promise.resolve();return""!==t.title||(0,u.y)()||(t.title=(0,c.pm)().Designer_DefaultFormTitle),this.Ot.updateForm(this.nn.Model.Id,t)},t.prototype.ln=function(t,n){var e=[],i=new Set;t.forEach((function(t){n.hasOwnProperty(t)?i.add(n[t]):e.push(t)}));var r=[];return e.length&&r.push(this.rn(this.nn.Model.Id,e)),i.forEach((function(t){return r.push(t())})),r},t.prototype.cn=function(t){var n=this,e={localizedResources:function(){if(!(0,u.sv)())return n.nn.getAllLocaleResources()}};if(t){e.archivedRowCount=function(){return n.Ot.getArchiveAndActiveResponseCount({$formId:n.nn.Model.Id}).then((function(t){return{rowCount:t.active,archivedRowCount:t.archive}}))}}return e},t.prototype.sn=function(){var t=this;return this.Ot.removeRecentForm(this.nn.Model.Id).then((function(){var n=Forms.Mru.MruDocumentCollectionMaster.getInstance();n&&n.removeDocument(t.nn.Model.Id)}))},t}();function v(t){return(128&t)>0}function g(t){return(64&t)>0}function p(t,n){return v(n)||t&&t.Model.TotalResponseCount>(0,o.vj)("FormResponsesQuota",5e4)}},81380:function(t,n,e){"use strict";e.d(n,{Ah:function(){return N},Cs:function(){return h},GI:function(){return y},Mv:function(){return d},W2:function(){return f},lK:function(){return v},lb:function(){return p},o7:function(){return g},qU:function(){return l},rl:function(){return b},tx:function(){return S},zg:function(){return w}});var i=e(26203),r=e(37076),o=e(61018),s=e(64290),a=e(31442),u=e(67661),c=e(96680);function l(t,n,e){var r=function(t){return(0,c.sQ)(t||i.d.getSubFieldSchemas(u.x.Schema)).map((function(t){var n=i.d.getFieldSchemaInfo(t);if(!n.Attributes.IsLocalField)return n.Attributes.SourceFieldName||n.Name})).filter((function(t){return t}))}(t);r.push("status");var s=i.d.getFieldSchemaInfo(u.x.Schema.Version).Attributes.SourceFieldName;r.indexOf(s)&&r.push(s);var l=4,f=null,h=null;n&&(f=n.OwnerTenantId,h=n.OwnerId,l=n.IsGroupForm?3:2);var d=o.VY.getInstance().createDataProvider(l,f,h);return d.getForms(r,e).then((function(t){var n=[],e=0,r=[];return t.forEach((function(t){if("Deleted"===t.status)++e,d.deleteForm(t.id);else if(t.version){var o=i.d.convertFromSourceData(t,u.x.Schema);r.push(o)}else n.push(t.id)})),(n.length||e)&&(0,a.$U)("PortalPage.FilteredOutForms",{deletedFormCount:e,oldVersionForms:n}),r}))}function f(t,n){return o.VY.getInstance().createDataProvider().getCachedSimpleForms(t,n)}function h(){return o.VY.getInstance().createDataProvider().getFormsResponseCount()}function d(){return(0,s.pd)(m,s.t1)}function m(){return o.VY.getInstance().createDataProvider(4).getFormsSharedWithCurrentUser().then((function(t){return t.map((function(t){return i.d.convertFromSourceData(t,u.x.Schema)}))}))}function v(t){if(!t.isFieldReady(u.x.Schema.OwnerTenantId)||!t.isFieldReady(u.x.Schema.OwnerId))return o.VY.getInstance().createDataProvider();var n=1;if(t.IsGroupForm)n=3;else{if(!t.Model.OwnerTenantId||!t.Model.OwnerId)return null;n=2}return o.VY.getInstance().createDataProvider(n,t.Model.OwnerTenantId,t.Model.OwnerId)}function g(t){var n=(0,r.kc)(t),e=1;return n.IsGroupOwner?e=3:n.OrgId&&n.OwnerId&&(e=2),o.VY.getInstance().createDataProvider(e,n.OrgId,n.OwnerId)}function p(t,n,e){return v(t).downloadExcelFile(t.Model.Id,n,e)}function b(t){return(0,a.$U)("DesignPage.ResponseCount.Get"),v(t).getFormResponseCount(t.Model.Id)}function y(t,n){return g(t).getAnalysisSurveyData(t,n)}function w(t){return g(t).getAnalysisQuizData(t)}function S(t){return g(t).getResultSharingAnalysisSurveyData(t)}function N(t){return g(t).getResultSharingAnalysisQuizData(t)}},82963:function(t,n,e){"use strict";e.d(n,{Lu:function(){return f},Od:function(){return d},_n:function(){return h},aj:function(){return l},mt:function(){return m},q4:function(){return v},qs:function(){return c}});var i=e(12611),r=e(43209),o=e(26203),s=e(41275),a=e(81380),u="0001-01-01T00:00:00Z";function c(t,n){var e=i.map(n.Answers,(function(t){return{questionId:t.QuestionId,answer1:t.Answer}})),r={answers:JSON.stringify(e),startDate:n.StartDate instanceof Date?n.StartDate.toISOString():"",submitDate:n.SubmitDate instanceof Date?n.SubmitDate.toISOString():""};return r.emailReceiptConsent=n.EmailReceiptConsent,r.submitLanguage=n.SubmitLanguage,n.Responder&&(r.responder=n.Responder,r.responderName=n.ResponderName),(0,a.lK)(t).submitFormResponse(t.Model.Id,r)}function l(t,n,e,i){return(0,a.lK)(t).getFormResponses(t.Model.Id,i,n,e).then((function(t){return t.map(g)}))}function f(t){return(0,a.lK)(t).getRuntimeResponses(t.Model.Id).then((function(t){return t.map(g)}))}function h(t){return(0,a.lK)(t).deleteFormResponses(t.Model.Id)}function d(t,n){var e,i,o=null===(i=null===(e=window.FormPrefetchCache)||void 0===e?void 0:e.responseCache)||void 0===i?void 0:i.data;return("Response"===(0,r.C2)()&&o?Promise.resolve(o.value):(0,a.lK)(t).getRuntimeResponses(t.Model.Id,n)).then((function(t){return t.filter((function(t){return t.releaseDate!==u})).map(g)}))}function m(t,n){return(0,a.lK)(t).getRuntimeResponse(t.Model.Id,n).then(g)}function v(t,n){var e=(0,a.o7)(t);return Promise.all(n.map((function(n){return e.deleteFormResponse(t,n)})))}function g(t){var n=o.d.convertFromSourceData(t,s.KJ.Schema);void 0!==n.StartDateAsString&&(n.StartDate=new Date(n.StartDateAsString)),void 0!==n.SubmitDateAsString&&(n.SubmitDate=new Date(n.SubmitDateAsString)),void 0!==n.ReleaseDateAsString&&(null===n.ReleaseDateAsString?n.ReleaseDate=new Date(u):n.ReleaseDate=new Date(n.ReleaseDateAsString));var e=[];if(n.AnswersAsString&&(e=JSON.parse(n.AnswersAsString).map((function(t){return{Answer:t.answer1,QuestionId:t.questionId}})),n.Answers=e),n.Comments){var r={},a=[];i.forEach(n.Comments,(function(t){var n=t.QuestionId||"___";r[n]&&a.push(r[n]),r[n]=t})),n.Comments=i.difference(n.Comments,a)}if(n.Comments){var c={};e.forEach((function(t){return c[t.QuestionId]=t})),i.forEach(n.Comments,(function(t){var i=t.QuestionId;if(i){var r=c[i];r||(r={Answer:null,QuestionId:i},e.push(r),c[i]=r),r.Feedback=t.Feedback,r.Score=t.Score}else n.Feedback=t.Feedback,n.TotalScore=t.Score}))}return n}},94956:function(t,n,e){"use strict";e.d(n,{b:function(){return o}});var i=e(94290),r=e(37890),o=function(){function t(t,n,e){void 0===n&&(n=1e3),void 0===e&&(e=5e3);var r=this;this.fn=Number.MAX_VALUE,n=null!=n?n:1e3,e=null!=e?e:5e3,(0,i.mF)()?this.hn=n:this.hn=4*n,this.dn=4*e,this.mn=function(){var t=r.vn();t&&t.resolve()}}return t.prototype.scheduleUpdate=function(){return this.pn&&console.warn("Calling scheduleUpdate() before the previous one is resolved."),this.pn=new r.wU,this.bn=window.setTimeout(this.mn,this.hn),this.yn=window.setTimeout(this.mn,this.dn),this.pn.promise()},t.prototype.postponeUpdate=function(){this.pn||console.warn("Calling postponeUpdate() before update scheduled."),this.bn&&window.clearTimeout(this.bn),this.bn=window.setTimeout(this.mn,this.hn)},t.prototype.cancelUpdate=function(){var t;null===(t=this.vn())||void 0===t||t.reject()},t.prototype.setMaxRetryTimesForUpdate=function(t){this.fn=t},t.prototype.vn=function(){window.clearTimeout(this.bn),this.bn=void 0,window.clearTimeout(this.yn),this.yn=void 0;var t=this.pn;return this.pn=void 0,t},t.prototype.retryForCreation=function(t){return t<3?Promise.resolve():Promise.reject("Retry times exceeded.")},t.prototype.retryForUpdate=function(t){var n=this;if(t>=this.fn)return Promise.reject("times >= this.maxRetryTimesForUpdate");var e=a;t<u&&(e=s*Math.pow(2,t));var i=new r.wU;return this.wn=window.setTimeout((function(){n.wn=void 0,i.resolve()}),e),i.promise()},t.prototype.cancelRetryForUpdate=function(){window.clearTimeout(this.wn),this.wn=void 0},t}(),s=2500,a=6e5,u=Math.log(a/s)/Math.log(2)},86415:function(t,n,e){"use strict";e.d(n,{k:function(){return g},I:function(){return v}});var i=e(59312),r=e(26203),o=e(39923),s=e(94956),a=e(82205),u=e(31442),c=e(41293),l=e(84154),f=e(81380),h=e(9743),d=function(){function t(t,n){this.Sn=t,this.Ot=(0,f.lK)(this.Sn.Response.Form)}return Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Sn.FormId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ResponseId",{get:function(){return this.Sn.ResponseId},enumerable:!1,configurable:!0}),t.prototype.Nn=function(){var n=this;return new Promise((function(e,i){t.responsePromiseObjCacheMap.set(n.ResponseId,{resolve:e,reject:i});void 0===t.timerID&&0!==t.comments.length&&(t.timerID=window.setTimeout((function(){if(t.timerID=void 0,1===t.comments.length){var r=t.comments[0];t.comments=[],n.Ot.addFormResponseComment(n.FormId,n.ResponseId,r).then((function(t){e(t)}),i)}else{var o=t.comments.map((function(t){return t}));t.comments=[],n.Ot.addFormResponseComments(n.FormId,o).then((function(n){for(var e=0,i=n;e<i.length;e++){var r=i[e],o=t.responsePromiseObjCacheMap.get(r.responseId);t.responsePromiseObjCacheMap.delete(r.responseId),o.resolve(r)}}),(function(n){t.responsePromiseObjCacheMap.forEach((function(t,e,i){t.reject(n)}))}))}}),500))}))},t.prototype.add=function(n,e,i){return(0,l.tE)()?this.Ot.addFormResponseComment(this.FormId,this.ResponseId,e.Snapshot):(e.Snapshot.responseId=this.ResponseId,t.comments.push(e.Snapshot),this.Nn())},t.prototype.delete=function(t){return new Promise((function(){}))},t.prototype.query=function(t){return(0,c._y)("No scenario to call this method currently.")},t.prototype.update=function(t,n){var e=this.Sn.Response.Form.SyncContext;return e!==h.y.DesignTimeForm&&e!==h.y.AnalysisTimeForm?new Promise((function(){})):this.add(t,n,!0)},t.comments=new Array,t.responsePromiseObjCacheMap=new Map,t}(),m={QuestionId:o.J4.string({IsKeyField:!0,SourceFieldName:"questionId"}),Id:o.J4.number({SourceFieldName:"id"}),Feedback:o.J4.string({SourceFieldName:"feedback"}),Score:o.J4.number({SourceFieldName:"score"}),SavingState:o.J4.reference({IsLocalField:!0})};function v(t){return r.d.getObjectMasterFromModel(t)}var g=function(t){function n(e){var i=t.call(this,e,{Scheduler:new s.b(n.name)})||this;return(0,a.vG)(i),i.observe(p),i.Synchronizer.observe(n.checkCommentUpdateError,[i.Synchronizer.Schema.UpdateError]),i}return(0,i.ZT)(n,t),n.setUpdateErrorCallback=function(t){n.updateErrorCallback=t},n.resetUpdateErrorCallback=function(){n.updateErrorCallback=null},Object.defineProperty(n.prototype,"Response",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"FormId",{get:function(){return this.Response.FormId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ResponseId",{get:function(){return this.Response.ResponseId},enumerable:!1,configurable:!0}),n.checkCommentUpdateError=function(t){n.updateErrorCallback&&t.Master&&t.Master.Schema.UpdateError&&n.updateErrorCallback(t.Master.Model.UpdateError,t.Master.getInstanceId())},n}(r.d.createObjectMasterClass("Comment",m,(function(t,n){return new d(t,n)})));function p(t){if(t.BeingDeleted&&t.Master.Synchronizer.Model.UpdateScheduled)try{throw Error("DeletingComment")}catch(t){(0,u.zU)("ModelError",t.stack)}}},73293:function(t,n,e){"use strict";e.d(n,{Jv:function(){return F},Kb:function(){return x},PQ:function(){return k}});var i=e(59312),r=e(12611),o=e(41480),s=e(15934),a=e(37890),u=e(26203),c=e(39923),l=e(7645),f=e(72467),h=e(1014),d=e(46008),m=e(31442),v=e(94605),g=e(94956),p=e(90819),b=e(3920),y=e(81380),w=e(9743),S=function(){function t(t,n){this.Cn=t,this.Ot=(0,y.lK)(this.Cn.Form)}return Object.defineProperty(t.prototype,"FormId",{get:function(){return this.Cn.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ElementId",{get:function(){return this.Cn.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ElementType",{get:function(){return this.Cn.Model.Type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ExtraQosData",{get:function(){var t=this.Cn.Form;return{WithSection:t.isFieldReady(t.Schema.DescriptiveElements)&&!!t.FormElementManager.SectionMasters.length}},enumerable:!1,configurable:!0}),t.prototype.add=function(t){var n=this;if(this.Cn.Form.SyncContext!==w.y.DesignTimeForm)throw Error("Trying to create an element without design type.");return this.Cn.createSyncJob((function(){return n.Ot.createFormDescriptiveElement(n.FormId,t,n.ExtraQosData)}))},t.prototype.delete=function(t){var n=this;if(!t||!t.id)throw Error("Trying to delete an empty element.");if(this.Cn.Form.SyncContext!==w.y.DesignTimeForm)throw Error("Trying to delete an element without design type.");return this.Cn.createSyncJob((function(){return n.Ot.deleteFormDescriptiveElement(n.FormId,t.id||"",n.ElementType,n.ExtraQosData)})).then(null,(function(t){if(t&&621===t.innerCode)return Promise.resolve();throw t}))},t.prototype.query=function(t){throw Error("No scenario to call this method currently.")},t.prototype.update=function(t,n){var e=this;return this.Cn.Form.SyncContext!==w.y.DesignTimeForm?Promise.resolve():this.Cn.createUploadSyncJob((function(){return e.Ot.updateFormDescriptiveElement(e.FormId,e.ElementId,e.ElementType,t,e.ExtraQosData)}))},t}(),N=e(53907),C=e(62539),I=e(82205),T={BranchInfo:c.J4.fromMasterClass((function(){return v.G}),{IsLocalField:!0}),CoAuthors:c.J4.collectionOf(c.J4.reference(),{IsLocalField:!0}),FileUploadSPOInfo:c.J4.create({anonymousLinkInfo:c.J4.string(),driveId:c.J4.string(),errorCode:c.J4.string(),folderId:c.J4.string(),linkInfo:c.J4.string()},{SourceFieldName:"fileUploadSPOInfo"}),FormsProRTQuestionTitle:c.J4.string({SourceFieldName:"formsProRTQuestionTitle"}),FormsProRTSubtitle:c.J4.string({SourceFieldName:"formsProRTSubtitle"}),Id:c.J4.string({IsKeyField:!0,SourceFieldName:"id"}),ImageInfo:c.J4.fromMasterClass(f.Cu,{SourceFieldName:"image"}),ImageSettings:c.J4.fromMasterClass(f.BF,{IsLocalField:!0}),IntegratedSavingState:c.J4.reference({IsLocalField:!0}),Order:c.J4.number({SourceFieldName:"order"}),QuestionInfo:c.J4.string({SourceFieldName:"questionInfo"}),SavingState:c.J4.reference({IsLocalField:!0}),ShowSubtitle:c.J4.boolean({IsLocalField:!0}),Subtitle:c.J4.string({SourceFieldName:"subtitle"}),Title:c.J4.string({SourceFieldName:"title"}),Type:c.J4.reference({SourceFieldName:"type"}),Hidden:c.J4.boolean({IsLocalField:!0}),Visible:c.J4.boolean({IsLocalField:!0}),VideoInfo:c.J4.create({Author:c.J4.string(),OriginalHeight:c.J4.number(),OriginalWidth:c.J4.number(),ShowWarningBar:c.J4.boolean(),Thumbnail_url:c.J4.string(),Title:c.J4.string(),Url:c.J4.string()},{IsLocalField:!0})};function k(t){return u.d.getObjectMasterFromModel(t)}function x(){return{Title:(0,l.pm)().DesciptiveElementType_Section_DefaultTitle,Type:"Question.ColumnGroup"}}var F=function(t){function n(e){var i=this,o=new a.wU;if(!e.InitialData)throw Error("Element model should created with initial data.");return(e=r.clone(e)).InitialData=r.clone(e.InitialData),e.InitialData.FormsProRTQuestionTitle||(e.InitialData.FormsProRTQuestionTitle=null),e.InitialData.FormsProRTSubtitle||(e.InitialData.FormsProRTSubtitle=null),i=t.call(this,e,{MasterReady:o.promise(),Scheduler:new g.b(n.name)})||this,(0,I.vG)(i),i.In(),i.Tn(e),(0,b.CU)(i,n.Schema.ImageInfo,n.Schema.ImageSettings),n.Rules.forEach((function(t){return i.addRule(t)})),i.xn={},o.resolve(),i}return(0,i.ZT)(n,t),n.supportMobileDesign=function(t){return!1},Object.defineProperty(n.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ImageInfoMaster",{get:function(){return(0,p.rQ)(this.Model.ImageInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ImageSettingsMaster",{get:function(){return(0,b.Hi)(this.Model.ImageSettings)},enumerable:!1,configurable:!0}),n.prototype.isFieldReady=function(e){return e=n.getSourceFields([e])[0],t.prototype.isFieldReady.call(this,e)},n.prototype.ensureFieldsReady=function(e){return t.prototype.ensureFieldsReady.call(this,n.getSourceFields(e))},n.prototype.fieldsReady=function(e){return t.prototype.fieldsReady.call(this,n.getSourceFields(e))},n.prototype.ensureCreationDone=function(){var t=this;return this.ImageInfoMaster.Synchronizer.flush().then((function(){return t.Synchronizer.flush()}))},n.prototype.setVideoUrl=function(t,e){var i=this.Model.VideoInfo;u.d.getObjectMasterFromModel(i).bulkEdit((function(){i.Url=(0,h.Qn)(t,(0,o.k)()),i.Title="",i.Author="",i.Thumbnail_url="",i.OriginalWidth=n.defaultWidth,i.OriginalHeight=n.defaultHeight,i.ShowWarningBar=e&&(0,s.M4)(t)}))},n.prototype.hasValidVideoUrl=function(){return(0,d.Fp)()?this.Fn()&&(0,s.eC)(this.Model.VideoInfo.Url):this.Fn()&&(0,s.yk)(this.Model.VideoInfo.Url)},n.prototype.clearVideoInfo=function(){this.Model.VideoInfo={Author:"",OriginalHeight:n.defaultHeight,OriginalWidth:n.defaultWidth,ShowWarningBar:!1,Thumbnail_url:"",Title:"",Url:""}},n.prototype.resetBranchInfo=function(){n.getBranchInfoMaster(this.Model.BranchInfo).resetToDefault()},n.prototype.createSyncJob=function(t){var n=this,e=new a.wU,i=e.promise().then((function(){return n.Form.getQuestionSyncBlocker(i)})).then(t);return e.resolve(),i},n.prototype.createUploadSyncJob=function(t){var n=this,e=new a.wU,i=Promise.all([e,this.Pn]).then((function(){return n.createSyncJob(t)}));return e.resolve(),this.Pn=(0,a.Bx)(i),i},n.prototype.updateCoAuthors=function(t){var n=this,e=r.filter(this.Model.CoAuthors,(function(n){return t.userId===n.userId}))[0],i=function(){e&&o.deleteItems([e]),t.userId in n.xn&&(clearTimeout(n.xn[t.userId]),delete n.xn[t.userId])},o=u.d.getCollectionMasterFromModel(this.Model.CoAuthors);o.bulkEdit((function(){i(),e=u.d.Collection.addItems(n.Model.CoAuthors,[t])[0]}));this.xn[t.userId]=window.setTimeout(i,1e4)},n.getBranchInfoMaster=function(t){return u.d.getObjectMasterFromModel(t)},n.prototype.Tn=function(t){this.Dn=new N.S(this,n.Schema.QuestionInfo,n.QuestionInfoFieldSet),t.InitialData&&this.isFieldReady(n.Schema.QuestionInfo)&&(t.ExistingInDataSource||t.InitialData.QuestionInfo?this.Dn.deserialize():this.Dn.serialize())},n.prototype.In=function(){this.isFieldReady(n.Schema.ImageInfo)?this.Model.IntegratedSavingState=(0,I.IM)([this.Model.ImageInfo.SavingState,this.Model.SavingState]):this.Model.IntegratedSavingState=this.Model.SavingState},n.prototype.Fn=function(){return this.Model.VideoInfo&&this.Model.VideoInfo.Url},Object.defineProperty(n,"QuestionInfoFieldSet",{get:function(){return n.questionInfoFieldSet||(n.questionInfoFieldSet=new C.C([n.Schema.BranchInfo,n.Schema.ImageSettings,n.Schema.ShowSubtitle,n.Schema.VideoInfo,n.Schema.Hidden])),n.questionInfoFieldSet},enumerable:!1,configurable:!0}),Object.defineProperty(n,"Rules",{get:function(){if(!n.rules){var t=n.Schema;n.rules=[{InterestedFields:[t.Id],Name:"block id changes",onChange:function(t){var n,e=t.Master.Model,i=e.Id,r=t.OldValues.Id;e.Id=r;try{throw Error("Changing element id")}catch(t){n=t}(0,m.zU)("UpdatingElementId",{newId:i,oldId:r,stack:n.stack})}},{InterestedFields:[t.ImageInfo.SavingState,t.SavingState],Name:"IntegrateSavingState",onChange:function(t){return t.Master.In()}}]}return n.rules},enumerable:!1,configurable:!0}),n.getSourceFields=function(t){return r.uniq(t.map((function(t){return n.QuestionInfoFieldSet.covers(t)?n.Schema.QuestionInfo:t})))},n.defaultWidth=459,n.defaultHeight=256,n}(u.d.createObjectMasterClass("DescriptiveElementMaster",T,(function(t,n){return new S(t,n)})))},85866:function(t,n,e){"use strict";var i;e.d(n,{d:function(){return i}}),function(t){t[t.Normal=0]="Normal",t[t.SoftDeleted=1]="SoftDeleted"}(i||(i={}))},19930:function(t,n,e){"use strict";var i;e.d(n,{r:function(){return i}}),function(t){t[t.NotStarted=1]="NotStarted",t[t.Opened=2]="Opened",t[t.Expired=3]="Expired",t[t.Closed=4]="Closed"}(i||(i={}))},9743:function(t,n,e){"use strict";var i;e.d(n,{y:function(){return i}}),function(t){t[t.DesignTimeForm=1]="DesignTimeForm",t[t.ResponseTimeForm=2]="ResponseTimeForm",t[t.SharedTimeForm=3]="SharedTimeForm",t[t.LocalForm=4]="LocalForm",t[t.AnalysisTimeForm=5]="AnalysisTimeForm",t[t.ResponseDetailTimeForm=6]="ResponseDetailTimeForm",t[t.AdminPhishingReviewForm=7]="AdminPhishingReviewForm"}(i||(i={}))},51150:function(t,n,e){"use strict";var i;e.d(n,{E:function(){return i}}),function(t){t[t.Default=0]="Default",t[t.Shown=1]="Shown",t[t.Closed=2]="Closed"}(i||(i={}))},53907:function(t,n,e){"use strict";e.d(n,{S:function(){return o},m:function(){return a}});var i=e(26203),r=0,o=function(){function t(t,n,e){this.Ln=t,this.Rn=n,this.An=e.FieldSchemas,this.En()}return t.prototype.serialize=function(){var t=this.Ln.getSnapshot(this.An),n=this.Ln.Schema,e={};this.An.forEach((function(n){var r=i.d.getFieldSchemaInfo(n).Name;e[r]=i.d.convertToSourceData(t[r],n)}));var o=i.d.getFieldSchemaInfo(this.Rn).Name,a=s(e,n,[]),u=a&&JSON.stringify(a),c=this.Ln.Model[o]!==u;(c||Math.random()<r)&&(c=!0,u=(a=s(e,n,null))&&JSON.stringify(a)),c&&(this.Ln.Model[o]=u)},t.prototype.deserialize=function(){var t=i.d.getFieldSchemaInfo(this.Rn).Name,n=this.Ln.Model[t],e=n?JSON.parse(n):{},r={};this.An.forEach((function(t){var n=i.d.getFieldSchemaInfo(t).Name;r[n]=i.d.convertFromSourceData(e[n],t)})),this.Ln.setData(r,this.An)},t.prototype.En=function(){var t=this,n=i.d.getFieldSchemaInfo(this.Rn).Name;this.Ln.addRule({Name:"Deserialize - "+n,InterestedFields:[this.Rn],onChange:function(n){n.BeingDeleted||t.deserialize()}}),this.Ln.addRule({Name:"Serialize - "+n,InterestedFields:this.An,onChange:function(n){n.BeingDeleted||t.serialize()}})},t}();function s(t,n,e){if(null==t)return null;if(Array.isArray(t)){if(t.length){var r=n[0];return t.map((function(t){return s(t,r,e)}))}return e}var o={},a=0;return i.d.getSubFieldSchemas(n).forEach((function(n){var r=i.d.getFieldSchemaInfo(n),u=r.Attributes.SourceFieldName||r.Name,c=t[u];r.IsLeaf||(c=s(c,n,e)),null!=c&&(++a,o[u]=c)})),a>0?o:null}function a(t){r=t}},62539:function(t,n,e){"use strict";e.d(n,{C:function(){return s}});var i=e(12611),r=e(72420),o=e(26203),s=function(){function t(t){this.On=t.concat(),this.Bn=t.map((function(t){return o.d.getFieldSchemaInfo(t).Name}))}return Object.defineProperty(t.prototype,"FieldSchemas",{get:function(){return this.On.concat()},enumerable:!1,configurable:!0}),t.prototype.covers=function(t){return(0,r.HD)(t)?i.contains(this.Bn,t):i.contains(this.On,t)},t}()},67661:function(t,n,e){"use strict";e.d(n,{x:function(){return B}});var i=e(59312),r=e(12611),o=e(9947),s=e(64459),a=e(37890),u=e(72377);var c=e(26203),l=e(39923),f=e(73252),h=e(20987),d=e(72467),m=(e(64290),e(22707)),v=e(81380),g=e(82963),p=e(94956),b=e(73293),y=e(53907),w=e(90819),S=e(3920),N=e(502),C=e(9743),I=function(){function t(t){this.Ln=t,this.Ot=(0,v.lK)(this.Ln.Form)}return t.prototype.add=function(t){if(!t.localeId||!t.localeName||this.Ln.Form.SyncContext!==C.y.DesignTimeForm)return Promise.resolve();var n={elementKey:"localename",elementValue:t.localeName,locale:t.localeId,questionId:""};return this.Ot.createLocaleItem(this.Ln.FormId,n)},t.prototype.delete=function(t){return t.localeId&&this.Ln.Form.SyncContext===C.y.DesignTimeForm?this.Ot.deleteLocale(this.Ln.FormId,t.localeId):Promise.resolve()},t.prototype.query=function(t){throw Error("No scenario to call this method currently.")},t.prototype.update=function(t,n){if(!n.ValuesBefore||!t.localeName||this.Ln.Form.SyncContext!==C.y.DesignTimeForm)return Promise.resolve();var e=null!==n.ValuesBefore.localeName,i={elementKey:"localename",elementValue:t.localeName,locale:this.Ln.Model.localeId,questionId:null};return e?this.Ot.updateLocaleItem(this.Ln.FormId,i):this.Ot.createLocaleItem(this.Ln.FormId,i)},t}(),T={localeId:l.J4.string({IsKeyField:!0}),localeName:l.J4.string()},k=function(t){function n(e){return t.call(this,e,{Scheduler:new p.b(n.name)})||this}return(0,i.ZT)(n,t),Object.defineProperty(n.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),n}(c.d.createObjectMasterClass("LocaleInfoMaster",T,(function(t){return new I(t)}))),x=e(91091),F=e(64966),P=e(99374),D=e(20469),M=e(41275),L=e(85866),R=e(51150),A=e(96680),E=e(74871),O=e(56647),_={Id:l.J4.string({IsSourceGenerated:!0,IsKeyField:!0,SourceFieldName:"id"}),Description:l.J4.string({SourceFieldName:"description"}),Background:l.J4.fromMasterClass(d.Cu,{SourceFieldName:"background"}),Category:l.J4.string({SourceFieldName:"category"}),Logo:l.J4.fromMasterClass(d.Cu,{SourceFieldName:"logo"}),MeetingId:l.J4.string({SourceFieldName:"meetingId"}),ModifiedDate:l.J4.string({SourceFieldName:"modifiedDate"}),CreatedDate:l.J4.string({SourceFieldName:"createdDate"}),OtherInfo:l.J4.string({SourceFieldName:"otherInfo"}),OwnerId:l.J4.string({SourceFieldName:"ownerId"}),OwnerTenantId:l.J4.string({SourceFieldName:"ownerTenantId"}),OwnerUserType:l.J4.string({SourceFieldName:"ownerUserType"}),CollectionId:l.J4.string({SourceFieldName:"collectionId"}),RowCount:l.J4.number({SourceFieldName:"rowCount"}),ArchivedRowCount:l.J4.number({SourceFieldName:"archivedRowCount"}),SharedBy:l.J4.string({SourceFieldName:"sharedBy"}),SharedFormOwnerName:l.J4.string({SourceFieldName:"ownerDisplayName"}),SharedDate:l.J4.string({SourceFieldName:"dateTimeShared"}),TableId:l.J4.string({IsSourceGenerated:!0,SourceFieldName:"tableId"}),TenantSwitches:l.J4.number({SourceFieldName:"tenantSwitches"}),PrivacyUrl:l.J4.string({SourceFieldName:"privacyUrl"}),Title:l.J4.string({SourceFieldName:"title"}),Version:l.J4.string({SourceFieldName:"version"}),XlWorkbookId:l.J4.string({SourceFieldName:"xlWorkbookId"}),FillOutTimeLimit:l.J4.string({SourceFieldName:"fillOutTimeLimit"}),XlExportingTag:l.J4.string({SourceFieldName:"xlExportingTag"}),XlFileUnsynced:l.J4.boolean({SourceFieldName:"xlFileUnSynced"}),XlUnsyncedReason:l.J4.string({SourceFieldName:"xlUnsyncedReason"}),Permissions:l.J4.collectionOf((function(){return F.LN}),{SourceFieldName:"permissions"}),ResponderPermissions:l.J4.collectionOf((function(){return D.Qq}),{SourceFieldName:"responderPermissions"}),PermissionTokens:l.J4.collectionOf((function(){return P.p}),{SourceFieldName:"permissionTokens"}),Questions:l.J4.collectionOf(d.zE,{SourceFieldName:"questions"}),DescriptiveElements:l.J4.collectionOf((function(){return b.Jv}),{SourceFieldName:"descriptiveQuestions"}),MovingToRecycleBin:l.J4.boolean({IsLocalField:!0}),FormsInsightsInfo:l.J4.string({SourceFieldName:"formsInsightsInfo"}),SoftDeleted:l.J4.enumeration((function(){return L.d}),{SourceFieldName:"softDeleted",IsNumberTypeInDataSource:!0}),BusinessCdsId:l.J4.string({SourceFieldName:"BusinessCdsId"}),BusinessCdsRegion:l.J4.string({SourceFieldName:"BusinessCdsRegion"}),IsDefaultCds:l.J4.string({SourceFieldName:"IsDefaultCds"}),LastEmbedConfig:l.J4.string({SourceFieldName:"LastEmbedConfig"}),FormsProBranchRules:l.J4.string({SourceFieldName:"FormsProBranchRules"}),MfpBranchingData:l.J4.string({SourceFieldName:"mfpBranchingData"}),CVSimplifiedBranchingSupported:l.J4.string({SourceFieldName:"cvSimplifiedBranchingSupported"}),PipesDetails:l.J4.string({SourceFieldName:"formsProConfiguredPipes"}),FormsProRTTitle:l.J4.string({SourceFieldName:"formsProRTTitle"}),FormsProRTDescription:l.J4.string({SourceFieldName:"formsProRTDescription"}),ResponseThresholdCount:l.J4.string({SourceFieldName:"responseThresholdCount"}),InviteExpiryDays:l.J4.string({SourceFieldName:"inviteExpiryDays"}),FormsProEmbedCode:l.J4.string({SourceFieldName:"formsProEmbedCode"}),FormsProAnswerTagMap:l.J4.collectionOf({name:l.J4.string(),value:l.J4.string(),questionId:l.J4.string()},{IsLocalField:!0}),FormsProAnswerTagMapRT:l.J4.collectionOf({name:l.J4.string(),value:l.J4.string()},{IsLocalField:!0}),FooterText:l.J4.string({SourceFieldName:"footerText"}),ConditionalThankyouMessage:l.J4.string({SourceFieldName:"conditionalThankyouMessage"}),CVDefaultLanguage:l.J4.string({SourceFieldName:"cvDefaultLanguage"}),CustomCssFileName:l.J4.string({SourceFieldName:"customCssFileName"}),CustomDomainSenderEmail:l.J4.string({SourceFieldName:"customDomainSenderEmail"}),ProjectId:l.J4.string({SourceFieldName:"projectId"}),InitialFormId:l.J4.string({SourceFieldName:"initialFormId"}),InitialFormOwnerId:l.J4.string({SourceFieldName:"initialFormOwnerId"}),SurveyFont:l.J4.string({SourceFieldName:"surveyFont"}),HeaderFont:l.J4.string({SourceFieldName:"headerFont"}),Alias:l.J4.string({SourceFieldName:"alias"}),ShortUrl:l.J4.string({SourceFieldName:"shortUrl"}),ProjectName:l.J4.string({SourceFieldName:"projectName"}),ProjectGroupId:l.J4.string({SourceFieldName:"projectGroupId"}),FileUploadStorage:l.J4.string({SourceFieldName:"fileUploadStorage"}),SurveyPermanentId:l.J4.string({SourceFieldName:"surveyPermanentId"}),EmailTemplatesMapping:l.J4.string({SourceFieldName:"emailTemplatesMapping"}),SurveyLastModifiedAt:l.J4.string({SourceFieldName:"surveyLastModifiedAt"}),HeaderEnabled:l.J4.string({SourceFieldName:"headerEnabled"}),HeaderBGImage:l.J4.fromMasterClass(d.Cu,{SourceFieldName:"header"}),HeaderTheme:l.J4.fromMasterClass((function(){return u.Pv.Resolve("ICVMixin").getMixinHeaderThemeMaster()}),{IsLocalField:!0}),BackGroundPositionX:l.J4.string({IsLocalField:!0}),BackGroundPositionY:l.J4.string({IsLocalField:!0}),BackGroundPositionZ:l.J4.string({IsLocalField:!0}),ThemeHeaderBackgroundImageURL:l.J4.string({IsLocalField:!0}),LogoPositionX:l.J4.string({IsLocalField:!0}),LogoPositionY:l.J4.string({IsLocalField:!0}),TitlePositionX:l.J4.string({IsLocalField:!0}),TitlePositionY:l.J4.string({IsLocalField:!0}),LogoSize:l.J4.string({IsLocalField:!0}),HeaderImageFocalPointEnabled:l.J4.string({IsLocalField:!0}),HeaderOtherInfo:l.J4.string({SourceFieldName:"headerOtherInfo"}),HeaderAltText:l.J4.string({SourceFieldName:"headerAltText"}),CustomCSSInLineHeaderToggle:l.J4.string({SourceFieldName:"customCSSInLineHeaderToggle"}),FlowTemplateId:l.J4.string({SourceFieldName:"flowTemplateId"}),InvitesCoolingPeriod:l.J4.number({SourceFieldName:"invitesCoolingPeriod"}),OverSurveySettingEnabled:l.J4.boolean({SourceFieldName:"overSurveySettingEnabled"}),TrackingId:l.J4.string({SourceFieldName:"trackingId"}),ThankYouMessage:l.J4.string({SourceFieldName:"thankYouMessage"}),EmailReceiptEnabled:l.J4.boolean({SourceFieldName:"emailReceiptEnabled"}),Flags:l.J4.number({SourceFieldName:"flags"}),Type:l.J4.reference({SourceFieldName:"type"}),ReputationTier:l.J4.number({SourceFieldName:"reputationTier"}),BufferResponses:l.J4.collectionOf(l.J4.reference({},(function(t){return t.Id.toString()})),{IsLocalField:!0}),CoAuthors:l.J4.collectionOf(l.J4.reference(),{IsLocalField:!0}),DeleteCollaborationPermission:l.J4.boolean({IsLocalField:!0}),LastSyncTime:l.J4.number({IsLocalField:!0}),RtcStatus:l.J4.number({IsLocalField:!0}),HasValidBranching:l.J4.boolean({IsLocalField:!0}),HasQuestionMedia:l.J4.boolean({IsLocalField:!0}),Created:l.J4.string({IsLocalField:!0}),Modified:l.J4.string({IsLocalField:!0}),PredefinedResponses:l.J4.collectionOf({Id:l.J4.number({IsKeyField:!0}),Answers:l.J4.collectionOf({QuestionId:l.J4.string(),Answer:l.J4.reference()})},{IsLocalField:!0}),PrimaryCustomizedThemeColor:l.J4.string({IsLocalField:!0}),QuizQuestionsCount:l.J4.number({IsLocalField:!0}),SecondaryCustomizedThemeColor:l.J4.string({IsLocalField:!0}),Responses:l.J4.collectionOf(l.J4.reference({},(function(t){return t.Id.toString()})),{IsLocalField:!0}),ResponsesCount:l.J4.number({IsLocalField:!0}),XlExportingLocalTag:l.J4.string({IsLocalField:!0}),SerializedSettings:l.J4.string({SourceFieldName:"settings"}),Settings:l.J4.fromMasterClass((function(){return E.w}),{IsLocalField:!0}),SerializedPredefinedResponses:l.J4.string({SourceFieldName:"predefinedResponses"}),TertiaryCustomizedThemeColor:l.J4.string({IsLocalField:!0}),Theme:l.J4.fromMasterClass((function(){return O.I}),{IsLocalField:!0}),ResponseModels:l.J4.collectionOf((function(){return M.KJ}),{IsLocalField:!0}),IntegratedSavingState:l.J4.reference({IsLocalField:!0}),SavingState:l.J4.reference({IsLocalField:!0}),LogoInfo:l.J4.fromMasterClass(d.BF,{IsLocalField:!0}),CreatedFromOneDrive:l.J4.boolean({IsLocalField:!0}),TemplateId:l.J4.string({IsLocalField:!0}),TransferInProgress:l.J4.boolean({IsLocalField:!0}),DataClassificationLabel:l.J4.string(),DefaultLanguage:l.J4.string({SourceFieldName:"defaultLanguage"}),LocaleList:l.J4.collectionOf((function(){return k}),{SourceFieldName:"localeList"}),LocalizedResources:l.J4.collectionOf((function(){return N.k}),{SourceFieldName:"localizedResources"}),CreatedBy:l.J4.string({SourceFieldName:"createdBy"}),FileUploadFormInfo:l.J4.create({errorCode:l.J4.string()},{SourceFieldName:"fileUploadFormInfo"}),ProgressBarEnabled:l.J4.string({SourceFieldName:"progressBarEnabled"}),YouTubeMessageBarState:l.J4.enumeration((function(){return R.E}),{IsLocalField:!0}),QuizPreviousResponsesCount:l.J4.number({IsLocalField:!0}),NotifiedAdminForApproval:l.J4.boolean({IsLocalField:!0}),SupportedQuestionType:l.J4.reference({IsLocalField:!0})},B=function(t){function n(e,i,r,o,s,u){void 0===o&&(o=!1);var c=this,l=new a.wU;i=(0,A.xO)(i),(c=t.call(this,i,{Scheduler:new p.b(n.name),MasterReady:l.promise()})||this).initializing=l,c.syncBlocker=s?new a.bC(s):c.initializing,c.isGroupForm=r,c.Hn=o,c.Gn=e,c.qn=u;var f=(0,d.mp)();return c.formElementManager=new f(c),c.Vn(i),c.Un(i),c.$n(i),n.Rules.forEach((function(t){return c.addRule(t)})),c.jn(),c}return(0,i.ZT)(n,t),n.prototype.getSyncBlocker=function(){return this.syncBlocker},Object.defineProperty(n.prototype,"IsGroupForm",{get:function(){return this.isGroupForm},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"IsSampleForm",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"IsAssignmentForm",{get:function(){return!!this.isFieldReady(this.Schema.Category)&&"assignments"===this.Model.Category},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"SyncContext",{get:function(){return this.Gn},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"FormElementManager",{get:function(){return this.formElementManager},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"SettingMaster",{get:function(){return c.d.getObjectMasterFromModel(this.Model.Settings)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ThemeMaster",{get:function(){return c.d.getObjectMasterFromModel(this.Model.Theme)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"HeaderThemeMaster",{get:function(){return c.d.getObjectMasterFromModel(this.Model.HeaderTheme)},enumerable:!1,configurable:!0}),n.prototype.getRelatedSourceFields=function(t){return(0,A.sQ)(t)},n.prototype.getImageMaster=function(t){return(0,w.rQ)(this.getModelByFieldSchema(t))},n.prototype.getImageSettingsMaster=function(t){return(0,S.Hi)(this.getModelByFieldSchema(t))},n.prototype.getQuestionById=function(t){return this.formElementManager.getQuestionById(t)},n.prototype.getElementById=function(t){return this.formElementManager.getElementMasterById(t)},n.prototype.getReleasedResponsesByResponder=function(t){var n=this;return t&&!this.SettingMaster.Model.IsAnonymous?(0,g.Od)(this,t).then((function(t){return(0,f.M0)()?n.qn.normalizeResponses(t):n.normalizeResponses(t)})):Promise.resolve(null)},n.prototype.getRuntimeResponse=function(t){var n=this;return t?(0,g.mt)(this,t).then((function(t){return n.Wn(t)})):Promise.resolve(null)},n.prototype.ensureReadyToResponse=function(){return this.ensureFieldsReady((0,A.Co)())},n.prototype.ensureReadyToShare=function(){return this.ensureFieldsReady((0,A.ez)())},n.prototype.getDefaultResponse=function(){var t={};return(0,h.Es)()&&r.forEach(this.Model.Questions,(function(n){return t[n.Id]=n.DefaultValue})),t},n.prototype.hasSection=function(){return this.FormElementManager.SectionMasters.length>0},n.prototype.syncRuntimeResponses=function(){var t=this;return this.Synchronizer.existingInDataSource().then((function(){return(0,g.Lu)(t)})).then((function(n){t.updatingResponsesFromServer=!0,t.bulkEdit((function(){return t.Model.Responses=t.normalizeResponses(n)})),t.updatingResponsesFromServer=!1}))},n.prototype.submitResponse=function(t){var n=this;if(this.syncBlocker.states()===a.Cb.Pending)return Promise.resolve(void 0);var e=!1;return(t=r.clone(t)).Answers=r.map(t.Answers,(function(t){var i=n.getQuestionById(t.QuestionId);return i&&i.Model&&((t=r.clone(t)).Answer=i.serializeAnswer(t.Answer),"Question.TextField"===i.Model.Type&&!e&&i.Model.IsMathQuiz&&(e=!0)),t})),e&&this.Zn(t),new Promise((function(e){n.Synchronizer.existingInDataSource().then((function(){return e((0,g.qs)(n,t))}))}))},n.prototype.getSnapshotToCopy=function(){var t=this.getSnapshot((0,A.DV)()),n=null;return t.XlWorkbookId&&((n=r.clone(t)).XlWorkbookId="WaitingForExport"),this.Model.OwnerTenantId!==(0,o.k0)().userInfo.TenantId&&t.DataClassificationLabel&&(n||(n=r.clone(t)),n.DataClassificationLabel=null),null===n?t:n},n.prototype.getLocaleResouceById=function(t){var n=this;return(0,v.o7)(this.Model.Id).getLocaleResource(this.Model.Id,t).then((function(t){var e=(0,x.n$)(t);return n.ensureFieldsReady([n.Schema.Questions]).then((function(){return n.Xn(e)}))}))},n.prototype.Xn=function(t){var n=this;return r.forEach(t.localizedResources,(function(t){r.forEach(t.questionResources,(function(t){t.choices=r.filter(r.map(t.choices,(function(e){var i=n.getQuestionById(t.questionId),r=i&&(i.getChoiceByKey(e.key)||i.getChoiceById(Number(e.choiceId)));return r&&{key:r.Model.Key,choiceId:String(r.Model.Id),description:e.description}})),(function(t){return!!(t&&t.choiceId&&t.key&&t.description)}))}))})),t},n.prototype.totalSectionCount=function(){return this.formElementManager.SectionMasters.length+(this.formElementManager.HeaderTopQuestionMasters.length>0?1:0)},n.prototype.isProgressBarVisible=function(){return!!this.isFieldReady(n.Schema.ProgressBarEnabled)&&("true"===this.Model.ProgressBarEnabled&&this.totalSectionCount()>=2)},n.prototype.ensureFieldsReady=function(n){return t.prototype.ensureFieldsReady.call(this,n)},n.prototype.Un=function(t){t.ExistingInDataSource?this.isFieldReady(n.Schema.ModifiedDate)&&(this.Model.Modified=this.Model.ModifiedDate):this.Model.Modified=(new Date).toISOString()},n.prototype.$n=function(t){t.ExistingInDataSource?this.isFieldReady(n.Schema.CreatedDate)&&(this.Model.Created=this.Model.CreatedDate):this.Model.Created=(new Date).toISOString()},n.prototype.Vn=function(t){this.Yn=new y.S(this,n.Schema.OtherInfo,(0,A.gD)()),t.InitialData&&this.isFieldReady(n.Schema.OtherInfo)&&(t.ExistingInDataSource||t.InitialData.OtherInfo?this.Yn.deserialize():this.Yn.serialize())},n.prototype.initializeHeaderOtherInfoBinder=function(t){},n.prototype.normalizeResponses=function(t){var n=this;return this.bulkEdit((function(){t=t.map((function(t){return n.Wn(t)}))})),t},n.prototype.Wn=function(t){var n=this.Model.Settings.IsQuizMode&&this.SyncContext!==C.y.ResponseTimeForm,e={};this.FormElementManager.QuestionMasters.forEach((function(t){return e[t.Model.Id]=t})),(t=r.clone(t)).Answers=r.map(t.Answers,(function(t){var i=e[t.QuestionId];return i?((t=r.clone(t)).Answer=i.deserializeAnswer(t.Answer),t.IsMathAnswer=!i.Model.IsAnswerPlainText,null==t.Score&&n&&i.autoGradeAnswer(t),t):null})).filter((function(t){return!!t}));var i=this.getResponseModelById(t.Id);return i&&((0,M._p)(i).updateWithNormalizedResponse(t),t=i),t},n.prototype.getResponseModelById=function(t){return c.d.Collection.getItemWithKeyFields(this.Model.ResponseModels,{Id:t})},n.prototype.Zn=function(t){var n=this,e={QuestionCount:0,GradableQuestionCount:0,MathResponses:0,MathGradableResponses:0,TextResponses:0,TextGradableResponses:0,EmptyResponses:0,TotalLength:0};r.forEach(t.Answers,(function(t){var i=n.getQuestionById(t.QuestionId);if(i&&i.Model&&"Question.TextField"===i.Model.Type&&i.Model.IsMathQuiz){i.hasCorrectAnswers()?e.GradableQuestionCount++:e.QuestionCount++;var r=(0,s.d)(t.Answer);null!=r&&r.Answer?(e.TotalLength+=r.Answer.length,i.hasCorrectAnswers()?r.IsMath?e.MathGradableResponses++:e.TextGradableResponses++:r.IsMath?e.MathResponses++:e.TextResponses++):e.EmptyResponses++}}))},n.prototype.jn=function(){var t=this;this.formElementManager.adjustElementOrders();var e=[n.Schema.Questions,n.Schema.DescriptiveElements],i=this.qn;this.addRule({Name:"ElementOrder",InterestedFields:e,onChange:function(){i&&!i.isFormLoadingComplete()||t.formElementManager.adjustElementOrders()}})},Object.defineProperty(n,"Rules",{get:function(){if(!n.rules){var t=n.Schema;n.rules=[{Name:"DeserializeSettings",InterestedFields:[t.SerializedSettings],onChange:function(t){if(!t.BeingDeleted){var n=t.Master.Model.SerializedSettings||"{}",e=JSON.parse(n);t.Master.setData({Settings:e})}}},{Name:"DeserializePredefinedResponses",InterestedFields:[t.SerializedPredefinedResponses],onChange:function(t){if(!t.BeingDeleted){var n=t.Master.Model.SerializedPredefinedResponses||"[]",e=JSON.parse(n);t.Master.setData({PredefinedResponses:e})}}},{Name:"QuestionMediaProperties",InterestedFields:[t.Questions,t.DescriptiveElements],onChange:function(t){var n=t.Master.Model,e=c.d.convertToArray(t.Master.getSnapshot().Questions),i=c.d.convertToArray(t.Master.getSnapshot().DescriptiveElements);n.HasQuestionMedia=e.some((function(t){return!(!t.ImageInfo.ResourceUrl&&!t.VideoInfo.Url)}))||i.some((function(t){return!(!t.ImageInfo.ResourceUrl&&!t.VideoInfo.Url)}))}},{Name:"QuestionBranchValidity",InterestedFields:[t.Questions,t.DescriptiveElements],onChange:function(t){var e=t.Master.Model,i=!1;t.Master.isFieldReady(n.Schema.Questions)&&(i=c.d.convertToArray(t.Master.Model.Questions).some((function(t){return c.d.getObjectMasterFromModel(t).hasValidBranching()})));var r=!1;t.Master.isFieldReady(n.Schema.DescriptiveElements)&&(r=c.d.convertToArray(t.Master.Model.DescriptiveElements).some((function(t){return t.BranchInfo&&c.d.getObjectMasterFromModel(t.BranchInfo).isValid()})));e.HasValidBranching=i||r;var o=c.d.convertToArray(t.Master.getSnapshot().Questions);e.QuizQuestionsCount=o.filter((function(t){return t.IsQuiz})).length}}]}return n.rules},enumerable:!1,configurable:!0}),n}(c.d.createObjectMasterClass("FormMaster",_,(function(t,n){return t.getSyncBlocker().promise().then((function(){return new m.cV(t,n)}))})))},25366:function(t,n,e){"use strict";e.d(n,{H:function(){return u}});var i=e(12611),r=e(26203),o=e(73293),s=e(67661),a=e(53315),u=function(){function t(t){this.formMaster=t}return Object.defineProperty(t,"QuestionOrderFloor",{get:function(){return 500},enumerable:!1,configurable:!0}),Object.defineProperty(t,"QuestionOrderDefaultStep",{get:function(){return 100},enumerable:!1,configurable:!0}),t.isDescriptiveElement=function(t){return"Question.ColumnGroup"===t},t.isSection=function(t){return"Question.ColumnGroup"===t},Object.defineProperty(t.prototype,"TopQuestionMasters",{get:function(){return i.filter(this.formMaster.Model.Questions,(function(t){return!t.GroupId})).map(r.d.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"HeaderTopQuestionMasters",{get:function(){var t=this.SectionMasters,n=t.length&&t[0].Model.Order;return n>0?this.ne(null,n):this.TopQuestionMasters},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"HeaderQuestionMasters",{get:function(){var t=this.SectionMasters,n=t.length&&t[0].Model.Order;return n>0?this.ne(null,n,!0):this.QuestionMasters},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"QuestionMasters",{get:function(){return r.d.convertToArray(this.formMaster.Model.Questions).map(r.d.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"DescriptiveElementMasters",{get:function(){return r.d.convertToArray(this.formMaster.Model.DescriptiveElements).map(r.d.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SectionMasters",{get:function(){return i.filter(this.DescriptiveElementMasters,(function(n){return t.isDescriptiveElement(n.Model.Type)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"AllElementMasters",{get:function(){return this.getAllElements().map(r.d.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"TopElementMasters",{get:function(){return this.ee(!0).map(r.d.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),t.prototype.getQuestionById=function(t){var n=r.d.Collection.getItemWithKeyFields(this.formMaster.Model.Questions,{Id:t});return n&&(0,a.vV)(n)},t.prototype.getElementMasterById=function(t){return this.getQuestionById(t)||this.getDescriptiveElementMasterById(t)},t.prototype.getDescriptiveElementMasterById=function(t){var n=r.d.Collection.getItemWithKeyFields(this.formMaster.Model.DescriptiveElements,{Id:t});return n&&(0,o.PQ)(n)},t.prototype.findQuestionsInSection=function(t,n){if(t){var e=this.SectionMasters,r=i.indexOf(e,t);return r>=0?this.ne(e[r].Model.Order,r+1<e.length?e[r+1].Model.Order:null,n):[]}return n?this.HeaderQuestionMasters:this.HeaderTopQuestionMasters},t.prototype.findContainerSection=function(t){var n=this.SectionMasters;return n[i.findLastIndex(n,(function(n){return n.Model.Order<=t.Model.Order}))]},t.prototype.adjustElementOrders=function(){var n=this;if(this.formMaster.isFieldReady(s.x.Schema.Questions)){var e=this.formMaster.isFieldReady(s.x.Schema.DescriptiveElements),i=this.getAllElements();i.length&&this.formMaster.bulkEdit((function(){i.sort(t.questionComparer),i[0].Order||(i[0].Order=t.QuestionOrderFloor+t.QuestionOrderDefaultStep);for(var r=0,o=i[0].Order,s=1;s<=i.length;++s){var a=i[s]&&i[s].Order;if(!a)break;if(o!==a){var u=(a-o)/(s-r);for(o+=u;++r<s;)i[r].Order=o,o+=u}}for(;++r<i.length;)o+=t.QuestionOrderDefaultStep,i[r].Order=o;n.formMaster.Model.Questions=i.filter((function(n){return!t.isDescriptiveElement(n.Type)})).map((function(t){return t})),e&&(n.formMaster.Model.DescriptiveElements=i.filter((function(n){return t.isDescriptiveElement(n.Type)})))}))}},t.prototype.getSectionNodes=function(){var t=this,n=[],e=this.HeaderTopQuestionMasters;return e.length&&n.push({TopQuestionMasters:e}),this.SectionMasters.forEach((function(e){n.push({Section:e,TopQuestionMasters:t.findQuestionsInSection(e)})})),n},t.prototype.getAllElements=function(){return this.ee(!1)},t.prototype.ee=function(n){var e=r.d.convertToArray(this.formMaster.Model.Questions);n&&(e=i.filter(e,(function(t){return!t.GroupId})));var o=e;return this.formMaster.isFieldReady(s.x.Schema.DescriptiveElements)&&(o=o.concat(r.d.convertToArray(this.formMaster.Model.DescriptiveElements)).sort(t.questionComparer)),o},t.questionComparer=function(t,n){var e=t.Order-n.Order;return t.Order&&n.Order||(e=-e),e||t.Id.localeCompare(n.Id)},t.prototype.ne=function(t,n,e){var i;return i=e?this.QuestionMasters:this.TopQuestionMasters,null!==n&&(i=i.filter((function(t){return n>t.Model.Order}))),null!==t&&(i=i.filter((function(n){return n.Model.Order>=t}))),i},t}()},51586:function(t,n,e){"use strict";e.d(n,{OM:function(){return N},Si:function(){return g},Wq:function(){return S},ZP:function(){return w},hJ:function(){return C},iZ:function(){return b},jg:function(){return p},kJ:function(){return y}});e(56647);var i=e(12611),r=e(94290),o=e(9947),s=e(26203),a=e(37076),u=e(72467),c=e(41350),l=(e(64290),e(9743)),f=e(67661),h=e(96680),d={},m={},v=new c.Y;function g(t){return p(t,!0)}function p(t,n,e){if(void 0===e&&(e=!1),t.Id)return w(t,e);if(n?(t.OwnerId=t.OwnerId||(0,r.av)(),!t.OwnerId&&(0,u.f5)().Model.GroupMaster&&(t.OwnerId=(0,u.f5)().Model.GroupMaster.Model.id),t.OwnerTenantId=t.OwnerTenantId||(0,r.jM)()||(0,o.k0)().userInfo.TenantId):(t.OwnerId=t.OwnerId||(0,o.k0)().userInfo.UserId,t.OwnerTenantId=t.OwnerTenantId||(0,o.k0)().userInfo.TenantId),!t.OwnerId||!t.OwnerTenantId)throw new Error("Form OwnerId or OwnerTenantId cannot be null!");return y(t,n?"Group":"User",e)}function b(t,n){var e=new((0,u.Ed)())(l.y.DesignTimeForm,{ExistingInDataSource:!0,InitialData:t},n);return e.forceFieldsReady((0,h.E3)()),m[e.getInstanceId()]=e,v.trigger(e),e.Synchronizer.Model.CreationInProcess=!0,e}function y(t,n,e){var r=(0,h.pf)().map(s.d.getFieldSchemaInfo).map((function(t){return t.Name})),o=new((0,u.Ed)())(l.y.DesignTimeForm,{ExistingInDataSource:!1,InitialData:i.pick(t,r)},"Group"===n,e);return m[o.getInstanceId()]=o,o.existingOnServerSide().then((function(){d[o.Model.Id]=o})),v.trigger(o),o}function w(t,n,e){void 0===e&&(e=!1);var r=d[t.Id];if(r&&!e){var o=s.d.convertToSourceData(t,f.x.Schema);return r.Synchronizer.onSourceDataReceived(o),r}var c=(0,a.kc)(t.Id);return(t=i.clone(t)).OwnerId=c.OwnerId,t.OwnerTenantId=c.OrgId,t.TableId=c.TableId,r=new((0,u.Ed)())(l.y.DesignTimeForm,{ExistingInDataSource:!0,InitialData:t},c.IsGroupOwner,n),m[r.getInstanceId()]=r,d[t.Id]=r,v.trigger(r),r}function S(t){return m[t]}function N(t){return d[t]}function C(t){v.register(t)}},96680:function(t,n,e){"use strict";e.d(n,{Co:function(){return m},DV:function(){return l},E3:function(){return d},eT:function(){return p},ez:function(){return v},gD:function(){return h},pf:function(){return f},sQ:function(){return c},xO:function(){return g}});var i,r,o=e(12611),s=(e(64290),e(62539)),a=e(67661),u=e(74871);function c(t){var n=a.x.Schema,e=[];return t.forEach((function(t){switch(t){case"Settings":case n.Settings:e.push(n.SerializedSettings);break;case"Modified":case n.Modified:e.push(n.ModifiedDate);break;case"Created":case n.Created:e.push(n.CreatedDate);break;case"ResponsesCount":case n.ResponsesCount:e.push(n.RowCount);break;case"PredefinedResponses":case n.PredefinedResponses:e.push(n.SerializedPredefinedResponses);break;case"Theme":case n.Theme:e.push(n.Background,n.OtherInfo);break;case"HeaderTheme":case n.HeaderTheme:e.push(n.HeaderBGImage,n.HeaderOtherInfo);break;default:h().covers(t)?e.push(n.OtherInfo):!function(){r||(r=new s.C([a.x.Schema.HeaderTheme,a.x.Schema.BackGroundPositionX,a.x.Schema.BackGroundPositionY,a.x.Schema.BackGroundPositionZ,a.x.Schema.ThemeHeaderBackgroundImageURL,a.x.Schema.LogoPositionX,a.x.Schema.LogoPositionY,a.x.Schema.TitlePositionX,a.x.Schema.TitlePositionY,a.x.Schema.LogoSize]));return r}().covers(t)?e.push(t):e.push(n.HeaderOtherInfo)}})),o.uniq(e)}function l(){var t=a.x.Schema;return[t.Background,t.Description,t.Logo,t.LogoInfo,t.Questions,t.DescriptiveElements,t.Settings,t.SerializedSettings,t.SoftDeleted,t.Title,t.PrimaryCustomizedThemeColor,t.SecondaryCustomizedThemeColor,t.TertiaryCustomizedThemeColor,t.Theme,t.TrackingId,t.XlWorkbookId,t.ThankYouMessage,t.EmailReceiptEnabled,t.DataClassificationLabel,t.Type,t.DefaultLanguage,t.LocaleList,t.LocalizedResources,t.ReputationTier,t.MeetingId,t.FormsInsightsInfo,t.ProgressBarEnabled,t.FormsProRTTitle,t.FormsProRTDescription,t.FillOutTimeLimit,t.OtherInfo]}function f(){return l().concat([a.x.Schema.OwnerId,a.x.Schema.OwnerTenantId,a.x.Schema.CollectionId])}function h(){return i||(i=new s.C([a.x.Schema.PrimaryCustomizedThemeColor,a.x.Schema.SecondaryCustomizedThemeColor,a.x.Schema.TertiaryCustomizedThemeColor,a.x.Schema.Theme,a.x.Schema.LogoInfo,a.x.Schema.CreatedFromOneDrive,a.x.Schema.TemplateId])),i}function d(){var t=a.x.Schema;return[t.Title,t.ModifiedDate,t.CreatedDate,t.MeetingId,t.FormsInsightsInfo,t.OwnerId,t.OwnerTenantId,t.Description,t.Questions,t.DescriptiveElements,t.Permissions,t.ResponderPermissions,t.PermissionTokens,t.ResponsesCount,t.Settings,t.Theme,t.Logo,t.LogoInfo,t.Background,t.XlWorkbookId,t.XlExportingTag,t.XlFileUnsynced,t.XlUnsyncedReason,t.Category,t.TrackingId,t.PredefinedResponses,t.ThankYouMessage,t.EmailReceiptEnabled,t.Flags,t.ReputationTier,t.DataClassificationLabel,t.Type,t.DefaultLanguage,t.LocaleList,t.LocalizedResources,t.ProgressBarEnabled,t.FormsProRTTitle,t.FormsProRTDescription]}function m(){var t=a.x.Schema;return[t.Title,t.ModifiedDate,t.Description,t.Settings,t.Theme,t.Questions,t.DescriptiveElements,t.Logo,t.LogoInfo,t.Background,t.Category,t.PredefinedResponses,t.ThankYouMessage,t.EmailReceiptEnabled,t.DataClassificationLabel,t.Type,t.DefaultLanguage,t.LocaleList,t.ReputationTier,t.ProgressBarEnabled,t.TenantSwitches,t.PrivacyUrl,t.FormsProRTTitle,t.FormsProRTDescription]}function v(){var t=a.x.Schema;return[t.Title,t.ModifiedDate,t.OwnerId,t.OwnerTenantId,t.Description,t.Questions,t.DescriptiveElements,t.Settings,t.Theme,t.Logo,t.LogoInfo,t.Background,t.XlWorkbookId,t.Category,t.Type,t.ProgressBarEnabled,t.FormsProRTTitle,t.FormsProRTDescription]}function g(t){var n;return t.InitialData&&((t.InitialData.SerializedSettings||t.InitialData.Settings)&&(n=n||{},t.InitialData.SerializedSettings?n.Settings=JSON.parse(t.InitialData.SerializedSettings):n.SerializedSettings=u.w.serialize(t.InitialData.Settings)),(t.InitialData.SerializedPredefinedResponses||t.InitialData.PredefinedResponses)&&(n=n||{},t.InitialData.SerializedPredefinedResponses?n.PredefinedResponses=JSON.parse(t.InitialData.SerializedPredefinedResponses):n.SerializedPredefinedResponses=p(t.InitialData.PredefinedResponses))),n&&((t=o.clone(t)).InitialData=o.extend({},t.InitialData,n)),t}function p(t){return t&&t.length>0?JSON.stringify(t):null}},74871:function(t,n,e){"use strict";e.d(n,{w:function(){return l}});var i=e(59312),r=e(26203),o=e(39923),s=e(7645),a=e(81380),u=e(19930),c={LockGivenQuestionsEndDisplayOrder:o.J4.number(),LockGivenQuestionsStartDisplayOrder:o.J4.number(),FormClosed:o.J4.boolean(),FormClosedMessage:o.J4.string(),FormClosedMessageChanged:o.J4.boolean(),TimerEnabled:o.J4.boolean(),TimerEnabledStart:o.J4.boolean(),TimerEnabledEnd:o.J4.boolean(),StartTime:o.J4.string(),EndTime:o.J4.string(),RequiresUniqueResponse:o.J4.boolean(),IsAnonymous:o.J4.boolean(),NotRecordIdentity:o.J4.boolean(),ShuffleAllQuestions:o.J4.boolean(),ShuffleQuestionOrder:o.J4.boolean(),ShowGradedResults:o.J4.boolean(),RespondInAppOnly:o.J4.boolean(),AllowCopy:o.J4.boolean(),ShareToken:o.J4.string(),ManualGradingEnabled:o.J4.boolean(),IsQuizMode:o.J4.boolean(),EmailNotification:o.J4.boolean(),AllowResponderGetAllResponses:o.J4.boolean(),ShowQuestionNumbers:o.J4.boolean(),IsEmailableEntityCreationEnabled:o.J4.boolean(),CDSSyncQuestionResponses:o.J4.boolean(),OverSurveySettingEnabled:o.J4.boolean(),InvitesCoolingPeriod:o.J4.number(),EmailableEntity:o.J4.string(),HideLanguageDropdown:o.J4.boolean(),PauseAndResumeSurvey:o.J4.boolean(),RecordPartialResponse:o.J4.number(),DisableSubmitAnother:o.J4.boolean(),PermissionForResponder:o.J4.boolean()},l=function(t){function n(e){var i=t.call(this,e)||this;return i.addRule({Name:"updateClosedMessage",InterestedFields:[i.Schema.FormClosed],onChange:n.updateClosedMessage}),i.addRule({Name:"updateAllowCopy",InterestedFields:[i.Schema.ShareToken],onChange:n.updateAllowCopy}),i}return(0,i.ZT)(n,t),n.serialize=function(t){var n=r.d.convertToSourceData(t,this.Schema),e=0;return Object.keys(n).forEach((function(t){null==n[t]?delete n[t]:++e})),e>0?JSON.stringify(n):null},n.prototype.getFormStatus=function(){var t=this.Model;if(t.FormClosed)return u.r.Closed;if(t.TimerEnabled){var n=Date.now();if(null!=t.StartTime&&Date.parse(t.StartTime)>n)return u.r.NotStarted;if(null!=t.EndTime&&Date.parse(t.EndTime)<n)return u.r.Expired}return u.r.Opened},n.prototype.getFormClosedMessage=function(){var t=this.Model;switch(this.getFormStatus()){case u.r.Closed:return t.FormClosedMessage;case u.r.NotStarted:return(0,s.pm)().FormSetting_NotStartForm_DefaultMessage.format(new Date(t.StartTime).toLocaleString());case u.r.Expired:return(0,s.pm)().FormSetting_ExpiredForm_DefaultMessage;default:return}},n.prototype.setSharingStatus=function(t,n){var e=this,i=this.Parent,r=(0,a.lK)(i);return i.existingOnServerSide().then((function(){return r.changeSharingStatus(i.Model.Id,n)})).then((function(t){e.Model.ShareToken=t}))},n.updateClosedMessage=function(t){if(-1===t.FieldSchemas.indexOf(n.Schema.FormClosedMessage)){var e=t.Master.Model;e.FormClosed?null!=e.FormClosedMessage&&(0,s.ay)().then((function(t){return e.FormClosedMessage=t.FormSetting_ClosedForm_DefaultMessage})):e.FormClosedMessage=null}},n.updateAllowCopy=function(t){var n=t.Master.Model;n.AllowCopy=!!n.ShareToken},n}(r.d.createObjectMasterClass("FormSettingsMaster",c))},56647:function(t,n,e){"use strict";e.d(n,{I:function(){return d}});var i=e(59312),r=e(46407),o=e(9947),s=e(26203),a=e(39923),u=e(41317),c=e(43367),l=e(9743),f=e(67661),h={BackgroundColor:a.J4.string({IsLocalField:!0}),BackgroundImage:a.J4.string({IsLocalField:!0}),Name:a.J4.string(),PrimaryColor:a.J4.string({IsLocalField:!0}),SecondaryColor:a.J4.string({IsLocalField:!0}),Thumbnail:a.J4.string({IsLocalField:!0})},d=function(t){function n(n){var e=t.call(this,n)||this;if(n.MasterTreeReady){var i=f.x.Schema;n.MasterTreeReady.then((function(){return e.Form.fieldsReady([i.Theme])})).then((function(){return e.Form.ensureFieldsReady([i.PrimaryCustomizedThemeColor,i.SecondaryCustomizedThemeColor,i.TertiaryCustomizedThemeColor,i.Background])})).then((function(){return e.ie()}))}return e}return(0,i.ZT)(n,t),Object.defineProperty(n.prototype,"Form",{get:function(){return this.Parent},enumerable:!1,configurable:!0}),n.prototype.isCustomized=function(){return this.Model.Name===r.FP},n.prototype.getCustomizedTheme=function(){var t=this.Form.Model,n=(0,c.getIoCDefaultTheme)();return{BackgroundColor:t.TertiaryCustomizedThemeColor||n.BackgroundColor,BackgroundImage:t.Background.ResourceUrl,Name:r.FP,PrimaryColor:t.PrimaryCustomizedThemeColor||n.PrimaryColor,SecondaryColor:t.SecondaryCustomizedThemeColor||n.SecondaryColor,Thumbnail:null}},n.prototype.ie=function(){var t=this;this.addRule({Name:"calculate theme basing on name",onChange:function(n){n.BeingDeleted||t.re()}});var n=f.x.Schema;this.Form.observe((function(){return t.re()}),[n.PrimaryCustomizedThemeColor,n.SecondaryCustomizedThemeColor,n.TertiaryCustomizedThemeColor,n.Background.ResourceUrl]),this.re()},n.prototype.re=function(){var t=this,n=this.Model.Name;switch(n){case r.FP:this.setData(this.getCustomizedTheme());break;case r.kC:this.setData((0,c.getIoCDefaultTheme)());break;default:var e=(0,o.k0)().themeConfig;if(e&&"object"==typeof e&&e[n]&&"object"==typeof e[n])return void this.setData(e[n]);this.se(n).then((function(n){return t.setData(n)}))}},n.prototype.se=function(t){return this.Form.SyncContext!==l.y.ResponseTimeForm?(0,u.BM)(t):(0,u.lx)(t)},n}(s.d.createObjectMasterClass("FormTheme",h))},93271:function(t,n,e){"use strict";e.d(n,{r:function(){return w},k:function(){return y}});var i=e(59312),r=e(97265),o=e(37890),s=e(26203),a=e(39923),u=e(94605),c=e(94956),l=e(53907),f=e(62539),h=e(82205),d=e(41293),m=e(31442),v=e(81380),g=e(9743),p=function(){function t(t,n){this.ae=t,this.Ot=(0,v.lK)(this.ae.Form)}return Object.defineProperty(t.prototype,"FormId",{get:function(){return this.ae.FormId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"QuestionId",{get:function(){return this.ae.QuestionId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ChoiceId",{get:function(){return this.ae.Model.Id},enumerable:!1,configurable:!0}),t.prototype.add=function(t){if(this.ae.Form.SyncContext===g.y.DesignTimeForm)return this.Ot.createQuestionChoice(this.FormId,this.QuestionId,t);(0,d._y)("Trying to create a choice out of design time.")},t.prototype.delete=function(t){if(this.ae.Form.SyncContext===g.y.DesignTimeForm)return this.Ot.deleteQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId);(0,d._y)("Trying to delete a choice out of design time.")},t.prototype.query=function(t){return this.Ot.getQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId)},t.prototype.update=function(t,n){if(this.ae.Form.SyncContext===g.y.DesignTimeForm){if(t)return this.Ot.updateQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId,t);try{throw Error("patch choice body null error")}catch(t){(0,m.zU)("DataSourceUpdatingChoiceNull",{stack:t.stack})}return Promise.resolve()}(0,d._y)("Trying to update a choice out of design time.")},t}(),b={Id:a.J4.number({IsSourceGenerated:!0,IsKeyField:!0,SourceFieldName:"id"}),AnswerHint:a.J4.string({SourceFieldName:"description"}),CustomProperties:a.J4.string({SourceFieldName:"customProperties"}),Description:a.J4.string({SourceFieldName:"displayText"}),FormsProDisplayRTText:a.J4.string({IsLocalField:!0}),Order:a.J4.number({SourceFieldName:"order"}),Key:a.J4.string({SourceFieldName:"key"}),IsGenerated:a.J4.boolean({IsLocalField:!0}),IsMathOption:a.J4.boolean({IsLocalField:!0}),BranchInfo:a.J4.fromMasterClass((function(){return u.G}),{IsLocalField:!0}),SavingState:a.J4.reference({IsLocalField:!0}),Level:a.J4.number({SourceFieldName:"level"}),ParentOrder:a.J4.number({SourceFieldName:"parentOrder"}),parentChoiceId:a.J4.number({SourceFieldName:"parentId"})};function y(t){return s.d.getObjectMasterFromModel(t)}var w=function(t){function n(e){var i=this,s=new o.wU;return i=t.call(this,e,{Scheduler:new c.b(n.name),MasterReady:s.promise()})||this,(0,h.vG)(i),i.fieldsReady([i.Schema.Id,i.Schema.Key]).then((function(){i.Model.Key||(i.Model.Key=(0,r.GW)())})),i.ue(e),s.resolve(),i}return(0,i.ZT)(n,t),Object.defineProperty(n.prototype,"Question",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"QuestionId",{get:function(){return this.Question.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Form",{get:function(){return this.Question.Form},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),n.prototype.ue=function(t){this.ce=new l.S(this,n.Schema.CustomProperties,n.CustomPropertiesFieldSet),t.InitialData&&this.isFieldReady(n.Schema.CustomProperties)&&(t.ExistingInDataSource||t.InitialData.CustomProperties?this.ce.deserialize():this.ce.serialize())},Object.defineProperty(n,"CustomPropertiesFieldSet",{get:function(){return n.customPropertiesFieldSet||(n.customPropertiesFieldSet=new f.C([n.Schema.BranchInfo,n.Schema.IsGenerated,n.Schema.IsMathOption,n.Schema.FormsProDisplayRTText])),n.customPropertiesFieldSet},enumerable:!1,configurable:!0}),n}(s.d.createObjectMasterClass("ChoiceV2Master",b,(function(t,n){return new p(t,n)})))},76795:function(t,n,e){"use strict";e.d(n,{L:function(){return f},P:function(){return h}});var i=e(59312),r=e(12611),o=e(63795),s=e(26203),a=e(7645),u=e(64290),c=e(58680),l=e(53315),f=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.getElementTypeName=function(){return"Question.Choice"},n.createDefaultDefinition=function(){var t=[{Description:(0,a.pm)().Designer_Choices_DefaultDescription.format(1),IsGenerated:!0},{Description:(0,a.pm)().Designer_Choices_DefaultDescription.format(2),IsGenerated:!0}];return{Type:n.getElementTypeName(),Title:(0,a.pm)().Question_DefaultTitle,Choices:t,ChoiceType:l.T6.SingleChoice,OptionDisplayStyle:l.h3.ListAll,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},n.supportMobileDesign=function(t){return!n.hasInvalidSettingOnMobile(t)&&t.OptionDisplayStyle!==l.h3.Dropdown},n.prototype.verify=function(t){return!this.Model.Required||t&&"[]"!==t?t&&t.length>n.MaxAnswerLength?l.ej.MultiChoiceQuestionLengthLimitError:l.ej.Success:l.ej.RequiredError},n.prototype.isEmpty=function(t){return this.Model.ChoiceType===l.T6.SingleChoice?!t:!t||"[]"===t},n.prototype.getTypeDisplayName=function(){switch(this.Model.ChoiceType){case l.T6.SingleChoice:return(0,a.pm)().QuestionType_SingleChoice;case l.T6.MultiChoice:return(0,a.pm)().QuestionType_MultiChoice;default:throw Error("Choice Question Type Not Supported")}},n.prototype.supportsQuestionLevelBranching=function(){return this.Model.ChoiceType!==l.T6.SingleChoice},n.prototype.supportsChoiceLevelBranching=function(){return this.Model.ChoiceType===l.T6.SingleChoice},n.prototype.getSnapshotWithoutBranchInfo=function(){var n=t.prototype.getSnapshotWithoutBranchInfo.call(this);return n.Choices=s.d.convertToArray(n.Choices).map((function(t){return delete(t=r.clone(t)).BranchInfo,t})),n},n.prototype.resetBranchInfo=function(){var n=this;t.prototype.resetBranchInfo.call(this),s.d.convertToArray(this.Model.Choices).filter((function(t){return n.getBranchInfoMaster(t.BranchInfo).resetToDefault()})),this.getBranchInfoMaster(this.Model.BranchInfoForOtherChoice).resetToDefault()},n.prototype.insertChoice=function(t,n){var e=this.Model.Choices,i=r.find(e,(function(t){return t.IsGenerated}));if(!i||n&&""!==i.Description){var o=s.d.Collection.addItems(e,[{Description:t,IsMathOption:n}]);i=o[0]}else{var a=s.d.getObjectMasterFromModel(i);(0,u.pd)((function(){a.bulkEdit((function(){i.Description=t,i.IsGenerated=null,i.IsMathOption=n}))}),u.t1)}return i},n.prototype.hasCorrectAnswers=function(t){return t?r.some(t.IsAnswerKeys):r.some(this.Model.Choices,(function(t){return t.IsAnswerKey}))},n.prototype.isCorrectAnswer=function(t){var n=h(t,this.Model).SelectedOptions.map((function(t){return(0,o.bC)(t)})).sort(),e=s.d.convertToArray(this.Model.Choices).filter((function(t){return t.IsAnswerKey})).map((function(t){return t.Description})).map((function(t){return(0,o.bC)(t)})).sort();return r.isEqual(e,n)},n.prototype.justifyQuestionInfo=function(){var t=this.Master.Model;if(null==t.OptionDisplayStyle){var e=t.ChoiceType===l.T6.SingleChoice&&!t.IsMathQuiz&&!t.AllowOtherAnswer&&t.Choices.length>=n.MinimumOptionsForDropDown;t.OptionDisplayStyle=e?l.h3.Dropdown:l.h3.ListAll}},n.prototype.showAsDropdown=function(){return this.Master.Model.OptionDisplayStyle===l.h3.Dropdown},n.prototype.setAnswerKey=function(t,n){var e=this;this.Master.bulkEdit((function(){t.IsAnswerKey=n,e.Model.ChoiceType===l.T6.SingleChoice&&t.IsAnswerKey&&s.d.convertToArray(e.Model.Choices).forEach((function(n){n.IsAnswerKey&&n!==t&&(n.IsAnswerKey=!1)}))}))},n.prototype.createQuizResult=function(t){if(this.Model.IsQuiz){var n=s.d.convertToArray(this.Model.Choices);return n.some((function(t){return t.IsAnswerKey}))?{IsAnswerCorrect:this.isCorrectAnswer(t),AnswerHints:n.map((function(t){return t.AnswerHint})),IsAnswerKeys:n.map((function(t){return t.IsAnswerKey})),Choices:n.map((function(t){return t.Description})),GradingBasis:this.Model.GradingBasis}:void 0}},n.prototype.autoGradeAnswer=function(n){if(r.some(this.Model.Choices,(function(t){return t.IsAnswerKey}))){var e=this.Model.Point?this.Model.Point:0;n.Score=this.isCorrectAnswer(n.Answer)?e:0,n.IsAutoGraded=!0}else t.prototype.autoGradeAnswer.call(this,n)},n.prototype.autoGradeWithQuizResult=function(t,n){return n?n.IsAnswerCorrect?this.Model.Point:0:null},n.prototype.getBranchingResult=function(n){var e=this;if(this.Model.ChoiceType!==l.T6.SingleChoice)return t.prototype.getBranchingResult.call(this,n);var i=s.d.convertToArray(this.Model.Choices),o=i.filter((function(t){return t.BranchInfo&&s.d.getObjectMasterFromModel(t.BranchInfo).isValid()})),a=s.d.getObjectMasterFromModel(this.Model.BranchInfoForOtherChoice);if(0===o.length&&!a.isValid())return t.prototype.getBranchingResult.call(this,n);var u,c=i.filter((function(t){return e.fe(n,t)})),f=r.intersection(c,o);f.length>0||c.length>0?u=(f[0]||c[0]).BranchInfo:this.isEmpty(n)||(u=this.Model.BranchInfoForOtherChoice);return u?this.getBranchInfoMaster(u).getBranchingResult():{Type:"Pending"}},n.prototype.fe=function(t,n){return n.Description===t},n.MinimumOptionsForDropDown=7,n.MaxAnswerLength=4e3,n}(c.P);function h(t,n){var e=n.ChoiceType===l.T6.SingleChoice;if(null!=t){var i=s.d.convertToArray(n.Choices).map((function(t){return t.Description}));if(!e||!n.AllowOtherAnswer&&!r.contains(i,t))try{var o=JSON.parse(t);if(Array.isArray(o)){if(!o.some((function(t){return!r.isString(t)})))return{IsSingleChoiceAnswer:!1,IsLegacyChoiceAnswer:!1,SelectedOptions:o}}else if(r.isObject(o)){var a=r.values(o);if(!a.some((function(t){return!r.isString(t)})))return{IsSingleChoiceAnswer:e&&a.length<=1,IsLegacyChoiceAnswer:!0,SelectedOptions:a}}}catch(t){}}return{IsSingleChoiceAnswer:e,IsLegacyChoiceAnswer:!1,SelectedOptions:null==t?[]:[t]}}},58680:function(t,n,e){"use strict";e.d(n,{P:function(){return o}});var i=e(12611),r=e(26203),o=function(){function t(t){this.me=t}return t.supportMobileDesign=function(t){return!1},t.hasInvalidSettingOnMobile=function(t){return t.ShowSubtitle||!!t.ImageInfo.ResourceUrl||!!t.VideoInfo.Url},Object.defineProperty(t.prototype,"Master",{get:function(){return this.me},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Model",{get:function(){return this.me.Model},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(t){return!t},t.prototype.justifyNumberBoundaries=function(){throw Error("to be overridden")},t.prototype.supportsQuestionLevelBranching=function(){return!0},t.prototype.supportsChoiceLevelBranching=function(){return!1},t.prototype.getBranchedResult=function(t,n){var e=this.getBranchingResult(t);if("Next"===e.Type)e.TargetElement=n;return e},t.prototype.isNumberType=function(){return!1},t.prototype.getNumberValidationErrorMessage=function(t){throw Error("to be overridden")},t.prototype.getValidationErrorMessage=function(){throw Error("to be overridden")},t.prototype.getSnapshotWithoutBranchInfo=function(){var t=i.clone(this.Master.getSnapshot());return delete t.BranchInfo,delete t.BranchInfoForOtherChoice,t},t.prototype.resetBranchInfo=function(){this.getBranchInfoMaster(this.Model.BranchInfo).resetToDefault()},t.prototype.insertChoice=function(t,n){},t.prototype.getNormalizedAnswer=function(t){return t},t.prototype.hasAnswer=function(){return!0},t.prototype.hasCorrectAnswers=function(t){return!1},t.prototype.isCorrectAnswer=function(t){return!1},t.prototype.setAnswerKey=function(t,n){},t.prototype.createQuizResult=function(t){return null},t.prototype.autoGradeAnswer=function(t){var n=!this.Model.Point,e=null==t.Answer||""===t.Answer;(n||e)&&(t.Score=0,t.IsAutoGraded=!0)},t.prototype.autoGradeWithQuizResult=function(t,n){var e=this.Master.Parent;return(e&&e.Model||this.Model).Point||(null==t||""===t)?0:null},t.prototype.serializeAnswer=function(t){return t},t.prototype.deserializeAnswer=function(t){return t},t.prototype.justifyQuestionInfo=function(){},t.prototype.showAsDropdown=function(){},t.prototype.redressGradingBasis=function(){},t.prototype.getBranchInfoMaster=function(t){return r.d.getObjectMasterFromModel(t)},t.prototype.getBranchingResult=function(t){return this.getBranchInfoMaster(this.Model.BranchInfo).getBranchingResult()},t}()},53315:function(t,n,e){"use strict";e.d(n,{T6:function(){return S},pW:function(){return w},h3:function(){return I},MF:function(){return G},ej:function(){return C},le:function(){return N},PA:function(){return y},vV:function(){return H}});var i,r=e(59312),o=e(12611),s=e(15934),a=e(37890),u=e(26203),c=e(41293),l=e(39923),f=e(43367),h=e(72467),d=e(46008),m=(e(64290),e(31442)),v=e(94605),g=e(94956),p=e(90819),b=e(3920);!function(t){t[t.None=0]="None",t[t.All=1]="All",t[t.Flip=2]="Flip",t[t.LimitedNumber=3]="LimitedNumber",t[t.Advanced=4]="Advanced"}(i||(i={}));var y,w,S,N,C,I,T,k,x=e(53907),F=e(62539),P=(e(67661),e(82205)),D=e(93271),M=e(81380),L=e(9743),R=[],A=function(t){for(;R.shift()!==t;);},E=function(t){return t.then((function(n){return A(t),n})).catch((function(n){throw A(t),n}))},O=function(){function t(t,n){this.ve=t,this.Ot=(0,M.lK)(this.ve.Form)}return Object.defineProperty(t.prototype,"FormId",{get:function(){return this.ve.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"QuestionId",{get:function(){return this.ve.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"QuestionType",{get:function(){return this.ve.Model.Type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ExtraQosData",{get:function(){var t=this.ve.Form;return{WithSection:t.isFieldReady(t.Schema.DescriptiveElements)&&t.hasSection(),FormType:t.isFieldReady(t.Schema.Type)&&null!==t.Model.Type?t.Model.Type:""}},enumerable:!1,configurable:!0}),t.prototype.add=function(t){var n=this;if(this.ve.Form.SyncContext===L.y.DesignTimeForm){var e=this.ve.ParentQuestionMaster;return e?e.Synchronizer.existingInDataSource().then((function(){return n.ge(t)})):this.ge(t)}(0,c._y)("Trying to create a question without design type.")},t.prototype.delete=function(t){var n=this;this.ve.Form.SyncContext!==L.y.DesignTimeForm&&(0,c._y)("Trying to delete a question without design type.");var e=this.ve.ParentQuestionMaster;if(e&&e.Deleted)return Promise.resolve();var i=this.ve.SubQuestionMasters.map((function(t){return t.Synchronizer.flush()}));return Promise.all(i).then((function(){return n.ve.createSyncJob((function(){return n.Ot.deleteFormQuestion(n.FormId,t.id,n.QuestionType,n.ExtraQosData)}))})).then(null,(function(t){if(t&&621===t.innerCode)return Promise.resolve();throw t}))},t.prototype.query=function(t){(0,c._y)("No scenario to call this method currently.")},t.prototype.update=function(t,n){var e=this;if(this.ve.Form.SyncContext!==L.y.DesignTimeForm)return Promise.resolve();if("id"in t){var i=t.id,r=n.ValuesBefore.id;(0,m.zU)("DataSourceUpdatingQuestionId",{newId:i,oldId:r})}if(null===t.allowMultipleValues)try{throw Error("allowMultipleValues null error")}catch(t){(0,m.zU)("DataSourceUpdatingQuestionNullAllowMultipleValues",{stack:t.stack})}return this.ve.createUploadSyncJob((function(){return e.Ot.updateFormQuestion(e.FormId,e.QuestionId,e.QuestionType,t,e.ExtraQosData)}))},t.prototype.ge=function(t){var n=this,e=this.ve.createSyncJob((function(){return n.pe(t)})).then((function(t){var n=t;return n.FileUploadSPOInfo&&(t.fileUploadSPOInfo={driveId:n.FileUploadSPOInfo.DriveId,errorCode:n.FileUploadSPOInfo.ErrorCode,folderId:n.FileUploadSPOInfo.FolderId,linkInfo:n.FileUploadSPOInfo.linkInfo,anonymousLinkInfo:n.FileUploadSPOInfo.anonymousLinkInfo}),t}));return e.then((function(t){"id"in t&&t.id!==n.QuestionId&&(0,m.zU)("ChangedIdFromServerSide",{formId:n.FormId,newId:t.id,oldId:n.QuestionId})})),e},t.prototype.pe=function(t){var n=this;if("Question.FileUpload"===t.type){if(R.length>0){var e=R[R.length-1].then((function(){return n.Ot.createFormQuestion(n.FormId,t,n.ExtraQosData)}),(function(){return n.Ot.createFormQuestion(n.FormId,t,n.ExtraQosData)}));return R.push(e),E(e)}var i=this.Ot.createFormQuestion(this.FormId,t,this.ExtraQosData);return R.push(i),E(i)}return this.Ot.createFormQuestion(this.FormId,t,this.ExtraQosData)},t}(),_=e(36837),B={Id:l.J4.string({IsKeyField:!0,SourceFieldName:"id"}),DefaultValue:l.J4.string({SourceFieldName:"defaultValue"}),ImageInfo:l.J4.fromMasterClass(h.Cu,{SourceFieldName:"image"}),ImageSettings:l.J4.fromMasterClass(h.BF,{IsLocalField:!0}),Order:l.J4.number({SourceFieldName:"order"}),QuestionInfo:l.J4.string({SourceFieldName:"questionInfo"}),Required:l.J4.boolean({SourceFieldName:"required"}),Subtitle:l.J4.string({SourceFieldName:"subtitle"}),CombinedTitle:l.J4.string({SourceFieldName:"title"}),Type:l.J4.reference({SourceFieldName:"type"}),GroupId:l.J4.string({SourceFieldName:"groupId"}),ShowSubtitle:l.J4.boolean({IsLocalField:!0}),Hidden:l.J4.boolean({IsLocalField:!0}),Visible:l.J4.boolean({IsLocalField:!0}),FormsProRTQuestionTitle:l.J4.string({SourceFieldName:"formsProRTQuestionTitle"}),FormsProCalculateSentiment:l.J4.boolean({IsLocalField:!0}),FormsProRTSubtitle:l.J4.string({SourceFieldName:"formsProRTSubtitle"}),FormsProEnableAnswerTag:l.J4.boolean({IsLocalField:!0}),FormsProAnswerTag:l.J4.string({IsLocalField:!0}),FormsProAnswerTagHasError:l.J4.boolean({IsLocalField:!0}),Title:l.J4.string({IsLocalField:!0}),BranchInfo:l.J4.fromMasterClass((function(){return v.G}),{IsLocalField:!0}),IntegratedSavingState:l.J4.reference({IsLocalField:!0}),SavingState:l.J4.reference({IsLocalField:!0}),IsQuiz:l.J4.boolean({SourceFieldName:"isQuiz"}),GradingBasis:l.J4.string({IsLocalField:!0}),Point:l.J4.number({IsLocalField:!0}),AllowMultipleValues:l.J4.boolean({SourceFieldName:"allowMultipleValues"}),AllowOtherAnswer:l.J4.boolean({IsLocalField:!0}),BranchInfoForOtherChoice:l.J4.fromMasterClass((function(){return v.G}),{IsLocalField:!0}),FormsProIsFileUploaded:l.J4.boolean({IsLocalField:!0}),FormsProChoiceLimits:l.J4.boolean({IsLocalField:!0}),FormsProNumberOfSelections:l.J4.number({IsLocalField:!0}),FormsProOptionsLayout:l.J4.enumeration((function(){return T}),{IsLocalField:!0}),FormsProOtherChoice:l.J4.create({Description:l.J4.string(),IsDefault:l.J4.boolean(),FormsProDisplayRTText:l.J4.string()},{IsLocalField:!0}),FormsProRandomizationType:l.J4.enumeration((function(){return i}),{IsLocalField:!0}),FormsProNumberOfRandomizationOptions:l.J4.number({IsLocalField:!0}),OptionDisplayStyle:l.J4.enumeration((function(){return I}),{IsLocalField:!0}),ChoiceGroup:l.J4.collectionOf((function(){return D.r}),{SourceFieldName:"choices"}),Choices:l.J4.collectionOf({Description:l.J4.string(),BranchInfo:l.J4.fromMasterClass((function(){return v.G})),IsAnswerKey:l.J4.boolean(),AnswerHint:l.J4.string(),IsGenerated:l.J4.boolean(),IsMathOption:l.J4.boolean(),FormsProDisplayRTText:l.J4.string()},{IsLocalField:!0}),ChoiceType:l.J4.reference({IsLocalField:!0}),Hint:l.J4.string({IsLocalField:!0}),ShuffleOptions:l.J4.boolean({IsLocalField:!0}),Length:l.J4.number({IsLocalField:!0}),RatingShape:l.J4.enumeration((function(){return N}),{IsLocalField:!0}),LeftDescription:l.J4.string({IsLocalField:!0}),RightDescription:l.J4.string({IsLocalField:!0}),FormsProRTLeftDescription:l.J4.string({IsLocalField:!0}),FormsProRTRightDescription:l.J4.string({IsLocalField:!0}),ShowRatingLabel:l.J4.boolean({IsLocalField:!0}),MinRating:l.J4.number({IsLocalField:!0}),FormsProSmileyList:l.J4.string({IsLocalField:!0}),Multiline:l.J4.boolean({IsLocalField:!0}),IsNumber:l.J4.boolean({IsLocalField:!0}),HasTFRestrictionForPro:l.J4.boolean({IsLocalField:!0}),Placeholder:l.J4.string({IsLocalField:!0}),NumberValidationRule:l.J4.enumeration((function(){return w}),{IsLocalField:!0}),FormsProValidationType:l.J4.enumeration((function(){return y}),{IsLocalField:!0}),NumberMinBoundary:l.J4.string({IsLocalField:!0}),NumberMaxBoundary:l.J4.string({IsLocalField:!0}),FormsProCustomRegEx:l.J4.string({IsLocalField:!0}),FormsProCustomPlaceholder:l.J4.string({IsLocalField:!0}),Date:l.J4.boolean({IsLocalField:!0}),Time:l.J4.boolean({IsLocalField:!0}),FileUploadSPOInfo:l.J4.create({anonymousLinkInfo:l.J4.string(),driveId:l.J4.string(),folderId:l.J4.string(),errorCode:l.J4.string(),linkInfo:l.J4.string()},{SourceFieldName:"fileUploadSPOInfo"}),FileTypes:l.J4.create({Word:l.J4.boolean(),Excel:l.J4.boolean(),PowerPoint:l.J4.boolean(),PDF:l.J4.boolean(),Image:l.J4.boolean(),Video:l.J4.boolean(),Audio:l.J4.boolean()},{IsLocalField:!0}),MaxFileCount:l.J4.number({IsLocalField:!0}),MaxFileSize:l.J4.number({IsLocalField:!0}),HasSpecificFileType:l.J4.boolean({IsLocalField:!0}),CoAuthors:l.J4.collectionOf(l.J4.reference(),{IsLocalField:!0}),IsMathQuiz:l.J4.boolean({IsLocalField:!0}),IsPlainTextInMathField:l.J4.boolean({IsLocalField:!0}),IsAnswerPlainText:l.J4.boolean({IsLocalField:!0}),IsMathInputDefault:l.J4.boolean({IsLocalField:!0}),InputSwitcherDisabled:l.J4.boolean({IsLocalField:!0}),MathTemplateID:l.J4.number({IsLocalField:!0}),MathAriaLabels:l.J4.collectionOf(l.J4.string(),{IsLocalField:!0}),LastMathMLFormula:l.J4.string({IsLocalField:!0}),VideoInfo:l.J4.create({Url:l.J4.string(),Title:l.J4.string(),Author:l.J4.string(),Thumbnail_url:l.J4.string(),OriginalWidth:l.J4.number(),OriginalHeight:l.J4.number(),ShowWarningBar:l.J4.boolean()},{IsLocalField:!0}),TrackingId:l.J4.string({SourceFieldName:"trackingId"}),QuestionTagForIntelligence:l.J4.string({SourceFieldName:"questionTagForIntelligence"}),InsightsInfo:l.J4.string({SourceFieldName:"insightsInfo"}),IsFromSuggestion:l.J4.boolean({SourceFieldName:"isFromSuggestion"}),SuspiciousEvidence:l.J4.number({IsLocalField:!0}),CascadeLevel:l.J4.number({SourceFieldName:"cascadeLevel"}),CascadeFileName:l.J4.string({SourceFieldName:"cascadeFileName"}),CascadeChoiceGroup:l.J4.collectionOf(l.J4.reference(),{IsLocalField:!0})};!function(t){t[t.Number=0]="Number",t[t.Email=1]="Email",t[t.Custom=2]="Custom"}(y||(y={})),function(t){t[t.None=0]="None",t[t.Greater=1]="Greater",t[t.GreaterOrEqual=2]="GreaterOrEqual",t[t.Less=3]="Less",t[t.LessOrEqual=4]="LessOrEqual",t[t.Equal=5]="Equal",t[t.NotEqual=6]="NotEqual",t[t.Between=7]="Between",t[t.NotBetween=8]="NotBetween",t[t.Max=9]="Max"}(w||(w={})),function(t){t[t.SingleChoice=1]="SingleChoice",t[t.MultiChoice=2]="MultiChoice"}(S||(S={})),function(t){t[t.Number=0]="Number",t[t.Star=1]="Star",t[t.Smiley=2]="Smiley",t[t.CheckMark=3]="CheckMark",t[t.Flag=4]="Flag",t[t.Heart=5]="Heart",t[t.Lightbulb=6]="Lightbulb",t[t.Ribbon=7]="Ribbon",t[t.SmileFace=8]="SmileFace",t[t.ThumbLike=9]="ThumbLike",t[t.Trophy=10]="Trophy"}(N||(N={})),function(t){t[t.Success=0]="Success",t[t.RequiredError=1]="RequiredError",t[t.NumberValidationError=2]="NumberValidationError",t[t.QuizWrongChoiceError=3]="QuizWrongChoiceError",t[t.MathLengthError=4]="MathLengthError",t[t.MultiChoiceQuestionLengthLimitError=5]="MultiChoiceQuestionLengthLimitError",t[t.RegExValidationError=6]="RegExValidationError"}(C||(C={})),function(t){t[t.Dropdown=0]="Dropdown",t[t.ListAll=1]="ListAll"}(I||(I={})),function(t){t[t.Vertical=0]="Vertical",t[t.Horizontal=1]="Horizontal"}(T||(T={})),function(t){t[t.Editing=0]="Editing",t[t.Preview=1]="Preview"}(k||(k={}));B.Choices[0],B.ChoiceGroup[0];function H(t){return u.d.getObjectMasterFromModel(t)}var G=function(t){function n(e){var i=this,r=new a.wU;return e.InitialData?(n.resolveQuestionNullTypeIssue(e.InitialData),(e=o.clone(e)).InitialData=o.clone(e.InitialData),void 0!==e.InitialData.CombinedTitle?(0,_.S)(e.InitialData):(0,_.k)(e.InitialData)):(0,c._y)("Question model should created with initial data."),(i=t.call(this,e,{MasterReady:r.promise(),Scheduler:new g.b(n.name)})||this).fieldsReady([n.Schema.ChoiceGroup]).then((function(){u.d.Collection.setComparer(i.Model.ChoiceGroup,(function(t,n){return t.Order-n.Order}));var t=u.d.getCollectionMasterFromModel(i.Model.ChoiceGroup);(0,P.v)(t,t.Schema[0].SavingState,(function(t){var n=[i.Model.SavingState,t];i.Model.IntegratedSavingState=(0,P.IM)(n)}))})),i.Tn(e),(0,b.CU)(i,n.Schema.ImageInfo,n.Schema.ImageSettings),i.be(e),i.redressGradingBasis(),i.coAuthorTimers={},i.initializing=r,i}return(0,r.ZT)(n,t),Object.defineProperty(n.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ImageInfoMaster",{get:function(){return(0,p.rQ)(this.Model.ImageInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ImageSettingsMaster",{get:function(){return(0,b.Hi)(this.Model.ImageSettings)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ParentQuestionMaster",{get:function(){if(!this.isFieldReady(this.Schema.GroupId))return null;var t=this.Model.GroupId;return t&&this.Form.getQuestionById(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"SubQuestionMasters",{get:function(){var t=this;return this.Form.FormElementManager.QuestionMasters.filter((function(n){return n.Model.GroupId===t.Model.Id}))},enumerable:!1,configurable:!0}),n.prototype.isFieldReady=function(e){return e=n.getSourceFields([e])[0],t.prototype.isFieldReady.call(this,e)},n.prototype.ensureFieldsReady=function(e){return t.prototype.ensureFieldsReady.call(this,n.getSourceFields(e))},n.prototype.fieldsReady=function(e){return t.prototype.fieldsReady.call(this,n.getSourceFields(e))},n.prototype.hasValidVideoUrl=function(){return(0,d.Fp)()?this.Fn()&&(0,s.eC)(this.Model.VideoInfo.Url):this.Fn()&&(0,s.yk)(this.Model.VideoInfo.Url)},n.prototype.createSyncJob=function(t){var n=this,e=new a.wU,i=e.promise().then((function(){return n.Form.getQuestionSyncBlocker(i)})).then(t);return e.resolve(),i},n.prototype.createUploadSyncJob=function(t){var n=this,e=new a.wU,i=Promise.all([e,this.Pn]).then((function(){return n.createSyncJob(t)}));return e.resolve(),this.Pn=(0,a.Bx)(i),i},n.prototype.getMethodDelegator=function(){var t=this.Model.Type;this.ye=this.ye||(this.ye={});var n=this.ye[t];n||(n=new((0,f.getIoCQuestionDelegatorClass)(t))(this),this.ye[t]=n);return n},n.prototype.getChoiceById=function(t){var n=o.find(this.Model.ChoiceGroup,(function(n){return n.Id===t}));return n&&(0,D.k)(n)},n.prototype.getChoiceByKey=function(t){var n=o.find(this.Model.ChoiceGroup,(function(n){return n.Key===t}));return n&&(0,D.k)(n)},n.prototype.hasValidBranching=function(){var t=this.Model;return o.map(t.Choices,(function(t){return t.BranchInfo})).concat([t.BranchInfo,t.BranchInfoForOtherChoice]).map(u.d.getObjectMasterFromModel).some((function(t){return t.isValid()}))},n.prototype.Tn=function(t){this.Dn=new x.S(this,n.Schema.QuestionInfo,n.QuestionInfoFieldSet),t.InitialData&&this.isFieldReady(n.Schema.QuestionInfo)&&(t.ExistingInDataSource||t.InitialData.QuestionInfo?this.Dn.deserialize():this.Dn.serialize()),this.justifyQuestionInfo()},n.prototype.be=function(t){!t.ExistingInDataSource&&t.InitialData.FileUploadSPOInfo&&(this.Model.FileUploadSPOInfo=null)},n.prototype.hasRuntimeError=function(){var t=this.Model.FileUploadSPOInfo;return!!t&&!(!this.Form.SettingMaster.Model.IsAnonymous||!t.anonymousLinkInfo)},n.prototype.Fn=function(){return this.Model.VideoInfo&&this.Model.VideoInfo.Url},Object.defineProperty(n,"QuestionInfoFieldSet",{get:function(){return n.questionInfoFieldSet||(n.questionInfoFieldSet=new F.C([n.Schema.VideoInfo,n.Schema.ShowSubtitle,n.Schema.Hidden,n.Schema.BranchInfo,n.Schema.ShowRatingLabel,n.Schema.Point,n.Schema.FormsProCalculateSentiment,n.Schema.ImageSettings,n.Schema.GradingBasis,n.Schema.ChoiceType,n.Schema.Choices,n.Schema.Hint,n.Schema.AllowOtherAnswer,n.Schema.OptionDisplayStyle,n.Schema.ShuffleOptions,n.Schema.BranchInfoForOtherChoice,n.Schema.Length,n.Schema.RatingShape,n.Schema.LeftDescription,n.Schema.RightDescription,n.Schema.Multiline,n.Schema.IsNumber,n.Schema.NumberValidationRule,n.Schema.NumberMinBoundary,n.Schema.NumberMaxBoundary,n.Schema.Date,n.Schema.Time,n.Schema.IsMathQuiz,n.Schema.IsPlainTextInMathField,n.Schema.IsAnswerPlainText,n.Schema.InputSwitcherDisabled,n.Schema.IsMathInputDefault,n.Schema.MathTemplateID,n.Schema.MathAriaLabels,n.Schema.HasSpecificFileType,n.Schema.FileTypes,n.Schema.MaxFileCount,n.Schema.MaxFileSize,n.Schema.MinRating,n.Schema.FormsProChoiceLimits,n.Schema.FormsProIsFileUploaded,n.Schema.FormsProNumberOfRandomizationOptions,n.Schema.FormsProNumberOfSelections,n.Schema.FormsProOptionsLayout,n.Schema.FormsProOtherChoice,n.Schema.FormsProRandomizationType,n.Schema.FormsProRTLeftDescription,n.Schema.FormsProRTRightDescription,n.Schema.FormsProEnableAnswerTag,n.Schema.FormsProAnswerTag,n.Schema.FormsProAnswerTagHasError,n.Schema.HasTFRestrictionForPro,n.Schema.FormsProValidationType,n.Schema.FormsProCustomRegEx,n.Schema.FormsProCustomPlaceholder,n.Schema.FormsProSmileyList])),n.questionInfoFieldSet},enumerable:!1,configurable:!0}),n.resolveQuestionNullTypeIssue=function(t){if(!t.Type){var n={choiceType:t.ChoiceType,date:t.Date,time:t.Time,ratingShape:t.RatingShape,multiline:t.Multiline};t.Type=null!=n.choiceType?"Question.Choice":null!=n.date||null!=n.time?"Question.DateTime":n.ratingShape?"Question.Rating":"Question.TextField",(0,m.zU)("QuestionNullTypeError",{message:"question type resolved",conditions:n,resolvedType:t.Type})}},n.getSourceFields=function(t){return o.uniq(t.map((function(t){return n.QuestionInfoFieldSet.covers(t)?n.Schema.QuestionInfo:t})))},n}(u.d.createObjectMasterClass("QuestionMaster",B,(function(t,n){return new O(t,n)})));Object.keys({verify:null,isEmpty:null,getTypeDisplayName:null,getBranchedResult:null,isNumberType:null,resetBranchInfo:null,getNormalizedAnswer:null,hasAnswer:null,justifyNumberBoundaries:null,getNumberValidationErrorMessage:null,getValidationErrorMessage:null,supportsQuestionLevelBranching:null,supportsChoiceLevelBranching:null,getSnapshotWithoutBranchInfo:null,insertChoice:null,setAnswerKey:null,createQuizResult:null,autoGradeAnswer:null,autoGradeWithQuizResult:null,serializeAnswer:null,deserializeAnswer:null,justifyQuestionInfo:null,showAsDropdown:null,hasCorrectAnswers:null,isCorrectAnswer:null,redressGradingBasis:null}).forEach((function(t){G.prototype[t]=function(){var n=this.getMethodDelegator();return n[t].apply(n,arguments)}}))},36837:function(t,n,e){"use strict";e.d(n,{S:function(){return o},k:function(){return r}});var i=e(33447);function r(t){if(t.IsMathQuiz&&t.Subtitle){var n=t.Title||"";t.CombinedTitle=n+i.J+t.Subtitle}else t.CombinedTitle=t.Title}function o(t){var n=t.CombinedTitle;n&&(n=n.split(i.J)[0]),t.Title=n}},91367:function(t,n,e){"use strict";e.d(n,{E:function(){return a}});var i=e(12611),r=e(97265),o=e(31442),s=function(){return function(t,n,e){this.answer=t,this.id=n||(0,r.GW)(),this.isMath=e}}(),a=function(){function t(n){if(this.we=[],null!=n.GradingBasis)try{this.we=JSON.parse(n.GradingBasis)}catch(e){this.we=[],(0,o.zU)("ShortTextGradingBasisJsonParseFailure",{gradingBasisLength:n.GradingBasis.length,nonAsciiDetected:t.doesContainNonAsciiCharacters(n.GradingBasis)})}else this.we=[]}return t.prototype.serialize=function(){return JSON.stringify(this.we)},t.prototype.getAnswers=function(){return i.clone(this.we)},t.prototype.areAnyAnswersDefined=function(){return 0!==this.we.length},t.prototype.addAnswer=function(t,n){return!this.Se(t)&&(!this.Ne(t)&&(this.we.push(new s(t,void 0,n)),!0))},t.prototype.updateAnswer=function(t,n,e){if(this.Se(n))return!1;if(this.Ne(n,t))return!1;var i=this.Ce(t);if(i<0)return!1;var r=this.we[i];return this.we[i]=new s(n,r.id,e),!0},t.prototype.deleteAnswer=function(t){var n=this.Ce(t);n>=0&&this.we.splice(n,1)},t.prototype.isCorrect=function(t){return!this.Se(t)&&(t=(t+="").trim().toUpperCase(),null!=i.find(this.we,(function(n){return n.answer.trim().toUpperCase()===t})))},t.prototype.Ne=function(t,n){var e=(t+="").toUpperCase();return null!=i.find(this.we,(function(t){return t.answer.toUpperCase()===e&&t.id!==n}))},t.prototype.Se=function(t){return null==t||""===t},t.prototype.Ce=function(t){return i.findIndex(this.we,(function(n){return n.id===t}))},t.doesContainNonAsciiCharacters=function(t){for(var n=0;n<t.length;n++)if(t.charCodeAt(n)>127)return!0;return!1},t}()},82205:function(t,n,e){"use strict";e.d(n,{IM:function(){return a},v:function(){return s},vG:function(){return o}});var i=e(12611),r=e(26203);function o(t){var n=t.Synchronizer;n.observe((function(){return u(t)}),[n.Schema.CreationFailed,n.Schema.CreationInProcess,n.Schema.CreationScheduled,n.Schema.UpdateFailed,n.Schema.UpdateInProcess,n.Schema.UpdateScheduled]),u(t)}function s(t,n,e){var o=r.d.convertToArray(t.Model).map(r.d.getObjectMasterFromModel);function s(){var t=o.map((function(t){return t.getModelByFieldSchema(n)}));e(a(t))}s(),t.observe((function(t){t.AddedModels.length&&(o=o.concat(t.AddedModels.map(r.d.getObjectMasterFromModel))),t.RemovedModels.length&&t.RemovedModels.map(r.d.getObjectMasterFromModel).forEach((function(t){t.Synchronizer.deletedFromDataSource().then((function(){o=i.without(o,t),s()}))})),s()}),[n])}function a(t){return i.contains(t,"Saving")?"Saving":i.contains(t,"Scheduled")?"Scheduled":i.contains(t,"Failed")?"Failed":"Idle"}function u(t){var n=t.Synchronizer.Model;n.CreationInProcess||n.UpdateInProcess?t.Model.SavingState="Saving":n.CreationScheduled||n.UpdateScheduled?t.Model.SavingState="Scheduled":n.CreationFailed||n.UpdateFailed?t.Model.SavingState="Failed":t.Model.SavingState="Idle"}},83735:function(t,n,e){"use strict";e.d(n,{BT:function(){return c},OT:function(){return f},TS:function(){return h},b4:function(){return l}});var i,r=e(59312),o=e(13877),s=e(26203),a=e(39923),u={ExportToExcelCalloutVersion:a.J4.string(),NewFormTeachingCalloutVersion:a.J4.string(),SendTeachingCalloutVersion:a.J4.string(),ThemeSuggestCalloutVersion:a.J4.string(),WhatsNewVersion:a.J4.string(),PortalFormIntroduction:a.J4.string(),PortalFormsProIntroduction:a.J4.string(),OutlookQuickPollTeachingUI:a.J4.string(),FormsProSampleForm:a.J4.string(),FlowTeachingCallout:a.J4.string(),ExcelSurveyIntroduction:a.J4.string(),ToggleExpTeachingBubble:a.J4.string(),ProCardTeachingBubble:a.J4.string(),MSRewardsTeachingCoach:a.J4.string(),MSRewardsCommandBarTeachingCoach:a.J4.string(),IsNotFirstTimePhishingDetected:a.J4.boolean(),FormsProAvailableTeachingCallout:a.J4.string(),CustomerVoiceDesignerCallout:a.J4.string(),CustomerVoiceAdvancedRandomizationCallout:a.J4.string(),CalculateSentimentTeachingCallout:a.J4.string(),AddBranchingTeachingCalloutVersion:a.J4.string(),CustomerVoiceIntroductionDialog:a.J4.string(),EditScoreTeachingCoach:a.J4.string(),CustomerVoiceCustomHeaderCallout:a.J4.string(),ReportFilterTeachingBubble:a.J4.string()},c=2;function l(){return i||(i=new h)}function f(t){var n=parseInt(t);return isNaN(n)||n<c}var h=function(t){function n(){var e=t.call(this,{InitialData:n.getInitialData()})||this;return e.observe((function(t){return e.Ie(t.FieldSchemas)})),e}return(0,r.ZT)(n,t),n.getInitialData=function(){var t=(0,o.ns)(),e={};return Object.keys(n.Schema).forEach((function(n){return e[n]=t.getItem(n)})),e},n.prototype.Ie=function(t){var n=(0,o.ns)(),e=this.getSnapshot();t.map(s.d.getFieldSchemaInfo).map((function(t){return t.Name})).forEach((function(t){return n.setItem(t,e[t])}))},n}(s.d.createObjectMasterClass("UserProfileMaster",u))},69260:function(t,n,e){"use strict";e.d(n,{G4:function(){return r},Kw:function(){return o},zv:function(){return s}});var i=e(22810),r=function(){function t(t,n,e,i){this.Te=t,this.ke=n,this.xe=e,this.Fe=i}return Object.defineProperty(t.prototype,"Id",{get:function(){return this.Te},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"DisplayName",{get:function(){return this.ke},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"UserPrincipalName",{get:function(){return this.xe},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Mail",{get:function(){return this.Fe},enumerable:!1,configurable:!0}),t}();function o(t,n){return function(t,n){var e=a[n];if(!e){var o="User"===t?(0,i.PR)(n):(0,i.ex)(n);e=Promise.resolve(o).then((function(t){return new r(n,t.displayName,t.userPrincipalName,t.mail)})),a[n]=e}return e}(t,n)}function s(t){a[t.Id]||(a[t.Id]=Promise.resolve(t))}var a={}},90819:function(t,n,e){"use strict";e.d(n,{dL:function(){return r},Xf:function(){return x},nv:function(){return i},w9:function(){return k},rQ:function(){return I},bN:function(){return T},UO:function(){return C}});var i,r,o=e(59312),s=e(12611),a=e(37890),u=e(26203),c=e(39923),l=e(97265),f=e(41293),h=e(72467),d=e(61018),m=e(31442),v=e(73293),g=e(67661),p=e(53315),b=e(81380),y=function(){function t(t,n){this.Pe=t;var e,i=this.Pe.Parent;if(i instanceof g.x)e=i;else{if(!(i instanceof p.MF||i instanceof v.Jv))throw"Wrong parent type of ImageInfoMaster.";e=i.Form}var r=e.IsGroupForm?3:2;this.Ot=(0,b.lK)(e),this.De=d.VY.getInstance().createImageProvider(r,e.Model.OwnerTenantId,e.Model.OwnerId);var o=u.d.getFieldSchemaInfo(t.Membership.FieldSchema);this.Me=o.Attributes.SourceFieldName||o.Name}return t.prototype.add=function(t){return new Promise((function(t){window.setTimeout((function(){t(void 0)}))}))},t.prototype.delete=function(t){return(0,f._y)("not supported")},t.prototype.query=function(t){return(0,f._y)("not supported")},t.prototype.update=function(t){var n,e=t.uploadParameters;return e?(e.Delete?n=this.Le():e.ImageFile?n=this.Ae(e.ImageFile):e.Url&&(n=this.Oe(e.Url,e.Size)),n?n.then((function(t){var n=s.clone(t);return n.uploadParameters=null,n})):void 0):this._e()},t.prototype._e=function(){var t=this,n=u.d.convertToSourceData(this.Pe.getSnapshot(),(0,h.Cu)().Schema);delete n.uploadParameters;var e,i={};i[this.Me]=n;var r=this.Pe.Parent;if(r instanceof g.x)e=this.Ot.updateForm(r.Model.Id,i);else{if(!(r instanceof p.MF||r instanceof v.Jv))return(0,f._y)("not supported");var o=r;e=o.createUploadSyncJob((function(){return t.Ot.updateFormQuestion(o.Form.Model.Id,o.Model.Id,o.Model.Type,i)}))}return e.then((function(n){return n&&n[t.Me]}))},t.prototype.Oe=function(t,n){var e=this,i={SourceUrl:t,Title:(0,l.GW)(),Size:n},r=this.Pe.Parent;if(r instanceof g.x)return this.Ot.createFormImageFromUrl(r.Model.Id,this.Me,i);if(r instanceof p.MF||r instanceof v.Jv){var o=r;return o.createUploadSyncJob((function(){return e.Ot.createQuestionImageFromUrl(o.Form.Model.Id,o.Model.Id,i)}))}return(0,f._y)("not supported")},t.prototype.Ae=function(t){var n=this,e={ImageBlob:t,ImageName:(0,l.GW)(),ImageType:t.type},i=this.Pe.Parent;if(i instanceof g.x)return this.De.uploadFormImage(i.Model.Id,this.Me,e);if(i instanceof p.MF||i instanceof v.Jv){var r=i;return r.createUploadSyncJob((function(){return n.De.uploadQuestionImage(r.Form.Model.Id,r.Model.Id,n.Me,e)}))}return(0,f._y)("not supported")},t.prototype.Le=function(){var t,n=this,e=this.Pe.Parent;if(e instanceof g.x)(0,m.$U)("DesignPage.FormImage.Delete"),t=this.De.deleteFormImage(e.Model.Id,this.Me);else{if(!(e instanceof p.MF||e instanceof v.Jv))return(0,f._y)("not supported");var i=e;(0,m.$U)("DesignPage.QuestionImage.Delete"),t=i.createUploadSyncJob((function(){return n.De.deleteQuestionImage(i.Form.Model.Id,i.Model.Id,n.Me)}))}return t.then(null,(function(t){if(t&&805===t.innerCode)return(0,m.zU)("DeleteImageNotFoundError",{imageUrl:n.Pe.Model.ResourceUrl}),Promise.resolve();throw t})).then((function(){return{altText:null,contentType:null,fileIdentifier:null,height:null,imageFile:null,originalFileName:null,resourceId:null,resourceUrl:null,size:null,width:null}}))},t}(),w=e(94956),S=e(82205),N={AltText:c.J4.string({SourceFieldName:"altText"}),ContentType:c.J4.string({SourceFieldName:"contentType"}),FileIdentifier:c.J4.string({SourceFieldName:"fileIdentifier"}),OriginalFileName:c.J4.string({SourceFieldName:"originalFileName"}),ResourceId:c.J4.string({SourceFieldName:"resourceId"}),ResourceUrl:c.J4.string({SourceFieldName:"resourceUrl"}),Width:c.J4.number({SourceFieldName:"width"}),Height:c.J4.number({SourceFieldName:"height"}),UploadParameters:c.J4.reference({SourceFieldName:"uploadParameters"}),ErrorType:c.J4.enumeration((function(){return r}),{IsLocalField:!0}),ResponseError:c.J4.reference({IsLocalField:!0}),ImageProcessingStatus:c.J4.enumeration((function(){return i}),{IsLocalField:!0}),IsPredefined:c.J4.boolean({IsLocalField:!0}),SavingState:c.J4.reference({IsLocalField:!0})};function C(t){if(!t)return!1;if(t.ResourceUrl)return!0;var n=t.UploadParameters;return!!n&&!!n.ImageFile}function I(t){return u.d.getObjectMasterFromModel(t)}function T(t,n,e,i){if(t>e||n>i){var r=Math.min(i/n,e/t);t*=r,n*=r}return{width:t,height:n}}function k(){return{UploadParameters:null,ErrorType:r.NoError,ResponseError:null,ImageProcessingStatus:i.Idle,Width:null,Height:null}}!function(t){t[t.Idle=0]="Idle",t[t.Picking=1]="Picking",t[t.Uploading=2]="Uploading",t[t.Deleting=3]="Deleting"}(i||(i={})),function(t){t[t.NoError=0]="NoError",t[t.SizeTooLarge=1]="SizeTooLarge",t[t.InvalidType=2]="InvalidType",t[t.BrokenImage=3]="BrokenImage",t[t.ServerError=4]="ServerError",t[t.DeleteFailError=5]="DeleteFailError"}(r||(r={}));var x=function(t){function n(e){var o=this,u=new a.wU,c=!e.ExistingInDataSource&&e.InitialData&&!!e.InitialData.ResourceUrl,l=s.clone(e.InitialData);(e=s.clone(e)).InitialData=c?s.extend({},l,{ImageProcessingStatus:i.Uploading}):s.extend({},l,k());var f=new w.b(n.name);f.setMaxRetryTimesForUpdate(0);var h=(o=t.call(this,e,{Scheduler:f,MasterReady:u.promise()})||this).Synchronizer;return h.observe((function(t){var n;s.contains(t.FieldSchemas,h.Schema.CreationError)?n=h.Model.CreationError:s.contains(t.FieldSchemas,h.Schema.UpdateError)&&(n=h.Model.UpdateError),n&&o.bulkEdit((function(){o.Model.ResponseError=n;var t=o.Model.UploadParameters;t&&t.Delete?o.Model.ErrorType=r.DeleteFailError:o.Model.ErrorType=r.ServerError}))}),[h.Schema.CreationError,h.Schema.UpdateError]),o.addRule({InterestedFields:[o.Schema.ResourceId],Name:"ResetErrorStatus",onChange:function(t){!t.BeingDeleted&&o.Model.ResourceId&&o.resetStatus(i.Idle)}}),o.initializing=u,o.duplicatingImage=c,o.originalInitialData=l,(0,S.vG)(o),o}return(0,o.ZT)(n,t),n.prototype.getSettingsMaster=function(){return this.He},n.prototype.setSettingsMaster=function(t){this.He=t},n.prototype.resetStatus=function(t){var n=this.Model;this.bulkEdit((function(){n.ErrorType=r.NoError,n.ResponseError=void 0,n.ImageProcessingStatus=t}))},n}(u.d.createObjectMasterClass("ImageInfoMaster",N,(function(t,n){return new y(t,n)})))},3920:function(t,n,e){"use strict";e.d(n,{CU:function(){return v},Hi:function(){return m},RZ:function(){return i},Vj:function(){return g},h2:function(){return r}});var i,r,o=e(59312),s=e(12611),a=e(9947),u=e(26203),c=e(39923),l=e(687),f=e(67661),h=e(90819),d={Layout:c.J4.enumeration((function(){return i})),Size:c.J4.enumeration((function(){return r})),NaturalWidth:c.J4.number(),NaturalHeight:c.J4.number(),ContainerWidth:c.J4.number(),ContainerHeight:c.J4.number(),ActualWidth:c.J4.number(),ActualHeight:c.J4.number(),Left:c.J4.number(),Top:c.J4.number()};function m(t){return u.d.getObjectMasterFromModel(t)}function v(t,n,e){t.fieldsReady([n]).then((function(){var i=t.getModelByFieldSchema(n),r=(0,h.rQ)(i);t.ensureFieldsReady([e]).then((function(){var n=m(t.getModelByFieldSchema(e));r.setSettingsMaster(n)}))}))}!function(t){t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical",t[t.Square=3]="Square"}(i||(i={})),function(t){t[t.Small=1]="Small",t[t.Large=2]="Large"}(r||(r={}));var g=function(t){function n(n){var e=t.call(this,n)||this;return n.MasterTreeReady&&n.MasterTreeReady.then((function(){var t=e.Parent;t instanceof f.x&&t.fieldsReady([f.x.Schema.LogoInfo]).then((function(){t.Model.LogoInfo===e.Model&&(e.Ge=!0)}))})),e}return(0,o.ZT)(n,t),Object.defineProperty(n.prototype,"IsFormLogo",{get:function(){return this.Ge},enumerable:!1,configurable:!0}),n.prototype.validateImageSettings=function(t){var n=s.clone(this.getSnapshot());if(744===n.ContainerWidth&&(n.ContainerHeight=n.ContainerHeight*(0,l.Fy)()/n.ContainerWidth,n.ContainerWidth=(0,l.Fy)(),!t)){var e=this.Model;e.ContainerWidth=n.ContainerWidth,e.ContainerHeight=n.ContainerHeight}if(null==n.ContainerHeight||null==n.ContainerWidth||null==n.ActualHeight||null==n.ActualWidth||null==n.Top){var i=this.getDefaultImageSettings();for(var r in i)n[r]=Math.round(i[r]),t||(this.Model[r]=n[r])}return n},n.prototype.calcLogoLayout=function(t){var n,e,r,o=(this.Model.NaturalWidth||(0,l.vM)())/(this.Model.NaturalHeight||(0,l.HJ)()),s=(t=t||{}).isSmallSize,a=t.isMobile,u=t.isSlimSize;if(a)(e=(n=u?30:s?70:80)*o)>n?(e=(n=u?40:n)*o,r=i.Vertical):r=i.Horizontal;else{var c=void 0;s?(n=70,c=125):u?(n=40,c=95):(n=120,c=215),(e=n*o)>c?(e=(n=u?30:s?40:70)*o,r=i.Vertical):r=i.Horizontal}return{ActualWidth:e=Math.min(e,750),ActualHeight:n,Layout:r}},n.prototype.getDefaultImageSettings=function(){var t,n=this.Model;n.NaturalHeight&&n.NaturalWidth?t={NaturalHeight:n.NaturalHeight,NaturalWidth:n.NaturalWidth}:t={NaturalHeight:n.NaturalHeight||(0,l.HJ)(),NaturalWidth:n.NaturalWidth||(0,l.vM)()};if(!(0,a.k0)().userInfo.IsMsa&&this.IsFormLogo)return t;var e=this.Ve();if(null==e.Height?(t.ContainerWidth=e.Width,t.ContainerHeight=e.Width*t.NaturalHeight/t.NaturalWidth):null==e.Width?(t.ContainerWidth=e.Height*t.NaturalWidth/t.NaturalHeight,t.ContainerHeight=e.Height):(t.ContainerWidth=e.Width,t.ContainerHeight=e.Height),null==e.Height||null==e.Width)t.Left=0,t.Top=0,t.ActualWidth=t.ContainerWidth,t.ActualHeight=t.ContainerHeight;else{var i=Math.max(t.ContainerWidth/t.NaturalWidth,t.ContainerHeight/t.NaturalHeight);t.ActualWidth=i*t.NaturalWidth,t.ActualHeight=i*t.NaturalHeight,t.Left=(t.ContainerWidth-t.ActualWidth)/2,t.Top=(t.ContainerHeight-t.ActualHeight)/2}return t},n.prototype.Ve=function(){var t=this.Model;if(null==t.Size||t.Size===r.Small)switch(t.Layout){case i.Square:return{Width:314,Height:314};case i.Vertical:return{Height:314};case i.Horizontal:default:return{Width:314}}else switch(t.Layout){case i.Square:return{Width:414,Height:414};case i.Vertical:return{Height:414};case i.Horizontal:default:return{Width:(0,l.Fy)()}}},n}(u.d.createObjectMasterClass("ImageSettingsMaster",d))},38537:function(t,n,e){"use strict";e.d(n,{H:function(){return a}});var i,r=e(86353),o=e(94283),s=e(31442);function a(t,n){void 0===n&&(n=["None"]),(null==t?void 0:t.length)>0&&(null==n?void 0:n.length)>0&&t.forEach((function(t){t.experiments=function(){var t;if(!i){var n=(0,r.Tl)();i={IntelligenceExp1:null===(t=null==n?void 0:n.IntelligenceExp1)||void 0===t?void 0:t.replace(/"/g,"")}}return i}(),t.eventTime=(new Date).toUTCString(),function(t){var n={action:t.action,actionTarget:t.actionTarget,contextType:t.contextType,userType:t.userType,requestId:t.requestId,experiments:t.experiments,loggingContent:t.loggingContent,itemId:t.id},e={action:t.action,actionTarget:t.actionTarget,contextType:t.contextType,userType:t.userType,suggestionId:t.suggestionId,experiments:t.experiments,loggingContent:t.loggingContent,suggestionContent:t.suggestionContent,itemId:u(t.id)};(0,s.yY)("Intelligence.Suggestions.Feedback",n),(0,s.f)("IntelligenceStatistic.Suggestions.Feedback",e),(0,o.Zz)(3,{$extraData:n})}(t)}))}function u(t){var n=0;if(t&&t.length>0)for(var e=0;e<t.length;e++){n=(n<<5)-n+t.charCodeAt(e),n|=0}return n}},62715:function(t,n,e){"use strict";e.d(n,{z:function(){return y}});var i=e(59312),r=e(12611),o=e(86353),s=e(97265),a=e(72377),u=e(26203),c=e(39923),l=e(7645),f=e(37076),h=e(66557),d=e(68246),m=e(38537),v=e(69094),g={SuggestionId:c.J4.string(),UserBasedSuggestionId:c.J4.string(),IsReady:c.J4.boolean(),IsLoading:c.J4.boolean()};var p=function(t){function n(n){var e,i=this;(i=t.call(this,{InitialData:{SuggestionId:"None",UserBasedSuggestionId:"None",IsReady:!1,IsLoading:!1}})||this).ze=1e3,i.Qe=.6,i.Ue=6,i.$e=!1,i.We=[],i.Je=n,i.Ze=[],i.Xe=[],i.Ye=[],i.ti=[],i.ni=[];var r=(0,o.Tl)();return i.Ht={IntelligenceExp1:null===(e=null==r?void 0:r.IntelligenceExp1)||void 0===e?void 0:e.replace(/"/g,"")},i.ei=i.ei.bind(i),i.ii=i.ii.bind(i),i}return(0,i.ZT)(n,t),n.prototype.registerObservers=function(){this.Je&&this.Je.observe(this.ii,[this.Je.Schema.Title,this.Je.Schema.Theme,this.Je.Schema.Questions])},n.prototype.unregisterObservers=function(){this.Je&&this.Je.unobserve(this.ii)},n.prototype.registerTargetElement=function(t){t&&(-1===r.findIndex(this.Xe,(function(n){var e,i;return"string"==typeof n?n===t:(null===(e=n.Model)||void 0===e?void 0:e.Id)===(null===(i=t.Model)||void 0===i?void 0:i.Id)}))&&this.Xe.push(t))},n.prototype.unregisterTargetElement=function(t){if(t){var n=r.findIndex(this.Xe,(function(n){var e,i;return"string"==typeof n?n===t:(null===(e=n.Model)||void 0===e?void 0:e.Id)===(null===(i=t.Model)||void 0===i?void 0:i.Id)}));n>-1&&this.Xe.splice(n,1)}},Object.defineProperty(n.prototype,"RemainingQuestionSuggestions",{get:function(){return this.ni},set:function(t){this.ni=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"MaxSuggestionCount",{get:function(){return this.Ue},set:function(t){this.Ue=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"SubQuestionCollection",{get:function(){return this.ri},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Suggestions",{get:function(){return this.Ze},set:function(t){this.Ze=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"DesignIntelligenceVariation",{get:function(){return this.We},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"TopSuggestion",{get:function(){var t=this;if(this.Ze.length>0){var n=this.Ze.filter((function(n){return n.Confidence>t.Qe&&t.Ye.indexOf(n.Feature)<0}));return r.sortBy(n,(function(t){return t.Confidence})).reverse()[0]}return null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ShouldExpandQuestionSuggestionCard",{get:function(){return this.$e},set:function(t){this.$e=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Experiments",{get:function(){return this.Ht},enumerable:!1,configurable:!0}),n.prototype.getSuggestion=function(t){var n=this.Ze.filter((function(n){return n.Feature===t}));return n.length>0?n[0]:null},n.prototype.AddCurrentSuggestion=function(t){this.ti.indexOf(t)<0&&this.ti.push(t),this.RemoveDismissedSuggestion(t)},n.prototype.RemoveCurrentSuggestion=function(t){var n=this.ti.indexOf(t);n>-1&&(this.ti.splice(n,1),this.Model.SuggestionId=(0,s.GW)())},n.prototype.AddDismissedSuggestion=function(t){this.Ye.indexOf(t)<0&&this.Ye.push(t),this.RemoveCurrentSuggestion(t)},n.prototype.RemoveDismissedSuggestion=function(t){var n=this.Ye.indexOf(t);n>-1&&this.Ye.splice(n,1)},n.prototype.ShouldPopUpSuggestion=function(t){var n,e,i,r=0===this.ti.length;return this.ti.indexOf(t)>-1||!(this.Ye.indexOf(t)>-1)&&(!!r&&("TitleSuggestsQuestion"===t?"TitleSuggestsQuestion"===(null===(n=this.TopSuggestion)||void 0===n?void 0:n.Feature)||"HistoryFormSuggestion"===(null===(e=this.TopSuggestion)||void 0===e?void 0:e.Feature):(null===(i=this.TopSuggestion)||void 0===i?void 0:i.Feature)===t))},n.prototype.ii=function(){this.oi&&window.clearTimeout(this.oi),this.oi=window.setTimeout(this.ei,this.ze)},n.prototype.ei=function(){var t=this;this.Je&&this.Je.ensureFieldsReady([this.Je.Schema.Id]).then((function(){if(t.si()){var n=t.Je.Model,e=u.d.convertToArray(t.Je.Model.Questions).map((function(n){var e=r.findIndex(t.Xe,(function(t){var e;return"string"!=typeof t&&(null===(e=t.Model)||void 0===e?void 0:e.Id)===n.Id}));return{Options:u.d.convertToArray(n.Choices).map((function(t){return t.Description})),QuestionTagForIntelligence:n.QuestionTagForIntelligence,QuestionType:n.Type,Title:n.Title,IsTarget:e>-1}})),i={Id:n.Id,Questions:e,Title:n.Title};t.ai=t.ui(),t.Model.IsLoading=!0;var o=a.Pv.Resolve("ITemplateQuestions");Promise.all([o,(0,v.c4)(),(0,h.Ng)()]).then((function(n){var e=n[0],r=n[1],o=n[2],s=e.Item_1;t.ri=e.Item_2;var a={ContextInfo:{ContextType:"Form",UserType:o},Data:i,Feature:"TitleSuggestsQuestion",Experiments:t.Ht};t.IntelligenceProvider.askSuggetions(a).then((function(n){var e=n.Suggestion.filter((function(t){return"TitleSuggestsQuestion"===t.Feature}));e.length>0&&(e[0].Suggestion=e[0].Suggestion.map((function(t){return s[t]?s[t]:null})).filter((function(t){return null!==t})));var i=n.Suggestion.filter((function(t){return"TitleSuggestsTheme"===t.Feature}));i.length>0&&(i[0].Suggestion=(0,v.K2)(i[0].Suggestion,r)),t.bulkEdit((function(){t.We=n.Variations,t.Ze=n.Suggestion,t.Model.SuggestionId=n.SuggestionId,t.Model.UserBasedSuggestionId=n.UserBasedSuggestionId,t.Model.IsReady=!0,t.Model.IsLoading=!1,t.$e=!1,t.oi=null})),t.ci(n.ExtraData)})).catch((function(){t.bulkEdit((function(){t.Model.IsReady=!0,t.Model.IsLoading=!1,t.$e=!1,t.oi=null}))}))}))}else t.$e=!1}))},n.prototype.si=function(){return this.ai!==this.ui()&&!this.li()},n.prototype.li=function(){var t=this.Je.Model.Title;return!t||t.indexOf((0,l.pm)().Designer_DefaultFormTitle)>=0||t.indexOf((0,l.pm)().Designer_DefaultQuizTitle)>=0},n.prototype.ui=function(){var t,n=this.Je.Model.Title.length,e=u.d.convertToArray(this.Je.Model.Questions),i=r.reduce(e,(function(t,n){return t.QuestionCount++,t.OptionCount+=n.Choices.length,t}),{QuestionCount:0,TitleLength:0,OptionCount:0}),o=null===(t=this.Je.Model.Theme)||void 0===t?void 0:t.Name;return"".concat(n,"_").concat(i.QuestionCount,"_").concat(i.TitleLength,"_").concat(i.OptionCount,"_").concat(o)},Object.defineProperty(n.prototype,"IntelligenceProvider",{get:function(){if(!this.di){var t=(0,f.kc)(this.Je.Model.Id),n=t.IsGroupOwner?3:2;this.di=d.A.createIntelligenceProvider(n,t.OrgId,t.OwnerId)}return this.di},enumerable:!1,configurable:!0}),n.prototype.ci=function(t){var n=this.getSuggestion("TitleSuggestsQuestion"),e=!!n&&!!n.Suggestion&&n.Suggestion.length>0,i=this.getSuggestion("TitleSuggestsTheme"),r=!!i&&!!i.Suggestion&&i.Suggestion.length>0,o={action:"Addressable",actionTarget:"Suggestions",contextType:"Form",id:this.Je.Model.Id,requestId:this.Model.UserBasedSuggestionId,suggestionId:this.Model.SuggestionId,loggingContent:{hasHistorySuggestion:!!this.getSuggestion("HistoryFormSuggestion"),hasQuestionSuggestion:e,hasThemeSuggestion:r,hasEstimatedTimeSuggestion:!!this.getSuggestion("PredictResponseTime"),extraData:t}};(0,m.H)([o])},n}(u.d.createObjectMasterClass("IntelligenceSuggestions",g)),b={};function y(t){if(!t)return null;var n=t.getInstanceId(),e=b[n];return e||(e=b[n]=new p(t)),e}},69094:function(t,n,e){"use strict";e.d(n,{K2:function(){return h},c4:function(){return c},qX:function(){return f}});var i,r=e(12611),o=e(9947),s=e(26203),a=e(41317),u=e(22884);function c(){return i||(i=(0,a.Rt)().then((function(t){var n={};for(var e in t)l(t[e])&&(n[e]=t[e]);return n}))),i}function l(t){return t.BackgroundImage&&-1!==t.BackgroundImage.indexOf("formsresources")?(0,o.k0)().isCdnEnabled:t.Name&&-1!==t.Name.indexOf("Suggest")}function f(t){var n,e=(0,u.F)(t);return e&&e.Model?(n=s.d.convertToArray(e.Model.suggestions),c().then((function(t){return h(n,t)})).catch((function(t){return[]}))):Promise.resolve([])}function h(t,n){if(!n||!t||0===t.length)return[];for(var e=[],i=[],o=0,s=t;o<s.length;o++){var u=s[o];for(var c in n)if(n[c].Tag){if(e.length>=10)break;var l=(0,a.nk)(n[c]);l.Tag.High.indexOf(u)>=0?e.push(l):l.Tag.General.indexOf(u)>=0&&i.push(l)}}for(var f=e.length,h=0;h<i.length&&!(f>=10);f++,h++)e.push(i[h]);return r.unique(e,(function(t){return t.Name}))}},22884:function(t,n,e){"use strict";e.d(n,{F:function(){return c},n:function(){return a}});var i=e(59312),r=e(26203),o=e(39923),s={suggestions:o.J4.collectionOf(o.J4.string({IsLocalField:!0}))},a=function(t){function n(n){var e=t.call(this)||this;return e.mi=n,e}return(0,i.ZT)(n,t),Object.defineProperty(n.prototype,"SuggestId",{get:function(){return this.mi},enumerable:!1,configurable:!0}),n}(r.d.createObjectMasterClass("ThemeSuggestion",s)),u={};function c(t){if(!t)return null;var n=u[t];return n||(n=u[t]=new a(t)),n}},3864:function(t,n,e){"use strict";e.d(n,{qU:function(){return h},CI:function(){return d},XA:function(){return v},r:function(){return l},bh:function(){return f},Yb:function(){return m}});var i=e(79552),r=e(7645);var o,s,a=e(22617),u=e(72467),c=e(31442);function l(t,n){void 0===n&&(n="Error"),(0,u.f5)().bulkEdit((function(e){e.ErrorBarMessage=t,e.ErrorLevel=n}))}function f(t,n,e){(0,c.$U)((0,i.xP)(n)?"Error.ErrorMessageBar.Show.Expected":"Error.ErrorMessageBar.Show.Unexpected",{Error:JSON.stringify(n),Key:e,Scenario:t},n&&n.correlationId),o=t,s=e,(0,r.ay)().then((function(){return l((t=n.innerCode,t&&(0,a.D)("".concat(t))||(o?function(t,n){var e=null!=n?n:(0,r.pm)();switch(t){case"CreateQuestion":return e.Error_Bar_Message_CreateQuestion;case"DeleteForm":return e.Error_Bar_Message_DeleteForm;case"DeleteQuestion":return e.Error_Bar_Message_DeleteQuestion;case"ExportResponsesToExcel":return e.Error_Bar_Message_ExportResponsesToExcel;case"RefreshResponses":return e.Error_Bar_Message_RefreshResponses;case"SaveForm":return e.Error_Bar_Message_SaveForm;case"SaveQuestion":return e.Error_Bar_Message_SaveQuestion;case"SyncError_DeleteForm":return e.Error_Bar_Message_SyncError_DeleteForm;case"SyncError_DeleteQuestion":return e.Error_Bar_Message_SyncError_DeleteQuestion;case"SyncError_DeleteSection":return e.Error_Bar_Message_SyncError_DeleteSection;case"SyncError_PatchForm":return e.Error_Bar_Message_SyncError_PatchForm;case"SyncError_PatchQuestion":return e.Error_Bar_Message_SyncError_PatchQuestion;case"SyncError_PatchSection":return e.Error_Bar_Message_SyncError_PatchSection;case"SyncError_PostQuestion":return e.Error_Bar_Message_SyncError_PostQuestion;case"SyncError_PostSection":return e.Error_Bar_Message_SyncError_PostSection;default:return""}}(o):null)));var t}))}function h(t,n){t===o&&n===s&&((0,c.$U)("Error.ErrorMessageBar.Hide",{Key:n,Scenario:t}),o=void 0,s=void 0,l(null))}function d(t){t&&t.Synchronizer.Model.CreationFailed&&!(0,u.f5)().Model.CriticalError&&(0,u.f5)().Model.ErrorBarMessage&&h("SaveForm",t.getInstanceId())}function m(t){(0,u.f5)().Model.InfoBarMessageType=t}function v(){(0,u.f5)().Model.InfoBarMessageType=void 0}},502:function(t,n,e){"use strict";e.d(n,{k:function(){return v}});var i=e(59312),r=e(12611),o=e(26203),s=e(39923),a=e(94956),u=e(54438),c=e(81380),l=e(9743),f=e(91091),h=function(){function t(t){this.Ln=t,this.Ot=(0,c.lK)(this.Ln.Form)}return t.prototype.add=function(t){var n=this;if(this.Ln.Form.SyncContext!==l.y.DesignTimeForm)return Promise.resolve();var e=this.Ln.Form;return e?e.Synchronizer.existingInDataSource().then((function(){var t=n.Ln.Model.localeId,i=o.d.Collection.getItemWithKeyFields(e.Model.LocaleList,{localeId:t});return o.d.getObjectMasterFromModel(i).Synchronizer.existingInDataSource()})).then((function(){var e,i=[];for(e in t)if(t.hasOwnProperty(e)){var o=(0,f.Lk)(r.pick(t,[e]));null!==o.elementKey&&"localename"!==o.elementKey&&(o.locale=n.Ln.Model.localeId,o.questionId="",i.push((0,u.m)(o,n.Ln.FormId)))}return Promise.all(i).then((function(t){}))})):Promise.reject()},t.prototype.delete=function(t){throw Error("No scenario to call this method currently.")},t.prototype.query=function(t){throw Error("No scenario to call this method currently.")},t.prototype.update=function(t,n){if(!n.ValuesBefore||this.Ln.Form.SyncContext!==l.y.DesignTimeForm)return Promise.resolve();var e,i=[];for(e in t)if(t.hasOwnProperty(e)){var o=null!==n.ValuesBefore[e],s=(0,f.Lk)(r.pick(t,[e]));s.locale=this.Ln.Model.localeId,s.questionId="",i.push(o?this.Ot.updateLocaleItem(this.Ln.FormId,s):this.Ot.createLocaleItem(this.Ln.FormId,s))}return Promise.all(i).then((function(){}))},t}(),d=e(155),m={conditionalThankyouMessage:s.J4.string(),footerText:s.J4.string(),formCloseMessage:s.J4.string(),formsprortlocalesubtitle:s.J4.string(),formsprortlocaletitle:s.J4.string(),localeId:s.J4.string({IsKeyField:!0}),localeName:s.J4.string(),questionResources:s.J4.collectionOf((function(){return d.A})),subtitle:s.J4.string(),thankYouMessage:s.J4.string(),title:s.J4.string()},v=function(t){function n(e){return t.call(this,e,{Scheduler:new a.b(n.name)})||this}return(0,i.ZT)(n,t),Object.defineProperty(n.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"LocaleId",{get:function(){return this.Model.localeId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"LocaleName",{get:function(){return this.Model.localeName},enumerable:!1,configurable:!0}),n.getFormResourceMaster=function(t,n){var e=r.find(n.Model.LocalizedResources,(function(n){return n.localeId===t}));if(e)return o.d.getObjectMasterFromModel(e);throw Error("This locale does not exist in form.")},n.getQuestionResourceMaster=function(t,n,e){var i=e.Model.LocalizedResources,r=o.d.Collection.getItemWithKeyFields(i,{localeId:t});if(r){if(r.questionResources||(r.questionResources=[]),r.questionResources.length>0){var s=o.d.Collection.getItemWithKeyFields(r.questionResources,{localeId:t,questionId:n});if(s)return o.d.getObjectMasterFromModel(s)}return(0,f._T)({localeId:t,localeName:r.localeName},n,r,e)}throw Error("This locale does not exist in form.")},n}(o.d.createObjectMasterClass("FormLocalizedItemMaster",m,(function(t){return new h(t)})))},91091:function(t,n,e){"use strict";e.d(n,{Lk:function(){return u},Mn:function(){return m},_T:function(){return h},an:function(){return l},e0:function(){return c},fK:function(){return p},fp:function(){return d},n$:function(){return s},tc:function(){return f}});var i=e(12611),r=e(26203),o=e(31442);function s(t){return{localizedResources:a(t)}}function a(t){var n=function(t){var n=t.filter((function(t){return""===t.questionId})),e=i.groupBy(n,(function(t){return t.locale}));return i.map(e,(function(t){var n={conditionalThankyouMessage:null,footerText:null,formCloseMessage:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,localeId:null,localeName:null,questionResources:[],subtitle:null,thankYouMessage:null,title:null};return t.forEach((function(t){!function(t,n){switch(t.elementKey){case"thankyoumessage":n.thankYouMessage=t.elementValue;break;case"formclosemessage":n.formCloseMessage=t.elementValue;break;case"footertext":n.footerText=t.elementValue;break;case"conditionalthankyoumessage":n.conditionalThankyouMessage=t.elementValue;break;default:v(t,n)}}(t,n)})),n}))}(t),e=function(t){var n=t.filter((function(t){return t.questionId})),e=i.groupBy(n,(function(t){return t.locale})),r={},o=i.map(e,(function(t,n){var e=i.groupBy(t,(function(t){return t.questionId})),r=i.map(e,(function(t,e){var r={choices:[],choicesV1:[],formsprortlocaleldescription:null,formsprortlocalerdescription:null,formsprocustomplaceholder:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,leftDescription:null,localeId:n,localeName:null,option:null,questionId:e,rightDescription:null,subtitle:null,title:null,cascadeChoices:null},o=t.filter((function(t){return t.elementKey&&(t.elementKey.startsWith("choiceid_")||t.elementKey.startsWith("choicekey_"))}));if(o&&o.length>0){var s=i.map(o,(function(t){var n={choiceId:null,description:null,key:null};return function(t,n){var e=t.elementKey;e&&e.startsWith("choiceid_")&&(n.choiceId=e.split("_")[1]);e&&e.startsWith("choicekey_")&&(n.key=e.split("_")[1]);n.description=t.elementValue}(t,n),n}));r.choices=s}var a=t.filter((function(t){return t.elementKey&&!(t.elementKey.startsWith("choiceid_")||t.elementKey.startsWith("choicekey_"))}));return a&&a.forEach((function(t){!function(t,n){switch(n.questionId=t.questionId,t.elementKey){case"leftdescription":n.leftDescription=t.elementValue;break;case"rightdescription":n.rightDescription=t.elementValue;break;case"option":n.option=t.elementValue;break;case"formsprortlocaleldescription":n.formsprortlocaleldescription=t.elementValue;break;case"formsprortlocalerdescription":n.formsprortlocalerdescription=t.elementValue;break;case"formsprocustomplaceholder":n.formsprocustomplaceholder=t.elementValue;break;default:v(t,n)}}(t,r)})),r}));return r}));return o.forEach((function(t){var n=t.length>0&&t[0].localeId;n&&(r[n]=t)})),r}(t);return n.forEach((function(t){if(t.localeId){var n=e[t.localeId];n&&(t.questionResources=n)}})),n}function u(t){var n=g(t);return null!=t.formCloseMessage?(n.elementKey="formclosemessage",n.elementValue=t.formCloseMessage):null!=t.thankYouMessage?(n.elementKey="thankyoumessage",n.elementValue=t.thankYouMessage):null!=t.footerText?(n.elementKey="footertext",n.elementValue=t.footerText):null!=t.conditionalThankyouMessage&&(n.elementKey="conditionalthankyoumessage",n.elementValue=t.conditionalThankyouMessage),n}function c(t){var n=g(t);return null!=t.leftDescription?(n.elementKey="leftdescription",n.elementValue=t.leftDescription):null!=t.rightDescription?(n.elementKey="rightdescription",n.elementValue=t.rightDescription):null!=t.option&&'{"choicesV1":[]}'!==t.option?(n.elementKey="option",n.elementValue=t.option):null!=t.formsprortlocaleldescription?(n.elementKey="formsprortlocaleldescription",n.elementValue=t.formsprortlocaleldescription):null!=t.formsprortlocalerdescription?(n.elementKey="formsprortlocalerdescription",n.elementValue=t.formsprortlocalerdescription):null!=t.formsprocustomplaceholder&&(n.elementKey="formsprocustomplaceholder",n.elementValue=t.formsprocustomplaceholder),n}function l(t,n){var e=n.Model;if(!r.d.Collection.getItemWithKeyFields(e.LocalizedResources,{localeId:t.localeId})){var i={footerText:null,formCloseMessage:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,localeId:t.localeId,localeName:t.localeName,questionResources:[],subtitle:null,thankYouMessage:null,title:null,conditionalThankyouMessage:null};r.d.Collection.itemsAddedInSource(e.LocalizedResources,[i])}}function f(t,n){var e=n.Model,i=r.d.Collection.getItemWithKeyFields(e.LocalizedResources,{localeId:t});i&&r.d.Collection.itemsDeletedInSource(e.LocalizedResources,[i])}function h(t,n,e,o){var s={choices:[],choicesV1:[],formsprortlocaleldescription:null,formsprortlocalerdescription:null,formsprocustomplaceholder:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,leftDescription:null,localeId:t.localeId,localeName:t.localeName,option:null,questionId:n,rightDescription:null,subtitle:null,title:null,cascadeChoices:null},a=r.d.Collection.getItemWithKeyFields(o.Model.Questions,{Id:n});if(a&&a.ChoiceGroup&&a.ChoiceGroup.length>0){var u=i.map(a.ChoiceGroup,(function(t){return{choiceId:t.Id.toString(),description:null,key:t.Key}}));s.choices=u}var c=r.d.Collection.itemsAddedInSource(e.questionResources,[s]);return r.d.getObjectMasterFromModel(c[0])}function d(t,n,e){var i={choiceId:t,description:null,key:n},o=r.d.Collection.itemsAddedInSource(e.choices,[i]);return r.d.getObjectMasterFromModel(o[0])}function m(t){var n=r.d.Collection.itemsAddedInSource(t.choicesV1,[{choiceId:null,description:"",formsProDisplayRTText:""}]);return r.d.getObjectMasterFromModel(n[0])}function v(t,n){switch(n.localeId=t.locale,t.elementKey){case"title":n.title=t.elementValue;break;case"subtitle":n.subtitle=t.elementValue;break;case"localename":n.localeName=t.elementValue;break;case"formsprortlocaletitle":n.formsprortlocaletitle=t.elementValue;break;case"formsprortlocalesubtitle":n.formsprortlocalesubtitle=t.elementValue;break;default:var e=t.elementValue&&t.elementValue.length,i="Unexpected locale element key:[".concat(t.elementKey,"], value length:").concat(e),r=new Error(i).stack;return console.log(r),void(0,o.zU)("UnexpectedLocaleElementKey","".concat(i,", call stack:").concat(r))}}function g(t){var n={elementKey:null,elementValue:null,locale:null,questionId:null};return null!=t.title?(n.elementKey="title",n.elementValue=t.title):null!=t.subtitle?(n.elementKey="subtitle",n.elementValue=t.subtitle):null!=t.localeName?(n.elementKey="localename",n.elementValue=t.localeName):null!=t.formsprortlocaletitle?(n.elementKey="formsprortlocaletitle",n.elementValue=t.formsprortlocaletitle):null!=t.formsprortlocalesubtitle&&(n.elementKey="formsprortlocalesubtitle",n.elementValue=t.formsprortlocalesubtitle),n}function p(t,n){t&&t.length>0&&i.forEach(t,(function(t){var e=[];i.forEach(n,(function(n){var o=i.filter(t.questionResources,(function(t){return t.questionId===n.oldId}));i.forEach(o,(function(t){(t=i.clone(r.d.getObjectMasterFromModel(t).getSnapshot())).questionId=n.newId,e.push(t)}))})),r.d.Collection.addItems(t.questionResources,e)}))}},155:function(t,n,e){"use strict";e.d(n,{A:function(){return w}});var i=e(59312),r=e(12611),o=e(37890),s=e(26203),a=e(39923),u=e(94956),c=e(53907),l=e(62539),f=e(54438),h=e(81380),d=e(9743),m=function(){function t(t){this.Ln=t,this.Ot=(0,h.lK)(this.Ln.Form)}return t.prototype.add=function(t){var n=this;if(this.Ln.Form.SyncContext!==d.y.DesignTimeForm)return Promise.resolve();var e=this.Ln.QuestionId;if(e){var i=this.Ln.Form.getQuestionById(e).getChoiceByKey(this.Ln.Model.key||"");if(i)return i.Synchronizer.existingInDataSource().then((function(){var e=i.Model.Id.toString();n.Ln.Model.choiceId=e;var r={elementKey:"choiceid_"+e,elementValue:t.description,locale:n.Ln.LocaleId,questionId:n.Ln.QuestionId};return(0,f.m)(r,n.Ln.FormId).then((function(){return{choiceId:e,description:t.description}}))}))}return Promise.reject()},t.prototype.delete=function(t){throw Error("No scenario to call this method currently.")},t.prototype.query=function(t){throw Error("No scenario to call this method currently.")},t.prototype.update=function(t,n){if(!n.ValuesBefore||this.Ln.Form.SyncContext!==d.y.DesignTimeForm)return Promise.resolve();if(t.choiceId||void 0===t.description)throw Error("No valid payload to update.");var e={elementKey:"choiceid_"+this.Ln.ChoiceId,elementValue:t.description,locale:this.Ln.LocaleId,questionId:this.Ln.QuestionId};return null!==n.ValuesBefore.description?this.Ot.updateLocaleItem(this.Ln.FormId,e):this.Ot.createLocaleItem(this.Ln.FormId,e)},t}(),v={choiceId:a.J4.string({IsKeyField:!0,IgnoreKeyWithEmptyValue:!0}),description:a.J4.string(),key:a.J4.string()},g=function(t){function n(e){var i=t.call(this,e,{Scheduler:new u.b(n.name)})||this;if(!i.Model.key){if(!i.Model.choiceId)throw Error("Current choice localized master doesn't has key and choiceId.");e.MasterTreeReady&&e.MasterTreeReady.then((function(){return i.Form.fieldsReady([i.Form.Schema.Questions])})).then((function(){var t=i.Form.getQuestionById(i.QuestionId).getChoiceById(Number(i.Model.choiceId));t&&(i.Model.key=t.Model.Key)}))}return i}return(0,i.ZT)(n,t),Object.defineProperty(n.prototype,"QuestionLocalizedMaster",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Form",{get:function(){return this.QuestionLocalizedMaster.Form},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"QuestionId",{get:function(){return this.QuestionLocalizedMaster.Model.questionId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"LocaleId",{get:function(){return this.QuestionLocalizedMaster.Model.localeId},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ChoiceId",{get:function(){return this.Model.choiceId},enumerable:!1,configurable:!0}),n}(s.d.createObjectMasterClass("ChoiceLocalizedItemMaster",v,(function(t){return new m(t)}))),p=e(91091),b=function(){function t(t){this.Ln=t,this.Ot=(0,h.lK)(this.Ln.Form)}return t.prototype.add=function(t){var n=this;if(this.Ln.Form.SyncContext!==d.y.DesignTimeForm)return Promise.resolve();var e=this.Ln.QuestionId;if(e){var i=this.Ln.Form.getElementById(e);if(i)return i.Synchronizer.existingInDataSource().then((function(){var e,i=[];for(e in t)if(t.hasOwnProperty(e)){var o=(0,p.e0)(r.pick(t,[e]));o.elementKey&&(o.locale=n.Ln.Model.localeId,o.questionId=n.Ln.QuestionId,i.push((0,f.m)(o,n.Ln.FormId)))}return Promise.all(i).then((function(t){}))}))}return Promise.reject()},t.prototype.delete=function(t){throw Error("No scenario to call this method currently.")},t.prototype.query=function(t){throw Error("No scenario to call this method currently.")},t.prototype.update=function(t,n){if(!n.ValuesBefore||this.Ln.Form.SyncContext!==d.y.DesignTimeForm)return Promise.resolve();var e,i=[];for(e in t)if(t.hasOwnProperty(e)){var o=null!==n.ValuesBefore[e],s=(0,p.e0)(r.pick(t,[e]));s.locale=this.Ln.Model.localeId,s.questionId=this.Ln.QuestionId,i.push(o?this.Ot.updateLocaleItem(this.Ln.FormId,s):this.Ot.createLocaleItem(this.Ln.FormId,s))}return Promise.all(i).then((function(){}))},t}(),y={choices:a.J4.collectionOf((function(){return g})),choicesV1:a.J4.collectionOf({choiceId:a.J4.string({IsLocalField:!0}),description:a.J4.string({SourceFieldName:"Description"}),formsProDisplayRTText:a.J4.string({SourceFieldName:"FormsProDisplayRTText"})},{IsLocalField:!0}),formsprortlocaleldescription:a.J4.string(),formsprortlocalerdescription:a.J4.string(),formsprocustomplaceholder:a.J4.string(),formsprortlocalesubtitle:a.J4.string(),formsprortlocaletitle:a.J4.string(),leftDescription:a.J4.string(),localeId:a.J4.string({IsKeyField:!0}),localeName:a.J4.string(),option:a.J4.string(),questionId:a.J4.string({IsKeyField:!0}),rightDescription:a.J4.string(),subtitle:a.J4.string(),title:a.J4.string(),cascadeChoices:a.J4.collectionOf({choiceId:a.J4.string({IsLocalField:!0}),elementValue:a.J4.string({IsLocalField:!0}),locale:a.J4.string({IsLocalField:!0}),questionId:a.J4.string({IsLocalField:!0})},{IsLocalField:!0})},w=function(t){function n(e){var i=this,r=new o.wU;return(i=t.call(this,e,{MasterReady:r.promise(),Scheduler:new u.b(n.name)})||this).gi(e),r.resolve(),i}return(0,i.ZT)(n,t),n.handleChoicesV1Deleted=function(t,n,e){t<0||r.forEach(e.Model.LocalizedResources,(function(e){r.filter(e.questionResources,(function(t){return t.questionId===n})).forEach((function(n){n.choicesV1.length>t&&s.d.Collection.itemsDeletedInSource(n.choicesV1,[n.choicesV1[t]])}))}))},n.handleChoicesV1Exchange=function(t,n,e,i){r.forEach(i.Model.LocalizedResources,(function(i){s.d.getCollectionMasterFromModel(i.questionResources).bulkEdit((function(i){r.filter(i,(function(t){return t.questionId===e})).forEach((function(e){var i,o,s=e.choicesV1;for(t>n?(i=n,o=t):(i=t,o=n);s.length<=o+1;)(0,p.Mn)(e);var a=r.map(s,(function(t){return t.description})),u=a.splice(t,1);a.splice(n,0,u[0]);for(var c=i;c<=o;++c)s[c].description=a[c]}))}))}))},Object.defineProperty(n.prototype,"Form",{get:function(){return this.FormLocalizedMaster.Form},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"FormLocalizedMaster",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"QuestionId",{get:function(){return this.Model.questionId},enumerable:!1,configurable:!0}),n.prototype.getChoiceLocalizedMaster=function(t){var n=this,e=r.find(this.Form.Model.Questions,(function(t){return t.Id===n.QuestionId}));if(e){var i=r.find(e.ChoiceGroup,(function(n){return n.Id.toString()===t}));if(i){var o=s.d.Collection.getItemWithKeyFields(this.Model.choices,{choiceId:t});return o?s.d.getObjectMasterFromModel(o):(0,p.fp)(t,i.Key,this.Model)}}throw Error("Question or Chocie don't exist for localization.")},n.prototype.getChoiceV1LocalizedMaster=function(t){var n=this,e=r.find(this.Form.Model.Questions,(function(t){return t.Id===n.QuestionId}));if(e&&e.Choices.length>t){for(;this.Model.choicesV1.length<e.Choices.length;)(0,p.Mn)(this.Model);return s.d.getObjectMasterFromModel(this.Model.choicesV1[t])}return null},n.prototype.gi=function(t){n.Schema.option&&(this.bi=new c.S(this,n.Schema.option,n.ChoicesV1FieldSet),t.InitialData&&this.isFieldReady(n.Schema.option)&&(t.ExistingInDataSource||t.InitialData.option?this.bi.deserialize():this.bi.serialize()))},Object.defineProperty(n,"ChoicesV1FieldSet",{get:function(){return n.choicesV1FieldSet||(n.choicesV1FieldSet=new l.C([n.Schema.choicesV1])),n.choicesV1FieldSet},enumerable:!1,configurable:!0}),n}(s.d.createObjectMasterClass("QuestionLocalizedItemMaster",y,(function(t){return new b(t)})))},64966:function(t,n,e){"use strict";e.d(n,{LN:function(){return m},yN:function(){return h},pg:function(){return d}});var i=e(59312),r=e(26203),o=e(39923),s=e(41293),a=e(9743),u=e(81380),c=function(){function t(t,n){this.wi=t,this.Ot=(0,u.lK)(this.wi.Form)}return Object.defineProperty(t.prototype,"FormId",{get:function(){return this.wi.FormId},enumerable:!1,configurable:!0}),t.prototype.add=function(t){return this.wi.Form.SyncContext===a.y.AdminPhishingReviewForm?this.Ot.createAdminPhishingReviewPermissionLink(this.FormId,t):this.Ot.createPermissionLink(this.FormId,t)},t.prototype.delete=function(t){return this.Ot.deletePermissionLink(this.FormId,t.principalId)},t.prototype.query=function(t){return(0,s._y)("No scenario to call this method currently.")},t.prototype.update=function(t,n){if("OrgLink"===n.Snapshot.type||"Link"===n.Snapshot.type||"ShareToPeople"===n.Snapshot.type){var e={permissionSet:n.Snapshot.permissionSet,type:n.Snapshot.type};return this.wi.Form.SyncContext===a.y.AdminPhishingReviewForm?this.Ot.createAdminPhishingReviewPermissionLink(this.FormId,e):this.Ot.createPermissionLink(this.FormId,e)}return(0,s._y)("No scenario to call this method currently.")},t}(),l=e(82205),f={PrincipalId:o.J4.string({SourceFieldName:"principalId"}),PermissionSet:o.J4.string({SourceFieldName:"permissionSet"}),Type:o.J4.reference({SourceFieldName:"type"}),FormId:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"formId"}),IsOwner:o.J4.boolean({IsSourceGenerated:!0,SourceFieldName:"isOwner"}),PrincipalEmailAddress:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"principalEmailAddress"}),PrincipalName:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"principalName"}),SavingState:o.J4.reference({IsLocalField:!0})};function h(t){return{PermissionSet:"Read, Write, Share",Type:t}}function d(t){return r.d.getObjectMasterFromModel(t)}var m=function(t){function n(n){var e=t.call(this,n)||this;return(0,l.vG)(e),e}return(0,i.ZT)(n,t),Object.defineProperty(n.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),n}(r.d.createObjectMasterClass("Permission",f,(function(t,n){return new c(t,n)})))},99374:function(t,n,e){"use strict";e.d(n,{p:function(){return f},R:function(){return l}});var i=e(59312),r=e(26203),o=e(39923),s=e(41293),a=e(81380),u=function(){function t(t,n){this.Ni=t,this.Ot=(0,a.lK)(this.Ni.getForm())}return t.prototype.Ci=function(){return this.Ni.getFormId()},t.prototype.add=function(t){return this.Ot.createPermissionToken(this.Ci(),t)},t.prototype.delete=function(t){return this.Ot.deletePermissionToken(this.Ci(),t.principalId)},t.prototype.query=function(t){return(0,s._y)("No scenario to call this method currently.")},t.prototype.update=function(t,n){return(0,s._y)("No scenario to call this method currently.")},t}(),c={PrincipalId:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"principalId"}),Type:o.J4.reference({SourceFieldName:"type"}),Name:o.J4.string({SourceFieldName:"name"})};function l(t){return r.d.getObjectMasterFromModel(t)}var f=function(t){function n(n){return t.call(this,n)||this}return(0,i.ZT)(n,t),n.prototype.getForm=function(){return this.Parent.Parent},n.prototype.getFormId=function(){return this.getForm().Model.Id},n}(r.d.createObjectMasterClass("PermissionToken",c,(function(t,n){return new u(t,n)})))},85179:function(t,n,e){"use strict";e.d(n,{R:function(){return r},l:function(){return o}});var i=e(59312);function r(t){return Promise.resolve(function(t){var n=s[t];n||(n=s[t]=new o(t));return n}(t))}var o=function(t){function n(n){var e=t.call(this)||this;return e.Ii=n,e}return(0,i.ZT)(n,t),Object.defineProperty(n.prototype,"GroupId",{get:function(){return this.Ii},enumerable:!1,configurable:!0}),n}(e(92913).C);var s={}},92913:function(t,n,e){"use strict";e.d(n,{C:function(){return a},U:function(){return u}});var i=e(59312),r=e(26203),o=e(39923),s={height:o.J4.number(),id:o.J4.string({IsKeyField:!0}),value:o.J4.reference(),width:o.J4.number()};var a=function(t){function n(){return t.call(this,{ExistingInDataSource:!0})||this}return(0,i.ZT)(n,t),n.prototype.getUrl=function(){var t=this;return this.Ti||(this.Ti=this.ensureFieldsReady([this.Schema.value]).then((function(){return n=t.Model.value,new Promise((function(t,e){var i=new FileReader;i.readAsDataURL(n),i.onloadend=function(n){return t("string"==typeof i.result?i.result:"")},i.onerror=e}));var n}))),this.Ti},n}(r.d.createObjectMasterClass("PhotoMaster",s,(function(t){for(var n=0,e=c;n<e.length;n++){var i=(0,e[n])(t);if(i)return i}throw Error("Not supported")})));function u(t){c.push(t)}var c=[]},92447:function(t,n,e){"use strict";e.d(n,{F:function(){return o},t:function(){return r}});var i=e(59312);function r(t){return Promise.resolve(function(t){var n=s[t];n||(n=s[t]=new o(t));return n}(t))}var o=function(t){function n(n){var e=t.call(this)||this;return e.ki=n,e}return(0,i.ZT)(n,t),Object.defineProperty(n.prototype,"UserId",{get:function(){return this.ki},enumerable:!1,configurable:!0}),n}(e(92913).C);var s={}},31437:function(t,n,e){"use strict";e.d(n,{my:function(){return s},nu:function(){return p},Rd:function(){return S.R},to:function(){return C.t},uw:function(){return d}});var i=e(59312),r=e(92913),o=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.getInstance=function(){return n.instance||(n.instance=new n),n.instance},n}(r.C);function s(){return Promise.resolve(o.getInstance())}var a=e(12611),u=e(26203),c=e(61018),l=function(){function t(t){this.Ln=t,this.Ot=(0,c.d8)()}return Object.defineProperty(t.prototype,"Master",{get:function(){return this.Ln},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"DataProvider",{get:function(){return this.Ot},enumerable:!1,configurable:!0}),t.prototype.add=function(t){throw Error("PhotoDataSource.add - No scenario to call this method currently.")},t.prototype.delete=function(t){throw Error("PhotoDataSource.delete - No scenario to call this method currently.")},t.prototype.query=function(t){var n=[],e=u.d.getFieldSchemaInfo(this.Ln.Schema.value).Name;return a.contains(t,e)&&(n.push(this.queryValue()),t=a.without(t,e)),t.length&&n.push(this.queryDefinition()),Promise.all(n).then((function(t){return a.extend.apply(a,(0,i.ev)([{}],t,!1))}))},t.prototype.update=function(t){throw Error("PhotoDataSource.update - No scenario to call this method currently.")},t}(),f=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.queryValue=function(){return this.DataProvider.getCurrentUserPhotoValue().then((function(t){return{value:t}}))},n.prototype.queryDefinition=function(){throw new Error("NotSupportQueryOfCurrentUserPhotoDefinition")},n}(l);(0,r.U)((function(t){return t instanceof o?new f(t):null}));var h=e(67661);function d(t){return new Promise((function(n,e){t.ensureFieldsReady([h.x.Schema.Id,h.x.Schema.OwnerId]).then((function(){var e=t.Model.OwnerId,i=v[e];i||(i=v[e]=new m(t.Model.Id)),n(i)}),e)}))}var m=function(t){function n(n){var e=t.call(this)||this;return e.Fi=n,e}return(0,i.ZT)(n,t),Object.defineProperty(n.prototype,"TypicalFormId",{get:function(){return this.Fi},enumerable:!1,configurable:!0}),n}(r.C),v={},g=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.queryValue=function(){return this.DataProvider.getFormCreatorPhotoValue(this.Master.TypicalFormId).then((function(t){return{value:t}}))},n.prototype.queryDefinition=function(){return this.DataProvider.getFormCreatorPhotoDefinition(this.Master.TypicalFormId)},n}(l);function p(t,n){var e="".concat(t,"_").concat(n),i=y[e];return i||(i=y[e]=new b(t,n)),i}(0,r.U)((function(t){return t instanceof m?new g(t):null}));var b=function(t){function n(n,e){var i=t.call(this)||this;return i.Ii=n,i.ki=e,i}return(0,i.ZT)(n,t),Object.defineProperty(n.prototype,"GroupId",{get:function(){return this.Ii},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"MemberId",{get:function(){return this.ki},enumerable:!1,configurable:!0}),n}(r.C),y={},w=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.queryValue=function(){return this.DataProvider.getGroupMemberPhotoValue(this.Master.GroupId,this.Master.MemberId).then((function(t){return{value:t}}))},n.prototype.queryDefinition=function(){return this.DataProvider.getGroupMemberPhotoDefinition(this.Master.GroupId,this.Master.MemberId)},n}(l);(0,r.U)((function(t){return t instanceof b?new w(t):null}));var S=e(85179),N=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.queryValue=function(){return this.DataProvider.getGroupPhotoValue(this.Master.GroupId).then((function(t){return{value:t}}))},n.prototype.queryDefinition=function(){return this.DataProvider.getGroupPhotoDefinition(this.Master.GroupId)},n}(l);(0,r.U)((function(t){return t instanceof S.l?new N(t):null}));var C=e(92447),I=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.queryDefinition=function(){throw new Error("Method not implemented.")},n.prototype.queryValue=function(){return this.DataProvider.getUserPhotoValue(this.Master.UserId).then((function(t){return{value:t}}))},n}(l);(0,r.U)((function(t){return t instanceof C.F?new I(t):null}))},16240:function(t,n,e){"use strict";e.d(n,{Np:function(){return f},dI:function(){return d},n3:function(){return v},sv:function(){return h},zh:function(){return m}});var i=e(9947),r=e(7645),o=e(87941),s=e(61018),a=e(48333),u=e(26143),c=e(85866),l=e(51586);function f(t,n){var e=function(t,n){var e=n.FormMasters,s=(0,a.o)(t?(0,r.pm)().Designer_DefaultQuizTitle:(0,r.pm)().Designer_DefaultFormTitle,(0,r.pm)().Designer_Title_autoRenameFormat,e.filter((function(t){return!t.Deleted})).map((function(t){return t.Model.Title}))),u={IsAnonymous:(0,i.k0)().userInfo.IsMsa,IsQuizMode:t,RequiresUniqueResponse:t&&!(0,i.k0)().userInfo.IsMsa};t&&(u.ShowGradedResults=!0,u.ManualGradingEnabled=!1);return{Settings:u,Title:s,XlWorkbookId:(0,o.jI)(!0,t)}}(t,n);return e.OwnerId=n.Model.id,function(t,n){var e=(0,l.Si)(t);return n.addFormReference({instanceId:e.getInstanceId(),modifiedDate:e.Model.Modified,ownerId:e.Model.OwnerId,ownerTenantId:e.Model.OwnerTenantId,title:e.Model.Title,softDeleted:e.Model.SoftDeleted}),e}(e,n)}function h(t,n){u.Z.duplicateForm(t,{IsGroupForm:t.IsGroupForm,OwnerId:t.Model.OwnerId,OwnerTenantId:t.Model.OwnerTenantId})}function d(t,n){t.Deleted=!0,t.Synchronizer.flush().then((function(){n.FormMasters.indexOf(t)>-1&&n.removeFormReference(t.getInstanceId())}))}function m(t,n,e){var i=function(){n.FormMasters.indexOf(t)>-1&&n.removeFormReference(t.getInstanceId()),e&&e()};s.VY.getInstance().createDataProvider().deleteForm(t.Model.Id).then(i,(function(t){674===t.innerCode&&i()}))}function v(t,n){t.Model.SoftDeleted=c.d.Normal}},39271:function(t,n,e){"use strict";e.d(n,{Z:function(){return v},I:function(){return i}});var i,r=e(59312),o=e(12611),s=e(26203),a=e(39923),u=e(67661),c=e(51586),l=e(61018),f=function(){function t(t){this.Pi=t}return t.prototype.add=function(t){throw Error("No scenario to call this method currently.")},t.prototype.delete=function(t){throw Error("No scenario to call this method currently.")},t.prototype.query=function(t){var n,e=(0,l.d8)();switch(this.Pi.Model.Extension){case i.Form:n="User";break;case i.GroupForm:n="Group";break;default:n=null}return e.getRecentForms(n).then((function(t){return{documents:t}}))},t.prototype.update=function(t,n){return new Promise((function(){}))},t}(),h={App:a.J4.string({SourceFieldName:"app"}),Category:a.J4.string({SourceFieldName:"category"}),Extension:a.J4.string({SourceFieldName:"extension"}),FormCategory:a.J4.string({SourceFieldName:"formCategory"}),FormType:a.J4.string({SourceFieldName:"formType"}),IsPinned:a.J4.boolean({SourceFieldName:"isPinned"}),MruId:a.J4.string({SourceFieldName:"mruId"}),NotExist:a.J4.boolean({IsLocalField:!0}),OwnerId:a.J4.string({SourceFieldName:"ownerId"}),OwnerName:a.J4.string({SourceFieldName:"ownerName"}),OwnerTenantId:a.J4.string({SourceFieldName:"ownerTenantId"}),OwnerType:a.J4.reference({SourceFieldName:"ownerType"}),ServerDocId:a.J4.string({SourceFieldName:"serverDocId"}),Timestamp:a.J4.string({SourceFieldName:"timestamp"}),Title:a.J4.string({SourceFieldName:"title"}),Type:a.J4.string({SourceFieldName:"type"}),Url:a.J4.string({SourceFieldName:"url"})},d=function(t){function n(n){var e=t.call(this,n)||this;return e.Model.NotExist=!1,e}return(0,r.ZT)(n,t),Object.defineProperty(n.prototype,"FormMaster",{get:function(){return this.Je||(this.Je=(0,c.Si)({Id:this.Model.ServerDocId})),this.Je},enumerable:!1,configurable:!0}),n.prototype.matchSearchStrings=function(t){var n="".concat(this.Model.Title," ").concat(this.Model.OwnerName||"").toLowerCase();return o.all(t,(function(t){return n.indexOf(t)>=0}))},n}(s.d.createObjectMasterClass("MruDocument",h)),m={Extension:a.J4.enumeration((function(){return i}),{IsLocalField:!0}),Knowledge:a.J4.string({IsSourceGenerated:!0,SourceFieldName:"knowledge"}),MruDocuments:a.J4.collectionOf((function(){return d}),{SourceFieldName:"documents"}),ResponseCode:a.J4.string({IsSourceGenerated:!0,SourceFieldName:"responseCode"})};!function(t){t[t.Form=0]="Form",t[t.GroupForm=1]="GroupForm",t[t.Unspecified=2]="Unspecified"}(i||(i={}));var v=function(t){function n(){var n=t.call(this,{ExistingInDataSource:!0,InitialData:{Extension:i.GroupForm,Knowledge:""}})||this;return n.Di=[],n}return(0,r.ZT)(n,t),n.getInstance=function(){return this.instance||(this.instance=new n),this.instance},Object.defineProperty(n.prototype,"Documents",{get:function(){return this.isFieldReady(this.Schema.MruDocuments)?s.d.convertToArray(this.Model.MruDocuments).sort((function(t,n){return Date.parse(n.Timestamp)-Date.parse(t.Timestamp)})).map((function(t){return s.d.getObjectMasterFromModel(t)})):[]},enumerable:!1,configurable:!0}),n.prototype.removeDocument=function(t){this.isFieldReady(this.Schema.MruDocuments)&&s.d.Collection.deleteItems(this.Model.MruDocuments,o.filter(this.Model.MruDocuments,(function(n){return n.ServerDocId===t})))},n.prototype.initializeFormList=function(){var t=this,e=n.Schema;return this.ensureFieldsReady([e.Knowledge,e.MruDocuments]).then((function(){o.forEach(t.Model.MruDocuments,(function(t){var n=(0,c.ZP)({Id:t.ServerDocId},!1);n.fieldsReady([u.x.Schema.Title]).then((function(){n.observe((function(e){e.BeingDeleted||(t.Title=n.Model.Title)}),[u.x.Schema.Title]),t.Title=n.Model.Title}))}))}),(function(){}))},n.prototype.observeListChange=function(t){if(this.Mi(t)<0){var n=function(n){(n.AddedModels.length||n.RemovedModels.length)&&t()};this.Di.push({originCallback:t,registeredCallback:n}),this.Li().then((function(t){return t.observe(n)}))}},n.prototype.unobserveListChange=function(t){var n=this.Mi(t);if(n>=0){var e=this.Di[n];this.Di.splice(n,1),this.Li().then((function(t){return t.unobserve(e.registeredCallback)}))}},n.prototype.Li=function(){var t=this;return this.fieldsReady([this.Schema.MruDocuments]).then((function(){return s.d.getCollectionMasterFromModel(t.Model.MruDocuments)}))},n.prototype.Mi=function(t){return o.findIndex(this.Di,(function(n){return n.originCallback===t}))},n}(s.d.createObjectMasterClass("MruDocumentCollection",m,(function(t){return new f(t)})));Forms.Mru.MruDocumentCollectionMaster=v},40935:function(t,n,e){"use strict";e.d(n,{E:function(){return w},F:function(){return S}});var i=e(59312),r=e(26203),o=e(39923),s=e(12611),a=e(85866),u=e(51586),c=e(31437),l=e(67661),f=function(){function t(){}return t.prototype.add=function(){throw Error("No scenario to call this method currently.")},t.prototype.delete=function(t){throw Error("No scenario to call this method currently.")},t.prototype.update=function(){throw Error("No scenario to call this method currently.")},t.prototype.query=function(t,n){var e=r.d.getFieldSchemaInfo(d.Schema.id).Name;if(!s.isEqual(t,[e]))throw Error("No scenario to call this method currently.");var i=n.Master.FormMaster;return i.ensureFieldsReady([i.Schema.Id]).then((function(){return{id:i.Model.Id}}))},t}(),h={category:o.J4.string(),id:o.J4.string({IsKeyField:!0,IsSourceGenerated:!0}),instanceId:o.J4.string({IsLocalField:!0}),modifiedDate:o.J4.string(),movingToRecycleBin:o.J4.boolean({IsLocalField:!0}),ownerId:o.J4.string(),ownerTenantId:o.J4.string(),ready:o.J4.boolean({IsLocalField:!0}),softDeleted:o.J4.enumeration((function(){return a.d}),{IsNumberTypeInDataSource:!0}),title:o.J4.string(),BusinessCdsId:o.J4.string(),BusinessCdsRegion:o.J4.string(),CustomCssFileName:o.J4.string(),FormsProBranchRules:o.J4.string(),formsProEmbedCode:o.J4.string(),formsProRTDescription:o.J4.string(),formsProRTTitle:o.J4.string(),inviteExpiryDays:o.J4.string(),IsDefaultCds:o.J4.string(),LastEmbedConfig:o.J4.string(),MfpBranchingData:o.J4.string(),CVSimplifiedBranchingSupported:o.J4.string(),ownerUserType:o.J4.string(),PipesDetails:o.J4.string(),progressBarEnabled:o.J4.string(),responseThresholdCount:o.J4.string(),ProjectId:o.J4.string(),surveyFont:o.J4.string(),headerFont:o.J4.string(),alias:o.J4.string(),shortUrl:o.J4.string(),InitialFormId:o.J4.string(),InitialFormOwnerId:o.J4.string(),projectName:o.J4.string(),projectGroupId:o.J4.string(),fileUploadStorage:o.J4.string(),surveyPermanentId:o.J4.string(),emailTemplatesMapping:o.J4.string(),flowTemplateId:o.J4.string(),surveyLastModifiedAt:o.J4.string()},d=function(t){function n(e){var i=t.call(this,n.normalizeContext(e))||this;return i.Je=(0,u.Wq)(i.Model.instanceId),i.Je.fieldsReady([l.x.Schema.Id]).then((function(){i.Synchronizer.onSourceDataReceived({id:i.Je.Model.Id})})),i.Je.fieldsReady([l.x.Schema.Modified]).then((function(){i.Model.ready=!0})),i.Je.observe((function(t){if(!t.BeingDeleted){var n=t.NewValues;i.bulkEdit((function(){i.Synchronizer.onSourceDataReceived({modifiedDate:n.ModifiedDate,softDeleted:n.SoftDeleted,title:n.Title,BusinessCdsId:n.BusinessCdsId,BusinessCdsRegion:n.BusinessCdsRegion,CustomCssFileName:n.CustomCssFileName,FormsProBranchRules:n.FormsProBranchRules,formsProEmbedCode:n.FormsProEmbedCode,formsProRTDescription:n.FormsProRTDescription,formsProRTTitle:n.FormsProRTTitle,inviteExpiryDays:n.InviteExpiryDays,IsDefaultCds:n.IsDefaultCds,LastEmbedConfig:n.LastEmbedConfig,MfpBranchingData:n.MfpBranchingData,CVSimplifiedBranchingSupported:n.CVSimplifiedBranchingSupported,ownerUserType:n.OwnerUserType,PipesDetails:n.PipesDetails,progressBarEnabled:n.ProgressBarEnabled,responseThresholdCount:n.ResponseThresholdCount,ProjectId:n.ProjectId,surveyFont:n.SurveyFont,headerFont:n.HeaderFont,alias:n.Alias,shortUrl:n.ShortUrl,InitialFormId:n.InitialFormId,InitialFormOwnerId:n.InitialFormOwnerId,projectName:n.ProjectName,projectGroupId:n.ProjectGroupId,fileUploadStorage:n.FileUploadStorage,surveyPermanentId:n.SurveyPermanentId,emailTemplatesMapping:n.EmailTemplatesMapping,flowTemplateId:n.FlowTemplateId,surveyLastModifiedAt:n.SurveyLastModifiedAt}),i.Model.movingToRecycleBin=n.MovingToRecycleBin}))}}),[l.x.Schema.MovingToRecycleBin,l.x.Schema.ModifiedDate,l.x.Schema.SoftDeleted,l.x.Schema.Title,l.x.Schema.OwnerUserType,l.x.Schema.BusinessCdsId,l.x.Schema.BusinessCdsRegion,l.x.Schema.IsDefaultCds,l.x.Schema.LastEmbedConfig,l.x.Schema.PipesDetails,l.x.Schema.FormsProRTDescription,l.x.Schema.FormsProRTTitle,l.x.Schema.FormsProBranchRules,l.x.Schema.MfpBranchingData,l.x.Schema.CVSimplifiedBranchingSupported,l.x.Schema.CustomCssFileName,l.x.Schema.ResponseThresholdCount,l.x.Schema.InviteExpiryDays,l.x.Schema.ProgressBarEnabled,l.x.Schema.ProjectId,l.x.Schema.SurveyFont,l.x.Schema.HeaderFont,l.x.Schema.Alias,l.x.Schema.ShortUrl,l.x.Schema.InitialFormId,l.x.Schema.InitialFormOwnerId,l.x.Schema.ProjectName,l.x.Schema.ProjectGroupId,l.x.Schema.FileUploadStorage,l.x.Schema.SurveyPermanentId,l.x.Schema.EmailTemplatesMapping,l.x.Schema.FlowTemplateId,l.x.Schema.SurveyLastModifiedAt]),i}return(0,i.ZT)(n,t),Object.defineProperty(n.prototype,"FormMaster",{get:function(){return this.Je},enumerable:!1,configurable:!0}),n.normalizeContext=function(t){if(t.InitialData&&!t.InitialData.instanceId&&((t=s.clone(t)).InitialData=s.clone(t.InitialData),t.InitialData)){var n=(0,u.Si)({Id:t.InitialData.id});n.Synchronizer.onSourceDataReceived(t.InitialData),t.InitialData.instanceId=n.getInstanceId()}return t},n}(r.d.createObjectMasterClass("FormReferenceMaster",h,(function(){return new f}))),m=e(61018),v=function(){function t(t){this.Ri=t,this.Ot=(0,m.GA)(this.Ri.Model.id)}return t.prototype.add=function(t){throw Error("No scenario to call this method currently.")},t.prototype.delete=function(t){throw Error("No scenario to call this method currently.")},t.prototype.update=function(t,n){return new Promise((function(){}))},t.prototype.query=function(t){var n=[],e=p.Schema,o=r.d.getFieldSchemaInfo(e.formReferences).Name,a=r.d.getFieldSchemaInfo(e.members).Name,u=r.d.getFieldSchemaInfo(e.owners).Name,c=r.d.getFieldSchemaInfo(e.classification).Name,l=r.d.getFieldSchemaInfo(e.visibility).Name,f=r.d.getFieldSchemaInfo(e.emailAddress).Name;if(t.indexOf(o)<0&&t.indexOf(a)<0&&t.indexOf(u)<0&&t.indexOf(c)<0&&t.indexOf(l)<0&&t.indexOf(f)<0)throw Error("No scenario to call this method currently.");if(t.indexOf(o)>-1){var h=this.Ot.getForms(["id","title","modifiedDate","ownerId","ownerTenantId","softDeleted","category"],{name:"type",operator:"ne",value:"'survey'"}).then((function(t){return{formReferences:t}}));n.push(h)}if(t.indexOf(a)>-1){h=this.Ot.getGroupMembers(this.Ri.Model.id).then((function(t){return{members:t}}));n.push(h)}if(t.indexOf(u)>-1){h=this.Ot.getGroupOwners(this.Ri.Model.id).then((function(t){return{owners:t}}));n.push(h)}if(t.indexOf(c)>-1||t.indexOf(f)>-1||t.indexOf(l)>-1){h=this.Ot.getGroup(this.Ri.Model.id).then((function(t){return{classification:t&&t.classification,emailAddress:t&&t.emailAddress,visibility:t&&t.visibility}}));n.push(h)}return Promise.all(n).then((function(t){return s.extend.apply(s,(0,i.ev)([{}],t,!1))}))},t}(),g={classification:o.J4.string(),displayName:o.J4.string(),emailAddress:o.J4.string(),formReferences:o.J4.collectionOf(d),id:o.J4.string({IsKeyField:!0}),members:o.J4.collectionOf({displayName:o.J4.string(),id:o.J4.string()}),owners:o.J4.collectionOf({displayName:o.J4.string(),id:o.J4.string()}),visibility:o.J4.string()},p=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),Object.defineProperty(n.prototype,"Photo",{get:function(){return(0,c.Rd)(this.Model.id)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"FormMasters",{get:function(){return this.isFieldReady(this.Schema.formReferences)?r.d.convertToArray(this.Model.formReferences).map((function(t){return(0,u.Wq)(t.instanceId)})):[]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"FormMasterExceptSoftDeleted",{get:function(){return this.FormMasters.filter((function(t){return t.isFieldReady(t.Schema.SoftDeleted)&&(t.Model.MovingToRecycleBin||t.Model.SoftDeleted!==a.d.SoftDeleted)}))},enumerable:!1,configurable:!0}),n.prototype.getFormMasterSoftDeteledForms=function(){return this.FormMasters.filter((function(t){return t.isFieldReady(t.Schema.SoftDeleted)&&t.Model.SoftDeleted===a.d.SoftDeleted&&!t.Model.MovingToRecycleBin}))},n.prototype.addFormReference=function(t){this.isFieldReady(n.Schema.formReferences)&&r.d.Collection.itemsAddedInSource(this.Model.formReferences,[t])},n.prototype.removeFormReference=function(t){this.isFieldReady(n.Schema.formReferences)&&r.d.Collection.itemsDeletedInSource(this.Model.formReferences,s.filter(this.Model.formReferences,(function(n){return n.instanceId===t})))},n.prototype.getMemberPhoto=function(t){return Promise.resolve((0,c.nu)(this.Model.id,t))},n}(r.d.createObjectMasterClass("Group",g,(function(t){return new v(t)}))),b=function(){function t(t){this.Ot=(0,m.d8)()}return t.prototype.add=function(t){throw Error("No scenario to call this method currently.")},t.prototype.delete=function(t){throw Error("No scenario to call this method currently.")},t.prototype.update=function(t){throw Error("No scenario to call this method currently.")},t.prototype.query=function(t){var n=r.d.getFieldSchemaInfo(w.Schema.groups).Name;if(1!==t.length||t[0]!==n)throw Error("The fields didn't exist.");return this.Ot.getGroups().then((function(t){var n=p.Schema,e=[n.classification,n.displayName,n.emailAddress,n.id,n.visibility].map((function(t){return r.d.getFieldSchemaInfo(t).Name}));return{groups:t=t.map((function(t){return s.pick(t,e)}))}}))},t}(),y={groups:o.J4.collectionOf((function(){return p}))},w=function(t){function n(){return t.call(this,{ExistingInDataSource:!0})||this}return(0,i.ZT)(n,t),n.getInstance=function(){return this.instance||(this.instance=new n),this.instance},Object.defineProperty(n.prototype,"Groups",{get:function(){return this.isFieldReady(this.Schema.groups)?r.d.convertToArray(this.Model.groups).map((function(t){return r.d.getObjectMasterFromModel(t)})):[]},enumerable:!1,configurable:!0}),n}(r.d.createObjectMasterClass("MyGroups",y,(function(t){return new b(t)})));function S(){return w.getInstance()}},70284:function(t,n,e){"use strict";e.d(n,{V:function(){return l}});var i=e(59312),r=e(26203),o=e(39923),s=e(64459),a=e(61018),u=function(){function t(t){this.Ot=(0,a.d8)()}return t.prototype.add=function(t){throw Error("No scenario to call this method currently.")},t.prototype.delete=function(t){throw Error("No scenario to call this method currently.")},t.prototype.update=function(t,n){return this.Ot.updateUserSettings(JSON.stringify(n.Snapshot))},t.prototype.query=function(t){return this.Ot.getUserSettings().then((function(t){return(0,s.d)(t)}))},t}(),c={SampleFormStates:{PartyInvite:o.J4.string()},TemplateGalleryToggleState:o.J4.boolean()},l=function(t){function n(){return t.call(this,{ExistingInDataSource:!0})||this}return(0,i.ZT)(n,t),n.getInstance=function(){return this.instance||(this.instance=new n),this.instance},n}(r.d.createObjectMasterClass("UserSettings",c,(function(t){return new u(t)})))},20469:function(t,n,e){"use strict";e.d(n,{Qq:function(){return d},kF:function(){return f},cp:function(){return h}});var i=e(59312),r=e(26203),o=e(39923),s=e(41293),a=e(81380),u=function(){function t(t,n){this.wi=t,this.Ot=(0,a.lK)(this.wi.Form)}return Object.defineProperty(t.prototype,"FormId",{get:function(){return this.wi.FormId},enumerable:!1,configurable:!0}),t.prototype.add=function(t){return this.Ot.createResponderPermissionLink(this.FormId,t)},t.prototype.delete=function(t){return this.Ot.deleteResponderPermissionLink(this.FormId,t.principalId)},t.prototype.query=function(t){return(0,s._y)("No scenario to call this method currently.")},t.prototype.update=function(t,n){return(0,s._y)("No scenario to call this method currently.")},t}(),c=e(82205),l={PrincipalId:o.J4.string({SourceFieldName:"principalId"}),PermissionSet:o.J4.string({SourceFieldName:"permissionSet"}),Type:o.J4.reference({SourceFieldName:"type"}),FormId:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"formId"}),IsOwner:o.J4.boolean({IsSourceGenerated:!0,SourceFieldName:"isOwner"}),PrincipalEmailAddress:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"principalEmailAddress"}),PrincipalName:o.J4.string({IsSourceGenerated:!0,SourceFieldName:"principalName"}),SavingState:o.J4.reference({IsLocalField:!0})};function f(t){return{PermissionSet:"DataCreator",Type:t}}function h(t){return r.d.getObjectMasterFromModel(t)}var d=function(t){function n(n){var e=t.call(this,n)||this;return(0,c.vG)(e),e}return(0,i.ZT)(n,t),Object.defineProperty(n.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),n}(r.d.createObjectMasterClass("ResponderPermission",l,(function(t,n){return new u(t,n)})))},41275:function(t,n,e){"use strict";e.d(n,{KJ:function(){return b},q4:function(){return p},_p:function(){return g}});var i=e(59312),r=e(37890),o=e(82205),s=e(26203),a=e(39923),u=e(41293),c=e(9743),l=e(81380),f=function(){function t(t,n){this.Oi=t,this._i=n,this.Ot=(0,l.lK)(this.Oi.Form)}return t.prototype.Ci=function(){return this.Oi.FormId},t.prototype.Gi=function(){return this.Oi.ResponseId},t.prototype.add=function(t){return(0,u._y)("No scenario to call this method currently.")},t.prototype.delete=function(t){return this.Ot.deleteFormResponse(this.Ci(),t.id)},t.prototype.query=function(t){return(0,u._y)("No scenario to call this method currently.")},t.prototype.update=function(t,n){var e=t.releaseDate,i=this.Oi.Form.SyncContext;return i!==c.y.DesignTimeForm&&i!==c.y.AnalysisTimeForm?new Promise((function(){})):void 0!==e?this.Ot.setResponseReleaseDate(this.Ci(),this.Gi(),e):Promise.resolve()},t}(),h=e(82963),d=e(94956),m=e(86415),v={Id:a.J4.number({IsKeyField:!0,SourceFieldName:"id"}),Comments:a.J4.collectionOf((function(){return m.k}),{SourceFieldName:"comments"}),AnswersAsString:a.J4.string({SourceFieldName:"answers"}),StartDateAsString:a.J4.string({SourceFieldName:"startDate"}),SubmitDateAsString:a.J4.string({SourceFieldName:"submitDate"}),Responder:a.J4.string({SourceFieldName:"responder"}),ResponderName:a.J4.string({SourceFieldName:"responderName"}),QuizResult:a.J4.string({SourceFieldName:"quizResult"}),ReleaseDateAsString:a.J4.string({SourceFieldName:"releaseDate"}),Answers:a.J4.collectionOf({QuestionId:a.J4.string({IsKeyField:!0,SourceFieldName:"questionId"}),Answer:a.J4.reference({SourceFieldName:"answer1"}),Feedback:a.J4.string({IsLocalField:!0}),Score:a.J4.number({IsLocalField:!0}),IsAutoGraded:a.J4.boolean({IsLocalField:!0}),IsMathAnswer:a.J4.boolean({IsLocalField:!0})},{IsLocalField:!0}),StartDate:a.J4.reference({IsLocalField:!0}),SubmitDate:a.J4.reference({IsLocalField:!0}),ReleaseDate:a.J4.reference({IsLocalField:!0}),Feedback:a.J4.string({IsLocalField:!0}),TotalScore:a.J4.number({IsLocalField:!0}),IntegratedSavingState:a.J4.reference({IsLocalField:!0}),SavingState:a.J4.reference({IsLocalField:!0}),EmailReceiptConsent:a.J4.boolean({SourceFieldName:"emailReceiptConsent"}),SubmitLanguage:a.J4.string({SourceFieldName:"submitLanguage"}),MSRewardsData:a.J4.reference({SourceFieldName:"msRewardsData"}),FormsProData:a.J4.reference({SourceFieldName:"formsProData"})};v.Answers[0];function g(t){return s.d.getObjectMasterFromModel(t)}function p(t,n){return(0,h.q4)(t.Model.Id,n)}var b=function(t){function n(e){var i=this,o=new r.wU;return(i=t.call(this,e,{Scheduler:new d.b(n.name),MasterReady:o.promise()})||this).qi(),n.Rules.forEach((function(t){return i.addRule(t)})),o.resolve(),i}return(0,i.ZT)(n,t),Object.defineProperty(n.prototype,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ResponseId",{get:function(){return this.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Comment",{get:function(){return this.getCommentByQuestionId(null)},enumerable:!1,configurable:!0}),n.prototype.updateWithNormalizedResponse=function(t){var e=this;this.bulkEdit((function(){e.Synchronizer.onSourceDataReceived(s.d.convertToSourceData(t,n.Schema)),e.setData(t)}))},n.prototype.getAnswerByQuestionId=function(t){var n=s.d.Collection.getItemWithKeyFields(this.Model.Answers,{QuestionId:t});return n&&s.d.getObjectMasterFromModel(n)},n.prototype.getCommentByQuestionId=function(t){var n=s.d.Collection.getItemWithKeyFields(this.Model.Comments,{QuestionId:t});return n&&(0,m.I)(n)},n.prototype.setAnswerGrading=function(t,n,e){var i=this.Form.getQuestionById(t);if(i){var r=i.SubQuestionMasters;r.length>0&&(t=r[r.length-1].Model.Id);var o=this.getCommentByQuestionId(t);if(o)o.bulkEdit((function(){void 0!==n&&(o.Model.Score=n),void 0!==e&&(o.Model.Feedback=e)}));else{var a=this.getAnswerByQuestionId(t);n=null!=n?n:a.Model.Score;var u={QuestionId:t,Feedback:e,Score:n};try{s.d.Collection.addItems(this.Model.Comments,[u])}catch(i){this.getCommentByQuestionId(t)&&this.setAnswerGrading(t,n,e)}}}},n.prototype.qi=function(){var t=this;this.Vi="Idle";var n=s.d.getCollectionMasterFromModel(this.Model.Comments);(0,o.v)(n,n.Schema[0].SavingState,(function(n){t.Vi=n,t.In()})),(0,o.vG)(this),this.In()},n.prototype.zi=function(t){var n=this.getAnswerByQuestionId(t);if(n)return n;var e=s.d.Collection.addItems(this.Model.Answers,[{QuestionId:t}])[0];return s.d.getObjectMasterFromModel(e)},n.prototype.In=function(){this.Model.IntegratedSavingState=(0,o.IM)([this.Model.SavingState,this.Vi])},Object.defineProperty(n,"Rules",{get:function(){if(!n.rules){var t=n.Schema;n.rules=[{Name:"ResponseComment",InterestedFields:[t.Feedback,t.TotalScore],onChange:function(t){var n=t.Master,e=n.getCommentByQuestionId(null);e?e.bulkEdit((function(){e.Model.Feedback=n.Model.Feedback,e.Model.Score=n.Model.TotalScore})):s.d.Collection.addItems(n.Model.Comments,[{QuestionId:null,Feedback:n.Model.Feedback,Score:n.Model.TotalScore}])}},{Name:"AnswerComment",InterestedFields:[t.Answers[0].Feedback,t.Answers[0].Score,t.Answers[0].IsAutoGraded],onChange:function(t){var n=t.Master,e=n.Model.Answers,i=function(t){t.IsAutoGraded||n.setAnswerGrading(t.QuestionId,t.Score,t.Feedback)};t.SubChanges.filter((function(t){return t.Master.Model===e})).forEach((function(t){t.AddedModels.forEach(i),t.SubChanges.forEach((function(t){return i(t.Master.Model)}))}))}},{Name:"ApplyCommentChange",InterestedFields:[t.Comments],onChange:function(t){var n=t.Master,e=n.Model.Comments,i=function(t){var e=t.QuestionId;if(e){var i=n.zi(e);i.bulkEdit((function(){i.Model.Feedback=t.Feedback,i.Model.Score=t.Score,i.Model.IsAutoGraded=!1}))}else n.bulkEdit((function(){n.Model.Feedback=t.Feedback,n.Model.TotalScore=t.Score}))};t.SubChanges.filter((function(t){return t.Master.Model===e})).forEach((function(t){t.AddedModels.forEach(i),t.SubChanges.forEach((function(t){return i(t.Master.Model)}))}))}}],n.rules=n.rules.concat(n.getRulesForSyncBetweenDateFields(t.StartDate,t.StartDateAsString),n.getRulesForSyncBetweenDateFields(t.SubmitDate,t.SubmitDateAsString),n.getRulesForSyncBetweenDateFields(t.ReleaseDate,t.ReleaseDateAsString))}return n.rules},enumerable:!1,configurable:!0}),n.getRulesForSyncBetweenDateFields=function(t,n){var e=s.d.getFieldSchemaInfo(t).Name,i=s.d.getFieldSchemaInfo(n).Name;return[{Name:"update ".concat(e),InterestedFields:[n],onChange:function(t){var n=t.Master.Model;n[e]=new Date(n[i])}},{Name:"update ".concat(i),InterestedFields:[t],onChange:function(t){var n=t.Master.Model;n[i]=n[e].toISOString()}}]},n}(s.d.createObjectMasterClass("Response",v,(function(t,n){return new f(t,n)})))},71683:function(t,n,e){"use strict";e.d(n,{X:function(){return s}});var i=e(12611),r=e(25366),o=e(53315),s=function(){function t(t){this.Qi=[],this.Ui=this.Ui.bind(this),this.$i=t}return t.getBranchedSections=function(n,e){for(var s=[],a=[],u=0,c=function(){var c=n[u];if(i.findIndex(s,(function(t){return t.Section===c.Section}))>=0)return"break";for(var l=[],f=void 0,h=c.TopQuestionMasters[0],d=function(){if(i.include(a,h))return"break";a.push(h),l.push(h);var t=e(h,c.TopQuestionMasters),s=t.TargetElement;s instanceof o.MF?h=s:(s&&r.H.isSection(s.Model.Type)?f=i.findIndex(n,(function(t){return t.Section===s})):"End"===t.Type&&(f=-1),h=null)};h;){if("break"===d())break}s.push({Section:c.Section,TopQuestionMasters:l}),u=void 0!==f?f:t.getNextSectionFromSection(c,n)};u<=n.length-1&&u>=0;){if("break"===c())break}return s},t.prototype.calculateQuestionRuntimeList=function(n){var e=[],i=this.ji(n);this.formRuntimeMaster.IsDisableBranching||(i=t.getBranchedSections(i,this.Ui));var r=this.Qi,o=this.Ki(i,e);if(this.$i||t.isBranchingResultChanged(r,o)){this.Qi=o;var s=this.formRuntimeMaster.Model;this.formRuntimeMaster.bulkEdit((function(){s.QuestionRuntimeMasters=e,s.BranchChangeVersion=(s.BranchChangeVersion||0)+1}))}},t.prototype.hasPrevSection=function(){return this.Ji()>0},t.prototype.gotoPrevSection=function(){var t=this.Ji();if(t>0){var n=this.Qi[t-1];this.formRuntimeMaster.Model.RuntimeSectionId=n.Section&&n.Section.Model.Id}},t.prototype.hasNextSection=function(){return this.Ji()<this.Qi.length-1},t.prototype.gotoNextSection=function(){var t=this.Zi();t&&(this.formRuntimeMaster.Model.RuntimeSectionId=t)},t.prototype.getAllSections=function(){return this.Qi},t.prototype.getCurrentSection=function(){return this.Xi(this.formRuntimeMaster.Model.RuntimeSectionId)},t.prototype.isFirstPage=function(){var t=this.getCurrentSection();return 0===this.Qi.indexOf(t)},t.isBranchingResultChanged=function(t,n){if(t.length!==n.length)return!0;for(var e=0;e<t.length;e++){if(t[e].Section!==n[e].Section||t[e].TopQuestionMasters.length!==n[e].TopQuestionMasters.length)return!0;for(var i=0;i<t[e].TopQuestionMasters.length;i++)if(t[e].TopQuestionMasters[i]!==n[e].TopQuestionMasters[i])return!0}return!1},t.prototype.Ui=function(t,n){var e=this.formRuntimeMaster.getOrCreateQuestionRuntime(t),i=e.Model.BranchingType,r=e.Model.BranchedElement;return r instanceof o.MF&&-1===n.indexOf(r)&&(r=n[n.indexOf(t)+1]),{TargetElement:r,Type:i}},t.prototype.Ki=function(t,n){var e=this;return t.map((function(t){return{Section:t.Section,TopQuestionMasters:t.TopQuestionMasters.map((function(t){var i=e.formRuntimeMaster.getOrCreateQuestionRuntime(t);return n.push(i),t.SubQuestionMasters.forEach((function(t){var i=e.formRuntimeMaster.getOrCreateQuestionRuntime(t);n.push(i)})),i}))}}))},t.getNextSectionFromSection=function(t,n){var e=t.Section,r=e&&e.Model.BranchInfo;if(r){if(r.ToTheEnd)return-1;var o=i.findIndex(n,(function(t){return t.Section&&t.Section.Model.Id===r.TargetQuestionId}));if(o>=0)return o}return i.findIndex(n,t)+1},t.prototype.Xi=function(t){var n=this,e=i.find(this.Qi,(function(n,e){return t?n.Section&&t===n.Section.Model.Id:0===e}));return t&&!e&&(e=this.Qi[0],setTimeout((function(){n.formRuntimeMaster.Model.RuntimeSectionId=null}))),e},t.prototype.Ji=function(){return i.indexOf(this.Qi,this.getCurrentSection())},t.prototype.ji=function(t){var n=this.formRuntimeMaster.Form;return n.hasSection()?n.FormElementManager.getSectionNodes():[{TopQuestionMasters:t.filter((function(t){return!t.Model.GroupId}))}]},t.prototype.Zi=function(){var t=this.Ji();if(t<this.Qi.length-1&&t>=0){var n=this.Qi[t+1];return n.Section&&n.Section.Model.Id}},t}()},29482:function(t,n,e){"use strict";e.d(n,{l:function(){return v}});var i=e(59312),r=e(12611),o=e(26203),s=e(39923),a=e(73252),u=e(13886),c=e(41350),l=(e(64290),e(67661)),f=e(71683);function h(t){var n=new f.X((0,a.M0)());return n.formRuntimeMaster=t,n}var d=e(22530),m={QuestionRuntimeMasters:s.J4.collectionOf(s.J4.reference()),RuntimeSectionId:s.J4.string(),UploadingFileCount:s.J4.number(),BranchChangeVersion:s.J4.number()},v=function(t){function n(n,e){var i=t.call(this)||this;return i.nr={},i.ir=new c.Y,i.rr=function(){return i.ir.trigger()},i.sr=function(t){return i.replaceAnswerTagsWithValue(t.Master)},i.lr=function(t){return i.dr(t)},i.vr=function(){return i.dr()},i.gr=function(){return i.pr.callOnceLater()},i.pr=new c.u((function(){return i.br()}),0),i.Je=n,i.yr=h(i),e=e||{},i.wr=e.disableShuffle,i.Sr=e.disableBranching,i.dr(),i.pr.callImmediately(),i.Model.UploadingFileCount=0,o.d.getCollectionMasterFromModel(n.Model.Questions).observe(i.lr),n.observe(i.vr,[l.x.Schema.HasValidBranching,l.x.Schema.Settings.ShuffleQuestionOrder]),i}return(0,i.ZT)(n,t),Object.defineProperty(n.prototype,"Form",{get:function(){return this.Je},enumerable:!1,configurable:!0}),n.prototype.ElementManager=function(){return this.yr},Object.defineProperty(n.prototype,"IsDisableBranching",{get:function(){return this.Sr},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Answers",{get:function(){return o.d.convertToArray(this.Model.QuestionRuntimeMasters).filter((function(t){return t.Question.hasAnswer()})).map((function(t){return t.getAnswerEntity()}))},set:function(t){var n=this,e={};r.forEach(t,(function(t){return e[t.QuestionId]=t.Answer})),this.bulkEdit((function(){n.Je.FormElementManager.QuestionMasters.map((function(t){return n.getOrCreateQuestionRuntime(t)})).forEach((function(t){t.Model.Answer=e[t.Question.Model.Id]}))})),this.pr.flush()},enumerable:!1,configurable:!0}),n.prototype.TopQuestionRuntimeMasters=function(){return o.d.convertToArray(this.Model.QuestionRuntimeMasters).filter((function(t){return!t.Question.Model.GroupId}))},n.prototype.CurrentRuleManager=function(){return!1},n.prototype.isDefaultAnswer=function(){var t=this.Je.getDefaultResponse();return o.d.convertToArray(this.Model.QuestionRuntimeMasters).every((function(n){var e=n.Question.Model.Id;return t[e]===n.Model.Answer}))},n.prototype.updateWithResponse=function(t){var n=this,e={};t&&t.Answers&&r.forEach(t.Answers,(function(t){return e[t.QuestionId]=t})),this.bulkEdit((function(){n.Je.FormElementManager.QuestionMasters.map((function(t){return n.getOrCreateQuestionRuntime(t)})).forEach((function(t){var n=t.Question.Model.Id,i=e[n];t.bulkEdit((function(){t.Model.Answer=i&&i.Answer,t.Model.AnswerEntity=i}))}))})),this.dr()},n.prototype.setQuizResults=function(t){var n=this;t.forEach((function(t){var e=n.nr[t.id];e&&(e.Model.QuizResult={IsAnswerCorrect:t.isAnswerCorrect,AnswerHints:t.answerHints,IsAnswerKeys:t.answerKeys,Choices:r.map(e.Question.Model.Choices,(function(t){return t.Description})),GradingBasis:t.gradingBasis})}))},n.prototype.clearQuizResult=function(){for(var t in this.nr)this.nr[t].Model.QuizResult=void 0},n.prototype.resetQuestions=function(){},n.prototype.getQuestionResponseFromQueryString=function(){},n.prototype.calculateQuizResultFromModel=function(){o.d.convertToArray(this.Model.QuestionRuntimeMasters).forEach((function(t){return t.calculateQuizResultFromModel()}))},n.prototype.formsProQuestionVisiblityCheck=function(t){0},n.prototype.setVisibility=function(t){0},n.prototype.isContainingSectionVisible=function(t){},n.prototype.formsProSectionVisiblityCheck=function(t){0},n.prototype.getQuestionsWithWrongAnswer=function(t){if(t.length<=0)return[];var n=this.TopQuestionRuntimeMasters(),e=r.findIndex(n,(function(n){return n.Question.Model.Id===t[0].Question.Model.Id}))+1;return t.map((function(t,n){return t.verifyAnswer()?-1:n+e})).filter((function(t){return t>0}))},n.prototype.getOrCreateQuestionRuntimeById=function(t){var n=this.Je.getQuestionById(t);return n&&this.getOrCreateQuestionRuntime(n)},n.prototype.observeAnswerChange=function(t){this.ir.register(t)},n.prototype.unobserveAnswerChange=function(t){this.ir.unregister(t)},n.prototype.release=function(){var t=function(t){var e=n.nr[t];e.unobserve(n.gr),e.unobserve(n.rr),e.release()},n=this;for(var e in this.nr)t(e);o.d.getCollectionMasterFromModel(this.Je.Model.Questions).unobserve(this.lr),this.Je.unobserve(this.vr)},n.prototype.getOrCreateQuestionRuntime=function(t){var n=t.Model.Id;return this.nr[n]||(this.nr[n]=this.Nr(t)),this.nr[n]},n.prototype.Nr=function(t){var n=new d.r(t,this);return n.observe(this.gr,[d.r.Schema.BranchedElement,d.r.Schema.BranchingType]),n.observe(this.rr,[d.r.Schema.Answer]),n},n.prototype.dr=function(t){var n,e=this,o=this.Je.Model.Settings,s=this.Je.FormElementManager;this.Cr=s.TopQuestionMasters;var a=this.Form.hasSection();if(!a&&!this.wr&&!this.Je.Model.HasValidBranching&&o.ShuffleQuestionOrder)if(o.ShuffleAllQuestions||null==o.ShuffleAllQuestions)this.Cr=r.shuffle(this.Cr);else if((0,u.U)(o.LockGivenQuestionsStartDisplayOrder)&&(0,u.U)(o.LockGivenQuestionsEndDisplayOrder)){var c=o.LockGivenQuestionsStartDisplayOrder-1,l=o.LockGivenQuestionsEndDisplayOrder-1,f=this.Cr.splice(c,l-c+1);this.Cr=r.shuffle(this.Cr),(n=this.Cr).splice.apply(n,(0,i.ev)([c,0],f,!1))}a?s.getSectionNodes().forEach((function(t){return e.Ir(t.TopQuestionMasters)})):this.Ir(this.Cr),t&&(t.AddedModels.length||t.RemovedModels.length)&&this.pr.callOnceLater()},n.prototype.Ir=function(t){var n=this;t.forEach((function(e,i){var r=n.getOrCreateQuestionRuntime(e);r.bulkEdit((function(n){n.NextQuestionInOrder=t[i+1],n.NextQuestionInitialized=!0})),"Specified"===r.Model.BranchingType&&!r.Model.BranchedElement&&(0,a.M0)()&&r.updateBranchedQuestion(),e.SubQuestionMasters.forEach((function(t){return n.getOrCreateQuestionRuntime(t)}))}))},n.prototype.ensureProRuleManager=function(t){this.Tr=FormsPro.getRuleManager(this.Je,this.Model.QuestionRuntimeMasters,this,t,this.Answers)},n.prototype.Fr=function(t,n,e){},n.prototype.br=function(){this.yr.calculateQuestionRuntimeList(this.Cr)},n.prototype.calcProgressBarInfo=function(){return{showProgressBar:this.Form.isProgressBarVisible(),currentPageNumber:this.Pr()+1,totalPageNumber:this.Form.totalSectionCount()}},n.prototype.Pr=function(){var t=this.Model.RuntimeSectionId;if(!t)return 0;var n=this.Form.FormElementManager,e=n.getDescriptiveElementMasterById(t);return e?n.SectionMasters.indexOf(e)+(n.HeaderTopQuestionMasters.length>0?1:0):0},n.prototype.replaceAnswerTagsWithValue=function(t){},n.prototype.clearFileUploadAnswers=function(){this.Model.UploadingFileCount=0;var t=this.Model.QuestionRuntimeMasters;o.d.convertToArray(t).filter((function(t){return"Question.FileUpload"===t.Question.Model.Type})).forEach((function(t){return t.Model.Answer=void 0}))},n}(o.d.createObjectMasterClass("FormRuntime",m))},22530:function(t,n,e){"use strict";e.d(n,{r:function(){return l}});var i=e(59312),r=e(64459),o=e(26203),s=e(39923),a=e(64290),u=(e(31442),e(53315)),c={Answer:s.J4.reference(),AnswerEntity:s.J4.reference(),BranchedElement:s.J4.reference(),BranchingType:s.J4.string(),NextQuestionInOrder:s.J4.reference(),NextQuestionInitialized:s.J4.boolean(),QuizResult:s.J4.reference(),Visible:s.J4.reference(),FormsProOrdinal:s.J4.reference(),FormsProRuntimeTitle:s.J4.reference(),FormsProRuntimeSubtitle:s.J4.reference(),InitialFormsProLocalizedRuntimeTitle:s.J4.reference(),InitialFormsProLocalizedRuntimeSubtitle:s.J4.reference(),SelectedChoice:s.J4.reference(),CDSFileResponseId:s.J4.reference(),CDSFileId:s.J4.reference(),HasSensitiveInfo:s.J4.boolean()},l=function(t){function n(n,e){var i=t.call(this)||this;return i.Dr=function(){return i.updateBranchedQuestion()},i.ve=n,i.ve.observe(i.Dr),i.Lr=e,(0,a.hl)((function(){i.addRule({Name:"UpdateBranchedQuestion",onChange:function(t){return i.updateBranchedQuestion()}})})),i}return(0,i.ZT)(n,t),Object.defineProperty(n.prototype,"Question",{get:function(){return this.ve},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"SubQuestions",{get:function(){return this.Question.SubQuestionMasters},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"SubQuestionRuntimeMasters",{get:function(){var t=this;return this.SubQuestions.map((function(n){return t.getSubQuestionRuntimeById(n.Model.Id)}))},enumerable:!1,configurable:!0}),n.prototype.getSubQuestionRuntimeById=function(t){return this.Lr?this.Lr.getOrCreateQuestionRuntimeById(t):null},n.prototype.verifyAnswer=function(){if(0===this.SubQuestionRuntimeMasters.length){if(this.Question.Model.IsMathQuiz){var t=(0,r.d)(this.Model.Answer||"{}"),n=null==t.Answer?this.Model.Answer:t.Answer;return this.Question.verify(n)===u.ej.Success}return this.Question.verify(this.Model.Answer)===u.ej.Success}return this.SubQuestionRuntimeMasters.every((function(t){return t.Question.verify(t.Model.Answer)===u.ej.Success}))},n.prototype.release=function(){this.ve.unobserve(this.Dr)},n.prototype.getAnswerEntity=function(){return{Answer:this.Question.getNormalizedAnswer(this.Model.Answer),QuestionId:this.Question.Model.Id}},n.prototype.calculateQuizResultFromModel=function(){0===this.SubQuestionRuntimeMasters.length?this.Model.QuizResult=this.Question.createQuizResult(this.Model.Answer):this.Model.QuizResult={IsAnswerCorrect:!1}},n.prototype.getScore=function(){var t=this.Model.AnswerEntity,n=t&&t.Score;return null!=n?n:this.Question.autoGradeWithQuizResult(this.Model.Answer,this.Model.QuizResult)},n.prototype.updateBranchedQuestion=function(){if(!this.Question.Deleted){var t=this.Model,n=this.Question.getBranchedResult(t.Answer,t.NextQuestionInOrder);this.bulkEdit((function(t){t.BranchedElement=n.TargetElement,t.BranchingType=n.Type}))}},n.prototype.Ar=function(){0},n.prototype.Er=function(t,n){},n}(o.d.createObjectMasterClass("QuestionRuntime",c))},19976:function(t,n,e){"use strict";e.d(n,{a:function(){return o}});var i=e(55411),r=e(72467);function o(){return(0,i.sv)()?(0,r.uq)():(0,r.f5)()}},41420:function(t,n,e){"use strict";e.d(n,{NW:function(){return i},UE:function(){return r}});var i=function(t){return t?function(t){return Object.keys(t).reduce((function(n,e){return n[e.toLowerCase()]=t[e],n}),{})}(t.substring(1).split("&").reduce((function(t,n){var e=n.split("="),i=e[0],r=e[1];return r&&(t[i.toLowerCase()]=decodeURIComponent(r)),t}),{})):{}};function r(){return i(location.search).subpage}},60504:function(t,n,e){"use strict";e.d(n,{a:function(){return I}});e(61533);var i,r=e(12611),o=e(94290),s=e(9947),a=e(72467),u=e(25664),c=e(61018),l=e(67661),f=e(31442),h=/^({?)((\d|[a-fA-F]){8}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){12})(}?)$/,d=/^([a-fA-F\d]{8})([a-fA-F\d]{4})([a-fA-F\d]{4})([a-fA-F\d]{4})([a-fA-F\d]{12})$/,m=function(){function t(n,e){if(void 0===e&&(e=!1),e)this.guid=n;else{var i=t._formatGuidString(n);if(!i)throw new Error("".concat(n," is not a valid Guid value."));this.guid=i}Object.freeze(this)}return t.externalGuid=function(n){return n?"{"+n.guid.toUpperCase()+"}":t.EMPTYSTRING},t.fromExternalGuid=function(n){return n?new t(n.replace(/[\{\}]/gi,"")):t.EMPTY},t.validate=function(t){return null!=t&&null!==h.exec(t)},t.toString=function(t){return t?t.guid:null},t.tryParse=function(n){return t.tryParseOrNull(n)||t.EMPTY},t.tryParseOrNull=function(n){var e=t._formatGuidString(n);return e?new t(e,!0):null},t.parse=function(n){return new t(n)},t._formatGuidString=function(t){if(!t)return null;t=t.toLowerCase();var n=h.exec(t);if(n)return n[1].length!==n[8].length?null:n[2];var e=d.exec(t);return e?e.filter((function(t,n){return n>0})).join("-"):null},t.equals=function(n,e){return null==n||null==e?n===e:t.toString(n)===t.toString(e)},t.isNullOrEmpty=function(n){return!n||t.equals(n,t.EMPTY)},t.newGuid=function(){for(var n="0123456789abcdef",e="",i=0;i<36;i++)if(14===i)e+="4";else if(8===i||13===i||18===i||23===i)e+="-";else if(19===i){var r=Math.floor(16*Math.random());e+=n.substr(3&r|8,1)}else e+=n.substr(Math.floor(16*Math.random()),1);return new t(e,!0)},t.EMPTYGUIDSTRING="00000000-0000-0000-0000-000000000000",t.EMPTY=new t(t.EMPTYGUIDSTRING,!0),t.EMPTYSTRING="",t}();FormsPro.getCdsManager=function(){return i||(i=new v)};var v=function(){function t(){var t=this;this._r=["NA","SAM","CAN","EMEA","APAC","OCE","JPN","IND","GCC","TIP","GBR","FRA"];var n=(0,a.f5)(),e=n.Model,i=!0;if(e.DefaultCdsId="",e.DefaultCdsUrl="",e.DefaultCdsInfoLoadState="Loading",null==e.FormId){var c=(0,o.HQ)(),h=(0,o.W6)();m.isNullOrEmpty(m.tryParse(c))&&(c=null),h&&!r.contains(this._r,h.toUpperCase())&&(h=null),c&&h&&(e.CdsInfoAvailableInUrl=!0,(0,s.k0)().lastUsedEnv&&!r.isEmpty((0,s.k0)().lastUsedEnv)&&(e.LastUsedEnv=(0,s.k0)().lastUsedEnv),this.setCurrentCds(c,h),i=!1);var d=(0,u.A8)(location.search,"cdsId");window.history.replaceState(null,null,window.location.pathname+d);var v=(0,u.A8)(location.search,"cdsRegion");window.history.replaceState(null,null,window.location.pathname+v)}e.CdsInfoAvailableInUrl||null==e.FormId&&(e.CurrentProject&&null!==e.CurrentProject.BusinessCdsId?(this.setCurrentCds(e.CurrentProject.BusinessCdsId,e.CurrentProject.BusinessCdsRegion),i=!1):(0,s.k0)().lastUsedEnv&&(0,s.k0)().lastUsedEnv.CdsId&&(this.setCurrentCds((0,s.k0)().lastUsedEnv.CdsId,(0,s.k0)().lastUsedEnv.Region),i=!1)),(0,f.JG)({type:"MFPUI_GetDefaultCdsInfoStarted",eventInfo:{tenantId:(0,s.k0)().userInfo.TenantId,Geo:null!=document.getElementById("Geo")?document.getElementById("Geo").value:"",Component:"CdsManager"}}),FormsPro.MFPDataProviderAdapter.GetDefaultCdsInfo().then((function(r){if(e.DefaultCdsInfoLoadState="Loaded",null!=r){(0,f.JG)({type:"MFPUI_GetDefaultCdsInfoCompleted",eventInfo:{tenantId:(0,s.k0)().userInfo.TenantId,Geo:null!=document.getElementById("Geo")?document.getElementById("Geo").value:"",Component:"CdsManager"}}),e.DefaultCdsId=r.cdsId,e.DefaultCdsUrl=r.cdsUrl,e.TenantCountryCode=r.TenantCountryCode;var o={cdsName:"Default",cdsUniqueName:"Default",cdsUrl:e.DefaultCdsUrl,cdsId:e.DefaultCdsId,regionName:t.mapRegionFromSuffix(e.DefaultCdsUrl),environmentId:"",environmentName:"Default"};if(0==e.CdsList.filter((function(t){return t.cdsId===e.DefaultCdsId})).length&&(e.CdsList=e.CdsList.concat(o)),e.CdsList=e.CdsList.sort((function(t,n){return t.environmentName.toLowerCase().localeCompare(n.environmentName.toLowerCase())})),null==e.FormId)i&&t.switchToDefaultCds(r.CDSProvisioningState,r.CDSProvisionigFailureReason);else{var a=n.Model.FormMaster;a.ensureFieldsReady([l.x.Schema.BusinessCdsId,l.x.Schema.BusinessCdsRegion]).then((function(){t.setCurrentCds(a.Model.BusinessCdsId,a.Model.BusinessCdsRegion)})).catch((function(){t.switchToDefaultCds(r.CDSProvisioningState,r.CDSProvisionigFailureReason)}))}}})).catch((function(t){(0,f.JG)({type:"MFPUI_GetDefaultCdsInfoFailed",eventInfo:{tenantId:(0,s.k0)().userInfo.TenantId,Geo:null!=document.getElementById("Geo")?document.getElementById("Geo").value:"",Component:"CdsManager",type:"unexpected"}}),e.DefaultCdsInfoLoadState="Loaded",e.ValidationChecked="UnknownError",e.CriticalError=t}))}return t.prototype.getFormList=function(){return(0,a.f5)().Model.FormList},t.prototype.populateCdsList=function(){var t=(0,a.f5)(),n=t.Model;return n.EnvironmentListLoadState="Loading",FormsPro.MFPDataProviderAdapter.GetEnvironmentList().then((function(n){t.bulkEdit((function(t){if(null!=n){t.EnvironmentListLoadState="Loaded";var e=[].concat(t.CdsList);t.CdsList=n.environmentInstances,r.forEach(e,(function(n){0==t.CdsList.filter((function(t){return t.cdsId===n.cdsId})).length&&(t.CdsList=t.CdsList.concat(n))})),t.CdsList=t.CdsList.sort((function(t,n){if(null!=t.environmentName)return t.environmentName.toLowerCase().localeCompare(n.environmentName.toLowerCase())}))}else t.EnvironmentListLoadState="Failed"}))})).catch((function(t){return console.log("Fetch environment list failed due to some error."),n.EnvironmentListLoadState="Failed",t}))},t.prototype.setCurrentCds=function(t,n){var e=this,i=(0,a.f5)();if(i.Model.SelectedCdsId!==t&&(i.Model.CriticalError=void 0,i.bulkEdit((function(i){i.ValidationChecked="Pending",i.FormList=[],i.FormListLoadState="Loading",console.log("SetCurrentCDS States F{0},D{1},A{2},V{3},SID{4},DID{5}",i.FormListLoadState,i.DefaultCdsInfoLoadState,i.AllFormListLoadState,i.ValidationChecked,i.SelectedCdsId,i.DefaultCdsId),i.SelectedCdsId=t,i.SelectedCdsRegion=n,i.SelectedCdsUrl=e.getCurrentCdsUrl(),null==i.SelectedCdsId||""==i.SelectedCdsId||i.SelectedCdsId===i.DefaultCdsId?i.IsDefaultCds=!0:i.IsDefaultCds=!1,(0,s.k0)().lastUsedEnv&&i.SelectedCdsId==(0,s.k0)().lastUsedEnv.CdsId&&(i.IsDefaultCds=(0,s.k0)().lastUsedEnv.IsDefaultCDS);var r=i.CdsValidationMap[i.SelectedCdsId];null==r?FormsPro.MFPDataProviderAdapter.isValidMfpUser(i.IsDefaultCds,i.SelectedCdsId,i.SelectedCdsUrl,!0,i.SelectedCdsRegion).then((function(t){i.CdsValidationMap[i.SelectedCdsId]=i.ValidationChecked,("ValidationPassed"===(r=i.ValidationChecked)||i.IsDefaultCds)&&FormsPro.MFPDataProviderAdapter.filterFormsMultiCds()})):(i.ValidationChecked=r,("ValidationPassed"===r||i.IsDefaultCds)&&FormsPro.MFPDataProviderAdapter.filterFormsMultiCds())})),(0,s.k0)().lastUsedEnv.CdsId!=t)){var r=this.getCurrentEnvName();r?this.Br(t,n,r,t===i.Model.DefaultCdsId):i.observe((function(){e.Br(t,n,e.getCurrentEnvName(),t===i.Model.DefaultCdsId)}),[i.Schema.CdsList])}},t.prototype.resetLastUsedEnv=function(){var t=this,n=(0,a.f5)();if(n.Model.LastUsedEnv&&!r.isEmpty(n.Model.LastUsedEnv)){c.VY.getInstance().createDataProvider().updateLastUsedEnv((0,s.k0)().userInfo.TenantId,(0,s.k0)().userInfo.UserId,JSON.stringify(n.Model.LastUsedEnv))}else{var e=n.Model.DefaultCdsId,i=n.Model.DefaultCdsUrl;e&&i?this.Hr(e,i,!0):n.observe((function(){t.Hr(n.Model.DefaultCdsId,n.Model.DefaultCdsUrl,!0)}),[n.Schema.DefaultCdsId,n.Schema.DefaultCdsUrl])}},t.prototype.Hr=function(t,n,e){if(t&&n){var i=this.getCurrentRegion(t,n),r=this.getCurrentEnvName(t);if(i){var o={CdsId:t,Region:i,EnvironmentName:r,IsDefaultCDS:e};c.VY.getInstance().createDataProvider().updateLastUsedEnv((0,s.k0)().userInfo.TenantId,(0,s.k0)().userInfo.UserId,JSON.stringify(o))}}},t.prototype.Br=function(t,n,e,i){var r={CdsId:t,Region:n||this.getCurrentRegion(),EnvironmentName:e,IsDefaultCDS:i};c.VY.getInstance().createDataProvider().updateLastUsedEnv((0,s.k0)().userInfo.TenantId,(0,s.k0)().userInfo.UserId,JSON.stringify(r)).then((function(){(0,s.cm)({lastUsedEnv:r})}))},t.prototype.getCurrentCdsId=function(){var t=(0,a.f5)().Model;return t.SelectedCdsId?t.SelectedCdsId:""},t.prototype.getIsDefaultCds=function(){return(0,a.f5)().Model.IsDefaultCds},t.prototype.getCurrentCdsUrl=function(){var t=(0,a.f5)().Model;if(!(t.CdsList.length>0))return t.SelectedCdsUrl;var n=t.CdsList.filter((function(n){return n.cdsId===t.SelectedCdsId}));return n.length>0?n[0].cdsUrl:void 0},t.prototype.getCurrentCdsUniqueName=function(){var t=(0,a.f5)().Model;if(!(t.CdsList.length>0))return"";var n=t.CdsList.filter((function(n){return n.cdsId===t.SelectedCdsId}));return n.length>0?n[0].cdsUniqueName:void 0},t.prototype.getCurrentEnvironmentId=function(){var t=(0,a.f5)().Model;if(!(t.CdsList.length>0))return"";var n=t.CdsList.filter((function(n){return n.cdsId===t.SelectedCdsId}));return n.length>0?n[0].environmentId:void 0},t.prototype.getCurrentRegion=function(t,n){var e=(0,a.f5)().Model,i=null!=t?t:e.SelectedCdsId;if(!(e.CdsList.length>0)){var r=null!=n?n:this.getCurrentCdsUrl();return this.mapRegionFromSuffix(r)}var o=e.CdsList.filter((function(t){return t.cdsId===i}));if(o.length>0)return o[0].regionName},t.prototype.getCurrentEnvName=function(t){var n=(0,a.f5)().Model,e=null!=t?t:n.SelectedCdsId;if(!(n.CdsList.length>0))return"";var i=n.CdsList.filter((function(t){return t.cdsId===e}));return i.length>0?i[0].environmentName:void 0},t.prototype.mapRegionFromSuffix=function(t){if(!t)return t;var n=t.split("."),e="";if(n.length>=4)switch(n[1].toUpperCase()){case"CRM":case"CRM9":e="NA";break;case"CRM2":e="SAM";break;case"CRM3":e="CAN";break;case"CRM4":e="EMEA";break;case"CRM5":e="APAC";break;case"CRM6":e="OCE";break;case"CRM7":e="JPN";break;case"CRM8":e="IND";break;case"CRM10":e="TIP";break;case"CRM11":e="GBR";break;case"CRM12":e="FRA";break;case"CRM15":e="UAE";break;case"CRM16":e="GER";break;case"CRM17":e="CHE"}return e},t.prototype.getCdsList=function(){return(0,a.f5)().Model.CdsList},t.prototype.isProvisioningFailed=function(t,n){var e=(0,a.f5)().Model,i=t.toLowerCase(),r=n.toLowerCase();return"failedprovisioning"==i&&"none"!=r&&("cds1exception"==r?(e.ValidationChecked="CDS10Failure",!0):"AADApplicationDisabled"==r?(e.ValidationChecked="AADApplicationDisabled",!0):(e.ValidationChecked="UnknownError",!0))},t.prototype.switchToDefaultCds=function(t,n){var e=this,i=(0,a.f5)();i.Model.IsDefaultCds=!0,i.bulkEdit((function(i){i.FormListLoadState="Loading",i.ValidationChecked="Pending",console.log("switchToDefaultCds States F{0},D{1},A{2},V{3},SID{4},DID{5}",i.FormListLoadState,i.DefaultCdsInfoLoadState,i.AllFormListLoadState,i.ValidationChecked,i.SelectedCdsId,i.DefaultCdsId),i.SelectedCdsId=i.DefaultCdsId,i.SelectedCdsUrl=i.DefaultCdsUrl,FormsPro.MFPDataProviderAdapter.filterFormsMultiCds(),e.isProvisioningFailed(t,n)||((0,f.JG)({type:"MFPUI_IsValidMFPUserStarted",eventInfo:{tenantId:(0,s.k0)().userInfo.TenantId,Geo:null!=document.getElementById("Geo")?document.getElementById("Geo").value:"",Component:"CdsManager"}}),FormsPro.MFPDataProviderAdapter.isValidMfpUser(i.IsDefaultCds,i.SelectedCdsId,i.SelectedCdsUrl,!0).then((function(t){t&&(0,f.JG)({type:"MFPUI_IsValidMFPUserCompleted",eventInfo:{tenantId:(0,s.k0)().userInfo.TenantId,Geo:null!=document.getElementById("Geo")?document.getElementById("Geo").value:"",Component:"CdsManager"}}),i.CdsValidationMap[i.SelectedCdsId]=i.ValidationChecked,"ValidationPassed"===i.ValidationChecked&&FormsPro.MFPDataProviderAdapter.filterFormsMultiCds()}),(function(){(0,f.JG)({type:"MFPUI_IsValidMFPUserFailed",eventInfo:{tenantId:(0,s.k0)().userInfo.TenantId,Geo:null!=document.getElementById("Geo")?document.getElementById("Geo").value:"",Component:"CdsManager",type:"unexpected"}})})))})),this.Br(i.Model.DefaultCdsId,this.getCurrentRegion(),this.getCurrentEnvName(),!0)},t.prototype.getCDSProvisioningStatus=function(){return FormsPro.MFPDataProviderAdapter.fetchProvisioningStatus().then((function(t){return t.then((function(t){return t}))}))},t}(),g=e(26203),p=e(59312),b=function(t){function n(n){var e=t.call(this,window.FormPrefetchCache.tenantSettingsCache)||this;return e.Ot=n,e.init(),e}return(0,p.ZT)(n,t),n.prototype.onPrefetchSucceed=function(){try{var t=JSON.parse(this.cache.data);this.prefetchResolve(t)}catch(t){this.fallBackToNormalBoot()}},n.prototype.onPrefetchFaied=function(){this.fallBackToNormalBoot()},n.prototype.fallBackToNormalBoot=function(){var t=this;this.Ot.getFormsTenantSettings().then((function(n){return t.prefetchResolve(n)})).catch((function(n){return t.prefetchReject(n)}))},n}(e(24821).f),y=e(87941),w=e(37076),S=e(48186),N=e(51586),C=e(19976),I=(e(64290),function(){function t(){this.createForm=this.createForm.bind(this)}return t.getFormsTenantSettings=function(t){var n=c.VY.getInstance().createDataProvider();return(!t&&(0,s.k0)().prefetchEnabled&&window.FormPrefetchCache?new b(n).getPromise():n.getFormsTenantSettings()).then((function(t){(0,C.a)().Model.FormsTenantSettings=t}),(function(t){(0,f.zU)("TenentSettingsGetFailure",t)}))},t.copyFormBySharingLink=function(t,n){var e=(0,w.kc)(t);return c.VY.getInstance().createDataProvider(2,e.OrgId,e.OwnerId).copyFormBySharingLink(t,n).then((function(t){var n={Id:t.id};return(0,N.jg)(n,!1,!1)}))},t.createFormByDefinition=function(t){var n=(0,s.k0)().userInfo;return c.VY.getInstance().createDataProvider(2,n.TenantId,n.UserId).createFormByDefinition(t)},t.updateOrCreateFormMaster=function(t,n,e){var i;void 0===n&&(n=!1),void 0===e&&(e=!1);var a=t.Id&&(0,N.OM)(t.Id);if(a){var u=g.d.convertToSourceData(t,l.x.Schema);return a.Synchronizer.onSourceDataReceived(u),a}return t.Id||(t=r.clone(t),(0,S.l)(t.ProgressBarEnabled)&&(t.ProgressBarEnabled="false"),n?(t.XlWorkbookId=t.XlWorkbookId||(0,y.jI)(n,null===(i=t.Settings)||void 0===i?void 0:i.IsQuizMode),t.OwnerId=t.OwnerId||(0,o.av)(),t.OwnerTenantId=t.OwnerTenantId||(0,o.jM)()):(t.OwnerId=t.OwnerId||(0,s.k0)().userInfo.UserId,t.OwnerTenantId=(0,s.k0)().userInfo.TenantId)),(0,N.jg)(t,n,e)},t.prototype.createForm=function(n,e){return t.updateOrCreateFormMaster(n,e)},t}())},48333:function(t,n,e){"use strict";e.d(n,{Q:function(){return s},o:function(){return r}});var i=e(12611);function r(t,n,e){for(var r=t,s=o(t);i.contains(e,r);)r=n.format(s.BaseName,++s.Count);return r}function o(t){var n=t+" ",e=1,i="",r=t.lastIndexOf("(");return t&&")"===t.slice(-1)&&r>=0&&parseInt(t.slice(r+1,t.length-1))&&(i=t.slice(r+1,t.length-1),e=parseInt(i),n=t.slice(0,r)),{BaseName:n,Count:e,CountStr:i}}function s(t,n){var e=t.copyTitle,i=t.copyRichTitle,r=t.newTitle,s=r;if(!i)return{newTitle:r,newRichTitle:i};if(e!==i){var a=o(e),u=o(i);a.CountStr===u.CountStr?s=n.format(u.BaseName,o(r).Count):(r=n.format("".concat(e," "),"2"),s=n.format("".concat(i," "),"2"))}return{newTitle:r,newRichTitle:s}}},26143:function(t,n,e){"use strict";e.d(n,{Z:function(){return I},u:function(){return T}});var i=e(59312),r=e(12611),o=e(9947),s=e(26203),a=e(94978),u=e(7645),c=e(72467),l=e(25664),f=e(61018),h=e(81380),d=e(85866),m=e(67661),v=e(51586),g=e(3864),p=e(39271),b=e(70284),y=e(64290),w=e(31442),S=e(12484),N=e(60504),C=e(48333),I=function(t){function n(){var n=t.call(this)||this;return n.createForm=n.createForm.bind(n),n.deleteForm=n.deleteForm.bind(n),n.restoreFromRecycleBin=n.restoreFromRecycleBin.bind(n),n.moveToRecycleBin=n.moveToRecycleBin.bind(n),n.changeFormOwner=n.changeFormOwner.bind(n),n}return(0,i.ZT)(n,t),n.triggerReadProcess=function(t,e){var i=(0,c.f5)().Model;if(i.FormId||i.CopyFormId){if(!i.FormMaster||i.FormMaster.isFieldReady(m.x.Schema.Id)&&i.FormMaster.Model.Id!==i.FormId)if(i.CopyFormId)N.a.copyFormBySharingLink(i.CopyFormId,i.SharingToken).then((function(t){(0,S.b)(t.ensureReadyToDesign().then((function(){t.Model.Title+=(0,u.pm)().Tile_For_Duplicate_Form})),"DesignPage_GetDesignForm"),(0,c.f5)().copyBySharingLinkFinished(t)})).catch((function(t){return(0,c.f5)().Model.CriticalError=t}));else{var r={Id:i.FormId},s=N.a.updateOrCreateFormMaster(r);(0,S.b)(s.ensureReadyToDesign(),"DesignPage_GetDesignForm"),i.FormMaster=s}}else if((0,y.pd)((function(){"NotStarted"===i.FormListLoadState&&(0,S.b)(n.getAllForms(!t,e),"DesignPage_GetAllForms")}),y.t1),t||(0,o.k0)().userInfo.IsMsa||n.getGroupMruForms(),(0,o.k0)().userInfo.IsMsa){var a=b.V.getInstance();a.ensureFieldsReady([a.Schema.SampleFormStates,a.Schema.TemplateGalleryToggleState])}},n.getInactiveUserByIdOrEmail=function(t){return f.VY.getInstance().createDataProvider().getInactiveUserByIdOrEmail(t)},n.copyFormByAPI=function(t,e,i,r){var o,a=(0,c.f5)();o=a.getUniqueFormName(t.Model.Title,e.IsGroupForm);var l={Modified:(new Date).toUTCString(),OwnerId:e.OwnerId,OwnerTenantId:e.OwnerTenantId,Title:o},f=(0,v.iZ)(l,e.IsGroupForm);return n.concatToFormList(f),(0,h.lK)(t).copyForm(t.Model.Id,e.OwnerId,e.OwnerTenantId,e.IsGroupForm).then((function(i){(0,g.qU)("CopyFormByAPI",t.Model.Id);var r=s.d.convertFromSourceData(i,m.x.Schema),c=(0,v.jg)(r,e.IsGroupForm,!1);return c.ensureFieldsReady([c.Schema.Title,c.Schema.FormsProRTTitle]).then((function(){t.ensureFieldsReady([t.Schema.Title,t.Schema.FormsProRTTitle]).then((function(){var n={copyTitle:t.Model.Title,newTitle:o,copyRichTitle:t.Model.FormsProRTTitle},e=(0,C.Q)(n,(0,u.pm)().Designer_Title_autoRenameFormat);c.bulkEdit((function(t){t.Title=e.newTitle,t.FormsProRTTitle=e.newRichTitle}))}))})),a.bulkEdit((function(){n.deleteFromFormList(f),c&&n.concatToFormList(c)})),c}),(function(e){return n.deleteFromFormList(f),(0,g.bh)("CopyFormByAPI",e,t.Model.Id),e}))},n.copyFormByAPIWithPatchProperties=function(t,n,e,i){},n.duplicateForm=function(t,e,i,r){return n.copyFormByAPI(t,e,i,r)},n.addDefaultHeader=function(t,n){(0,c.AX)().addDefaultHeader(t,n)},n.concatToFormList=function(t){var n=(0,c.f5)().Model;(0,y.pd)((function(){t.IsGroupForm?t.isFieldReady("Id")&&n.GroupMaster.addFormReference({instanceId:t.getInstanceId(),modifiedDate:t.Model.Modified,ownerId:t.Model.OwnerId,ownerTenantId:t.Model.OwnerTenantId,title:t.Model.Title,softDeleted:t.Model.SoftDeleted}):t.Model.OwnerId===(0,o.k0)().userInfo.UserId&&s.d.Collection.addItems(n.FormList,[t])}),y.t1)},n.deleteFromFormList=function(t){var n=(0,c.f5)().Model;(0,y.pd)((function(){t.IsGroupForm?n.GroupMaster.removeFormReference(t.getInstanceId()):s.d.Collection.deleteItems(n.FormList,[t])}),y.t1)},n.getFormSharedWithMe=function(){var t=(0,c.f5)(),n=t.Model;return n.SharedWithMeFormListLoadState="Loading",(0,h.Mv)().catch((function(t){throw t})).then((function(e){t.bulkEdit((function(){var t=[];e&&(t=e.sort((function(t,n){return Date.parse(n.SharedDate)-Date.parse(t.SharedDate)})).map((function(t){var n=N.a.updateOrCreateFormMaster(t);return n.IsSharedForm=!0,n}))),Promise.all(t.map((function(t){return t.ensureFieldsReady([m.x.Schema.SharedFormOwnerName,m.x.Schema.SharedDate])}))).then((function(){(0,y.pd)((function(){n.SharedWithMeFormListLoadState="Loaded",n.SharedWithMeFormList=r.uniq(s.d.Collection.addItems(n.SharedWithMeFormList,t))}),y.t1),(0,w.$U)("PortalPage.OtherForms.FormCount",{count:n.SharedWithMeFormList.length})}))}))}))},Object.defineProperty(n.prototype,"GroupMruDocumentManager",{get:function(){return n.GroupMruDocumentManager},enumerable:!1,configurable:!0}),n.prototype.createForm=function(t,e){var i=N.a.updateOrCreateFormMaster(t,e);return n.concatToFormList(i),i},n.prototype.designForm=function(t){(0,c.f5)().designForm(t)},n.prototype.moveToRecycleBin=function(t,n){var e=this,i=t.formOwnedByMe();return t.moveToRecycleBin().then((function(){if(t.isSoftDeleted()){var n=(0,c.f5)().Model;i&&(s.d.Collection.addItems(n.RecycleBin,[t]),n.FormList=r.without(n.FormList,t)),e.GroupMruDocumentManager.removeDocument(t.Model.Id)}}))},n.prototype.restoreFromRecycleBin=function(t){var n=this,e=t.formOwnedByMe();return t.Model.SoftDeleted=d.d.Normal,t.Synchronizer.flush().then((function(){var i=(0,c.f5)().Model;e&&(i.RecycleBin=r.without(i.RecycleBin,t),s.d.Collection.addItems(i.FormList,[t])),n.GroupMruDocumentManager.removeDocument(t.Model.Id)}))},n.prototype.deleteForm=function(t){var n=this,e=t.formOwnedByMe();return t.IsSharedForm?(t.Model.DeleteCollaborationPermission=!0,(0,h.lK)(t).deleteSharedWithMeLink(t.Model.Id).then((function(){t.Model.DeleteCollaborationPermission=!1;var n=(0,c.f5)().Model;n.SharedWithMeFormList=r.without(n.SharedWithMeFormList,t)}))):(t.Deleted=!0,new Promise((function(i){t.Synchronizer.flush().then((function(){var o=(0,c.f5)().Model;e&&(o.RecycleBin=r.without(o.RecycleBin,t)),t.IsGroupForm&&n.removeFromMRU(t),i()}))})))},n.prototype.changeFormOwner=function(t,n){var e=(0,h.lK)(t);return t.Model.TransferInProgress=!0,e.moveForm(t.Model.Id,n.OwnerId,n.IsGroupForm).finally((function(){return t.Model.TransferInProgress=!1})).then((function(n){t.Synchronizer.onDeletedInDataSource();var e=(0,c.f5)().Model;return e.FormList=r.without(e.FormList,t),n})).then((function(t){return{category:t.category,id:t.id,instanceId:void 0,modifiedDate:t.modifiedDate,ownerId:t.ownerId,ownerTenantId:t.ownerTenantId,softDeleted:t.softDeleted,title:t.title}})).catch((function(t){(0,c.f5)().Model.CriticalError=t}))},n.prototype.removeFromMRU=function(t){var n=this;return(0,h.lK)(t).removeRecentForm(t.Model.Id).then((function(){n.GroupMruDocumentManager.removeDocument(t.Model.Id)}))},Object.defineProperty(n,"GroupMruDocumentManager",{get:function(){return p.Z.getInstance()},enumerable:!1,configurable:!0}),n.getAllForms=function(t,e){var i=(0,c.f5)(),o=i.Model;o.FormListLoadState="Loading";var a=m.x.Schema,u=[a.Id,a.Title,a.Created,a.Modified,a.Settings,a.XlWorkbookId,a.OwnerId,a.OwnerTenantId,a.Category,a.Theme,a.SoftDeleted,a.Type,a.FileUploadFormInfo],f=(0,l.VK)(),d=(0,h.qU)(u,e,f),v=t?(0,h.Cs)():null;return d.catch((function(t){throw o.CriticalError=t,t})).then((function(t){var e=[];if(t&&(e=t.map((function(t){return N.a.updateOrCreateFormMaster(t)})),n.shouldFilterOutSurveys()&&(e=e.filter((function(t){return"survey"!==t.Model.Type})))),v){var u=v;e.forEach((function(t){var n=u.then((function(n){var e=[];return n&&(e=n.filter((function(n){return n.id===t.Model.Id}))),0===e.length?{rowCount:-1}:{rowCount:e[0].responseCount}}));t.Synchronizer.setFieldsQueryJob([t.Schema.RowCount],n)}))}Promise.all(e.map((function(t){return t.fieldsReady([a.Modified])}))).then((function(){i.bulkEdit((function(){o.FormList=r.uniq(s.d.Collection.addItems(o.FormList,e.filter((function(t){return t.isNotSoftDeleted()})))),o.RecycleBin=r.uniq(s.d.Collection.addItems(o.RecycleBin,e.filter((function(t){return t.isSoftDeleted()})))),o.FormListLoadState="Loaded",(0,w.$U)("PortalPage.MyForms.FormCount",{count:o.FormList.length,softDeletedCount:o.RecycleBin.length})}))}))}))},n.getGroupMruForms=function(){var t=(0,c.f5)().Model;"NotStarted"===t.GroupMruFormListLoadState&&(t.GroupMruFormListLoadState="Loading",n.GroupMruDocumentManager.initializeFormList().then((function(){return t.GroupMruFormListLoadState="Loaded"})))},n.shouldFilterOutSurveys=function(){var t=!0;return(0,y.pd)((function(){var n=new Date((0,a.Gw)("CustomerVoiceTransitionCompletionDate")),e=new Date;t=e>n}),y.t1),t},n}(N.a);function T(t){t.Model.Title=(0,c.f5)().getUniqueFormName(t.Model.Title),I.concatToFormList(t)}},13663:function(t,n,e){"use strict";e.d(n,{V:function(){return v},b:function(){return g}});var i=e(59312),r=e(87363),o=e(60211),s=e(7645),a=e(43367),u=e(72467),c=e(31442),l=e(3424),f=e(23112),h=e(63481),d=e(64520),m=e(25303);function v(t){return r.createElement(b,t)}function g(){return b.selectMedia().then((function(t){switch(t){case 1:return(0,d.L)().then((function(t){return{Image:t}}),p);case 2:return(0,m.t)().then((function(t){return{Video:t}}),p);default:return Promise.reject(!0)}}))}function p(t){if(t)return g()}var b=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.state={HoverOption:0},n}return(0,i.ZT)(n,t),n.selectMedia=function(){return n.promiseReject&&n.promiseReject(),new Promise((function(t,e){n.promiseResolve=t,n.promiseReject=e,(0,u.f5)().Model.FlexPane="MediaSelect",(0,h.cz)("Flexpane-MediaSelect",(function(){return t(0)}))}))},n.prototype.render=function(){return r.createElement("div",{className:"media-select-container"},r.createElement("span",{className:"media-select-label",role:"heading","aria-level":1},(0,s.pm)().ImagePicker_Insert_Mdeia_button),(0,a.getIoCMMediaPickerPaneText)(),this.Gr(1),!(0,o.x8)()&&this.Gr(2))},n.prototype.Gr=function(t){var n=this,e=1===t,i={role:"button",className:"flex-pane-content-title flex-pane-media-content",onClick:function(){n.qr(t)},onKeyUp:function(e){13!==e.keyCode&&32!==e.keyCode||n.qr(t)},onMouseEnter:function(){e?n.setState({HoverOption:1}):n.setState({HoverOption:2})},onMouseLeave:function(){n.setState({HoverOption:0})},tabIndex:0};return r.createElement("div",i,r.createElement("span",{className:"flex-pane-icon-container"},(0,l.M)({FluentIcon:e?"Image":"Video",HTMLAttributes:{className:"flex-pane-icon forms-icon-size20x20"}})),e?(0,s.pm)().ImagePicker_Type_Image:(0,s.pm)().ImagePicker_Type_Video)},n.prototype.qr=function(t){var e=1===t?"DesignPage.MediaPicker.ChooseImage":"DesignPage.MediaPicker.ChooseVideo";(0,c.$U)(e),n.promiseResolve&&n.promiseResolve(t)},n}(f.r)},64520:function(t,n,e){"use strict";e.d(n,{n:function(){return O},L:function(){return E}});var i=e(59312),r=e(87363),o=e(60211),s=e(9947),a=e(7645),u=e(43367),c=e(72467),l=e(64290),f=e(31442),h=e(3424),d=e(61533),m=e(12611),v=e(262),g=e(23112),p=e(25306);var b=function(t){function n(n){var e=t.call(this,n)||this;return e.Vr=!1,e.zr=e.zr.bind(e),e}return(0,i.ZT)(n,t),n.prototype.render=function(){return this.Qr()},n.prototype.Qr=function(){var t=this,n={className:"image-picker-switch-button",onKeyUp:this.zr,onClick:function(){var n=d.findDOMNode(t.refs.fileInput);$(n).val(""),$(n).click(),t.Vr=!0},ref:"ImageUploadButton",role:"tab items"},e=(0,p.E)({HTMLAttributes:n,ButtonStyle:1,Text:this.props.UploadButtonHint}),i=r.createElement("input",{type:"file",accept:"image/*",ref:"fileInput",onChange:function(n){return t.Ur(n)},className:"design-question-image-reader"}),o=m.extend({},this.props.HTMLAttributes);return o.className=(0,v.j)(o.className,"design-question-image-picker"),r.createElement("div",o,e,i)},n.prototype.Ur=function(t){var n=t.target.files[0];n&&((0,f.$U)("DesignPage.ImagePicker.AddImage",{source:"Local",size:n.size}),this.props.filePickedCallBack(n)),this.Vr=!1},n.prototype.zr=function(t){this.Vr&&27===t.keyCode&&(t.stopPropagation(),t.preventDefault(),this.Vr=!1)},n}(g.r),y=e(63481),w=e(687),S=function(){function t(t){this.$r=10,this.jr=t,this.Kr=t/140,this.Jr=t/200}return Object.defineProperty(t.prototype,"Margin",{get:function(){return this.$r},set:function(t){this.$r=t},enumerable:!1,configurable:!0}),t.prototype.layoutContent=function(t){for(var n=[],e=t,i=0,r=e.length,o=[];i<r;i++){var s=this.Zr([].concat(o,e[i])),a=s.length;a<=0||(i<r-1&&N(s[a-1])<this.Jr?(o=s[a-1],s.length=a-1):o=[],n=n.concat.apply(n,s))}return n},t.prototype.Zr=function(t){for(var n=this.Xr(t),e=function(t){var e=i.Yr(n[t]);if(1===n[t].length&&n[t][0].NaturalRatio>i.Kr)return n[t][0].Height=e,n[t][0].Width=i.jr-i.$r,"continue";n[t].forEach((function(t){t.Height=e,t.Width=e*t.NaturalRatio}))},i=this,r=0;r<n.length;r++)e(r);return n},t.prototype.Xr=function(t){var n=t.filter((function(t){return 1===t.Type})),e=t.filter((function(t){return 0===t.Type}));if(n.length<=0)return this.no(e);var i=this.no(n),r=i[i.length-1],o=N(r);if(o<this.Jr)for(var s=0;s<e.length&&s<5;s++){var a=e[s].NaturalRatio;if(o+a<this.Jr)o+=a,r.push(e[s]),e.splice(s--,1);else if(o+a<this.Kr){r.push(e[s]),e.splice(s,1);break}}return i.concat(this.no(e))},t.prototype.no=function(t){for(var n=[],e=[],i=0;i<t.length;i++){e.push([i]);for(var r=e.length-1,o=function(r){var o=t[i].NaturalRatio;o+=e[r].map((function(n){return t[n].NaturalRatio})).reduce((function(t,n){return t+n}),0);var a=e[r].slice(0);if(a.push(i),o<s.Jr)e.push(a);else if(o>=s.Jr&&o<=s.Kr){n.push(a.map((function(n){return t[n]})));for(var u=e.length-1;u>=0;u--)e[u].some((function(t){return a.indexOf(t)>=0}))&&e.splice(u,1);return"break"}},s=this,a=0;a<r;a++){if("break"===o(a))break}}var u=e.filter((function(t){return 1===t.length})).map((function(n){return t[n[0]]})),c=[];for(i=0;i<u.length;i++)c.push(u[i]),N(c)>this.Kr&&(n.push(c),c=[]);return c.length>0&&n.push(c),n},t.prototype.Yr=function(t){var n=N(t);return n>this.Kr&&1===t.length?140:n<this.Jr?200:(this.jr-t.length*this.$r)/n},t}();function N(t){return t.map((function(t){return t.NaturalRatio})).reduce((function(t,n){return t+n}))}var C=function(){function t(){}return Object.defineProperty(t.prototype,"Type",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Width",{get:function(){return this.eo},set:function(t){this.eo=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Height",{get:function(){return this.io},set:function(t){this.io=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"NaturalWidth",{get:function(){return this.oo},set:function(t){this.oo=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"NaturalHeight",{get:function(){return this.so},set:function(t){this.so=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"NaturalRatio",{get:function(){return this.oo&&this.so?this.oo/this.so:1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Src",{get:function(){return this.ao},set:function(t){this.ao=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ThumbnailSrc",{get:function(){return this.uo},set:function(t){this.uo=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Title",{get:function(){return this.fo},set:function(t){this.fo=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Size",{get:function(){return this.ho},set:function(t){this.ho=t},enumerable:!1,configurable:!0}),t}(),I=function(){function t(){}return Object.defineProperty(t.prototype,"Type",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"NaturalHeight",{get:function(){return 175},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"NaturalWidth",{get:function(){return 265},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"NaturalRatio",{get:function(){return this.NaturalWidth/this.NaturalHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Height",{get:function(){return this.io},set:function(t){this.io=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Width",{get:function(){return this.eo},set:function(t){this.eo=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Title",{get:function(){return this.fo},set:function(t){this.fo=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"AlbumCount",{get:function(){return this.do},set:function(t){this.do=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ResourceId",{get:function(){return this.mo},set:function(t){this.mo=t},enumerable:!1,configurable:!0}),t}(),T=e(61018),k=e(96689),x=e(42605),F=e(20572),P=e(93387),D=e(77309);function M(t){return r.createElement(L,t)}var L=function(t){function n(n){var e=t.call(this,n)||this;return e.vo=!0,e.po=0,e.bo=10,e.yo=e.yo.bind(e),e}return(0,i.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.vo=!1},n.prototype.render=function(){var t=m.extend({},this.props.HTMLAttributes);return t.id="imagePickerContentContainer",t.className="imagePickerContentContainer",t.onScroll=this.yo,t.ref=this.props.ImageContainerRef,r.createElement("div",t,this.wo(this.So()),this.No())},n.prototype.No=function(){var t=m.flatten(this.props.Nodes).length,n=0===t&&this.props.screenReaderMessageForEmptyContent?this.props.screenReaderMessageForEmptyContent:(0,a.pm)().ImagePicker_Status.format(t);return r.createElement(D.L,{HTMLAttributes:{className:"screenReaderVisible"},LazyRendering:!0,Role:"Status"},n)},n.prototype.yo=function(){var t=this;this.po&&clearTimeout(this.po),this.po=window.setTimeout((function(){var n=document.getElementById("imagePickerContentContainer");n.scrollTop+n.clientHeight+t.bo>=n.scrollHeight&&t.props.onPaging()}),500)},n.prototype.So=function(){var t=m.clone(this.props.Nodes);return new S(this.props.ContainerWidth-50).layoutContent(t)},n.prototype.wo=function(t){var n=this,e=0,i=[];return t.forEach((function(t){switch(t.Type){case 0:i.push(n.Io(t,e++));break;case 1:i.push(n.xo(t,e++));break;default:throw Error("ImagePickerContentView.createImages: invaild node type {0}".format(t.Type))}})),i},n.prototype.Io=function(t,n){var e=this.props;this.Fo(t);var i=(0,h.M)({FluentIcon:"Checkmark",HTMLAttributes:{className:"imageCheckIcon forms-icon-size14x14"}});return(0,P.ax)({key:n,HTMLAttributes:{className:"imageContentPieceWrapper",style:{height:t.Height+"px",width:t.Width+"px",backgroundImage:"url('".concat(t.ThumbnailSrc,"')")},onClick:function(){return e.onSelectedImageChange(t)},onFocus:function(){return e.onSelectedImageChange(t)},onKeyUp:function(n){return e.onSelectedImageKeyUp(n.keyCode,t)},onDoubleClick:function(){return e.onSelectedImageDoubleClick(t)},title:t.Title},ButtonStyle:1,ToggleActive:t===e.SelectedImage,children:[r.createElement("div",{className:"imageCheckBox",key:"imageCheckBox"},i,r.createElement("div",{className:"imageDescriptionLabel",key:"imageDescriptionLabel"},"".concat(t.NaturalWidth,"x").concat(t.NaturalHeight)))]})},n.prototype.xo=function(t,n){var e=this,i=(0,h.M)({FluentIcon:"Folder",HTMLAttributes:{className:"folderImageIcon forms-icon-size26x26"}});return(0,P.ax)({key:n,HTMLAttributes:{className:"folderContentPieceWrapper",style:{width:t.Width+"px",height:t.Height+"px"},onClick:function(){e.props.onFolderClick(t)}},ButtonStyle:1,children:r.createElement("div",{className:"folderImage"},i,r.createElement("div",{className:"folderFooter"},r.createElement("div",{className:"folderBeak"}),r.createElement("div",{className:"folderBeakHighlight"}),r.createElement("div",{className:"folderTitle"},t.Title)))})},n.prototype.Fo=function(t){var n=this;if(!m.contains(this.props.LazeLayoutCollection,t)&&(0===t.NaturalHeight||0===t.NaturalWidth)){var e=new Image;e.onload=function(){t.NaturalHeight=e.height,t.NaturalWidth=e.width,n.vo&&n.setState({})},this.props.LazeLayoutCollection.push(t),e.src=t.ThumbnailSrc}},n}(g.r);var R=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.vo=!0,n.state=n.getDefaultState(),n}return(0,i.ZT)(n,t),n.prototype.getDefaultState=function(){return{UseShareLicense:!0,ShowSearchLicenseBar:!1,NodesData:[],OffSet:0,LastUrl:null,Total:null,SeletedImage:null}},n.prototype.componentDidMount=function(){this.state.ShowSearchLicenseBar||""===this.props.Value||this.setState({ShowSearchLicenseBar:!0}),this.Po()},n.prototype.componentWillUnmount=function(){this.vo=!1},n.prototype.render=function(){var t=this,n=0===this.state.NodesData.length?void 0:M({ContainerWidth:this.props.ContainerWidth,Nodes:this.state.NodesData,SelectedImage:this.state.SeletedImage,onPaging:this.Po.bind(this),onSelectedImageChange:function(n){return t.setState({SeletedImage:n})},onSelectedImageDoubleClick:function(n){return t.setState({SeletedImage:n},t.Do.bind(t))},onSelectedImageKeyUp:function(n,e){13===n&&t.Do()}});return r.createElement("div",{className:"basicContentPageWrapper"},r.createElement("div",{className:"basicContentPageInnerWrapper"},this.Mo(),this.props.IsPrivacyLinkEnable?this.Ro():void 0,this.Ao(),n))},n.filterImage=function(t){return t.filter((function(t){return t.Size<=(0,w.yi)()}))},n.getBingSearchImages=function(t){var e=t.LicensesBarValue?"Share":"All";return T.VY.getInstance().createDataProvider().searchImage(t.Query,e,(0,w.qx)(),t.OffSet,t.LastUrl).then((function(e){return n.getFilteredImages(t,e)}))},n.getFilteredImages=function(t,n){var e=n.PartGroups.ImageParts,i=this.filterImage(e).map((function(t){var n=new C;return n.NaturalWidth=t.SourceUrl.Width,n.NaturalHeight=t.SourceUrl.Height,n.Src=t.SourceUrl.Url,n.ThumbnailSrc=t.ThumbnailUrl.Url,n.Title=t.Title,n.Size=t.Size,n}));return t.LastUrl=e.length?e[e.length-1].SourceUrl.Url:void 0,t.OffSet=Number(n.Offset),t.Total=Number(n.TotalResults),t.NodesData=t.NodesData.concat(i),t.NodesData.length>=(0,w.qx)()||t.OffSet>t.Total||0===t.Total||0===t.OffSet?Promise.resolve(t):this.getBingSearchImages(t)},n.prototype.Po=function(){var t=this,e=this.state,i=this.props;if(!(e.OffSet>e.Total)&&i.Value){i.showLoading(!0);var r={UseShareLicense:i.LicensesBarValue,ShowSearchLicenseBar:e.ShowSearchLicenseBar,OffSet:e.OffSet,Total:e.Total,LastUrl:e.LastUrl,NodesData:[],Query:i.Value,LicensesBarValue:i.LicensesBarValue};n.getBingSearchImages(r).then((function(n){var r=e.NodesData.concat([n.NodesData]);i.showLoading(!1),t.vo&&t.setState({NodesData:r,OffSet:n.OffSet,Total:n.Total,LastUrl:n.LastUrl})}),(function(n){t.props.showError(0,n.innerCode||n.statusCode,!0)}))}},n.prototype.Mo=function(){var t=this,n=(0,F.ZA)({Placeholder:(0,a.pm)().ImagePicker_BingSearch_HintMessage,HTMLAttributes:{className:"bingSearchTextField",onKeyDown:function(n){13===n.keyCode&&((0,f.$U)("DesignPage.ImagePicker.Search"),t.Eo())}},Options:{HTMLPropsForInnerElement:{"aria-label":(0,a.pm)().ImagePicker_BingSearch_LogoName}},Value:this.props.Value,TextFieldType:0,MinimalHeight:40,onValueChange:function(n){return t.props.onValueChange(n)}}),e=(0,x.F)({FluentIcon:"Search",IconClassName:"forms-icon-size18x18",Text:(0,a.pm)().ImagePicker_BingSearch_TipMessage,HTMLAttributes:{className:"bingSearchButton",onClick:function(){(0,f.$U)("DesignPage.ImagePicker.Search"),t.Eo()}},ButtonStyle:1,GlyphButtonStyle:"GlyphOnly"}),i=(0,p.E)({HTMLAttributes:{className:"image-picker-add-button",disabled:!this.state.SeletedImage,onClick:this.Do.bind(this)},Text:(0,a.pm)().ImagePicker_Add_button,ButtonStyle:1}),o=(0,h.M)({HTMLAttributes:{className:"bingSearchIcon"},IconName:"BingLogo"});return r.createElement("div",{className:"bingSearchContainer"},o,r.createElement("div",{className:"bingSearchLabel"},(0,a.pm)().ImagePicker_BingSearch_LogoName),n,e,i)},n.prototype.Do=function(){var t=this.state.SeletedImage;this.props.addImageFromUrlHandler&&((0,f.$U)("DesignPage.ImagePicker.AddImage",{source:"BingSearch",size:this.state.SeletedImage.Size}),this.props.addImageFromUrlHandler(t.Src,t.Title,t.Size,t.NaturalWidth,t.NaturalHeight)),this.setState({SeletedImage:null})},n.prototype.Ro=function(){var t=this;return r.createElement("div",{className:"bingSearchResponsibleLinkContainer"},r.createElement("div",{className:"bingSearchResponsibleLinkContent"},r.createElement("span",{className:"bingSearchResponsibleWarning"},(0,a.pm)().ImagePicker_Responsible_Warning),r.createElement("a",{className:"bingSearchResponsibleLink",href:"https://go.microsoft.com/fwlink/?LinkId=824927",target:"_blank"},(0,a.pm)().ImagePicker_Responsible_Link)),(0,x.F)({FluentIcon:"Dismiss",IconClassName:"forms-icon-size14x14",Text:(0,a.pm)().Common_Close_Text,HTMLAttributes:{className:"bingSearchResponsibleCloseButton",onClick:function(){t.props.onPrivacyLinkEnableChange(!1)},onKeyDown:!1},ButtonStyle:1,GlyphButtonStyle:"GlyphOnly"}))},n.prototype.Eo=function(){var t=this.getDefaultState();t.ShowSearchLicenseBar||""===this.props.Value?t.ShowSearchLicenseBar&&""===this.props.Value&&(t.ShowSearchLicenseBar=!1):t.ShowSearchLicenseBar=!0,this.setState(t,this.Po.bind(this))},n.prototype.Ao=function(){var t=this;if(this.state.ShowSearchLicenseBar)return r.createElement("div",{className:"bingSearchResponsibleLinkContainer"},(0,k.e)({HTMLAttributes:{className:"bingSerachLicensesCheckBox",title:(0,a.pm)().ImagePicker_Creative_Commons_Licenses},Value:this.props.LicensesBarValue,Description:(0,a.pm)().ImagePicker_Creative_Commons_Licenses,onValueChange:function(n){return t.Oo(n)},children:[r.createElement("a",{className:"bingSearchResponsibleLink BingSearchlicenseLink",href:"https://go.microsoft.com/fwlink/?LinkId=825104",target:"_blank"},(0,a.pm)().ImagePicker_Responsible_Link)]}))},n.prototype.Oo=function(t){(0,f.$U)("DesignPage.ImagePicker.BingSearchLicense",{useShareLicense:t}),this.props.onSearchLicenseSwitch(t);var n=this.getDefaultState();n.ShowSearchLicenseBar=this.state.ShowSearchLicenseBar,this.setState(n,this.Po.bind(this))},n}(g.r);var A=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.vo=!0,n.Bo=r.createRef(),n.Ho=r.createRef(),n.state={NodesData:[],FolderNodes:[],ImageNodes:[],SkipToken:"",LoadingState:0,SeletedImage:null},n}return(0,i.ZT)(n,t),Object.defineProperty(n.prototype,"OneDriveRoot",{get:function(){return"root"},enumerable:!1,configurable:!0}),n.prototype.componentWillMount=function(){this.qo(!1)},n.prototype.componentWillUnmount=function(){this.vo=!1},n.prototype.render=function(){var t=this,n=(0,p.E)({HTMLAttributes:{className:"image-picker-add-button",disabled:!this.state.SeletedImage,onClick:this.Do.bind(this)},Text:(0,a.pm)().ImagePicker_Add_button,ButtonStyle:1}),e=(0,h.M)({HTMLAttributes:{className:"oneDriveIcon"},IconName:"OneDrive"});return r.createElement("div",{className:"basicContentPageWrapper"},r.createElement("div",{className:"basicContentPageInnerWrapper"},r.createElement("div",{className:"onDriveContainer"},e,r.createElement("div",{className:"oneDriveLabel"},(0,a.pm)().ImagePicker_OneDrive_LogoName),n),this.Vo(),this.Qo(),M({ContainerWidth:this.props.ContainerWidth,Nodes:this.state.NodesData,screenReaderMessageForEmptyContent:(0,a.pm)().ImagePicker_OneDrive_EmptyFolderPromptMessage,SelectedImage:this.state.SeletedImage,onPaging:this.jo.bind(this),onFolderClick:function(n){return t.setState({SeletedImage:null},(function(){return t.Wo(n,!0)}))},onSelectedImageChange:function(n){return t.setState({SeletedImage:n})},onSelectedImageDoubleClick:function(n){return t.setState({SeletedImage:n},t.Do.bind(t))},onSelectedImageKeyUp:function(n,e){13===n&&t.Do()},LazeLayoutCollection:[],ImageContainerRef:this.Bo})))},n.prototype.Do=function(){var t=this.state;(0,f.$U)("DesignPage.ImagePicker.AddImage",{source:"OneDrive",size:t.SeletedImage.Size}),this.props.addImageFromUrlHandler(t.SeletedImage.Src,t.SeletedImage.Title,t.SeletedImage.Size,t.SeletedImage.NaturalWidth,t.SeletedImage.NaturalHeight)},n.prototype.Qo=function(){return 0===this.state.NodesData.length&&2===this.state.LoadingState?r.createElement("div",{className:"image-picker-oneDrive-emptyFolder-message"},(0,a.pm)().ImagePicker_OneDrive_EmptyFolderPromptMessage):void 0},n.prototype.Wo=function(t,n){var e=this,i=m.clone(this.props);1!==this.state.LoadingState&&this.setState({NodesData:[],FolderNodes:[],ImageNodes:[],SkipToken:""},(function(){var r=m.contains(i.OneDrivePath,t)?i.OneDrivePath.splice(0,m.indexOf(i.OneDrivePath,t)+1):i.OneDrivePath.concat(t);e.props.OnPathChange(r),e.qo(n)}))},n.prototype.jo=function(){this.state.SkipToken&&this.qo(!1)},n.prototype.qo=function(t){var n=this;1!==this.state.LoadingState&&this.setState({LoadingState:1},(function(){n.props.showLoading(!0);var e=m.last(n.props.OneDrivePath);T.VY.getInstance().createDataProvider().browseImage(e.ResourceId,(0,w.qx)(),n.state.SkipToken).then((function(e){var i=n.state,r=e.PartGroups.FolderParts,o=e.PartGroups.ImageParts,s=r.map((function(t){var n=new I;return n.Title=t.Title,n.ResourceId=t.ResourceId,n.AlbumCount=t.AlbumCount,n})),a=o.map((function(t){var n=new C;return n.Src=t.SourceUrl.Url,n.ThumbnailSrc=t.SourceUrl.Url,n.NaturalHeight=t.SourceUrl.Height,n.NaturalWidth=t.SourceUrl.Width,n.Title=t.Title,n.Size=t.Size,n})),u=s.length<=0?i.FolderNodes:i.FolderNodes.concat([s]),c=a.length<=0?i.ImageNodes:i.ImageNodes.concat([a]);n.props.showLoading(!1),n.vo&&n.setState({FolderNodes:u,ImageNodes:c,NodesData:u.concat(c),SkipToken:e.Offset,LoadingState:2},(function(){!n.Bo.current||!t||document.activeElement&&document.activeElement!==document.body||(0===n.state.NodesData.length?(0,y.nP)(n.Ho.current):(0,y.Vh)(n.Bo.current),t=!1)}))}),(function(t){n.setState({LoadingState:3}),n.props.showError(1,t.innerCode||t.statusCode,!0)}))}))},n.prototype.Vo=function(){var t=this,n=this.props.OneDrivePath.map((function(n,e){return(0,P.ax)({ButtonStyle:1,HTMLAttributes:{className:"imagePickerContentPageBreadcrumbWrapper",onClick:function(){t.setState({SeletedImage:null},(function(){return t.Wo(n,!1)}))}},children:r.createElement("span",{},(n.ResourceId===t.OneDriveRoot?"":"> ")+n.Title),key:e})}));return r.createElement("div",{className:"imagePickerContentPageBreadcrumbContainer",ref:this.Ho},n)},n}(g.r);function E(){return _.pickImage()}function O(t){return r.createElement(_,t)}var _=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.Ko=(0,c.f5)().Model.FormsTenantSettings,e.vo=!0,e.state={BingSearchKeyword:"",OneDrivePath:[{Title:(0,s.k0)().userInfo.DisplayName+(0,a.pm)().ImagePicker_OneDrive_PathRootSuffix,ResourceId:n.OneDriveRoot}],BingSearchPrivacyLinkEnable:!0,ImagePickerTypeState:e.Jo()?0:1,BingSearchLicensesValue:!0},e}return(0,i.ZT)(n,t),Object.defineProperty(n,"OneDriveRoot",{get:function(){return"root"},enumerable:!1,configurable:!0}),n.pickImage=function(){return n.imageReject&&n.imageReject(),new Promise((function(t,e){n.imageResolve=t,n.imageReject=e;var i=(0,c.f5)().Model;i.FlexPane="ImagePicker",(0,y.cz)("Flexpane-ImagePicker",(function(){i.FlexPane=(0,l.pd)((function(){return"MediaSelect"}),l.t1),n.rejectImagePicker(!0)}))}))},n.rejectImagePicker=function(t){n.imageReject&&(n.imageReject(t),n.imageReject=null,n.imageResolve=null)},n.collapeFlexPaneHandler=function(){var t=(0,c.f5)().Model;"ImagePicker"===t.FlexPane&&(t.FlexPane="None")},n.prototype.componentWillUnmount=function(){this.vo=!1,n.rejectImagePicker()},n.prototype.rejectPickerDeferred=function(){n.rejectImagePicker(!0)},n.prototype.createPickerContent=function(){var t=this;if(!(0,u.areIoCImageUploadButtonsEnabled)())return null;var n,e=this.state;return 1===e.ImagePickerTypeState?(n={ContainerWidth:this.props.ContainerWidth,showLoading:this.Zo.bind(this),showError:this.Xo.bind(this),addImageFromUrlHandler:this.Yo.bind(this),OneDrivePath:e.OneDrivePath,OnPathChange:function(n){t.setState({OneDrivePath:n})}},r.createElement(A,n)):function(t){return r.createElement(R,t)}({ContainerWidth:this.props.ContainerWidth,showLoading:this.Zo.bind(this),showError:this.Xo.bind(this),addImageFromUrlHandler:this.Yo.bind(this),Value:e.BingSearchKeyword,onValueChange:function(n){t.setState({BingSearchKeyword:n})},IsPrivacyLinkEnable:e.BingSearchPrivacyLinkEnable,onPrivacyLinkEnableChange:function(n){t.setState({BingSearchPrivacyLinkEnable:n})},LicensesBarValue:e.BingSearchLicensesValue,onSearchLicenseSwitch:function(n){t.setState({BingSearchLicensesValue:n})}})},n.prototype.createErrorHandling=function(){var t=this.state,n=t.ImagePickerTypeState,e=t.ErrorState&&t.ErrorState.InnerCode;if(e&&t.ErrorState.Source===n){var i,o="";switch(n){case 0:o=(0,a.pm)().Error_Message_5403;break;case 1:o=(0,a.pm)().Error_Message_5401;break;default:throw Error("ImagePickerView.createErrorHandling:ImagePickerType.{0} shouldn't call this method".format(n))}switch(e){case 5400:i=(0,a.pm)().Error_Message_5400;break;case 5401:i=(0,a.pm)().Error_Message_5401;break;case 5402:i=(0,a.pm)().Error_Message_5402;break;case 5403:i=(0,a.pm)().Error_Message_5403;break;default:i=o}var s=(0,h.M)({FluentIcon:"Emoji Sad",HTMLAttributes:{className:"image-picker-error-icon forms-icon-size32x32"}});return r.createElement("div",{className:"image-picker-error-hanlder-container"},s,r.createElement("div",{className:"image-picker-error-message"},i))}},n.prototype.createSwitchButtons=function(){var t,e=this,i=this.state.ImagePickerTypeState,o=(0,u.areIoCImageUploadButtonsEnabled)()&&this.Jo()?this.createSwicherButton((0,a.pm)().ImagePicker_switcher_BingSearch,0===i,(function(){e.ts(0,"DesignPage.ImagePicker.UploadBingSearch")})):void 0,s=(0,u.areIoCImageUploadButtonsEnabled)()?this.createSwicherButton((0,a.pm)().ImagePicker_switcher_OD4B,1===i,(function(){e.ts(1,"DesignPage.ImagePicker.UploadOD4B")})):void 0,c=(t={ContainerClassName:(0,u.getIoCImagePickerLocalContainerClassName)(),filePickedCallBack:function(t){(0,f.$U)("DesignPage.ImagePicker.UploadLocal"),n.imageResolve&&n.imageResolve({File:t}),n.collapeFlexPaneHandler()},UploadButtonHint:(0,a.pm)().ImagePicker_switcher_Upload,HTMLAttributes:{className:"image-picker-switch-button-wrapper"}},r.createElement(b,t));return r.createElement("div",{className:"image-picker-switch-button-container"},o,s,c)},n.prototype.Xo=function(t,n,e){this.setState({ErrorState:e?{InnerCode:n,Source:t}:null,Loading:!1})},n.prototype.ts=function(t,n){var e,i=this,r=this.state;(0,f.$U)(n),r.ErrorState&&r.ErrorState.Source===t&&(e=r.ErrorState&&r.ErrorState.Source===t?r.ErrorState:null),this.setState({ErrorState:e,Loading:!1},(function(){return i.setState({ImagePickerTypeState:t})}))},n.prototype.Zo=function(t){this.vo&&!this.state.Loading!=!t&&this.setState({Loading:t,ErrorState:null})},n.prototype.Yo=function(t,e,i,r,o){n.imageResolve&&n.imageResolve({FromUrl:{Url:t,Size:i,Width:r,Height:o}}),n.collapeFlexPaneHandler()},n.prototype.Jo=function(){return!(0,o.x8)()&&!(this.Ko&&!this.Ko.bingImageSearch)},n}(e(774).R)},774:function(t,n,e){"use strict";e.d(n,{R:function(){return f}});var i=e(59312),r=e(87363),o=e(7645),s=e(43367),a=e(72467),u=e(31442),c=e(42605),l=e(25306),f=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.render=function(){var t;return this.state.Loading&&(t=r.createElement("div",{className:"image-picker-loading-container"},r.createElement("div",{className:"image-picker-loading common-spinner-circle"}))),r.createElement("div",{className:"image-picker-container"},this.rs(),(0,s.getIoCMediaPickerPaneTitle)(),(0,s.getIoCMediaPickerPaneInfoContent)(),this.createSwitchButtons(),this.createPickerContent(),this.createErrorHandling(),t)},n.prototype.createSwicherButton=function(t,n,e){return r.createElement("div",{className:"image-picker-switch-button-wrapper"},(0,l.E)({HTMLAttributes:{className:"image-picker-switch-button",onClick:e,role:"tab","aria-selected":n},ToggleActive:n,ButtonStyle:1,Text:t}))},n.prototype.rs=function(){var t=this,n=(0,a.f5)().Model;if("MediaSelect"===n.PreviousFlexPane)return r.createElement("div",null,(0,c.F)({HTMLAttributes:{className:"image-picker-back-button",onClick:function(){(0,u.$U)("DesignPage.MediaPicker.Back"),t.setState({Loading:!1,ErrorState:void 0},(function(){n.FlexPane="MediaSelect",t.rejectPickerDeferred()}))}},ButtonStyle:1,Icon:"Back",IconClassName:"image-picker-back-button-img forms-icon-size17x17",Text:(0,o.pm)().Common_Back_Text,TextClassName:"image-picker-back-button-text"}))},n}(e(23112).r)},25303:function(t,n,e){"use strict";e.d(n,{H:function(){return b},t:function(){return p}});var i=e(59312),r=e(87363),o=(e(61533),e(15934)),s=e(687),a=e(7645),u=e(72467),c=e(1014),l=e(46008),f=e(70877),h=(e(64290),e(31442)),d=e(3424),m=e(20572),v=e(25306),g=e(63481);function p(){return y.pickVideo()}function b(t){return r.createElement(y,t)}var y=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.pickVideo=function(){return n.videoRejected&&n.videoRejected(),new Promise((function(t,e){n.videoResolved=t,n.videoRejected=e;var i=(0,u.f5)().Model;i.FlexPane="VideoPicker",(0,g.cz)("Flexpane-VideoPicker",(function(){i.FlexPane="MediaSelect",n.rejectVideoPicker(!0)}))}))},n.rejectVideoPicker=function(t){n.videoRejected&&(n.videoRejected(t),n.videoRejected=null,n.videoResolved=null)},n.collapeFlexPaneHandler=function(){var t=(0,u.f5)().Model;"VideoPicker"===t.FlexPane&&(t.FlexPane="None")},n.prototype.componentWillUnmount=function(){n.rejectVideoPicker()},n.prototype.rejectPickerDeferred=function(){n.rejectVideoPicker(!0)},n.prototype.createPickerContent=function(){return this.us()},n.prototype.createErrorHandling=function(){var t=this.state.ErrorState&&this.state.ErrorState.InnerCode;if(t){var n,e,i;switch(t){case 5400:i=(0,a.pm)().Error_Message_5400;break;case 5401:i=(0,a.pm)().Error_Message_5401;break;case 5402:i=(0,a.pm)().Error_Message_5402;break;case 5403:i=(0,a.pm)().Error_Message_5403;break;default:var s=this.state.VideoURL,u=(0,l.Fp)(),c=(0,f.eM)();if(u&&c&&!(0,o.K2)(s)){i=(0,a.pm)().Error_Message_Client_VideoUrlError;break}if(!c&&(0,o.yk)(s)){i=(0,a.pm)().Error_Message_Client_Youtube_Disabled_VideoUrlError,e=(0,d.M)({FluentIcon:"Info",HTMLAttributes:{className:"forms-icon-size32x32"}});break}u&&!(0,o.M4)(s)&&(i=(0,a.pm)().Error_Message_Client_MicrosoftStream_VideoUrlError)}i&&(n=(0,d.M)({FluentIcon:"Emoji Sad",HTMLAttributes:{className:"forms-icon-size32x32"}}));return r.createElement("div",{className:"image-picker-error-hanlder-container"},r.createElement("div",{className:"image-picker-error-icon"},e||n),r.createElement("div",{className:"image-picker-error-message","aria-live":"assertive",role:"alert"},i))}},n.prototype.createSwitchButtons=function(){return r.createElement("div",{className:"image-picker-switch-button-container"},this.createSwicherButton((0,a.pm)().ImagePicker_switcher_VideoUrl,!0,(function(){})))},n.prototype.fs=function(t){n.videoResolved&&n.videoResolved(t),n.collapeFlexPaneHandler()},n.prototype.hs=function(){var t=this.state.VideoURL,n=(0,l.Fp)(),e=(0,f.eM)();n&&e&&(0,o.eC)(t)||n&&!e&&(0,o.M4)(t)||!n&&e&&(0,o.yk)(t)?((0,h.$U)("DesignPage.MediaPicker.AddVideo",{videoSrc:(0,c.To)(t)}),this.fs(t),this.setState({VideoURL:void 0,ErrorState:void 0})):((0,h.$U)("DesignPage.MediaPicker.AddVideoFailure",{videoSrc:(0,c.To)(t)}),this.setState({ErrorState:{InnerCode:(0,s.Nj)()}}))},n.prototype.us=function(){var t,n=this,e=(0,l.Fp)(),i=(0,f.eM)();e&&i?t=(0,a.pm)().VideoPicker_FromUrl_HintMessage:e&&!i?t=(0,a.pm)().VideoPicker_MicrosoftStream_FromUrl_HintMessage:!e&&i&&(t=(0,a.pm)().ImagePicker_FromUrl_HintMessage);var o=(0,m.ZA)({Placeholder:t,HTMLAttributes:{className:"fromUrlTextField",onKeyUp:function(t){13===t.keyCode&&n.hs()}},Value:this.state.VideoURL,TextFieldType:0,MinimalHeight:40,onValueChange:function(t){return n.setState({VideoURL:t,ErrorState:void 0})}}),s=(0,v.E)({HTMLAttributes:{className:"image-picker-add-button from-url","aria-describedby":!1,disabled:!1,onClick:function(){return n.hs()}},Text:(0,a.pm)().ImagePicker_Add_button,ButtonStyle:1}),u=(0,d.M)({FluentIcon:"Link",HTMLAttributes:{className:"fromUrlIcon"}});return r.createElement("div",{className:"fromUrlContainer"},u,r.createElement("div",{className:"fromUrlLabel"},(0,a.pm)().ImagePicker_switcher_Url),o,s)},n}(e(774).R)},50541:function(t,n,e){"use strict";e.d(n,{t:function(){return c}});var i=e(59312),r=e(87363),o=e(7645),s=e(41040),a=e(23112),u=e(72317);function c(t){return r.createElement(l,(0,i.pi)({},t))}var l=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.ds=void 0,n.vs=void 0,n}return(0,i.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this;this.setState({Alerting:!0});var n=this.props;n.Timeout>0&&(this.ds=window.setTimeout((function(){t.setState({Timeout:!0})}),n.Timeout)),this.vs=window.setTimeout((function(){(0,u.a)().RetryingRecoverableError&&t.setState({Timeout:!0,DetailMessage:t.props.TimeoutMessage||(0,o.pm)().RetryRecoverableErrorMessage_WorkingOn})}),1e4)},n.prototype.componentWillUnmount=function(){window.clearTimeout(this.ds),window.clearTimeout(this.vs)},n.prototype.render=function(){var t,n;if(this.state.Timeout){var e=this.state.DetailMessage||(0,o.pm)().LoadingPlaceholder_Timeout_Message;t=r.createElement("div",{className:"page-loading-message-timeout"},e)}this.state.Alerting&&(n=this.props.Message);var a={ClassName:"portalPage-content-spinner",Ignorable:!1,LoadingDescription:n},u=r.createElement(s.P,(0,i.pi)({},a));return r.createElement("div",{"aria-live":"polite","aria-label":(0,o.pm)().Common_Loading_Text,className:"page-loading-messagebox",tabIndex:0},u,t)},n}(a.r)},96539:function(t,n,e){"use strict";e.d(n,{Mb:function(){return h},BT:function(){return l},OJ:function(){return c},$q:function(){return f},dq:function(){return d},yM:function(){return v},Bi:function(){return m},OT:function(){return p},oH:function(){return g}});var i=e(87363),r=e(262),o=e(7645),s=e(25306),a=e(59312),u=function(t){function n(n){var e=t.call(this,n)||this;return e.state={ShowAltImg:!1},e}return(0,a.ZT)(n,t),n.prototype.render=function(){return this.state.ShowAltImg?this.props.altImgUrl&&i.createElement("img",{className:"teaching-callout-img",src:this.props.altImgUrl,alt:(0,o.pm)().AltText_Gif}):i.createElement("img",{className:"teaching-callout-img",src:this.props.imgUrl,alt:(0,o.pm)().AltText_Gif})},n.prototype.componentDidMount=function(){this.gs()},n.prototype.componentDidUpdate=function(){this.gs()},n.prototype.gs=function(){var t=this;this.props.altTimeout&&!this.state.ShowAltImg&&(this.bs&&clearTimeout(this.bs),this.bs=setTimeout((function(){return t.setState({ShowAltImg:!0})}),this.props.altTimeout))},n}(i.Component),c=0,l=2,f=3,h=5e3;function d(t,n,e,o,s,a){return i.createElement("div",{className:"firstrun-callout-container","aria-live":"polite","aria-label":s},i.createElement("div",{id:e,className:"firstrun-callout"},i.createElement("div",{className:(0,r.j)("firstrun-callout-beak",o)}),i.createElement("div",{className:"teaching-callout-text-wrap"},a||function(t){return i.createElement("div",{className:"teaching-callout-text"},t)}(s)),i.createElement("div",{className:"teaching-callout-img-wrap"},t),n))}function m(t,n,e){return i.createElement(u,{imgUrl:t,altImgUrl:n,altTimeout:e})}function v(t){return(0,s.E)({HTMLAttributes:{className:"teaching-callout-button",onClick:t},Text:(0,o.pm)().TeachingUi_GotIt,ButtonStyle:1})}function g(t){return parseInt(t)===f}function p(t){var n=parseInt(t);return isNaN(n)||n<l}},24513:function(t,n,e){"use strict";e.d(n,{a:function(){return o},k:function(){return s}});var i=e(59312),r=e(87363),o="single-progress-bar",s=function(t){if(t.$CurrentStep<0||t.$TotalSteps<=0||t.$TotalSteps<t.$CurrentStep)return null;var n=Math.round(100*t.$CurrentStep/t.$TotalSteps),e={id:o,className:"progress-bar-text office-form-theme-secondary-color"},s={className:"progress-bar-div",role:"progressbar","aria-label":t.$DescriptionText,"aria-valuenow":n};return r.createElement("div",(0,i.pi)({},s),r.createElement("div",{className:"progress-bar-background office-form-theme-progress-bar-background"},r.createElement("div",(0,i.pi)({},e),t.$DescriptionText),r.createElement("div",{className:"progress-bar"},r.createElement("div",{className:"progress-bar-control office-form-theme-primary-background",style:{width:"".concat(n,"%")}}))))}},72317:function(t,n,e){"use strict";e.d(n,{a:function(){return r}});var i=e(72377);function r(){return i.Pv.Resolve("IPageContext")}},45862:function(t,n,e){"use strict";e.d(n,{P:function(){return h}});var i,r=e(61533),o=e(94290),s=e(7645),a=e(31442),u=e(76669);function c(){try{(0,u.Km)().exitWebView()}catch(t){(0,a.zU)("Union.exitWebViewFailed",{errorInfo:t.message})}}!function(t){t[t.Mail=0]="Mail",t[t.Teams=1]="Teams"}(i||(i={}));var l=e(30521),f=e(64290);function h(t){(0,f.c2)(),(0,s.ay)().then((function(){r.render((0,l.a)({Error:t,ShowBackButton:(0,o.mF)(),OnBackButtonClicked:(0,o.mF)()?c:null}),document.getElementById("content-root"))}))}},64290:function(t,n,e){"use strict";e.d(n,{Sp:function(){return l},Xw:function(){return h},c2:function(){return c},hl:function(){return u},md:function(){return a},pd:function(){return s},t1:function(){return f}});var i,r=e(9947),o=e(73252);function s(t,n){return t()}function a(t){return null}function u(t){return t()}function c(){}function l(){return void 0===i&&(i=!!(0,r.k0)().proEnabled&&(0,o.cr)("FormsPro")),i}function f(){throw new Error("unreachable code")}FormsPro.initializeStyleBasis=c;var h={}},51185:function(t,n,e){"use strict";e.d(n,{lT:function(){return St},RS:function(){return wt}});var i=e(59312),r=e(87363),o=e(61533),s=e(12611),a=e(78587),u=e(60211),c=e(51531),l=e(29559),f=e(73909);function h(t){switch(t){case"uz-latn-uz":case"hy":return"en-gb";case"be":return"ru";case"zh-hk":case"zh-Hant":return"zh-tw";case"es-ES":return"es";case"fr-FR":return"fr";case"zh-Hans":return"zh-cn";default:return t}}var d=e(9947),m=e(262),v=e(64459),g=e(26203),p=e(46571),b=e(73252),y=e(57411),w=e(7899),S=e(77356),N=e(94283);function C(){var t=document.createElement("link").relList;return!!(t&&t.supports&&t.supports("prefetch"))}C();var I=e(72377),T=e(31442);function k(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){return I.Pv.Resolve("IBootEvent").addBootCompleteListener((function(){!function(){(0,i.mG)(this,void 0,void 0,(function(){var t,n;return(0,i.Jh)(this,(function(e){return C()||(t=document.getElementsByTagName("link"),n=[],Array.prototype.slice.call(t).forEach((function(t){t.rel&&t.rel.match(/\b(?:pre(?:render|fetch)|next)\b/)&&n.push(t.href)})),n.forEach((function(t){return(new Image).src=t})),(0,T.b6)("Polyfill.Prefetch"),(0,N.Zz)(5)),[2]}))}))}()})),[2]}))}))}var x=e(7645),F=e(43367),P=e(9554),D=e(20987),M=e(54496),L=e(90710),R=e(77494),A=e(46008),E=e(66557);var O=e(30521),_=e(18260),B=e(83726),H=e(32782),G=e(29295);function q(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(653).then(e.bind(e,26642))];case 1:return[2,{default:t.sent().ReportPage}]}}))}))}function V(t){var n=(0,G.J)(V,q);return r.createElement(H.Z,null,r.createElement(n,(0,i.pi)({},t)))}function z(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(653).then(e.bind(e,73598))];case 1:return[2,{default:t.sent().ThankYouPage}]}}))}))}function Q(t){var n=(0,G.J)(Q,z);return r.createElement(H.Z,null,r.createElement(n,(0,i.pi)({},t)))}var U=e(9743),j=e(67661),W=(e(53315),e(502)),K=e(29482),J=(e(22530),e(24513)),Z=e(64290),X=e(96689),Y=e(3424),tt=e(61111),nt=e(77309),et=e(25306),it=e(77145),rt=e(16717),ot=e(25038),st=e(42605);var at=e(23112),ut=e(21707),ct=e(47393),lt=e(41360),ft=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.ys=r.createRef(),n}return(0,i.ZT)(n,t),n.prototype.render=function(){var t=r.createElement("div",{className:"introduction-title-container"},r.createElement("div",{className:"introduction-title"},(0,x.pm)().Form_Introduction_Title_MSA),r.createElement("a",{className:"office-form-try-link",href:"javascript:void(0)",onClick:ht},(0,x.pm)().Form_Introduction_TryText_MSA)),n={ButtonStyle:1,HTMLAttributes:{"aria-label":(0,x.pm)().Form_Introduction_CreateButtonText_MSA,className:"introduction-create-form",onClick:dt,title:(0,x.pm)().Form_Introduction_CreateButtonText_MSA},ref:this.ys,Text:(0,x.pm)().Form_Introduction_CreateButtonText_MSA},e=r.createElement(et.A,(0,i.pi)({},n));return r.createElement("div",{className:"office-form introduction-for-responser-container"},t,r.createElement("div",{className:"introduction-container"},r.createElement("div",{className:"introduction"},r.createElement(lt.z,{alt:(0,x.pm)().Form_Introduction_MSA_1,className:"introduction-image",key:"introductionImage1",src:"/Images/MSAIntroduction1.png"}),r.createElement("div",{className:"introduction-text"},(0,x.pm)().Form_Introduction_MSA_1)),r.createElement("div",{className:"introduction"},r.createElement(lt.z,{alt:(0,x.pm)().Form_Introduction_MSA_2,className:"introduction-image",key:"introductionImage2",src:"/Images/MSAIntroduction2.png"}),r.createElement("div",{className:"introduction-text"},(0,x.pm)().Form_Introduction_MSA_2)),r.createElement("div",{className:"introduction"},r.createElement(lt.z,{alt:(0,x.pm)().Form_Introduction_MSA_3,className:"introduction-image",key:"introductionImage3",src:"/Images/MSAIntroduction3.png"}),r.createElement("div",{className:"introduction-text"},(0,x.pm)().Form_Introduction_MSA_3))),r.createElement("div",{className:"introduction-button"},e))},n}(at.r);function ht(){return(0,T.$U)("ResponsePage.IntroductionForResponser.TryForms"),(0,ct.gB)("/Pages/DesignPage.aspx"),!0}function dt(){return(0,T.$U)("ResponsePage.IntroductionForResponser.Create"),(0,ct.gB)("/Pages/DesignPage.aspx"),!0}var mt=e(70642),vt=e(89099),gt=e(56550),pt=e(90927),bt=e(63481),yt=e(58537);function wt(t){return r.createElement(St,t)}var St=function(t){function n(n){var e=t.call(this,n)||this;e.ws=!1,e.Ss=!1,e.Ns=768,e.defaultLanguageId=e.props.Master.Model.DefaultLanguage,e.Is=!0,e.Ts=0,e.ks=function(){e.setState({ShowPrintResult:!0,ReturnFromPrintResponse:!0}),window.setTimeout((function(){$(".form-content-container").appendTo($("body")),$(".reactshellheader").hide(),$(".top-view-container").hide(),$("#content-root").hide(),$(".form-content-container").show(),$(".title-menu-control-container, .menu-control-dropup").hide(),document.execCommand("print",!1,null)||window.print()}),1e3)},e.xs=function(t){e.setState({ShouldShowImmersiveReaderButtons:t||!e.state.ShouldShowImmersiveReaderButtons})};var i=!1,o=n.IncrementalQuestionLoader;o&&(o.setFormRenderer(e),i=null!==o.getFormForFirstRender()&&(0,b.Gs)()&&!(0,D._o)()),e.Fs=r.createRef(),e.formRuntimeMaster=new K.l(e.props.Master,{disableBranching:e.Sr(),disableShuffle:i});var s=(0,f.lc)(),a=(0,f.Wi)();e.defaultLanguageName=s[e.defaultLanguageId]||a[e.defaultLanguageId];var u,c=(0,f.W$)((0,d.k0)().cultureInfo.Name.toLowerCase()),l=!1;if((0,F.cvOnlyLanguageUtilityIoC)()){var h=e.Ps(),m=h.newLocaleId,v=h.forceUpdate;c=null!=m?m:c,l=v}var p=g.d.Collection.getItemWithKeyFields(e.props.Master.Model.LocaleList,{localeId:c});p?u=p.localeName:(0,Z.pd)((function(){c=e.defaultLanguageId,u=e.defaultLanguageName}),Z.t1),e.Ds(c,l),e.Ms(e.props.PersistedSectionId);var y=e.formRuntimeMaster.calcProgressBarInfo(),w=y.showProgressBar,S=y.currentPageNumber,N=y.totalPageNumber;return(0,L.NW)().oembedocv,e.state={IsSmallScreen:(0,A.rA)(e.Ns),SubmitState:0,ShowDuplicateSpinner:!1,ShowErrorPage:!1,ShowPhishingWarningBar:!0,IsStudentViewMode:null!=e.props.Response,IsReportingView:!1,HideQuestions:!1,EmailReceiptConsent:!1,LocalizedResource:e.props.Master.Model.LocaleList.length&&{localeId:c,localeName:u},ShowSpinnerWhenChangeLanguage:!1,ShowSpinnerForFirstTimeLoadMultilingual:!1,LocalizedStrings:(0,x.pm)(),ShouldShowImmersiveReaderButtons:!1,ShowLongOperationMessage:!1,ShowProgressBar:w,CurrentPageNumber:S,TotalPageNumber:N,WrongQuestionCount:e.Ls().length,SubmitButtonDependencyReady:!(0,b.VE)(),ShowSensitiveInfoWarning:!1},e.Rs=e.Rs.bind(e),e.As=e.As.bind(e),e.Os=e.Os.bind(e),e._s=e._s.bind(e),e.Bs=e.Bs.bind(e),e.Vs=e.Vs.bind(e),e.zs=e.zs.bind(e),e.Qs=e.Qs.bind(e),e.Us=e.Us.bind(e),e.$s=e.$s.bind(e),e.Js=e.Js.bind(e),e.Zs=e.Zs.bind(e),e.Xs=e.Xs.bind(e),e.Ys=e.Ys.bind(e),e.na=e.na.bind(e),e.ea=e.ea.bind(e),e.ia=e.ia.bind(e),e.ra=e.ra.bind(e),e.oa=e.oa.bind(e),e.aa=e.aa.bind(e),e.ua=e.ua.bind(e),e.la=e.la.bind(e),e.ha=e.ha.bind(e),e.ma=e.ma.bind(e),e.va=e.va.bind(e),e.ga=n.PhishingReviewUXFactory,e.ba(),(0,b.VE)()&&Promise.all([I.Pv.Resolve("IThirdPartyDateTimePicker"),(0,B.d)()]).then((function(){return e.setState({SubmitButtonDependencyReady:!0})})),e}return(0,i.ZT)(n,t),n.prototype.componentWillMount=function(){this.state.IsStudentViewMode?this.updateWithResponse(this.props.Response):this.populatePersistedAnswers(),this.formRuntimeMaster.observeAnswerChange(this.Os),this.formRuntimeMaster.observe(this._s,[K.l.Schema.RuntimeSectionId]),this.formRuntimeMaster.observe(this.As,[K.l.Schema.BranchChangeVersion,K.l.Schema.QuestionRuntimeMasters,K.l.Schema.UploadingFileCount]),window.addEventListener("resize",this.Rs),(0,L.NW)().oembedocv},n.prototype.componentDidMount=function(){return(0,i.mG)(this,void 0,void 0,(function(){var t,n,e,r,o,s,a,c,m=this;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return(0,R.C_)(),window.addEventListener("afterprint",(function(){window.setTimeout((function(){m.state.ReturnFromPrintResponse&&($(".form-content-container").appendTo($(".form-content")),$(".reactshellheader").show(),$(".top-view-container").show(),$("#content-root").show(),$(".title-menu-control-container, .menu-control-dropup").show(),m.setState({ShowPrintResult:!1}),m.state.ReturnFromPrintResponse=!1)}),1e3)})),this.props.ForcedLocaleId?(this.props.Master.ensureFieldsReady([this.props.Master.Schema.LocalizedResources]).then((function(){var t=m.props.Master.Model.LocalizedResources;t&&t[0]&&t[0].localeId==m.props.ForcedLocaleId&&m.setState({LocalizedResource:t[0],ShowSpinnerForFirstTimeLoadMultilingual:!1})})),[3,8]):[3,1];case 1:return this.state.IsStudentViewMode?(t=this.props.Response.SubmitLanguage)?(r=JSON.parse(t).localeId,[4,this.Ds(r)]):[3,3]:[3,4];case 2:i.sent(),this.ensureLayout(r),i.label=3;case 3:return[3,8];case 4:return(n=this.props.Master.Model.LocaleList).length>0?(e=this.props.Master.SyncContext===U.y.ResponseTimeForm,r=(0,f.W$)((0,d.k0)().cultureInfo.Name.toLowerCase()),o=this.Ps(),s=o.newLocaleId,a=o.forceUpdate,r=null!=s?s:r,(c=g.d.Collection.getItemWithKeyFields(this.props.Master.Model.LocaleList,{localeId:r}))?[4,this.Ds(r,a)]:[3,6]):[3,8];case 5:return i.sent(),this.ensureLayout(r),[3,7];case 6:this.ensureLayout(this.defaultLanguageId),r!==this.defaultLanguageId&&(0,Z.pd)((function(){var t=h(m.defaultLanguageId);(0,x.D1)(t).then((function(t){m.setState({LocalizedStrings:t})}))}),Z.t1),i.label=7;case 7:e&&(0,T.$U)("ResponsePage.MultiLingual.OpenForm",{browserLocaleId:r,defaultLocaleId:this.defaultLanguageId,firstRenderMatched:!!c,localeCount:n.length}),i.label=8;case 8:return this.ya(),k(),(0,l.w1)()||(0,u.x8)()||(0,b._y)()||(0,w.y)("ImmersiveReader"),[2]}}))}))},n.prototype.Ps=function(){(0,F.cvOnlyLanguageUtilityIoC)();return{newLocaleId:null,forceUpdate:!1}},n.prototype.ya=function(){return(0,i.mG)(this,void 0,void 0,(function(){var t,n,e;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return[4,this.wa()];case 1:return t=i.sent(),[4,this.Sa()];case 2:return n=i.sent(),[4,this.Na()];case 3:return e=i.sent(),this.setState({DuplicateNavBar:t,DuplicateMessage:n,ResultContainer:e}),[2]}}))}))},n.prototype.setResultContainer=function(t){return(0,i.mG)(this,void 0,void 0,(function(){var n,e;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return n=this.setState,e={},[4,this.Na()];case 1:return n.apply(this,[(e.ResultContainer=i.sent(),e),t]),[2]}}))}))},n.prototype.componentDidUpdate=function(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){return(0,R.C_)(),(0,S.z)($(".office-form-answerhint")),[2]}))}))},n.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.Rs),(0,L.NW)().oembedocv,this.formRuntimeMaster.observe(this._s),this.formRuntimeMaster.unobserveAnswerChange(this.Os),this.formRuntimeMaster.unobserve(this.As),this.formRuntimeMaster.release()},n.prototype.render=function(){var t=this;if(this.state.ShowSpinnerForFirstTimeLoadMultilingual)return this.Ca();var e,i=this.props.Master.SyncContext===U.y.SharedTimeForm;if(this.state.ShowErrorPage)return(0,O.a)({Error:this.error,FormId:this.props.Master.Model.Id,ShowCreateFormLink:!1});var o={className:(0,Z.pd)((function(){return"office-form-content office-form-page-padding"}),Z.t1)};this.props.HTMLAttributes&&(o.className=(0,m.j)(o.className,this.props.HTMLAttributes.className));var s=this.props.Master.Model;if(!this.state.IsReportingView&&this.state.ShowPhishingWarningBar&&(0,ot.mk)(s.ReputationTier)&&(o.className=(0,m.j)(o.className,"height-with-tip-bar")),i&&(o.className=(0,m.j)(o.className,"share-page")),(this.props.ViewMode===yt.w.Mobile||this.state.IsSmallScreen)&&(o.className=(0,m.j)(o.className,"small-screen")),this.isMobile()&&(o.className=(0,m.j)(o.className,"mobile-view")),3===this.state.SubmitState&&!this.state.ShowPrintResult||4===this.state.SubmitState&&!this.state.ShowQuizResult&&!this.state.ShowPrintResult){var a,u,c;this.props.Master.Model.Settings.RequiresUniqueResponse||this.props.Master.Model.Settings.DisableSubmitAnother||(a=function(){return t.Ia()}),4===this.state.SubmitState&&(u=this.Js),this.props.Master.Model.EmailReceiptEnabled&&(c=this.ks);var l=this.state.LocalizedResource.localeId;e=r.createElement(rt.U.Consumer,{children:function(n){return Q({FormMaster:t.props.Master,LocaleId:l!==t.defaultLanguageId&&l,LocalizedStrings:n.LocalizedStrings,ShowPromotionMessage:!(0,D.ft)(),submitAnother:a,viewResultsHandler:u,printResultsHandler:c,CustomStyle:!1,msRewardsThankYouProps:!1,SelectedThankYouMessage:!1})}}),(0,y.M5)()&&!this.isMobile()&&(e=r.createElement("div",null,e,r.createElement(ft)))}else if(this.state.IsReportingView)e=r.createElement(rt.U.Consumer,{children:function(n){return V({LocalizedStrings:n.LocalizedStrings,LocaleId:t.state.LocalizedResource.localeId,FormMaster:t.props.Master,hideAbuseReport:t.Ys})}});else{var f,h=!!this.state.ShowValidationStyle&&!!this.Ls().length;e=r.createElement("div",null,r.createElement("div",{"aria-label":this.props.Master.Model.Title,className:"office-form office-form-theme-shadow",role:"form"},this.Ta(),!this.isMobile()&&this.xa(),(0,Z.pd)((function(){return t.Fa()}),Z.t1),this.state.ResultContainer,r.createElement("div",{className:"office-form-body","data-id":f},this.Pa(),this.props.PrintView&&this.Da(),this.Ma(),this.props.PrintView&&n.createPrintTimePrivacyDeclare(),this.La(),this.Ra(),this.state.DuplicateMessage,r.createElement("div",{className:this.ws?"office-form-error-message-container compact-view":"office-form-error-message-container"},h?this.Aa():null,this.Ea()),this.Oa(),this._a())),this.Ba(f),this.Ha())}var d="form-content-container";this.props.ViewMode===yt.w.Mobile?d="form-content-container mobile-view":this.state.IsSmallScreen&&(d="form-content-container small-screen");var v=0===this.props.Master.Model.LocaleList.length||this.state.LocalizedResource.localeId===this.defaultLanguageId||this.props.Master.isFieldReady(this.props.Master.Schema.LocalizedResources)&&this.props.Master.Model.LocalizedResources&&this.props.Master.Model.LocalizedResources.length>0;return r.createElement(rt.U.Provider,{value:this.state,children:r.createElement("div",{className:d,ref:this.Fs,role:"main"},this.state.DuplicateNavBar,this.Ga(),this.qa(),this.Va(),r.createElement("div",o,this.props.HeaderMessage&&this.za(),r.createElement(pt.w,{ThemeMaster:this.props.Master.ThemeMaster}),!1,this.isMobile()&&this.xa(),v&&e),this.Qa(),this.Ua(),this.props.PrintView&&n.createPrintFooter())})},n.prototype.$a=function(){return(0,Z.pd)((function(){return null}),Z.t1)},n.prototype.updateWithResponse=function(t){t&&(this.Wa(t.Answers),this.formRuntimeMaster.updateWithResponse(t),this.setServerQuizResult(t.QuizResult),this.setState({ShowQuizResult:!0,IsStudentViewMode:!0}),this.setResultContainer())},n.prototype.Ba=function(t){if(!this.props.MobileReadOnly){var n="ShowStatementWithNotice";return this.props.Master.SyncContext===U.y.ResponseTimeForm&&(0,y.gq)()&&(n="ShowStatement"),r.createElement(ut.r,{FormMaster:this.props.Master,FooterType:n,FooterText:!1,LocaleId:this.state.LocalizedResource&&this.state.LocalizedResource.localeId,SectionId:t})}},n.prototype.qa=function(){if(this.ga)return this.ga.createPhishingWarningPage(this.props.Master,this.state.IsReportingView)},n.prototype.Va=function(){var t=this;if(this.props.Master.SyncContext===U.y.DesignTimeForm)return null;var n=this.props.Master.Model.ReputationTier,e=this.Ka()?"ShareForm":"Response";return(0,ot.mk)(n)&&!this.state.IsReportingView&&this.state.ShowPhishingWarningBar?r.createElement(rt.U.Consumer,{children:function(){return(0,_.vV)({Info:(0,ot.nW)(n,e),TipBarLocation:"Up",TipBarStyle:"YellowBackground",ShouldClose:!0,onClose:t.la})}}):void 0},n.prototype.ua=function(){this.setState({IsReportingView:!0})},n.prototype.la=function(){this.setState({ShowPhishingWarningBar:!1})},n.prototype.Ds=function(t,n){var e=this;void 0===n&&(n=!1),t!==this.defaultLanguageId&&this.props.Master.ensureFieldsReady([j.x.Schema.LocalizedResources]).then((function(){(0,Z.pd)((function(){if(e.state.IsStudentViewMode){var n=h(t);(0,x.D1)(n).then((function(n){e.setState({LocalizedStrings:n}),e.Ja(t)}))}else e.Ja(t)}),Z.t1)}))},n.prototype.Ja=function(t){var n=this;this.props.Master.getLocaleResouceById(t).then((function(t){var e=n.props.Master.Model.LocalizedResources,i=t.localizedResources;g.d.Collection.getItemWithKeyFields(e,{localeId:i[0].localeId})||g.d.Collection.itemsAddedInSource(e,i),n.setState({LocalizedResource:t&&i[0],ShowSpinnerForFirstTimeLoadMultilingual:!1})}))},n.prototype.Ma=function(){return this.state.HideQuestions?null:this.props.Master.hasSection()?this.Za():r.createElement("div",null,this.Xa(this.formRuntimeMaster.TopQuestionRuntimeMasters()))},n.prototype.Js=function(){this.setState({ShowQuizResult:!0})},n.prototype._a=function(){if(this.state.ShowQuizResult&&!this.state.ShowPrintResult&&4===this.state.SubmitState)return r.createElement("div",{className:"office-form-quiz-back-to-result-link"},r.createElement("a",{href:"javascript:void(0)",onClick:this.Zs},(0,x.pm)().Response_Page_Quiz_Result_Back_To_Thank_You_Message))},n.prototype.Zs=function(){this.setState({ShowQuizResult:!1})},n.prototype.za=function(){return r.createElement("div",{className:"form-header-text-message"},this.props.HeaderMessage)},n.prototype.wa=function(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return!(this.props.Master.SyncContext===U.y.SharedTimeForm)||this.state.IsReportingView?[2]:[4,e.e(678).then(e.bind(e,57319))];case 1:return[2,(0,t.sent().createDuplicateNavBarInternal)(this)]}}))}))},n.prototype.Ga=function(){var t=this;if(this.ga)return this.ga.createAdminPhishingReviewNavBar(this.props.Master,(function(n){t.error=n,t.setState({ShowErrorPage:!0})}))},n.prototype.Sa=function(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return this.props.Master.SyncContext!==U.y.SharedTimeForm?[3,2]:[4,e.e(678).then(e.bind(e,57319))];case 1:return[2,(0,t.sent().showDuplicateMessageInternal)(this)];case 2:return[2]}}))}))},n.prototype.Pa=function(){if(4!==this.state.SubmitState&&!this.state.IsStudentViewMode&&!this.props.MobileReadOnly){var t=[this.Ya(),this.iu()];return t.some((function(t){return!!t}))?r.createElement.apply(r,(0,i.ev)(["div",{className:"office-form-notice-container"}],t,!1)):void 0}},n.prototype.Ya=function(){var t=this,n=this.props.Master.Model.Settings,e=this.props.Master.SyncContext===U.y.SharedTimeForm,i=!this.formRuntimeMaster.ElementManager().isFirstPage();return e||i?void 0:r.createElement(rt.U.Consumer,{children:function(e){var i;if(n.IsAnonymous||n.NotRecordIdentity||t.props.PrintView)i="";else{var o=(0,d.k0)().userInfo.GivenName||(0,d.k0)().userInfo.DisplayName;o?i=e.LocalizedStrings.Response_NonAnonymous_Notice.format(o):((0,T.zU)("MissingUserName",{displayName:!!(0,d.k0)().userInfo.DisplayName,givenName:!!(0,d.k0)().userInfo.GivenName,userId:!!(0,d.k0)().userInfo.UserId}),i=e.LocalizedStrings.Response_NonName_Notice)}if(4!==t.state.SubmitState)return r.createElement("div",{},r.createElement("span",{className:"office-form-notice-long-text"},i))}})},n.prototype.iu=function(){if(!this.props.MobileReadOnly){var t=this.props.Master,n=[];return n=t.hasSection()&&!this.ou()?this.formRuntimeMaster.ElementManager().getCurrentSection().TopQuestionMasters.map((function(t){return t.Question.Model})):g.d.convertToArray(t.Model.Questions),s.some(n,(function(t){return t.Required}))?r.createElement(rt.U.Consumer,{children:function(t){return r.createElement("div",null,r.createElement("span",{className:"office-form-required-notice-star"}),r.createElement("span",null,t.LocalizedStrings.Answer_Required_Notice))}}):void 0}},n.prototype.Na=function(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return this.state.IsStudentViewMode||4===this.state.SubmitState?[4,Promise.resolve().then(e.bind(e,85451))]:[3,2];case 1:return[2,(0,t.sent().createResultContainerInternal)(this)];case 2:return[2]}}))}))},n.prototype.Aa=function(){var t=this;return r.createElement(rt.U.Consumer,{children:function(n){var e,i=t.Ls(),o=i.map((function(t){return n.LocalizedStrings.Form_QuestionWithOrdinal.format(t)})).join(n.LocalizedStrings.Common_ItemSeperator);e=t.formRuntimeMaster.ElementManager().hasNextSection()?n.LocalizedStrings.Section_Question_Error_Message.format(i.length,o):n.LocalizedStrings.Form_Question_Error_Message.format(i.length,o);var s=(0,Y.M)({FluentIcon:"Warning",HTMLAttributes:{className:"office-form-alert-icon forms-icon-size16x16"}}),a=!!t.state.ShowValidationStyle&&!!i.length,u="";return t.Ts%2==0&&(u=" "),r.createElement("div",{className:(0,m.j)("office-form-submit-error",a?"":"NotVisible"),role:"alert","aria-label":"".concat(u)},s,r.createElement("span",{className:"error-message"},a?e:""))}})},n.prototype.Ls=function(){return this.formRuntimeMaster.Form.hasSection()?this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.ElementManager().getCurrentSection().TopQuestionMasters):this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.TopQuestionRuntimeMasters())},n.prototype.Ca=function(){if(this.state.ShowSpinnerForFirstTimeLoadMultilingual)return r.createElement("div",{className:"multi-lingual-page-loading-background"},r.createElement("div",{className:"page-loading-messagebox",tabIndex:0,"aria-label":(0,x.pm)().Common_Loading_Text,"aria-live":"polite"},r.createElement("div",{className:"page-loading-animation"},r.createElement("div",{className:"spinner-tile-animation"})),r.createElement("div",{className:"page-loading-message"},(0,x.pm)().Common_Loading_Text)))},n.prototype.xa=function(){if(this.showMultiLingualSelect()){var t=this.props.Master.Model.LocaleList,n=[];n.push({DisplayName:this.defaultLanguageName,Key:"default-language",Value:this.defaultLanguageId}),s.forEach(t,(function(t){n.push({DisplayName:(0,F.getIoCCustomLanguageFriendlyName)(t.localeName||""),Key:t.localeId,Value:t.localeId||""})}));var e="multi-lingual-select-control office-form-theme-secondary-background";this.isMobile()&&(e=(0,m.j)(e,"isMobile"));var i=this.state.LocalizedResource.localeId,r=this.state.LocalizedStrings.MultiLingualEditionView_language_Name_label;return(0,tt.E)({HTMLAttributes:{className:e,disabled:this.props.MobileReadOnly},Label:r,onValueChange:this.aa,Placeholder:n[0]&&n[0].DisplayName,PlaceholderFluentIcon:"Globe",SelectOptions:n,Value:i})}},n.prototype.Qa=function(){if(this.state.ShowSpinnerWhenChangeLanguage)return r.createElement("div",{className:"multi-lingual-spinner-container"},r.createElement("div",{className:"multi-lingual-blank-page"}),r.createElement("div",{className:"multi-lingual-spinner"},r.createElement("div",{className:"spinner-tile-animation"})))},n.prototype.aa=function(t){var n=this;(0,T.$U)("ResponsePage.MultiLingual.ChangeLanguage",{LocaleId:t});var e=h(t);(0,x.D1)(e).then((function(i){n.ensureLayout(e),n.setState({LocalizedStrings:i}),n.au(t)}))},n.prototype.au=function(t){if(t!==this.defaultLanguageId){if(this.props.Master.isFieldReady(j.x.Schema.LocalizedResources)){var n=g.d.Collection.getItemWithKeyFields(this.props.Master.Model.LocalizedResources,{localeId:t});n?this.setState({LocalizedResource:n}):this.uu(t)}}else this.setState({LocalizedResource:{localeId:this.defaultLanguageId,localeName:this.defaultLanguageName}})},n.prototype.uu=function(t){var n=this;this.setState({ShowSpinnerWhenChangeLanguage:!0}),this.props.Master.getLocaleResouceById(t).then((function(t){g.d.Collection.itemsAddedInSource(n.props.Master.Model.LocalizedResources,t.localizedResources),n.setState({LocalizedResource:t&&t.localizedResources[0],ShowSpinnerWhenChangeLanguage:!1})}))},n.prototype.showMultiLingualSelect=function(){return!(!this.props.Master.Model.LocaleList.length||this.state.IsStudentViewMode||!this.ou()&&!this.formRuntimeMaster.ElementManager().isFirstPage())},n.prototype.Ta=function(){var t=this.props.Master,n=t.SyncContext===U.y.SharedTimeForm;if(!this.isMobile()&&(this.ou()||this.formRuntimeMaster.ElementManager().isFirstPage())&&(this.props.PrintView||!(!(0,y.gq)()&&(0,u.yv)()||(0,d.k0)().userInfo.IsMsa)&&n&&t.isFieldReady(j.x.Schema.DataClassificationLabel)&&t.Model.DataClassificationLabel)){var e=(0,m.j)(this.showMultiLingualSelect()?"office-form-duplicate-classification-label-with-multilingual":"office-form-duplicate-classification-label-without-multilingual","office-form-duplicate-classification-label","office-form-theme-secondary-background");return r.createElement(it.d,{FormMaster:this.props.Master,HTMLAttributes:{className:e},DesignTimeView:!1})}},n.prototype.Ka=function(){return this.props.Master.SyncContext===U.y.SharedTimeForm},n.prototype.cu=function(){return 1===this.state.SubmitState||5===this.state.SubmitState},n.prototype.ensureLayout=function(t){this.fu((0,f.Fp)(t),t)},n.prototype.fu=function(t,n){var e=this,i=this.props.Master.SyncContext===U.y.ResponseTimeForm,r=this.props.Master.SyncContext===U.y.DesignTimeForm&&!(0,l.tq)(),o=this.props.Master.SyncContext===U.y.DesignTimeForm&&(0,l.tq)(),s=t?"rtl":"ltr";i?($("html").attr("lang",n),$(".form-content").attr("dir",s),(0,p.g)(t?p.Y.ResponsePageRtl:p.Y.ResponsePage).then((function(){return e.forceUpdate()}))):r?($(".form-content").attr({dir:s,lang:n}),(0,p.g)(t?p.Y.DesignPageRtl:p.Y.DesignPage).then((function(){return e.forceUpdate()}))):o&&($(".form-content").attr({dir:s,lang:n}),(0,p.g)(t?p.Y.MobileDesignPageRtl:p.Y.MobileDesignPage).then((function(){return e.forceUpdate()})))},n.prototype.Fa=function(){var t=this.state.LocalizedResource.localeId;return(0,P.w)({Form:this.props.Master,LocaleId:t!==this.defaultLanguageId&&t,IsMobile:this.props.ViewMode===yt.w.Mobile||(0,l.tq)(),IsReadOnlyOnMobile:this.props.MobileReadOnly,IsSlimTitle:!this.ou()&&!this.formRuntimeMaster.ElementManager().isFirstPage(),ImmersiveReaderToggleProps:!this.props.DisableImmersiveReader&&{ShouldShowImmersiveReaderButtons:this.state.ShouldShowImmersiveReaderButtons,ToggleImmersiveReaderButtons:this.xs},ProgressBarDesc:this.du()?this.mu():void 0})},n.prototype.pu=function(){},n.prototype.bu=function(t,n){var e=t.Section,i=t.TopQuestionMasters;if(!e)return this.Xa(i);var o=e.Model.Id,s=this.state.LocalizedResource.localeId,a=[];n||a.push(r.createElement(vt.b,{HasTheme:!this.isMobile(),key:"form-section-breaker-"+o}));var u=this.Xa(i);return a.push(r.createElement(gt.p,{children:u,Disabled:!0,DisableShuffle:!0,Expaned:!0,IsMobile:this.props.ViewMode===yt.w.Mobile||(0,l.tq)(),LocaleId:s!==this.defaultLanguageId&&s,key:"form-section-container-"+o,SectionMaster:e,ShouldShowImmersiveReaderButtons:this.state.ShouldShowImmersiveReaderButtons})),a},n.prototype.Za=function(){var t=this;if(this.ou())return[this.formRuntimeMaster.ElementManager().getAllSections().map((function(n,e){return t.bu(n,0===e)}))];var n=this.formRuntimeMaster.ElementManager().getCurrentSection();return this.bu(n,!0)},n.prototype.Xa=function(t){var n=this;if(t.length<=0)return null;var e,i=this.state.ShowValidationStyle,o=this.state.ShowQuizResult,a=this.state.ShowPrintResult;(0,Z.pd)((function(){e=s.indexOf(n.formRuntimeMaster.TopQuestionRuntimeMasters(),t[0])+1}),Z.t1);var u=this.state.LocalizedResource.localeId;return r.createElement(rt.U.Consumer,{children:function(r){return t.map((function(t,s){var c=t.Question.Model.Id,l=e+s,f={SyncContext:n.props.Master.SyncContext,Master:t,LocaleId:u!==n.defaultLanguageId&&u,LocalizedStrings:r.LocalizedStrings,Ordinal:l,Disabled:4===n.state.SubmitState||n.state.IsStudentViewMode||n.props.ReadOnlyMode||t.Question.hasRuntimeError()||n.props.Master.SyncContext===U.y.ResponseDetailTimeForm,key:c,IsMobile:n.isMobile(),IsPrintViewDesignTime:n.props.PrintView,ShowValidationStyle:i,ShowQuizResult:o,ShowPrintResult:a,ShowPhishingWarning:n.yu(),ShowFileInfo:!!n.props.HeaderMessage,HideMedia:!1,IsStudentViewMode:n.state.IsStudentViewMode,HideDeleteButton:n.cu()||4===n.state.SubmitState||n.state.IsStudentViewMode,increaseUploadingFileCountCallBack:n.Qs,decreaseUploadingFileCountCallBack:n.Us,setAbuseReportStateCallBack:n.$s,EnableShowHideQuestion:(0,Z.pd)((function(){return!1}),Z.t1),ShouldShowImmersiveReaderButtons:n.state.ShouldShowImmersiveReaderButtons,IncrementalLoadFormsEnabled:!!n.props.IncrementalQuestionLoader,SmallScreenCutoffOverride:n.Ns};return(0,mt.n)(f)}))},key:"elementRenderers"})},n.prototype.wu=function(){var t=this;return this.Su()?r.createElement(rt.U.Consumer,{children:function(n){return r.createElement("div",{className:"office-form-bottom-button-div"},(0,et.E)({HTMLAttributes:{className:"section-next-button office-form-bottom-button office-form-theme-button",disabled:!!t.formRuntimeMaster.Model.UploadingFileCount,onKeyUp:t.ra,onMouseUp:t.ia},ButtonStyle:1,Text:(0,L.NW)().oembedocv?n.LocalizedStrings.SEND_LABEL:n.LocalizedStrings.Common_Next_Text}))}}):null},n.prototype.Iu=function(){var t=this;if(this.ou()||!this.formRuntimeMaster.ElementManager().hasPrevSection()){return null}var n=this.cu()||!!this.formRuntimeMaster.Model.UploadingFileCount;return r.createElement(rt.U.Consumer,{children:function(e){return r.createElement("div",{className:"office-form-bottom-button-div"},(0,et.E)({HTMLAttributes:{className:"office-form-bottom-button office-form-dark-theme-button gray-background",disabled:n,onKeyUp:t.ea,onMouseUp:t.na},ButtonStyle:1,Text:(0,L.NW)().oembedocv?e.LocalizedStrings.Common_Previous_Text:e.LocalizedStrings.Common_Back_Text}))}})},n.prototype.Ea=function(){var t=this,n=(0,Y.M)({FluentIcon:"Warning",HTMLAttributes:{className:"office-form-alert-icon forms-icon-size16x16"}}),e=this.cu()&&this.state.ShowLongOperationMessage;if(2===this.state.SubmitState||e)return r.createElement(rt.U.Consumer,{children:function(i){return r.createElement(nt.L,{HTMLAttributes:{className:(0,m.j)("office-form-submit-error",e?"submitting-warning":"")},LazyRendering:!0,Role:"Alert"},e?void 0:n,r.createElement("span",{className:"error-message"},e?i.LocalizedStrings.RetryRecoverableErrorMessage_Submitting:t.state.ErrorMessage))}})},n.prototype.Su=function(){return!this.ou()&&this.formRuntimeMaster.ElementManager().hasNextSection()},n.prototype.Ua=function(){var t,n,e=this.props.Master;if(3===this.state.SubmitState){if(this.state.LocalizedResource&&this.state.LocalizedResource.localeId!==e.Model.DefaultLanguage)t=W.k.getFormResourceMaster(this.state.LocalizedResource.localeId,e).Model.thankYouMessage;t=t||e.Model.ThankYouMessage||this.state.LocalizedStrings.Renderer_SubmissionSucceeded,n=this.state.LocalizedStrings.Response_Page_Thanks}return r.createElement("div",{className:"office-form-submit-success-hint","aria-live":"polite"},r.createElement("div",null,n),r.createElement("div",null,t))},n.prototype.Tu=function(){return!1},n.prototype.ku=function(){var t=this;if(!(this.Su()||4===this.state.SubmitState||this.state.IsStudentViewMode||this.props.MobileReadOnly||this.Tu())){var n=this.cu(),e=n||!this.state.SubmitButtonDependencyReady||this.props.Master.SyncContext===U.y.SharedTimeForm||this.props.Master.SyncContext===U.y.AdminPhishingReviewForm||this.props.Master.SyncContext===U.y.ResponseDetailTimeForm||this.props.DisableSubmitButton||(0,A.m$)()||!!this.formRuntimeMaster.Model.UploadingFileCount||!1;return r.createElement(rt.U.Consumer,{children:function(o){return r.createElement("div",{className:"__submit-button-div__ office-form-bottom-button-div"},(0,et.E)({HTMLAttributes:{className:(0,m.j)("__submit-button__ office-form-bottom-button office-form-theme-button",n?"office-form-hide-text":""),disabled:e,title:(0,A.m$)()?o.LocalizedStrings.Renderer_SubmitButtonSPODisabledTitle:void 0,onClick:function(){return(0,i.mG)(t,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){return this.va(o),[2]}))}))}},ButtonStyle:1,Text:(0,L.NW)().oembedocv?o.LocalizedStrings.SEND_LABEL:(0,Z.pd)((function(){return o.LocalizedStrings.Renderer_SubmitButtonText}),(function(){var n=o.LocalizedStrings.Renderer_SubmitButtonText,e=t.formRuntimeMaster.CurrentRuleManager();return(0,b.cr)("CVAdvBranchingImprovements")&&e&&e.getChainedStatus()&&e.getIsChainedSurvey()&&(n=o.LocalizedStrings.Common_Next_Text),n}))}),t.xu())}})}},n.prototype.Fu=function(t){return(0,i.mG)(this,void 0,void 0,(function(){var n=this;return(0,i.Jh)(this,(function(r){return 0!==this.state.SubmitState&&2!==this.state.SubmitState||this.setState({SubmitState:5},(function(){return(0,i.mG)(n,void 0,void 0,(function(){var n;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),[4,e.e(653).then(e.bind(e,43367))];case 1:return n=i.sent().handleSubmitButtonClickIoC,5!==this.state.SubmitState?[3,3]:[4,n(t,this)];case 2:i.sent(),i.label=3;case 3:return[3,5];case 4:return i.sent(),this.setState({SubmitState:2,ErrorMessage:t.LocalizedStrings.Error_Message_15001}),[3,5];case 5:return[2]}}))}))})),[2]}))}))},n.prototype.xu=function(){if(this.cu())return r.createElement("div",{className:"submit-spinner"},r.createElement("div",{className:"common-spinner-circle"},r.createElement(nt.L,{HTMLAttributes:{className:"screenReaderVisible"},LazyRendering:!0,Role:"Log",children:(0,x.pm)().Response_Page_Submitting_Message})))},n.prototype.SetMsRewardsThankyouState=function(t){},n.prototype.setThankYouMessageState=function(){},n.prototype.Ia=function(){var t=this;(0,T.$U)("ResponsePage.ThanksView.SubmitAnother"),this.Wa(),this.Ms(),this.formRuntimeMaster.updateWithResponse(null),this.setState({ErrorMessage:void 0,ShowValidationStyle:!1,ShowQuizResult:!1,SubmitState:0,ShowLongOperationMessage:!1,IsStudentViewMode:!1,HideQuestions:!0,EmailReceiptConsent:!1},(function(){t.setState({HideQuestions:!1},n.scrollToTop)}))},n.prototype.Wa=function(t){this.startTime=new Date,this.formRuntimeMaster.clearQuizResult(),this.formRuntimeMaster.Answers=t||[]},n.prototype.Ms=function(t){this.formRuntimeMaster.Model.RuntimeSectionId=t||null},n.prototype.populatePersistedAnswers=function(t){if(!this.state.IsStudentViewMode){var n=(this.props.PersistedAnswers||[]).slice(0);if(t&&this.props.AnswerStorage){var e=[];(this.props.AnswerStorage.Answers||[]).forEach((function(t){var r=t.QuestionId,o=t.Answer;if(null!==o){var a=s.findIndex(n,(function(t){return t.QuestionId===r}));a>-1?n[a]=(0,i.pi)((0,i.pi)({},n[a]),{Answer:o}):e.push(t)}})),n=n.concat(e)}this.Wa(n)}},n.prototype.setServerQuizResult=function(t){if(t){var n=(0,v.d)(t);Array.isArray(n)&&this.formRuntimeMaster.setQuizResults(n)}else this.formRuntimeMaster.calculateQuizResultFromModel()},n.prototype.isMobile=function(){switch(this.props.ViewMode){case yt.w.Desktop:return!1;case yt.w.Mobile:return!0;default:return(0,l.tq)()}},n.prototype.Os=function(){var t=this.props.persistAnswer;t&&(this.formRuntimeMaster.isDefaultAnswer()?t(void 0):t(g.d.convertToArray(this.formRuntimeMaster.Answers)));var n=this.Ls().length;n!==this.state.WrongQuestionCount&&this.setState({WrongQuestionCount:n})},n.prototype.Bs=function(){return!1},n.prototype.Vs=function(){return!1},n.prototype.zs=function(){return!1},n.prototype._s=function(){var t=this.props.persistSectionId;t&&(null==this.formRuntimeMaster.Model.RuntimeSectionId?t():t(this.formRuntimeMaster.Model.RuntimeSectionId));var n={ShowValidationStyle:!1};if(this.state.ShowProgressBar){var e=this.formRuntimeMaster.calcProgressBarInfo(),i=e.currentPageNumber,r=e.totalPageNumber;i!==this.state.CurrentPageNumber&&(n.CurrentPageNumber=i),r!==this.state.TotalPageNumber&&(n.TotalPageNumber=r)}this.setState(n,this.ma)},n.prototype.ma=function(){this.Is||(0,bt.Vh)(o.findDOMNode(this)),n.scrollToTop()},n.prototype.Qs=function(){this.formRuntimeMaster.Model.UploadingFileCount++},n.prototype.Us=function(){this.formRuntimeMaster.Model.UploadingFileCount>0&&this.formRuntimeMaster.Model.UploadingFileCount--},n.prototype.$s=function(){this.setState({IsReportingView:!0})},n.prototype.Ys=function(){this.setState({IsReportingView:!1})},n.prototype.Rs=function(){(0,A.rA)(this.Ns)!==this.state.IsSmallScreen?this.setState({IsSmallScreen:!this.state.IsSmallScreen}):(0,R.C_)()},n.prototype.Oa=function(){var t=this;if(this.yu())return r.createElement(rt.U.Consumer,{children:function(n){return r.createElement("div",{className:"office-form-notice-password"},n.LocalizedStrings.Response_Page_Footer_Notice,r.createElement("a",{className:(0,c.o)()?"office-form-notice-report office-form-theme-spo-link":"office-form-notice-report",href:"javascript:void(0)",onClick:function(){return t.setState({IsReportingView:!0})}},n.LocalizedStrings.Response_Page_Footer_Report))}})},n.prototype.yu=function(){var t=this.props.Master.Model.Settings,n=this.props.Master.SyncContext===U.y.ResponseTimeForm;if(!t.IsAnonymous||!n||this.state.ShowQuizResult||(0,u.x8)())return!1;var e=!1;return(0,Z.pd)((function(){e=(0,b.cr)("HideReportAbuse")}),Z.t1),!e},n.prototype.Ha=function(){var t=this;return this.state.ShowSensitiveInfoWarning?r.createElement(rt.U.Consumer,{children:function(n){return e={Context:n,ShowReportAbuse:t.yu(),cancel:function(){return t.setState({ShowSensitiveInfoWarning:!1})},reportAubse:function(){return t.setState({IsReportingView:!0})},submit:function(){t.setState({ShowSensitiveInfoWarning:!1}),t.Fu(n)}},i=function(){return e.cancel()},o=(0,st.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{autoFocus:!0,className:"sensitiveinfo-close",onClick:i},FluentIcon:"Dismiss",IconClassName:"forms-icon-size16x16",Text:e.Context.LocalizedStrings.Common_Close_Text}),s=(0,et.E)({HTMLAttributes:{autoFocus:!1,className:"sensitiveinfo-button",onClick:function(){return e.submit()}},ButtonStyle:1,Text:e.Context.LocalizedStrings.Renderer_SubmitButtonText}),a=(0,et.E)({HTMLAttributes:{autoFocus:!1,className:"sensitiveinfo-button",onClick:i},ButtonStyle:1,Text:e.Context.LocalizedStrings.Common_Cancel_Text}),u=e.ShowReportAbuse?r.createElement("div",{className:"sensitiveinfo-abuse"},e.Context.LocalizedStrings.Response_Page_Footer_Notice,r.createElement("a",{className:"office-form-notice-report",href:"javascript:void(0)",onClick:function(){return e.reportAubse()}},e.Context.LocalizedStrings.Response_Page_Footer_Report)):null,r.createElement("div",{"aria-label":e.Context.LocalizedStrings.Response_Page_SensitiveInfo_Dialog,className:"sensitiveinfo-container",style:{lineHeight:"normal"}},r.createElement("div",{className:"sensitiveinfo-dialog"},o,r.createElement("div",{className:"sensitiveinfo-box"},r.createElement("div",{className:"sensitiveinfo-title"},e.Context.LocalizedStrings.Response_Page_SensitiveInfo_Dialog_Title),r.createElement("div",{className:"sensitiveinfo-subtitle"},e.Context.LocalizedStrings.Response_Page_SensitiveInfo_Dialog_Subtitle),r.createElement("div",{className:"form-sensitive-button-contianer"},r.createElement("div",{className:"sensitiveinfo-buttons"},s,a)),u)));var e,i,o,s,a,u}}):null},n.scrollToTop=function(){(0,M.n1)($(".office-form-title-container"),$(".office-form-content"),void 0,void 0,!0)},n.scrollToShowSubmitError=function(){(0,M.n1)($(".office-form-submit-error"),$(".office-form-content"),void 0,20,!0)},n.prototype.La=function(){var t=this,n=this.props.Master.Model,e=n.EmailReceiptEnabled&&!(0,u.x8)()&&!n.Settings.IsAnonymous&&!n.Settings.NotRecordIdentity&&!this.state.ShowQuizResult&&!this.state.ShowPrintResult&&!this.Su(),i=!this.state.ShowQuizResult&&!this.state.ShowPrintResult&&!this.Su()&&n.EmailReceiptEnabled;return r.createElement(rt.U.Consumer,{children:function(n){return e?(0,X.e)({HTMLAttributes:{className:"office-form-email-receipt-checkbox"},Value:t.state.EmailReceiptConsent,Description:n.LocalizedStrings.Response_Page_EmailReceipt_Checkbox_Description,SpanClassName:"office-form-email-receipt-checkbox-description",onValueChange:function(n){t.setState({EmailReceiptConsent:n})}}):i?r.createElement("div",{className:"office-form-email-receipt-checkbox"},r.createElement("label",{},r.createElement("span",{className:"email-anonymous-des"},n.LocalizedStrings.Response_EmailReceipt_Anonymous),t.props.children)):null}})},n.prototype.Ra=function(){return r.createElement("div",{className:"office-form-navigation-container","data-id":this.formRuntimeMaster.Model.RuntimeSectionId},r.createElement("div",{className:"office-form-button-container"},this.Iu(),!1,!this.state.ShowPrintResult&&this.ku(),this.wu()),this.Pu())},n.prototype.Pu=function(){if(this.du()){var t=(0,J.k)({$CurrentStep:this.state.CurrentPageNumber,$TotalSteps:this.state.TotalPageNumber,$DescriptionText:this.mu()});return r.createElement("div",{className:"progress-bar-container"},t)}},n.prototype.du=function(){var t=this.state,n=t.ShowProgressBar,e=t.CurrentPageNumber,i=t.TotalPageNumber;return n&&e>0&&i>1&&!this.ou()},n.prototype.mu=function(){return this.state.LocalizedStrings.Response_Page_ProgressBar_Description.format(this.state.CurrentPageNumber,this.state.TotalPageNumber)},n.prototype.Du=function(){return!(this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.ElementManager().getCurrentSection().TopQuestionMasters).length>0)||(this.setState({ShowValidationStyle:!0},n.scrollToShowSubmitError),!1)},n.prototype.Xs=function(){this.formRuntimeMaster.ElementManager().gotoPrevSection()},n.prototype.na=function(){this.Is=!0;this.formRuntimeMaster.ElementManager().isFirstPage();this.formRuntimeMaster.ElementManager().gotoPrevSection()},n.prototype.ea=function(t){switch(t.keyCode){case 13:case 32:this.Is=!1;this.formRuntimeMaster.ElementManager().isFirstPage();this.formRuntimeMaster.ElementManager().gotoPrevSection()}},n.prototype.oa=function(){(this.props.Master.SyncContext===U.y.SharedTimeForm||this.Du())&&this.formRuntimeMaster.ElementManager().gotoNextSection()},n.prototype.va=function(t){this.formRuntimeMaster.TopQuestionRuntimeMasters().some((function(t){return t.Model.HasSensitiveInfo}))&&(0,b.cr)("SensitiveInfoCheckInResponsePage")&&((0,b.cr)("SensitiveInfoCheckForAllForms")||this.props.Master.Model.Settings.IsAnonymous)?this.setState({ShowSensitiveInfoWarning:!0}):this.Fu(t)},n.prototype.ia=function(){(this.props.Master.SyncContext===U.y.SharedTimeForm||this.Du())&&(this.Is=!0,this.formRuntimeMaster.ElementManager().gotoNextSection())},n.prototype.ra=function(t){switch(t.keyCode){case 13:case 32:(this.props.Master.SyncContext===U.y.SharedTimeForm||this.Du())&&(this.Is=!1,this.formRuntimeMaster.ElementManager().gotoNextSection())}},n.prototype.Mu=function(){},n.prototype.ou=function(){return this.state.ShowQuizResult||this.props.PrintView||this.props.MobileReadOnly||this.state.ShowPrintResult},n.prototype.As=function(){this.forceUpdate()},n.prototype.ha=function(){},n.prototype.Sr=function(){return this.props.PrintView||this.props.MobileReadOnly},n.prototype.ba=function(){return(0,i.mG)(this,void 0,Promise,(function(){var t;return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return t=!1,[4,(0,E.UF)()];case 1:return n.sent()&&(t=!this.isMobile()),this.setState({ShouldShowImmersiveReaderButtons:t}),[2]}}))}))},n.prototype.Da=function(){if(!this.props.Master.Model.Settings.NotRecordIdentity&&!this.props.Master.Model.Settings.IsAnonymous){var t=this.state.LocalizedStrings.Print_Form_Record_UserName_Question_Title;return r.createElement("div",{className:"print-user-name-record"},r.createElement("div",{className:"print-user-name-title-line"},r.createElement("span",{className:"print-user-name-remand-icon"},"*"),r.createElement("div",{className:"print-user-name-record-title"},t)),r.createElement("input",{className:"print-user-name-record-input"}))}},n.createPrintTimePrivacyDeclare=function(){var t=(0,x.pm)().Print_Form_Privacy_Declaration;return r.createElement("div",{className:"print-privacy-declare"},r.createElement("div",{className:"print-privacy-declare-boundary"}),r.createElement("div",{className:"print-privacy-declare-content"},t),r.createElement("div",{className:"print-privacy-info"},r.createElement("img",{className:"print-privacy-icon",src:(0,a.Jn)("/Images/forms-logo-128.png")}),r.createElement("span",{className:"print-privacy-text"},(0,x.pm)().Page_Title)))},n.createPrintFooter=function(){return r.createElement("div",{className:"print-footer"},r.createElement("span",{className:"print-footer-date"},(new Date).toFormatString("M/d/yyyy",(0,d.k0)().cultureInfo)))},n}(at.r)},40947:function(t,n,e){"use strict";e.d(n,{B2:function(){return d},Yi:function(){return h},zg:function(){return v}});var i=e(59312),r=e(87363),o=e(61533),s=e(94283),a=e(43209),u=e(72467),c=e(77494),l=e(90819),f=e(31442);function h(t){return r.createElement(v,{Image:t.Image,ImageSettings:t.ImageSettings,ImageType:t.ImageType})}function d(t){return r.createElement("div",{className:"image-spinner",id:t&&m(t)},r.createElement("div",{className:"common-spinner-circle"}))}function m(t){return"imageSpinner-"+t.ResourceId}var v=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.vo=!0,n.As=function(){return n.forceUpdate()},n.Ru=function(){return n.Eu()},n}return(0,i.ZT)(n,t),n.prototype.componentDidMount=function(){var t=(0,u.Cu)().Schema,n=(0,u.BF)().Schema;this.props.ImageSettings.observe(this.As),this.props.Image.observe(this.As,[t.ResourceUrl,t.ContentType,t.OriginalFileName]),this.props.ImageSettings.observe(this.Ru,[n.ContainerHeight,n.ContainerWidth,n.Left,n.Top]),this.props.Image.observe(this.Ru,[t.AltText]),this.Ou()},n.prototype.componentDidUpdate=function(){this.Ou()},n.prototype.componentWillUnmount=function(){this.vo=!1,this.props.ImageSettings.unobserve(this.As),this.props.Image.unobserve(this.As),this.props.ImageSettings.unobserve(this.Ru),this.props.Image.unobserve(this.Ru)},n.prototype.render=function(){var t=this,n=this.props.Image.Model,e=this.props.ImageSettings.validateImageSettings(!0),i=0;return r.createElement("img",{src:n.ResourceUrl,alt:n.AltText,height:e.ContainerHeight+"px",width:e.ContainerWidth+"px",style:{visibility:"hidden"},onLoad:function(){(0,f.w6)("Image.ImageOnLoad.Success",{imageType:t.props.ImageType,location:"1"}),(0,s.OE)(2,{$imageType:t.props.ImageType,$location:"RenderCard"})},onError:function(e){if(i<3&&"Response"===(0,a.C2)()){var r=o.findDOMNode(t);i++;var u=n.ResourceUrl+"?"+i;window.setTimeout((function(){$(r).attr("src",u)}),1e3)}else(0,f.$U)("Image.ImageOnLoad.Failure",{imageType:t.props.ImageType,location:"1"}),(0,s.OE)(1,{$imageType:t.props.ImageType,$location:"RenderCard"})}})},n.prototype.Ou=function(){var t=this,n=this.props.Image&&this.props.Image.Model;if(n&&n.ResourceUrl&&!this._u()){var e=o.findDOMNode(this),i=0;e&&this.props.ImageSettings&&(e.onload=function(){return t.Eu()},e.onerror=function(r){if(i<3&&"Response"===(0,a.C2)()){i++;var o=n.ResourceUrl+"?"+i;window.setTimeout((function(){$(e).attr("src",o)}),1e3)}else{(0,f.$U)("Image.CanvasOnLoad.Failure",{imageSrc:e.src,imageType:t.props.ImageType,location:"1"});var s=document.getElementById(m(n));s&&$(s).css("display","none"),$(e).css("visibility","visible")}})}},n.prototype.Eu=function(){if(this.vo){var t=this.props.Image&&this.props.Image.Model;if(t&&t.ResourceUrl&&!this._u()){var n=o.findDOMNode(this);if($(n).siblings("canvas").remove(),n&&this.props.ImageSettings)try{var e=document.createElement("canvas"),i=this.props.ImageSettings.validateImageSettings(!0);e.tabIndex=-1;var r=1*i.NaturalWidth/i.ActualWidth,s=Math.abs(i.Left*r);s=Math.floor(Math.min(s,i.NaturalWidth));var a=Math.abs(i.Top*r);a=Math.floor(Math.min(a,i.NaturalHeight));var u=i.ContainerWidth*r||i.NaturalWidth;u=Math.floor(Math.min(u,i.NaturalWidth));var l=i.ContainerHeight*r||i.NaturalHeight;l=Math.floor(Math.min(l,i.NaturalHeight));try{var h=isNaN(window.devicePixelRatio)?1:window.devicePixelRatio;h=Math.ceil(Math.max(h,r)),e.width=Math.floor(i.ContainerWidth*h),e.height=Math.floor(i.ContainerHeight*h),t.AltText&&(e.setAttribute("role","img"),e.setAttribute("aria-label",t.AltText)),e.getContext("2d").drawImage(n,s,a,u,l,0,0,e.width,e.height)}catch(t){$(n).css("visibility","visible");var d=t.message||void 0,v=t.stack||void 0;return void(0,f.$U)("Image.CanvasRender.Failure",{imageSrc:n.src,imageType:this.props.ImageType,location:"1",error:d+" "+v,Exception:"DrawImageCanvas"})}var g=document.getElementById(m(t));g&&$(g).css("display","none"),$(n).css("display","none"),$(n).parent().append(e),(0,f.$U)("Image.CanvasRender.Success",{imageType:this.props.ImageType,location:"1"}),(0,c.C_)()}catch(t){d=t.message||void 0,v=t.stack||void 0;throw(0,f.$U)("Image.CanvasRender.Failure",{imageSrc:n.src,imageType:this.props.ImageType,location:"1",error:"".concat(d," ").concat(v),Exception:"CreateImageCanvas"}),t}}}},n.prototype._u=function(){return this.props.Image.Model.ImageProcessingStatus!==l.nv.Idle},n}(e(23112).r)},85451:function(t,n,e){"use strict";e.r(n),e.d(n,{createResultContainerInternal:function(){return s},validateQuizPoint:function(){return c}});var i=e(87363),r=e(7645),o=e(65863);function s(t){var n=function(t){if(t.state.IsStudentViewMode){var n=t.props.Response.Feedback;if(n){var e=(0,r.pm)().RuntimeView_FormComment.format(n),s=(0,o.q)({Text:e,ContainsHtml:!0,RenderMode:"RichText"});return i.createElement("div",{className:"office-form-formcomment-container"},i.createElement("div",{className:"office-form-formcomment office-form-theme-primary-foreground"},s))}return}}(t),e=function(t){var n=0,e=0,o=0,s=0,a=!1;(4===t.state.SubmitState||t.state.IsStudentViewMode)&&t.formRuntimeMaster.TopQuestionRuntimeMasters().forEach((function(i){var r=i.Question.Model,u=i.Question;if(r.IsQuiz)if(u.hasCorrectAnswers(i.Model.QuizResult)&&++o,e+=r.Point||0,s+=i.Model.QuizResult&&i.Model.QuizResult.IsAnswerCorrect?1:0,4===t.state.SubmitState)n+=i.Model.QuizResult&&i.Model.QuizResult.IsAnswerCorrect&&r.Point||0,a=!0;else{var c=i.SubQuestionRuntimeMasters,l=(i=c[c.length-1]||i).getScore();null!=l&&(n+=l,a=!0)}}));if(o||e){var u={className:"office-form-totalscore-bar",tabIndex:-1,autoFocus:!0};if(0===e&&0===n){var c=Math.round(100*s/o)+"%";return u["aria-label"]=(0,r.pm)().Response_Preview_SubmitNotificationUnderAutoReleaseGrade.format((0,r.pm)().Response_QuizResult_Title,c),i.createElement("div",u,i.createElement("div",{className:"office-form-point-label"},(0,r.pm)().Common_Points_Text+":"),i.createElement("div",{className:"office-form-score-label office-form-theme-primary-foreground"},c))}var l=a?n:"-",f=e||"-";return u["aria-label"]=(0,r.pm)().Response_Preview_SubmitNotificationUnderAutoReleaseGrade.format((0,r.pm)().Response_QuizResult_Title,(0,r.pm)().Response_ScoreResult_Transcript.format(l,e)),i.createElement("div",u,i.createElement("div",{className:"office-form-point-label"},(0,r.pm)().Common_Points_Text+":"),i.createElement("div",{className:"office-form-score-label office-form-theme-primary-foreground"},(0,r.pm)().RuntimeView_TotalPoints_Content.format(l,f)))}return null}(t);if(n||e)return i.createElement("div",{className:"office-form-result-container"},n,e)}var a=/^[0-9.]*$/,u=/[0-9]$/;function c(t,n){if(void 0===n&&(n=100),t&&!a.test(t))return null;var e=Number("0"+t);if(isNaN(e))return null;var i=(e-Math.floor(e)).toString();return("0"===i||"0.5"===i)&&e>=0&&e<=n?{point:e,pointString:!!t&&u.test(t)?(Math.floor(10*e)/10).toString():t}:null}},46872:function(t,n,e){"use strict";e.d(n,{f:function(){return r}});var i=e(7645);function r(t){var n=(0,i.pm)().Quiz_Points_BracketsText_Singular,e=(0,i.pm)().Quiz_Points_BracketsText_Plural;return(1===t?n:e).format(t)}},58537:function(t,n,e){"use strict";var i;e.d(n,{w:function(){return i}}),function(t){t[t.Desktop=0]="Desktop",t[t.Mobile=1]="Mobile",t[t.Auto=2]="Auto",t[t.Embed=3]="Embed"}(i||(i={}))},69856:function(t,n,e){"use strict";var i,r;e.d(n,{K:function(){return i},d:function(){return r}}),function(t){t[t.Unknown=0]="Unknown",t[t.Form=1]="Form",t[t.Meeting=2]="Meeting",t[t.Loop=3]="Loop"}(i||(i={})),function(t){t[t.SummaryInsight=0]="SummaryInsight",t[t.CorrelationInsight=1]="CorrelationInsight",t[t.ExplainDiffInsight=2]="ExplainDiffInsight",t[t.Outstanding=3]="Outstanding",t[t.OutstandingCollection=4]="OutstandingCollection",t[t.AssociationRuleInsight=5]="AssociationRuleInsight",t[t.FunctionalDependency=6]="FunctionalDependency",t[t.IntraclassInsight=7]="IntraclassInsight",t[t.RatingKeywordsInsight=8]="RatingKeywordsInsight",t[t.LikertAssociationRuleInsight=9]="LikertAssociationRuleInsight",t[t.PartialOrderInsight=10]="PartialOrderInsight",t[t.NPSKeywordsInsight=11]="NPSKeywordsInsight",t[t.ResponseSentimentInsight=12]="ResponseSentimentInsight",t[t.KeywordSentimentInsight=13]="KeywordSentimentInsight",t[t.KeyPhrasesInsight=14]="KeyPhrasesInsight",t[t.SummaryDistribution=15]="SummaryDistribution",t[t.SummaryDistributionCollection=16]="SummaryDistributionCollection",t[t.CorrelationInsightCollection=17]="CorrelationInsightCollection",t[t.ResponseSentimentInsightCollection=18]="ResponseSentimentInsightCollection",t[t.RatingDistributionAnalysisInsight=21]="RatingDistributionAnalysisInsight",t[t.AllHandsSummaryInsight=22]="AllHandsSummaryInsight",t[t.RatingDistributionInsight=25]="RatingDistributionInsight",t[t.RatingImpactInsight=26]="RatingImpactInsight",t[t.TextClusterInsight=28]="TextClusterInsight",t[t.TimeDistributionInsight=29]="TimeDistributionInsight",t[t.LikertImpactAnalysisInsightCollection=30]="LikertImpactAnalysisInsightCollection",t[t.DrivingFactorAnalysisInsightCollection=31]="DrivingFactorAnalysisInsightCollection",t[t.ResponseWordCloudInsight=32]="ResponseWordCloudInsight",t[t.EngagementOverview=33]="EngagementOverview",t[t.EngagementTrendInsight=34]="EngagementTrendInsight"}(r||(r={}))},5699:function(t,n,e){"use strict";e.d(n,{$A:function(){return S},$w:function(){return h},Bv:function(){return f},Cm:function(){return P},E1:function(){return H},Gy:function(){return k},Hs:function(){return i},J9:function(){return o},KF:function(){return v},L:function(){return R},N5:function(){return z},OP:function(){return G},QA:function(){return l},QM:function(){return L},Q_:function(){return A},Qx:function(){return B},Tb:function(){return c},VZ:function(){return C},W1:function(){return p},bf:function(){return d},er:function(){return w},f0:function(){return a},gK:function(){return T},gU:function(){return D},hj:function(){return b},i:function(){return V},i7:function(){return _},iA:function(){return I},iQ:function(){return E},l3:function(){return y},lV:function(){return M},lv:function(){return s},m0:function(){return N},nq:function(){return x},rd:function(){return O},te:function(){return g},uS:function(){return u},ul:function(){return F},wc:function(){return r},xM:function(){return q},zo:function(){return m}});var i="291cebec6b9a4cbf9489bc8cf3a0cc50-06f4c682-bd49-4f88-a8c2-ac582180b7f9-7725",r="d4551187b06a470980076d381efaa944-55338c41-3ed1-4be7-86ae-f6f2d022aa9a-7049",o="34574250afbe400d814cda5bafaabbbf-e8b2d8de-469a-4779-8134-0c3b0fa0d78e-7592",s="577e32a3275e48c5a639a92c9a8af033-4028cb75-b5f4-4ad0-835e-0e26d79ff209-6823",a="aa96061debfd4ec7b9704f62060b4ca6-a498d428-fdba-43da-bc8b-4fe51865cb7f-7984",u="79beea9c4fdb49a5adab4843729e1fa0-19b42cd4-5bd4-4bf8-8e49-05dc0f7f97f8-7484",c="5f4ebf0f9a11474199e89f94bc7e2f50-61b8420a-22b1-4220-b531-4a4b96e4edb9-7406",l="2ddc7e5f54754fc68f3ae1c5b7f3eb20-1883aa8c-4c7b-42d1-b3d6-c9cdb5956783-7092",f="e132e188c609439ab47cd7b06511fc0a-433f81b3-fab9-415a-882a-ba9e2f91abea-6917",h="d34df8693d35452c98f0e1cdfde6d6a8-44cd1abe-6b6d-4edc-a342-46ba159633a4-7645",d="847cac884ec7438c803f8fc375832d7f-8af022cb-395a-4731-b40b-aade0142f724-7321",m="fb4a5e0bc6e5481a8790cf380d1b1058-eaf2bb92-036c-4ff5-984e-ad0782620010-7469",v="event_correlation_id",g="duration",p="event_name",b="properties",y="timestamp",w="form_id",S="user_type",N="client_build_version",C="integration_appid",I="integration_host",T="MUID",k="page_type",x="routing_build",F="routing_dc",P="routing_instance",D="server_build_version",M="server_dc",L="server_instance",R="server_ring",A="session_id",E="source_application",O="UserInfo.Id",_="UserInfo.IdType",B="UserInfo.OMSTenantId",H="user_id",G="user_role",q="user_tenant_id",V="4e990506778b4d9cbf05300e98315eed-682648e1-a406-45c4-9d5b-709b9899d662-7161",z="Office.Forms.Web"},31442:function(t,n,e){"use strict";e.d(n,{f:function(){return g},RF:function(){return d},$U:function(){return f},zU:function(){return p},JG:function(){return c},b6:function(){return m},w6:function(){return v},yY:function(){return h},in:function(){return b},t0:function(){return y},O7:function(){return l}});var i=e(60211),r=e(43209),o=e(72377),s=e(73546);function a(t,n,e,i,r){r&&console.error(r),p("UnhandleException",{columnNo:i,error:r&&r.toString(),fileName:n,lineNo:e,message:t,stack:r&&r.stack})}var u=[];function c(t){(0,s.j)().logFormsProEvent(t)}function l(t){(0,s.j)().sendTeamsAppInitializationCompleteSignal(t)}function f(t,n,a){(0,s.j)().logData({correlationId:a,eventName:t,eventType:"engagement_event",extraData:n}),(0,i.x8)()||"Design"!==(0,r.C2)()||(0===u.length&&e.e(410).then(e.t.bind(e,40634,19)).then((function(t){return t.default})).then((function(t){u=t})),t&&u.indexOf(t)>=0&&o.Pv.Resolve("IFormUserContextActionSignal").addUserActionSignal(t,6,null,!1))}function h(t,n){(0,s.j)().logData({eventName:t,eventType:"intelligence_event",extraData:n,$optoutUTel:!0})}function d(t,n){(0,s.j)().logData({eventName:t,eventType:"diagnostic_event",extraData:n})}function m(t,n){(0,s.j)().logData({eventName:t,eventType:"generic_event",extraData:n,$optoutUTel:!0})}function v(t,n){(0,s.j)().logData({eventName:t,eventType:"impression_event",extraData:n,$optoutUTel:!0})}function g(t,n){(0,s.j)().logData({eventName:t,eventType:"anonymous_event",extraData:n})}function p(t,n,e){(0,s.j)().logData({correlationId:e,eventName:t,eventType:"error_event",extraData:n})}function b(t,n){(0,s.j)().logData({eventName:t,eventType:"nav_perf_event",extraData:n})}function y(t,n){(0,s.j)().logData({correlationId:n,eventName:"session_start",eventType:"session_start",extraData:t,$optoutUTel:!0})}var w=window.onerror;window.onerror=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];a.apply(void 0,t),w&&w.apply(this,t)}},12484:function(t,n,e){"use strict";e.d(n,{b:function(){return r}});var i=e(31442);function r(t,n){var e=Date.now(),r=window.setTimeout((function(){(0,i.$U)("PageLoadingTimeout.".concat(n),{actualDuration:Date.now()-e,timeoutLimit:15e3})}),15e3);t.finally((function(){window.clearTimeout(r)}))}},89904:function(t,n,e){"use strict";e.d(n,{$o:function(){return s},AX:function(){return o}});var i=e(64459),r=e(63795),o=function(t){return(0,r.r3)(t,"<head")||(0,r.r3)(t,"<title")||(0,r.r3)(t,"<span")||(0,r.r3)(t,"<div")||(0,r.r3)(t,"<html")||(0,r.r3)(t,"<!DOCTYPE")||(0,r.r3)(t,"<img")},s=function(t){var n;return t.properties=function(t){return o(t)?'{"log":"[Sanitized log due to property contains HTML]"}':t}((n=t.properties,(0,r.r3)(n,"OnlineSafetyLevel")&&(0,r.r3)(n,"Questions")&&(0,r.r3)(n,"IsQuiz")?'{"log":"[Sanitized log due to property contains Form Definition]"}':n)),t.properties=function(t){return(0,r.r3)(t,"submitDate")&&(0,r.r3)(t,"responderName")&&(0,r.r3)(t,"answers")?'{"log":"[Sanitized log due to property contains Form Result]"}':t}(t.properties),t.properties=function(t){return(0,r.r3)(t,"userName")||(0,r.r3)(t,"user name")?'{"log":"[Sanitized log due to property contains UserName]"}':t}(t.properties),t=function(t){if(t){if((0,r.r3)(t.eventName,"ClientMSGraph.GetPeople")&&(0,r.r3)(t.properties,"Syntax error")){var n=(0,i.d)(t.properties);n&&n.ServiceError&&(n.ServiceError.sourceUrl='{"log":"[Sanitized log due to sourceUrl contains people list]"}',n.ServiceError.innerMessage='{"log":"[Sanitized log due to sourceUrl contains people list]"}',t.properties=JSON.stringify(n))}return t}}(function(t){if(t){if((0,r.r3)(t.eventName,"FileUpload.UploadFile")){var n=(0,i.d)(t.properties);n&&n.ServiceError&&n.ServiceError.sourceUrl&&(n.ServiceError.sourceUrl='{"log":"[Sanitized log due to sourceUrl contains user content]"}',t.properties=JSON.stringify(n))}return t}}(t))}},44644:function(t,n,e){"use strict";e.d(n,{P:function(){return s}});var i=e(94290),r=e(20987),o=e(90710);function s(){var t;if(t=(0,i.Eh)())return t;var n="origin",e=(0,o.NW)()[n];return e||(n="oembedsso",(0,o.NW)()[n]?"Forms WebPart":(0,r.ft)()?"PowerPoint":null)}},14327:function(t,n,e){"use strict";function i(t){return"string"!=typeof t?t:t.replace(/((http|https|chrome-extension):\/\/[^\?\#]+[\?\#])([^ \s'"]+)[ \s'"]?/g,"$1[PII:UrlParameters] ")}function r(t){return"string"!=typeof t?t:t.replace(/(?![\w]+@thread\.v2)[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)/g,"[PII:Email]")}function o(t){var n=new Set(["","/","/default.aspx"]);if(!t||"string"!=typeof t)return!0;var e=t.trim().toLocaleLowerCase();return""===e||(!!n.has(e)||(!!e.startsWith("/pages/")||!!/^\/(r|g|e)\/[^.]+$/.test(e)))}e.d(n,{Or:function(){return o},WW:function(){return i},ug:function(){return r}})},13309:function(t,n,e){"use strict";e.d(n,{u:function(){return i}});var i=(0,e(4851).Rm)((function(){return!!window.navigator.webdriver||navigator.userAgent.includes("HeadlessChrome")}))},62396:function(t,n,e){"use strict";e.d(n,{F:function(){return T},Z:function(){return k}});var i=e(59312),r=e(87363),o=e(22707),s=e(60211),a=e(29559),u=e(9947),c=e(7645),l=e(90710),f=e(28087),h=e(72467),d=e(67661),m=e(3864),v=e(31442),g=e(3424),p=e(42605),b=e(41040),y=e(48280),w=e(40554),S=e(25306),N=e(23112),C=e(17111),I=e(63481);function T(t){return r.createElement(k,(0,i.pi)({},t))}var k=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Bu=!1,n.Hu=r.createRef(),n.Gu=(0,h.f5)().Model,n.qu=function(){var t=n.Gu.FormsTenantSettings;n.setState({IsExternalSharingAllowed:null==t||t.externalShareResult})},n.Vu=function(){return n.forceUpdate()},n.state={ConfirmDialogPrompt:void 0,ResetMenu:!1,ShowShareSummaryResultContainer:!1,ShowDeleteShareResultLinkContainer:!1,ShowSpinner:!0,ShowErrorBox:!1,PermissionToken:"",IsExternalSharingAllowed:null==n.Gu.FormsTenantSettings||n.Gu.FormsTenantSettings.externalShareResult,TooltipClassName:"button-tooltip-analyze-view-ellipsis-button"},n.zu=function(){return n.props.Form.isCurrentUserFormOwnerOrGroupMember()||n.props.Form.canEditPermissionTokenByCoauthor()},n.Qu=function(t){var e=n.Hu.current;n.state.ShowShareSummaryResultContainer&&t.target&&e&&!e.contains(t.target)&&!n.Uu(t,e)&&n.setState({ShowShareSummaryResultContainer:!1,ShowDeleteShareResultLinkContainer:!1})},n}return(0,i.ZT)(n,t),n.prototype.componentDidUpdate=function(){var t=document.getElementById("share-result-container-textbox-link")||document.getElementById("share-result-cancel-button");t&&(t.focus(),this.Bu&&(document.getElementById("share-result-container-copy-button").click(),t.select(),this.Bu=!1))},n.prototype.componentDidMount=function(){this.ju=this.Wu("#share-result-container-copy-button","#share-result-container-copy-button-status",(0,c.pm)().SharePane_Link_SuccessMessage,(0,c.pm)().SharePane_Link_FailedMessage);var t=(0,h.f5)();t.observe(this.qu,[t.Schema.FormsTenantSettings]),this.props.onReExportToExcel&&this.props.Form.observe(this.Vu,[d.x.Schema.XlExportingLocalTag]),document.addEventListener("mouseup",this.Qu)},n.prototype.componentWillUnmount=function(){document.removeEventListener("mouseup",this.Qu),this.ju&&this.ju.destroy(),this.ju=void 0,(0,h.f5)().unobserve(this.qu),this.props.onReExportToExcel&&this.props.Form.unobserve(this.Vu)},n.prototype.render=function(){return this.Ku()?r.createElement("div",null,this.Ju(),this.Zu(),this.Xu()):null},n.prototype.Ku=function(){var t=!!this.props.onDelete||!!this.props.onPostScore;return(0,a.tq)()?t:t||!!this.props.onPrint},n.prototype.Yu=function(){var t=this;if(this.props.onDelete){var n={Action:function(){return t.props.onDelete()},ActionButtonText:(0,c.pm)().Common_Delete_Text,CancelButtonText:(0,c.pm)().Common_Cancel_Text,DialogDescription:this.ec()};return{Checked:!1,Description:this.props.DeleteAllResponses?(0,c.pm)().AnalyzeView_ResetResponses_ButtonText:(0,c.pm)().AnalyzeView_DeleteSingleResponse_ButtonText,Key:"deleteResponseItem",onExecute:function(){t.props.onBeforeDeletedDialogShown&&t.props.onBeforeDeletedDialogShown(),t.setState({ConfirmDialogPrompt:n})},IsDisabled:!this.props.HasAnswers||this.props.IsMovingData}}return null},n.prototype.ic=function(){var t=this;if(!(0,a.tq)()&&this.props.onPrint){return{Checked:!1,Description:this.props.DeleteAllResponses?(0,c.pm)().AnalyzeView_PrintResponses_ItemText:(0,c.pm)().AnalyzeView_PrintSingleResponse_ItemText,Key:"printItem",onExecute:function(){(0,v.$U)("DesignPage.Responses.PrintAnalyzeView"),t.props.onPrint()},IsDisabled:!this.props.HasAnswers}}return null},n.prototype.rc=function(){var t=this;if(this.props.onPostScore&&!(0,u.k0)().userInfo.IsMsa){var n={Action:this.props.onPostScore,ActionButtonText:(0,c.pm)().GradingView_ReleaseResponse_Confirm_Release,CancelButtonText:(0,c.pm)().Common_Cancel_Text,DialogDescription:(0,c.pm)().GradingView_ReleaseResponse_Confirm_Description};return{Checked:!1,Description:this.props.IsScoreReleased?(0,c.pm)().GradingView_AlreadyReleased:(0,c.pm)().GradingView_Release,IsDisabled:this.props.IsScoreReleased,Key:"postScoreItem",onExecute:function(){return t.setState({ConfirmDialogPrompt:n})}}}return null},n.prototype.sc=function(){var t=this;if(!(0,a.tq)()&&this.props.onReExportToExcel){var n={Action:function(){t.props.Form.ensureFieldsReady([d.x.Schema.XlExportingLocalTag]).then((function(){t.props.Form.SetToExporting(),(0,v.$U)("DesignPage.Responses.PopupReExportToExcelDialog"),t.props.onReExportToExcel()})),(0,m.qU)("ReexportToExcelFile")},ActionButtonText:(0,c.pm)().VirtualKeyboard_Button_Enter,CancelButtonText:(0,c.pm)().Common_Cancel_Text,DialogDescription:(0,c.pm)().ReExportToExcel_Confirm_Message},e=(0,c.pm)().ReExportToExcel;return{Checked:!1,IsDisabled:this.props.Form.IsExporting(),Description:e,Key:"ReExportToExcelItem",onExecute:function(){(0,v.$U)("DesignPage.Responses.PopupReExportToExcelDialog"),t.setState({ConfirmDialogPrompt:n})}}}return null},n.prototype.Ju=function(){var t,n=this;return t=(t=this.props.DeleteAllResponses&&(0,o.yH)(this.props.AggregationMaster,this.props.Form.Model.Flags)?[this.Yu()]:[this.Yu(),this.ic(),this.ac(),this.rc(),this.sc()]).filter((function(t){return!!t})),r.createElement(y.Th,{ButtonStyle:1,ClassNameForContainer:"analyze-view-menu-control-container",Disabled:this.props.Disabled,TooltipClassName:this.state.TooltipClassName,HTMLAttributes:{className:"analyze-view-ellipsis-button","aria-label":(0,c.pm)().Responses_Options_Tootip,title:(0,c.pm)().Responses_Options_Tootip,children:(0,g.M)({FluentIcon:"More Horizontal",HTMLAttributes:{className:"forms-icon-size20x20"}})},MenuItemType:0,Reset:this.state.ResetMenu,UnorderListMenuItems:t,onMenuReset:function(){return n.setState({ResetMenu:!1})}})},n.prototype.Zu=function(){var t=this,n=this.state.ConfirmDialogPrompt;if(n){var e={ButtonStyle:2,ClassName:"delete-confirm-control-reset-button",GlyphButtonStyle:"Horizontal",Key:"d",Text:n.ActionButtonText,onClick:function(){t.setState({ConfirmDialogPrompt:void 0,ResetMenu:!0}),n.Action&&n.Action(),t.props.onDeleteDialogDismissed&&t.props.onDeleteDialogDismissed()}},o={ButtonStyle:2,ClassName:"delete-confirm-control-cancel-button",GlyphButtonStyle:"Horizontal",Key:"c",Text:n.CancelButtonText,onClick:function(){t.setState({ConfirmDialogPrompt:void 0,ResetMenu:!0}),t.props.onDeleteDialogDismissed&&t.props.onDeleteDialogDismissed()}},s={ButtonStyle:1,ClassName:"delete-confirm-control-close-button",GlyphButtonStyle:"GlyphOnly",Key:"x",Text:(0,c.pm)().Common_Close_Text,FluentIcon:"Dismiss",IconClassName:"forms-icon-size16x16",onClick:function(){t.setState({ConfirmDialogPrompt:void 0,ResetMenu:!0}),t.props.onDeleteDialogDismissed&&t.props.onDeleteDialogDismissed()}},a={ButtonsProps:[e,o].filter((function(t){return!!t})),ClassName:"delete-confirm-control-container",CloseButtonProps:s,Description:n.DialogDescription,HTMLAttributes:{"aria-label":this.ec()},ShowDialog:!!n,TextClassName:this.props.ConfirmDialogTextClassName,onBlur:function(){window.setTimeout((function(){t.setState({ConfirmDialogPrompt:void 0})}),0)},onDismiss:function(){return t.setState({ConfirmDialogPrompt:void 0,ResetMenu:!0})}};return r.createElement(w.o,(0,i.pi)({},a))}},n.prototype.ec=function(){return this.props.DeleteAllResponses?(0,c.pm)().AnalyzeView_ResetResponses_DescriptionText:(0,c.pm)().AnalyzeView_ResetResponse_DescriptionText},n.prototype.ac=function(){var t=this;if(this.props.onShareResult){return{Checked:!1,Description:this.props.PermissionToken?(0,c.pm)().AnalyzeView_Get_Share_Result_Link:(0,c.pm)().AnalyzeView_Create_Share_Result_Link,IsDisabled:!this.props.PermissionToken&&!this.zu(),Key:"shareResultItem",onExecute:function(){(0,v.$U)("DesignPage.Responses.GetSummaryResult"),window.setTimeout((function(){return t.setState({ShowShareSummaryResultContainer:!0,ShowDeleteShareResultLinkContainer:!1},(function(){return(0,I.mZ)(t.Hu.current)}))})),t.props.PermissionToken?t.setState({PermissionToken:t.props.PermissionToken,ShowSpinner:!1}):t.props.onCreatePermissionToken().then((function(n){t.setState({PermissionToken:n,ShowSpinner:!1})})).catch((function(n){t.setState({ShowSpinner:!1,ShowErrorBox:!0});var e=(0,c.pm)().Error_Message_Failed_Create_Permission_Token;t.uc(e,"#share-result-error-status")})),t.Bu=!0},Title:(0,c.pm)().AnalyzeView_Get_Summary_Link_Tooltip}}return null},n.prototype.Xu=function(){if(this.state.ShowShareSummaryResultContainer)return r.createElement("div",{className:"delete-confirm-control-container share-result",ref:this.Hu},this.cc(),this.fc())},n.prototype.cc=function(){var t=this;if(!this.state.ShowDeleteShareResultLinkContainer){var n=(0,c.pm)(),e={id:(0,l.$p)().FormId,AnalyzerToken:this.state.PermissionToken},i="../Pages/AnalysisPage.aspx?"+jQuery.param(e),o=(0,f.WN)(i),a=this.state.IsExternalSharingAllowed&&!(0,s.j4)()?n.AnalyzeView_Share_Result_Link_External_Title:n.AnalyzeView_Share_Result_Link_Internal_Title,u=!this.state.IsExternalSharingAllowed&&!(0,s.j4)()&&r.createElement(g.F,{FluentIcon:"Error Circle",HTMLAttributes:{title:n.AnalyzeView_Share_Result_Link_Warning_Message,className:"flex-pane-dropdown-option-alert"}}),h=r.createElement("div",{className:"share-result-container-title"},a,u),d=r.createElement("input",{disabled:!1,readOnly:!0,value:o,className:"share-result-container-textbox",id:"share-result-container-textbox-link",onClick:function(){var t=$("#share-result-container-textbox-link");t.focus(),t.select()},"aria-label":n.AnalyzeView_Share_Result_Link_External_Title}),m={className:"share-result-contaienr-copy-button office-form-theme-button",id:"share-result-container-copy-button",disabled:this.state.ShowSpinner,onClick:function(){(0,v.$U)("DesignPage.Share.CopyAnalysisResultLink")},"aria-label":n.Mobile_Share_Copy_Link,"data-clipboard-target":"#share-result-container-textbox-link"},b=(0,S.E)({HTMLAttributes:m,ButtonStyle:1,Text:n.Common_Copy_Text,ref:"copyButton",key:"copyButton"}),y=(0,p.F)({HTMLAttributes:{className:"share-result-contaienr-delete-button",onClick:function(){return t.setState({ShowDeleteShareResultLinkContainer:!0})},disabled:this.state.ShowSpinner||!this.zu()},ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",FluentIcon:"Delete",IconClassName:"share-result-contaienr-delete-button-icon forms-icon-size18x18",Text:n.AnalyzeView_Delete_Share_Result_Link_Button}),w=r.createElement("div",{className:"share-result-status",id:"share-result-container-copy-button-status",role:"alert"}),N=void 0;return this.state.ShowErrorBox&&(N=r.createElement("div",{className:"share-result-error-status",id:"share-result-error-status"})),r.createElement("div",{"aria-label":a,className:"share-result-content"},this.hc(),h,d,b,y,w,N,this.dc())}},n.prototype.fc=function(){var t=this;if(this.state.ShowDeleteShareResultLinkContainer){var n=(0,c.pm)().AnalyzeView_Delete_Share_Result_Link_Title,e=r.createElement("div",{className:"share-result-confirm-delete-text"},n),i=(0,S.E)({HTMLAttributes:{className:"share-result-confirm-cancel-button",id:"share-result-cancel-button",onClick:function(){t.setState({ShowDeleteShareResultLinkContainer:!1,ResetMenu:!0}),t.Bu=!0}},Text:(0,c.pm)().Common_Back_Text,ButtonStyle:1}),o=(0,S.E)({HTMLAttributes:{className:"share-result-confirm-delete-button",onClick:function(){t.setState({ShowShareSummaryResultContainer:!1,ResetMenu:!0}),t.props.onDeletePermissionToken&&(t.props.onDeletePermissionToken(),t.setState({ShowSpinner:!0}))}},Text:(0,c.pm)().AnalyzeView_Delete_Share_Result_Link_Button,ButtonStyle:1});return r.createElement("div",{"aria-label":n,className:"share-result-delete-content"},this.hc(),e,r.createElement("div",{className:"share-result-confirm-delete-buttons"},i,o))}},n.prototype.hc=function(){var t=this,n=this.state.ShowDeleteShareResultLinkContainer;return(0,p.F)({HTMLAttributes:{className:"share-result-close-button",onClick:function(){n?(t.setState({ShowDeleteShareResultLinkContainer:!1,ResetMenu:!0}),t.Bu=!0):t.setState({ShowShareSummaryResultContainer:!1})}},FluentIcon:"Dismiss",IconClassName:"share-result-close-button-icon forms-icon-size14x14",ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",Text:(0,c.pm)().Common_Close_Text})},n.prototype.dc=function(){var t=r.createElement(b.P,(0,i.pi)({},{ClassName:"designPage-share-result-spinner",Ignorable:!1}));if(this.state.ShowSpinner)return r.createElement("div",{className:"share-result-spinner-container"},r.createElement("div",{className:"share-resilt-spinner"},t))},n.prototype.Wu=function(t,n,e,i){var r=this;return(0,C.w)(t,(function(){r.props.Form.triggerShareAction(),(0,v.$U)("DesignPage.Responses.CopySummaryLink");var t=$(n);t.removeClass("flex-pane-status-error"),t.addClass("flex-pane-status-success"),t.text(e),t.show(),setTimeout((function(){t.fadeOut("slow",(function(){t.hide()}))}),3e3)}),(function(){(0,v.$U)("DesignPage.Send.ActionFailed",{action:t});var e=$(n);e.removeClass("flex-pane-status-success"),e.text(i),e.addClass("flex-pane-status-error")}),!0)},n.prototype.uc=function(t,n){var e=$(n);e.addClass("flex-pane-status-error"),e.removeClass("flex-pane-status-success"),e.text(t),e.show(),setTimeout((function(){e.fadeOut("slow")}),3e3)},n.prototype.Uu=function(t,n){var e=n.getBoundingClientRect();return t.clientX>=e.left&&t.clientX<=e.right&&t.clientY>=e.top&&t.clientY<=e.bottom},n}(N.r)},66022:function(t,n,e){"use strict";e.d(n,{y:function(){return m}});var i=e(59312),r=e(87363),o=e(22707),s=e(55411),a=e(7645),u=e(19930),c=e(9743),l=e(67661),f=e(23112),h=e(62396),d=e(35230),m=function(t){function n(n){var e=t.call(this,n)||this;e.mc=function(){return e.forceUpdate()};var i=n.Form;return i.Synchronizer.ensureFieldsReady([l.x.Schema.ArchivedRowCount]),i.observe(e.mc,[l.x.Schema.ArchivedRowCount]),e}return(0,i.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.props.Form.unobserve(this.mc)},n.prototype.render=function(){if(this.props.AggregationMaster)return r.createElement("div",{className:this.SummaryViewContentClassName},r.createElement("div",{className:"analyze-view-summary-table"},r.createElement("div",{className:"analyze-view-summary-container"},this.vc(),this.statisticsContent(),this.gc()),this.bc()),this.insightContent(),r.createElement("div",{className:"analysis-page-row-line"}))},Object.defineProperty(n.prototype,"IsAggregationReady",{get:function(){return this.props.AggregationMaster.Model.IsAggregationReady},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"SummaryViewContentClassName",{get:function(){return"analyze-view-summary-content"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"IsAggregationFailed",{get:function(){return this.props.AggregationMaster.Model.IsAggregationFailed},enumerable:!1,configurable:!0}),n.prototype.getAverageTimeProps=function(){var t=this.yc(),n=(0,s.sv)()?(0,a.pm)().Mobile_AnalyzeView_Average_Fill_Time:(0,a.pm)().AnalyzeView_Average_Fill_Time;return{AccessibilityText:(0,a.pm)().AnalyzeView_Average_Fill_Time_Minutes_Seconds_Explicit.format(t.minutes,t.seconds),Data:(0,a.pm)().AnalyzeView_Average_Fill_Time_Minutes_Seconds_Short.format(t.minutes<10?"0"+t.minutes:t.minutes,t.seconds<10?"0"+t.seconds:t.seconds),Description:n,Ignorable:!0,IsReady:0===this.props.AggregationMaster.Model.TotalResponseCount||this.IsAggregationReady||this.IsAggregationFailed}},n.prototype.statisticsContent=function(){return!(0,o.yH)(this.props.AggregationMaster,this.props.Form.Model.Flags)&&r.createElement(d.V,(0,i.pi)({},this.getAverageTimeProps()))},n.prototype.insightContent=function(){return null},n.prototype.vc=function(){var t=this.props.AggregationMaster.Model,n=this.props.Form,e=n.Synchronizer.isFieldReady(l.x.Schema.ArchivedRowCount),s=(e?n.Model.ArchivedRowCount:0)+t.TotalResponseCount,u=(0,o.kR)(n.Model.Flags)?e:null!==t.TotalResponseCount,c={AccessibilityText:(0,a.pm)().AnalyzeView_NumberOfResponses_AccessibilityLabel.format(s),Data:s,Description:(0,a.pm)().Common_Responses_Text,Ignorable:!1,IsReady:u};return r.createElement(d.V,(0,i.pi)({},c))},n.prototype.yc=function(){if(this.props.AggregationMaster.Model.TotalResponseCount>0){var t=this.props.AggregationMaster.Model.AverageSubmitTime/1e3;return{minutes:Math.floor(t/60),seconds:Math.floor(t%60)}}return{minutes:0,seconds:0}},n.prototype.gc=function(){var t=this.Sc(),n={AccessibilityText:(0,a.pm)().AnalyzeView_FormStatus_AccessibilityLabel.format(t),Data:t,Description:(0,a.pm)().AnalyzeView_Status_Label,Ignorable:!1,IsReady:null!=this.props.AggregationMaster.Model.FormStatus};return r.createElement(d.V,(0,i.pi)({},n))},n.prototype.Sc=function(){switch(this.props.AggregationMaster.Model.FormStatus){case u.r.Opened:return(0,a.pm)().AnalyzeView_Status_Active;case u.r.Closed:case u.r.Expired:case u.r.NotStarted:return(0,a.pm)().AnalyzeView_Status_Closed;default:return(0,a.pm)().AnalyzeView_Status_Unknown}},n.prototype.bc=function(){if(!(0,s.sv)()&&this.props.AggregationMaster.FormMaster.SyncContext!==c.y.AnalysisTimeForm){var t=this.props.Form,n=(0,o.Ai)(t.Model.Flags),e={DeleteAllResponses:!0,Form:t,HasAnswers:!1,onDelete:this.props.onDeleteResponses,onCreatePermissionToken:this.props.onCreatePermissionToken,onDeletePermissionToken:this.props.onDeletePermissionToken,onPrint:this.props.onPrint,onShareResult:!0,onReExportToExcel:this.props.onExportExcel,PermissionToken:this.props.PermissionToken,IsMovingData:n},a=t.Synchronizer.isFieldReady(l.x.Schema.ArchivedRowCount)?t.Model.ArchivedRowCount:0;if(this.IsAggregationReady||this.IsAggregationFailed){var u=this.props.AggregationMaster;e.AggregationMaster=u,e.HasAnswers=this.props.AggregationMaster.Model.TotalResponseCount+((0,o.kR)(t.Model.Flags)?a:0)>0}return r.createElement(h.Z,(0,i.pi)({},e))}},n}(f.r)},35230:function(t,n,e){"use strict";e.d(n,{V:function(){return u}});var i=e(59312),r=e(87363),o=e(12611),s=e(262),a=e(41040),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.render=function(){var t=(0,s.j)(this.props.ClassName,"simple-data-control-container");this.props.Ignorable&&(t=(0,s.j)(t,"optional-cell"));var n=o.extend({},this.props.HTMLAttributes);return n.className=(0,s.j)(n.className,t),r.createElement("div",(0,i.pi)({},n,{role:"list"}),this.Nc(),r.createElement("div",(0,i.pi)({className:"simple-data-control-description"},this.Cc()),this.props.Description))},n.prototype.Nc=function(){if(this.props.IsReady)return r.createElement("div",{className:"simple-data-control-content office-form-theme-primary-foreground",role:"listitem","aria-label":this.props.AccessibilityText},this.props.Data);return r.createElement(a.P,(0,i.pi)({},{ClassName:"designPage-response-averageTime-spinner",Ignorable:!1}))},n.prototype.Cc=function(){if(this.props.AccessibilityText)return{"aria-hidden":!0,role:"presentation"}},n}(e(23112).r)},93387:function(t,n,e){"use strict";e.d(n,{ax:function(){return l},zx:function(){return f}});var i=e(59312),r=e(87363),o=e(29559),s=e(262),a=e(65274),u=e(88744),c=e(23112);function l(t){return r.createElement(f,(0,i.pi)({},t))}var f=function(t){function n(n){var e=t.call(this,n)||this;return e.Te=(0,a.EL)("b"),e.Ic=r.createRef(),e.Tc=0,e.state={ShowTooltip:!1},e.xc=e.xc.bind(e),e}return(0,i.ZT)(n,t),n.prototype.componentWillUnmount=function(){window.clearTimeout(this.Tc)},n.prototype.componentDidUpdate=function(){var t=this.Ic.current;if(this.state.ShowTooltip&&t){var n=t.getBoundingClientRect(),e=this.getHtmlElement();if(n.right>window.innerWidth){var i=e.getBoundingClientRect();t.style.left="auto",t.style.right=(0,o.tq)()?"".concat(window.innerWidth-i.right,"px"):"".concat(i.right-window.innerWidth,"px")}n.bottom>window.innerHeight&&(t.style.bottom="".concat(e.clientHeight,"px"))}},n.prototype.render=function(){var t=this,n=(0,a.l7)({},this.props.HTMLAttributes);switch(n.className=(0,s.j)(n.className,"button-control"),n["aria-pressed"]=this.props.ToggleActive,this.props.ToggleActive&&(n.className=(0,s.j)(n.className,"active")),this.props.ButtonStyle){case 1:n.className=(0,s.j)(n.className,"light-background-button");break;case 2:n.className=(0,s.j)(n.className,"dark-background-button")}var e=null,o=this.props.Tooltip,c=n.title;if(o||c){var l=void 0;c&&c!==o&&(l=r.createElement("span",{key:"s"},c));var f=void 0;if(o){var d=void 0;n["aria-label"]===o||n["aria-describedby"]||(d=this.Te+"-tooltip",n["aria-describedby"]=d),f=r.createElement("span",{id:d,key:"t"},o)}var m=void 0;m=this.state.ShowTooltip?this.props.TooltipClassName||"button-tooltip":"screenReaderReference",e=r.createElement("div",{className:m,key:"t",onClick:h,ref:this.Ic},l,f),n.title=void 0,n.onKeyUp=(0,u.F)(n.onKeyUp,this.xc),n.onFocus=(0,u.F)(n.onFocus,(function(){return t.Pc(!0)})),n.onMouseOver=(0,u.F)(n.onMouseOver,(function(){return t.Pc(!0)})),n.onBlur=(0,u.F)(n.onBlur,(function(){return t.Pc(!1)})),n.onMouseOut=(0,u.F)(n.onMouseOut,(function(){return t.Pc(!1)}))}return r.createElement("button",(0,i.pi)({},n),r.createElement("div",{className:"button-content"},this.props.children),e)},n.prototype.focus=function(){this.getHtmlElement().focus()},n.prototype.xc=function(t){this.state.ShowTooltip&&27===t.keyCode&&(t.stopPropagation(),this.setState({ShowTooltip:!1}))},n.prototype.Pc=function(t){var n=this;window.clearTimeout(this.Tc),this.state.ShowTooltip!==t&&(this.Tc=window.setTimeout((function(){n.setState({ShowTooltip:t}),n.Tc=0}),t?500:300))},n}(c.r);function h(t){t.stopPropagation()}},96689:function(t,n,e){"use strict";e.d(n,{e:function(){return c}});var i=e(59312),r=e(87363),o=e(262),s=e(54496),a=e(74302),u=e(35929);function c(t){return r.createElement(l,t)}var l=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.createReactNodes=function(){var t=this.props,n=t.RadioCheckbox?"radio":"checkbox",e=t.Options,i=e&&e.classNameForInnerDiv,a=(0,o.j)(n,e&&e.classNameForInnerLabel),c=t.Disabled,l=t.HelpText||void 0,f=(0,s.p2)(e&&e.HTMLPropsForInnerElement,{checked:t.Value,disabled:c,type:n,onChange:this.Dc.bind(this),className:this.props.ClassName,ref:this.props.CheckboxRef,autoFocus:t.CheckboxAutoFocus,title:this.props.InnerHelpText}),h=r.createElement("div",{className:a},r.createElement("label",{disabled:c},r.createElement("input",f),r.createElement("span",{className:this.props.SpanClassName,title:this.props.InnerHelpText},t.Description),t.ShowRequiredStar?r.createElement(u.R):void 0));return r.createElement("div",{className:i,id:t.Id,disabled:c,title:l},h,t.children)},n.prototype.Dc=function(t){this.props.onValueChange(t.nativeEvent.target.checked)},n}(a.i)},74302:function(t,n,e){"use strict";e.d(n,{i:function(){return a}});var i=e(59312),r=e(87363),o=e(12611),s=e(262),a=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.render=function(){var t=o.extend({},this.props.HTMLAttributes);return this.props.ValidationStyle&&(t.className=(0,s.j)(t.className,this.props.ValidationStyle)),this.props.Hidden&&(t.style=t.style||{},t.style.display="none"),r.createElement("div",t,this.createReactNodes())},n.prototype.createReactNodes=function(){throw Error("to be overridden.")},n}(r.Component)},35929:function(t,n,e){"use strict";e.d(n,{R:function(){return o}});var i=e(59312),r=e(87363),o=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.render=function(){return r.createElement("span",{className:"required-star"})},n}(e(23112).r)},355:function(t,n,e){"use strict";e.d(n,{xU:function(){return b}});var i=e(59312),r=e(87363),o=e(32782),s=e(9947),a=e(262),u=e(7645),c=e(54496),l=e(80820);function f(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(778).then(e.bind(e,47455)).then((function(t){return e.e(778).then(e.bind(e,55422)).then((function(n){return t.registerIcons({icons:{CalculatorMultiply:r.createElement(n.Close,{$height:12,$width:12}),Calendar:r.createElement(n.Calendar,null),ChevronDown:r.createElement(n.ChevronDown,{$height:14,$width:14}),Down:r.createElement(n.DownIcon,{$height:16,$width:16}),Up:r.createElement(n.UpIcon,{$height:16,$width:16}),Cancel:r.createElement(n.Cancel,{$height:12,$width:12,$fillColor:l.mr})}})}))}))];case 1:return t.sent(),[2]}}))}))}var h=r.lazy((function(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,f().then((function(){return e.e(778).then(e.bind(e,26581))}))];case 1:return[2,{default:t.sent().ComboBox}]}}))}))}));var d=r.lazy((function(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,f().then((function(){return e.e(778).then(e.bind(e,96506))}))];case 1:return[2,{default:t.sent().DatePicker}]}}))}))})),m=e(74302),v=e(42605),g=new Date("1/1/1753 12:00:00 AM"),p=new Date("12/31/9999 11:59:59 PM");function b(t){return r.createElement(y,t)}var y=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Mc=null,n.Lc=15,n.Rc=null,n}return(0,i.ZT)(n,t),n.prototype.createReactNodes=function(){var t=this.props,n=t.Options,e=n&&n.classNameForInnerDiv,i=n&&n.classNameForInnerLabel;return r.createElement(r.Fragment,null,t.Label?r.createElement("span",{className:i},t.Label):void 0,r.createElement("div",{className:e},this.Ac()?this.Ec():void 0,this.Oc()?this._c():void 0,t.children))},n.prototype.componentWillMount=function(){this.Bc=this.Bc.bind(this),this.Hc=this.Hc.bind(this),this.Gc=this.Gc.bind(this),this.qc=this.qc.bind(this),this.Vc=this.Vc.bind(this),this.Mc=this.Ac()&&!this.zc()?new Date(this.props.Value):null},n.prototype.shouldComponentUpdate=function(t){return t.Value!==this.props.Value&&(this.Mc=this.Ac()&&!this.zc()?new Date(t.Value):null),!0},n.prototype.Ec=function(){var t=this.props,n=t.Options&&t.Options.HTMLPropsForInnerElement,e=(0,v.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",FluentIcon:"Calendar LTR",IconClassName:"dateIcon forms-icon-size20x20",HTMLAttributes:{disabled:t.Disabled,tabIndex:-1},Text:t.DateTitle}),l=(0,s.k0)().cultureInfo.DateTimeFormat,f=(0,c.p2)(n,{className:"form-control",disabled:t.Disabled,placeholder:t.Placeholder||l.ShortDatePattern,value:this.Hc()}),h=r.createElement("div",{className:"office-form-date-time-picker office-form-theme-focus-border"},r.createElement("input",(0,i.pi)({},f)),e);if(this.props.Disabled)return h;var m=(0,u.pm)();return r.createElement(o.Z,{fallback:h},r.createElement(d,{allowTextInput:!0,ariaLabel:t.Label,className:"office-form-date-time-picker office-form-theme-focus-border",firstDayOfWeek:l.FirstDayOfWeek,formatDate:this.Bc,isMonthPickerVisible:!1,maxDate:t.AllowedDateTime&&t.AllowedDateTime.End,minDate:t.AllowedDateTime&&t.AllowedDateTime.Start,onFocus:this.qc,onSelectDate:this.Vc,parseDateFromString:this.Gc,pickerAriaLabel:t.DateTitle,placeholder:t.Placeholder||l.ShortDatePattern,showCloseButton:!0,showGoToToday:!0,showMonthPickerAsOverlay:!0,strings:{closeButtonAriaLabel:m.Common_Close_Text,goToToday:m.DatePickerGoToToday,nextMonthAriaLabel:m.DatePickerGoToNextMonth,nextYearAriaLabel:m.DatePickerGoToNextYear,nextYearRangeAriaLabel:m.DatePickerGoToNextYearRange,prevMonthAriaLabel:m.DatePickerGoToPreviousMonth,prevYearAriaLabel:m.DatePickerGoToPreviousYear,prevYearRangeAriaLabel:m.DatePickerGoToPreviousYearRange,days:l.DayNames||l.AbbreviatedDayNames,months:l.MonthNames||l.AbbreviatedMonthNames,shortDays:l.AbbreviatedDayNames,shortMonths:l.AbbreviatedMonthNames},styles:{icon:this.props.InSettingPane?{padding:0,top:8}:void 0},textField:{"aria-label":t.DateTitle,"aria-labelledby":(0,a.j)(f["aria-labelledby"],f["aria-describedby"]),borderless:!0,inputClassName:f.className,styles:{field:{border:"ignore"},fieldGroup:{height:"100%"}}},value:this.Mc}))},n.prototype._c=function(){var t=this,n=this.props,e=(0,s.k0)().cultureInfo.DateTimeFormat,a=(0,v.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",FluentIcon:this.props.TimeIcon?"":"Chevron Down",Icon:this.props.TimeIcon,IconClassName:"dateCaretDown forms-icon-size16x16",HTMLAttributes:(0,c.p2)(n.Options&&n.Options.HTMLPropsForInnerElement,{disabled:n.Disabled}),Text:n.TimeTitle}),u=n.Options&&n.Options.HTMLPropsForInnerElement,l=this.Qc(),f=(0,c.p2)(u,{className:"form-control",disabled:n.Disabled,placeholder:n.Placeholder||e.ShortTimePattern,value:l}),d=r.createElement("div",{className:"office-form-date-time-picker office-form-theme-focus-border"},r.createElement("input",(0,i.pi)({},f)),a);if(this.props.Disabled)return d;var m="ignore";this.Uc();var g=l?this.Rc.find((function(t){return t.text===l})):void 0;return r.createElement(o.Z,{fallback:d},r.createElement(h,{allowFreeform:!0,ariaLabel:n.TimeTitle,"aria-describedby":f["aria-describedby"],"aria-labelledby":f["aria-labelledby"],calloutProps:{doNotLayer:!0,style:{maxHeight:256}},caretDownButtonStyles:{icon:{lineHeight:m},root:{right:0}},className:"office-form-date-time-picker office-form-theme-focus-border",onChange:function(n,e,i,r){return t.$c(e?e.text:r)},options:this.Rc,placeholder:n.TimePlaceholder||e.ShortTimePattern,selectedKey:g&&g.key,styles:{input:"form-control",root:{border:m,height:40,padding:m}},text:l}))},n.prototype.Ac=function(){return 1!==this.props.Type},n.prototype.Oc=function(){return 0!==this.props.Type},n.prototype.zc=function(){var t=this.props.Value;return this.Ac()?isNaN(Date.parse(t)):isNaN(Number(t))},n.prototype.Hc=function(){if(this.Ac())return this.zc()?"":(this.props.IsLocaleInvariant?Date.parseDate(this.props.Value,"yyyy-MM-dd",(0,s.k0)().cultureInfo):new Date(this.props.Value)).toDateShortString((0,s.k0)().cultureInfo)},n.prototype.Qc=function(){if(this.Oc())return this.zc()?"":new Date(this.props.Value).toTimeShortString((0,s.k0)().cultureInfo)},n.prototype.Bc=function(t){if(t){if(t instanceof Date)return t.toDateShortString((0,s.k0)().cultureInfo);if(this.Mc)return this.Mc.toDateShortString((0,s.k0)().cultureInfo)}return""},n.prototype.Uc=function(){if(!this.Rc){var t=Math.floor(1440/this.Lc);this.Rc=Array(t);for(var n=new Date(0),e=0;e<t;e++)n.setHours(0,e*this.Lc,0,0),this.Rc[e]={key:e,text:n.toTimeShortString((0,s.k0)().cultureInfo)}}},n.prototype.Gc=function(t){var n=(0,s.k0)().cultureInfo,e=this.props,i=Date.parseDate(t,n.DateTimeFormat.ShortDatePattern,n),r=0;return null==i&&(r=1),(i<=g||i>=p)&&(r=2),0!==r?(e.onValueValidation&&e.onValueValidation(!0,r),null):i},n.prototype.qc=function(){this.props.onValueValidation&&this.props.onValueValidation(!0,0)},n.prototype.Vc=function(t,e){var i,r=this.props;if(null!=t){this.Mc=t;var o=new Date(r.Value);e?o.setHours(t.getHours(),t.getMinutes(),t.getSeconds()):o.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),i=r.IsLocaleInvariant?n.formatLocaleInvariantString(o,!this.Oc()):o.toJSON()}r.Value!==i&&(r.onValueChange(i),this.forceUpdate())},n.prototype.$c=function(t){if(t&&t!==this.Qc()){var n=this.props,e=void 0;e=this.Ac()?new Date(n.Value):new Date;var i=Date.parseTime(t,(0,s.k0)().cultureInfo.DateTimeFormat.ShortTimePattern,(0,s.k0)().cultureInfo);if(isNaN(i))n.onValueValidation&&n.onValueValidation(!1,1);else{var r=Math.floor(i/1e3/60/60),o=i/1e3/60%60,a=i/1e3%60;e.setHours(r,o,a),this.Vc(e,!0)}}},n.formatLocaleInvariantString=function(t,n){var e=new Date;e.setUTCFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e.setUTCHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds());var i=e.toISOString();return i.slice(0,i.indexOf(n?"T":"Z"))},n}(m.i)},3424:function(t,n,e){"use strict";e.d(n,{F:function(){return u},M:function(){return a}});var i=e(59312),r=e(87363),o=e(262),s=e(65274);function a(t){return r.createElement(u,(0,i.pi)({},t))}var u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.render=function(){var t=(0,s.d9)(this.props.HTMLAttributes)||{};if(this.props.FluentIcon){var n=this.props.FluentIcon.replaceAll(" ","");t.className=(0,o.j)("ff-icon ff-icon-".concat(n),this.props.className,t.className)}else t.className=(0,o.j)("ms-Icon",this.props.IconName?"ms-Icon--".concat(this.props.IconName):"",this.props.className,t.className);return this.props.Accessible||(t.role="presentation",t["aria-hidden"]="true"),r.createElement("i",(0,i.pi)({},t))},n}(e(23112).r)},42605:function(t,n,e){"use strict";e.d(n,{F:function(){return c}});var i=e(59312),r=e(87363),o=e(12611),s=e(262),a=e(93387),u=e(3424);function c(t){var n,e,c=o.clone(t)||{},l=o.clone(c.HTMLAttributes)||{};switch(c.HTMLAttributes=l,t.GlyphButtonStyle){case 1:case"Vertical":l.className=(0,s.j)(l.className,"glyph-button-control-vertical");break;default:l.className=(0,s.j)(l.className,"glyph-button-control-horizontal")}if(l["aria-label"]=l["aria-label"]||t.Text,t.Icon||t.FluentIcon){var f={FluentIcon:t.FluentIcon,HTMLAttributes:{className:t.IconClassName},IconName:t.Icon,key:"icon"};n=r.createElement(u.F,(0,i.pi)({},f))}switch("GlyphOnly"!==t.GlyphButtonStyle&&2!==t.GlyphButtonStyle?e=r.createElement("span",{className:t.TextClassName,key:"text"},t.Text):t.Text&&(c.Tooltip=c.Tooltip||t.Text,c.Tooltip!==t.Text&&(l.title=t.Text)),t.GlyphLocation){case 1:case"Right":c.children=[e,t.children,n];break;default:c.children=[n,e,t.children]}return(0,a.ax)(c)}},17764:function(t,n,e){"use strict";e.d(n,{_:function(){return c}});var i=e(59312),r=e(87363),o=e(65863),s=e(74302),a=e(35929),u=e(3424);function c(t){return r.createElement(l,t)}var l=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.jc=!1,n.vo=!1,n}return(0,i.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this;this.vo=!0,this.jc||window.setTimeout((function(){t.jc=!0,t.vo&&t.forceUpdate()}))},n.prototype.componentWillUnmount=function(){this.vo=!1},n.prototype.createReactNodes=function(){var t,n=this.props,e=n.ShowRequiredStar?r.createElement(a.R):void 0,i=n.ShowOrdinal?r.createElement("span",{className:"ordinal-number",key:"ordinalNumber"},"".concat(this.props.Ordinal,".")):void 0;n.Alert&&!this.jc||(t=(0,o.q)({ContainsHtml:!!n.HtmlContent,Text:n.Label,RenderMode:"RichText"}));var s=n.ShowWarningIcon&&(0,u.M)({FluentIcon:"Error Circle",HTMLAttributes:{className:"forms-icon-size20x20 warning-icon-style",title:n.WarningIconTooltip},Accessible:!0}),c=n.ShowInfoIcon&&(0,u.M)({FluentIcon:"Info",HTMLAttributes:{className:"forms-icon-size12x12 info-icon-style",title:n.InfoIconTooltip},Accessible:!0});return n.Bold?r.createElement(r.Fragment,{},r.createElement("b",void 0,i,t,e),n.children):r.createElement(r.Fragment,{},i,t,e,s,c,n.children)},n}(s.i)},41040:function(t,n,e){"use strict";e.d(n,{P:function(){return s}});var i=e(59312),r=e(87363),o=e(262),s=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.render=function(){var t=this.props.Ignorable?(0,o.j)(this.props.ClassName,"optional-cell"):this.props.ClassName;return r.createElement("div",{className:t},r.createElement("div",{className:"common-spinner-circle"}),this.Wc())},n.prototype.Wc=function(){if(this.props.LoadingDescription)return r.createElement("div",{className:"loading-control-description",role:"status"},this.props.LoadingDescription)},n}(e(23112).r)},48280:function(t,n,e){"use strict";e.d(n,{Gy:function(){return d},Th:function(){return m}});var i=e(59312),r=e(87363),o=e(12611),s=e(262),a=e(38174),u=e(54496),c=e(64290),l=e(3424),f=e(23112),h=e(93387);function d(){return r.createElement("hr",{"aria-hidden":"true",className:"menu-control-hr"})}var m=function(t){function n(n){var e=t.call(this,n)||this;return e.Jc=r.createRef(),e.Zc=r.createRef(),e.Xc=r.createRef(),e.Yc=null,e.tl=null,e.il=!1,e.ol=null,e.al=o.uniqueId("menu"),e.ll=!e.props.SubMenu,e.state={MenuExpanded:!1,DisableButtonFocused:!1},e.fl=e.fl.bind(e),e.dl=e.dl.bind(e),e.vl=e.vl.bind(e),e.bl=e.bl.bind(e),e.yl=e.yl.bind(e),e.wl=e.wl.bind(e),e.Sl=e.Sl.bind(e),e.Nl=e.Nl.bind(e),e.Cl=e.Cl.bind(e),e.Il=e.Il.bind(e),e}return(0,i.ZT)(n,t),n.prototype.componentWillReceiveProps=function(t){t.Reset&&(this.setState({MenuExpanded:!1}),t.onMenuReset&&t.onMenuReset(),this.focus())},n.prototype.componentDidMount=function(){window.addEventListener("resize",this.yl)},n.prototype.componentDidUpdate=function(t,n){var e=this;!this.state.MenuExpanded&&this.il&&(this.focus(),this.il=!1),!n.MenuExpanded&&this.state.MenuExpanded&&(this.props.DisableAdjustPopupPosition||this.xl(),setTimeout((function(){var t;e.Fl(null===(t=e.Pl())||void 0===t?void 0:t[0])}),0),this.props.onMenuExpand&&this.props.onMenuExpand()),n.MenuExpanded&&!this.state.MenuExpanded&&(this.ol=null,this.props.onMenuCollapse&&this.props.onMenuCollapse())},n.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.yl),this.Yc&&window.clearTimeout(this.Yc),this.tl&&window.clearTimeout(this.tl)},n.prototype.render=function(){var t,n=(0,s.j)(this.props.ClassNameForContainer,"menu-control-dropup");return(t=this.Dl()).ref=this.Zc,this.props.SubMenu?t.className=(0,s.j)(t.className,n):t={className:n},r.createElement("div",(0,i.pi)({},t),this.Ml(),this.Ll())},n.setReservedWidthToRight=function(t){n.reservedWidthToRight=t},n.prototype.yl=function(){var t=this;this.Yc||(this.Yc=window.setTimeout((function(){t.Yc=null,t.xl()}),100))},n.prototype.focus=function(){var t=this.props.SubMenu?this.Zc.current:this.Jc.current;t&&!this.state.MenuExpanded&&t.focus()},n.prototype.Fl=function(t){t&&t.focus()},n.prototype.Rl=function(t){this.il=this.state.MenuExpanded&&!!t,this.setState({MenuExpanded:!this.state.MenuExpanded})},n.prototype.Il=function(){this.setState({MenuExpanded:!1})},n.prototype.Ml=function(){return this.props.SubMenu?this.props.HTMLAttributes.children:(0,h.ax)({HTMLAttributes:this.Dl(),TooltipClassName:this.props.TooltipClassName,ButtonStyle:this.props.ButtonStyle,children:this.props.HTMLAttributes.children,ref:this.Jc})},n.prototype.Nl=function(t){this.props.SubMenu&&this.props.setSelectedElement(t.currentTarget),this.props.onButtonFocus&&this.props.onButtonFocus()},n.prototype.Dl=function(){var t={tabIndex:this.props.SubMenu?-1:0,autoFocus:this.props.AutoFocused,"aria-expanded":this.state.MenuExpanded,"aria-haspopup":!0,"aria-label":this.props.AriaLabel,"aria-disabled":this.props.Disabled,"aria-controls":this.state.MenuExpanded?this.al:void 0,className:"menu-control-trigger"};return this.props.Disabled||(t=o.extend(t,{onClick:this.Cl,onFocus:this.Nl,onKeyDown:this.vl})),(0,u.p2)(t,this.props.HTMLAttributes)},n.prototype.Al=function(t){switch(t){case 0:return"menuitem";case 2:return"menuitemradio";default:return"menuitemcheckbox"}},n.prototype.dl=function(t){var n=this;t.stopPropagation();var e=(0,a.y3)(t);if(this.props.SubMenu){var i=this.props.Root.current;if(!i||!i.contains(e))return void(this.tl=window.setTimeout((function(){n.tl=null,n.props.collapseRootMenu()}),150))}var r=this.Xc.current;r&&r.contains(e)||(this.tl=window.setTimeout((function(){n.tl=null,n.Il()}),150))},n.prototype.El=function(t,n,e){var o=this,a=!!t.IsDisabled,u=function(){if(!a)return t.onExecute()},c={"aria-disabled":a,className:(0,s.j)("separator",a?"menu-item-disabled highContrast-text-disabled":"menu-item-active",t.Checked?"checked":""),key:t.Key,"aria-setsize":e,"aria-posinset":n+1,onFocus:this.wl,title:t.Title,role:this.Al(this.props.MenuItemType),tabIndex:a?void 0:-1,onClick:function(){o.Rl(!u())},onBlur:this.dl,onKeyDown:function(t){return o.Ol(t,u)}};0!==this.props.MenuItemType&&(c["aria-checked"]=t.Checked);var f=t.Checked?r.createElement(l.F,(0,i.pi)({},{FluentIcon:"Checkmark",HTMLAttributes:{className:"forms-icon-size18x18 question-menu-check-icon"}})):void 0;return r.createElement("li",(0,i.pi)({},c),f,r.createElement("span",null,t.Description))},n.prototype._l=function(){var t=this,n=[],e=this.props.UnorderListMenuItems,o=!1;if(e){var a=e.filter((function(t){return!!t}));a.forEach((function(e,i){n.push(t.El(e,i,a.length)),o=o||e.Checked}))}var u={className:(0,s.j)("menu-control-options-box",this.props.ClassName),id:this.al,ref:this.Xc,role:"menubar",tabIndex:-1,onBlur:this.dl,onKeyUp:this.bl},c=(0,s.j)("menu-control-options-content","menu-control","border-no-radius",o?"checked":"");return r.createElement("div",(0,i.pi)({},u),r.createElement("ul",{className:c,role:"presentation"},n))},n.prototype.Bl=function(){var t=this.Hl(),n={"aria-label":this.props.AriaLabel||"",className:(0,s.j)("menu-control-options-box",this.props.ClassName),id:this.al,ref:this.Xc,role:"menu",tabIndex:-1,onKeyUp:this.bl,onBlur:this.dl,style:this.ll?{overflowY:"auto"}:void 0};return r.createElement("div",(0,i.pi)({},n),r.createElement("div",{className:"menu-control-options-content"},t))},n.prototype.Hl=function(){var t=this,e=r.Children.toArray(this.props.children).filter((function(t){return t.props.Active})).length,i=0;return r.Children.map(this.props.children,(function(a,l){a=r.Children.only(a);var f=o.clone(a.props);if(f.Active){var h=t.Al(t.props.MenuItemType),d=o.extend({key:l.toString(),"aria-disabled":f.Disabled,"aria-posinset":++i,"aria-setsize":e,role:h,tabIndex:-1},f.HTMLAttributes);return f.Disabled?d.className=(0,s.j)(d.className,"menu-item-disabled highContrast-text-disabled"):d.className=(0,s.j)(d.className,"menu-item-active"),f.SubMenu?(t.ll=!1,r.createElement(n,{AriaLabel:t.props.AriaLabelForSubmenu,MenuItemType:t.props.MenuItemType,SubMenu:!0,Disabled:f.Disabled,TooltipClassName:t.props.TooltipClassName,setSelectedElement:t.Sl,HTMLAttributes:d,collapseRootMenu:t.props.collapseRootMenu||t.Il,Root:t.props.Root||t.Xc},f.children)):(d=f.Disabled?(0,u.p2)(d,{onFocus:function(n){t.ol=n.currentTarget,t.state.MenuExpanded&&t.props.onMenuItemMouseOver&&n.currentTarget.getAttribute("aria-disabled")&&(t.props.onMenuItemMouseOver(n),t.setState({DisableButtonFocused:!0}))},onBlur:function(n){t.props.onMenuItemMouseLeave&&(t.props.onMenuItemMouseLeave(n),t.setState({DisableButtonFocused:!1}))}}):(0,u.p2)(d,{onFocus:t.wl,onClick:function(n){n.stopPropagation(),n.preventDefault(),(0,c.pd)((function(){return f.onClick()}),c.t1),t.props.SubMenu?t.props.collapseRootMenu():t.Rl()},onKeyDown:function(n){return t.Ol(n,f.onClick)}}),f.HTMLAttributes=d,r.cloneElement(a,f))}return a}))},n.prototype.Sl=function(t){this.ol=t},n.prototype.fl=function(){return this.Xc},n.prototype.Ll=function(){return this.state.MenuExpanded?this.props.UnorderListMenuItems?this._l():this.Bl():null},n.prototype.Cl=function(t){this.props.SubMenu&&(t.stopPropagation(),t.preventDefault()),this.Rl()},n.prototype.wl=function(t){t.stopPropagation(),this.ol=t.currentTarget},n.prototype.bl=function(t){switch(t.keyCode){case 36:t.stopPropagation(),t.preventDefault(),this.Fl(this.Pl()[0]);break;case 35:t.stopPropagation(),t.preventDefault();var n=this.Pl();this.Fl(n[n.length-1]);break;case 38:t.stopPropagation(),t.preventDefault(),this.Fl(this.Gl());break;case 39:case 40:t.stopPropagation(),t.preventDefault(),this.Fl(this.ql());break;case 37:case 27:case 9:t.stopPropagation(),t.preventDefault(),this.state.DisableButtonFocused?(this.props.onMenuItemMouseLeave&&this.props.onMenuItemMouseLeave(t),this.setState({DisableButtonFocused:!1})):this.Rl(!0)}},n.prototype.Pl=function(){var t=this.Xc.current;return t?t.firstElementChild.querySelectorAll(".menu-item-active,.menu-item-disabled"):null},n.prototype.Gl=function(){var t=this,n=this.Pl();if(n.length>0){if(this.ol&&this.ol!==n[0]){var e=o.findIndex(n,(function(n){return t.ol===n}));return n[--e]}return n[n.length-1]}},n.prototype.ql=function(){var t=this,n=this.Pl();if(n.length>0){if(this.ol&&this.ol!==n[n.length-1]){var e=o.findIndex(n,(function(n){return t.ol===n}));return n[++e]}return n[0]}},n.prototype.vl=function(t){switch(t.keyCode){case 40:this.props.SubMenu||(t.preventDefault(),this.Rl());break;case 13:t.stopPropagation(),t.preventDefault(),this.Rl();break;case 39:this.state.MenuExpanded||(t.stopPropagation(),t.preventDefault(),this.Rl())}},n.prototype.Ol=function(t,n){switch(t.keyCode){case 32:t.stopPropagation(),t.preventDefault(),n&&n(),1!==this.props.MenuItemType&&(this.props.SubMenu?this.props.collapseRootMenu():this.Rl());break;case 13:t.stopPropagation(),t.preventDefault();var e=n&&n(),i=void 0!==e&&e;this.props.SubMenu?this.props.collapseRootMenu():this.Rl(!i)}},n.prototype.xl=function(){var t;t=this.props.SubMenu?this.Zc.current:this.Jc.current&&this.Jc.current.getHtmlElement();var e=this.Xc.current;if(t&&e){var i=e.offsetWidth,r=e.offsetHeight,o=e.offsetParent;if(!o)return;for(e.style.display="none";o;){var s=window.getComputedStyle(o,""),a=s.overflowX,u=s.overflowY;if(a&&"visible"!==a||u&&"visible"!==u||"BODY"===o.tagName)break;o=o.parentElement}var c=o.getBoundingClientRect(),l=t.getBoundingClientRect(),f=void 0,h=void 0;this.props.SubMenu?(f=o.clientWidth+c.left-l.right-i>0?l.width:-i,h=o.clientHeight+c.top-l.top-r>0?0:-r):(f=Math.min(o.clientWidth+c.left-l.left-i-n.reservedWidthToRight,0),h=Math.min(o.clientHeight+c.top-l.top-r-5,l.height)),e.style.display="block",e.style.left=f+"px",e.style.top=h+"px"}},n.reservedWidthToRight=0,n}(f.r)},99202:function(t,n,e){"use strict";e.d(n,{w:function(){return l}});var i=e(59312),r=e(87363),o=e(12611),s=e(262),a=e(7645),u=e(74302),c=e(40959);function l(t){return r.createElement(f,t)}var f=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Vl=o.uniqueId("ratingAccessibilityLabel."),n.zl=o.uniqueId("ratingTable."),n}return(0,i.ZT)(n,t),n.prototype.createReactNodes=function(){var t,n=this.props,e=n.MinRating;return null==e&&(e=1),t=n.ShowRatingLabel?(0,c.yR)(1,null,n.LeftDescription,n.RightDescription,e.toString(),n.Length.toString(),this.Ql(n.LeftDescription,n.RightDescription),n.Length,10,this.zl,n.FormsProRTLeftDescription,n.FormsProRTRightDescription):r.createElement("div",{className:"office-form-question-rating-container"},this.Ql()),n.ShouldAccessibleTextReadSelectedValue?r.createElement("div",{"aria-labelledby":this.Vl},r.createElement("div",{id:this.Vl,className:"screenReaderVisible"},(0,a.pm)().GradingView_RatingAnswer_LabelFormat.format(this.Ul(),n.Length)),r.createElement("div",{"aria-hidden":"true",role:"presentation"},t)):t},n.prototype.Ql=function(t,n){var e=this;void 0===t&&(t=""),void 0===n&&(n="");var i=this.props.MinRating;null==i&&(i=1);var a=o.range(i,this.props.Length+1),u=this.Ul(),c=(0,s.j)("office-form-question-rating-body","Center"===this.props.Layout?"justifyContentSpaceBetween":""),l=this.props.HTMLAttributes["aria-labelledby"],f=l?(0,s.j)(l,this.zl):this.zl;return r.createElement("div",{className:c,"aria-labelledby":f,role:"radio",tabIndex:0},a.map((function(i){var o=u===i;return r.createElement("div",{className:"office-form-question-rating-item",key:i},r.createElement("label",{htmlFor:e.$l(i),"aria-hidden":"true"},i),r.createElement("input",{id:e.$l(i),"aria-checked":o,"aria-label":"".concat(i===e.props.MinRating?t:i,"  ").concat(i===e.props.Length?n:""),"aria-posinset":i,"aria-setsize":a.length,type:"radio",disabled:e.props.Disabled,checked:o,onClick:function(){return e.props.onValueChange(i)}}))})))},n.prototype.$l=function(t){return"".concat(this.Vl,"-number-rating-").concat(t)},n.prototype.Ul=function(){return parseInt(this.props.Value)},n}(u.i)},11807:function(t,n,e){"use strict";e.d(n,{w:function(){return p}});var i=e(59312),r=e(87363),o=e(61533),s=e(12611),a=e(29559),u=e(262),c=e(64290),l=e(72377),f=e(73252),h=e(7645),d=e(83726),m=e(31442),v=e(74302),g=e(40959);function p(t){return r.createElement(b,t)}var b=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.jl=r.createRef(),n.jr=0,n.Wl=n.Kl(),n.Jl=!(0,f.VE)(),n.Zl=!1,n.Xl=s.uniqueId("rd"),n}return(0,i.ZT)(n,t),n.prototype.createReactNodes=function(){var t,n=this.props,e={className:"rateit margin-left office-form-theme-primary-foreground","data-rateit-icon":"","data-rateit-iconforempty":"","data-rateit-mode":"font","data-rateit-marginleft":this.Wl.MarginLeft,"data-rateit-marginright":this.Wl.MarginRight,"data-rateit-starwidth":this.Wl.FontSize,"data-rateit-max":n.Length,"data-rateit-value":n.Value,"data-rateit-step":1,"data-rateit-resetable":!1,"data-rateit-ispreset":!0,style:{fontSize:this.Wl.FontSize},ref:"rateit"};if(t=r.createElement("div",e,this.Yl()),n.ShowRatingLabel)return(0,g.yR)(0,this.jl,n.LeftDescription,n.RightDescription,n.LeftDescriptionTitle,n.RightDescriptionTitle,t,n.Length,10,this.Xl,n.FormsProRTLeftDescription,n.FormsProRTRightDescription);return r.createElement("div",{className:"office-form-question-rating-container",key:"c",ref:this.jl},t)},n.prototype.componentWillMount=function(){this.tf=this.tf.bind(this)},n.prototype.componentDidMount=function(){var t=this;this.nf=(0,d.d)(),this.nf.then((function(){t.Jl||(t.Jl=!0,t.forceUpdate()),t.ef()})),this.if(null),window.addEventListener("resize",this.tf)},n.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.tf)},n.prototype.componentDidUpdate=function(t){this.if(t)},n.prototype.Yl=function(){if(!this.Jl)return l.Pv.Resolve("IRatingStarsFactory").createRatingStar({NumStar:this.props.Length,Config:this.Wl})},n.prototype.if=function(t){var n=this;this.rf()?this.forceUpdate():this.nf.then((function(){return n.sf(t)}))},n.prototype.rf=function(){var t=this.jl.current;if(t&&t.clientWidth>0){this.jr=t.clientWidth;var n=this.Kl();if(!s.isEqual(n,this.Wl))return this.Wl=n,this.Zl=!0,!0}return!1},n.prototype.ef=function(){var t=this,n=this.props,e=$(o.findDOMNode(this.refs.rateit));e.rateit(),e.on("rated",(function(){var t=e.rateit("value");t>=0&&t<=n.Length&&n.onValueChange(t)})),e.on("over",(function(n,e){return t.cf(e)}));var i=e.find(".rateit-range");if(i&&n.Options&&n.Options.HTMLPropsForInnerElement)for(var r in i.removeAttr("aria-label"),n.Options.HTMLPropsForInnerElement)i.attr(r,n.Options.HTMLPropsForInnerElement[r]);if(i&&n.ShowRatingLabel){var s=i.attr("aria-labelledby");s&&(s=(0,u.j)(s,this.Xl),i.attr("aria-labelledby",s))}i&&n.Disabled&&i.attr("aria-disabled","true")},n.prototype.tf=function(){var t=this;this.Yc||(this.Yc=window.setTimeout((function(){t.Yc=null,t.rf()&&t.forceUpdate()}),100))},n.prototype.sf=function(t){if(this.props.Value>this.props.Length)(0,m.$U)("DesignPage.Questions.RatingValueOutOfBounds",{operation:"RatingValueOutOfBounds"});else{var n=$(o.findDOMNode(this.refs.rateit));if(!this.Zl&&t&&this.props.Disabled==t.Disabled&&this.props.Value===t.Value&&this.props.Length===t.Length||(this.Zl=!1,n.rateit("batchUpdate",{value:this.props.Value,max:this.props.Length,readonly:this.props.Disabled,starwidth:this.Wl.FontSize,marginleft:this.Wl.MarginLeft,marginright:this.Wl.MarginRight}),this.cf()),this.props.NoTabFocus){var e=n.find(".rateit-range");e&&e.removeAttr("tabindex")}n.children(".rateit-range").removeAttr("aria-readonly")}},n.prototype.cf=function(t){var n=null!=t?t:1;t=t||this.props.Value||0;var e=$(o.findDOMNode(this.refs.rateit));(0,c.md)((function(){var t;n&&Array.from(null===(t=e[0])||void 0===t?void 0:t.getElementsByClassName("rateit-empty")[0].getElementsByTagName("span")).forEach((function(t,n){return t.setAttribute("title","".concat(n+1," Stars"))}))}));var i=(0,h.pm)().Renderer_RatingControlText.format(t);e.attr("title",i)},n.prototype.Kl=function(){var t=this.props.IsRtlLanguage,n={MarginLeft:4,MarginRight:4,FontSize:24,IsRtlLanguage:t};if(this.jr>0)if(this.lf()){n.MarginLeft=4;var e=this.props.Length,i=e>6?24:28;if(n.FontSize=i,e<4)n.MarginRight=27;else{n.MarginRight=(this.jr-n.MarginLeft*(e+1)-i*e)/(e-1)}}else if(this.jr>380)return{MarginLeft:5,MarginRight:5,FontSize:this.props.Compact?24:28,IsRtlLanguage:t};return n},n.prototype.lf=function(){return this.props.IsMobile||(0,a.tq)()},n}(v.i)},40959:function(t,n,e){"use strict";e.d(n,{yR:function(){return c}});var i=e(59312),r=e(87363),o=e(262),s=e(7645),a=e(24497),u=(e(64290),e(65863));function c(t,n,e,c,l,f,h,d,m,v,g,p){var b=0===t?"star":"number",y="office-form-question-rating-description-".concat(b),w="office-form-rating-container-".concat(b," container-margin-right"),S="office-form-rating-container-".concat(b," container-margin-left");""===e&&(w=(0,o.j)(w,"container-empty")),d===m&&(w=(0,o.j)(w,"container-".concat(b,"-max-width")),S=(0,o.j)(S,"container-".concat(b,"-max-width")));var N=r.createElement(u.D,{Text:(0,a.wg)(e,g),RenderMode:"RichText",ContainsHtml:!0}),C=r.createElement(u.D,{Text:(0,a.wg)(c,p),RenderMode:"RichText",ContainsHtml:!0}),I=r.createElement("div",{className:w},r.createElement("div",{className:y},N||e)),T=r.createElement("div",{className:S},r.createElement("div",{className:y},C||c));return r.createElement(r.Fragment,null,r.createElement("div",{className:"office-form-question-rating-container",key:"d",ref:n},I,h,T),(e||c)&&function(t,n,e,o,c,l,f){var h=(0,a.wg)(t,l),d=(0,a.wg)(n,f);var m=r.createElement("div",{className:"office-form-response-rating-description"},r.createElement("div",{className:"office-form-rating-description-label"},e),r.createElement("div",{className:"rating-option-description"},r.createElement(u.D,{Text:(0,s.pm)().Colon.format(null==h?void 0:h.trim()),RenderMode:"RichText",ContainsHtml:!0}))),v=r.createElement("div",{className:"office-form-response-rating-description"},r.createElement("div",{className:"office-form-rating-description-label"},o),r.createElement("div",{className:"rating-option-description"},r.createElement(u.D,{Text:(0,s.pm)().Colon.format(null==d?void 0:d.trim()),RenderMode:"RichText",ContainsHtml:!0}))),g={className:"office-form-rating-description-container",id:c};return r.createElement("div",(0,i.pi)({},g),m,v)}(e,c,l,f,v,g,p))}},61111:function(t,n,e){"use strict";e.d(n,{E:function(){return m},P:function(){return v}});var i=e(59312),r=e(87363),o=e(61533),s=e(12611),a=e(29559),u=e(262),c=e(38174),l=e(54496),f=e(23112),h=e(3424),d=e(65863);function m(t){return r.createElement(v,(0,i.pi)({},t))}var v=function(t){function n(e){var i=t.call(this,e)||this;i.ff=!0,i.al=s.uniqueId(n.name),i.hf=i.al+"_placeholder",i.df=r.createRef(),i.mf=i.mf.bind(i),i.vf=i.vf.bind(i),i.gf=i.gf.bind(i),i.yf=i.yf.bind(i);var o=i.wf(),a=s.findIndex(o,(function(t){return t.Value===i.props.Value}));return i.Sf=a<0?void 0:o[a].Key,i.state={Expanded:!1},i}return(0,i.ZT)(n,t),n.prototype.componentWillUpdate=function(t,e){var i=n.GetSelectOptions(t),r=s.findIndex(i,(function(n){return n.Value===t.Value}));this.Sf=r<0?void 0:i[r].Key},n.prototype.componentDidMount=function(){this.ff=!1},n.prototype.componentDidUpdate=function(){if(this.Nf(),this.state.Expanded){if(this.Cf(),this.props.NeedScroll){var t=this.df.current;if(t){var n=$(".office-form-content"),e=t.getBoundingClientRect().bottom,i=n.height()-e;if(i<70){var r=o.findDOMNode(this.refs.menu);n.scrollTop(n.scrollTop()+r.offsetHeight-i)}}}var s=this.refs[this.Sf];if(s){var a=o.findDOMNode(s);a&&a.focus()}}},n.prototype.Cf=function(){var t=document.getElementById(this.al),n=window.getComputedStyle(t),e=t.offsetWidth,i=o.findDOMNode(this.refs.menu);(this.props.AllowWrap||i.offsetWidth<e)&&(i.style.width=e+"px"),i.style.top=t.offsetHeight-parseInt(n.borderTopWidth)+"px",i.style.left="-"+n.borderLeftWidth},n.prototype.render=function(){var t=this,n=s.extend({},this.props.HTMLAttributes),e=(0,l.p2)(n,{className:"select-control",id:this.al,onBlur:this.mf,onClick:n.disabled?void 0:function(){return t.If()},onKeyUp:this.vf,onKeyDown:this.gf,ref:this.df,tabIndex:n.disabled?-1:0});return this.props.IsMobile||(e=(0,l.p2)(e,{"aria-describedby":this.hf,"aria-expanded":this.state.Expanded,"aria-haspopup":"listbox","aria-label":this.props.Label,"aria-required":!!this.props.required,role:"listbox"})),r.createElement("div",(0,i.pi)({},e),this.Tf(),this.kf())},n.GetSelectOptions=function(t){var n=t.SelectOptions;if(n)return n;var e=t.SelectOptionGroups;return s.flatten(e.map((function(t){return t.SelectOptions})))},n.prototype.wf=function(){return n.GetSelectOptions(this.props)},n.prototype.xf=function(){return!!this.Ff()},n.prototype.Ff=function(){return this.props.SelectOptionGroups},n.prototype.Tf=function(){var t,n=this,e=this.wf(),o=s.findIndex(e,(function(t){return void 0===n.Sf?t.Value===n.props.Value:t.Key===n.Sf})),u=this.Sf?"select-placeholder-text":"select-placeholder-text default",c=this.props.IsMobile;o>=0&&(t=e[o].DisplayContent||e[o].DisplayName),t||(t=this.props.Placeholder||"");var f=(this.props.PlaceholderIcon||this.props.PlaceholderFluentIcon)&&r.createElement("div",{className:"select-placeholder-icon","aria-hidden":"true"},r.createElement(h.F,{FluentIcon:this.props.PlaceholderFluentIcon,IconName:this.props.PlaceholderIcon,HTMLAttributes:{className:"forms-icon-size14x14"}})),m={className:"select-placeholder","aria-hidden":(0,a.Dt)(),"aria-label":c?this.props.Label:this.Pf(e[o]),"aria-live":this.state.Expanded||this.ff?"off":"polite","aria-selected":!0,"aria-posinset":o>0?o+1:void 0,"aria-setsize":o>0?e.length:void 0,id:this.hf,role:this.props.IsMobile?"button":"option"};return c&&(m=(0,l.p2)(m,{"aria-expanded":this.state.Expanded,"aria-haspopup":"listbox"})),r.createElement("div",(0,i.pi)({},m),f,r.createElement("span",{className:u},"string"==typeof t?r.createElement(d.D,{Text:t,RenderMode:"RichText",ContainsHtml:!0}):r.createElement("span",null,t)),this.Mf())},n.prototype.Pf=function(t){return t&&t.DisplayName?t.DisplayName:this.props.Placeholder||""},n.prototype.Mf=function(){var t={FluentIcon:this.state.Expanded?"Chevron Up":"Chevron Down",HTMLAttributes:{className:"select-placeholder-arrow forms-icon-size14x14"},IconName:this.state.Expanded?"ChevronUp":"ChevronDown"};return r.createElement(h.F,(0,i.pi)({},t))},n.prototype.kf=function(){var t=this;if(this.state.Expanded){var n={"aria-label":this.props.Label,className:"select-option-menu-container",ref:"menu",role:"listbox",onWheel:function(n){n.preventDefault();var e=n.deltaY,i=o.findDOMNode(t.refs.menu),r=i.scrollTop+e;if(e>=0){var s=i.scrollHeight-i.clientHeight;i.scrollTop=Math.min(r,s)}else i.scrollTop=Math.max(r,0)}};return r.createElement("div",(0,i.pi)({},n),this.Lf())}},n.prototype.Lf=function(){var t=this;return this.xf()?this.Ff().map((function(n,e){return t.Rf(n,e)})):this.Af(this.wf())},n.prototype.Rf=function(t,n){var e=!(!t.SelectOptions.length||!t.DisplayName)&&r.createElement("h5",{className:"select-group-header office-form-theme-primary-color",key:"group_header"+n},t.DisplayName);return r.createElement(r.Fragment,{key:"group_"+n},e,this.Af(t.SelectOptions))},n.prototype.Af=function(t){var n=this;return t.map((function(t,e,i){return n.Ef(t,e,i.length)}))},n.prototype.Ef=function(t,n,e){var s=this,a=t.Key===this.Sf,c={"aria-label":t.AriaLabel||t.DisplayName,"aria-selected":a,"aria-disabled":t.Disabled,"aria-posinset":n+1,"aria-setsize":e,className:this.props.AllowWrap?"select-option-nocheck":"select-option",tabIndex:a?0:-1,key:t.Key,ref:t.Key&&t.Key.toString(),role:"option"};t.Disabled?(c.className=(0,u.j)(c.className,"disabled"),c["aria-labelledby"]=t.ArialLabelId||void 0,c.onFocus=function(n){n.stopPropagation(),t.showToolTip&&t.showToolTip(),t.DisableFocused=!0},c.onBlur=function(n){n.stopPropagation(),t.hideToolTip&&t.hideToolTip(),t.DisableFocused=!1}):c.onClick=function(n){n.stopPropagation(),s.Sf&&s.Sf===t.Key||s.props.onValueChange(t.Value),s.setState({Expanded:!1},(function(){o.findDOMNode(s).focus()}))};var l,f="select-option-state forms-icon-size14x14";(this.props.PlaceholderIcon||this.props.PlaceholderFluentIcon)&&(f=(0,u.j)(f,"hasPlaceholderIcon")),this.props.AllowWrap||(l=r.createElement(h.F,{FluentIcon:"Checkmark",HTMLAttributes:{className:f}})),a&&(c.className=(0,u.j)(c.className,"selected"));var m=t.DisplayContent;return m||(m=r.createElement("span",{"aria-hidden":"true"},r.createElement(d.D,{Text:t.DisplayName,RenderMode:"RichText",ContainsHtml:!0}))),r.createElement("div",(0,i.pi)({},c),r.createElement("div",{className:"select-option-content"},l,m))},n.prototype.mf=function(t){var n=this,e=this.df.current;t.persist(),window.setTimeout((function(){var i=(0,c.y3)(t);e&&!e.contains(i)&&n.state.Expanded&&"HTML"!==i.nodeName&&n.setState({Expanded:!1})}),0)},n.prototype.gf=function(t){if(this.state.Expanded&&27===t.keyCode&&(t.stopPropagation(),this.yf()),(0,a.Dt)())switch(t.keyCode){case 32:case 13:t.preventDefault(),t.stopPropagation()}},n.prototype.vf=function(t){var n=this;switch(t.keyCode){case 32:this.setState({Expanded:!0}),t.stopPropagation();break;case 13:this.If(!0),t.stopPropagation();break;case 9:this.state.Expanded&&(t.stopPropagation(),this.yf());break;case 38:case 40:t.altKey?this.setState({Expanded:!this.state.Expanded},(function(){var t=n.df.current;!n.state.Expanded&&t&&t.focus()})):38===t.keyCode?this.Of():this._f(),t.stopPropagation(),t.preventDefault()}},n.prototype.Of=function(){var t=this,n=this.wf(),e=s.findIndex(n,(function(n){return n.Key===t.Sf}));if(e>0){var i=n[e-1];if(this.Sf=i.Key,i.Disabled||this.props.disableSelectOnArrowKeys){var r=o.findDOMNode(this.refs[i.Key]);r&&r.focus()}else this.props.onValueChange(i.Value)}},n.prototype._f=function(){var t=this,n=this.wf(),e=s.findIndex(n,(function(n){return n.Key===t.Sf}));if(e<n.length-1){var i=n[e+1];this.Sf=i.Key;var r=o.findDOMNode(this.refs[i.Key]);r&&r.focus(),i.Disabled||this.props.disableSelectOnArrowKeys||this.props.onValueChange(i.Value)}},n.prototype.If=function(t){var n=this,e=this.wf();if(this.state.Expanded){if(o.findDOMNode(this).focus(),this.props.disableSelectOnArrowKeys){var i=s.findIndex(e,(function(t){return t.Key===n.Sf}));e[i]&&this.props.onValueChange(e[i].Value)}}else t&&void 0===this.Sf&&e[0]&&this.props.onValueChange(e[0].Value);this.setState({Expanded:!this.state.Expanded})},n.prototype.Nf=function(){if(this.state.Expanded){var t=$(o.findDOMNode(this.refs.menu)),n=t.find(".select-option.selected");(0,l.n1)(n,t)}},n.prototype.yf=function(){var t=this,n=this.wf();s.some(n,(function(t){return t.DisableFocused}))?n.forEach((function(t){t.Disabled&&t.hideToolTip&&(t.hideToolTip(),t.DisableFocused=!1)})):this.setState({Expanded:!1},(function(){t.df.current&&t.df.current.focus()}))},n.prototype.focus=function(){o.findDOMNode(this).focus()},n}(f.r)},40554:function(t,n,e){"use strict";e.d(n,{o:function(){return g},s:function(){return v}});var i=e(59312),r=e(87363),o=e(61533),s=e(12611),a=e(29559),u=e(262),c=e(38174),l=e(54496),f=e(3424),h=e(23112),d=e(63481),m=e(42605);function v(t){return r.createElement(g,(0,i.pi)({},t))}var g=function(t){function n(e){var i=t.call(this,e)||this;return i.Bf=s.uniqueId(n.name),i.Hf=i.Hf.bind(i),i}return(0,i.ZT)(n,t),n.prototype.componentDidMount=function(){(void 0===this.props.TrapFocus||this.props.TrapFocus)&&(0,d.mZ)(o.findDOMNode(this))},n.prototype.shouldComponentUpdate=function(t){return!s.isEqual(this.props,t)},n.prototype.render=function(){var t=this;if(this.props.ShowDialog){var n=(0,l.p2)(this.props.HTMLAttributes,{className:this.props.ClassName||"simple-dialog-container",key:"dialogContainer",ref:"dialogContainer",tabIndex:-1,onBlur:function(n){var e=(0,c.y3)(n);o.findDOMNode(t.refs.dialogContainer).contains(e)||t.props.onBlur&&t.props.onBlur()},onKeyDown:function(n){return t.gf(n)},onMouseLeave:this.props.onMouseLeave,onMouseOver:this.props.onMouseOver}),e=!(0,a.tq)();return r.createElement("div",(0,i.pi)({},n),this.props.children,this.Gf(),e&&this.props.CloseButtonProps&&this.qf(),this.Vf(),this.zf(),this.Qf())}return null},n.prototype.Gf=function(){var t=this.props;if(t.IconName||t.FluentIcon){var n={FluentIcon:t.FluentIcon,HTMLAttributes:{className:t.IconClassName},IconName:t.IconName,key:"icon"};return r.createElement(f.F,(0,i.pi)({},n))}},n.prototype.qf=function(){return this.Hf(this.props.CloseButtonProps,this.props.ButtonsProps.length+1)},n.prototype.Vf=function(){if(this.props.Description){var t=(0,u.j)("description-container",this.props.TextClassName);return r.createElement("div",{className:t,id:this.Bf,key:"descriptionContainer"},this.props.Description)}return null},n.prototype.Qf=function(){return this.props.WarningMessage?r.createElement("div",{className:"warning-container",id:this.Bf+"_warning",key:"warningContainer"},this.props.WarningMessage):null},n.prototype.Hf=function(t,n){return(0,m.F)({ButtonStyle:t.ButtonStyle,GlyphButtonStyle:t.GlyphButtonStyle,FluentIcon:t.FluentIcon,HTMLAttributes:{"aria-describedby":t.ConveyDescription?this.Bf:"",autoFocus:0===n,className:t.ClassName,title:t.Title,onClick:function(n){n.preventDefault(),n.stopPropagation(),t.onClick&&t.onClick(n)}},Icon:t.IconClass,IconClassName:(0,u.j)(t.IconClassName,"forms-icon-size24x24"),IsDisabled:t.IsDisabled,key:t.Key,ref:t.ref,Text:t.Text,TextClassName:t.TextClassName})},n.prototype.zf=function(){var t=this.props.ButtonsProps||[];return t.length>0?r.createElement("div",{className:"buttons-container",key:"buttonsContainer"},t.filter((function(t){return!!t})).map(this.Hf)):null},n.prototype.gf=function(t){27===t.keyCode&&(t.stopPropagation(),t.preventDefault(),this.props.onDismiss&&this.props.onDismiss())},n}(h.r)},20572:function(t,n,e){"use strict";e.d(n,{aQ:function(){return T},ZA:function(){return C},ZN:function(){return I}});var i=e(59312),r=e(87363),o=e(61533),s=e(12611),a=e(29559),u=e(262),c=e(63795),l=e(73252),f=e(687),h=e(7645),d=e(54496),m=e(32782),v=e(29295);function g(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(757).then(e.bind(e,38405))];case 1:return[2,{default:t.sent().EditorRibbonCombination}]}}))}))}function p(t){var n=(0,v.J)(p,g);return r.createElement(m.Z,null,r.createElement(n,(0,i.pi)({},t)))}var b=e(64290),y=e(31442),w=e(23112);var S=e(74302),N=e(35929);function C(t){return r.createElement(k,t)}function I(t,n,e,i,r,o,s,a,u){return(0,b.pd)((function(){return C(t)}),b.t1)}function T(t,n,e,i,r){return void 0===e&&(e=null),void 0===i&&(i=!0),n?I(t):C(t)}var k=function(t){function n(n){var e=t.call(this,n)||this;return e.Uf=r.createRef(),e.$f=e.$f.bind(e),e}return(0,i.ZT)(n,t),n.prototype.componentDidMount=function(){this.props.AutoFocus&&this.focus()},n.prototype.focus=function(){if(this.Uf.current)this.Uf.current.focus();else{var t=o.findDOMNode(this),n=$(t).find(".roosterjs-editor-box");n&&n.focus()}},n.prototype.createReactNodes=function(){return r.createElement(r.Fragment,{},this.jf(),this.Wf())},n.prototype.jf=function(){var t=this.props,n=t.Options;if(t.Label||t.ShowRequiredStar)return r.createElement("div",null,r.createElement("span",{className:n&&n.classNameForInnerLabel},t.Label),t.ShowRequiredStar?r.createElement(N.R):void 0)},n.prototype.Kf=function(){var t=this,e=this.props,i=e.Options,r="DesignPage.ShortCut.Clipboard",s="".concat("office-form-textfield-input"," form-control border-no-radius");return(0,d.p2)(i&&i.HTMLPropsForInnerElement,{value:e.Value||"","aria-label":e.AriaLabel,className:s,rows:this.props.Rows,placeholder:e.Placeholder,ref:this.Uf,"aria-required":e.Required,style:{height:e.MinimalHeight?"".concat(e.MinimalHeight,"px"):void 0,overflowY:1===e.TextFieldType?"auto":void 0},spellCheck:!0,disabled:e.Disabled,onChange:this.Dc.bind(this),maxLength:e.MaxLength?e.MaxLength:(0,f.LY)(),onFocus:e.AutoSelection?function(){if(t.Uf.current){var n=o.findDOMNode(t.Uf.current);n&&n.select()}}:void 0,onClick:function(){var n;return(0,a.gn)()&&(null===(n=t.Uf.current)||void 0===n?void 0:n.focus())},onKeyDown:(0,d.IB)((function(i){if(i.ctrlKey||i.metaKey){var o=new Date,s=String.fromCharCode(i.keyCode),a="".concat(i.ctrlKey?"Ctrl":"Meta","+").concat(s);switch(s){case"B":case"I":case"U":(0,y.$U)("TextFormatShortcutEvent",{TextFormatFlight:!0,Shortcut:a,Location:e.TextFieldLocation});break;case"C":case"X":t.Jf(n.prevTimeKeyDown,o.getTime())>n.minDuration&&t.Yf(i,r,a),n.prevTimeKeyDown=o.getTime();break;case"V":t.Yf(i,r,a);break;case"Y":case"Z":t.Yf(i,"DesignPage.ShortCut.UndoRedo",a)}}})),onCopy:function(e){var i=new Date;t.Jf(n.prevTimeOnCopy,i.getTime())>n.minDuration&&t.Yf(e,r,"onCopy"),n.prevTimeOnCopy=i.getTime()},onPaste:function(n){t.Yf(n,r,"onPaste")},onCut:function(e){var i=new Date;t.Jf(n.prevTimeOnCut,i.getTime())>n.minDuration&&t.Yf(e,r,"onCut"),n.prevTimeOnCut=i.getTime()}})},n.prototype.Wf=function(){var t,n,e,i,o,s,a=this.props,c=this.Kf(),f=(0,u.j)("office-form-textfield",null===(t=a.Options)||void 0===t?void 0:t.classNameForInnerDiv);if(a.Disabled||!a.AllowRichText||(0,l._y)())switch(a.TextFieldType){case 2:var d=c,m=null==a.MinimalHeight?80:a.MinimalHeight>0?a.MinimalHeight:0;d.MinHeight=m.toString()+"px",e=function(t){return r.createElement(x,t)}(d);break;case 1:i=r.createElement("textarea",c);break;default:o=r.createElement("input",c)}else{f=(0,u.j)(f,"textfield-with-text-format");var v=(0,u.j)("roosterjs-editor-box",c.className);(2===a.TextFieldType||a.AllowHeightAdjustment)&&(v=(0,u.j)(v,"auto-height-div"),delete c.style.height,c.style.minHeight=a.MinimalHeight?"".concat(a.MinimalHeight,"px"):void 0),n=p({$ariaLabel:c["aria-label"],$autoFocus:a.AutoFocus,$className:v,$disableRibbon:a.DisableRibbon,$leaveFirstLineOnlyWhenPaste:a.LeaveFirstLineOnlyWhenPaste,$maxLength:c.maxLength,$placeHolder:c.placeholder,$preventMultiline:!a.TextFieldType,$style:c.style,$textFieldLocation:a.TextFieldLocation,$value:String(c.value),$context:{$flights:{$svgIcon:!1},$ls:(0,h.pm)(),$funcAdapters:{$logEngagement:y.$U}},$onKeyDown:c.onKeyDown,$onPaste:a.onRichEditorPaste,$updateContentToBindBox:this.$f})}if(a.ShowCharCounter){var g=!a.Value||c.maxLength>a.Value.length?"office-form-textfield-counter":"office-form-textfield-counter textfield-counter-warning";s=r.createElement("label",{className:g},this.nh(a.Value,c.maxLength))}return r.createElement("div",{className:f},n,e,i,o,s)},n.prototype.$f=function(t){this.props.onValueChange(t)},n.prototype.Dc=function(t){if(!this.props.Disabled){var n=t.target,e=(0,c.bC)(n.value);if(e&&e.length>n.maxLength&&(e=e.slice(0,n.maxLength)),this.props.onValueChange(e),this.props.ShowCharCounter){var i=o.findDOMNode(n).nextSibling;i&&(i.innerText=this.nh(e,n.maxLength))}}},n.prototype.nh=function(t,n){return(t||"").length.toString()+" / "+n.toString()},n.prototype.Yf=function(t,n,e){var i;this.props.HTMLAttributes&&(i=this.props.HTMLAttributes.className),(0,y.$U)(n,{targetClassName:i,operation:e})},n.prototype.Jf=function(t,n){return n-t},n.prevTimeKeyDown=0,n.prevTimeOnCopy=0,n.prevTimeOnCut=0,n.minDuration=500,n}(S.i);var x=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Uf=r.createRef(),n}return(0,i.ZT)(n,t),n.prototype.componentDidMount=function(){this.eh(),this.ih=this.eh.bind(this),window.addEventListener("resize",this.ih)},n.prototype.componentDidUpdate=function(){this.eh()},n.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.ih)},n.prototype.focus=function(){this.Uf.current&&this.Uf.current.focus()},n.prototype.render=function(){var t=s.clone(this.props);return t.ref=this.Uf,delete t.MinHeight,r.createElement("textarea",t)},n.prototype.eh=function(){if(!this.Uf.current.hasAttribute("rows")){var t=o.findDOMNode(this),n=this.props,e=t.parentElement,i=e.style.height;e.style.height=window.getComputedStyle(e).height,t.style.height=n.MinHeight;var r=t.offsetHeight-t.clientHeight;t.style.height=t.scrollHeight+r+"px",e.style.height=i,t.style.minHeight=n.MinHeight}},n}(w.r)},9097:function(t,n,e){"use strict";e.d(n,{i:function(){return s}});var i=e(59312),r=e(87363),o=e(262);function s(t){return r.createElement(a,t)}var a=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.createReactNodes=function(){return r.createElement(r.Fragment,{},this.oh(),this.jf(),this.props.children)},n.prototype.jf=function(){var t=this.props.Options,n=t&&t.classNameForInnerLabel;return this.props.Disabled&&(n=(0,o.j)(n,"disabled")),this.props.Label&&!this.props.HideText?r.createElement("span",{className:n},this.props.Label):void 0},n.prototype.oh=function(){var t=this.props,n=t.Options,e=(0,o.j)(n&&n.classNameForInnerDiv,t.Disabled?"toggle-button disabled":"toggle-button",t.Value?"office-form-theme-toggle active":void 0,t.ParentComponent);return r.createElement("div",{className:e,tabIndex:t.Disabled?-1:0,role:"switch",type:"button","aria-label":t.Label,"aria-checked":!!t.Value,onClick:t.Disabled?function(){}:function(){t.onValueChange(!t.Value)},onKeyDown:function(n){13!==n.keyCode&&32!==n.keyCode||(t.onValueChange(!t.Value),"header"===t.ParentComponent&&(t.Value?t.focusStringSetter("toggle-button header"):t.focusStringSetter("toggle-button  header office-form-theme-toggle header active")))},title:t.Disabled?t.DisabledText:void 0})},n}(e(74302).i)},65863:function(t,n,e){"use strict";e.d(n,{D:function(){return f},q:function(){return l}});var i=e(59312),r=e(87363),o=e(23112),s=e(37944),a=e(18113),u=e(24497),c=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.render=function(){var t=this.props,n=t.Html;t.RenderHtml||(n=(0,a.ZP)(t.Html));var e=(0,u.gA)(n);return r.createElement(s.H,{id:t.Id,className:"text-format-content",$html:e})},n}(o.r);function l(t){return r.createElement(f,(0,i.pi)({},t))}var f=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.render=function(){var t;return"RichText"===(this.props.RenderMode||"PlainText")?(t={id:this.props.Id,Html:this.props.Text,RenderHtml:this.props.ContainsHtml},r.createElement(c,(0,i.pi)({},t))):(t={id:this.props.Id},r.createElement("span",(0,i.pi)({},t),this.props.Text))},n}(o.r)},77309:function(t,n,e){"use strict";e.d(n,{L:function(){return s}});var i=e(59312),r=e(87363),o=e(12611),s=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this;this.props.LazyRendering&&window.setTimeout((function(){return t.setState({Mounted:!0})}))},n.prototype.render=function(){var t=o.clone(this.props.HTMLAttributes||{});switch(this.props.Role){case"Alert":t.role="alert";break;case"Log":t.role="log",t["aria-live"]=t["aria-live"]||"polite",t["aria-relevant"]=t["aria-relevant"]||"additions text";break;case"Marquee":t.role="marquee";break;case"Status":t.role="status"}return this.props.LazyRendering&&!this.state.Mounted?(t["aria-label"]=void 0,t.children=null,r.createElement("div",(0,i.pi)({},t))):r.createElement("div",(0,i.pi)({},t),this.props.children)},n}(e(23112).r)},8214:function(t,n,e){"use strict";e.d(n,{s:function(){return o}});var i=e(59312),r=e(87363);function o(t){return t.SubMenu||!t.Active?t.children:r.createElement("div",(0,i.pi)({},t.HTMLAttributes),t.children)}},71170:function(t,n,e){"use strict";e.d(n,{J:function(){return d},P:function(){return h}});var i=e(59312),r=e(87363),o=e(12611),s=e(262),a=e(97265),u=e(7645),c=e(64290),l=e(23112),f=e(65863),h=function(t){function n(e){var i=t.call(this,e)||this;return i.sh=r.createRef(),i.ah=(0,a.GW)(),i.Vl=o.uniqueId(),i.uh=n.createNPSOptions(),i.lh=function(t){var n=i.props.onValueChange;n&&n(parseInt(t.currentTarget.value,10))},i.fh=function(t){i.setState({FocusValue:parseInt(t.currentTarget.value,10)})},i.dh=function(){i.setState({FocusValue:void 0})},i.mh=function(t){return i.gh(t)},i.ph=function(){return i.yh=!0},i.wh=function(t){i.yh=!1,i.setState({Touch:-1})},i.Sh=function(t){return i.Nh(t)},i}return(0,i.ZT)(n,t),n.prototype.render=function(){var t="nps-control clearfix unselectable-text",n="nps-control-table reset",e=this.Vl;this.props.Disabled||(n=(0,s.j)(n,"enabled"));var a=this.props.HTMLAttributes,u={};return a?(t=(0,s.j)(t,a.className),e=(0,s.j)(a["aria-labelledby"],e),o.extend(u,a)):e=null,u.className=n,u["aria-labelledby"]=e,r.createElement("div",{className:t},this.Ch(),r.createElement("table",(0,i.pi)({},u),this.Ih(),this.kh()),this.props.LeftLabel||this.props.RightLabel?this.xh():void 0)},n.prototype.Ch=function(){var t=this.state.Touch,n=(0,s.j)(void 0!==t&&-1!==t?"nps-pop-up show":"nps-pop-up",this.props.ClassNameForInnerLabel,t===this.props.Value?"active":"");return r.createElement("div",{className:n,ref:this.sh},r.createElement("span",{className:"nps-pop-up-text"},this.state.Touch))},n.prototype.xh=function(){var t=this;return(0,c.pd)((function(){var n={className:"nps-control-label-container clearfix",id:t.Vl,"aria-label":t.Ph()};return r.createElement("div",(0,i.pi)({},n),r.createElement("div",{className:"left-label"},r.createElement("span",null,(0,f.q)({Text:t.props.LeftLabel,RenderMode:"RichText",ContainsHtml:!0}))),r.createElement("div",{className:"right-label"},r.createElement("span",null,(0,f.q)({Text:t.props.RightLabel,RenderMode:"RichText",ContainsHtml:!0}))))}),c.t1)},n.prototype.Ph=function(){var t=this.uh[0].Value.toString(),n=this.props.LeftLabel,e=this.uh[this.uh.length-1].Value.toString(),i=this.props.RightLabel,r=n?"".concat(t,": ").concat(n,". "):"",o=i?"".concat(e,": ").concat(i,". "):"";return". ".concat(r).concat(o)},n.createNPSOptions=function(){for(var t=[],n=0;n<11;n++)t.push({DisplayName:d(n),Key:n,Value:n});return t},n.prototype.Ih=function(){return r.createElement("thead",null,r.createElement("tr",{className:"nps-head-row"},this.uh.map((function(t){return r.createElement("th",{className:"nps-head-column",key:t.Key},t.Value)}))))},n.prototype.kh=function(){var t=this,n=this.uh.map((function(n,e){return t.Dh(n,e)}));return r.createElement("tbody",null,r.createElement("tr",null,n))},n.prototype.Dh=function(t,n){var e=this.props.Value,a=this.props.Disabled;o.isString(e)&&(e=parseInt(e,10));var u=e===t.Value,c="nps-".concat(this.ah,"-").concat(t.Value),l={"aria-label":t.Value.toString(),"aria-posinset":n+1,"aria-setsize":this.uh.length,checked:u,disabled:this.props.Disabled,id:c,name:"nps-".concat(this.ah),type:"radio",value:t.Value},f={htmlFor:c};return a||(o.extend(l,{onBlur:-1===this.state.Touch?void 0:this.dh,onChange:this.lh,onFocus:-1===this.state.Touch?void 0:this.fh}),o.extend(f,{htmlFor:c,onTouchCancel:this.wh,onTouchEnd:this.Sh,onTouchMove:this.ph,onTouchStart:this.mh})),f.className=(0,s.j)("answer-label",void 0!==this.state.Touch?"touch":"",this.props.ClassNameForInnerLabel,u?"active":"",this.state.FocusValue===t.Value?"focus":""),r.createElement("td",{key:t.Key,className:"radio-button-item"},r.createElement("div",{className:"radio-button"},r.createElement("input",(0,i.pi)({},l)),r.createElement("label",(0,i.pi)({},f),r.createElement("span",{"data-text":t.Value,className:"radio-button-display"}))))},n.prototype.gh=function(t){var n=t.currentTarget,e=this.sh.current,i=e.parentElement.getBoundingClientRect(),r=n.getBoundingClientRect(),o=r.width/2,s=r.height/2;e.style.left="".concat(r.left-i.left-o/2,"px"),e.style.top="".concat(r.top-i.top-s/2,"px"),e.style.width="".concat(r.width+o,"px"),e.style.height="".concat(r.height+s,"px");var a=n.firstElementChild;this.setState({Touch:parseInt(a.dataset.text,10)})},n.prototype.Nh=function(t){var n=this;if(this.yh)this.yh=!1,this.setState({Touch:-1});else{var e=this.state.Touch;this.setState({Touch:-1},(function(){var t=n.props.onValueChange;t&&t(e)}))}t.preventDefault()},n}(l.r);function d(t){return t<7?(0,u.pm)().NPS_Detractors:t>8?(0,u.pm)().NPS_Promoters:(0,u.pm)().NPS_Passives}},25306:function(t,n,e){"use strict";e.d(n,{A:function(){return a},E:function(){return u}});var i=e(59312),r=e(87363),o=e(12611),s=e(93387),a=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.ys=r.createRef(),n}return(0,i.ZT)(n,t),n.prototype.render=function(){var t;return(t=o.clone(this.props)||{}).children=this.props.Text,t.ref=this.ys,t.HTMLAttributes=o.clone(t.HTMLAttributes)||{},t.HTMLAttributes["aria-label"]=t.HTMLAttributes["aria-label"]||this.props.Text,r.createElement(s.zx,(0,i.pi)({},t))},n.prototype.focus=function(){this.ys.current&&this.ys.current.focus()},n}(e(23112).r);function u(t){return r.createElement(a,(0,i.pi)({},t))}},8009:function(t,n,e){"use strict";e.d(n,{C:function(){return c}});var i=e(59312),r=e(87363),o=e(29559),s=e(687),a=e(23112),u=e(49221),c=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.render=function(){var t;return t=this.props.ShowVideoUrl?r.createElement(u.k,{InDesignMode:this.props.InDesignMode,IsMobile:this.props.IsMobile,LocalizedStrings:this.props.LocalizedStrings,VideoUrl:this.props.Url}):r.createElement("iframe",{allowFullScreen:!0,className:this.props.ClassNameForIFrame,frameBorder:"0",height:n.calcVideoDisplayHeight(),sandbox:"allow-scripts allow-same-origin allow-popups allow-forms",src:this.props.Url,width:"100%","aria-label":this.props.LocalizedStrings.Linked_Video}),r.createElement("div",(0,i.pi)({},this.props.HTMLAttributes),t,this.props.children)},n.calcVideoDisplayHeight=function(){if((0,o.tq)()){var t=$(window).width();return 0===t&&(t=document.body.scrollWidth),9*t/16}return(0,s.HR)()},n}(a.r)},47432:function(t,n,e){"use strict";e.d(n,{P:function(){return F}});var i=e(59312),r=e(87363),o=e(61533),s=e(12611),a=e(94283),u=e(262),c=e(37890),l=e(687),f=e(7645),h=e(72467),d=e(90819),m=e(64520),v=e(64290),g=e(31442),p=e(3424),b=e(42605),y=e(41040),w=e(77309),S=e(25306),N=e(23112),C=e(3920),I=e(93387),T=e(20572),k=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Lh=r.createRef(),n.Rh=r.createRef(),n.Oh=r.createRef(),n._h=r.createRef(),n.Bh=r.createRef(),n.Hh=r.createRef(),n.qh=!1,n.Qh=!1,n.Uh=!1,n.state={ShowAltTextButton:!0},n.$h=function(t){return n.jh(t)},n}return(0,i.ZT)(n,t),n.prototype.componentWillMount=function(){document.addEventListener("click",this.$h)},n.prototype.componentDidUpdate=function(){var t=this.Lh.current,n=this._h.current;this.qh&&(!this.props.SizeButtontDisabled&&t?(t.focus(),this.qh=!1):!this.props.ZoomButtonDisabled&&n&&(n.focus(),this.qh=!1));var e=this.Hh.current;this.Uh&&e&&e.focus();var i=this.Oh.current;this.Qh&&i&&(o.findDOMNode(i).getElementsByTagName("input")[0].focus(),this.Qh=!1)},n.prototype.componentWillUnmount=function(){document.removeEventListener("click",this.$h)},n.prototype.render=function(){var t=this,n=[];return this.props.Expanded?(this.props.SizeButtontDisabled||n.push(this.Kh()),this.props.ZoomButtonDisabled||n.push(this.Xh()),n.push(this.Yh())):n.push(this.td()),n.push(this.nd()),r.createElement("div",{className:"image-edit-pane-container office-form-theme-border","aria-label":(0,f.pm)().UploadFile_Type_Image,role:"group",onKeyUp:function(n){t.props.onKeyUpOnEditPane&&(t.props.onKeyUpOnEditPane(n),27===n.keyCode&&(t.Uh=!0))}},n)},n.prototype.ed=function(){return 2===this.props.ZoomButtonState||0===this.props.ZoomButtonState},n.prototype.od=function(){return 2===this.props.ZoomButtonState||1===this.props.ZoomButtonState},n.prototype.sd=function(t){this.props.SelectedImageSize!==t&&this.props.onImageStyleChange&&this.props.onImageStyleChange(t)},n.prototype.td=function(){var t=this,n=(0,b.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{"aria-expanded":this.props.Expanded,className:"image-edit-pane-inner-button office-form-theme-button-foreground",disabled:this.props.EditButtonDisabled,onClick:function(n){t.props.onImageEditClick&&t.props.onImageEditClick(),n.nativeEvent.stopImmediatePropagation()}},FluentIcon:"Edit",IconClassName:"forms-icon-size14x14",Text:(0,f.pm)().Common_Edit_Text,ref:this.Hh});return this.qh=!0,r.createElement("div",{className:"image-edit-pane-edit",key:"edit-button"},n)},n.prototype.Kh=function(){var t=this,n="image-edit-pane-inner-button office-form-theme-button-foreground";this.props.SelectedImageSize===C.h2.Small&&(n=(0,u.j)(n,"active"));var e={ButtonStyle:1,children:(0,p.M)({FluentIcon:"Resize Small",HTMLAttributes:{className:"image-edit-pane-inner-button-icon forms-icon-size14x14"}}),HTMLAttributes:{"aria-label":(0,f.pm)().ImageEditPane_SmallSize_Button||void 0,className:n,onClick:function(){return t.sd(C.h2.Small)}},Tooltip:(0,f.pm)().ImageEditPane_SmallSize_Button||void 0,ref:this.Lh},o=r.createElement(I.zx,(0,i.pi)({},e)),s="image-edit-pane-inner-button office-form-theme-button-foreground";this.props.SelectedImageSize===C.h2.Large&&(s=(0,u.j)(s,"active"));var a={ButtonStyle:1,children:(0,p.M)({FluentIcon:"Resize Large",HTMLAttributes:{className:"image-edit-pane-inner-button-icon forms-icon-size14x14"}}),HTMLAttributes:{"aria-label":(0,f.pm)().ImageEditPane_LargeSize_Button||void 0,className:s,onClick:function(){return t.sd(C.h2.Large)}},Tooltip:(0,f.pm)().ImageEditPane_LargeSize_Button||void 0},c=r.createElement(I.zx,(0,i.pi)({},a));return r.createElement("div",{className:"image-edit-pane-element-container office-form-theme-border",key:"size-button"},o,c)},n.prototype.Xh=function(){var t=this,n="image-edit-pane-inner-button";this.ed()||(n=(0,u.j)(n,"office-form-theme-button-foreground"));var e=(0,b.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:n,disabled:this.ed(),onClick:function(){t.props.onImageZoomClick&&t.props.onImageZoomClick(!0,(function(){t.ed()&&t.Bh.current&&t.Bh.current.focus()}))}},FluentIcon:"Zoom In",IconClassName:"forms-icon-size15x15",ref:this._h,Text:(0,f.pm)().ImageEditPane_ZoomIn_Button}),i="image-edit-pane-inner-button";this.od()||(i=(0,u.j)(n,"office-form-theme-button-foreground"));var o=(0,b.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:i,disabled:this.od(),onClick:function(){t.props.onImageZoomClick&&t.props.onImageZoomClick(!1,(function(){t.od()&&t._h.current&&t._h.current.focus()}))}},FluentIcon:"Zoom Out",IconClassName:"forms-icon-size15x15",ref:this.Bh,Text:(0,f.pm)().ImageEditPane_ZoomOut_Button});return r.createElement("div",{className:"image-edit-pane-element-container office-form-theme-border",key:"zoom-button"},e,o)},n.prototype.Yh=function(){var t=this,n=(0,f.pm)(),e=(0,b.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"image-edit-pane-inner-button office-form-theme-button-foreground",onClick:function(n){(0,g.$U)("DesignPage.ImageEditPane.AltText",{Id:t.props.imageId}),t.setState({ShowAltTextButton:!1}),n.nativeEvent.stopImmediatePropagation()}},FluentIcon:"Text Field",IconClassName:"edit-pane-fieldText",ref:this.Rh,Text:n.Common_Fullstop.format(n.ImageEditPane_AltText_Button,n.Click_Enter_Edit)}),i=(0,T.ZA)({AutoSelection:!0,MaxLength:(0,l.jz)(),MinimalHeight:28,onValueChange:this.props.onValueChange.bind(this.props),Placeholder:(0,f.pm)().ImageEditPane_AltText_PlaceHolder,ref:this.Oh,TextFieldType:0,Value:this.props.Value});return this.state.ShowAltTextButton?r.createElement("div",{className:"image-edit-pane-alttext-button office-form-theme-border",key:"alttext-button"},e):(this.Qh=!0,r.createElement("div",{className:"image-edit-pane-alttext office-form-theme-border",key:"alttext"},i))},n.prototype.nd=function(){var t=this,n=(0,b.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"image-edit-pane-inner-button office-form-theme-button-foreground",onClick:function(){t.props.onImageDeleteClick&&t.props.onImageDeleteClick()}},FluentIcon:"Delete",IconClassName:"forms-icon-size14x14",Text:(0,f.pm)().Common_Delete_Text});return r.createElement("div",{className:"image-edit-pane-delete",key:"delete-button"},n)},n.prototype.jh=function(t){var n=this.Oh.current;n&&(o.findDOMNode(n).contains(t.target)||this.setState({ShowAltTextButton:!0}))},n}(N.r),x=function(t){function n(n){var e=t.call(this,n)||this;return e.vo=!0,e.ud=!1,e.ld=r.createRef(),e.fd=r.createRef(),e.hd=r.createRef(),e.vd=r.createRef(),e.bd=Promise.resolve(),e.$h=function(t){return e.jh(t)},e.yd=function(){return e.wd()},e.Sd=function(){return e.forceUpdate()},e.Nd=function(){return e.Le()},e.state={EditPaneEditButtonDisabled:!0,EditPaneExpanded:!1,ShowImageEditPane:!1,ZoomButtonState:1},e.gf=e.gf.bind(e),e.Cd=e.Cd.bind(e),e.Td=e.Td.bind(e),e.kd=e.kd.bind(e),e.xd=e.xd.bind(e),e.Pd=e.Pd.bind(e),e.Dd=e.Dd.bind(e),e.Md=e.Md.bind(e),e.Ld=e.Ld.bind(e),e.Ad=e.Ad.bind(e),e}return(0,i.ZT)(n,t),n.prototype.componentWillMount=function(){var t=(0,h.BF)();this.props.ImageSettingsMaster.validateImageSettings(),this.props.ImageSettingsMaster.observe(this.Sd,[t.Schema.Layout,t.Schema.Left,t.Schema.Top]),this.props.ImageSettingsMaster.observe(this.Md,[t.Schema.ContainerHeight,t.Schema.ContainerWidth]),this.props.ImageMaster.observe(this.Sd,[(0,h.Cu)().Schema.ResourceUrl]),document.addEventListener("click",this.$h),document.addEventListener("wheel",this.yd)},n.prototype.componentDidMount=function(){this._d()},n.prototype.componentDidUpdate=function(){this.ud?(this.ud=!1,this._d()):this.Bd()},n.prototype.componentWillUnmount=function(){this.vo=!1,this.props.ImageSettingsMaster.unobserve(this.Sd),this.props.ImageSettingsMaster.unobserve(this.Md),this.props.ImageMaster.unobserve(this.Sd),document.removeEventListener("click",this.$h),document.removeEventListener("wheel",this.yd);var t=this.props.ImageMaster.Model;t&&t.ErrorType!==d.dL.NoError&&(t.ErrorType=d.dL.NoError);var n=this.ld.current;if(n){if(!this._u()){var e=this.props.ImageSettingsMaster.Model,i=$(n).cropper("getCanvasData");i.naturalHeight===e.NaturalHeight&&i.naturalWidth===e.NaturalWidth&&this.Ld(i,e)}$(n).cropper("destroy")}},n.prototype.render=function(){var t=s.extend({},this.props.HTMLAttributes);return t.className=(0,u.j)(t.className,"design-page-image-container"),t["aria-label"]=(0,f.pm)().DesignPage_Image_ImageDesigner,r.createElement("div",(0,i.pi)({},t),this.Hd(),this.qd(),this.Vd(),this.xu(),!1)},n.prototype.Bd=function(){var t=this.props.ImageMaster.Model,n=this.props.ImageSettingsMaster.Model;if(!this._u()&&t.ResourceUrl&&(null===t.ErrorType||t.ErrorType===d.dL.NoError)){var e=this.ld.current;if(e)try{$(e).cropper("setCanvasData",{height:n.ActualHeight||n.ContainerHeight,left:n.Left||0,naturalHeight:n.NaturalHeight,naturalWidth:n.NaturalWidth,top:n.Top||0,width:n.ActualWidth||n.ContainerWidth}),this.state.EditPaneExpanded?$(e).cropper("enable"):$(e).cropper("disable")}catch(t){var i=t.message||void 0,r=t.stack||void 0;(0,g.$U)("Image.CanvasRender.Failure",{error:"".concat(i," ").concat(r),imageSrc:e.src,imageType:this.props.IsFormLogo?"Logo":"Question",location:"0"})}}},n.prototype._d=function(){var t=this,n=this.props.ImageMaster.Model,e=this.props.ImageSettingsMaster.Model,i=new c.wU;if(!this._u()&&n.ResourceUrl&&(null===n.ErrorType||n.ErrorType===d.dL.NoError)){var r=this.ld.current;r&&(this.bd.finally((function(){try{$(r).cropper("destroy"),$(r).cropper({autoCropArea:1,background:!1,built:function(){var n,e=document.getElementsByClassName("cropper-invisible");$(e).css("opacity",0),(0,g.$U)("Image.CanvasRender.Success",{imageType:t.props.IsFormLogo?"Logo":"Question",location:"0"}),t.Bd(),i.resolve(),null===(n=$(".cropper-bg"))||void 0===n||n.hide()},center:!1,checkCrossOrigin:!1,cropBoxMovable:!1,cropBoxResizable:!1,dragMode:"move",guides:!1,highlight:!1,minCanvasHeight:e.ContainerHeight,minCanvasWidth:e.ContainerWidth,minContainerHeight:0,minContainerWidth:0,modal:!1,responsive:!0,restore:!1,toggleDragModeOnDblclick:!1,viewMode:3})}catch(e){var n=e.message||void 0,o=e.stack||void 0;(0,g.$U)("Image.CanvasRender.Failure",{error:"".concat(n," ").concat(o),imageSrc:r.src,imageType:t.props.IsFormLogo?"Logo":"Question",location:"0"}),i.reject()}})),this.bd=i.promise())}},n.prototype.xu=function(){if(this._u())return n.createSpinnerInternal()},n.createSpinnerInternal=function(t){var n=r.createElement(y.P,(0,i.pi)({},{ClassName:"designPage-quesion-imageUpload-spinner",Ignorable:!1}));return r.createElement("div",{className:"image-spinner",ref:t},n)},n.prototype.Hd=function(){var t,e,o,s,a,c,f,h=this.props.ImageMaster&&this.props.ImageMaster.Model;if(null!==h.ErrorType&&h.ErrorType!==d.dL.NoError)return null;if(!h.ResourceUrl&&!this._u())return null;var m=n.createSpinnerInternal(this.vd);if(h.ResourceUrl){e="design-question-title-image-button",h.ImageProcessingStatus===d.nv.Deleting?e=(0,u.j)(e,"office-form-theme-border","design-question-title-image-gray"):f=this.fd;var g=this.props.ImageSettingsMaster&&this.props.ImageSettingsMaster.Model;g?g.ContainerWidth&&g.ContainerHeight&&(a=g.ContainerHeight+"px",c=g.ContainerWidth+"px",!this.props.IsFormLogo&&g.ContainerWidth>(0,l.Fy)()&&(c=(0,l.Fy)()+"px",a=g.ContainerHeight/g.ContainerWidth*(0,l.Fy)()+"px"),t=h.ResourceUrl):t=h.ResourceUrl}t||(e="design-question-title-image-button-placeholder office-form-theme-border",s=(0,l.w_)()+"px",o=(0,l.Rr)()+"px");var p=(0,v.pd)((function(){return{}}),v.t1);return r.createElement("div",{ref:f},r.createElement("div",(0,i.pi)({className:e,onKeyDown:this.gf,style:{height:s,width:o}},p),r.createElement("img",{alt:h.AltText,className:"design-question-title-image-hidden",height:a,onError:this.Td,onLoad:this.Cd,ref:this.ld,src:t,title:h.AltText,width:c})),m)},n.prototype.gf=function(t){var n=this.ld.current;switch(t.keyCode){case 46:this.Le();break;case 37:$(n).cropper("move",-10,0);break;case 38:$(n).cropper("move",0,-10);break;case 39:$(n).cropper("move",10,0);break;case 40:$(n).cropper("move",0,10)}},n.prototype.Cd=function(){(0,g.w6)("Image.ImageOnLoad.Success",{imageType:this.props.IsFormLogo?"Logo":"Question",location:"0"}),(0,a.OE)(2,{$imageType:this.props.IsFormLogo?"Logo":"Section",$location:"DesignCard"});var t=this.vd.current;t&&$(t).css("display","none"),this.ud=!0,this.setState({EditPaneEditButtonDisabled:!1,ShowImageEditPane:!0})},n.prototype.Td=function(t){var n=this.ld.current;if(n){$(n).css("visibility","visible"),(0,g.w6)("Image.ImageOnLoad.Failure",{imageType:this.props.IsFormLogo?"Logo":"Question",location:"0"}),(0,a.OE)(1,{$imageType:this.props.IsFormLogo?"Logo":"Section",$location:"DesignCard"});var e=this.vd.current;e&&$(e).css("display","none"),this.setState({EditPaneEditButtonDisabled:!0,ShowImageEditPane:!0})}},n.prototype.Vd=function(){var t=this,n=this.props.ImageSettingsMaster.Model,e=this.props.ImageMaster,o=e.Model;if(this._u()||o.ErrorType===d.dL.NoError)return null;var s,a=e.getImageErrorMessage(),u=r.createElement(w.L,{HTMLAttributes:{className:"error-message","aria-label":a},LazyRendering:!0,Role:"Alert"},a);if(o.ErrorType===d.dL.DeleteFailError){var c={ButtonStyle:1,HTMLAttributes:{className:"office-form-theme-primary-foreground",onClick:function(){return e.clear()}},Text:(0,f.pm)().Common_Try_again_Text};s=r.createElement(S.A,(0,i.pi)({},c))}else s=(0,b.F)({ButtonStyle:1,GlyphButtonStyle:"Horizontal",HTMLAttributes:{className:"office-form-theme-primary-foreground",onClick:function(){(0,g.$U)(t.props.IsFormLogo?"DesignPage.Form.Logo.AddImage":"DesignPage.Questions.AddImage"),(0,m.L)().then((function(t){return e.addImage(t)}))}},FluentIcon:"Image",IconClassName:"errorPictureIcon forms-icon-size12x12",Text:(0,f.pm)().Common_Try_again_Text});var l=(0,p.M)({HTMLAttributes:{className:"image-error-frowny-icon"},IconName:"Sad"});return r.createElement("div",{className:"design-image-error office-form-theme-border",style:{height:n.ContainerHeight,width:n.ContainerWidth}},l,u,r.createElement("div",null,s))},n.prototype.qd=function(){var t=this.props.ImageMaster.Model,n=this.props.ImageSettingsMaster&&this.props.ImageSettingsMaster.Model;return t.ResourceUrl&&!this._u()&&t.ErrorType===d.dL.NoError&&this.state.ShowImageEditPane?r.createElement(k,{EditButtonDisabled:this.state.EditPaneEditButtonDisabled,Expanded:this.state.EditPaneExpanded,imageId:t.ResourceId,onImageEditClick:this.xd,onImageStyleChange:this.props.IsFormLogo?void 0:this.Pd,onImageZoomClick:this.Dd,onImageDeleteClick:this.Nd,onKeyUpOnEditPane:this.Ad,onValueChange:this.kd,ref:this.hd,SelectedImageSize:n&&n.Size,SizeButtontDisabled:this.props.IsFormLogo,Value:t.AltText,ZoomButtonDisabled:!1,ZoomButtonState:this.state.ZoomButtonState}):t.ResourceUrl&&this._u()?r.createElement(k,{EditButtonDisabled:!0,imageId:t.ResourceId,onImageDeleteClick:this.Nd,onValueChange:this.kd,ref:"edit-pane-container",Value:t.AltText}):void 0},n.prototype.Ad=function(t){if(27===t.keyCode)this.state.EditPaneExpanded&&(this.setState({EditPaneExpanded:!1}),t.stopPropagation(),t.preventDefault())},n.prototype.kd=function(t){this.props.ImageMaster.Model.AltText=t},n.prototype.Pd=function(t){var n=this.props.ImageMaster.Model,e=this.props.ImageSettingsMaster,i=e.Model;(0,g.$U)("DesignPage.ImageEditPane.Style",{imageId:n.ResourceId,style:t}),e.onImageStyleChange(t),i.Size!==t&&this.setState({ZoomButtonState:1})},n.prototype.xd=function(){(0,g.$U)("DesignPage.ImageEditPane.Edit"),this.setState({EditPaneExpanded:!0});var t=this.ld.current;$(t).cropper("enable"),this.wd()},n.prototype.Dd=function(t,n){var e=this.ld.current;if(t)switch(this.state.ZoomButtonState){case 3:case 1:$(e).cropper("zoom",.1),(0,g.$U)("DesignPage.ImageEditPane.ZoomIn")}else switch(this.state.ZoomButtonState){case 3:case 0:$(e).cropper("zoom",-.1),(0,g.$U)("DesignPage.ImageEditPane.ZoomOut")}this.wd(n)},n.prototype.Ld=function(t,n){this.props.ImageSettingsMaster.bulkEdit((function(n){n.Left=Math.round(t.left),n.Top=Math.round(t.top),n.ActualWidth=Math.round(t.width),n.ActualHeight=Math.round(t.height)}))},n.prototype.wd=function(t){if(!this._u()){var n=this.ld.current,e=$(n).cropper("getCanvasData"),i=this.props.ImageSettingsMaster.Model,r=void 0;e.width&&e.height&&(this.Ld(e,i),r=e.width>2*i.ContainerWidth&&e.height>2*i.ContainerHeight?0:e.width-i.ContainerWidth<1||e.height-i.ContainerHeight<1?1:3,this.state.ZoomButtonState!==r&&this.setState({ZoomButtonState:r},t))}},n.prototype.Le=function(){var t=this,n=this.props.ImageMaster,e=this.props.ImageSettingsMaster;(0,g.$U)("DesignPage.ImageEditPane.Delete",{imageKind:this.props.IsFormLogo?"Logo":"Question"}),n.clear().then((function(){var n=t.ld.current;$(n).cropper("destroy"),e.clear(),t.vo&&t.setState({EditPaneExpanded:!1})}))},n.prototype.jh=function(t){if(this.state.EditPaneExpanded){var n=this.fd.current,e=this.hd.current;if(n&&e){var i=o.findDOMNode(n),r=o.findDOMNode(e);if(!i.contains(t.target)&&!r.contains(t.target)){var s=this.ld.current;$(s).cropper("disable"),this.setState({EditPaneExpanded:!1})}}}},n.prototype._u=function(){return this.props.ImageMaster.Model.ImageProcessingStatus!==d.nv.Idle},n.prototype.Md=function(){this.ud=!0},n}(N.r);function F(t){var n=t.ImageMaster.Model;return n.ImageProcessingStatus===d.nv.Picking||n.ErrorType!==d.dL.NoError||(0,d.UO)(n)?r.createElement(x,(0,i.pi)({},t)):void 0}},72855:function(t,n,e){"use strict";e.d(n,{p:function(){return w}});var i=e(59312),r=e(87363),o=e(61533),s=e(12611),a=e(17290),u=e(7645),c=e(72467),l=e(67661),f=e(64290),h=e(31442),d=e(50434),m=e(96689),v=e(42605),g=e(17764),p=e(61111),b=e(13878),y=e(71209),w=function(t){function n(n){var e=t.call(this,n)||this;e.zd=0;var i=e.props.Master.Model.FileTypes;return Object.keys(i).forEach((function(t){i[t]&&e.zd++})),e.Qd=e.Qd.bind(e),e.Ud=e.Ud.bind(e),e.$d=e.$d.bind(e),e.jd=e.jd.bind(e),e}return(0,i.ZT)(n,t),n.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),0===this.zd&&(0,d.a1)(this.props.Master)},n.prototype.componentWillUnmount=function(){t.prototype.componentWillUnmount.call(this)},n.prototype.createReactNodes=function(){var t=this,n=(0,v.F)({ButtonStyle:1,GlyphButtonStyle:"Horizontal",HTMLAttributes:{className:"design-question-upload-button",disabled:!0},FluentIcon:"Arrow Upload",IconClassName:"forms-icon-size18x18",Text:(0,u.pm)().UploadFile_Button,TextClassName:"design-question-upload-text"});return[r.createElement("div",{className:"design-question-upload-container",key:"container"},n,r.createElement("div",{className:"design-question-upload-dropdown-container"},this.Wd(),(0,f.pd)((function(){return t.Kd()}),(function(){return t.Jd()}))),this.Zd())]},n.prototype.createMainContent=function(){var n,e=this.props.Master.Form;e.isFieldReady(l.x.Schema.Id)&&(n=(0,d.Iy)(e.Model.Id));var i=(0,u.pm)().UploadFile_Warning_Inform_GroupForm_Text,o=(0,u.pm)().UploadFile_Warning_Inform_Form_Text,s=e.IsGroupForm?i:o;if(n){var a=(0,c.AJ)();return r.createElement(a,{description:s,clickNoButton:this.onClickDeleteButton,clickContinueButton:this.Qd,key:"dialog"})}return t.prototype.createMainContent.call(this)},n.prototype.getErrorMessage=function(){var t=this.props,n=t.Master.Form;if(n.isFieldReady(l.x.Schema.Id)&&!(0,d.Iy)(n.Model.Id))return t.Master.getErrorMessage()},n.prototype.createMoreMenuItems=function(){return t.prototype.createMoreMenuItems.call(this).concat(this.createValidationItem())},n.prototype.createValidationItem=function(){return{Checked:this.props.Master.Model.HasSpecificFileType,Description:(0,u.pm)().Designer_QuestionMenu_FileType,Key:"validationItem",MenuItemType:1,onExecute:this.jd}},n.prototype.updateComponentNodesStatus=function(){this.QuestionElementRef.current&&t.prototype.updateComponentNodesStatus.call(this)},n.prototype.jd=function(){var t=this,n=this.props.Master.Model;(0,h.$U)("DesignPage.QuestionMenu.Validation",{questionType:n.Type,value:n.HasSpecificFileType}),n.HasSpecificFileType=!n.HasSpecificFileType;var e=n.FileTypes,i=Object.keys(e);i.filter((function(t){return e[t]})).length===i.length&&i.forEach((function(t){e[t]=!1})),n.HasSpecificFileType&&this.onUpdateDone((function(){var n=o.findDOMNode(t.getElementRef(1).current);(0,a.x)($(n).find("input"))}))},n.prototype.Zd=function(){if(this.props.Master.Model.HasSpecificFileType)return r.createElement("div",{className:"design-question-restrictions-container",key:"restrictionsContainer"},r.createElement("div",{className:"design-question-restrictions-label"},(0,u.pm)().UploadFile_File_Type),this.Xd("Word",1),this.Xd("Excel"),this.Xd("PowerPoint"),this.Xd("PDF"),this.Xd("Image"),this.Xd("Video"),this.Xd("Audio"))},n.prototype.Xd=function(t,n){var e=this,i=(1===n?(0,u.pm)().UploadFile_File_Type:"")+(0,d.UL)((0,u.pm)(),t);return(0,m.e)({Description:(0,d.UL)((0,u.pm)(),t),HTMLAttributes:{"aria-label":i,className:"inline-display design-question-upload-checkbox"},onValueChange:function(n){e.props.Master.Model.FileTypes[t]=n,n?e.zd++:e.zd--,e.Yd("DesignPage.QuestionMenu.FileTypeChange")},Options:{classNameForInnerDiv:"inline-display"},SpanClassName:"design-question-file-type",Value:this.props.Master.Model.FileTypes[t],ref:1===n&&this.getElementRef(n)})},n.prototype.Wd=function(){var t=this.props.Master.Model,n=(0,g._)({HTMLAttributes:{className:"question-setting-label"},Label:(0,u.pm)().UploadFile_Max_File_Number.format("")}),e=s.range(1,11).map((function(t){return{DisplayName:t.toString(),Key:t,Value:t}})),i=(0,p.E)({Label:(0,u.pm)().UploadFile_Max_File_Number.format(""),onValueChange:this.Ud,SelectOptions:e,Value:t.MaxFileCount});return r.createElement("div",{className:"design-question-upload-dropdown"},n,r.createElement("div",{className:"question-setting-dropdown",style:{width:"110px"}},i))},n.prototype.Kd=function(){var t=this.props.Master.Model,n=(0,g._)({HTMLAttributes:{className:"question-setting-label"},Label:(0,u.pm)().UploadFile_Single_File_Size.format("")}),e=Object.keys(d.EE).map((function(t){return{DisplayName:t,Key:t,Value:d.EE[t]}})),i=(0,p.E)({Label:(0,u.pm)().UploadFile_Single_File_Size.format(""),onValueChange:this.$d,SelectOptions:e,Value:t.MaxFileSize});return r.createElement("div",{className:"design-question-upload-dropdown"},n,r.createElement("div",{className:"question-setting-dropdown",style:{width:"110px"}},i))},n.prototype.Jd=function(){},n.prototype.Ud=function(t){this.props.Master.Model.MaxFileCount=t,this.Yd("DesignPage.QuestionMenu.FileNumberChange")},n.prototype.$d=function(t){this.props.Master.Model.MaxFileSize=t,this.Yd("DesignPage.QuestionMenu.FileSizeChange")},n.prototype.Qd=function(){(0,d.q2)(this.props.Master.Form,!1),this.setState({SelectedElementIndex:b.K4},this.tm)},n.prototype.tm=function(){var t=o.findDOMNode(this.getElementRef(b.K4).current);t&&(0,a.x)($(t).find("textarea"))},n.prototype.Yd=function(t){var n=this.props.Master.Model,e=JSON.parse(n.QuestionInfo),i={FileTypes:e.FileTypes,MaxFileCount:e.MaxFileCount,MaxFileSize:e.MaxFileSize};(0,h.$U)(t,{questionType:n.Type,value:JSON.stringify(i)})},n.keyPrefixFileUploadDialogMap="officeforms.fileuploaddialogmap",n}(y.v)},13878:function(t,n,e){"use strict";e.d(n,{oF:function(){return X},Et:function(){return K},Wr:function(){return J},K4:function(){return W}});var i=e(59312),r=e(87363),o=e(61533),s=e(12611),a=e(78587),u=e(29559),c=e(9947),l=e(262),f=e(38174),h=e(29952),d=e(38537),m=e(26203),v=e(687),g=e(17290),p=e(7645),b=e(54496),y=e(72467),w=e(46008),S=e(70877),N=e(18260),C=e(24497),I=e(51150),T=e(53315),k=e(83735),x=e(90819),F=e(91091),P=e(13663),D=e(96539),M=e(64290),L=e(85451),R=e(31442),A=e(47601),E=e(3424),O=e(42605),_=e(48280),B=e(20572),H=e(9097),G=e(62335),q=e(54164),V=e(23112),z=e(49221);var Q=e(47432),U=e(65434),j=e(40554);var W=-1,K=-3,J=-4;function Z(){(0,k.b4)().Model.AddBranchingTeachingCalloutVersion=k.BT.toString()}var X=function(t){function n(n){var e=t.call(this,n)||this;e.nm=r.createRef(),e.im=[],e.rm={},e.om=r.createRef(),e.As=function(){return e.sm()},e.am=e.am.bind(e),e.um=e.um.bind(e),e.lm=e.lm.bind(e),e.fm=e.fm.bind(e),e.hm=e.hm.bind(e),e.handleMoveUp=e.handleMoveUp.bind(e),e.handleMoveDown=e.handleMoveDown.bind(e),e.onClickDeleteButton=e.onClickDeleteButton.bind(e),e.onClickCancelButton=e.onClickCancelButton.bind(e),e.deleteQuestion=e.deleteQuestion.bind(e),e.dm=e.dm.bind(e),e.longAnswerValueChange=e.longAnswerValueChange.bind(e),e.singleMultipleValueChange=e.singleMultipleValueChange.bind(e),e.pauseResumeSurveyHandle=e.pauseResumeSurveyHandle.bind(e),e.createCVBranchingErrorNotification=e.createCVBranchingErrorNotification.bind(e);var i=e.props.Master.Model.Point,o={SelectedElementIndex:W,QuizPoint:null==i?void 0:i.toString()};return e.state=o,e.vm=s.debounce((function(){var t=e.props.Master.Model.QuestionTagForIntelligence;if(t&&"Unknown"!==t){var n={action:"Edit",actionTarget:"Question",contextType:"Form",id:e.props.Master.Form.Model.Id,loggingContent:{type:"Title"},suggestionContent:{suggestions:[t]}};(0,d.H)([n])}}),1e3),e}return(0,i.ZT)(n,t),n.prototype.componentWillMount=function(){var t=(0,k.b4)();!this.props.HideBranching&&t.observe(this.As,[k.TS.Schema.AddBranchingTeachingCalloutVersion]);var n=s.without(m.d.getSubFieldSchemas((0,y.zE)().Schema),(0,y.zE)().Schema.Order);this.props.Master.observe(this.As,n)},n.prototype.componentDidMount=function(){this.updateComponentNodesStatus(),this.state.SelectedElementIndex===W&&this.setFocusToTitleElement()},n.prototype.componentDidUpdate=function(){this.updateComponentNodesStatus()},n.prototype.componentWillUnmount=function(){(0,k.b4)().unobserve(this.As),this.props.Master.Model.Title=this.props.Master.Model.Title.replace(/\s*$/,""),"ImagePicker"===(0,y.f5)().Model.FlexPane&&((0,y.f5)().Model.FlexPane="None"),this.props.Master.unobserve(this.As)},n.prototype.render=function(){return r.createElement("div",{className:"office-form-question-designer-container office-form-theme-focus-border office-form-theme-border-top"},this.createMainContent())},Object.defineProperty(n.prototype,"QuestionElementRef",{get:function(){return this.nm},enumerable:!1,configurable:!0}),n.prototype.onClickDeleteButton=function(){var t=this.props.Master,n=t.Model,e=t.Form.FormElementManager.TopElementMasters,i=e.indexOf(t),r=e[i+1];!function(t){t.Form.FormElementManager.deleteFormQuestion(t)}(t),r?this.props.designElement(r):this.props.focusOnAddButton(),"Question.Choice"===n.Type||"Question.TextField"===n.Type?(0,R.$U)("DesignPage.Questions.Delete",{isMathQuiz:!!n.IsMathQuiz,questionType:n.Type}):(0,R.$U)("DesignPage.Questions.Delete",{questionType:n.Type})},n.prototype.updateComponentNodesStatus=function(){this.gm()},n.prototype.createReactNodes=function(){throw Error("to be overridden.")},n.prototype.createMainContent=function(){var t=s.extend({},this.props.HTMLAttributes);t.className=(0,l.j)(t.className,"__question-designer__","office-form-question-designer"),t.onTouchStart=t.onTouchStart||function(){},t["aria-label"]=(0,p.pm)().Form_EditQuestionWithOrdinal.format(this.props.Ordinal),t.ref=this.nm;this.props.Master.Model;return r.createElement(r.Fragment,null,this.bm(),this.createCVBranchingErrorNotification(),r.createElement("div",(0,i.pi)({},t),this.ym(),this.createTopMenu(),this.wm(),this.Sm(),this.createPhishingWarningBar(),this.createSuggestionBar(),this.createReactNodes(),!1,r.createElement("hr",{"aria-hidden":!0,className:"design-question-hr"}),this.createBottomBar(),!1,this.createActionBar(),this.createDeleteConfirmDialog(),this.createMetricConfirmationDialog()))},n.prototype.createPhishingWarningBar=function(){return null},n.prototype.createSuggestionBar=function(){return null},n.prototype.createMathBar=function(){return null},n.prototype.getErrorMessage=function(){return null},n.prototype.getElementFocusingProps=function(t){var n=this;return{onBlur:function(e){var i=n.getElementRef(t).current,r=(0,f.y3)(e);n.state.SelectedElementIndex!==t||i&&r&&i.contains(r)||n.setState({SelectedElementIndex:-2})},onFocus:function(){n.setState({SelectedElementIndex:t})}}},n.prototype.getElementFocusingPropsScan=function(t){var n=this.getElementFocusingProps(t),e=n.onBlur;return n.onBlur=function(t){t.persist(),window.setTimeout((function(){return e(t)}),0)},n},n.prototype.getElementRef=function(t){var n;switch(t){case W:n="title";break;case-2:n="other";break;case J:n="subtitle";break;case-5:n="move-up";break;case-6:n="move-down";break;default:n="element"+t}return this.rm[n]||(this.rm[n]=r.createRef()),this.rm[n]},n.prototype.onTitleValueChange=function(){},n.prototype.createValidationItem=function(){return null},n.prototype.createMoreMenuItems=function(){return[{Checked:this.props.Master.Model.ShowSubtitle,Description:(0,p.pm)().Designer_MenuItemForSubtitle,Key:"subtitleItem",MenuItemType:1,onExecute:this.um}]},n.prototype.onUpdateDone=function(t){this.im.push(t)},n.prototype.setFocusToTitleElement=function(){this.setState({SelectedElementIndex:W});var t=o.findDOMNode(this.getElementRef(W).current);t&&(0,g.x)($(t).find("textarea"))},n.prototype.createAnswerTagMenuItem=function(){return!1},n.prototype.createAnswerTagDiv=function(t){return!1},n.prototype.createAddBranchMenuItem=function(){var t,n=this;return!this.props.HideBranching&&(0,M.hl)((function(){t={Checked:!1,Description:(0,p.pm)().Designer_MenuItemForAddBranch,Key:"addbranchItem",MenuItemType:1,onExecute:n.am}})),t},n.prototype.lm=function(t){this.props.Master.bulkEdit((function(n){(0,C.v1)(n,t,"Title","FormsProRTQuestionTitle")})),this.vm(),this.onTitleValueChange()},n.prototype.fm=function(t){this.props.Master.bulkEdit((function(n){(0,C.v1)(n,t,"Subtitle","FormsProRTSubtitle")}))},n.prototype.um=function(){var t=this,n=this.props.Master.Model;return(0,R.$U)("DesignPage.QuestionMenu.Subtitle",{questionId:n.Id,questionType:n.Type,value:!n.ShowSubtitle}),n.ShowSubtitle||this.onUpdateDone((function(){var n=o.findDOMNode(t.getElementRef(J).current);(0,g.x)($(n).find(":focusable"))})),n.ShowSubtitle=!n.ShowSubtitle,n.ShowSubtitle},n.prototype.am=function(){Z();var t=this.props.Master.Model,n=(0,y.f5)().Model.FormMaster.Model.HasValidBranching;if(t.Id&&((0,y.f5)().Model.BranchingElementId=t.Id,this.nm.current&&this.nm.current.parentElement)){var e=this.nm.current.parentElement.getBoundingClientRect().top;(0,y.f5)().Model.RelativeScrollHeight=e}(0,y.f5)().Model.TopView="Branch",(0,R.$U)("DesignPage.QuestionMenu.AddBranch",{questionId:t.Id,questionType:t.Type,value:n})},n.prototype.createCVBranchingErrorNotification=function(){return null},n.prototype.bm=function(){if(this.getErrorMessage()){var t=(0,E.M)({FluentIcon:"Error Circle",HTMLAttributes:{className:"forms-icon-size16x16 design-question-warning-icon"},key:"warningIcon"});return r.createElement(r.Fragment,null,r.createElement("div",{className:"design-question-error-message-container"},t,r.createElement("span",{className:"design-question-question-error-bar"},this.getErrorMessage())),r.createElement("div",{className:"design-question-question-mask"}))}},n.prototype.ym=function(){var t=this,n=this.props.Master.Model;if(n.CoAuthors&&n.CoAuthors.length>0)return n.CoAuthors[n.CoAuthors.length-1].userId===(0,c.k0)().userInfo.UserId?void 0:r.createElement("div",{className:"question-coAuthor-notification-container-design-mode"},s.map(n.CoAuthors,(function(n){return t.Nm(n)})))},n.prototype.Nm=function(t){if(t.userId!==(0,c.k0)().userInfo.UserId){var n=(0,p.pm)().DesignPage_NavBar_CoAuthor_Screen_Reader.format(t.displayName||t.userId,this.props.Ordinal);return r.createElement(G.k,{ariaLabel:n,displayText:(0,q.c)(t.displayName,t.firstName,t.lastName),email:t.email,key:t.userId,name:t.displayName,tooltip:t.displayName||t.userId})}},n.prototype.createActionBar=function(){var t,e,i,o,s=this,a=(0,p.pm)();(0,h.Oy)()?(t=a.ActionBar_Copy,e=a.ActionBar_Delete,i=a.ActionBar_Down,o=a.ActionBar_Up):(t=a.Designer_ActionBar_Duplicate,e=a.Designer_ActionBar_Delete,i=a.Designer_ActionBar_MoveDown,o=a.Designer_ActionBar_MoveUp);var u,c=this.props.Master,l=c.Model,f=!!this.getErrorMessage(),d=f||"Question.FileUpload"===l.Type&&!!(0,A.e)(c.Form);u=c.Form.reachedQuestionNumberLimitation()?n.createActionBarButton((0,p.pm)().DesignPage_LimitMessage_QuestionNumber,"Copy","forms-icon-size16x16",d,(function(){})):n.createActionBarButton(t,"Copy","forms-icon-size16x16",d,(function(){var t=c.Form.FormElementManager.duplicateElement(c);s.props.designElement(t);var n=c.Form.Model.LocalizedResources;if(n&&n.length>0){for(var e=t.Model.ChoiceGroup,i=[],r=0;r<e.length;r++)i[r]=e[r].Key;var o=[{newId:t.Model.Id,oldId:c.Model.Id}];if(t.SubQuestionMasters&&t.SubQuestionMasters.length>0)for(r=0;r<t.SubQuestionMasters.length;r++)o.push({newId:t.SubQuestionMasters[r].Model.Id,oldId:c.SubQuestionMasters[r].Model.Id});(0,F.fK)(n,o)}(0,R.$U)("DesignPage.Questions.Duplicate",{questionType:l.Type})}));var m=n.createActionBarButton(e,"Delete","forms-icon-size16x16",!1,this.deleteQuestion),v=n.createActionBarButton(o,"Arrow Up","forms-icon-size15x15",f||this.props.IsFirstElement,this.handleMoveUp,this.getElementRef(-5)),g=n.createActionBarButton(i,"Arrow Down","forms-icon-size15x15",f||this.props.IsLastElement,this.handleMoveDown,this.getElementRef(-6));return r.createElement("div",{className:"question-designer-action-bar",key:"ActionBar"},u,m,v,g)},n.prototype.handleMoveUp=function(){var t=this,n=this.props.Master,e=n.Model;this.props.IsFirstElement||((0,R.$U)("DesignPage.Questions.MoveUp",{questionType:e.Type}),this.props.DesignFocus.setLocked(!0),n.Form.FormElementManager.moveElementUp(n),setTimeout((function(){t.props.DesignFocus.setLocked(!1)})))},n.prototype.handleMoveDown=function(){var t=this,n=this.props.Master,e=n.Model;this.props.IsLastElement||((0,R.$U)("DesignPage.Questions.MoveDown",{questionType:e.Type}),this.props.DesignFocus.setLocked(!0),n.Form.FormElementManager.moveElementDown(n),setTimeout((function(){t.props.DesignFocus.setLocked(!1)})))},n.prototype.wm=function(){var t=this,n=(0,h.Oy)()?(0,p.pm)().FieldName:(0,p.pm)().Designer_QuestionTitle_Placeholder,e=this.props.Master.Model,i=!this.props.HideOrdinal&&r.createElement("div",{className:"design-question-ordinal",key:"Ordinal"},(0,p.pm)().Designer_QuestionOrdinal.format(this.props.Ordinal)),o=(0,B.ZN)({AllowRichText:!0,AutoFocus:!0,AutoSelection:!0,HTMLAttributes:{className:this.state.SelectedElementIndex===W?"design-question-title-with-image active":"design-question-title-with-image",onFocus:function(){t.setState({SelectedElementIndex:W})}},key:"Title",MaxLength:(0,v.zn)(),MinimalHeight:(0,v.gj)(),onValueChange:this.lm,Options:this.Tm(),Placeholder:n,ref:this.om,TextFieldType:2,TextFieldLocation:{Location:(0,U.bF)(e.Type),Suffix:1},Value:(0,C.wg)(e.Title,e.FormsProRTQuestionTitle)},this.props.Master.Form,!0);return r.createElement("div",{className:"design-question-title-bar",key:"TitleBar"},i,this.Fa(o))},n.prototype.Tm=function(){return{HTMLPropsForInnerElement:(0,b.p2)(this.getElementFocusingProps(W),{"aria-label":(0,p.pm)().Designer_QuestionTitle,className:"design-question-textbox mixer-focus-target"})}},n.prototype.Fa=function(t){var n=this,e=this.props.Master,i=e.Model,s=i.ImageInfo,a="design-question-title-image-picker office-form-theme-button";this.state.SelectedElementIndex===W&&(a=(0,l.j)(a,"active"));var u,c=!this.props.HideMediaPicker&&(0,O.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:(0,b.p2)(this.getElementFocusingProps(W),{className:a,onClick:function(){(0,R.$U)("DesignPage.Questions.AddImage",{questionId:i.Id,questionType:i.Type}),(0,P.b)().then((function(t){t.Image?e.ImageInfoMaster.addImage(t.Image):t.Video&&e.setVideoUrl(t.Video,!0)})).catch((function(t){t&&-2===n.state.SelectedElementIndex&&n.setState({SelectedElementIndex:W},(function(){var t=o.findDOMNode(n.getElementRef(W).current);t&&(0,g.x)($(t).find(".design-question-title-image-picker"))}))}))},onFocus:function(){$(".roorterjs-ribbon").removeClass("roorterjs-ribbon-visible")}}),FluentIcon:"Image",IconClassName:"forms-icon-size20x20",key:"ImagePicker",Text:(0,p.pm)().ImagePicker_Insert_Mdeia_button||void 0});u=s&&(s.ImageProcessingStatus===x.nv.Picking||s.ErrorType||(0,x.UO)(s))?this.km():e.hasValidVideoUrl()?this.xm():[t,c];var f=this.getElementRef(W);return r.createElement("div",{className:"design-question-image-title-container",key:"TitleContainer",ref:f},u)},n.prototype.km=function(){var t=(0,Q.P)({ImageMaster:this.props.Master.ImageInfoMaster,ImageSettingsMaster:this.props.Master.ImageSettingsMaster,IsFormLogo:!1,key:"ImageAndEditPane"});return[this.Fm(),t]},n.prototype.xm=function(){var t=this.Pm();return[this.Fm(),t]},n.prototype.Fm=function(){var t,n=this,e=this.props.Master.Model,i=e.ImageInfo,r=e.VideoInfo,o="design-question-image-title",s=2,a=(0,v.gj)();return i.ErrorType===x.dL.NoError&&i.ResourceUrl&&e.ImageSettings.ContainerWidth?e.ImageSettings.ContainerWidth<(0,v.Fy)()?(t="calc(100% - ".concat(e.ImageSettings.ContainerWidth,"px)"),s=1,a=e.ImageSettings.ContainerHeight):o="design-question-image-title-big-horizontal":r&&r.Url?o="design-question-image-title-big-horizontal":(t="calc(100% - ".concat((0,v.Rr)(),"px)"),a=(0,v.w_)(),s=1),(0,B.ZN)({AllowRichText:!0,AutoFocus:!0,AutoSelection:!0,HTMLAttributes:{className:o,style:{width:t}},key:"ImageTitle",MaxLength:(0,v.zn)(),MinimalHeight:a,onValueChange:function(t){return n.lm(t)},Options:this.Tm(),TextFieldType:s,TextFieldLocation:{Location:(0,U.bF)(e.Type),Suffix:1},Value:(0,C.wg)(e.Title,e.FormsProRTQuestionTitle)},this.props.Master.Form,!0)},n.prototype.Sm=function(){var t=this.props.Master.Model;if(t.ShowSubtitle){if(t.IsMathQuiz)return this.createMathBar();var n=(0,B.ZN)({AllowRichText:!0,AutoSelection:!0,HTMLAttributes:{className:"design-question-subtitle"},MaxLength:(0,v.ED)(),MinimalHeight:(0,v.gj)(),onValueChange:this.fm,Options:{HTMLPropsForInnerElement:{"aria-label":(0,p.pm)().Designer_QuestionSubtitle,className:"design-question-textbox mixer-focus-target"}},Placeholder:(0,p.pm)().Designer_PlaceholderForQuestionSubtitle,ref:this.getElementRef(J),TextFieldType:2,TextFieldLocation:{Location:(0,U.bF)(t.Type),Suffix:2},Value:(0,C.wg)(t.Subtitle,t.FormsProRTSubtitle)},this.props.Master.Form,!0);return r.createElement("div",{className:"design-question-element",key:"Subtitle"},n)}},n.prototype.createBottomBar=function(){var t=this,n=this.props.Master.Form.Model.Questions,e=null;return(0,M.hl)((function(){n.length>1&&t.props.Master.Model.Id===n[1].Id&&(e=!t.props.HideBranching&&function(t,n){if(!(0,k.OT)((0,k.b4)().Model.AddBranchingTeachingCalloutVersion))return null;var e=(0,p.pm)().FirstRun_Callout_AddBranch_Text,i=(0,D.yM)((function(){Z()})),r=(0,D.Bi)((0,a.Jn)("/Images/branching.gif"),null,D.Mb);return(0,D.dq)(r,i,t,n,e)}("teachingCallout-addbranch","teachingCallout-addbranch-direction"))})),r.createElement("div",{className:"design-question-bottombar-container clearfix",key:"BottomBar"},this.Dm(this.props.Master),r.createElement("div",{className:"design-question-bottombar"},!1,!1,this.createSingleMultipleToggleButton(),this.createRequiredToggleButton(),!1,this.createMoreMenu(),e))},n.prototype.Dm=function(t){var n=this,e=t.Model;if(e.IsQuiz){var i=(0,B.ZN)({HTMLAttributes:{className:"design-quiz-point-box"},onValueChange:function(t){if(""===t)e.Point=null,n.setState({QuizPoint:t});else{var i=(0,L.validateQuizPoint)(t);null!=i&&(e.Point=i.point,n.setState({QuizPoint:i.pointString}))}(0,R.$U)("DesignPage.Quiz.Point",{QuestionId:e.Id,Value:e.Type})},Options:{HTMLPropsForInnerElement:{"aria-label":(0,p.pm)().Common_Points_Text,className:"design-quiz-point-box-input"}},Value:n.state.QuizPoint});return r.createElement("div",{className:"design-quiz-point-bar"},r.createElement("div",{className:"design-quiz-point-label"},(0,p.pm)().Common_Points_Text+":"),i)}},n.prototype.pauseResumeSurveyHandle=function(){},n.prototype.longAnswerValueChange=function(t){var n=this.props.Master.Model;(0,R.$U)("DesignPage.Questions.LongAnswer",{questionId:n.Id,questionType:n.Type,value:t}),n.Multiline=t,this.pauseResumeSurveyHandle()},n.prototype.singleMultipleValueChange=function(t){var n=this.props.Master.Model;(0,R.$U)("DesignPage.Questions.MultipleAnswers",{isQuiz:n.IsQuiz,questionType:n.Type});var e=n;e.ChoiceType=t?T.T6.MultiChoice:T.T6.SingleChoice,e.IsQuiz&&e.ChoiceType===T.T6.SingleChoice&&s.rest(s.filter(e.Choices,(function(t,n){return t.IsAnswerKey}))).map((function(t,n){return t.IsAnswerKey=!1}));var i=e.DefaultValue&&JSON.parse(e.DefaultValue);if(i){var r=Object.getOwnPropertyNames(i);if(e.ChoiceType!==T.T6.MultiChoice&&r.length>1){for(var o=1;o<r.length;o++)delete i[r[o]];e.DefaultValue=JSON.stringify(i)}}this.pauseResumeSurveyHandle()},n.prototype.createSingleMultipleToggleButton=function(){var t=this,n=this.props.Master.Model;switch(n.Type){case"Question.Choice":case"Question.TextField":case"Question.MatrixChoice":var e=n.OptionDisplayStyle===T.h3.Dropdown;return(0,H.i)({Disabled:e,HTMLAttributes:{className:"design-question-bottombar-element",title:e?(0,p.pm)().QuestionBar_DesignTime_MultipleChoice_Tooltip:""},Label:"Question.TextField"===n.Type?(0,p.pm)().Designer_AllowMultipleLines:(0,p.pm)().Designer_AllowMultipleChoices,onValueChange:function(e){"Question.TextField"===n.Type?t.longAnswerValueChange(e):t.singleMultipleValueChange(e)},Options:{classNameForInnerLabel:"design-question-toggle-label"},Value:"Question.TextField"===n.Type?n.Multiline:n.ChoiceType===T.T6.MultiChoice});default:return null}},n.prototype.createRequiredToggleButton=function(){var t=this.props.Master,n=t.Model;return(0,H.i)({HTMLAttributes:{className:"design-question-bottombar-element"},Label:(0,p.pm)().Designer_IsRequired,onValueChange:function(e){(0,R.$U)("DesignPage.Questions.AnswerRequired",{isQuiz:n.IsQuiz,questionId:n.Id,questionType:n.Type,value:e}),n.Required=e,t.SubQuestionMasters.forEach((function(t){t.Model.Required=n.Required}))},Options:{classNameForInnerLabel:"design-question-toggle-label toggle-label-margin-right"},Value:n.Required})},n.prototype.createMoreMenu=function(){var t=this,n={"aria-label":(0,p.pm)().QuestionCard_DesignTime_Menu_Tooltip,children:(0,E.M)({FluentIcon:"More Horizontal",HTMLAttributes:{className:"forms-icon-size18x18"}}),className:"design-question-more-options",title:(0,p.pm)().QuestionCard_DesignTime_Menu_Tooltip};return r.createElement(_.Th,{ButtonStyle:1,ClassNameForContainer:"design-question-bottombar-element",HTMLAttributes:n,MenuItemType:1,onMenuExpand:function(){(0,R.$U)("DesignPage.QuestionMenu.Navigate",{questionType:t.props.Master.Model.Type})},UnorderListMenuItems:this.createMoreMenuItems().concat([this.createAddBranchMenuItem()])})},n.prototype.Mm=function(t){},n.prototype.Lm=function(t){},n.prototype.hm=function(){var t=this.props.Master.Model,n=document.getElementById("Geo");(0,R.JG)({eventInfo:{Component:"QuestionDesignerBase",Geo:n&&n.value||"",tenantId:(0,c.k0)().userInfo.TenantId},type:"MFPUI_AnswerTag"}),t.FormsProEnableAnswerTag=!t.FormsProEnableAnswerTag},n.createActionBarButton=function(t,n,e,i,r,o){return(0,O.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"question-edit-button",disabled:i,onClick:r},FluentIcon:n,IconClassName:e,ref:o,Text:t})},n.prototype.gm=function(){var t=document.activeElement,n=o.findDOMNode(this.getElementRef(-5).current),e=o.findDOMNode(this.getElementRef(-6).current),i=this.getErrorMessage();this.props.IsFirstElement&&t===n?(e.disabled=!1,e.focus()):this.props.IsLastElement&&t===e&&(n.disabled=!1,n.focus()),n.disabled=this.props.IsFirstElement||!!i,e.disabled=this.props.IsLastElement||!!i},n.prototype.Pm=function(){var t=this,e=this.props.Master,i=e.Form,o=e.Model.VideoInfo,s=(0,S.B9)(o.Url,e.Form),a="design-question-title-video office-form-theme-border";s&&(a=(0,l.j)(a,"youTubeDisabled"));var c=(0,O.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"video-delete-button office-form-theme-button-foreground",onClick:function(){(0,R.$U)("DesignPage.VideoEditPane.Delete"),t.props.Master.clearVideoInfo(),(0,S.ax)(i)||i.Model.YouTubeMessageBarState!==I.E.Shown||(i.Model.YouTubeMessageBarState=I.E.Default)}},FluentIcon:"Delete",IconClassName:s?"forms-icon-size14x14":"forms-icon-size18x18",Text:(0,p.pm)().VideoEditPane_Delete_Button}),f=(0,u.tq)();return r.createElement("div",{"aria-label":(0,p.pm)().VideoPane_Video_Container,className:a,key:"VideoContainer",tabIndex:0},this.Am(),s&&r.createElement(z.k,{InDesignMode:!0,IsMobile:f,LocalizedStrings:(0,p.pm)(),VideoUrl:o.Url}),!s&&r.createElement("iframe",{allowFullScreen:!0,className:"design-question-title-video-frame",frameBorder:"0",height:n.calcVideoDisplayHeight(),sandbox:"allow-scripts allow-same-origin allow-popups allow-forms",src:o.Url,width:"100%","aria-label":(0,p.pm)().Linked_Video}),c)},n.prototype.Am=function(){if((0,w.Fp)()&&this.props.Master.Model.VideoInfo.ShowWarningBar){var t=this.props.Master.Form.SettingMaster,n=t.Model.IsAnonymous?(0,p.pm)().Designer_QuestionTitle_StreamVideoTipForAnonymousForm:(0,p.pm)().Designer_QuestionTitle_StreamVideoTip;return(0,N.vV)({TipBarIconClassName:"ms-Icon ms-Icon--Info forms-icon-size16x16",Info:n,TipBarLocation:"Up",TipBarStyle:t.Model.IsAnonymous?"RedBackground":"YellowBackground",ShouldClose:!0,onClose:this.dm})}},n.prototype.dm=function(t){t.stopPropagation(),t.preventDefault(),this.props.Master.Model.VideoInfo.ShowWarningBar=!1},n.calcVideoDisplayHeight=function(){if((0,u.tq)()){var t=$(window).width();return 0===t&&(t=document.body.scrollWidth),t/1.7777777777777777}return(0,v.HR)()},n.prototype.sm=function(){var t=this.im;this.im=[],this.forceUpdate((function(){t.forEach((function(t){return t()}))}))},n.prototype.createDeleteConfirmDialog=function(){var t={clickCancelButton:this.onClickCancelButton,clickDeleteQuestion:this.onClickDeleteButton,Description:this.state.ConfirmDialogText};return this.state.ShowConfirmDialog&&function(t){var n={ClassName:"design-question-delete-close-button",GlyphButtonStyle:"GlyphOnly",Key:"closeItem",onClick:t.clickCancelButton,Text:(0,p.pm)().Common_Close_Text,FluentIcon:"Dismiss",IconClassName:"forms-icon-size16x16"},e=[{ClassName:"design-question-delete-continue-button",GlyphButtonStyle:"Horizontal",Key:"cancelItem",onClick:t.clickCancelButton,Text:(0,p.pm)().Common_Cancel_Text},{ClassName:"design-question-delete-continue-button",GlyphButtonStyle:"Horizontal",Key:"deleteItem",onClick:t.clickDeleteQuestion,Text:(0,p.pm)().Common_Yes_Text}],i=t.Description||(0,p.pm)().Designer_DeleteQuestion_Warning_Text,o={ButtonsProps:e,ClassName:t.ClassName?t.ClassName:"design-question-button-container",CloseButtonProps:n,Description:i,key:"deleteConfirmDialog",ShowDialog:!0};return r.createElement("div",{className:"design-question-confirm-dialog","aria-label":i,role:"dialog"},(0,j.s)(o))}(t)},n.prototype.deleteQuestion=function(){var t=function(t,n,e){var i=(0,p.pm)().DeleteDialogText_With_Multilingual,r=(0,p.pm)().DeleteDialogText_With_NoMultilingual_NoDataSync,o=(0,p.pm)().DeleteDialogText_With_NoMultilingual_DataSync,s=(0,p.pm)().DeleteDialogText_With_Multilingual_NoDataSync;return t?n?e?i:s:i:n?e?o:r:null}(this.props.Master.Form.Model.LocaleList.length,this.props.Master.Form.Model.ResponsesCount>0,!!this.props.Master.Form.Model.XlWorkbookId);t?this.setState({ShowConfirmDialog:!0,ConfirmDialogText:t}):this.onClickDeleteButton()},n.prototype.onClickCancelButton=function(){var t=this;this.setState({ShowConfirmDialog:!1,SelectedElementIndex:W},(function(){var n=t.om.current;n&&n.focus&&n.focus()}))},n.prototype.createMetricConfirmationDialog=function(){return r.createElement(r.Fragment,null)},n.prototype.updateInlineRule=function(t,n){},n.prototype.createTopMenu=function(){return r.createElement(r.Fragment,null)},n}(V.r)},71209:function(t,n,e){"use strict";e.d(n,{v:function(){return i}});var i=e(72377).Pv.Resolve("IQuestionDesignerBase")},65434:function(t,n,e){"use strict";function i(t){switch(t){case"form":case"Form":return 1;case"section":case"Section":case"Question.ColumnGroup":return 2;case"Question.Choice":return 3;case"Question.DateTime":return 4;case"Question.Rating":return 5;case"Question.TextField":return 6;case"Question.Ranking":return 7;case"Question.MatrixChoiceGroup":return 8;case"Question.MatrixChoice":return 9;case"Question.FileUpload":return 10;case"Question.NPS":return 11;default:return 0}}function r(t){return t&&1===t.Location&&1===t.Suffix}e.d(n,{bF:function(){return i},co:function(){return r}})},50434:function(t,n,e){"use strict";e.d(n,{DQ:function(){return C},EE:function(){return y},Iy:function(){return P},KR:function(){return w},LP:function(){return I},UL:function(){return T},UV:function(){return x},a1:function(){return M},nX:function(){return S},q2:function(){return F},uV:function(){return N}});var i=e(87363),r=e(12611),o=e(13877),s=e(7645),a=(e(67661),e(64290),e(3424)),u=["mp3","aif","iff","m3u","m4a","mid","mpa","ra","wav","wma"],c=["xls","xlt","xlm","xlsx","xlsm","xltx","xltm"],l=["jpg","jpeg","png","gif","bmp","tiff","psd","thm","yuv","ai","drw","eps","ps","svg","3dm","max"],f=["ppt","pot","pps","pptx","pptm","potx","potm","ppam","ppsx","ppsm","sldx","sldm"],h=["pdf"],d=["avi","mp4","mov","wmv","asf","3g2","3gp","asx","flv","mpg","rm","swf","vob"],m=["doc","dot","wbk","docx","docm","dotx","dotm","docb"],v={};u.forEach((function(t){return v[t]="Audio"})),c.forEach((function(t){return v[t]="Excel"})),l.forEach((function(t){return v[t]="Image"})),f.forEach((function(t){return v[t]="PowerPoint"})),h.forEach((function(t){return v[t]="PDF"})),d.forEach((function(t){return v[t]="Video"})),m.forEach((function(t){return v[t]="Word"}));var g={Audio:u,Excel:c,Image:l,PDF:h,PowerPoint:f,Video:d,Word:m},p={Audio:{Color:"#666",Name:"Microphone"},Excel:{Color:"#217346",Name:"ExcelDocument"},Image:{Color:"#666",Name:"Photo2"},PDF:{Color:"#666",Name:"PDF"},PowerPoint:{Color:"#B7472A",Name:"PowerPointDocument"},Text:{Color:"#666",Name:"TextField"},Video:{Color:"#666",Name:"Video"},Word:{Color:"#2B579A",Name:"WordDocument"}},b="officeforms.fileuploaddialogmap",y={"10MB":10,"100MB":100,"1GB":1e3};function w(t){if(t.isFieldReady(t.Schema.FileUploadFormInfo)&&t.Model.FileUploadFormInfo&&t.Model.FileUploadFormInfo.errorCode&&"3"!==t.Model.FileUploadFormInfo.errorCode)return(0,s.pm)().UploadFile_ErrorMessage_PortalPage_FormCard_Bar}function S(t){var n=(0,s.pm)(),e="";switch(t){case"3":e=n.UploadFile_ErrorMessage_ErrorCode_3;break;case"6611":e=n.Error_Message_6611;break;case"6612":e=n.Error_Message_6612;break;case"6613":e=n.Error_Message_6613;break;case"6614":e=n.Error_Message_6614;break;default:e=n.UploadFile_Creation_Error_Message}return e}function N(t,n){var e="";switch(t){case 1:e=(0,s.pm)().UploadFile_ErrorMessage_DesignPage_1;break;case 14:e=(0,s.pm)().UploadFile_ErrorMessage_DesignPage_14;break;case 16:e=(0,s.pm)().UploadFile_ErrorMessage_DesignPage_16;break;default:e=(0,s.pm)().UploadFile_Creation_Error_Message}return n?e="".concat((0,s.pm)().UploadFile_ErrorMessage_DesignPage_AnonymousDisabled," ").concat(e):e||(e=(0,s.pm)().UploadFile_Creation_Error_Message),e}function C(t){var n=[];return Object.keys(t).forEach((function(e){t[e]&&(n=n.concat(g[e]))})),n}function I(t){var n=k(t),e={className:"forms-icon-size20x20 office-form-theme-quiz-point analyze-view-file-icon",style:{color:n.Color}};return i.createElement(a.F,{HTMLAttributes:e,IconName:n.Name})}function T(t,n){switch(n){case"Audio":return t.UploadFile_Type_Audio;case"Excel":return t.UploadFile_Type_Excel;case"Image":return t.UploadFile_Type_Image;case"PowerPoint":return t.UploadFile_Type_PowerPoint;case"PDF":return t.UploadFile_Type_PDF;case"Video":return t.UploadFile_Type_Video;case"Word":return t.UploadFile_Type_Word;default:return""}}function k(t){var n=t.split("."),e=n[n.length-1].toLowerCase();return p[v[e]]||{Color:"#666",Name:"TextDocument"}}function x(t){var n=k(t);return'<i class="ms-Icon ms-Icon--'.concat(n.Name,' forms-icon-size20x20 response-dialog-fileIcon office-form-theme-quiz-point" style="color: ').concat(n.Color,';"></i>')}function F(t,n){var e=t.Model.Id,i=!!r.find(t.Model.Questions,(function(t){return"Question.FileUpload"===t.Type}));if(P(e)||!i){var s=D(),a=r.find(s,(function(t){return t.FormId===e}));a?a.ShowConfirmDialog=a.ShowConfirmDialog&&n:s.push({FormId:e,ShowConfirmDialog:!0}),(0,o.$o)().setItem(b,JSON.stringify(s))}}function P(t){var n=r.find(D(),(function(n){return n.FormId===t}));return!!n&&n.ShowConfirmDialog}function D(){var t=[],n=(0,o.$o)().getItem(b);return n&&(t=JSON.parse(n)),t}function M(t){var n=t.Model.FileTypes;Object.keys(n).forEach((function(t){n[t]=!0}))}},47601:function(t,n,e){"use strict";e.d(n,{e:function(){return o}});var i=e(12611),r=e(40935);function o(t){if(!t.IsGroupForm&&!t.formOwnedByMe())return!0;var n=(0,r.F)();if(n.isFieldReady(n.Schema.groups)){var e=i.find(n.Groups,(function(n){return n.Model.id===t.Model.OwnerId}));return t.IsGroupForm&&!e}}},77145:function(t,n,e){"use strict";e.d(n,{d:function(){return h}});var i=e(59312),r=e(87363),o=e(262),s=e(64459),a=e(7645),u=e(49306),c=e(67661),l=e(64290),f=e(77309),h=function(t){function n(n){var e=t.call(this,n)||this;return e.state={LabelDetailLoaded:!1,LabelsLoaded:!1},e.Em=function(){return e.forceUpdate()},e.props.FormMaster.observe(e.Em,[e.props.FormMaster.Schema.DataClassificationLabel]),e}return(0,i.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this;this.props.DesignTimeView&&(0,u.I)().then((function(n){t.Om=(0,s.d)(n),t.setState({LabelsLoaded:!0})})),!this.props.DesignTimeView&&this.props.FormMaster.isFieldReady(c.x.Schema.DataClassificationLabel)&&(0,u.F)(this.props.FormMaster.Model.OwnerTenantId,this.props.FormMaster.Model.DataClassificationLabel).then((function(n){t._m=n,t.setState({LabelDetailLoaded:!0})}))},n.prototype.componentWillUnmount=function(){this.props.FormMaster.unobserve(this.Em,[this.props.FormMaster.Schema.DataClassificationLabel])},n.prototype.render=function(){if(!this.props.FormMaster.isFieldReady(c.x.Schema.DataClassificationLabel)||!this.props.FormMaster.Model.DataClassificationLabel||this.props.DesignTimeView&&!this.state.LabelsLoaded||!this.props.DesignTimeView&&(!this.state.LabelDetailLoaded||!this._m))return null;var t=this.props.FormMaster.Model.DataClassificationLabel;if(this.props.DesignTimeView)for(var n=0,e=this.Om;n<e.length;n++){var i=e[n];if(i.level===t&&!i.showInFormContent)return null}var s=(0,o.j)(this.props.HTMLAttributes&&this.props.HTMLAttributes.className,"__data-classification-label__");return(0,l.pd)((function(){return r.createElement(f.L,{Role:"Status",LazyRendering:!0},r.createElement("div",{className:s,"aria-label":(0,a.pm)().DesignPage_SettingsPane_DataClassification_External_Title.format(t)},t))}),(function(){return r.createElement("div",{className:s},t)}))},n}(e(23112).r)},85977:function(t,n,e){"use strict";e.d(n,{W:function(){return f}});var i=e(59312),r=e(87363),o=e(61533),s=e(80820),a=e(37944),u=e(7645),c=e(54496),l=e(34990),f=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.Bm(),this.unregisterTooltipMouseOverEventHandler(),t.prototype.componentWillUnmount.call(this)},n.prototype.componentDidMount=function(){this.Bm(),this.Hm(),this.registerTooltipMouseOverEventHandler(),t.prototype.componentDidMount.call(this)},n.prototype.insightViewDescriptionDetail=function(){return r.createElement("div",{className:"association-rule-insight-container"},r.createElement("div",{className:"association-rule-insight-description"},this.Gm(),this.qm()))},n.prototype.shouldShowSourceQuestions=function(){return!1},n.prototype.insightViewSourceQuestions=function(){return null},n.prototype.updateContent=function(){this.Bm(),this.Hm(),this.registerTooltipMouseOverEventHandler(),this.Vm("chartDescription")},n.getAnswerValue=function(t){var n=t.Value[0].RawValue;if("Rating"===t.Question.Type||"NPS"===t.Question.Type){var e=l.N.getRatingRange(t.Question.Choices.length);switch(t.Value[0].RawValue){case"Detractors":n=(0,u.pm)().AnalyzeView_Insight_Association_Rule_Detractor_Answer;break;case"High":n=(0,u.pm)().AnalyzeView_Insight_Association_Rule_High_Rating_Template.format(e[1][0],e[1][1]);break;case"Low":n=(0,u.pm)().AnalyzeView_Insight_Association_Rule_Low_Rating_Template.format(e[0][0],e[0][1]);break;case"Passives":n=(0,u.pm)().AnalyzeView_Insight_Association_Rule_Passive_Answer;break;case"Promoters":n=(0,u.pm)().AnalyzeView_Insight_Association_Rule_Promoter_Answer}}return(0,c.Nw)(n)},n.isCategorizedType=function(t){var n=t.Type.toUpperCase();return"RATING"===n||"NPS"===n},n.prototype.Gm=function(){var t,e=this.props.Insight,i=n.isCategorizedType(e.ConditionAnswers[0].Question),o=n.isCategorizedType(e.TargetAnswer.Question),s=(t=100===Math.ceil(100*e.ConfidenceValue)?i&&o?(0,u.pm)().AnalyzeView_Insight_Association_Rule_Description_Categorized_Categorized_All:i?(0,u.pm)().AnalyzeView_Insight_Association_Rule_Description_Categorized_Common_All:o?(0,u.pm)().AnalyzeView_Insight_Association_Rule_Description_Common_Categorized_All:(0,u.pm)().AnalyzeView_Insight_Association_Rule_Description_Common_Common_All:i&&o?(0,u.pm)().AnalyzeView_Insight_Association_Rule_Description_Categorized_Categorized:i?(0,u.pm)().AnalyzeView_Insight_Association_Rule_Description_Categorized_Common:o?(0,u.pm)().AnalyzeView_Insight_Association_Rule_Description_Common_Categorized:(0,u.pm)().AnalyzeView_Insight_Association_Rule_Description_Common_Common).format(n.getAnswerValue(e.ConditionAnswers[0]),n.createSourceQuestionTooltip(e.ConditionAnswers[0].Question),n.getAnswerValue(e.TargetAnswer),n.createSourceQuestionTooltip(e.TargetAnswer.Question)),l=t.format(n.getAnswerValue(e.ConditionAnswers[0]),(0,c.Nw)(e.ConditionAnswers[0].Question.Title),n.getAnswerValue(e.TargetAnswer),(0,c.Nw)(e.TargetAnswer.Question.Title));return r.createElement(a.H,{"aria-label":l,className:"association-rule-insight-description-text-container",$html:s,tabIndex:0,$as:"div"})},n.prototype.qm=function(){var t,e,i=this.props.Insight;t=n.isCategorizedType(i.ConditionAnswers[0].Question)?(0,u.pm)().AnalyzeView_Insight_Association_Rule_Legend_Support_Categorized:(0,u.pm)().AnalyzeView_Insight_Association_Rule_Legend_Support_Common,e=n.isCategorizedType(i.TargetAnswer.Question)?(0,u.pm)().AnalyzeView_Insight_Association_Rule_Legend_Target_Categorized:(0,u.pm)().AnalyzeView_Insight_Association_Rule_Legend_Target_Common;var o=t.format(Math.ceil(100*i.SupportValue),n.getAnswerValue(i.ConditionAnswers[0]),n.createSourceQuestionTooltip(i.ConditionAnswers[0].Question)),s=e.format(Math.ceil(100*i.ConfidenceValue),n.getAnswerValue(i.TargetAnswer),n.createSourceQuestionTooltip(i.TargetAnswer.Question)),f=t.format(Math.ceil(100*i.SupportValue),n.getAnswerValue(i.ConditionAnswers[0]),(0,c.Nw)(i.ConditionAnswers[0].Question.Title)),h=e.format(Math.ceil(100*i.ConfidenceValue),n.getAnswerValue(i.TargetAnswer),(0,c.Nw)(i.TargetAnswer.Question.Title)),d=l.A[this.props.Index%l.A.length][0],m=l.A[this.props.Index%l.A.length][1];return r.createElement("div",{"aria-label":"".concat(f," ").concat(h),className:"association-rule-insight-view-charts-container",tabIndex:0},r.createElement("div",{className:"association-rule-insight-view-chart"},r.createElement("div",{className:"association-rule-insight-view-chart-row"},r.createElement("div",{className:"association-rule-insight-view-support-chart"}),r.createElement("div",{className:"association-rule-insight-view-target-chart"})),r.createElement("div",{className:"association-rule-insight-view-description-row animation",ref:"chartDescription"},r.createElement("div",{className:"association-rule-insight-view-legend-container support"},r.createElement("div",{className:"association-rule-insight-view-legend-dot",style:{background:d}}),r.createElement(a.H,{className:"association-rule-insight-view-legend-description",$html:o,$as:"div"})),r.createElement("div",{className:"association-rule-insight-view-legend-container target"},r.createElement("div",{className:"association-rule-insight-view-legend-dot",style:{background:m}}),r.createElement(a.H,{className:"association-rule-insight-view-legend-description",$html:s,$as:"div"})))))},n.prototype.Hm=function(){var t=this.props.Insight,e=Math.ceil(100*t.SupportValue),i=t.ConditionAnswers.map((function(t){return n.getAnswerValue(t)}));this.zm(e,i,0);var r=Math.ceil(100*t.ConfidenceValue),o=[n.getAnswerValue(t.TargetAnswer)];this.zm(r,o,1)},n.prototype.Bm=function(){d3&&d3.select(".association-rule-insight-view-charts-container").selectAll("svg").remove()},n.prototype.zm=function(t,n,e){var i=0===e;n=n.map((function(t){return t.length>=25?"".concat(t.slice(0,22),"..."):t}));var r=[{name:"main",percent:t},{name:"other",percent:100-t}],o=i?150:300,a=i?74:45,u=i?62:38,c=i?75:250,f=i?0:1,h=l.A[this.props.Index%l.A.length][f],d=d3.scale.ordinal().range([h,s.QC]),m=d3.layout.pie().value((function(t){return t.percent})).sort(null).padAngle(.03),v=d3.svg.arc().outerRadius(a).innerRadius(u),g=i?".association-rule-insight-view-support-chart":".association-rule-insight-view-target-chart",p=d3.select(g).append("svg").attr({width:o,height:150}).append("g").attr({transform:"translate(".concat(c,",").concat(75,")")});p.selectAll("path").data(m(r)).enter().append("path").attr({d:v,fill:function(t,n){return d(t.data.name)}}).transition().duration(1e3).attrTween("d",(function(t){var n=d3.interpolate({startAngle:0,endAngle:0},t);return function(t){return v(n(t))}}));setTimeout((function(){i||p.append("path").attr({class:"association-rule-chart-pointer",d:"M -25 -40 A 43 45 0 0 0 -25 40 L -250 0"}),p.selectAll("text").data(m(r)).enter().append("text").transition().duration(200).attr("dy",".4em").attr("text-anchor","middle").attr("class","association-rule-chart-percentage-text").text((function(t,n){if(0===n)return"".concat(t.data.percent,"%")}))}),1e3)},n.prototype.Vm=function(t){var n=$(o.findDOMNode(this.refs[t]));n&&n.length>0&&(n.removeClass("animation"),window.setTimeout((function(){return n.addClass("animation")}),0))},n}(l.N)},34990:function(t,n,e){"use strict";e.d(n,{A:function(){return h},N:function(){return d}});var i=e(59312),r=e(87363),o=e(61533),s=e(12611),a=e(7645),u=e(54496),c=e(31442),l=e(3424),f=e(23112),h=[["#0078d8","#01439e"],["#ee2872","#a7183f"],["#8cc83f","#458114"],["#13a89f","#066a62"],["#922790","#5e115d"],["#e92224","#a3140b"],["#4655a0","#182d72"],["#672e91","#3a0f62"],["#117d10","#044604"]],d=function(t){function n(n){var e=t.call(this,n)||this;return e.Qm=Date.now(),e.props.setCurrentViewInsight(e.props.Insight),e.Um=e.Um.bind(e),e}return(0,i.ZT)(n,t),n.prototype.componentWillUpdate=function(t,n){this.$m=!s.isEqual(this.props,t)||!s.isEqual(this.state,n)},n.prototype.componentDidUpdate=function(){this.$m&&(this.registerTooltipMouseOverEventHandler(),this.Wm(),this.props.focusOnInsightDialog(),this.updateContent())},n.prototype.componentDidMount=function(){this.props.focusOnInsightDialog(),this.registerTooltipMouseOverEventHandler()},n.prototype.componentWillUnmount=function(){this.Wm(),this.unregisterTooltipMouseOverEventHandler()},n.prototype.render=function(){return r.createElement("div",{className:"insight-view-content",ref:"insight-content"},this.Jm(),this.Zm())},n.prototype.Jm=function(){return r.createElement("div",{className:"insight-view-description-summary"},r.createElement("div",{className:"insight-view-description-summary-detail"},this.insightViewDescriptionDetail()))},n.prototype.Zm=function(){var t=this;if(!this.shouldShowSourceQuestions())return null;var n=null;this.state.ShowSourceDetail&&(n=this.insightViewSourceQuestions());var e={"aria-label":this.getSourceButtonTitle(),className:"insight-view-descrption-source-title",onClick:function(){return t.setState({ShowSourceDetail:!t.state.ShowSourceDetail})},tabIndex:0,onKeyDown:function(n){13!==n.keyCode&&32!==n.keyCode||t.setState({ShowSourceDetail:!t.state.ShowSourceDetail})}};return r.createElement("div",{className:"insight-view-source-questions"},r.createElement("div",{className:"insight-view-description-source-container"},r.createElement("div",(0,i.pi)({},e),r.createElement("span",{className:"insight-view-description-source-text"},this.getSourceButtonTitle()),r.createElement(l.F,{FluentIcon:this.state.ShowSourceDetail?"Chevron Up":"Chevron Down",HTMLAttributes:{className:"insight-view-description-source-icon forms-icon-size14x14 select-placeholder-arrow"}}))),n)},n.prototype.shouldShowSourceQuestions=function(){return!0},n.prototype.getSourceButtonTitle=function(){return(0,a.pm)().AnalyzeView_Insight_Source_Title},n.prototype.createSourceQuestionTitle=function(t){return(0,a.pm)().AnalyzeView_Insight_Source_Question_Template.format(t.QuestionOrder,t.Title)},n.createSourceQuestionTooltip=function(t){var n=(0,a.pm)().AnalyzeView_Insight_Tooltip_Template.format(t.QuestionOrder),e=(0,a.pm)().Analyze_Insight_summary_Question_Title.format(t.QuestionOrder,(0,u.Nw)(t.Title));return'<span class="insight-tooltip">'.concat(n,'<span class="insight-tooltip-text">').concat(e,"</span></span>")},n.prototype.registerTooltipMouseOverEventHandler=function(){var t=this,n=document.getElementsByClassName("insight-tooltip");s.forEach(n,(function(n){n.addEventListener("mouseover",t.Um)}))},n.prototype.unregisterTooltipMouseOverEventHandler=function(){var t=this,n=document.getElementsByClassName("insight-tooltip");s.forEach(n,(function(n){n.removeEventListener("mouseover",t.Um)}))},n.getRatingRange=function(t){var n=0;switch(t){default:case 2:case 3:n=0;break;case 4:case 5:case 6:case 7:n=1;break;case 8:case 9:n=2;break;case 10:n=3}return[[1,1+n],[t-n,t]]},n.prototype.Um=function(t){var n=t.currentTarget,e=o.findDOMNode(this.refs["insight-content"]),i=n.firstElementChild,r=n.getBoundingClientRect(),s=e.getBoundingClientRect();r.right+125>s.right?i.style.left="-".concat(i.clientWidth,"px"):r.left-125<s.left&&(i.style.left="0px"),r.top+125>s.bottom&&(i.style.top="-".concat(i.clientHeight+15,"px"))},n.prototype.Wm=function(){(0,c.$U)("DesignPage.Responses.ReleaseInsightView",{Duration:Date.now()-this.Qm,InsightType:this.props.Insight.Type}),this.Qm=Date.now()},n}(f.r)},79068:function(t,n,e){"use strict";e.d(n,{N4:function(){return s},_I:function(){return u},s$:function(){return a}});var i=e(60211),r=e(83894),o=e(64290);function s(){return(0,o.hl)((function(){return!(0,i.x8)()}))}function a(){return(0,o.hl)((function(){return!(0,i.x8)()&&!(0,r.ro)()}))}function u(){return(0,o.hl)((function(){return(0,r.Wh)()||(0,r.Ak)()}))}},64876:function(t,n,e){"use strict";e.d(n,{Z:function(){return u}});var i=e(59312),r=e(87363),o=e(262),s=e(31442),a=e(23112),u=function(t){function n(n){var e=t.call(this,n)||this;return e.Xm=e.Xm.bind(e),e.tv=e.tv.bind(e),e.rv=e.rv.bind(e),e}return(0,i.ZT)(n,t),n.prototype.render=function(){var t="question-suggestion-card-gallery-dot",n={className:t=(0,o.j)(t,"office-form-theme-border","office-form-theme-interactive-background",this.props.Selected?"active":"inactive"),key:"gallery-dot"+this.props.Index,onClick:this.Xm,onKeyDown:this.tv,tabIndex:0};return r.createElement("div",(0,i.pi)({},n))},n.prototype.Xm=function(){this.rv(),this.props.changeGalleryDot(this.props.Index)},n.prototype.tv=function(t){switch(t.keyCode){case 13:case 32:this.rv(),this.props.changeGalleryDot(this.props.Index)}},n.prototype.rv=function(){(0,s.$U)("Intelligence.QuestionSuggestion.Index",{Index:this.props.Index})},n}(a.r)},53738:function(t,n,e){"use strict";e.d(n,{n:function(){return h}});var i=e(59312),r=e(87363),o=e(12611),s=e(60211),a=e(9947),u=e(44286),c=e(7645),l=e(31442),f=e(93387),h=function(t){function n(n){var e=t.call(this,n)||this;return e.ov=e.ov.bind(e),e}return(0,i.ZT)(n,t),n.prototype.render=function(){return r.createElement("span",{className:"suggest-theme-icon-container"},this.uv(),this.cv())},n.prototype.uv=function(){var t=this.props.Theme,n={backgroundImage:"url(".concat(t.Thumbnail,")")},e=r.createElement("span",{className:"theme-suggestion-view-button",style:n}),s=(0,u.U)(t.Name)||(0,c.pm)().Suggest_Theme_Name,a={ButtonStyle:1,children:e,HTMLAttributes:{"aria-label":"".concat(s," ").concat((0,c.pm)().ImmersiveReaderButton_Label),className:"suggest-theme-icon-button",onClick:this.ov,title:s},ToggleActive:this.props.IsActive,key:s};return o.extend(a.HTMLAttributes,this.props.HTMLAttributes),r.createElement(f.zx,(0,i.pi)({},a))},n.prototype.cv=function(){var t=this.props.Theme,n={};return t.PrimaryColor&&(n.backgroundColor=t.PrimaryColor),r.createElement("div",{className:"suggest-theme-color-snapshot","aria-hidden":!0,onClick:this.ov},r.createElement("div",{className:"suggest-snapshot-title",style:n}),r.createElement("div",{className:"suggest-snapshot-content"},r.createElement("div",{className:"suggest-snapshot-submit-button",style:n})))},n.prototype.ov=function(){var t,n;(0,l.$U)("Intelligence.Theme.Apply",{isFromSuggestionCard:this.props.IsFromSuggestionCard,isQuiz:this.props.IsQuiz,suggestTheme:!0,variation:null!==(t=this.props.DesignIntelligenceVariation)&&void 0!==t?t:[]}),(0,l.f)("IntelligenceStatistic.ThemeSuggestion.Apply",{isFromSuggestionCard:this.props.IsFromSuggestionCard,isQuiz:this.props.IsQuiz,msftUser:(0,a.k0)().userInfo.TenantId===(0,s.rq)(),suggestTheme:!0,theme:this.props.Theme.Name,variation:null!==(n=this.props.DesignIntelligenceVariation)&&void 0!==n?n:[]}),this.props.applyTheme(this.props.Theme.Name)},n}(e(23112).r)},16717:function(t,n,e){"use strict";e.d(n,{U:function(){return s}});var i=e(87363),r=e(7645),o={};Object.defineProperty(o,"LocalizedStrings",{get:r.pm});var s=i.createContext(o)},79873:function(t,n,e){"use strict";e.d(n,{r:function(){return i}});var i=function(){return function(){}}()},62335:function(t,n,e){"use strict";e.d(n,{Y:function(){return f},k:function(){return l}});var i=e(59312),r=e(87363),o=e(80820),s=e(69065),a=e(17290),u=e(93387),c=e(3424),l=function(t){function n(n){return t.call(this,n)||this}return(0,i.ZT)(n,t),n.prototype.render=function(){var t=this.fv(),n=this.props.displayText?this.props.displayText.toLocaleUpperCase():(0,c.M)({FluentIcon:"Person",HTMLAttributes:{className:"author-notification-icon"}}),e={backgroundColor:t.backgroundColor,color:t.textColor},i={onClick:function(t){(0,a.x)($(t.target))},"aria-label":this.props.ariaLabel||this.props.tooltip,className:"author-notification-content",style:e,title:this.props.tooltip};return(0,u.ax)({HTMLAttributes:i,ButtonStyle:1,Tooltip:this.props.tooltip,children:r.createElement("span",{"aria-hidden":!0},n)})},n.createColor=function(t){for(var e=0,i=t.length-1;i>=0;i--){var r=t.charCodeAt(i),o=i%8;e^=(r<<o)+(r>>8-o)}var s=e%n.COLOR_SWATCHES_LOOKUP.length;return n.COLOR_SWATCHES_LOOKUP[s]},n.prototype.fv=function(){var t=this.props,e="",i="";t.backgroundColor&&(e=(0,s.hq)(t.backgroundColor)),t.textColor&&(i=(0,s.hq)(t.textColor));var r=t.email||t.name;return""!==i&&""!==e||!r||(e=e||n.createColor(r),i=i||(0,s.hq)((0,s.en)((0,s.$W)(e)))),{backgroundColor:e=e||n.defaultBackgroundColor,textColor:i=i||n.defaultTextColor}},n.COLOR_SWATCHES_LOOKUP=["#3765E4","#D83B01","#B91C49","#910A19","#E40089","#971497","#8150FD","#562685","#2C5797","#007B8A","#11723F","#6F292A","#A16412"],n.defaultBackgroundColor=n.COLOR_SWATCHES_LOOKUP[0],n.defaultTextColor=o.Ej,n}(e(23112).r);function f(t){return r.createElement(l,t)}},54164:function(t,n,e){"use strict";e.d(n,{Q:function(){return m},c:function(){return v}});var i=e(66676),r=new RegExp("\\(([^)]*)\\)","gi"),o=new RegExp("(?:[\0-/:-@[-^`{-퟿-￿]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udbff](?![\udc00-\udfff])|(?:[^\ud800-\udbff]|^)[\udc00-\udfff]) ","gi"),s=new RegExp("\\s+","gi"),a=new RegExp("[ء-ي٠-٩]"),u=new RegExp("[ᄀ-ᇿ|㄰-㆏|ꥠ-꥿|가-힯|ힰ-퟿]"),c=new RegExp("[一-鿌㐀-䶵﨎﨏﨑﨓﨔﨟﨡﨣﨤﨧-﨩]|[\ud840-\ud868][\udc00-\udfff]|\ud869[\udc00-\uded6\udf00-\udfff]|[\ud86a-\ud86c][\udc00-\udfff]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud86e[\udc00-\udc1d]");function l(t,n){var e=t.replace(/\s/,"");return n?e[e.length-1]:e[0]}function f(t,n){var e=t.replace(/\s/,"");return e.length<=2?n?e[0]:e[e.length-1]:n?e.substr(0,2):e.substr(e.length-2,e.length)}function h(t,n){var e="",i=t.split(" ");return 2===i.length?(e+=i[0].charAt(0).toUpperCase(),e+=i[1].charAt(0).toUpperCase()):3===i.length?(e+=i[0].charAt(0).toUpperCase(),e+=i[2].charAt(0).toUpperCase()):0!==i.length&&(e+=i[0].charAt(0).toUpperCase()),n&&e.length>1?e.charAt(1)+e.charAt(0):e}function d(t){return t=(t=(t=(t=t.replace(r,"")).replace(o,"")).replace(s," ")).trim()}function m(t,n){return null==t?"":(arguments.length<2&&(n=(0,i.t)()),t=d(t),a.test(t)?l(t,!!n):u.test(t)||c.test(t)?f(t,!!n):h(t,!!n))}function v(t,n,e){return m(t?t.trim():"".concat(n||""," ").concat(e||"").trim())}},72839:function(t,n,e){"use strict";e.d(n,{H:function(){return l}});var i=e(59312),r=e(87363),o=e(3424),s=e(23112),a=e(62335),u=e(54164),c=/[-_[\]{}()<>!@%~&*+=?.,:;"'`\\^$|#]/g,l=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.state={ShowPhoto:!1},n.vo=!0,n}return(0,i.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this;this.props.Photo.then((function(t){return t.getUrl()})).then((function(n){t.vo&&t.setState({PhotoUrl:n,ShowPhoto:!0})})).catch((function(){}))},n.prototype.componentWillUnmount=function(){this.vo=!1},n.prototype.render=function(){return r.createElement("div",{className:"fl-owner-container"},r.createElement("div",{className:"fl-facepile"},this.hv(),this.dv(),this.mv()),r.createElement("div",{className:"fl-displayname"},r.createElement("span",{className:"searchable"},this.props.HideName?"":this.props.DisplayText||this.props.DisplayName)))},n.prototype.hv=function(){return 2!==this.props.PhotoType?null:r.createElement("div",{className:"author-notification-content"},r.createElement(o.F,{FluentIcon:"Clock"}))},n.prototype.dv=function(){return 1!==this.props.PhotoType?null:this.state.ShowPhoto?this.vv(this.state.PhotoUrl):r.createElement("div",{className:"default-group-icon-container"},r.createElement(o.F,{FluentIcon:"People Community"}))},n.prototype.mv=function(){return 0!==this.props.PhotoType?null:this.state.ShowPhoto?this.vv(this.state.PhotoUrl):this.gv()},n.prototype.vv=function(t){return t&&"data:"!==t?r.createElement("img",{"aria-hidden":!this.props.HideName,"aria-label":this.props.DisplayName,className:"author-notification-content",src:t,title:this.props.DisplayName}):this.gv()},n.prototype.gv=function(){var t=this.props.DisplayName||"",n=t.replace(c,""),e={displayText:(0,u.c)(t,n.split(/\s+/)[0],n.split(/\s+/)[1]),name:t,tooltip:this.props.HideName?t:""};return r.createElement(a.k,(0,i.pi)({},e))},n}(s.r)},25038:function(t,n,e){"use strict";e.d(n,{$C:function(){return v},NT:function(){return l},ZV:function(){return m},bM:function(){return u},kl:function(){return f},mk:function(){return c},nW:function(){return d},wW:function(){return h}});var i=e(94290),r=e(73252),o=e(57411),s=e(7645),a=e(64290);function u(t){return(0,o.M5)()?2===t||3===t||4===t:3===t||4===t}function c(t){return(0,o.M5)()&&2===t}function l(t){return 3===t||4===t}function f(t){return 4===t}function h(t){return 3===t}function d(t,n){switch(n){case"Design":case"Analyze":case"ShareForm":return function(t){switch(t){case 4:return(0,a.pd)((function(){return(0,s.pm)().Phishing_Form_Warning_Message_100}),a.t1);case 3:return(0,o.M5)()?(0,a.pd)((function(){return(0,s.pm)().Phishing_Form_Warning_Message_2}),a.t1):(0,a.pd)((function(){return(0,s.pm)().Phishing_Form_Warning_Message_2_AAD}),a.t1);case 2:return(0,a.pd)((function(){return(0,s.pm)().Phishing_Form_Warning_Message_1}),a.t1);default:return""}}(t);case"Response":return function(t){switch(t){case 4:return(0,a.pd)((function(){return(0,s.pm)().Phishing_Form_ResponsePage_Warning_Message_4}),a.t1);case 3:return(0,a.pd)((function(){return(0,s.pm)().Phishing_Form_ResponsePage_Warning_Message_2}),a.t1);case 2:return(0,a.pd)((function(){return(0,s.pm)().Phishing_Form_ResponsePage_Warning_Message_1}),a.t1);default:return""}}(t);default:return}}function m(t){var n=t;return!(!n||6102!==n.innerCode&&6106!==n.innerCode)}function v(t){(0,i.Rw)()&&((0,r.cr)("FixEslintTeamsPostMessageError")?window.parent.postMessage({Name:"phishingForm",Value:t},"https://assignments.onenote.com"):window.parent.postMessage({Name:"phishingForm",Value:t},"*"))}},6293:function(t,n,e){"use strict";e.d(n,{h:function(){return c},w:function(){return l}});var i=e(87363),r=e(55411),o=e(94978),s=e(7645),a=e(67661),u=e(64290);function c(t){return t.isFieldReady(a.x.Schema.Type)&&"survey"===t.Model.Type?i.createElement("div",{className:"fl-type-label fl-type-survey",key:"type-label",title:(0,s.pm)().Survey_FormCard_TypeLabel}):null}function l(t){return(0,u.pd)((function(){if(t.isFieldReady(a.x.Schema.Type)&&"survey"===t.Model.Type&&(0,r.WT)()){var n=(0,o.Gw)("CustomerVoiceTransitionCompletionDate");return i.createElement("div",{className:"fl-warning-label fl-warning-survey",key:"warning-label",title:(0,s.pm)().CustomerVoiceSurveyWarning.format(n)})}return null}),(function(){return null}))}},17758:function(t,n,e){"use strict";e.d(n,{$:function(){return p}});var i=e(59312),r=e(87363),o=e(12611),s=e(80820),a=e(78587),u=e(262),c=e(85962),l=e(55411),f=e(7645),h=e(64290),d=e(93387),m=e(3424),v=e(41040),g=e(77309),p=function(t){function n(n){var e=t.call(this,n)||this;return e.cardButtonRef=r.createRef(),e.pv=o.uniqueId("FormCard."),e.Bf=e.pv+".description",e.onClick=e.onClick.bind(e),e.onKeyDown=e.onKeyDown.bind(e),e}return(0,i.ZT)(n,t),n.prototype.render=function(){if(this.props.CreateNew)return r.createElement("div",null,this.createFormCreatingCardByMode());var t=this.getCardDescription(),n=this.getCardTitle(),e={"aria-describedby":t?this.Bf:void 0,"aria-disabled":this.state.ContentCovered,"aria-label":n||(0,f.pm)().Unnamed_Survey_Title,className:"fl-content",onClick:this.onClick,onKeyDown:this.onKeyDown},o={ButtonStyle:1,children:[this.createThemeContent(),this.createTitleContent(),this.createCardOwnerContent(),this.createCardWarning(),this.createCardTypeContent(),r.createElement("div",{className:"new-form-card-middle-line",key:"mid-line"}),this.createFooterContent()],HTMLAttributes:e,key:"card-content",ref:this.cardButtonRef},s=r.createElement(d.zx,(0,i.pi)({},o)),a=t?r.createElement("span",{className:"screenReaderReference",id:this.Bf,key:"description"},t):void 0,u=(0,h.pd)((function(){return"fl-history-tile fl-tile"}),h.t1),c=r.createElement("div",{className:u},this.createSpinner(),s,a,this.createOtherContent(),this.bv());return(0,h.pd)((function(){return c}),h.t1)},n.prototype.getCardDescription=function(){return this.state.ShowCardResponseCount&&this.state.IsResponseCountReady?(0,f.pm)().PortalView_FormCard_Responses.format(this.getCardResponseCount()):null},n.prototype.shouldHideDialogTriggerButton=function(){var t=this;return(0,h.pd)((function(){return"survey"===t.getCardType()&&(0,l.WT)()}),h.t1)},n.prototype.createFormCreatingCardByMode=function(){return null},n.prototype.onClick=function(){},n.prototype.onKeyDown=function(t){},n.prototype.shouldShowSpinner=function(){return!1},n.prototype.getStatusMessage=function(){return null},n.prototype.createThemeContent=function(){if(!this.state.ShowCardTheme)return null;if(!this.state.IsThemeReady)return r.createElement("div",{className:"portal-tiles-theme-spinner-overlay",key:"theme-spiner"},r.createElement("div",{className:"common-spinner-circle portal-tiles-theme-spinner-history"}));var t=this.getCardThemeBackgroupUrl(),n=this.getCardThemeName(),e=this.getCardThemePrimaryColor();if(t){var i=t.match(/url\((.*)\)$/);t=i?i[1]:"url(".concat(t,")")}else t=this.getBackgroundImageURL(this.getCardTitle());var o="Customized Theme"===n?"new-form-card-image-customized":"new-form-card-image",a={backgroundColor:e||s.tu,backgroundImage:t};return r.createElement("div",{className:o,key:"theme",style:a})},n.prototype.createTitleContent=function(){if(!this.state.ShowCardTitle)return null;if(!this.state.IsTitleReady)return r.createElement("div",{className:"spinner-tile-animation",key:"title-spinner",style:{fontSize:"6px"}});var t=this.getCardTitle(),n={className:"fl-title searchable",key:"title"};if(t){var e=t.length;n.className=e<=19?(0,u.j)(n.className,"large-size"):e>19&&e<=43?(0,u.j)(n.className,"middle-size"):(0,u.j)(n.className,"small-size")}return r.createElement("div",(0,i.pi)({},n),r.createElement("span",null,t))},n.prototype.createFooterContent=function(){if(!this.state.ShowCardResponseCount)return null;var t,n;if(this.state.IsResponseCountReady){t=r.createElement("div",{className:"fl-response-count",key:"response-count"},"".concat(this.getCardResponseCount()," ").concat((0,f.pm)().Common_Responses_Text));var e=this.showFormStatus();e&&(n=r.createElement("div",{className:"fl-form-closed",key:"form-closed"},e))}else{var o={ClassName:"portal-view-card-resCount-spinner",Ignorable:!1,LoadingDescription:(0,f.pm)().Common_Responses_Text};t=r.createElement("div",{className:"fl-response-count",key:"rcount-spinner"},r.createElement(v.P,(0,i.pi)({},o)))}return r.createElement("div",{className:"fl-form-detail-container"},t,n)},n.prototype.createOtherContent=function(){return null},n.prototype.getErrorMessage=function(){return null},n.prototype.showFormStatus=function(){return null},n.prototype.createSpinner=function(){var t,n=this.getStatusMessage(),e=n&&r.createElement(g.L,{HTMLAttributes:{className:"screenReaderVisible"},LazyRendering:!0,Role:"Log"},n);return t=r.createElement(v.P,(0,i.pi)({},{ClassName:"portal-view-card-base-image-spinner",Ignorable:!1})),this.shouldShowSpinner()?r.createElement("div",{className:"portal-tiles-spinner-overlay"},t,e):null},n.prototype.getBackgroundImageURL=function(t){var n=t||"",e=Math.abs((0,c.u)(n))%9+1,i=(0,a.Jn)("/Images/Theme/default-".concat(e,".png"));return"url(".concat(i,")")},n.prototype.bv=function(){var t=this.getErrorMessage();if(t){var n=(0,m.M)({FluentIcon:"Error Circle",HTMLAttributes:{className:"forms-icon-size18x18 fl-error-icon"}});return r.createElement("div",{className:"fl-error-message-bar"},n,r.createElement("span",{className:"fl-error-message"},t))}},n}(e(23112).r)},23112:function(t,n,e){"use strict";e.d(n,{r:function(){return s}});var i=e(59312),r=e(87363),o=e(61533),s=function(t){function n(n){var e,i,r=t.call(this,n)||this;return r.state={},i=e=r,a.forEach((function(t){var n=i[t];n&&(i[t]=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];try{return n.apply(e,i)}catch(n){return u(e,t,n),null}})})),r}return(0,i.ZT)(n,t),n.prototype.getHtmlElement=function(){return o.findDOMNode(this)},n}(r.Component),a=["componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","componentWillUnmount","render"];function u(t,n,e){try{if(window.onerror){var i="React error in ".concat(t.constructor.name,".").concat(n);e&&e.message&&(i+=": ".concat(e.message)),window.onerror(i,"",0,0,e)}}catch(t){}}},41360:function(t,n,e){"use strict";e.d(n,{z:function(){return s}});var i=e(59312),r=e(87363),o=e(78587),s=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.render=function(){var t=this.props,n=t.src,e=(0,i._T)(t,["src"]);return r.createElement("img",(0,i.pi)({role:"presentation",src:(0,o.Jn)(n)},e))},n}(e(23112).r)},21707:function(t,n,e){"use strict";e.d(n,{r:function(){return w}});var i=e(59312),r=e(87363),o=e(13729),s=e(94290),a=e(51531),u=e(262),c=e(73252),l=e(43367),f=(e(42735),e(64290)),h=e(16717),d=e(23112),m=function(t){var n=r.useMemo((function(){return(0,o.nP)(t.Locale)}),[t.Locale]),e=r.useMemo((function(){return(0,o.ls)(t.Locale)}),[t.Locale]),s={href:n,target:"_blank"};return r.createElement("a",(0,i.pi)({},s),e)},v=e(9947),g=e(72377),p=e(32557),b=function(t){function n(n){var e=t.call(this,n)||this;return e.vo=!1,e.state={PrivacyUrl:"https://go.microsoft.com/fwlink/?LinkId=521839"},e.wv=e.wv.bind(e),e}return(0,i.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this;this.vo=!0,g.Pv.Resolve("IBootEvent").addBootCompleteListener((function(){return t.wv()}))},n.prototype.componentWillUnmount=function(){this.vo=!1},n.prototype.render=function(){var t={className:(0,a.o)()?"office-form-theme-spo-link":void 0,href:this.state.PrivacyUrl,target:"_blank",tabIndex:this.props.tabIndex},n="MSFT"!==(0,v.k0)().ring||this.props.IsAnonymous?this.state.PrivacyUrl?this.props.LocalizedStrings.Form_Footer_PrivacyStatement:this.props.LocalizedStrings.Form_Footer_AnonymousPrivacyStatement:this.props.LocalizedStrings.Form_Footer_DataPrivacyNotice,e=n;return r.createElement("div",{className:this.props.Multiline?"office-form-footer-block":"office-form-footer-inline"},this.state.PrivacyUrl?r.createElement("a",(0,i.pi)({},t,{"aria-label":e}),n):n)},n.prototype.wv=function(){var t=this;(0,p.pw)().then((function(n){t.vo&&t.setState({PrivacyUrl:n||""})}))},n}(d.r),y=e(70208),w=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Sv=!1,n}return(0,i.ZT)(n,t),n.prototype.render=function(){var t,n=this,e=this.props.TopExtraContent&&r.createElement("div",{className:"office-form-footer-block"},this.props.TopExtraContent),i=(0,u.j)("office-form-footer-container office-form-padding-align",this.props.HTMLAttributes&&this.props.HTMLAttributes.className),o=this.props.FooterText;o=(0,l.getIoCModifiedTextField)(o,!1),t=!1;this.Sv&&(0,c.cr)("FormsProCustomFooter"),this.Sv&&(0,c.cr)("FormsProCustomFooter");return r.createElement(h.U.Consumer,null,(function(o){var s=o.LocalizedStrings;return r.createElement("div",{className:"office-form-footer office-form-theme-footer",role:"contentinfo","data-id":n.props.SectionId},r.createElement("div",{className:i},e,(0,f.pd)((function(){return function(t,n,e){var i="office-form-footer-block office-form-footer-custom";switch(e){case"ShowStatement":return r.createElement("div",{className:i},(0,l.getIoCFooterElement)(t));case"ShowStatementWithNotice":return r.createElement("div",{className:i},(0,l.getIoCFooterElement)(n));default:return null}}(s.Response_Page_Footer_Statement_MSFT,s.Response_Page_Footer_Statement,n.props.FooterType)||t}),f.t1),(0,f.pd)((function(){return n.Nv(s)}),f.t1),function(){if((0,c.M0)())return r.createElement("div",{id:"form-bottom-sentinel",className:"office-form-bottom-sentinel"})}()))}))},n.prototype.Nv=function(t){var n,e,u,c,l=this;if(!(0,s.mF)()){var f=" | ";return r.createElement("div",{className:"office-form-footer-block"},(n=t.Form_Footer_Powered,(0,a.o)()?(u=n,c={className:(0,a.o)()?"office-form-theme-spo-link":void 0,href:window.location.origin,target:"_blank"},r.createElement("div",{className:"office-form-footer-inline-without-margin"},r.createElement("a",(0,i.pi)({},c),u))):(e=n,r.createElement("div",{className:"office-form-footer-inline-without-margin"},e))),!(0,s.S0)()&&r.createElement(r.Fragment,null,f,r.createElement(b,{LocalizedStrings:t,IsAnonymous:l.props.FormMaster?l.props.FormMaster.Model.Settings.IsAnonymous:null}),f,r.createElement(y.I,{FormMaster:l.props.FormMaster,LocalizedStrings:t,ForceUseCommercialTermsLink:l.props.ForceUseCommercialTermsLink})),(0,o.XJ)(this.props.LocaleId)&&f,(0,o.XJ)(this.props.LocaleId)&&r.createElement(m,{Locale:this.props.LocaleId}))}},n.prototype.Cv=function(t){},n}(d.r)},93018:function(t,n,e){"use strict";e.d(n,{d:function(){return s}});var i=e(59312),r=e(87363),o=e(94290),s=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.render=function(){return(0,o.Ig)()?r.createElement("div",{className:"image-alternative-text"},this.props.children):null},n}(e(23112).r)},46956:function(t,n,e){"use strict";e.d(n,{z:function(){return d}});var i=e(59312),r=e(87363),o=e(94283),s=e(687),a=e(72467),u=e(90819),c=(e(64290),e(31442)),l=e(41040),f=e(23112),h=e(93018),d=function(t){function n(n){var e=t.call(this,n)||this;return e.Iv=function(t){},e.vf=function(t){},e.state={ImageLoadStatus:0,RetryCount:0},e.Cd=e.Cd.bind(e),e.Td=e.Td.bind(e),e.Tv=e.Tv.bind(e),e}return(0,i.ZT)(n,t),n.prototype.componentDidMount=function(){var t=(0,a.Cu)().Schema;this.props.ImageInfoMaster.observe(this.Tv,[t.AltText,t.ResourceId,t.ResourceUrl])},n.prototype.componentWillUnmount=function(){this.kv&&window.clearTimeout(this.kv),this.props.ImageInfoMaster.unobserve(this.Tv)},n.prototype.render=function(){var t,e;this.props.FullFilled?(t="100%",e="auto"):(t=this.props.ImageWidth||(0,s.Rr)(),e=this.props.ImageHeight||(0,s.w_)());var i,o,a=this.state.RetryCount,u=this.props.ImageInfoMaster.Model,c=u.ResourceUrl;2===this.state.ImageLoadStatus&&a>0&&(c+="?"+a),this.dc()?o=n.createSpinner():1===this.state.ImageLoadStatus&&(i="visiable");var l=u.AltText||"";return r.createElement("div",{className:"office-form-title-image-box",onMouseOver:this.Iv,onFocus:this.props.cvContainerClassName&&this.Iv,tabIndex:this.props.cvContainerClassName&&0,onKeyUp:this.vf},r.createElement("img",{title:l,className:i,height:e,onError:this.Td,onLoad:this.Cd,src:c,width:t}),o,r.createElement(h.d,null,this.props.ImageInfoMaster.Model.AltText))},n.prototype.dc=function(){var t=this.props.ImageInfoMaster.Model;return 1!==this.state.ImageLoadStatus||t.ImageProcessingStatus!==u.nv.Idle},n.createSpinner=function(){var t=r.createElement(l.P,(0,i.pi)({},{ClassName:"designPage-question-titleLoadImage-spinner",Ignorable:!1}));return r.createElement("div",{className:"image-spinner"},t)},n.prototype.Cd=function(){(0,c.w6)("Image.ImageOnLoad.Success",{imageType:this.props.ImageType,location:"1"}),(0,o.OE)(2,{$imageType:this.props.ImageType,$location:"RenderCard"}),this.setState({ImageLoadStatus:1})},n.prototype.Td=function(){var t=this,n=this.state.RetryCount;n<3?this.kv=window.setTimeout((function(){return t.setState({RetryCount:++n})}),1e3):((0,c.w6)("Image.ImageOnLoad.Failure",{imageType:this.props.ImageType,location:"1"}),(0,o.OE)(1,{$imageType:this.props.ImageType,$location:"RenderCard"}),this.setState({ImageLoadStatus:2}))},n.prototype.Tv=function(){this.forceUpdate()},n}(f.r)},932:function(t,n,e){"use strict";e.d(n,{$:function(){return l}});var i=e(59312),r=e(87363),o=e(262),s=e(55411),a=e(7645),u=e(23112),c=e(41360),l=function(t){function n(n){var e=t.call(this,n)||this;return e.xv=r.createRef(),e.state={ShowIR:!1},e.Fv=e.Fv.bind(e),e}return(0,i.ZT)(n,t),n.prototype.render=function(){var t=this,n=this.state.ShowIR?"immersive-reader-focused":"";return r.createElement("div",{tabIndex:this.state.ShowIR?-1:0,onFocus:this.Fv,className:"immersive-reader-button-wrapper"},r.createElement("button",{className:(0,o.j)("immersive-reader-button-form",this.props.className,n),"data-locale":(0,s.Kc)()||navigator.language,"aria-label":(0,a.pm)().ImmersiveReaderButton_Hint,onClick:this.props.onClick,onBlur:function(){return t.setState({ShowIR:!1})},ref:this.xv},r.createElement(c.z,{src:this.props.whiteIcon?"/Images/IR_white_title.svg":"/Images/immersive-reader-icon_black.svg",alt:(0,a.pm)().ImmersiveReaderButton_Hint,title:(0,a.pm)().ImmersiveReaderButton_Hint,style:{verticalAlign:"middle"}})))},n.prototype.Fv=function(){var t=this;this.setState({ShowIR:!0},(function(){var n;null===(n=t.xv.current)||void 0===n||n.focus()}))},n}(u.r)},24742:function(t,n,e){"use strict";e.d(n,{E:function(){return u}});var i=e(59312),r=e(87363),o=e(77356),s=e(3424),a=e(65863),u=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Dv=r.createRef(),n}return(0,i.ZT)(n,t),n.prototype.componentDidMount=function(){(0,o.z)($(this.Dv.current))},n.prototype.render=function(){var t,n=this.props.Message,e=n;return"string"==typeof n&&(t={RenderMode:"RichText",Text:n,ContainsHtml:!0},e=(0,a.q)(t)),r.createElement("div",null,r.createElement("div",{className:"thank-you-page-confirm"},r.createElement(s.F,{FluentIcon:"Checkmark Circle",HTMLAttributes:{className:"office-form-theme-primary-color thank-you-page-font-icon"}}),r.createElement("span",{className:"thank-you-page-comfirm-text"},this.props.ConfirmText)),r.createElement("div",{className:"thank-you-page-container thank-you-page-message",ref:this.Dv},e))},n}(e(23112).r)},70642:function(t,n,e){"use strict";e.d(n,{n:function(){return _}});var i=e(87363),r=e(43367),o=e(59312),s=e(32782),a=e(29295);function u(){return(0,o.mG)(this,void 0,void 0,(function(){return(0,o.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(969).then(e.bind(e,88628))];case 1:return[2,{default:t.sent().DateTimeRenderer}]}}))}))}function c(t){var n=(0,a.J)(c,u);return i.createElement(s.Z,null,i.createElement(n,(0,o.pi)({},t)))}function l(){return(0,o.mG)(this,void 0,void 0,(function(){return(0,o.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(647).then(e.bind(e,4057))];case 1:return[2,{default:t.sent().LikertRenderer}]}}))}))}function f(t){var n=(0,a.J)(f,l);return i.createElement(s.Z,null,i.createElement(n,(0,o.pi)({},t)))}function h(){return(0,o.mG)(this,void 0,void 0,(function(){return(0,o.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(42).then(e.bind(e,15146))];case 1:return[2,{default:t.sent().NPSRenderer}]}}))}))}function d(t){var n=(0,a.J)(d,h);return i.createElement(s.Z,null,i.createElement(n,(0,o.pi)({},t)))}function m(){return(0,o.mG)(this,void 0,void 0,(function(){return(0,o.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(967).then(e.bind(e,74461))];case 1:return[2,{default:t.sent().RankingRenderer}]}}))}))}function v(t){var n=(0,a.J)(v,m);return i.createElement(s.Z,null,i.createElement(n,(0,o.pi)({},t)))}function g(){return(0,o.mG)(this,void 0,void 0,(function(){return(0,o.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(66).then(e.bind(e,50685))];case 1:return[2,{default:t.sent().RatingRenderer}]}}))}))}function p(t){var n=(0,a.J)(p,g);return i.createElement(s.Z,null,i.createElement(n,(0,o.pi)({},t)))}var b=e(12611),y=e(262),w=e(97265),S=e(64459),N=e(63795),C=e(29952),I=e(73252),T=e(687),k=e(13886);var x=e(22768),F=e(53315),P=e(91367),D=e(64290),M=e(31442),L=e(3424),R=e(42605),A=e(17764),E=e(20572),O=function(t){function n(n){var e=t.call(this,n)||this;return e.Lv="presentation",e.Rv=1,e.Ev=new Map,e.state={ShowWarningMessage:!1},e.onMathValueChange=e.onMathValueChange.bind(e),e.onInputValueChange=e.onInputValueChange.bind(e),e._v=e._v.bind(e),e.validateOnBlur=e.validateOnBlur.bind(e),e.setInputFieldDefault(),e}return(0,o.ZT)(n,t),n.prototype.componentWillUpdate=function(t){this.props.LocaleId!==t.LocaleId&&(this.defaultPlaceholder=(0,C.Oy)()?t.LocalizedStrings.Question_TextFiled_Placeholder:t.LocalizedStrings.TextField_DefaultPlaceholder)},n.prototype.createReactNodes=function(){var t=this,n=this.props.Master.Model,e=this.props.Master.Question,r=e.Model,o=e.Form.SettingMaster.Model.IsAnonymous;this.defaultPlaceholder=(0,C.Oy)()?this.props.LocalizedStrings.Question_TextFiled_Placeholder:this.props.LocalizedStrings.TextField_DefaultPlaceholder;var s,a,u,c=this.getErrorMessageLabel();if(this.props.PrintView){var l=(0,D.pd)((function(){return"textbox-printview"}),(function(){return"textbox-printview cv-textbox-printview"}));s=i.createElement("div",{className:l,key:"printView"},n.Answer)}else{var f=void 0,h=void 0,d=void 0;if(r.IsMathQuiz&&!r.Multiline){var m=this.getCorrectnessIcon(!0),v=r.InputSwitcherDisabled||!r.IsMathInputDefault,g=this.props.Disabled||v?void 0:this.createMathTextSwitcher(),p=void 0,b=void 0;if(n.AnswerEntity)p=n.AnswerEntity.IsMathAnswer,b=n.AnswerEntity.Answer;else p=!r.IsAnswerPlainText,b=(0,S.d)(n.Answer||"{}").Answer||"";if(p){this.props.IsPrintViewDesignTime?(d=" ",u=r.InputSwitcherDisabled&&i.createElement("div",{className:"print-restriction-tip"},this.props.LocalizedStrings.TextField_EnterMathAnswer)):d=r.InputSwitcherDisabled?this.props.LocalizedStrings.TextField_EnterMathAnswer:this.defaultPlaceholder;var y={onBlur:this.validateOnBlur},w=i.createElement(x.qS,{Disabled:this.props.Disabled,HTMLAttributes:y,key:"textmathquestion-mathfield",Location:"TextField.Response",onValueChange:this.onMathValueChange,Placeholder:d,QuestionId:r.Id,Value:b},g);h=i.createElement("div",{className:"office-form-response-question-math-container"},w,m)}else{var N=(0,E.ZA)({AutoSelection:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"design-question-math-plaintext-text",onBlur:this.validateOnBlur},key:"textmathquestion-textfield",Label:void 0,MaxLength:(0,T.NJ)(),MinimalHeight:this.props.IsPrintViewDesignTime&&r.Multiline?void 0:40,onValueChange:this.onMathValueChange,Options:{HTMLPropsForInnerElement:this.getElementProps({className:"design-question-math-plaintext-text"})},Placeholder:d||this.defaultPlaceholder,Rows:r.Multiline&&this.props.IsPrintViewDesignTime&&10,Theme:this.props.Theme,ValidationStyle:this.getValidationStyle(),Value:b});h=i.createElement("div",{className:"office-form-response-question-math-textfield"},N,g,m)}a=i.createElement("div",{className:"student-feedback-view-short-text-field-with-correctness",key:"normalView"},h)}else{this.props.IsPrintViewDesignTime?(d=" ",u=r.IsNumber&&i.createElement("div",{className:"print-restriction-tip"},e.getNumberValidationErrorMessage(this.props.LocalizedStrings))):d=(0,D.pd)((function(){return r.IsNumber?e.getNumberValidationErrorMessage(t.props.LocalizedStrings):r.Placeholder||t.defaultPlaceholder}),D.t1),f=(0,E.ZA)({Disabled:this.props.Disabled,HTMLAttributes:{onBlur:this.validateOnBlur},key:"textquestion-textfield",Label:void 0,MaxLength:(0,T.NJ)(),onValueChange:this.onInputValueChange,Required:this.props.Master.Question.Model.Required,Options:{HTMLPropsForInnerElement:this.getElementProps({className:"office-form-question-textbox"})},Placeholder:d,Rows:r.Multiline&&this.props.IsPrintViewDesignTime&&10,TextFieldType:r.Multiline?2:0,Theme:this.props.Theme,ValidationStyle:this.getValidationStyle(),Value:n.Answer});m=this.getCorrectnessIcon();a=i.createElement("div",{className:"student-feedback-view-short-text-field-with-correctness",key:"normalView"},f,m,this.Hv(o))}}return[s,a,u,this.createCorrectAnswerList(),c]},n.prototype.Hv=function(t){return this.state.ShowWarningMessage&&(0,I.cr)("SensitiveInfoCheckInResponsePage")&&((0,I.cr)("SensitiveInfoCheckForAllForms")||t)?i.createElement("div",{className:"warning-message-container",key:"warningMessage"},this.props.LocalizedStrings.Response_Page_SensitiveInfo_QuestionWarning):null},n.prototype.createMathTextSwitcher=function(){var t=this.props.Master.Question.Model,n="design-question-choice-to-math-button";this.props.IsMobile&&(n=(0,y.j)(n,"isMobile"));var e,i,r={className:n,onClick:this._v()};return t.IsAnswerPlainText?(e=this.props.LocalizedStrings.Designer_Question_Equation_Button,i=this.props.LocalizedStrings.Designer_Question_Equation_Button_Tooltip):(e=this.props.LocalizedStrings.Designer_Question_EquationToText_Button,i=this.props.LocalizedStrings.Designer_Question_EquationToText_Button_Tooltip),(0,R.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:r,FluentIcon:t.IsAnswerPlainText?"Math Formula":"Text Field",IconClassName:"forms-icon-size24x24",Text:e,Tooltip:i})},n.prototype._v=function(){var t=this;return function(n){var e=t.props.Master.Question.Model,i=t.props.Master.Model,r=(0,S.d)(i.Answer||"{}");e.IsAnswerPlainText=!e.IsAnswerPlainText;var o={Answer:r.Answer,IsMath:!e.IsAnswerPlainText};i.Answer=JSON.stringify(o),(0,M.$U)(e.IsAnswerPlainText?"DesignPage.Quiz.SwitchMathToTextInput":"DesignPage.Quiz.SwitchTextToMathInput",{location:"TextField.Response",questionId:e.Id}),t.forceUpdate()}},n.prototype.setInputFieldDefault=function(){var t=this.props.Master.Question.Model,n=this.props.Master;this.props.Master.Question.ensureFieldsReady([F.MF.Schema.Id]).then((function(){if(t.IsMathQuiz){if(n.Model.Answer){var e=(0,S.d)(n.Model.Answer||"{}");if(void 0!==e.IsMath)return void(t.IsAnswerPlainText=!e.IsMath)}t.IsAnswerPlainText=!t.IsMathInputDefault}else t.IsAnswerPlainText=!0}))},n.prototype.onInputValueChange=function(t){var n=this.props.Master.Model,e=(0,N.bC)(t);n.Answer=e},n.prototype.onMathValueChange=function(t){var n=this.props.Master.Model,e={Answer:(0,N.bC)(t),IsMath:!this.props.Master.Question.Model.IsAnswerPlainText};n.Answer=JSON.stringify(e)},n.prototype.Gv=function(t){var n=this.props.Master.Model,e=function(t){return!(void 0===t||/[^\u0000-\u007F]+/.test(t)||!/(4\d{3})(-?|\040*)(\d{4}(-?|\040*?)){3}/.test(t)&&!/(?!000|666)[0-8][0-9]{2}[- ](?!00)[0-9]{2}[- ](?!0000)[0-9]{4}/.test(t)&&(!/^[^\s]{8,16}$/.test(t)||!/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$/.test(t)&&!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/.test(t)&&!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/.test(t)))}(t);this.setState({ShowWarningMessage:e}),n.HasSensitiveInfo=e},n.prototype.validateOnBlur=function(){var t=this.props.Master.Model,n=this.props.Master.Question;if(n.Model.IsNumber){var e=t.Answer;n.verify(e)!==F.ej.Success||n.Model.IsMathQuiz||(0,D.pd)((function(){return t.Answer=(0,k.Q5)(e)}),D.t1)}this.Gv(t.Answer)},n.prototype.getErrorMessageLabel=function(){var t=this.props.Master.Model,n=this.props.Master.Question,e=(t.Answer,n.verify(t.Answer));if(t.Answer&&e!==F.ej.Success){var i;switch(e){case F.ej.NumberValidationError:case F.ej.RegExValidationError:i=n.getNumberValidationErrorMessage(this.props.LocalizedStrings);break;case F.ej.MathLengthError:i=this.props.LocalizedStrings.Math_Answer_LengthLimit_Message;break;default:return}return(0,A._)({Alert:!0,HTMLAttributes:{className:"validation-error-message-label",role:"alert"},key:"textquestion-errorlabel",Label:i})}},n.prototype.getCorrectnessIcon=function(t){var e=this.props.Master,r=this.props.Master.Question,s=r.Model;if(this.props.ShowQuizResult&&this.props.ShowPrintResult&&!s.Multiline&&s.IsQuiz){var a=n.isAnswerCorrect(e);if(null!==a&&(a||this.props.IsMobile)){var u=t?"student-feedback-view-short-text-math-correctness-icon-container":"student-feedback-view-short-text-correctness-icon-container";this.props.IsMobile&&(u=(0,y.j)(u,"isMobile"));var c,l=a?this.props.LocalizedStrings.Quiz_CorrectAnswer:this.props.LocalizedStrings.Quiz_WrongAnswer,f={FluentIcon:a?"Checkmark":"Dismiss",HTMLAttributes:{className:(0,y.j)("student-feedback-view-short-text-correctness-icon forms-icon-size14x14",a?"image-button-answerkey":"image-button-checked-wrong-answer"),title:l}},h=e.Model.Answer;if(c=h,!h||(0,w.Ew)(h))c=s.Placeholder||this.defaultPlaceholder;else if(r.Model.IsMathQuiz){var d=(0,S.d)(h||"{}");c=d.IsMath?(0,x.Rq)({Formula:null==d.Answer?h:d.Answer}):null==d.Answer?h:d.Answer}var m={"aria-hidden":!0,className:"student-feedback-view-short-text-hidden-text-to-position-correctness-icon",role:this.Lv};return i.createElement("div",{className:u},i.createElement("span",(0,o.pi)({},m),c),(0,L.M)(f))}}},n.isAnswerCorrect=function(t){var n=t.Model;return null!=n.QuizResult?n.QuizResult.IsAnswerCorrect:new P.E(t.Question.Model).areAnyAnswersDefined()?t.Question.isCorrectAnswer(n.Answer):null},n.prototype.createCorrectAnswerList=function(){var t=this.props.Master.Question.Model,n=this.props.Master.Model.QuizResult;if(this.qv()){var e=null!=n?n:t,r=new P.E(e);if(r.areAnyAnswersDefined()){var o,s=r.getAnswers();if(s.some((function(t){return t.isMath}))){for(var a=[],u=0,c=s;u<c.length;u++){var l=c[u];if(l.isMath){var f=(0,x.Rq)({Formula:l.answer});a.push(i.createElement("div",{className:"correct-answer-list-formula-element"},f))}else a.push(l.answer);a.push(this.props.LocalizedStrings.VariousLocations_ItemList_Separator)}a.pop(),o=i.createElement("div",{className:"correct-answer-list-formula-container"},a)}else o=b.map(s,(function(t){return t.answer})).join(this.props.LocalizedStrings.VariousLocations_ItemList_Separator);var h={HTMLAttributes:{"aria-hidden":!0,className:"office-form-right-answerkey various-short-text-correct-answer-list-correctness-icon",role:this.Lv},IconName:""};return i.createElement("div",{className:"various-short-text-correct-answer-list",key:"answerList"},(0,L.M)(h),i.createElement("b",null,this.props.LocalizedStrings.VariousLocations_CorrectAnswerList_Label," "),o)}}},n.prototype.qv=function(){var t=this.props.Master.Model,n=this.props.Master.Question.Model,e=this.props.Master.Model.QuizResult;return!(n.Multiline||!n.IsQuiz)&&(!(!this.props.ShowDesignInfo&&null==e)&&((null==e||!e.IsAnswerCorrect)&&!(null==e&&this.props.Master.Question.isCorrectAnswer(t.Answer))))},n}(e(88448).e);function _(t){var n,e=t.Master.Question.Model.Type;switch(e){case"Question.Choice":return(0,r.createChoiceQuestionRenderer)(t);case"Question.TextField":n=O;break;case"Question.Rating":return p(t);case"Question.Ranking":return v(t);case"Question.NPS":return d(t);case"Question.MatrixChoiceGroup":return f(t);case"Question.FileUpload":return(0,r.getIoCCreateFileUploadQuestionRenderer)(t);case"Question.DateTime":return c(t);case"Question.CascadeGroup":return(0,r.getIoCCreateCascadeQuestionRenderer)(t)}if(n)return i.createElement(n,t);throw Error('Type "'.concat(e,'" has not been found.'))}},88448:function(t,n,e){"use strict";e.d(n,{e:function(){return K}});var i=e(59312),r=e(87363),o=e(12611),s=e(60211),a=e(29559),u=e(9947),c=e(262),l=e(81620),f=e(42605),h=e(49211),d=e(55411),m=e(73252),v=e(687),g=e(77356),p=e(7645),b=e(43367),y=e(54496),w=e(72467),S=e(46008),N=e(70877),C=e(61018),I=e(22768),T=e(24497),k=e(67661),x=e(53315),F=e(90819),P=e(3920),D=e(502),M=e(155),L=e(19976),R=e(64290),A=e(40947),E=e(3424),O=e(76795),_=e(46872);function B(t){var n=t.Master.Question.Model,e=t.Master.SubQuestionRuntimeMasters,i=e[e.length-1];if(t.IsStudentViewMode){if(!(u=(i||t.Master).getScore())&&!n.Point)return;var o=n.Point?n.Point:"-",s=null!=u?u:"-",a=(0,p.pm)().RuntimeView_TotalPoints_Content.format(s,o);return r.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},(0,p.pm)().Quiz_Points_BracketsText.format(a))}if(n.IsQuiz&&!t.HiddenPoint){if(!n.Point)return;if(t.ShowDesignInfo||!t.ShowQuizResult&&!t.ShowPrintResult)return r.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},(0,_.f)(n.Point));var u;s=null!=(u=(i||t.Master).getScore())?u:"-",a=(0,p.pm)().RuntimeView_TotalPoints_Content.format(s,n.Point);return r.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},(0,p.pm)().Quiz_Points_BracketsText.format(a))}}function H(t){var n=t.Master.Model,e=t.Master.Question.Model,i=e.Type===O.L.getElementTypeName(),r="Question.TextField"===e.Type&&!e.Multiline,o="Question.Ranking"===e.Type,s=i||r||o;return!!(e.IsQuiz&&t.ShowQuizResult&&s&&n.QuizResult)&&!n.QuizResult.IsAnswerCorrect}var G=e(17764),q=e(65863),V=e(62335),z=e(54164),Q=e(23112),U=e(49221),j=e(93018),W=e(932),K=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.nm=r.createRef(),n.Vv=9,n.Qv=16,n.Uv=400,n.$v=o.uniqueId("question"),n.jv=function(){var t={chunks:n.getFormattedDataForImmersiveReader(),title:""},e={uiLang:(0,d.Kc)()||navigator.language};(0,C.d8)().getImmersiveReaderToken().then((function(n){n&&ImmersiveReader&&ImmersiveReader.launchAsync(n,null,t,e)}))},n}return(0,i.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this;this.update=function(){return t.forceUpdate((function(){var n=t.props.onHeightChange;n&&n()}))};var n=this.props.Master,e=[k.x.Schema.HasQuestionMedia];e=(0,b.addIoCSurveyFontToSchemas)(e),n.Question.Form.observe(this.update,e),n.observe(this.update),n.Question.observe(this.update),this.Wv=(0,L.a)(),this.Wv.observe(this.update,[this.Wv.Schema.FormsTenantSettings]);var i=(0,w.Cu)().Schema;n.Question.ImageInfoMaster.observe(this.update,[i.ResourceUrl,i.ContentType,i.OriginalFileName]),n.Question.ImageSettingsMaster.observe(this.update),this.Kv(this.props)},n.prototype.componentWillReceiveProps=function(t){this.Kv(t)},n.prototype.componentWillUnmount=function(){var t=this.props.Master;t.Question.ImageSettingsMaster.unobserve(this.update),t.Question.ImageInfoMaster.unobserve(this.update),t.Question.unobserve(this.update),t.unobserve(this.update),t.Question.Form.unobserve(this.update),this.Wv.unobserve(this.update),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.update)},n.prototype.componentDidMount=function(){this.Zv()},n.prototype.componentDidUpdate=function(t,n){this.Zv()},n.prototype.render=function(){var t={className:"__question__ office-form-question",ref:this.nm};if("has-error"===this.getValidationStyle()||H(this.props)){var n=this.props.IsMobile?"office-form-error-question-mobile":"office-form-error-question";t.className=(0,c.j)(t.className,n)}var e=this.Xv(),o=null;return void 0!==e&&(t.className=(0,c.j)(t.className,"office-form-studentview-question"),o=r.createElement("div",{className:"office-form-feedback-marginbottom-box"})),r.createElement("div",(0,i.pi)({},t,{"data-id":this.props.Master.Question.Model.Id}),this.Yv(),this.createQuestionContent(),e,o,!1)},n.prototype.createWrongResultLabel=function(){return function(t){if(!t.IsMobile&&!t.ShowPrintResult&&H(t)){var n,e=(0,E.M)({Accessible:!0,FluentIcon:"Dismiss",HTMLAttributes:{className:"validation-error-message-wrong-Icon office-form-answerkey"}});return n=[r.createElement("div",{className:"validation-error-circle-big"}),r.createElement("div",{className:"validation-error-circle-small"}),e],r.createElement.apply(r,(0,i.ev)(["div",{"aria-live":"assertive",role:"alert","aria-label":(0,p.pm)().Response_Preview_WrongReponseIcon.format(t.Ordinal)}],n,!1))}}(this.props)},n.prototype.createReactNodes=function(){throw Error("to be overridden.")},n.prototype.createQuestionTitleControls=function(){return r.createElement("div",{className:"form-question-title-controls"},(0,f.F)({Icon:"Up",IconClassName:"form-question-title-button"}),(0,f.F)({Icon:"Down",IconClassName:"form-question-title-button"}),(0,f.F)({Icon:"Copy",IconClassName:"form-question-title-button"}),(0,f.F)({Icon:"Delete",IconClassName:"form-question-title-button"}))},n.prototype.createQuestionContent=function(){var t={className:"office-form-question-content office-form-theme-focus-border"},n=this.props.HTMLAttributes;n&&(t=(0,y.p2)(n,t));var e=(0,c.j)("office-form-question-element",this.isImageLayout()?"with-image":""),o=null;return this.isRequiredQuestionError()&&(o=(0,G._)({HTMLAttributes:{className:"validation-error-message-label",role:"alert"},Label:this.props.LocalizedStrings.Required_Question_Error_Message})),r.createElement("div",(0,i.pi)({},t),this.createWrongResultLabel(),this.createTitleContainer(),null,r.createElement("div",{className:e},this.createReactNodes()),o)},n.prototype.isRequiredQuestionError=function(){if(!this.props.ShowValidationStyle)return!1;var t=this.props.Master,n=t.Question.verify(t.Model.Answer);return t.SubQuestionRuntimeMasters.forEach((function(t){t.Question.verify(t.Model.Answer)===x.ej.RequiredError&&(n=x.ej.RequiredError)})),n===x.ej.RequiredError},n.prototype.getValidationStyle=function(){if(!this.props.ShowValidationStyle)return"";var t=this.props.Master,n=t.Question.verify(t.Model.Answer);return t.SubQuestionRuntimeMasters.forEach((function(t){t.Question.verify(t.Model.Answer)===x.ej.RequiredError&&(n=x.ej.RequiredError)})),n===x.ej.Success?"has-success":"has-error"},n.prototype.getQuestionId=function(){return this.$v},n.prototype.getRequiredId=function(){return this.props.Master.Question.Model.Required?"".concat(this.$v,"-required"):void 0},n.prototype.getQuestionTypeId=function(){return"".concat(this.$v,"-questiontype")},n.prototype.getElementProps=function(t){var n={"aria-describedby":this.getSubtitleId(),"aria-labelledby":(0,c.j)(this.getOrdinalId(),this.getTitleId(),this.tg(),this.getRequiredId(),this.getQuestionTypeId())};return t?(0,y.p2)(t,n):n},n.prototype.getFormattedDataForImmersiveReader=function(){var t=this.props.Master.Question.Model,n=[];if(n.push({content:"".concat(this.props.Ordinal,". ").concat(t.Title).concat(t.Required?" *":"","\n")}),t.Point){var e=B(this.props);n.push({content:"".concat(e.props.children.toString(),"\n\n")})}else n.push({content:"\n"});if(t.Subtitle){var i=t.Subtitle;if("undefined"!=typeof MathJax){var r=MathJax.Hub.getAllJax(null),s=o.find(r,(function(n){return n.originalText===t.Subtitle}));if(s){var a=s.root&&s.root.toMathML&&s.root.toMathML();a&&(a=a.replace(/\n\s*/g,""),i="\x3c!--[if mathML]&#62;".concat((0,l.F1)(a,!0),"&#60;![endif]--\x3e"))}}n.push({content:"".concat(i),mimeType:"text/html"}),n.push({content:"\n\n"})}var u=document.createElement("i");return u.textContent=(0,l.F1)(this.props.LocalizedStrings.ImmersiveReader_InputAnswer,!0),n.push({content:u.outerHTML,mimeType:"text/html"}),n},n.prototype.ng=function(){var t=(0,G._)({HTMLAttributes:{className:"validation-error-message-label"},Label:this.props.LocalizedStrings.Required_Question_Error_Message}),n=(0,E.M)({IconName:"Error",className:"validation-error-message-icon"});return r.createElement("div",{className:"validation-error-container"},n,t)},n.prototype.Kv=function(t){var n=t.Master,e=t.LocaleId;this.questionLocalizedItemMaster&&(this.questionLocalizedItemMaster.unobserve(this.update),this.questionLocalizedItemMaster=void 0),e&&(this.questionLocalizedItemMaster=D.k.getQuestionResourceMaster(e,n.Question.Model.Id,n.Question.Form),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.update,[M.A.Schema.title,M.A.Schema.subtitle]))},n.prototype.Xv=function(){var t=this.props.Master.SubQuestionRuntimeMasters,n=t[t.length-1],e=(n&&n.Model||this.props.Master.Model).AnswerEntity,i=null==e?void 0:e.Feedback;if(this.props.IsStudentViewMode&&i){var o={FluentIcon:"Chat",HTMLAttributes:{className:(0,c.j)("feedback-icon forms-icon-size16x16",(0,a.un)()?"edge":void 0,(0,a.w1)()?"ie":void 0),role:"presentation"}};return r.createElement("div",{className:"office-form-feedback-box"},(0,E.M)(o),r.createElement("div",{className:"office-form-feedback-content"},r.createElement(q.D,{Text:i,RenderMode:"RichText",ContainsHtml:!0})))}},n.prototype.createTitleLabel=function(){var t=this,n=this.props.Master.Question.Model,e=this.props.Master.Question.Form,i=this.questionLocalizedItemMaster,o=null==i?void 0:i.Model,s=this.props.Master.Question.Form.Model.HasQuestionMedia,a=1===n.SuspiciousEvidence||3===n.SuspiciousEvidence,u=a&&(0,p.pm)().Phishing_Question_Level_Message_Suspicous||"",c=(0,R.pd)((function(){return(0,T.wg)(null==o?void 0:o.title,null==o?void 0:o.formsprortlocaletitle)||(0,T.wg)(n.Title,n.FormsProRTQuestionTitle)}),R.t1);c=(0,b.getIoCModifiedTextField)(c,!1);var l=!this.props.HideMedia&&(n.ImageInfo&&n.ImageInfo.ResourceUrl||s)?"office-form-question-title with-image":"office-form-question-title",f=(0,h.w)(e,"ResponsePage.PollView"),d=!this.props.HideOrdinal&&(0,R.pd)((function(){return!(t.isImageLayout()||f)}),R.t1),m={className:l,id:this.getTitleId()},v=n.Required?this.props.LocalizedStrings.Accessibility_RequiredAnswer:void 0,g=v&&r.createElement("div",{key:"accessibilityNode"},r.createElement("span",{className:"accessibility-reader-no-display",id:this.getRequiredId()},v)),y=this.createImmersiveReaderButton(),w=this.createQuestionTypeHint(),S={children:[y,g,w&&r.createElement("div",{key:"questionTypeNode"},r.createElement("span",{className:"accessibility-reader-no-display",id:this.getQuestionTypeId()},w)),B(this.props)],HTMLAttributes:m,HtmlContent:!0,key:this.getQuestionId().toString(),Label:c,Ordinal:this.props.Ordinal,ShowOrdinal:d,ShowRequiredStar:n.Required,ShowWarningIcon:a,Theme:this.props.Theme,WarningIconTooltip:u};return this.getLabel(S)},n.prototype.getLabel=function(t){return(0,G._)(t)},n.prototype.createQuestionTypeHint=function(){var t=this.props.Master.Question.Model,n="";switch(t.Type){case"Question.Choice":n=t.ChoiceType===x.T6.MultiChoice?this.props.LocalizedStrings.QuestionType_MultiChoice:this.props.LocalizedStrings.QuestionType_SingleChoice;break;case"Question.DateTime":n=this.props.LocalizedStrings.QuestionType_DateTime;break;case"Question.Rating":n=this.props.LocalizedStrings.QuestionType_Rating;break;case"Question.TextField":n=t.Multiline?this.props.LocalizedStrings.QuestionType_MultiLineText:this.props.LocalizedStrings.QuestionType_SingleLineText;break;case"Question.Ranking":n=this.props.LocalizedStrings.QuestionType_Ranking;break;case"Question.MatrixChoiceGroup":n=this.props.LocalizedStrings.QuestionType_MatrixChoiceGroup}return n},n.prototype.createTitleOrdinal=function(){return r.createElement("div",{className:"office-form-question-ordinal office-form-theme-primary-background"},r.createElement("span",{id:this.getOrdinalId()},this.props.Ordinal))},n.prototype.createTitleContainer=function(){var t,n,e,o,s,u=this.props.Master.Question,l=u.Model,f=u.Form.Model.HasQuestionMedia,h={},d="office-form-question-subtitle",m=this.props.IsMobile||(0,S.rA)(this.props.SmallScreenCutoffOverride)||l.ImageSettings.Layout===P.RZ.Horizontal&&l.ImageSettings.Size===P.h2.Large,g=u.hasValidVideoUrl(),w=m||g;if(this.props.HideMedia||g||!(l.ImageInfo&&l.ImageInfo.ResourceUrl||f||l.ImageInfo.ImageProcessingStatus===F.nv.Uploading||l.ImageInfo.ImageProcessingStatus===F.nv.Picking)){if(!this.props.HideMedia&&g){var C=(0,a.tq)();d="office-form-question-subtitle with-video";var k=l.VideoInfo;h.className=(0,c.j)(h.className,"question-title-container office-form-theme-video-question-background"),(0,N.B9)(k.Url,u.Form)?s=r.createElement(U.k,{IsMobile:C,LocalizedStrings:this.props.LocalizedStrings,VideoUrl:k.Url}):n=r.createElement("div",{className:"office-form-question-video-container"},r.createElement("iframe",{allowFullScreen:!0,frameBorder:"0",height:this.calcVideoDisplayHeight(),sandbox:"allow-scripts allow-same-origin allow-popups allow-forms",src:k.Url,width:"100%","aria-label":(0,p.pm)().Linked_Video}))}}else{h.className="question-title-container office-form-theme-image-question-background",d="office-form-question-subtitle with-image";var x=m?"office-form-question-horizontal-large-image-container office-form-theme-image-container-border":"office-form-question-image-container office-form-theme-image-container-border";if(l.ImageInfo&&l.ImageInfo.ResourceUrl){var D=u.ImageSettingsMaster.validateImageSettings(),M={className:x,style:m?void 0:{width:"{0}px".format(D.ContainerWidth)}};l.ImageInfo.AltText&&(M=(0,y.p2)(M,{"aria-label":l.ImageInfo.AltText,id:this.tg()}));var L=(0,A.B2)(l.ImageInfo);n=r.createElement("div",(0,i.pi)({},M),r.createElement(A.zg,{Image:u.ImageInfoMaster,ImageSettings:u.ImageSettingsMaster,ImageType:"Question"}),L,r.createElement(j.d,null,this.props.Master.Question.ImageInfoMaster.Model.AltText))}else if(l.ImageInfo.ImageProcessingStatus===F.nv.Uploading||l.ImageInfo.ImageProcessingStatus===F.nv.Picking){M={className:x,style:{height:"{0}px".format((0,v.w_)()),width:"{0}px".format((0,v.Rr)())}};n=r.createElement("div",(0,i.pi)({},M),(0,A.B2)())}}if(this.isSubtitleLayout())if(l.IsMathQuiz&&!l.IsPlainTextInMathField){var E=(0,I.Rq)({DisableLinebreaks:this.props.DisableFormulaLinebreak,Formula:l.Subtitle,onRenderComplete:this.props.onHeightChange});e=r.createElement("div",{className:"office-form-question-formula"},E)}else{var O=null===(t=this.questionLocalizedItemMaster)||void 0===t?void 0:t.Model,_=(0,R.pd)((function(){return(0,T.wg)(null==O?void 0:O.subtitle,null==O?void 0:O.formsprortlocalesubtitle)||(0,T.wg)(l.Subtitle,l.FormsProRTSubtitle)}),R.t1);_=(0,b.getIoCModifiedTextField)(_,!1),o=(0,G._)({HTMLAttributes:{className:l.FormsProRTSubtitle?(0,c.j)(d,"textformat-font"):d,id:this.getSubtitleId()},HtmlContent:!0,Label:_})}return r.createElement("div",{className:"question-title-box"},r.createElement("div",(0,i.pi)({},h),!1,w?void 0:n,w?void 0:s,this.showTitleOrdinal()?this.createTitleOrdinal():void 0,!1,this.createTitleLabel(),o,w?n:void 0,w?s:void 0,e),!1,!1)},n.prototype.showTitleOrdinal=function(){var t=this;this.props.Master.Question.Form;return(0,R.pd)((function(){return t.isImageLayout()}),R.t1)},n.prototype.createImmersiveReaderButton=function(){return(0,a.w1)()||(0,m._y)()||(0,s.x8)()||!this.props.ShouldShowImmersiveReaderButtons?null:r.createElement(W.$,{onClick:o.debounce(this.jv,this.Uv,!0),whiteIcon:!1})},n.prototype.Yv=function(){var t,n=this,e=this.props.Master.Question.Model;return e.CoAuthors&&e.CoAuthors.length>0?e.CoAuthors[e.CoAuthors.length-1].userId!==(0,u.k0)().userInfo.UserId&&(t=o.map(e.CoAuthors,(function(t){if(t.userId!==(0,u.k0)().userInfo.UserId){var e={ariaLabel:n.props.LocalizedStrings.DesignPage_NavBar_CoAuthor_Screen_Reader.format(t.displayName||t.userId,n.props.Ordinal||0),displayText:(0,z.c)(t.displayName,t.firstName,t.lastName),email:t.email,isCoAuthUser:!0,key:t.userId,name:t.displayName,tooltip:t.displayName||t.userId};return r.createElement(V.k,(0,i.pi)({},e))}}))):t=void 0,r.createElement("div",{className:"question-coAuthor-notification-container-render-mode","aria-live":"polite"},t)},n.prototype.calcVideoDisplayHeight=function(){if((0,a.tq)()){var t=$(window).width();return 0===t&&(t=document.body.scrollWidth),t/(this.Qv/this.Vv)}return(0,v.HR)()},n.prototype.getOrdinalId=function(){return this.isImageLayout()?"".concat(this.$v,"-ordinal"):void 0},n.prototype.getTitleId=function(){return"".concat(this.$v,"-title")},n.prototype.getSubtitleId=function(){return this.isSubtitleLayout()?"".concat(this.$v,"-subtitle"):void 0},n.prototype.tg=function(){return"".concat(this.$v,"-image")},n.prototype.isImageLayout=function(){return this.props.Master.Question.Form.Model.HasQuestionMedia&&!this.props.HideMedia},n.prototype.isSubtitleLayout=function(){var t=this.props.Master.Question.Model;return t.ShowSubtitle&&!!t.Subtitle},n.prototype.Zv=function(){var t=$(this.nm.current),n=t.find(".office-form-question-formula span"),e=t.find(".office-form-question-choice-formula span"),i=t.find(".design-formula-mixer span");(0,g.z)(t.find("span").not(n).not(e).not(i))},n}(Q.r)},89099:function(t,n,e){"use strict";e.d(n,{b:function(){return s}});var i=e(59312),r=e(87363),o=e(262),s=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.render=function(){var t="form-renderer-section-breaker";return this.props.HasTheme&&(t=(0,o.j)(t,"office-form-theme-page-background")),r.createElement("div",{className:t})},n}(e(23112).r)},56550:function(t,n,e){"use strict";e.d(n,{p:function(){return u}});var i=e(59312),r=e(87363),o=e(16717),s=e(23112),a=e(22580),u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.render=function(){var t=this;return r.createElement(o.U.Consumer,null,(function(n){n.LocalizedStrings;return r.createElement("div",{className:"form-renderer-section-container",role:"group","aria-label":t.props.SectionMaster.Model.Title,"data-id":t.props.SectionMaster.Model.Id},t.createSectionTitle(),r.createElement("div",{className:"form-renderer-section-content"},t.props.children))}))},n.prototype.createSectionTitle=function(){var t=this;return r.createElement(o.U.Consumer,null,(function(n){var e=n.LocalizedStrings;return r.createElement(a.$,{IsMobile:t.props.IsMobile,LocaleId:t.props.LocaleId,LocalizedStrings:e,Master:t.props.SectionMaster,ShouldShowImmersiveReaderButtons:t.props.ShouldShowImmersiveReaderButtons,IsRuntime:!0})}))},n}(s.r)},22580:function(t,n,e){"use strict";e.d(n,{$:function(){return F}});var i=e(59312),r=e(87363),o=e(12611),s=e(29559),a=e(9947),u=e(262),c=e(687),l=e(7645),f=e(43367),h=e(54496),d=e(72467),m=e(46008),v=e(70877),g=e(24497),p=e(73293),b=e(67661),y=e(90819),w=e(3920),S=e(502),N=e(8009),C=e(62335),I=e(54164),T=e(23112),k=e(20966),x=e(46956),F=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(n,t),n.prototype.componentWillMount=function(){this.ig(this.props)},n.prototype.componentWillReceiveProps=function(t){this.ig(t)},n.prototype.componentDidMount=function(){var t=this;this.As=function(){return t.forceUpdate()};var n=this.props.Master,e=p.Jv.Schema;n.observe(this.As,[e.Title,e.Subtitle,e.VideoInfo,e.CoAuthors]);var i=[b.x.Schema.HasQuestionMedia];i=(0,f.addIoCHeaderFontToSchemas)(i),n.Form.observe(this.As,i);var r=(0,d.BF)().Schema;n.ImageSettingsMaster.observe(this.As,[r.NaturalWidth,r.NaturalHeight,r.ContainerWidth,r.ContainerHeight,r.Size,r.Layout]);var o=(0,d.Cu)().Schema;n.ImageInfoMaster.observe(this.As,[o.ImageProcessingStatus,o.UploadParameters]),this.Wv=(0,d.f5)(),this.Wv.observe(this.As,[this.Wv.Schema.FormsTenantSettings])},n.prototype.componentWillUnmount=function(){var t=this.props.Master;t.unobserve(this.As),t.ImageInfoMaster.unobserve(this.As),t.ImageSettingsMaster.unobserve(this.As),this.Wv.unobserve(this.As)},n.prototype.render=function(){var t,n=this.props.Master,e="Right",a=n.Model.VideoInfo,c=n.ImageInfoMaster,f=n.ImageSettingsMaster,d=c.Model;if(!this.props.HideMedia)if(d.ErrorType||d.ImageProcessingStatus===y.nv.Idle&&!(0,y.UO)(d))n.hasValidVideoUrl()&&(e="Bottom",t=r.createElement(N.C,{ClassNameForIFrame:"design-question-title-video-frame",HTMLAttributes:{className:"design-question-image-title-big-horizontal"},key:"video",Url:a.Url,IsMobile:(0,s.tq)(),ShowVideoUrl:(0,v.B9)(a.Url,n.Form),LocalizedStrings:this.props.LocalizedStrings}));else{var m=this.rg(f.Model);e=m.ImageLayout,t=r.createElement(x.z,{FullFilled:"Bottom"===e,ImageWidth:m.Width,ImageHeight:m.Height,ImageInfoMaster:c,ImageSettingMaster:f,ImageType:"Section",key:"image"})}var g=o.extend({},this.props.HTMLAttributes);g.className=(0,u.j)(g.className,"__section-title__ office-form-section-title",this.props.Master.Form.Model.HasQuestionMedia&&"office-form-theme-image-question-background with-image");var p=this.og(),b=p.Title||(0,l.pm)().Designer_SectionTitle;p.SubTitle&&(b="".concat(b," ").concat(p.SubTitle));var w=(0,h.p2)(g,{"aria-label":"".concat(b)});if(this.props.IsRuntime&&this.sg(p.Title,p.SubTitle))return null;var S=r.createElement(k.F,(0,i.pi)({Heading:2,HTMLAttributes:w,HTMLPropsForInnerElement:{className:"office-form-theme-primary-color","aria-level":2,role:"heading"},MediaLayout:e,ImmersiveReaderToggleProps:{ShouldShowImmersiveReaderButtons:this.props.ShouldShowImmersiveReaderButtons,ToggleImmersiveReaderButtons:null}},p),t,this.ym());return this.props.IsRuntime&&(S=r.createElement("div",{className:"form-renderer-section-title"},S)),S},n.prototype.og=function(){var t,n,e,i,r=this.props.Master;if(this.ag){var o=this.ag.Model;t=o.title,n=o.subtitle,e=o.formsprortlocaletitle,i=o.formsprortlocalesubtitle}t=t||r.Model.Title||"",n=n||r.Model.Subtitle||"";var s=p.Jv.Schema,a=r.isFieldReady(s.FormsProRTQuestionTitle)&&r.isFieldReady(s.FormsProRTSubtitle);return e=(0,g.gA)(e||a&&r.Model.FormsProRTQuestionTitle||""),i=(0,g.gA)(i||a&&r.Model.FormsProRTSubtitle||""),{Title:(0,f.getIoCModifiedTextField)(t,!0),SubTitle:(0,f.getIoCModifiedTextField)(n,!0),RichTitle:(0,f.getIoCModifiedTextField)(e,!0),RichSubtitle:(0,f.getIoCModifiedTextField)(i,!0)}},n.prototype.sg=function(t,n){var e=this.props.Master.Model;return!(t||n||e.ImageInfo.ResourceUrl||e.VideoInfo.Url)},n.prototype.ig=function(t){var n=t.Master,e=n.Form,i=t.LocaleId;this.ag=i?S.k.getQuestionResourceMaster(i,n.Model.Id,e):void 0},n.prototype.ym=function(){var t=this,n=this.props.Master.Model.CoAuthors;if(n&&n.length>0&&n[n.length-1].userId!==(0,a.k0)().userInfo.UserId)return r.createElement("div",{className:"question-coAuthor-notification-container-design-mode",key:"coAuthor"},o.map(n,(function(n){return t.Nm(n)})))},n.prototype.Nm=function(t){if(t.userId!==(0,a.k0)().userInfo.UserId){var n=this.props.LocalizedStrings.DesignPage_NavBar_CoAuthor_Section_Screen_Reader.format(t.displayName||t.userId,this.props.Ordinal);return r.createElement(C.k,{ariaLabel:n,displayText:(0,I.c)(t.displayName,t.firstName,t.lastName),email:t.email,key:t.userId,name:t.displayName,tooltip:t.displayName||t.userId})}},n.prototype.rg=function(t){return this.props.IsMobile||(0,m.rA)()||t.Layout===w.RZ.Horizontal&&t.Size===w.h2.Large?{ImageLayout:"Bottom"}:{Height:t.ContainerHeight||(0,c.w_)(),ImageLayout:"Right",Width:t.ContainerWidth||(0,c.Rr)()}},n}(T.r)},70208:function(t,n,e){"use strict";e.d(n,{I:function(){return a}});var i=e(59312),r=e(87363),o=e(58268),s=e(9743),a=(e(64290),function(t){function n(n){var e=t.call(this,n)||this;return e.state={TermUrl:""},e}return(0,i.ZT)(n,t),n.prototype.componentDidMount=function(){var t;t||(t=(0,o.YD)(),this.props.ForceUseCommercialTermsLink?t=(0,o.V9)():this.props.FormMaster&&(t=function(t){if(t.SyncContext!==s.y.AdminPhishingReviewForm&&(t.SyncContext===s.y.SharedTimeForm||t.Model.Settings.IsAnonymous||t.Model.Settings.NotRecordIdentity))return o.ZD;return o.dg}(this.props.FormMaster))),this.setState({TermUrl:t})},n.prototype.render=function(){var t=this.props.LocalizedStrings.TermsLink,n={href:this.state.TermUrl,target:"_blank",tabIndex:this.props.tabIndex,"aria-label":t};return r.createElement("a",(0,i.pi)({},n),this.props.LocalizedStrings.TermsLink)},n}(e(23112).r))},90927:function(t,n,e){"use strict";e.d(n,{w:function(){return m}});var i=e(59312),r=e(87363),o=e(69065),s=e(80820),a=e(51531),u=e(29559),c=e(46407),l=e(9947),f=e(7645),h=e(43367),d=e(90710),m=(e(64290),function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.vo=!0,n.cg=new Image,n}return(0,i.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this,n=this.props.ThemeMaster;n&&(this.lg=function(n){n.NewValues.Name===(0,f.pm)().Customized_Theme_Name&&n.NewValues.BackgroundImage!==t.state.ImageUrl?t.setState({ImageUrl:n.NewValues.BackgroundImage,IsBackgroundImgCached:!1}):t.forceUpdate()},n.observe(this.lg))},n.prototype.componentWillUnmount=function(){var t=this.props.ThemeMaster;this.vo=!1,t&&t.unobserve(this.lg)},n.prototype.render=function(){var t,e=this,i=this.props.ThemeMaster;if(!(t=(0,a.o)()&&(0,l.k0)().themeInfo||(0,d.NW)().oembedocv&&(0,l.k0)().themeInfo?n.getSPOTheme((0,l.k0)().themeInfo):i&&i.Model))return null;var o=t.Name,c=t.PrimaryColor,m=t.SecondaryColor,v=t.BackgroundColor,g=t.BackgroundImage;(g=(0,h.getIoCThemeBackground)(g))&&g.match("url((.*))")&&(g=g.substring(4,g.length-1)),o===(0,f.pm)().Customized_Theme_Name&&g&&(this.state.IsBackgroundImgCached||(this.cg.src=g,this.cg.onload=function(t){e.vo&&e.setState({ImageUrl:g,IsBackgroundImgCached:!0})},g+="_mo"));var p="";if(p+=".office-form-theme-primary-color { color:".concat(c,"; }"),p+=".office-form-theme-secondary-color { color:".concat(m,"; }"),p+=".office-form-theme-primary-background { background:".concat(c,"; color:").concat(s.Ej,"; }"),p+=".office-form-theme-secondary-background { background:".concat(m,"; }"),p+=".office-form-theme-primary-foreground, ",p+=".office-form-theme-primary-foreground a, ",p+=".office-form-theme-primary-foreground.rateit .rateit-selected, ",p+=".office-form-theme-primary-foreground.rateit .rateit-hover",p+="{ color:".concat(c,"; } "),p+=".office-form-theme-border-top { border-top-color:".concat(c,"; }"),p+=".office-form-theme-border-bottom-for-mobile { border-bottom-color:".concat(c,"; }"),p+=".office-form-theme-spinner { border-color:".concat(c," #C7E0F4 #C7E0F4;}"),p+=".office-form-theme-border { border-color:".concat(c,";}"),p+=".office-form-theme-interactive-background.active { background-color:".concat(c,"; }"),p+=".office-form-theme-interactive-background:hover { background-color:".concat(m,"; }"),p+=".office-form-theme-interactive-background:focus { background-color:".concat(m,"; }"),p+=".office-form-theme-interactive-background:active { background-color:".concat(m,"; }"),p+=".office-form-theme-button-lightbackground { color:".concat(c,"; }"),p+=".office-form-theme-button-lightbackground.active { background-color:".concat(m,"; }"),p+=".office-form-theme-interactive-color { color:".concat(c,"; }"),p+=".office-form-theme-interactive-color:hover { color:".concat(m,"; }"),p+=".office-form-theme-interactive-color:focus { color:".concat(m,"; }"),p+=".office-form-theme-interactive-color:active { color:".concat(m,"; }"),p+=".office-form-theme-button { color: white; background:".concat(c,"; }"),p+=".office-form-theme-button:hover { background:".concat(m,"; }"),p+=".office-form-theme-button:focus { background:".concat(m,"; }"),p+=".office-form-dark-theme-button {color:".concat(m,"}"),p+=".office-form-dark-theme-button:hover { color:".concat(m,"; }"),p+=".office-form-dark-theme-button:focus { color:".concat(m,"; }"),p+=".office-form-theme-page-background-active.active { background :"+"".concat(c,"; color: ").concat(s.Ej,"; }"),p+=".office-form-theme-page-foreground-active.active, ",p+=".office-form-theme-select-color.active *{ color: ".concat(c,"; }"),p+=".office-form-theme-toggle.active { background: "+"".concat(c,"; border-color:").concat(c,"; }"),p+=".office-form-theme-border { border-color:".concat(c,"; }"),p+=".office-form-theme-outline { outline-color:".concat(c,"; }"),p+=".office-form-theme-button-foreground.active,.office-form-theme-button-foreground.touch.active:hover { color: white; background: "+"".concat(c,"; outline-color:").concat(c,"; }"),p+=".office-form-theme-button-foreground.active:hover { background: "+"".concat(m,"; outline-color:").concat(m,"; }"),p+=".office-form-theme-quiz-point { color:".concat(m,"; }"),p+=".office-form-theme-quiz-totalPoints-bar {color:".concat(c,"; }"),p+=".office-form-theme-image-question-background, .office-form-theme-video-question-background { background-color: "+"".concat(v,"; outline: 1px solid transparent; }"),p+=".office-form-theme-image-container-border { border: 3px solid "+"".concat(v,"; }"),p+=".office-form-sortable-chosen .office-form-sort-item "+"{ background: ".concat(c,"; color:white; }"),p+=".office-form-theme-sort-item { color: white; background:".concat(c,"; }"),p+=".office-form-theme-sort-item:hover { background:".concat(m,"; }"),p+=".office-form-theme-focus-border .office-form-textfield-input:focus,.office-form-theme-focus-border .form-control:focus,.office-form-theme-focus-border .select-control:focus,.office-form-theme-focus-border .picker--focused .picker__holder:focus,.roosterjs-editor-box:focus { border-color: "+"".concat(c,"; outline-color:").concat(c,"; }"),p+=".office-form-theme-bgcolor-hover:hover { background:".concat(v,"; }"),p+=".office-form-theme-button-color:hover *{ color:".concat(m,"; }"),p+=".form-intelligence-question-row.office-form-intelligence-theme-li { outline: 1px solid "+"".concat(m,"; background-color:").concat(v,";}")+".form-intelligence-question-row:hover {background-color:".concat(v,";}"),p+=".form-intelligence-question-row.mobile-office-form-intelligence-theme-li { outline: 1px solid "+"".concat(c,"; background-color:").concat(v,"; color:").concat(c,";}"),p+=".office-form-insight-theme-control .simple-data-control-content { color : "+"".concat(c,"; }"),p+=".office-form-insight-theme-control .simple-data-control-description { color : "+"".concat(c,"; }"),p+=".office-form-insight-theme-control .simple-data-control-description:hover { color : "+"".concat(m,"; }"),p+=".office-form-insight-theme-control .simple-data-control-description:focus { color : "+"".concat(m,"; }"),p+=".office-form-insight-theme-control .simple-data-control-description:active { color : "+"".concat(m,"; }"),p+=".office-form-info-container .office-form-info-children.office-form-theme-spo-link { color: "+"".concat(c,"; }"),p+=".office-form-info-container .office-form-info-children.office-form-theme-spo-link:hover"+"{color:".concat(m,"; }"),p+=".office-form-spo-embed .office-form-footer-block .office-form-theme-spo-link { color: "+"".concat(c,"; }"),p+=".office-form-spo-embed .office-form-footer-block .office-form-theme-spo-link:hover { color: "+"".concat(m,"; }"),p+=".office-form-theme-spo-link { color:".concat(c,"; }"),p+=".office-form-theme-spo-link:hover { color:".concat(m,"; }"),c){var b=c;b.startsWith("#")&&(b=b.substring(1)),b.length>6&&(b=b.substring(0,6)),p+=".office-form-theme-progress-bar-background { background: #".concat(b,"0D; }")}return(0,a.o)()||(g?(p+=".thank-you-page-content { opacity:.97; }",p+=".introduction-for-responser-container { opacity:.97; }",(0,u.tq)()?(p+=".office-form-theme-page-background { background-color:".concat(v,"; }"),p+=".office-form-theme-footer { background: rgba(255,255,255,.4); }"):(p+=".office-form-theme-page-background { background-image: url("+"".concat(g,"); }"),p+=".office-form-theme-footer { background: rgba(244,244,244,.8); }"),p+=".preview-mobile-container.office-form-theme-page-background { background:"+"".concat(v,"; }"),p+=".preview-mobile-container .office-form-theme-footer { background: rgba(255,255,255,.4); }"):(p+=".office-form-theme-footer { background : rgba(255,255,255,.4); }",p+=".office-form-theme-page-background { background-color:".concat(v,"; }"))),p+=".office-form-theme-shadow { box-shadow: 0 0.8px 1.8px 0 rgba(0, 0, 0, 0.132), 0 0.15px 0.45px 0 rgba(0, 0, 0, 0.132); }",o===(0,f.pm)().Customized_Theme_Name&&(p+=".office-form-body { opacity: 0.97; }"),p+=(0,h.getIoCThemeStyle)(t),r.createElement("style",null,p)},n.getSPOTheme=function(t){var n=(0,o.sL)(t);return{BackgroundColor:(0,o.zn)(n),BackgroundImage:null,Name:c.FP,PrimaryColor:n,SecondaryColor:(0,o.Mk)(n),Thumbnail:null}},n}(e(23112).r))},20966:function(t,n,e){"use strict";e.d(n,{F:function(){return w}});var i=e(59312),r=e(87363),o=e(12611),s=e(60211),a=e(29559),u=e(262),c=e(55411),l=e(73252),f=e(77356),h=e(61018),d=e(60299),m=e(24497),v=e(24513),g=e(64290),p=e(65863),b=e(23112),y=e(932),w=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.fg=r.createRef(),n.om=r.createRef(),n.Uv=400,n.jv=function(){var t=[];t.push({content:n.props.Title}),t.push({content:"\n"}),t.push({content:n.props.SubTitle});var e={chunks:t,title:""},i={uiLang:(0,c.Kc)()||navigator.language};(0,h.d8)().getImmersiveReaderToken().then((function(t){t&&ImmersiveReader&&ImmersiveReader.launchAsync(t,null,e,i)}))},n}return(0,i.ZT)(n,t),n.prototype.componentDidMount=function(){return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){return(0,f.z)($(this.fg.current)),(0,f.z)($(this.om.current)),this.hg(),[2]}))}))},n.prototype.componentDidUpdate=function(){(0,f.z)($(this.fg.current)),(0,f.z)($(this.om.current)),this.hg()},n.prototype.render=function(){var t=o.extend({},this.props.HTMLAttributes);t.className=(0,u.j)(t.className,"office-form-title-container");var n=this.mg(),e=(0,u.j)(this.props.TitleId,document.getElementById(v.a)&&v.a);return r.createElement("div",{className:"office-form-title-content","aria-labelledby":n?null:e,role:n?null:"group"},r.createElement("div",(0,i.pi)({},t),this.Fa(),this.vg(),"Bottom"===this.props.MediaLayout?this.props.children:void 0),!this.mg()&&r.createElement("div",{className:"office-form-title-ir-container"},this.gg(),this.yg()))},n.prototype.Fa=function(t){var n,e="office-form-title-box";return"Bottom"!==this.props.MediaLayout&&(e="".concat(e," ").concat(this.props.MediaLayout.toLowerCase()),n=this.props.children),r.createElement("div",{className:e},n,this.Sg())},n.prototype.Sg=function(){var t=this,n=o.extend({},this.props.HTMLPropsForInnerElement),e=this.props.Heading||1;return n.className=(0,u.j)("office-form-title",n.className,"heading-".concat(e),2===this.props.Heading&&"office-form-theme-secondary-color",!this.props.Title&&"empty-title"),(0,g.pd)((function(){var e={RenderMode:"RichText",Text:(0,m.wg)(t.props.Title,t.props.RichTitle),ContainsHtml:!0};return r.createElement("div",(0,i.pi)({},n,{ref:t.om}),r.createElement(p.D,(0,i.pi)({},e)),t.mg()&&t.gg(),n.children)}),g.t1)},n.prototype.hg=function(){2===this.props.Heading&&document.getElementById(v.a)&&$(this.om.current).attr("aria-labelledby",v.a)},n.prototype.yg=function(){return(0,a.w1)()||(0,s.x8)()||this.props.Heading>1?null:(0,d.V)({ImmersiveReaderToggleProps:(0,i.pi)({},this.props.ImmersiveReaderToggleProps)})},n.prototype.gg=function(){var t;return(0,a.w1)()||(0,s.x8)()||(0,l._y)()||!(null===(t=this.props.ImmersiveReaderToggleProps)||void 0===t?void 0:t.ShouldShowImmersiveReaderButtons)?null:r.createElement(y.$,{onClick:o.debounce(this.jv,this.Uv,!0),whiteIcon:!this.mg(),className:!this.mg()&&"office-form-theme-button"})},n.prototype.vg=function(){if(this.props.SubTitle){var t={RenderMode:"RichText",Text:(0,m.wg)(this.props.SubTitle,this.props.RichSubtitle),ContainsHtml:!0};return r.createElement("div",{className:"office-form-subtitle heading-".concat(this.props.Heading||1),ref:this.fg},r.createElement(p.D,(0,i.pi)({},t)))}},n.prototype.mg=function(){return 2===this.props.Heading},n}(b.r)},49221:function(t,n,e){"use strict";e.d(n,{k:function(){return o}});var i=e(87363),r=e(3424);function o(t){var n=i.createRef(),e=i.createRef(),o=t.IsMobile,s=t.VideoUrl,a=o?"mobile-youtube":"pc-youtube";return a=t.InDesignMode?"design-question-title-youtube-placeholder ".concat(a):"office-form-title-youtube-placeholder ".concat(a),i.createElement("div",{className:a},i.createElement("div",{className:"question-title-youtube-title"},i.createElement("a",{className:"question-title-youtube-link",href:s,rel:"noreferrer",target:"_blank"},s)),i.createElement("div",{className:"question-title-youtube-tip"},i.createElement("span",{className:"question-title-youtube-tip-text"},t.LocalizedStrings.DesignPage_Youtube_Disabled_Launch_Tip),!o&&i.createElement(r.F,{FluentIcon:"Info",HTMLAttributes:{className:"forms-icon-size12x12 question-title-youtube-tip-icon",onMouseOver:function(){var t=$(n.current&&n.current.getHtmlElement()),i=$(e.current);t&&i&&i.css({left:t.offset().left+t.width()/2,top:t.offset().top+t.width()/2})}},ref:n}),i.createElement("span",{className:"question-title-youtube-hover-tip ms-Icon",ref:e},t.LocalizedStrings.DesignPage_Youtube_Disabled_Hover_Tip)))}},17111:function(t,n,e){"use strict";function i(t,n,e,i){var r=new Clipboard(t);return r.on("success",(function(t){n(),i&&t.clearSelection()})),r.on("error",(function(){e()})),r}e.d(n,{w:function(){return i}})},63481:function(t,n,e){"use strict";e.d(n,{Vh:function(){return f},b6:function(){return a},cz:function(){return u},mZ:function(){return s},nP:function(){return l},r8:function(){return c},su:function(){return o}});var i,r=e(12611);e(56117);function o(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];if(t&&document.activeElement&&t.contains(document.activeElement)){var i=$(":focusable");n&&n.forEach((function(t){i=i.not((function(n,e){return t.contains(e)}))}));var r=i.index(document.activeElement);if(!(r<0)){for(var o=r+1;o<i.length;++o){var s=i[o];if(!t.contains(s)&&!d(s))return void i[o].focus()}for(o=r-1;o>=0;--o){s=i[o];if(!t.contains(s)&&!d(s))return void i[o].focus()}}}}function s(t){$(t).on("keydown",h)}function a(t){$(t).off("keydown",h)}function u(t,n){i||(i={}),i[t]||delete i[t],i[t]=n}function c(t){i&&i[t]&&(i[t](),delete i[t])}function l(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];var i=$(t).find(":focusable");n&&n.forEach((function(t){i=i.not((function(n,e){return t.contains(e)}))})),i[i.length-1].focus()}function f(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];var i=$(t).find(":focusable");n&&n.forEach((function(t){i=i.not((function(n,e){return t.contains(e)}))})),i.length>0&&i[0].focus()}function h(t){if(9===t.keyCode){t.stopPropagation(),t.preventDefault();var n=$(this),e=r.union(n.filter(":focusable").toArray(),n.find(":focusable").toArray()),i=e.indexOf(document.activeElement);if(!(i<0)){var o=r.union(e.slice(i+1),e.slice(0,i));t.shiftKey&&o.reverse(),o.push(e[i]);var s=r.find(o,(function(t){return!d(t)}));s&&s.focus()}}}function d(t){var n=Number(t.getAttribute("tabindex"));return!isNaN(n)&&n<0}},73546:function(t,n,e){"use strict";e.d(n,{j:function(){return r}});var i=e(72377);function r(){return i.Pv.Resolve("ILogger")}},15321:function(t,n,e){"use strict";e.d(n,{c:function(){return r}});var i=e(72377);function r(){return i.Pv.Resolve(22)}},72377:function(t,n,e){"use strict";e.d(n,{Pv:function(){return o},gX:function(){return s}});var i=function(){function t(){this.Cg=!1,this.Tg=!1}return t.prototype.UsingSingleton=function(t){return this.kg(t,!0)},t.prototype.UsingFactory=function(t){return this.kg(t,!1)},t.prototype.Create=function(){return this.Cg?(this.xg||(this.xg=this.Fg()),this.xg):this.Fg()},t.prototype.kg=function(t,n){return this.Cg=n,this.Pg=t,this},t.prototype.Fg=function(){if(this.Tg)throw Error("Circular dependency detected ");this.Tg=!0;var t=this.Pg();return this.Tg=!1,t},t}(),r=function(){function t(){this.Dg={}}return t.prototype.Add=function(t,n){this.Dg[t]=n},t.prototype.Get=function(t){return this.Dg[t]},t}(),o=new(function(){function t(){this.Mg=new r}return t.prototype.Resolve=function(t){var n,e=this.Mg.Get(t);if(!e)throw Error("Failed to resolve ".concat(t,", make sure you have registered it by calling Register()"));try{n=e.Create()}catch(n){throw Error("Exception when resolving ".concat(t,": ").concat(n))}return n},t.prototype.Register=function(t){var n=new i;return this.Mg.Add(t,n),n},t}()),s=function(t){return o.Resolve(t)}},76274:function(t,n,e){"use strict";var i=/('[^']*'|"[^"]*")/g,r=/('[^']*'|"[^"]*"|d{1,2}|M{1,2}|y{2,4}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|t{2})/g;function o(t,n){var e=t.toString();if(t<0)return e;if(n&&n>e.length)for(;n>e.length;)e="0"+e;return e}function s(t){return i.test(t)?t.substr(1,t.length-2):t}function a(t,n,e){var i={};return null==t||null==n||null==e?i:(n.split(r).forEach((function(n){var r;switch(n){case"d":case"dd":case"M":case"MM":case"h":case"hh":case"H":case"HH":case"m":case"mm":case"s":case"ss":r=2;case"yy":case"yyy":case"yyyy":r=r||4,i[n]=function(t,n){n=n||t.length;var e=t.match(/^\d+/g),i=e&&e[0];return i?i.length<=n?i:i.substr(0,n):""}(t,r),r=i[n].length;break;case"tt":r=0;var o=t.toUpperCase();o.startsWith(e.DateTimeFormat.AMDesignator.toUpperCase())?r=e.DateTimeFormat.AMDesignator.length:o.startsWith(e.DateTimeFormat.PMDesignator.toUpperCase())?r=e.DateTimeFormat.PMDesignator.length:(o.startsWith("AM")||o.startsWith("PM"))&&(r=2),i[n]=t.substr(0,r);break;default:r=0,n=s(n),t.startsWith(n)&&(r=n.length)}t=t.slice(r)})),t.length>0?{}:i)}function u(t,n){var e=parseInt(t.HH||t.H),i=parseInt(t.hh||t.h||t.time||12);if(isNaN(e)&&!isNaN(i)&&i>=1&&i<=12)if(null==t.tt)t.time||(e=0);else switch(t.tt.toUpperCase()){case"AM":case n.DateTimeFormat.AMDesignator.toUpperCase():e=i%12;break;case"PM":case n.DateTimeFormat.PMDesignator.toUpperCase():e=i%12+12}var r=parseInt(t.mm||t.m||t.time||0),o=parseInt(t.ss||t.s||0);return isNaN(e)||isNaN(r)?NaN:1e3*(60*(60*e+r)+o)}Date.prototype.toFormatString=function(t,n){var e=this;return null==e||null==t||null==n?null:t.split(r).map((function(t){switch(t){case"d":case"dd":return o(e.getDate(),t.length);case"ddd":return n.DateTimeFormat.AbbreviatedDayNames[e.getDay()];case"M":case"MM":return o(e.getMonth()+1,t.length);case"MMM":return n.DateTimeFormat.AbbreviatedMonthNames[e.getMonth()];case"yy":var i=e.getFullYear(),r=o(i,4);return i>n.Calendar.TwoDigitYearMax-100&&i<=n.Calendar.TwoDigitYearMax?r.slice(2):r;case"yyy":case"yyyy":case"yyyyy":return o(e.getFullYear(),t.length);case"H":case"HH":return o(e.getHours(),t.length);case"h":case"hh":return o((e.getHours()+11)%12+1,t.length);case"m":case"mm":return o(e.getMinutes(),t.length);case"s":case"ss":return o(e.getSeconds(),t.length);case"t":case"tt":var a=e.getHours()<12?n.DateTimeFormat.AMDesignator:n.DateTimeFormat.PMDesignator;return 1===t.length?a.charAt(0):a;default:return s(t)}})).join("")},Date.prototype.toDateShortString=function(t){return this.toFormatString(t.DateTimeFormat.ShortDatePattern,t)},Date.prototype.toTimeShortString=function(t){return this.toFormatString(t.DateTimeFormat.ShortTimePattern,t)};var c=e(9947);Date.parseDate=function(t,n,e){var i=a(t,n,e),r=parseInt(i.yyyy||i.yyy),o=parseInt(i.yy);if(isNaN(r)&&!isNaN(o))if(o>=100)r=o;else{var s=(0,c.k0)().cultureInfo.Calendar.TwoDigitYearMax%100;r=o<=s?(0,c.k0)().cultureInfo.Calendar.TwoDigitYearMax-s+o:(0,c.k0)().cultureInfo.Calendar.TwoDigitYearMax-s-100+o}var l=parseInt(i.MM||i.M),f=i.MMM;isNaN(l)&&f&&(l=e.DateTimeFormat.AbbreviatedMonthNames.indexOf(f)+1);var h=parseInt(i.dd||i.d),d=u(i,e);if(!(isNaN(r)||isNaN(l)||isNaN(h)||isNaN(d))){var m=new Date(r,l-1,h,0,0,0,d);if(m.getFullYear()===r&&m.getMonth()+1===l&&m.getDate()===h)return m}return null},Date.parseTime=function(t,n,e){var i=a(t,n,e);return i.time=!0,u(i,e)},"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){var t=/function\s([^(]{1,})\(/.exec(this.toString());return t&&t.length>1?t[1].trim():""}});var l=e(93641),f=e.n(l);!function(){var t;if(void 0!==e.g)t=e.g;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;if(n){var i=null;try{i=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===i&&!n.cast&&void 0!==n.prototype.finally)return}t.Promise=f().Promise}(),String.prototype.format||(String.prototype.format=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this.replace(/{(\d+)}/g,(function(n,e){return void 0!==t[e]?t[e]:n}))}),String.prototype.includes||(String.prototype.includes=function(t,n){return void 0===n&&(n=0),-1!==this.indexOf(t,n)}),String.prototype.startsWith=function(t){if(null==t||0===t.length)return!0;var n=this;return!(null==n||n.length<t.length)&&t===n.substr(0,t.length)},String.prototype.endsWith=function(t){if(null==t||0===t.length)return!0;var n=this;return!(null==n||n.length<t.length)&&t===n.substr(n.length-t.length,t.length)},String.prototype.replaceAll=function(t,n){return this.replace(new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),n)},Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t,n){for(var e=0;e<this.length;e++)if(t.call(n,this[e],e,this))return this[e]},configurable:!0,writable:!0});window.Forms={Mru:{},PrintTemplate:{}},window.FormsPro={};var h=e(72377),d=e(35337);function m(){h.Pv.Register("ILazyLoadResourceStringsFunc").UsingSingleton((function(){return d.f}))}m();var v=e(13878);h.Pv.Register("IQuestionDesignerBase").UsingSingleton((function(){return v.oF}));var g=e(87363),p=e(59312),b=e(61533),y=e(12611),w=e.n(y),S=e(83894),N=e(262),C=e(49211),I=e(73252),T=e(7645),k=e(72467),x=e(73293),F=e(67661),P=e(58680),D=e(53315),M=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.getElementTypeName=function(){return"Question.DateTime"},n.createDefaultDefinition=function(){return{Type:n.getElementTypeName(),Title:(0,T.pm)().Question_DefaultTitle,Date:!0,Time:!1,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},n.supportMobileDesign=function(t){return!n.hasInvalidSettingOnMobile(t)},n.prototype.verify=function(t){return this.Model.Required&&!t?D.ej.RequiredError:D.ej.Success},n.prototype.getTypeDisplayName=function(){return(0,T.pm)().QuestionType_DateTime},n}(P.P),L=e(50434),R=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.getElementTypeName=function(){return"Question.FileUpload"},n.createDefaultDefinition=function(){return{Type:n.getElementTypeName(),Title:(0,T.pm)().Question_DefaultTitle,HasSpecificFileType:!1,FileTypes:{Word:!0,Excel:!0,PowerPoint:!0,PDF:!0,Image:!0,Video:!0,Audio:!0},QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1,MaxFileCount:1,MaxFileSize:L.EE[Object.keys(L.EE)[0]]}},n.prototype.verify=function(t){return this.Model.Required&&!t?D.ej.RequiredError:D.ej.Success},n.prototype.getTypeDisplayName=function(){return(0,T.pm)().QuestionType_UploadFile},n}(P.P),A=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.getElementTypeName=function(){return"Question.MatrixChoiceGroup"},n.createDefaultDefinition=function(){var t=[{Description:(0,T.pm)().Designer_Choices_DefaultDescription.format(1),IsGenerated:!0,Id:1,Order:1},{Description:(0,T.pm)().Designer_Choices_DefaultDescription.format(2),IsGenerated:!0,Id:2,Order:2},{Description:(0,T.pm)().Designer_Choices_DefaultDescription.format(3),IsGenerated:!0,Id:3,Order:3},{Description:(0,T.pm)().Designer_Choices_DefaultDescription.format(4),IsGenerated:!0,Id:4,Order:4},{Description:(0,T.pm)().Designer_Choices_DefaultDescription.format(5),IsGenerated:!0,Id:5,Order:5}];return{Type:n.getElementTypeName(),Title:(0,T.pm)().Question_DefaultTitle,ChoiceGroup:t,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},n.createSubQuestionsDefinition=function(){return[{Title:(0,T.pm)().Desinger_Likert_DefaultDescription.format(1),Type:"Question.MatrixChoice"},{Title:(0,T.pm)().Desinger_Likert_DefaultDescription.format(2),Type:"Question.MatrixChoice"}]},n.prototype.verify=function(t){return D.ej.Success},n.prototype.getTypeDisplayName=function(){return(0,T.pm)().QuestionType_Likert},n.prototype.hasAnswer=function(){return!1},n}(P.P),E=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.getElementTypeName=function(){return"Question.NPS"},n.createDefaultDefinition=function(){return{Type:n.getElementTypeName(),Title:(0,T.pm)().NPS_DefaultTitle,LeftDescription:(0,T.pm)().NPS_LeftDescription,RightDescription:(0,T.pm)().NPS_RightDescription,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},n.prototype.verify=function(t){return this.Model.Required&&!t&&0!==t?D.ej.RequiredError:D.ej.Success},n.prototype.getTypeDisplayName=function(){return(0,T.pm)().QuestionType_NPS},n.prototype.isNumberType=function(){return!0},n}(P.P),O=e(97265),_=e(26203),B=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.getElementTypeName=function(){return"Question.Ranking"},n.createDefaultDefinition=function(){var t=[{Description:(0,T.pm)().Designer_Choices_DefaultDescription.format(1),Order:1,Key:(0,O.GW)()},{Description:(0,T.pm)().Designer_Choices_DefaultDescription.format(2),Order:2,Key:(0,O.GW)()},{Description:(0,T.pm)().Designer_Choices_DefaultDescription.format(3),Order:3,Key:(0,O.GW)()}];return{Type:n.getElementTypeName(),Title:(0,T.pm)().Question_DefaultTitle,AllowMultipleValues:!0,ChoiceGroup:t,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},n.prototype.verify=function(t){return!this.Model.Required||t&&0!==t.length?D.ej.Success:D.ej.RequiredError},n.prototype.getTypeDisplayName=function(){return(0,T.pm)().QuestionType_Ranking},n.prototype.isCorrectAnswer=function(t){var n=this;if(!t)return!1;var e,i=JSON.parse(this.Model.GradingBasis);e=y.isString(t)?JSON.parse(t):y.map(y.sortBy(t,(function(t){return t.answerOrder})),(function(t){return t.id}));var r=y.map(i,(function(t){return y.findWhere(n.Model.ChoiceGroup,{Key:t}).Id}));return e.length===r.length&&y.isEqual(r,e)},n.prototype.createQuizResult=function(t){if(this.Model.IsQuiz)return{IsAnswerCorrect:this.isCorrectAnswer(t),GradingBasis:this.Model.GradingBasis}},n.prototype.autoGradeAnswer=function(t){var n=this.Model.Point||0;t.Score=this.isCorrectAnswer(t.Answer)?n:0,t.IsAutoGraded=!0},n.prototype.autoGradeWithQuizResult=function(t,n){return n?n.IsAnswerCorrect?this.Model.Point:0:null},n.prototype.getNormalizedAnswer=function(t){return t||[]},n.prototype.hasCorrectAnswers=function(t){return!0},n.prototype.redressGradingBasis=function(){var t=this;this.Master.fieldsReady([(0,k.zE)().Schema.ChoiceGroup,(0,k.zE)().Schema.GradingBasis]).then((function(){var n=_.d.convertToArray(t.Master.Model.ChoiceGroup).sort((function(t,n){return t.Order-n.Order})).map((function(t){return t.Key}));t.Master.Model.GradingBasis=JSON.stringify(n)}))},n}(P.P),H=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.getElementTypeName=function(){return"Question.Rating"},n.createDefaultDefinition=function(){return{Type:n.getElementTypeName(),Title:(0,T.pm)().Question_DefaultTitle,Length:5,RatingShape:D.le.Star,LeftDescription:"",RightDescription:"",MinRating:1,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},n.supportMobileDesign=function(t){return!n.hasInvalidSettingOnMobile(t)&&!t.ShowRatingLabel},n.prototype.verify=function(t){return this.Model.Required&&!t?D.ej.RequiredError:D.ej.Success},n.prototype.getTypeDisplayName=function(){return(0,T.pm)().QuestionType_Rating},n.prototype.isNumberType=function(){return!0},n}(P.P),G=e(62715),q=e(31442),V=e(3424),z=e(42605),Q=e(48280),U=e(77309),j=e(8214),W=e(47601),K=e(25038),J=e(23112),Z=e(41360),X=e(687),Y=e(76795),tt=e(64459);var nt=e(13886),et=e(64290),it=e(91367);function rt(t){return function(t,n){var e=null!=n?n:(0,T.pm)();switch(t){case"Between":return e.NumberValidationBetween;case"Equal":return e.NumberValidationEqual;case"Greater":return e.NumberValidationGreater;case"GreaterOrEqual":return e.NumberValidationGreaterOrEqual;case"Less":return e.NumberValidationLess;case"LessOrEqual":return e.NumberValidationLessOrEqual;case"None":return e.NumberValidationNone;case"NotBetween":return e.NumberValidationNotBetween;case"NotEqual":return e.NumberValidationNotEqual;case"OnlyNumber":return e.NumberValidationOnlyNumber;case"RuleEnum_None":return e.NumberValidationRuleEnum_None;case"RuleError":return e.NumberValidationRuleError;case"_Between_Label":return e.NumberValidation_Between_Label;case"_Checkbox_Description":return e.NumberValidation_Checkbox_Description;case"_DropDown_Hint":return e.NumberValidation_DropDown_Hint;case"_ErrorMessage_Between":return e.NumberValidation_ErrorMessage_Between;case"_ErrorMessage_Equal":return e.NumberValidation_ErrorMessage_Equal;case"_ErrorMessage_Greater":return e.NumberValidation_ErrorMessage_Greater;case"_ErrorMessage_GreaterOrEqual":return e.NumberValidation_ErrorMessage_GreaterOrEqual;case"_ErrorMessage_Less":return e.NumberValidation_ErrorMessage_Less;case"_ErrorMessage_LessOrEqual":return e.NumberValidation_ErrorMessage_LessOrEqual;case"_ErrorMessage_None":return e.NumberValidation_ErrorMessage_None;case"_ErrorMessage_NotBetween":return e.NumberValidation_ErrorMessage_NotBetween;case"_ErrorMessage_NotEqual":return e.NumberValidation_ErrorMessage_NotEqual;case"_Rule_Button_From_Label":return e.NumberValidation_Rule_Button_From_Label;case"_Rule_Button_To_Label":return e.NumberValidation_Rule_Button_To_Label;case"_Rule_Description_Label":return e.NumberValidation_Rule_Description_Label;default:return""}}(D.pW[t])}function ot(t){return function(t,n){var e=null!=n?n:(0,T.pm)();switch(t){case"Custom":return e.ValidationTypeCustom;case"Email":return e.ValidationTypeEmail;case"Number":return e.ValidationTypeNumber;default:return""}}(D.PA[t])}var st=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.getElementTypeName=function(){return"Question.TextField"},n.createDefaultDefinition=function(){return n.createDefaultSingleLineDefinition()},n.createDefaultSingleLineDefinition=function(){return{Type:n.getElementTypeName(),Title:(0,T.pm)().Question_DefaultTitle,Multiline:!1,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},n.supportMobileDesign=function(t){return!n.hasInvalidSettingOnMobile(t)&&!t.IsNumber},n.prototype.verify=function(t){var n=t;if(this.Model.IsMathQuiz&&n){var e=(0,tt.d)(t);if((n=null==e.Answer?t:e.Answer).length>(0,X.xZ)())return D.ej.MathLengthError}return this.Model.Required&&!n?D.ej.RequiredError:n&&this.Model.IsNumber&&!this.Lg(n)?D.ej.NumberValidationError:D.ej.Success},n.prototype.getTypeDisplayName=function(){return this.Model.Multiline?(0,T.pm)().QuestionType_MultiLineText:this.Model.IsNumber?(0,T.pm)().Common_Number_Text:(0,T.pm)().QuestionType_SingleLineText},n.prototype.isNumberType=function(){return!!this.Model.IsNumber},n.prototype.justifyNumberBoundaries=function(){var t=this;this.Master.bulkEdit((function(){var n=t.Master.Model,e=(0,nt.Q5)(n.NumberMinBoundary)||"1",i=(0,nt.Q5)(n.NumberMaxBoundary)||"10";switch(n.NumberValidationRule){case D.pW.Greater:case D.pW.GreaterOrEqual:case D.pW.Equal:case D.pW.NotEqual:i=null;break;case D.pW.Less:case D.pW.LessOrEqual:e=null;break;case D.pW.Between:case D.pW.NotBetween:if(parseFloat(e)>parseFloat(i)){var r=e;e=i,i=r}}n.NumberMinBoundary=e,n.NumberMaxBoundary=i}))},n.prototype.getValidationErrorMessage=function(t,n){},n.prototype.getNumberValidationErrorMessage=function(t){var n=this.Model.NumberValidationRule;if(null!=n){var e=function(t,n){var e=null!=n?n:(0,T.pm)();switch(t){case"Between":return e.NumberValidation_ErrorMessage_Between;case"Equal":return e.NumberValidation_ErrorMessage_Equal;case"Greater":return e.NumberValidation_ErrorMessage_Greater;case"GreaterOrEqual":return e.NumberValidation_ErrorMessage_GreaterOrEqual;case"Less":return e.NumberValidation_ErrorMessage_Less;case"LessOrEqual":return e.NumberValidation_ErrorMessage_LessOrEqual;case"None":return e.NumberValidation_ErrorMessage_None;case"NotBetween":return e.NumberValidation_ErrorMessage_NotBetween;case"NotEqual":return e.NumberValidation_ErrorMessage_NotEqual;default:return""}}(D.pW[n],t);return null==e?void 0:e.format(this.Model.NumberMinBoundary,this.Model.NumberMaxBoundary)}},n.prototype.hasCorrectAnswers=function(t){return!(!this.Model.IsQuiz||this.Model.Multiline)&&new it.E(t||this.Model).areAnyAnswersDefined()},n.prototype.isCorrectAnswer=function(n){return this.Model.IsQuiz&&!this.Model.Multiline?new it.E(this.Model).isCorrect(n):t.prototype.isCorrectAnswer.call(this,n)},n.prototype.createQuizResult=function(t){if(new it.E(this.Model).areAnyAnswersDefined()&&this.Model.IsQuiz)return{IsAnswerCorrect:this.isCorrectAnswer(t),GradingBasis:this.Model.GradingBasis}},n.prototype.autoGradeAnswer=function(n){if(this.Model.IsQuiz&&!this.Model.Multiline){var e=new it.E(this.Model);if(e.areAnyAnswersDefined()){var i=this.Model.Point?this.Model.Point:0;n.Score=e.isCorrect(n.Answer)?i:0,n.IsAutoGraded=!0}else t.prototype.autoGradeAnswer.call(this,n)}else t.prototype.autoGradeAnswer.call(this,n)},n.prototype.autoGradeWithQuizResult=function(n,e){return e?this.Model.IsQuiz&&!this.Model.Multiline?e.IsAnswerCorrect?this.Model.Point:0:t.prototype.autoGradeWithQuizResult.call(this,n,e):null},n.prototype.Rg=function(t,n){return void 0===t||""===t||!!n.test(t)},n.prototype.Lg=function(t){if(void 0===t||""===t)return!0;if(!(0,nt.ZR)(t))return!1;var n=parseFloat((0,nt.Q5)(t)),e=parseFloat(this.Model.NumberMinBoundary),i=parseFloat(this.Model.NumberMaxBoundary);switch(this.Model.NumberValidationRule){case D.pW.None:return!0;case D.pW.Between:return n>=e&&n<=i;case D.pW.NotBetween:return!(n>=e&&n<=i);case D.pW.Greater:return n>e;case D.pW.GreaterOrEqual:return n>=e;case D.pW.Less:return n<i;case D.pW.LessOrEqual:return n<=i;case D.pW.Equal:return n===e;case D.pW.NotEqual:return n!==e;default:return!0}},n.prototype.deserializeAnswer=function(t){if(this.Model.IsMathQuiz&&t&&""!=t){var n=(0,tt.d)(t);return this.Model.IsAnswerPlainText=!n.IsMath,null==n.Answer?t:n.Answer}return t},n}(P.P);function at(t){return g.createElement(ut,t)}var ut=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=this.props,n=y.clone(t.HTMLAttributes)||{};return n.className=(0,N.j)("design-insert-card new-margin",n.className),n.onClick=t.onClick,(0,z.F)({ButtonStyle:2,HTMLAttributes:n,FluentIcon:t.FluentIcon,Icon:t.IconClass,IconClassName:t.IconClassName+" design-insert-card-img office-form-theme-primary-foreground",Text:t.DisplayText,TextClassName:"design-insert-card-text",Tooltip:t.DisplayText})},n}(J.r);function ct(){var t=$(window).width();return t<=(0,X.P6)()?2:t<=(0,X.Z1)()?1:0}var lt=function(t){function n(n){var e=t.call(this,n)||this;return e.Ag=g.createRef(),e.panelRef=g.createRef(),e.Eg=g.createRef(),e.Og=g.createRef(),e._g=g.createRef(),e.Bg=g.createRef(),e.Hg=y.uniqueId("insert-card-pane"),e.Gg=e.Gg.bind(e),e.qg=e.qg.bind(e),e.Vg=e.Vg.bind(e),e.Qg=e.Qg.bind(e),e.Ug=e.Ug.bind(e),e.mf=e.mf.bind(e),e.$g=e.$g.bind(e),e.Wg=e.Wg.bind(e),e.Kg=e.Kg.bind(e),e.Jg=e.Jg.bind(e),e.Zg=e.Zg.bind(e),e.onKeyDown=e.onKeyDown.bind(e),e.Xg=e.Xg.bind(e),e.Yg=e.Yg.bind(e),e.As=e.As.bind(e),e.tp=e.tp.bind(e),e.np=e.np.bind(e),e.ep=e.ep.bind(e),e.ip=e.ip.bind(e),e.rp=e.rp.bind(e),e.op=e.op.bind(e),e.sp=e.sp.bind(e),e.state={FocusedOnInsertPanelItem:!1,InsertPanelActiveElementIndex:0,InsertPanelExpanded:!1,MoreQuestionsMenuExpanded:!1,ScreenSize:ct(),ShowLikertTooltip:!1},e.vo=!0,e.props.Form.observe(e.As,[F.x.Schema.ReputationTier]),window.addEventListener("resize",e.Xg),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.vo=!1,this.props.Form.unobserve(this.As),window.removeEventListener("resize",this.Xg)},n.prototype.componentDidUpdate=function(){this.state.FocusedOnInsertPanelItem&&!this.state.MoreQuestionsMenuExpanded&&this.ap(this.state.InsertPanelActiveElementIndex)},n.prototype.componentDidMount=function(){var t=this.panelRef.current;this.up=t?t.getElementsByTagName("button"):[]},n.prototype.render=function(){var t=this.props.Form.Model;if((0,C.w)(this.props.Form,"DisableEditForm")||(0,K.kl)(t.ReputationTier))return null;var n=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:this.state.InsertPanelExpanded?"GlyphOnly":"Horizontal",HTMLAttributes:this.lp(),FluentIcon:"Add",IconClassName:"forms-icon-size20x20",ref:this.Ag,Text:(0,T.pm)().DesignPage_InsertPanel_CreateElement,TextClassName:"button-text"}),e={className:"__insert-pane__ design-view-insert-panel-container",onBlur:this.mf,onKeyUp:this.Ug};return g.createElement("div",(0,p.pi)({},e),g.createElement("div",{className:"design-view-insert-button-group office-form-theme-primary-background",tabIndex:-1},n,this.createPaneContents()),this.props.createSuggestionCard(this.state.InsertPanelExpanded,this.Gg,this.qg))},n.prototype.setFocusOnAddButton=function(){this.Ag.current&&this.Ag.current.focus()},n.prototype.createPaneContents=function(){var t,n=1===this.state.ScreenSize,e=2===this.state.ScreenSize,i=(t=this.props.insertCallback,at({DisplayText:(0,T.pm)().QuestionCategory_Choice,FluentIcon:"Radio Button Filled",IconClassName:"design-insert-card-icon forms-icon-size16x16",key:"choice",onClick:function(){var n=Y.L.createDefaultDefinition();t(n),(0,q.$U)("DesignPage.Questions.Create",{isMathQuiz:!!n.IsMathQuiz,questionType:"choice"})}})),r=function(t){return at({DisplayText:(0,T.pm)().QuestionCategory_Text,FluentIcon:"Text Field",IconClassName:"design-insert-card-icon forms-icon-size20x20",key:"text",onClick:function(){var n=st.createDefaultSingleLineDefinition();t(n),(0,q.$U)("DesignPage.Questions.Create",{isMathQuiz:!!n.IsMathQuiz,questionType:"text"})}})}(this.props.insertCallback),o=!e&&function(t){return at({DisplayText:(0,T.pm)().QuestionCategory_Rating,FluentIcon:"Thumb Like",IconClassName:"thumbUpEmptyIcon forms-icon-size18x18",key:"rating",onClick:function(){var n=H.createDefaultDefinition();t(n),(0,q.$U)("DesignPage.Questions.Create",{questionType:"rating"})}})}(this.props.insertCallback),s=!n&&!e&&function(t){return at({DisplayText:(0,T.pm)().QuestionCategory_DateTime,FluentIcon:"Calendar LTR",IconClassName:"forms-icon-size18x18",key:"dateTime",onClick:function(){var n=M.createDefaultDefinition();t(n),(0,q.$U)("DesignPage.Questions.Create",{questionType:"dateTime"})}})}(this.props.insertCallback);return g.createElement("div",{"aria-orientation":"horizontal",className:this.state.InsertPanelExpanded?"insertPanel":"insertPanel dn",onKeyDown:this.onKeyDown,ref:this.panelRef},i,r,o,s,this.dp(),this.state.ShowLikertTooltip&&this.vp(),this.props.Form.SettingMaster.Model.IsAnonymous&&this.gp())},n.prototype.vp=function(){return g.createElement("div",{className:"teachingUI-likertTooltip",ref:this.Og},g.createElement("div",{className:"teachingUI-likertTooltip-direction-shadow"}),g.createElement("div",{className:"teachingUI-likertTooltip-direction"}),g.createElement("div",{className:"teachingUI-likertTooltip-text"},(0,T.pm)().Likert_Tooltip_Text),g.createElement(Z.z,{className:"teachingUI-likertTooltip-img",src:"/Images/question_backgrounds/likert_tooltip.png","aria-hidden":"true"}),g.createElement(U.L,{HTMLAttributes:{className:"screenReaderVisible","aria-label":(0,T.pm)().Likert_Tooltip_Text},LazyRendering:!0,Role:"Status"}))},n.prototype.lp=function(){var t={"aria-expanded":this.state.InsertPanelExpanded,className:"design-view-insert-panel-button __insert-button__","aria-label":(0,T.pm)().Add_New_Question};return this.props.Form.reachedQuestionNumberLimitation()?(t.className=(0,N.j)(t.className,"add-question-button-disabled"),t.title=(0,T.pm)().DesignPage_LimitMessage_QuestionNumber):(t.className=(0,N.j)(t.className,"office-form-theme-button"),t.onClick=this.Vg,t.onKeyDown=this.Qg,t.onFocus=this.tp),t},n.prototype.Vg=function(){var t,n;this.setState({FocusedOnInsertPanelItem:!this.state.InsertPanelExpanded,InsertPanelExpanded:!this.state.InsertPanelExpanded}),(0,q.$U)("DesignPage.Questions.clickAddNewButton");var e=(0,G.z)(this.props.Form);(0,q.f)("IntelligenceStatistic.QuestionSuggestionPane.Expand",{ActionSubCategory:"AddNew",InsertPanelExpanded:!this.state.InsertPanelExpanded,SuggestionId:null===(t=null==e?void 0:e.Model)||void 0===t?void 0:t.SuggestionId}),(0,q.$U)("Intelligence.QuestionSuggestionPane.Expand",{ActionSubCategory:"AddNew",InsertPanelExpanded:!this.state.InsertPanelExpanded,UserBasedSuggestionId:null===(n=null==e?void 0:e.Model)||void 0===n?void 0:n.UserBasedSuggestionId})},n.prototype.Qg=function(t){switch(t.keyCode){case 9:this.state.InsertPanelExpanded&&(t.stopPropagation(),t.preventDefault(),this.setState({FocusedOnInsertPanelItem:!0}));break;case 13:t.stopPropagation(),t.preventDefault(),this.setState({FocusedOnInsertPanelItem:!this.state.InsertPanelExpanded,InsertPanelExpanded:!this.state.InsertPanelExpanded})}},n.prototype.tp=function(t){t.stopPropagation(),this.setState({FocusedOnInsertPanelItem:!1})},n.prototype.pp=function(){var t,n=1===this.state.ScreenSize,e=2===this.state.ScreenSize,i=[],r=this.bp(!0,"dateTime","Calendar LTR","forms-icon-size16x16",(0,T.pm)().QuestionCategory_DateTime,this.$g);return e?(i.push(this.bp(!0,"rating","Star","forms-icon-size16x16",(0,T.pm)().QuestionCategory_Rating,this.Jg)),i.push(r)):n&&i.push(r),i.push(this.bp(!0,"ranking","Arrow Sort","forms-icon-size18x18",(0,T.pm)().QuestionCategory_Ranking,this.Kg)),i.push(this.bp(!0,"likert","Likert","forms-icon-size18x18",(0,T.pm)().QuestionCategory_Likert,this.Wg)),(0,I.cr)("DesignerFileUpload")&&!(0,S.ro)()&&!1!==(null===(t=(0,k.f5)().Model.FormsTenantSettings)||void 0===t?void 0:t.allowFileUpload)&&i.push(this.yp()),i.push(this.wp()),i.push(g.createElement(j.s,{key:"line-breaker"},(0,Q.Gy)())),i.push(this.bp(!0,"section","Select All Off","forms-icon-size18x18",(0,T.pm)().DesciptiveElementCategory_Section,this.Yg)),i},n.prototype.yp=function(){var t=this,n=this.props.Form,e=n.SettingMaster.Model.IsAnonymous&&!(0,I.cr)("EnableAnonymousUploadLink"),i=e||!n.isFieldReady(F.x.Schema.Id)||!!(0,W.e)(n),r=(0,T.pm)().QuestionCategory_UploadFile,o="".concat(this.Hg,"-fileload-title"),s="".concat(this.Hg,"-tooltip-content");return g.createElement(j.s,{Active:!0,Disabled:i,key:"fileUpload",onClick:function(){(0,L.q2)(t.props.Form,!0);var n=R.createDefaultDefinition();t.props.insertCallback(n),(0,q.$U)("DesignPage.Questions.Create",{questionType:"fileUpload"})},HTMLAttributes:{onMouseLeave:e?this.ip:void 0,onMouseOver:e?this.rp:void 0,title:r,"aria-labelledby":"".concat(o," ").concat(s)}},g.createElement("div",{className:"design-insert-card-dropdown-option"},g.createElement(V.F,{FluentIcon:"Arrow Upload",HTMLAttributes:{className:"design-insert-card-dropdown-img office-form-theme-primary-foreground forms-icon-size18x18"}}),g.createElement("span",{id:o},r),e&&g.createElement(V.F,{FluentIcon:"Question Circle Filled",HTMLAttributes:{className:"forms-icon-size15x15 design-insert-card-warning-icon"},ref:this.Bg})))},n.prototype.gp=function(){var t=(0,T.pm)().SharePane_CollectResponse_DropDownOption2_Title,n="".concat(this.Hg,"-tooltip-content");return g.createElement("div",{className:"design-insert-card-upload-tip",ref:this.Eg,key:"toolTip",id:n},g.createElement("div",{className:"design-insert-card-upload-tip-text"},(0,T.pm)().UploadFile_CardInsert_Tip.format(t)),g.createElement("div",{className:"design-insert-card-beak"}),g.createElement("div",{className:"design-insert-card-beak-shadow"}))},n.prototype.rp=function(t){var n=$(this.Eg.current),e=this.Bg.current&&$(this.Bg.current.getHtmlElement());n.css({display:"inline-block",left:(e?e.offset().left:0)-(n.width()-(e?e.width():0))/2,top:(e?e.offset().top:0)-n.height()})},n.prototype.ip=function(t){this.Eg.current&&$(this.Eg.current).css("display","none")},n.prototype.sp=function(){var t=this;this.setState({ShowLikertTooltip:!0},(function(){var n=$(t._g.current.getHtmlElement()),e=$(t.Og.current),i=n.offset().left+124,r=n.offset().top-54;document.body.clientWidth<1300&&(i=n.offset().left-383),e.css({left:i,top:r})}))},n.prototype.op=function(){this.setState({ShowLikertTooltip:!1})},n.prototype.Cp=function(t,n,e,i,r,o,s){var a=(0,V.M)({FluentIcon:"Info",HTMLAttributes:{className:"forms-icon-size15x15 teachingUI-likertTooltip-warning-icon"},key:"likertTooltipIcon",ref:this._g});return g.createElement(j.s,{Active:t,Disabled:s,key:n,onClick:o,HTMLAttributes:{"aria-label":r,onMouseLeave:this.op,onMouseOver:this.sp,onFocus:this.sp,onBlur:this.op,title:r}},g.createElement("div",{className:"design-insert-card-dropdown-option"},g.createElement(V.F,{FluentIcon:e,HTMLAttributes:{className:i}}),g.createElement("span",null,r),a))},n.prototype.bp=function(t,n,e,i,r,o,s){var a=(0,N.j)("design-insert-card-dropdown-img office-form-theme-primary-foreground",i);return"likert"===n?this.Cp(t,n,e,a,r,o,s):g.createElement(j.s,{Active:t,Disabled:s,key:n,onClick:o,HTMLAttributes:{"aria-label":r}},g.createElement("div",{className:"design-insert-card-dropdown-option"},g.createElement(V.F,{FluentIcon:e,HTMLAttributes:{className:a}}),g.createElement("span",null,r)))},n.prototype.wp=function(){var t=this;return this.bp(!0,"nps","Top Speed","forms-icon-size18x18",(0,T.pm)().QuestionCategory_NPS,(function(){var n=E.createDefaultDefinition();t.props.insertCallback(n),(0,q.$U)("DesignPage.Questions.Create",{questionType:"NPS"})}))},n.prototype.Gg=function(){this.setState({InsertPanelExpanded:!1})},n.prototype.qg=function(){this.setState({InsertPanelExpanded:!0})},n.prototype.mf=function(t){var n=this,e=b.findDOMNode(this);setTimeout((function(){n.vo&&!e.contains(document.activeElement)&&n.state.InsertPanelExpanded&&n.setState({FocusedOnInsertPanelItem:!1,InsertPanelExpanded:!1})}),0)},n.prototype.$g=function(){var t=M.createDefaultDefinition();this.props.insertCallback(t),(0,q.$U)("DesignPage.Questions.Create",{questionType:"dateTime"})},n.prototype.Kg=function(){var t=B.createDefaultDefinition();this.props.insertCallback(t),(0,q.$U)("DesignPage.Questions.Create",{questionType:"ranking"})},n.prototype.Jg=function(){var t=H.createDefaultDefinition();this.props.insertCallback(t),(0,q.$U)("DesignPage.Questions.Create",{questionType:"rating"})},n.prototype.Wg=function(){var t=A.createDefaultDefinition(),n=A.createSubQuestionsDefinition();this.props.insertCallback(t,n),(0,q.$U)("DesignPage.Questions.Create",{questionType:"likert"})},n.prototype.Yg=function(){this.Zg()},n.prototype.Zg=function(){var t=(0,x.Kb)();this.props.insertCallback(t),(0,q.$U)("DesignPage.Section.Create",{elementType:"section"});var n=this.props.Form;"survey"===n.Model.Type&&2===n.totalSectionCount()&&((0,q.$U)("DesignPage.Setting.ProgressBarEnabled"),n.Model.ProgressBarEnabled="true")},n.prototype.Tp=function(t,n,e){var i=this.pp();this.state.MoreQuestionsMenuExpanded&&(t=(0,N.j)(t,"active"),n=(0,N.j)(n,"active"));var r={className:n},o={"aria-label":(0,T.pm)().QuestionCard_Menu_Tooltip,children:g.createElement(V.F,{FluentIcon:e,HTMLAttributes:r}),className:"design-insert-card-more-button",title:(0,T.pm)().QuestionCard_Menu_Tooltip};return g.createElement(Q.Th,{ButtonStyle:2,MenuItemType:0,ClassName:"design-insert-card-more-menu",ClassNameForContainer:t,HTMLAttributes:o,onMenuCollapse:this.np,onMenuExpand:this.ep,onMenuItemMouseOver:this.rp,onMenuItemMouseLeave:this.ip},i)},n.prototype.dp=function(){return this.Tp("design-insert-card-more-exp-container office-form-theme-button-lightbackground","forms-icon-size18x18 office-form-theme-primary-color","Chevron Down")},n.prototype.np=function(){this.setState({MoreQuestionsMenuExpanded:!1}),this.Og.current&&this.op()},n.prototype.ep=function(){this.setState({MoreQuestionsMenuExpanded:!0}),(0,q.$U)("DesignPage.onMoreQuestionsMenuEvent")},n.prototype.onKeyDown=function(t){var n=this.state.InsertPanelActiveElementIndex;switch(t.keyCode){case 9:++n<this.up.length&&(t.stopPropagation(),t.preventDefault(),this.setState({InsertPanelActiveElementIndex:n}));break;case 39:n=(n+1+this.up.length)%this.up.length,this.setState({InsertPanelActiveElementIndex:n});break;case 37:n=(n-1+this.up.length)%this.up.length,this.setState({InsertPanelActiveElementIndex:n});break;case 13:this.state.InsertPanelActiveElementIndex<this.up.length-1&&$(":focus").click()}},n.prototype.Ug=function(t){var n=this;this.state.InsertPanelExpanded&&27===t.keyCode&&(t.stopPropagation(),t.preventDefault(),this.setState({FocusedOnInsertPanelItem:!1,InsertPanelActiveElementIndex:0,InsertPanelExpanded:!1},(function(){n.setFocusOnAddButton()})))},n.prototype.ap=function(t){var n=this.up[t];n&&n.focus()},n.prototype.Xg=function(){this.setState({ScreenSize:ct()})},n.prototype.As=function(){this.forceUpdate()},n}(J.r),ft=function(){function t(){}return t.prototype.getReferenceToInsertCardPane=function(){return g.createRef()},t.prototype.getInsertCardPane=function(t,n){return function(t,n){return g.createElement(lt,(0,p.pi)({},t,{ref:n}))}(t,n)},t.prototype.createCascadeQuestionDesigner=function(t){return null},t.prototype.createCVChoiceQuestionDesigner=function(t){return null},t}();var ht=e(60211),dt=e(94290),mt=e(34221),vt=e(29559),gt=e(90710),pt=e(81620),bt=e(4851);new Map;function yt(t){return new Promise((function(n){if("serviceWorker"in navigator&&navigator.serviceWorker.controller){var e=new MessageChannel;return e.port1.onmessage=function(t){var i;e.port1.close(),e.port2.close(),n(null===(i=t.data)||void 0===i?void 0:i.payload)},navigator.serviceWorker.controller.postMessage(t,[e.port2]),setTimeout((function(){e.port1.close(),e.port2.close(),n(void 0)}),2e3)}n(null)})).catch((function(){}))}var wt=(0,bt.Rm)((function(){self.formsModuleResolveErrorCallback=function(t){try{(0,q.zU)("Velocity_Issue_InvalidModuleId",{moduleId:t}),(n={cacheName:"StaticResource"},yt({type:"clearcache",payload:n})).then((function(){(0,q.$U)("ServiceWorker_ClearJsCssCache")})).catch((function(){}))}catch(t){}var n}})),St=e(57411),Nt=e(94283),Ct=e(94978),It=e(89904),Tt=e(41797),kt=e(42922),xt=e(23421),Ft=e(37890),Pt=e(9754),Dt=e(5699),Mt=e(86353),Lt=e(43209),Rt=e(56010),At=e(5809),Et=e(75827),Ot=e(8435),_t=e(28087),Bt=e(44644),Ht=e(13309);function Gt(){return(0,At.Lu)((0,c.k0)(),function(){switch((0,Lt.C2)()){case"Design":return 0;case"Response":return 1;case"Analyze":return 3;case"TeamsConfig":return 4;default:return 2}}(),xt.y.getInstance().getMuid())}var qt=e(14327),Vt=["anonymous_event"],zt=function(){function t(t,n,i,r){var o=this;this.kp=[],this.xp=t,this.Pp=r,this.Dp=(0,Pt.dR)("EventCollectorUri");var s=e.e(641).then(e.bind(e,12891));this.Mp=Promise.all([s,n(),yt({type:"version"}),xt.y.getInstance().ensureMuid()]).then((function(t){var n=t[0],e=t[1],r=t[2];o.Rp=n,o.Ap=e,o.Pp&&o.Pp(),o.Ep=function(){return(0,p.pi)((0,p.pi)({},i()),{SwVersion:r})},(0,ht.a4)()&&!o.Dp?(0,Ft.Ks)((0,kt.G)(),3e4).then((function(t){o.Dp=t,o.Op()})).catch((function(){o.track({eventType:"diagnostic_event",eventName:"WaitEventCollectorUri",properties:JSON.stringify({error:"Wait for event collector uri timeout"}),timeStamp:Date.now()}),o.Op()})):o.Op()}))}return t.prototype.flush=function(t){var n=this;"OneNoteUwp"===(0,Bt.P)()&&t(),this.Mp.then((function(){n.Bp?n.Bp.flush(!0,t):t()}))},t.prototype.track=function(t){if("OneNoteUwp"!==(0,Bt.P)()){try{t&&t.properties&&(t.properties=(0,qt.WW)(t.properties),t.properties=(0,qt.ug)(t.properties))}catch(t){}this.Bp?this.Hp(t):this.kp.length<1e3&&this.kp.push(t)}},t.prototype.Hp=function(t){var n,e;"session_start"===t.eventType&&function(t,n){var e=(0,c.k0)(),i=(0,p.pi)({BuildVersion:e.version,EcsConfigIds:(0,Mt.DP)(),EcsFirstRelease:(0,Et.$O)(),FromIERedirect:"true"===(0,gt.NW)().fromie||void 0,IsFirstRelease:(0,Et.$O)(),IsMobile:(0,vt.tq)(),IsOwnerFirstRelease:(0,Mt.$K)(),IsSwSupported:(0,Ot.qI)(),JQueryLoaded:!!window.$,Referrer:document.referrer&&(0,_t.Lp)(document.referrer),SwEnabled:(0,Ot.eg)(),SwReload:e.IsSwReload||!1,UserAgent:navigator.userAgent},n()),r=(0,Bt.P)(),o=navigator.connection,s=(0,Rt.hp)();r&&(i.Origin=r),o&&(i.Connection={downLink:o.downLink||-1,effectiveType:o.effectiveType||"unsupported",rtt:o.rtt||-1}),s&&(i.StartPageRoute=s),i.IsMobile&&(i.IsMobileView=(0,vt.lZ)()),t.properties?t.properties=JSON.stringify((0,p.pi)((0,p.pi)({},i),JSON.parse(t.properties))):t.properties=JSON.stringify(i)}(t,this.Ep);var i="anonymous_event"===t.eventType?((n={})[Dt.W1]=t.eventName,n[Dt.hj]=t.properties,n[Dt.$A]=this.Ap,n):((e={})[Dt.KF]=t.eventCorrelationId,e[Dt.te]=t.duration,e[Dt.W1]=t.eventName,e[Dt.hj]=t.properties,e[Dt.l3]=t.timeStamp,e[Dt.er]=this.xp(),e[Dt.$A]=this.Ap,e);this.Bp.track({baseType:t.eventName,name:t.eventType,data:i})},t.prototype.Op=function(){var t=this,n=function(t){var n;return(0,At.kI)((0,ht.kD)(),t,null===(n=(0,c.k0)().userInfo)||void 0===n?void 0:n.TenantId,(0,Lt._B)(),(0,et.Sp)())}(this.xp());this.Dp&&(n.EndpointUrl=this.Dp);var e,i=(0,At.DY)((0,c.k0)(),(0,dt.rh)(),(0,dt.XF)(),(0,et.Sp)(),(0,Ht.u)());!(0,ht.x8)()&&(0,I.cr)("EnablePrivacyGuard")&&(e=(0,Tt.b)()),this.Bp=this.Rp.initializeOneDS(n,e),this.Bp.addTelemetryInitializer((function(t){Vt.includes(t.name)?(t.data=(0,p.pi)((0,p.pi)({},t.data),i),delete t.data.session_id):t.data=(0,p.pi)((0,p.pi)((0,p.pi)({},Gt()),i),t.data),delete t.ext.app.sesId})),this.kp.forEach((function(n){return t.Hp(n)})),this.kp=[]},t}(),Qt=function(t,n){return{name:t,value:void 0===n?-1:n,delta:0,entries:[],id:"v2-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},Ut=function(t,n){try{if(PerformanceObserver.supportedEntryTypes.includes(t)){if("first-input"===t&&!("PerformanceEventTiming"in self))return;var e=new PerformanceObserver((function(t){return t.getEntries().map(n)}));return e.observe({type:t,buffered:!0}),e}}catch(t){}},$t=function(t,n){var e=function e(i){"pagehide"!==i.type&&"hidden"!==document.visibilityState||(t(i),n&&(removeEventListener("visibilitychange",e,!0),removeEventListener("pagehide",e,!0)))};addEventListener("visibilitychange",e,!0),addEventListener("pagehide",e,!0)},jt=function(t){addEventListener("pageshow",(function(n){n.persisted&&t(n)}),!0)},Wt=function(t,n,e){var i;return function(r){n.value>=0&&(r||e)&&(n.delta=n.value-(i||0),(n.delta||void 0===i)&&(i=n.value,t(n)))}},Kt=-1,Jt=function(){return"hidden"===document.visibilityState?0:1/0},Zt=function(){$t((function(t){var n=t.timeStamp;Kt=n}),!0)},Xt=function(){return Kt<0&&(Kt=Jt(),Zt(),jt((function(){setTimeout((function(){Kt=Jt(),Zt()}),0)}))),{get firstHiddenTime(){return Kt}}},Yt=(new Date,{});function tn(t){"undefined"!=typeof PerformanceObserver&&(function(t,n){var e,i=Xt(),r=Qt("LCP"),o=function(t){var n=t.startTime;n<i.firstHiddenTime&&(r.value=n,r.entries.push(t),e())},s=Ut("largest-contentful-paint",o);if(s){e=Wt(t,r,n);var a=function(){Yt[r.id]||(s.takeRecords().map(o),s.disconnect(),Yt[r.id]=!0,e(!0))};["keydown","click"].forEach((function(t){addEventListener(t,a,{once:!0,capture:!0})})),$t(a,!0),jt((function(i){r=Qt("LCP"),e=Wt(t,r,n),requestAnimationFrame((function(){requestAnimationFrame((function(){r.value=performance.now()-i.timeStamp,Yt[r.id]=!0,e(!0)}))}))}))}}(t),function(t){var n,e=Qt("TTFB");n=function(){try{var n=performance.getEntriesByType("navigation")[0]||function(){var t=performance.timing,n={entryType:"navigation",startTime:0};for(var e in t)"navigationStart"!==e&&"toJSON"!==e&&(n[e]=Math.max(t[e]-t.navigationStart,0));return n}();if(e.value=e.delta=n.responseStart,e.value<0||e.value>performance.now())return;e.entries=[n],t(e)}catch(t){}},"complete"===document.readyState?setTimeout(n,0):addEventListener("load",(function(){return setTimeout(n,0)}))}(t))}var nn=function(){function t(t,n,e,i){this.Gp=(0,bt.Rm)((function(){var t=(0,Ct.QJ)("ThrottledEventNames");return t&&Array.isArray(t)?t.reduce((function(t,n){return t[n]=!0,t}),{}):{}})),tn((function(t){var n=t.name,e=t.value,i=t.delta,r=t.id;(0,q.b6)("Perf.WebVitals",{name:n,value:e,delta:i,id:r}),(0,Nt.AC)(7,{$metricDelta:i,$metricId:r,$metricName:n,$metricValue:e})})),this.qp=new zt(t,n,e,i)}return t.prototype.logData=function(t){t&&t.eventName&&!this.Vp(t.eventName)&&((0,Ht.u)()&&"string"==typeof t.eventName&&t.eventName.indexOf("Error.ErrorPage.Error")>-1||(t=(0,It.$o)(t),this.qp.track(t)))},t.prototype.flush=function(t){this.qp.flush(t)},t.prototype.Vp=function(t){return this.Gp()[t]},t}(),en=e(79552),rn=e(85708),on={anonymous_event:sn,diagnostic_event:sn,engagement_event:function(t){(0,vt.tq)()&&(t.extraData=(0,p.pi)((0,p.pi)({},t.extraData),{IsMobileView:!0}));return sn(t)},error_event:sn,formspro_event:sn,generic_event:sn,impression_event:sn,intelligence_event:sn,nav_perf_event:function(t){var n=sn(t);t.extraData&&(!function(t){if(an){var n=0;"hidden"===an.initialVisibility?n=an.initializeTime.getTime():an.visiToggleTime&&(n=an.visiToggleTime.getTime());var e="VisiToggled";t.extraData[e]=n,an.stop(),an=null}}(t),n.properties=JSON.stringify(t.extraData));return n},qos_event:function(t){var n={duration:t.duration,eventCorrelationId:t.correlationId,eventName:t.eventName,eventType:t.eventType,properties:"",timeStamp:(0,rn.dg)()};t.extraData&&(n.properties=JSON.stringify(t.extraData));return n},session_start:function(t){var n;return sn((0,p.pi)((0,p.pi)({},t),{correlationId:t.correlationId||(null===(n=(0,c.k0)().serverInfoFromPageHeaders)||void 0===n?void 0:n.serverCorrelationId)}))}};function sn(t){var n={eventCorrelationId:t.correlationId,eventName:t.eventName,eventType:t.eventType,properties:"",timeStamp:(0,rn.dg)()};return t.extraData&&(n.properties=JSON.stringify(t.extraData)),n}var an=new(function(){function t(){this.initialVisibility=document.visibilityState,this.initializeTime=new Date,this.zp=this.zp.bind(this),document.addEventListener("visibilitychange",this.zp)}return t.prototype.stop=function(){document.removeEventListener("visibilitychange",this.zp)},t.prototype.zp=function(){this.visiToggleTime=new Date},t}()),un=e(19194),cn=function(){function t(t,n){var e=this;this.logData=function(t){if(!function(t){return t.eventName=t.eventName.replace(" ",""),!t.eventName||-1!==((0,Ct.Gw)("DisabledEventNames")||[]).indexOf(t.eventName)}(t)){var n=on[t.eventType];if(n){var i=n(t);if(i.properties=e.sanitizeLogString(i.properties),e.awtLogger.logData(i),!t.$optoutUTel&&e.Qp){var r=function(t){var n,e=ln()[t.eventType];if(void 0===e)return null;var i=t.eventName,r=null,o=8===e?10:8,s={$extraData:t.extraData};if(0===e){var a=t;i=null!==(n=a.qosEventName)&&void 0!==n?n:i,s.$qosEventStatus=a.qosEventStatus,s.$correlationId=a.correlationId;var u={aggMode:0,count:1,duration:a.duration};switch(s.$qosEventStatus){case"Success":case"PartialSuccess":u.result={code:0};break;case"Failure":u.result={code:1,isExpected:!1};break;case"ExpectedFailure":u.result={code:1,isExpected:!0}}r={$type:0,$data:u}}return{$eventFlags:o,$eventName:i,$eventType:e,$eventContract:r,$eventData:s}}(t);r&&e.Qp.$sendTelemetryEvent(r)}}}},this.sendTelemetryEvent=function(t){e.Qp&&e.Qp.$sendTelemetryEvent(t)},this.flushAndStop=function(t){e.awtLogger&&e.awtLogger.flush((function(){e.Qp&&e.Qp.$flushAndStop(t)})),e.Qp||e.awtLogger||t()},this.awtLogger=t,this.Qp=n}return t.prototype.logFormsProEvent=function(t){},t.prototype.sendTeamsAppInitializationCompleteSignal=function(t){},t}();var ln=(0,bt.Rm)((function(){return{engagement_event:3,error_event:2,nav_perf_event:8,qos_event:0,diagnostic_event:2,anonymous_event:1}})),fn=function(t){function n(n,e){return t.call(this,n,e)||this}return(0,p.ZT)(n,t),n.prototype.logFormsProEvent=function(t){t.eventInfo.timeStamp=Date.now()-60*(new Date).getTimezoneOffset()*1e3;var n={eventName:t.type,eventType:"formspro_event",extraData:t.eventInfo};this.awtLogger.logData(sn(n))},n.prototype.sendTeamsAppInitializationCompleteSignal=function(t){(0,dt.Kw)()&&(t?(0,en.xP)(t)?microsoftTeams.appInitialization.notifySuccess():microsoftTeams.appInitialization.notifyFailure({message:(0,un.e)(t),reason:"Other"}):microsoftTeams.appInitialization.notifySuccess())},n.prototype.sanitizeLogString=function(t){if("string"==typeof t){var n=t.toLowerCase();return n.indexOf("auth_upn=")<0&&n.indexOf("token=")<0&&n.indexOf("bearer ")<0&&n.indexOf("authorization=")<0?t:t?'{"log":"[Sanitized log]"}':""}},n}(cn);function hn(){return{Flights:(t=(0,c.k0)(),{IsCdnEnabled:t.isCdnEnabled,IsAFDEnabled:t.isAFDEnabled,IsCandidateForLightResponsePage:t.isCandidateForLightResponsePage,NoLightReason:t.noLightReason,IsIntegration:t.isIntegration,IntegrationHost:t.isOembedSPO?"SPO":t.integrationHost,IsFirstReleaseEnabled:(0,I.g)()})};var t}var dn=e(97517);function mn(t){return t?t[0].toUpperCase()+t.slice(1):""}var vn=e(49690),gn=e(82195);function pn(t,n,e,i,r,o){switch(void 0===r&&(r=!1),void 0===o&&(o=0),typeof i){case"number":case"boolean":case"string":(0,gn.a)(t,n,e,i);break;case"object":if(o<3)for(var s in i)if(r||bn[s]){var a=r?mn(s):bn[s];pn(t,(0,vn.x)([n,e]),a,i[s],r,o+1)}}}var bn={$correlationId:"CorrelationId",$formId:"FormId",$extraData:"ExtraData",$duration:"Duration",$error:"Error",$guid:"Guid",$imageType:"ImageType",$location:"Location",$mediaType:"MediaType",$metricDelta:"MetricDelta",$metricId:"MetricId",$metricName:"MetricName",$metricValue:"MetricValue",$qosEventStatus:"QosEventStatus",$retry:"Retry",$startTime:"StartTime"},yn=e(83390),wn=e(26261);var Sn=(0,bt.Rm)((function(){var t=[];return t[0]=wn.cS.getFields.bind(wn.cS),t[1]=function(t){return wn.oe.getFields("Funnel",t)},t[2]=wn.iH.getFields,t[3]=wn.Vw.getFields,t})),Nn=function(){function t(t,n){var e=this;this.$flushAndStop=function(t){var n;e.Qp?null===(n=e.jp)||void 0===n||n.then((function(n){var i,r;e.Qp=null,(i=n)&&i.startWorker&&i.enabled?i.shutdown(!0):(r=n)&&r.getOneDSTelemetryEvent&&(r.flush(!1),r.shutdown()),t()})):t()},this.$sendTelemetryEvent=function(t){var n,i;if(e.Qp){e.jp||e.ie();var r=1===t.$eventType,o=5===t.$eventType;t.$eventData=null!==(n=t.$eventData)&&void 0!==n?n:{},r||t.$eventData.$formId||(t.$eventData.$formId=e.xp()),o&&!t.$eventData.$correlationId&&(t.$eventData.$correlationId=null===(i=(0,c.k0)().serverInfoFromPageHeaders)||void 0===i?void 0:i.serverCorrelationId);var s=[];!function(t,n){var e;for(e in n)if(bn[e]){var i=bn[e];pn(t,null,i,n[e],i===bn.$extraData)}n.$extraData instanceof Error&&Object.getOwnPropertyNames(n.$extraData).forEach((function(e){pn(t,bn.$extraData,mn(e),n.$extraData[e],!0,1)}))}(s,t.$eventData);var a={name:kn(t.$eventName),dataFields:[]};if(t.$eventContract&&t.$eventContract.$data){var u=function(t,n){var e=Sn()[t];if(e)return e(n)}(t.$eventContract.$type,t.$eventContract.$data);u&&(a.dataFields=u)}var l=(0,vn.x)([Dt.N5,In()[t.$eventType]]);e.Qp.sendTelemetryEvent({telemetryProperties:{ariaTenantToken:Dt.i},eventName:l,eventFlags:Tn(t.$eventFlags),eventContract:a,dataFields:s,timestamp:t.$timestamp})}};var i=(0,yn.xW)();"OneNoteUwp"!==(0,Bt.P)()&&!i&&(0,I.cr)("EnableUTelTelemetry")&&(this.xp=t,this.Wp=n,this.Qp=new dn.Dw(null,null,{disableValidation:!i,enableQueue:!0}))}return t.prototype.ie=function(){var t,n=this;this.jp=new Promise((function(n){return t=n}));var i,r=e.e(824).then(e.bind(e,14045)),o=(0,Pt.dR)("EventCollectorUri");i=(0,ht.a4)()&&!o?(0,Ft.Ks)((0,kt.G)(),Cn).catch((function(){return n.$sendTelemetryEvent({$eventType:2,$eventName:"WaitEventCollectorUri",$eventData:{$error:"Wait for event collector uri timeout"}}),o})):Promise.resolve(o),Promise.all([r,i,yt({type:"version"}),this.Wp(),xt.y.getInstance().ensureMuid()]).then((function(e){var i=e[0],r=e[1],o=e[2],s=e[3];n.Qp&&i.initializeTelemetryLogger(n.Qp,r,o,s).then((function(n){return t(n)}))}))},t}(),Cn=3e4,In=(0,bt.Rm)((function(){var t=[];return t[0]="Activity",t[1]="Anonymous",t[2]="Diagnostic",t[4]="Navigation",t[8]="Perf",t[5]="SessionStart",t[6]="SystemAction",t[7]="UserAction",t[3]="Engagement",t}));function Tn(t){var n={dataCategories:2,diagnosticLevel:10,samplingPolicy:1};return 2&t&&(n.dataCategories=4),4&t&&(n.diagnosticLevel=110),8&t&&(n.samplingPolicy=194),n}function kn(t){return"string"==typeof t?(0,vn.x)(t.split(".").map(mn)):"E".concat(t)}var xn,Fn=e(66557),Pn=e(92528),Dn=e(47393),Mn=e(67353),Ln=function(){function t(){}return t.prototype.getFormApiToken=function(){return(0,Mn.LP)()},t.prototype.handleAuthForContentPage=function(t){},t.prototype.handleAuthForAddinPage=function(){},t.prototype.hasUserLoggedIn=function(){return!!(0,c.k0)().userInfo.UserId},t.prototype.isValid=function(){return!0},t.prototype.redirectToLogin=function(){return(0,Dn.mj)((0,Dn.Gh)()),new Promise((function(){}))},t.prototype.refreshToken=function(){return(0,Mn.g$)()},t.prototype.signIn=function(){return this.redirectToLogin()},t.prototype.signOut=function(){return(0,Dn.gB)((0,c.k0)().signOutLink)},t}(),Rn=function(){function t(){}return t.prototype.getFormApiToken=function(){return this.Kp().getFormApiToken()},t.prototype.handleAuthForContentPage=function(t){return this.Kp().handleAuthForContentPage(t)},t.prototype.handleAuthForAddinPage=function(){return this.Kp().handleAuthForAddinPage()},t.prototype.hasUserLoggedIn=function(){return this.Kp().hasUserLoggedIn()},t.prototype.isValid=function(){return this.Kp().isValid()},t.prototype.redirectToLogin=function(){return this.Kp().redirectToLogin()},t.prototype.refreshToken=function(){return this.Kp().refreshToken()},t.prototype.signIn=function(){return this.Kp().signIn()},t.prototype.signOut=function(){return this.Kp().signOut()},t.prototype.Kp=function(){return this.Jp||(this.Jp=new Ln),this.Jp},t}(),An=function(){function t(t){this.Zp=null,this.Xp=t?t.concat():[new Rn]}return t.prototype.signIn=function(){return this.Yp().then((function(t){return t.signIn()}))},t.prototype.getFormApiToken=function(){return this.Yp().then((function(t){return t.getFormApiToken()}))},t.prototype.handleAuthForContentPage=function(t){return this.Yp().then((function(n){return n.handleAuthForContentPage(t)}))},t.prototype.handleAuthForAddinPage=function(){return this.Yp().then((function(t){return t.handleAuthForAddinPage()}))},t.prototype.hasUserLoggedIn=function(){var t=this.tb();return t&&t.hasUserLoggedIn()},t.prototype.redirectToLogin=function(){return this.Yp().then((function(t){return t.redirectToLogin()}))},t.prototype.refreshToken=function(){return this.Yp().then((function(t){return t.refreshToken()}))},t.prototype.signOut=function(){return this.Yp().then((function(t){return t.signOut()}))},t.prototype.Yp=function(){var t=this;if(this.Zp)return this.Zp;var n=function(e){var i=t.Xp[e];return i?i.isValid()?Promise.resolve(i):n(e+1):Promise.reject(new Error("No valid authenticator"))};return this.Zp=n(0),this.Zp},t.prototype.tb=function(){return this.Xp.filter((function(t){return t.isValid()}))[0]},t}(),En=function(){function t(t){var n=t.flights,e=void 0===n?"":n;this.nb={},Wn(),""!==e&&(this.eb=Vn(e)),""===e&&(this.ib=Vn((0,c.k0)().flights))}return t.prototype.isEnabled=function(t){return this.rb(t)},t.prototype.isEnabled_Deprecated=function(t){return this.rb(t)},t.prototype.setFlights=function(t){this.eb=Vn(t)},t.prototype.rb=function(t){var n=_n[t];switch("tenant"===n&&(this.eb||qn(t),n="environment"),n){case"environment":if(t in this.nb)return this.nb[t];break;case"deprecated":this.eb||qn(t);break;default:return!1}var e=this.ob(t);return"environment"===n&&(this.nb[t]=e),e},t.prototype.ob=function(t){var n=this;if(Bn[t]&&Bn[t].some((function(t){return n.rb(t)})))return!1;if(Hn[t]&&!Hn[t].every((function(t){return n.rb(t)})))return!1;var e=t.toUpperCase(),i=function(){if(zn)return zn;var t={};0;return zn=t,t}();if(e in i)return i[e];var r=this.eb||this.ib;return t in r?r[t]:On[t]},t}(),On={},_n={},Bn={},Hn={};function Gn(){xn=function(){switch((0,ht.kD)()){case"DevHost":return 1;case"Daily":case"Drill":case"Pilot":case"Trial":case"ProDaily":case"CVDaily":return 2;case"Weekly":case"Hotfix":return 3;case"Int":case"MSInt":case"CVInt":return 4;default:return 5}}()}function qn(t){var n=new Error('Checking flight "'.concat(t,'" before ready.'));(0,q.zU)("UnstableFlightChecking",{flightName:t,flightType:_n[t],stack:n.stack})}function Vn(t){var n={};return t&&t.split(";").forEach((function(t){"!"!==t[0]?n[t]=!0:(t=t.substr(1),n[t]=!1)})),n}var zn=null;function Qn(t,n){On[t]=jn(n),_n[t]="environment"}function Un(t,n){On[t]=jn(n),_n[t]="tenant"}function $n(t,n){On[t]=jn(n),_n[t]="deprecated"}function jn(t){return t>=(xn||Gn(),xn)}var Wn=(0,bt.Rm)((function(){var t;$n("TestDeprecatedFlight",0),Qn("TestEnvironmentFlight",5),Qn("TestEnvironmentFlight_Blocker",0),Un("TestTenantFlight",5),Un("ResponseInApp",4),$n("FormInsight",4),$n("PartialPut",1),Qn("AutoPinWordCloudInsight",4),Qn("CustomerVoiceBlackList",0),Qn("DisableRecordNameForTenant",0),Qn("DisableRedirect",0),Qn("EnableBrandingFooter",4),Qn("EnableCustomerVoice",5),Qn("EnableSanitizedHTML",0),Qn("EnableECSInFirstRelease",0),Qn("EnableExternalSharing",4),Qn("EnablePrivacyGuard",4),Qn("EnableUTelTelemetry",4),Qn("EstimationTimeUIFix",4),Qn("FeedbackLoopComponent",4),Qn("FirstReleaseClientEnabled",0),Qn("FixEslintPostMessageError",4),Qn("FixEslintTeamsPostMessageError",4),Qn("FixFluidPollRefresh",5),Qn("FluidCategoryLoopPoll",5),Qn("FluidFormErrorView",5),Qn("FluidHistorySuggestion",0),Qn("FluidQuickAddInFPS",4),Qn("FluidWordCloudSharing",0),Qn("FluidPollRemoveResponder",5),Qn("GetDriveItemFromFormApi",5),Qn("GetInsightNewApi",0),Qn("GetInsightPerResponseChange",4),Qn("GetRealtimeInsights",4),Qn("ImageManualReload",4),Qn("IncreaseTeamsPollMaxOptionCount",5),Qn("IntelligencePollSuggestionsFPS",4),Qn("MobileQuestionCalloutBugfix",4),Qn("Retry6300",4),Qn("PollChoiceResultView",4),Qn("PollOptionSuggestion",4),Qn("SearchEngineOptimization",5),Qn("SDXDataSync",0),Qn("SDXDataSyncProtection",0),Qn("SDXDataSyncAuthPrefetch",5),Qn("SDXDataSyncConsistencyCheck",0),Qn("SDXDataSyncUserChangeNotification",0),Qn("SDXDataSyncQuiz",0),Qn("SDXDataSyncShowErrorMessage",5),Qn("SDXDataSyncCheckFormOwner",0),Qn("SDXDataSyncDisconnection",0),Qn("SDXDataSyncUpnCheck",0),Qn("SDXDataSyncInPageResync",0),Qn("SensitiveInfoCheckForAllForms",4),Qn("SensitiveInfoCheckInResponsePage",4),Qn("ServiceWorkerEnabled",0),Qn("TeamsAddPollQuestion",0),Qn("TeamsBubbleEnableCrossEnvCheck",5),Qn("TeamsPollEnableSCActions",0),Qn("TeamsPollNPS",4),Qn("TeamsPollMESuggestion",0),Qn("TeamsPollMultiQuestionSuggestion",4),Qn("TeamsPollOptionImage",0),Qn("TeamsPollQuestionImage",4),Qn("TeamsPollLaunchFromEditor",4),Qn("TeamsPollGetOwnResponsesSw",4),Qn("TeamsPollAnonymousToken",4),Qn("TeamsPollAnonymousResultView",4),Qn("TeamsPollSignalR",4),Qn("TeamsForLifePollMESubtitle",4),Qn("TeamsForLifeAuthoringDeferSso",4),Qn("UnregisterServiceWorker",0),Qn("WordCloudPollInstruction",4),Qn("WordCloudPoll",4),Qn("EnableThrowErrorInDispatchDeadLoop",0),Qn("DaemonWorker",0),Qn("DeprecateOfficeDotComTreatment",0),Qn("SuiteHeaderLinkCSP",4),Qn("PowerPointPresent",0),Un("AssignmentsIFrameLimitParentHeaders",4),Un("BaseProFRE",0),Un("DesignerFileUpload",2),Un("EnableAnonymousUploadLink",0),Un("FormsProAvailableTeachingCallout",0),Un("HideReportAbuse",0),Un("IntelligenceExpDemoTenantTest",0),Un("QuickPollDisableEws",0),Un("SuspiciousForm",4),Un("NextButtonLiveRegion",4),Qn("FormsPro",0),t=["TestEnvironmentFlight_Blocker"],Bn["TestTenantFlight"]=t,function(t,n){Hn[t]=n}("TestTenantFlight",["TestEnvironmentFlight"])})),Kn=function(){function t(t){t=t||{},this.sb=new An(t.authenticators),this.ab=new En({}),t.addinAccessTokenGetter&&(0,Pn.QY)(t.addinAccessTokenGetter)}return Object.defineProperty(t.prototype,"AuthContext",{get:function(){return this.sb},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Flighting",{get:function(){return this.ab},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"RetryingRecoverableError",{get:function(){return this.ub},set:function(t){this.ub=t},enumerable:!1,configurable:!0}),t}();var Jn,Zn=function(){function t(){}return t.prototype.getMixinHeaderThemeMaster=function(){return null},t}(),Xn=e(37076),Yn=e(916),te=e(41480),ne=e(13877),ee=e(21607),ie={};!function(t){t[t.ApiFacadeEndPoint=0]="ApiFacadeEndPoint",t[t.FormsProUIHost=1]="FormsProUIHost",t[t.FormsHomeUrl=2]="FormsHomeUrl",t[t.FormsSingleSignOnHomeUrl=3]="FormsSingleSignOnHomeUrl",t[t.FormsProCdnHomeUrl=4]="FormsProCdnHomeUrl",t[t.PreviewSettingsDefaultDate=5]="PreviewSettingsDefaultDate",t[t.FormsProGeo=6]="FormsProGeo",t[t.FormsProLicensingServiceEndPoint=7]="FormsProLicensingServiceEndPoint",t[t.FormsProSampleFormTenantId=8]="FormsProSampleFormTenantId",t[t.FormsProMSRewardsAvailableCountryCodes=9]="FormsProMSRewardsAvailableCountryCodes",t[t.FormsProCSATEndpoint=10]="FormsProCSATEndpoint",t[t.FormsProCSATTenant=11]="FormsProCSATTenant",t[t.FormsProResponseLimit=12]="FormsProResponseLimit",t[t.UIFacadeEndPoint=13]="UIFacadeEndPoint",t[t.ChatDistributionEndpoint=14]="ChatDistributionEndpoint",t[t.ProjectUIServiceEndpoint=15]="ProjectUIServiceEndpoint",t[t.FormsProResponseGridLimit=16]="FormsProResponseGridLimit",t[t.OrchestrationServiceEndpoint=17]="OrchestrationServiceEndpoint",t[t.FormsProRespondentGridMaxLimit=18]="FormsProRespondentGridMaxLimit",t[t.FormsProRespondentGridPageSize=19]="FormsProRespondentGridPageSize",t[t.SatisfactionMetricTrendAndAggregateDataUrl=20]="SatisfactionMetricTrendAndAggregateDataUrl",t[t.SatisfactionMetricMaxLimit=21]="SatisfactionMetricMaxLimit",t[t.CustomerVoiceProjectShareServiceEndpoint=22]="CustomerVoiceProjectShareServiceEndpoint",t[t.ExportCsvServiceEndpoint=23]="ExportCsvServiceEndpoint",t[t.CustomerVoiceSurveyUIServiceEndpoint=24]="CustomerVoiceSurveyUIServiceEndpoint",t[t.CurrentFlowEndpoint=25]="CurrentFlowEndpoint",t[t.CVFlowUIServiceEndPoint=26]="CVFlowUIServiceEndPoint",t[t.CVHomeVideoLinks=27]="CVHomeVideoLinks",t[t.CVDynamicsLink=28]="CVDynamicsLink",t[t.ProjectAlertServiceEndPoint=29]="ProjectAlertServiceEndPoint",t[t.CVReportingLimit=30]="CVReportingLimit",t[t.CustomerVoiceProjectShareServiceV2Endpoint=31]="CustomerVoiceProjectShareServiceV2Endpoint",t[t.CVCIServiceEndpoint=32]="CVCIServiceEndpoint",t[t.CVSurveyReportDateFilterRange=33]="CVSurveyReportDateFilterRange",t[t.DistributionServiceEndpoint=34]="DistributionServiceEndpoint",t[t.CVPauseResumeService=35]="CVPauseResumeService",t[t.InviteServiceEndpoint=36]="InviteServiceEndpoint",t[t.ShareV2StatusFetchDuration=37]="ShareV2StatusFetchDuration",t[t.CustomLinksExcelUploadLimit=38]="CustomLinksExcelUploadLimit",t[t.CustomLinksRecordsLimit=39]="CustomLinksRecordsLimit",t[t.CVReportServiceHostUrl=40]="CVReportServiceHostUrl",t[t.CascadeSubQuesMaxLimit=41]="CascadeSubQuesMaxLimit",t[t.CVRespondentGridPageSize=42]="CVRespondentGridPageSize",t[t.CVResponseDeletePerBatchLimit=43]="CVResponseDeletePerBatchLimit",t[t.CVProjectOperationFetchDuration=44]="CVProjectOperationFetchDuration",t[t.CVSurveyCountApproachingLimitFirstStage=45]="CVSurveyCountApproachingLimitFirstStage",t[t.CVSurveyCountApproachingLimitSecondStage=46]="CVSurveyCountApproachingLimitSecondStage",t[t.CVSurveyCountExceedLimit=47]="CVSurveyCountExceedLimit",t[t.ShareV2SurveyLimitToShowMessage=48]="ShareV2SurveyLimitToShowMessage",t[t.CVHomeVideoTitles=49]="CVHomeVideoTitles",t[t.CVRoleTemplateId=50]="CVRoleTemplateId",t[t.CVGetFormLimit=51]="CVGetFormLimit",t[t.CVCkEditorVersion=52]="CVCkEditorVersion",t[t.CVTransferOwnershipDocUrl=53]="CVTransferOwnershipDocUrl"}(Jn||(Jn={})),ie[Jn.ApiFacadeEndPoint]="https://mfpapifacadefaint.azurewebsites.net/",ie[Jn.UIFacadeEndPoint]="https://cvsurveyuiserviceint.azurewebsites.net",ie[Jn.FormsProUIHost]="https://mfpuiwebappint.azurewebsites.net",ie[Jn.FormsHomeUrl]="https://forms.office-int.com",ie[Jn.FormsSingleSignOnHomeUrl]="https://forms.office-int.com/formspro",ie[Jn.FormsProCdnHomeUrl]="https://mfpembedcdnint.azureedge.net/mfpembedcontint/",ie[Jn.PreviewSettingsDefaultDate]="2019-02-08",ie[Jn.FormsProGeo]="INT",ie[Jn.FormsProLicensingServiceEndPoint]="https://mfplicensingservicefaint.azurewebsites.net/",ie[Jn.FormsProSampleFormTenantId]="558a6a52-809d-4de8-8b01-01a51502c93f",ie[Jn.FormsProMSRewardsAvailableCountryCodes]="US",ie[Jn.FormsProCSATEndpoint]="https://nps.onyx.azure.net",ie[Jn.FormsProCSATTenant]="formspro",ie[Jn.FormsProResponseLimit]="50000",ie[Jn.ChatDistributionEndpoint]="https://mfpuifacadeint.projectsshimlaint.com/",ie[Jn.ProjectUIServiceEndpoint]="https://cvuiserviceatmint.projectsshimlaint.com/",ie[Jn.ProjectAlertServiceEndPoint]="https://mfpprojectalertfaint.azurewebsites.net/",ie[Jn.FormsProResponseGridLimit]="5000",ie[Jn.OrchestrationServiceEndpoint]="https://cvtemplateorchfaint.azurewebsites.net/",ie[Jn.FormsProRespondentGridMaxLimit]="500",ie[Jn.FormsProRespondentGridPageSize]="50",ie[Jn.SatisfactionMetricTrendAndAggregateDataUrl]="https://mfpsatisfactionmetricsapisfaint.azurewebsites.net/",ie[Jn.SatisfactionMetricMaxLimit]="10",ie[Jn.CustomerVoiceProjectShareServiceEndpoint]="https://cvuisharev2tm.projectsshimlaint.com/",ie[Jn.ExportCsvServiceEndpoint]="https://mfpuasfaint.azurewebsites.net/",ie[Jn.CustomerVoiceSurveyUIServiceEndpoint]="https://cvsurveyuiserviceint.azurewebsites.net/",ie[Jn.CurrentFlowEndpoint]="https://us.tip1.flow.microsoft.com/",ie[Jn.CVFlowUIServiceEndPoint]="https://cvflowfaint.azurewebsites.net/",ie[Jn.CVHomeVideoLinks]="https://youtu.be/Mctc8pc6q_A,https://youtu.be/se5fCA9IptI,https://youtu.be/jLdw_TSqolA",ie[Jn.CVHomeVideoTitles]="Introduction to Dynamics 365 Customer Voice,How to add branching rules to your survey in Dynamics 365 Customer Voice,Customer Feedback Management Solution for banks using Dynamics 365 Customer Voice",ie[Jn.CVDynamicsLink]="https://dynamics.microsoft.com/en-us/customer-voice/overview/",ie[Jn.CVReportingLimit]="500000",ie[Jn.CustomerVoiceProjectShareServiceV2Endpoint]="https://cvuisharev2faint.azurewebsites.net/",ie[Jn.CVCIServiceEndpoint]="https://cvcifaint.azurewebsites.net/",ie[Jn.DistributionServiceEndpoint]="https://mfpdistfaint.azurewebsites.net/",ie[Jn.CVSurveyReportDateFilterRange]="90",ie[Jn.CVPauseResumeService]="https://mcvparfaint.azurewebsites.net/",ie[Jn.InviteServiceEndpoint]="https://cvinviteservicefaint.azurewebsites.net/formapi/api/",ie[Jn.ShareV2StatusFetchDuration]="5000",ie[Jn.CustomLinksExcelUploadLimit]="10000",ie[Jn.CustomLinksRecordsLimit]="10000",ie[Jn.CVReportServiceHostUrl]="https://customervoicereportingapi.azurewebsites.net/",ie[Jn.CascadeSubQuesMaxLimit]="3",ie[Jn.CVRespondentGridPageSize]="500",ie[Jn.CVResponseDeletePerBatchLimit]="500",ie[Jn.CVProjectOperationFetchDuration]="5000",ie[Jn.CVSurveyCountApproachingLimitFirstStage]="350",ie[Jn.CVSurveyCountApproachingLimitSecondStage]="375",ie[Jn.CVSurveyCountExceedLimit]="400",ie[Jn.ShareV2SurveyLimitToShowMessage]="15",ie[Jn.CVRoleTemplateId]="62e90394-69f5-4237-9190-012177145e10",ie[Jn.CVGetFormLimit]="200",ie[Jn.CVCkEditorVersion]="4.11.2-full",ie[Jn.CVTransferOwnershipDocUrl]="https://docs.microsoft.com/en-us/dynamics365/customer-voice/manage-projects#share-a-project";var re=function(){function t(){}return t.getSetting=function(n){t.webSettingsJson||(t.webSettingsJson=decodeURI((0,c.k0)().webSettings||"{}")),t.webSettingsMap||(t.webSettingsMap=JSON.parse(t.webSettingsJson));var e=t.webSettingsMap[Jn[n].toString()];if(!e){var i=ie[n];e=i||t.defaultValue}return e},t.defaultValue="",t}();function oe(){return re.getSetting(Jn.CVGetFormLimit)}var se=e(72317),ae=e(46298),ue=[],ce=["LastEmbedConfig","formsProConfiguredPipes","FormsProBranchRules","mfpBranchingData","formsProEmbedCode","conditionalThankyouMessage","headerOtherInfo","footerText","alias"],le=[],fe=["FormsProSmileyList"];function he(t){var n=null;switch(t.entityType){case 1:n=(0,et.pd)((function(){return ue}),(function(){return ce}));break;case 2:n=(0,et.pd)((function(){return le}),(function(){return fe}));break;default:return}n&&t.data&&"object"==typeof t.data&&n.forEach((function(n){t.data[n]&&(t.data["".concat(n,"@odata.type")]="#String")}))}var de=e(99437),me=e(5892),ve=e(68289),ge=e(77209),pe="forms",be="questions",ye="runtimeForms",we="localeResource",Se="runtimeresponses",Ne=function(){function t(t,n){this.serviceUrl=t,this.ownerServiceUrl=n,this.partialUpdateHttpMethod=(0,se.a)().Flighting.isEnabled_Deprecated("PartialPut")?"PUT":"PATCH"}return t.getQueryParameters=function(t,n,e){if(!n)return"".concat(t,"$expand=").concat(be);var i="$select="+(n=y.union(["id"],n)).join(","),r={permissions:"permissions"};r.questions="".concat(be,"($expand=").concat("choices",")"),r.permissionTokens="permissionTokens";var o=n.map((function(t){return r[t]})).filter((function(t){return t}));return o.length&&(i+="&$expand="+o.join(",")),e&&(i+="&$filter=".concat(e.name,"+").concat(e.operator,"+").concat(e.value)),i&&t+i},t.prototype.getImmersiveReaderToken=function(){var t=(0,St.x_)(),n="".concat(this.getSurveyWebServiceUrl(),"decomposition/GetImmersiveReaderToken?formId=").concat(t);return this.sendRequest({method:"GET",qosEventName:"Decomposition.GetImmersiveReaderToken",requestUri:n}).then((function(t){if(t)return t;throw new Error("Failed to get ImmersiveReader token via GetTokenForResource")}))},t.prototype.getPrivacySettings=function(t,n,e){var i={};return t&&(i.ownerTenantId=t),n&&(i.currentUserTenantId=n),e&&(i.isAnonymous=e),this.sendRequest({method:"GET",qosEventName:"Function.GetPrivacy",requestUri:"".concat(this.getSurveyWebServiceUrl(),"privacy?").concat($.param(i))})},t.prototype.reportAbuse=function(t){return this.sendRequest({data:t,method:"POST",qosEventName:"OnlineSafety.ReportAbuse",qosExtraData:{Category:t.Category},requestUri:"".concat(this.getSurveyWebServiceUrl(),"contentvalidation/report").concat(window.location.search)})},t.prototype.getRuntimeResponses=function(t,n){var e=n?"&$filter=responder+eq+'".concat(encodeURIComponent(n.replace(/\'/g,"''")),"'"):"",i=this.getSurveyWebOwnerServiceUrl();return this.sendRequest({qosEventName:"RuntimeResponses.Get",requestUri:"".concat(i).concat(pe,"('").concat(t,"')/").concat(Se).concat("?$expand=comments").concat(e)})},t.prototype.getRuntimeResponse=function(t,n){var e=(0,gt.NW)(),i={};return e.GetResponseToken&&(i.GetResponseToken=e.GetResponseToken),this.sendRequest({headers:i,qosEventName:"RuntimeResponse.Get",requestUri:"".concat(this.getSurveyWebOwnerServiceUrl(),"light/").concat(pe,"('").concat(t,"')/").concat(Se,"(").concat(n,")").concat("?$expand=comments")})},t.prototype.submitFormResponse=function(t,n){var e=(0,Xn.kc)(t),i="AAD";return null==e.OrgId?i="Unknown":e.OrgId.toLowerCase()===(0,ht.Fc)()&&(i="MSA"),this.sendRequest({data:n,method:"POST",qosEventName:"Response.Submit",qosExtraData:{OwnerSource:i},requestUri:"".concat(this.getSurveyWebOwnerServiceUrl()).concat(pe,"('").concat(t,"')/").concat("responses")})},t.prototype.getToken=function(){return(0,se.a)().AuthContext.getFormApiToken()},t.prototype.getRuntimeForm=function(n,e){var i="".concat(this.getSurveyWebOwnerServiceUrl(),"light/").concat(ye,"('").concat(n,"')");return i+=t.getQueryParameters("?",e),this.sendRequest({qosEventName:"ResponseForm.Get",requestUri:i},{hasPrefetch:!0})},t.prototype.getResponseDetailRuntimeForm=function(n,e){var i=(0,gt.NW)();if(i.GetResponseToken&&i.rid){var r={GetResponseToken:i.GetResponseToken},o="".concat(this.getSurveyWebOwnerServiceUrl(),"light/").concat("responseDetailRuntimeForms","('").concat(n,"')/").concat(i.rid);return o+=t.getQueryParameters("?",e),this.sendRequest({headers:r,qosEventName:"QosEvent.ServiceEndpoints.Form.GetResponseDetailRuntimeForm",requestUri:o})}return Promise.resolve(null)},t.prototype.getLocaleResource=function(t,n){var e="".concat(this.getMultilingualBaseUrl(t),"/'").concat(n,"'");return this.sendRequest({headers:{ValidationToken:""},method:"GET",qosEventName:"Locale.Get",requestUri:e})},t.prototype.createUploadSession=function(t,n,e){var i="".concat(this.getSurveyWebOwnerServiceUrl()).concat(ye,"('").concat(t,"')/").concat(be,"('").concat(n,"')/CreateUploadSession");return this.sendRequest({data:{value:e},method:"POST",qosEventName:"Question.CreateUploadSession",requestUri:i})},t.prototype.cancelOrDeleteUploadFile=function(t){return this.sendRequest({method:"DELETE",qosEventName:"FileUpload.CancelOrDeleteUploadFile",requestUri:t})},t.prototype.getUserInfo=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userInfo",method:"GET",qosEventName:"Function.GetUserInfo"},{disableRequestRingHeader:!0})},t.prototype.getSharedForm=function(t){return this.sendRequest({body:'{"value" : "'.concat((0,gt.NW)().sharetoken,'"}'),headers:{"Content-Type":"application/json;odata.metadata=minimal"},isSensitiveUri:!0,method:"GET",qosEventName:"SharedForm.Get",requestUri:"".concat(this.getSurveyWebOwnerServiceUrl()).concat("GetSharedForm","(formid='").concat(t,"',token='").concat((0,gt.NW)().sharetoken,"')")})},t.prototype.getDataClassificationLabelDetail=function(t,n){return this.fb({method:"GET",qosEventName:"Function.GetDataClassificationLabelDetails",requestUri:"".concat(this.getSurveyWebServiceUrl(),"/dataClassificationLabelInfo/").concat(t,"/").concat(encodeURIComponent(n))})},t.prototype.getMultilingualBaseUrl=function(t){return"".concat(this.getSurveyWebOwnerServiceUrl()).concat(pe,"('").concat(t,"')/").concat(we)},t.prototype.getSurveyWebOwnerServiceUrl=function(){return this.ownerServiceUrl},t.prototype.getSurveyWebServiceUrl=function(){return this.serviceUrl},t.prototype.getFormApiBaseServiceUrl=function(){return"".concat((0,ve.v)(),"formapi/api")},t.prototype.sendRequest=function(t,n,e){var i=this;return this.getToken().then((function(r){return t.headers=$.extend(!0,t.headers,i.getCommonHeaders(r)),he(t),(0,ae.lW)(t,n,e).then((function(t){return(0,me.D3)(t).value}),me.W3)}))},t.prototype.sendRequestWithCount=function(t,n,e){var i=this,r={Forms:[],TotalFormCount:0};return this.getToken().then((function(o){return t.headers=$.extend(!0,t.headers,i.getCommonHeaders(o)),he(t),(0,ae.lW)(t,n,e).then((function(t){var n=(0,me.D3)(t);return r.Forms=n.value,r.TotalFormCount=n.count,r}),me.W3)}))},t.prototype.getCommonHeaders=function(n){var e={Accept:"application/json",AnalyzerToken:(0,gt.NW)().AnalyzerToken,Authorization:(0,ge.U)(n),ShareInvitationKey:(0,gt.$p)().Token||(0,gt.NW)().Token||(0,gt.NW)().sharetoken,__RequestVerificationToken:(0,c.k0)().antiForgeryToken};return e=y.extend({},e,t.customizedHeaders)},t.prototype.fb=function(t,n){return t.headers=$.extend(!0,t.headers,this.getCommonHeaders("")),he(t),(0,ae.lW)(t,n).then(me.EI,me.W3)},t.customizedHeaders={},t}(),Ce="analysisForms",Ie="forms",Te="runtimeForms",ke="questions",xe="descriptiveQuestions",Fe="choices",Pe="responses",De="comments",Me="permissions",Le="responderPermissions",Re="permissionTokens",Ae="sharedWithMeForms",Ee="GetAggregateQuizData",Oe="GetAggregateSurveyData";function _e(t){function n(t){var n=null;if(t&&t.settings){0;var e=null;try{e=JSON.parse(t.settings)}catch(t){}if("poll"===t.type||t.category&&t.category.indexOf("Poll")>=0)return"Poll";e&&void 0!==e.IsQuizMode&&(n=e.IsQuizMode?"Quiz":"Form")}return n||void 0}function i(){switch((0,dt.XF)()){case"TeamsApproval":return"approval";case"TeamsReports":return"reports";default:return""}}return function(t){function r(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var i=t.apply(this,n)||this;return i.hb="aadFormLauncher",i.mb="msaFormLauncher",i}return(0,p.ZT)(r,t),r.addDefaultHeader=function(t,n){null===Ne.customizedHeaders&&(Ne.customizedHeaders={}),Ne.customizedHeaders[t]=n},r.prototype.getForms=function(t,n){var e=this.getSurveyWebOwnerServiceUrl()+"light/";return e+=Ie+Ne.getQueryParameters("?",t,n),this.sendRequest({requestUri:e,qosEventName:"Forms.Get"})},r.prototype.hardDeleteForms=function(t){var n="".concat(this.getSurveyWebOwnerServiceUrl(),"light/deleteForms");return this.sendRequest({requestUri:n,method:"POST",data:t,qosEventName:"Forms.HardDeleteForms"})},r.prototype.getFormsSharedWithCurrentUser=function(){var t=this.getSurveyWebOwnerServiceUrl()+Ae;return this.sendRequest({requestUri:t,qosEventName:"Forms.Get.SharedWithMe"})},r.prototype.getFormsSharedWithCurrentUserPro=function(t,n){var e=t?"?$skip=".concat(n,"&$top=").concat(oe()):"?$top=".concat(oe(),"&$count=true"),i=this.getSurveyWebOwnerServiceUrl()+"light/"+Ae+e;return this.sendRequestWithCount({requestUri:i,qosEventName:"Forms.Get.SharedWithMe"})},r.prototype.getCachedSimpleForms=function(t,n){var e="".concat(this.serviceUrl).concat(t,"/users/").concat(n,"/").concat("memorybasedforms");return this.sendRequest({requestUri:e,qosEventName:"Forms.GetCachedSimpleForms"})},r.prototype.getDesignForm=function(t,n){var e=this.getSurveyWebOwnerServiceUrl()+"light/";e+="forms('"+t+"')",e+=Ne.getQueryParameters("?",n);var r={FormType:i()};return this.sendRequest({requestUri:e,qosEventName:"DesignForm.Get",qosExtraData:r})},r.prototype.getAnalysisTimeForm=function(t){var n="".concat(this.getSurveyWebOwnerServiceUrl(),"light/").concat(Ce,"('").concat(t,"')?").concat("$expand=questions($expand=choices)");return this.sendRequest({requestUri:n,method:"GET",qosEventName:"AnalysisForm.Get"})},r.prototype.createOD4BSessionTempFolder=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Te+"('"+t+"')/Microsoft.FormServices.CreateOneDriveSessionTempFolder",method:"POST",qosEventName:"Form.CreateOD4BSessionTempFolder"}).then((function(t){return t?t.itemId:Promise.reject(new Error("Failed to create OneDriveForBusiness session temp folder."))}))},r.prototype.deleteSharedWithMeLink=function(t){var n=this.getSurveyWebServiceUrl()+"light/".concat(Ae,"('").concat(t,"')");return this.sendRequest({requestUri:n,method:"DELETE",qosEventName:"Forms.DeleteSharedWithMe"})},r.prototype.changeSharingStatus=function(t,n){var e=n?"On":"Off";return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/Microsoft.FormServices.Turn"+e+"AllowCopySetting",method:"POST",qosEventName:n?"FormDefinition.TurnOnFormSharing":"FormDefinition.TurnOffFormSharing"})},r.prototype.createPermissionLink=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+Me,method:"POST",data:n,qosEventName:"FormDefinition.CreateFormPermissionLink",qosExtraData:{specificShare:"User"===n.type||"Group"===n.type}})},r.prototype.deletePermissionLink=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+"permissions('"+n+"')",method:"DELETE",qosEventName:"FormDefinition.DeleteFormPermissionLink"})},r.prototype.createResponderPermissionLink=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+Le,method:"POST",data:n,qosEventName:"FormDefinition.CreateResponderFormPermissionLink",qosExtraData:{type:n.type}})},r.prototype.deleteResponderPermissionLink=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+"responderPermissions('"+n+"')",method:"DELETE",qosEventName:"FormDefinition.DeleteResponderFormPermissionLink"})},r.prototype.getFormPermissions=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+Me,method:"GET",qosEventName:"FormDefinition.GetFormPermissions"})},r.prototype.createPermissionToken=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+Re,method:"POST",data:n,qosEventName:"FormDefinition.CreateFormPermissionToken"})},r.prototype.getOrCreateFormPermissionToken=function(t,n,e){var i={};return(0,dt.Kw)()&&(i["x-ms-form-request-source"]="ms-teams"),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/Microsoft.FormServices.GetOrCreatePermissionToken",method:"POST",headers:i,data:{type:n,name:e},qosEventName:"Form.GetOrCreatePermissionToken"})},r.prototype.deletePermissionToken=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+"permissionTokens('"+n+"')",method:"DELETE",qosEventName:"FormDefinition.DeleteFormPermissionToken"})},r.prototype.getIdentityProviderType=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"authinfo/idptype?username="+encodeURIComponent(t),method:"GET",qosEventName:"Form.GetIdentityProviderType"}).then((function(t){return t.ProviderType}))},r.prototype.createForm=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie,method:"POST",data:t,headers:this.vb(),qosEventName:"Form.Create",entityType:1,qosExtraData:{FormType:n(t)}})},r.prototype.createFormByDefinition=function(t){return this.sendRequest({requestUri:"".concat(this.getSurveyWebOwnerServiceUrl(),"light/").concat(Ie),method:"POST",data:t,headers:this.vb(),qosEventName:"Form.Create",entityType:1,qosExtraData:{FormType:n(t),IsLight:!0}})},r.prototype.updateForm=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')",method:this.partialUpdateHttpMethod,data:n,qosEventName:"Form.Update",qosExtraData:{SoftDeleted:n.softDeleted},entityType:1},{disableRetry:1===n.softDeleted})},r.prototype.postFormShareAction=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+"forms('"+t+"')/shareaction",method:"POST",qosEventName:"Form.PostShareAction"})},r.prototype.createFormImageFromUrl=function(t,n,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+n,method:"POST",data:e,qosEventName:"logo"===n?"FormImage.CreateFromUrl":"ThemeImage.CreateFromUrl",qosExtraData:{FormProperty:n}})},r.prototype.deleteForm=function(t,n,e){void 0===n&&(n=""),void 0===e&&(e="");var i=(0,et.pd)((function(){}),et.t1);return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')",method:"DELETE",data:i,qosEventName:"Form.Delete"})},r.prototype.dupFormForExcel=function(t,n){var e={id:t,xlWorkbookId:n};return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie,method:"POST",data:e,qosEventName:"Excel.DuplicateFormForExcel"})},r.prototype.copyForm=function(t,n,e,i){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+"forms('"+t+"')/CopyToUser",method:"POST",data:{formId:t,newOwnerId:n,newTenantId:e,isNewOwnerGroup:i},qosEventName:"Function.CopyForm",qosExtraData:{FormId:t,NewOwnerId:n,IsNewOwnerGroup:i}},{disableRetry:!0}).then((function(t){return{id:t.id,title:t.title,createdDate:t.createdDate,modifiedDate:t.modifiedDate,settings:t.settings,xlWorkbookId:t.xlWorkbookId,ownerId:t.ownerId,ownerTenantId:t.ownerTenantId,category:t.category,otherInfo:t.otherInfo,background:t.background,softDeleted:t.softDeleted,type:t.type,fileUploadFormInfo:t.fileUploadFormInfo,status:t.status,version:t.version}}))},r.prototype.copyFormWithPatchProperties=function(t,n,e,i,r){},r.prototype.copyFormBySharingLink=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+"forms('"+t+"')/CopyBySharingLink",method:"POST",headers:{ShareInvitationKey:n},data:{formId:t,sharingToken:n},qosEventName:"Function.CopyBySharingLink",qosExtraData:{FormId:t}})},r.prototype.moveForm=function(t,n,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+"forms('"+t+"')/MoveForm",method:"POST",data:{newOwnerId:n,isNewOwnerGroup:e},qosEventName:"Function.MoveForm",qosExtraData:{FormId:t,NewOwnerId:n,IsNewOwnerGroup:e,IsDelegateMode:(0,dt.lS)()}})},r.prototype.postRecentForm=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms/"+t,data:n,method:"POST",qosEventName:"Function.PostRecentForm"})},r.prototype.getRecentForms=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms"+(null==t?"":"?ownerType="+encodeURIComponent(t)),method:"GET",qosEventName:"Function.GetRecentForms"})},r.prototype.removeRecentForm=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms/"+t,method:"DELETE",qosEventName:"Function.RemoveRecentForm"})},r.prototype.updateExperienceType=function(t,n,e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+t+"/users/"+n+"/experiencetype/"+e+"/UpdateExperienceType",method:"POST",qosEventName:"Function.UpdateExperienceType"})},r.prototype.updateLastUsedEnv=function(t,n,e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+t+"/users/"+n+"/UpdateLastUsedEnv",data:e,method:"POST",qosEventName:"Function.UpdateLastUsedEnv"})},r.prototype.updateFormsProLicense=function(t,n){var e="";t||(e="FORMS_PRO");var i="";return i="UpdateFormsProUserLicenses(licenseNames='{0}',isOptOutAction={1})".format(e,n?"true":"false"),this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+i,method:"DELETE",qosEventName:"Function.UpdateFormsProLicense"})},r.prototype.updateRecentForm=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms/"+t+"?title="+encodeURIComponent(n),method:"PUT",qosEventName:"Function.UpdateRecentForm"})},r.prototype.getFormsTenantSettings=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetFormsTenantSettings",method:"GET",qosEventName:"Function.GetFormsTenantSettings"})},r.prototype.getUserReputationTier=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userReputationTier",method:"GET",qosEventName:"Function.GetUserReputationTier"})},r.prototype.getFormCreatorPhotoDefinition=function(t){return this.gb({requestUri:this.getSurveyWebServiceUrl()+"light/GetFormCreatorDefinition('".concat(t,"','')"),method:"GET",qosEventName:"Function.GetFormCreatorPhotoDefinition"})},r.prototype.getFormCreatorPhotoValue=function(t){return this.gb({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"light/GetFormCreatorPhotoValue('".concat(t,"','')/$value"),method:"GET",qosEventName:"Function.GetFormCreatorPhotoValue"})},r.prototype.getCurrentUserPhotoValue=function(){return this.gb({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"GetCurrentUserPhotoValue",method:"GET",qosEventName:"Function.GetCurrentUserPhotoValue"})},r.prototype.getDataClassificationLabels=function(){return this.sendRequest({method:"GET",requestUri:this.getSurveyWebServiceUrl()+"GetDataClassificationLabels",qosEventName:"Function.GetDataClassificationLabels"})},r.prototype.getFormQuestion=function(t,n,e){var i=this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+"questions('"+n+"')";return e&&(i=i+"?$select="+e.toString()),this.sendRequest({requestUri:i,qosEventName:"Question.Get"})},r.prototype.createFormQuestion=function(t,n,e,i){var r=(0,p.pi)({IsQuiz:n.isQuiz,QuestionId:n.id,QuestionType:n.type},e),o={requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+ke,method:"POST",data:n,qosEventName:"Question.Create",qosExtraData:r,entityType:2};return i?this.gb(o,{},i):this.sendRequest(o)},r.prototype.createQuestionImageFromUrl=function(t,n,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+"questions('"+n+"')/image",method:"POST",data:e,qosEventName:"QuestionImage.CreateFromUrl",qosExtraData:{QuestionId:n}})},r.prototype.updateFormQuestion=function(t,n,e,i,r){var o=this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+"questions('"+n+"')",s=(0,p.pi)({QuestionType:e},r);return this.sendRequest({requestUri:o,method:this.partialUpdateHttpMethod,data:i,qosEventName:"Question.Update",qosExtraData:s,entityType:2},{disableLog:!0})},r.prototype.deleteFormQuestion=function(t,n,e,i){var r=(0,p.pi)({QuestionType:e,QuestionId:n},i);return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+"questions('"+n+"')",method:"DELETE",qosEventName:"Question.Delete",qosExtraData:r})},r.prototype.pb=function(){},r.prototype.bb=function(t){var n,e=this;if(t&&((n=(0,k.f5)())&&n.Model.FormMaster&&n.Model.FormMaster.Model.OwnerId===(0,c.k0)().userInfo.UserId)){var i=(0,k.f5)();(0,Fn.Ng)().then((function(n){if(n&&i.Model.FormMaster.Model.OwnerUserType!==n.toString()){var r={};r.ownerUserType=n.toString(),i.bulkEdit((function(t){t.FormMaster.Model.OwnerUserType=n.toString()})),e.updateForm(t,r)}})).catch((function(){(0,q.JG)({eventInfo:{Component:"FormAPI_fetchOwnerUserType",message:"Failed to fetch user type",pageName:"DesignPage",tenantId:(0,c.k0)().userInfo.TenantId,userId:(0,c.k0)().userInfo.UserId},type:"MFPUI_UserTypeFetchFailed"})}))}},r.prototype.getFormDescriptiveElement=function(t,n,e){var i=this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+"descriptiveQuestions('"+n+"')";return e&&(i=i+"?$select="+e.toString()),this.sendRequest({requestUri:i,qosEventName:"DescriptiveElement.Get"})},r.prototype.createFormDescriptiveElement=function(t,n,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+xe,method:"POST",data:n,qosEventName:"DescriptiveElement.Create",qosExtraData:(0,p.pi)({QuestionId:n.id,QuestionType:n.type},e)})},r.prototype.updateFormDescriptiveElement=function(t,n,e,i,r){var o=this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+"descriptiveQuestions('"+n+"')";return this.sendRequest({requestUri:o,method:this.partialUpdateHttpMethod,data:i,qosEventName:"DescriptiveElements.Update",qosExtraData:(0,p.pi)({QuestionType:e},r)},{disableLog:!0})},r.prototype.deleteFormDescriptiveElement=function(t,n,e,i){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+"descriptiveQuestions('"+n+"')",method:"DELETE",qosEventName:"DescriptiveElement.Delete",qosExtraData:(0,p.pi)({QuestionType:e},i)})},r.prototype.createQuestionChoice=function(t,n,e){var i=this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+"questions('"+n+"')/"+Fe;return this.sendRequest({requestUri:i,method:"POST",data:e,qosEventName:"Choice.Create"})},r.prototype.getQuestionChoice=function(t,n,e){var i=this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+"questions('"+n+"')/"+"choices("+e+")";return this.sendRequest({requestUri:i,method:"GET",qosEventName:"Choice.Get"})},r.prototype.updateQuestionChoice=function(t,n,e,i){var r=this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+"questions('"+n+"')/"+"choices("+e+")";return this.sendRequest({requestUri:r,method:this.partialUpdateHttpMethod,data:i,qosEventName:"Choice.Update"})},r.prototype.deleteQuestionChoice=function(t,n,e){var i=this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+"questions('"+n+"')/"+"choices("+e+")";return this.sendRequest({requestUri:i,method:"DELETE",qosEventName:"Choice.Delete"})},r.prototype.getFormResponses=function(t,n,e,i){var r=["$expand=comments"];n&&r.push("$filter={0}+{1}+{2}".format(n.name,n.operator,n.value)),e>=0&&i>=0&&r.push("$top={0}&$skip={1}".format(e,i));var o=r.filter((function(t){return!!t})).join("&");o=o&&"?"+o;var s=this.getSurveyWebOwnerServiceUrl()+"light/";return this.sendRequest({requestUri:s+Ie+"('"+t+"')/"+Pe+o,qosEventName:y.any(r,(function(t){return-1===t.indexOf("$filter")}))?"Responses.Get":"Responses.Get.Filter"})},r.prototype.getAnalysisTimeResponses=function(t,n,e){var i=this.getSurveyWebOwnerServiceUrl()+Ce+"('"+t+"')/"+"responses?$expand=comments";return n>=0&&e>=0&&(i+="&$top={0}&$skip={1}".format(n,e)),this.sendRequest({requestUri:i,method:"GET",qosEventName:"AnalysisTimeResponses.Get"})},r.prototype.getFormsResponseCount=function(){return this.gb({requestUri:this.getSurveyWebServiceUrl()+"light/GetRespCounts()",method:"GET",qosEventName:"Function.GetFormsResponseCount"})},r.prototype.getFormResponseCount=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+"responses/$count",qosEventName:"ResponseCount.Get"},{disableLog:!0})},r.prototype.deleteFormResponses=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+Pe,method:"DELETE",qosEventName:"Responses.Delete"})},r.prototype.deleteFormResponse=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+"responses("+n+")/",method:"DELETE",qosEventName:"Response.Delete",qosExtraData:{responseId:n}})},r.prototype.deleteFormInvites=function(t,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+"forms('"+t+"')/invites",method:"DELETE",data:n,qosEventName:"Invites.Delete"})},r.prototype.addFormResponseComment=function(t,n,e){var i={feedback:e.feedback,score:e.score,questionId:e.questionId};return e.id&&(i.id=e.id),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+"responses("+n+")/"+De,method:"POST",data:i,qosEventName:"Comment.Add"})},r.prototype.addFormResponseComments=function(t,n){return this.sendRequest({requestUri:"".concat(this.getSurveyWebOwnerServiceUrl(),"batch/").concat(Ie,"('").concat(t,"')/").concat(De),method:"POST",data:n,qosEventName:"Comments.Add"})},r.prototype.setResponseReleaseDate=function(t,n,e){var i={releaseDate:e};return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+"responses("+n+")",method:this.partialUpdateHttpMethod,data:i,qosEventName:"Response.Update"})},r.prototype.createExportFile=function(t){var n=this;return this.getToken().then((function(e){var i,r="cdb-export-iframe",o=function(t){var n=document.getElementById(t);return n&&n.parentNode.removeChild(n),(n=document.createElement("iframe")).id=t,n.name=t,n.hidden=!0,n}(r);if((i=document.createElement("form")).style.display="none",i.method="POST",i.action=n.getSurveyWebServiceUrl()+Ie+"('"+t+"')/Microsoft.FormServices.CreateExportFile",i.target=r,null!==e){var s=document.createElement("input");s.type="hidden",s.name="Authorization",s.value="Bearer "+e,i.appendChild(s)}if(null!==(0,c.k0)().antiForgeryToken){var a=document.createElement("input");a.type="hidden",a.name="__RequestVerificationToken",a.value=(0,c.k0)().antiForgeryToken,i.appendChild(a)}document.body.appendChild(o),$(o).on("load",(function(){o.contentDocument.body.appendChild(i)})),i.submit()}))},r.prototype.downloadExcelFile=function(t,n,i){var r=this,o=new Yn.o("Function.DownloadExcel");o.start();var s=3,a=this.vb(),u=this.yb({formid:t,timezoneOffset:a.__TimezoneOffset,__TimezoneId:a.__TimezoneId,minResponseId:n,maxResponseId:i}),c=function(){return r.getToken().then((function(t){var n=$.extend(!0,{},r.getCommonHeaders(t));n["x-correlationid"]=o.CorrelationId,n["x-usersessionid"]=(0,te.k)();var i=Date.now();return(0,ae.MM)({requestUri:u,headers:n}).then((function(t){return(0,p.mG)(r,void 0,void 0,(function(){var n,i;return(0,p.Jh)(this,(function(r){switch(r.label){case 0:return(i=y.find(y.keys(t.headers),(function(t){return"content-disposition"===t.toLowerCase()})))&&(n=t.headers[i].split("filename*=UTF-8''")[1]),n?[4,Promise.resolve().then(e.t.bind(e,2926,23))]:[2,Promise.reject({message:"No file name in header",response:{statusCode:t.statusCode}})];case 1:return(0,r.sent().default)(t.body,decodeURIComponent(n)),o.end({resultType:"Success"}),[2]}}))}))})).catch((function(t){var n,e=t&&t.response&&t.response.body,a=t&&t.response&&t.response.statusCode;if(!e){var l=r.wb(a,t.message,u,i);throw o.end({resultType:l.failureType,extraData:{ServiceError:l}}),l}return(n=e,new Promise((function(t,e){var i=new FileReader;i.onload=function(){return t(i.result)},i.onerror=e,i.readAsText(n)}))).then((function(t){var n=r.wb(a,t,u,i);if((711===n.innerCode||701===n.innerCode)&&s>0)return s--,void(0,se.a)().AuthContext.refreshToken().then(ee.Yq).then((function(){return c()})).catch(Dn.sl);throw o.end({resultType:n.failureType,extraData:{ServiceError:n}}),n}))}))}))};return c()},r.prototype.wb=function(t,n,e,i){var r="ExpectedFailure",o={statusCode:t,sourceUrl:e,innerCode:10203,innerMessage:n,failureType:"Failure"},s=(0,tt.d)(n);switch(s&&s.error&&(o.innerCode=parseInt(s.error.code),o.innerMessage=s.error.message,o.failureType=s.error["@ms.form.error.type"]),t){case 503:Date.now()-i>2e4?(o.innerMessage="ConnectionClosedByClient",o.innerCode=10210):o.innerCode=15503,o.failureType=r;break;case 429:o.innerMessage="TooManyRequest",o.innerCode=10208,o.failureType=r,n.includes("ManyRequestPerVM")&&(o.innerMessage="ManyRequestPerVM",o.innerCode=10209);case 0:case 502:case 504:o.innerMessage="GatewayTimeout",o.innerCode=15504,o.failureType=r;break;case 307:case 403:o.innerMessage="Blocked",o.innerCode=10207,o.failureType=r;break;default:if(void 0===t){n&&n.indexOf("Loading chunk")>=0&&(o.failureType=r)}}return o},r.prototype.getShellServiceInfo=function(t){var n,e=this,i=(0,ne.G)();return(n=i.getItem(this.hb))?Promise.resolve(JSON.parse(n)):this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetShellServiceInfo(culture='{0}')".format(t),method:"GET",qosEventName:"Function.GetShellServiceInfo"}).then((function(t){return i.setItem(e.hb,JSON.stringify(t)),t}))},r.prototype.getConsumerShellServiceInfo=function(t){var n,e=this;return(n=(0,ne.G)().getItem(this.mb))?Promise.resolve(JSON.parse(n)):this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetConsumerShellServiceInfo(culture='{0}')".format(t),method:"GET",qosEventName:"Function.GetConsumerShellServiceInfo"}).then((function(t){return window.sessionStorage.setItem(e.mb,JSON.stringify(t)),t}))},r.prototype.getShellNavBarData=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetShellServiceInfo(culture='{0}')".format(t),method:"GET",qosEventName:"QosEvent.ServiceEndpoints.Function.GetShellNavBarData"})},r.prototype.getOrNewExcelInOneDrive=function(t,n){var e=this.getSurveyWebOwnerServiceUrl()+"GetOrNewExcelInOneDrive(formid='"+t+"',forcereexport='"+n+"')";return this.sendRequest({requestUri:e,method:"GET",headers:this.vb(),qosEventName:"Action.OpenExcelInOneDrive"})},r.prototype.refreshUserInfo=function(){return this.sendRequest({method:"GET",requestUri:"".concat(this.getSurveyWebServiceUrl(),"refreshUserInfo"),qosEventName:"Function.RefreshUserInfo"})},r.prototype.getUserFeatureSettings=function(){return this.gb({requestUri:this.getSurveyWebServiceUrl()+"userfeaturesettings",method:"GET",qosEventName:"Function.GetUserFeatureSettings"})},r.prototype.updateUserFeatureSettings=function(t){return this.gb({data:JSON.stringify(t),requestUri:this.getSurveyWebServiceUrl()+"userfeaturesettings",method:"PATCH",qosEventName:"Function.UpdateUserFeatureSettings"})},r.prototype.getXlWorkbookId=function(t){var n=this.getSurveyWebServiceUrl()+"GetXlWorkbookId(formid='"+t+"')";return this.sendRequest({requestUri:n,method:"GET",headers:this.vb(),qosEventName:"Action.GetXlWorkbookId"})},r.prototype.isMemberOf=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"light/IsMemberOf('"+t+"')",method:"GET",qosEventName:"Function.IsMemberOf"},{disableXMsHeader:!0})},r.prototype.browseImage=function(t,n,e){var i={resourceId:t,itemCount:n,skipToken:e};return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/browseimage",method:"POST",data:i,qosEventName:"Decomposition.BrowseImage"})},r.prototype.getToken=function(){return(0,se.a)().AuthContext.getFormApiToken()},r.prototype.searchImage=function(t,n,e,i,r){var o={query:t,itemCount:e,lcid:(0,c.k0)().cultureInfo.Name.toLowerCase(),parameters:{license:n},skipToken:i.toString(),url:r};return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/searchimage",method:"POST",data:o,qosEventName:"Decomposition.SearchImage"})},r.prototype.getCdbToken=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=CollabDB",method:"GET",qosEventName:"Decomposition.GetCdbToken"}).then((function(t){if(t)return t;throw new Error("Failed to get CDB token via GetTokenForResource")}))},r.prototype.getOD4BToken=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=MSGraph",method:"GET",qosEventName:"Decomposition.GetOD4BToken"}).then((function(t){if(t)return"Bearer ".concat(t);throw new Error("Failed to get OneDriveForBusiness token via GetTokenForResource")}))},r.prototype.getOCPSToken=function(){var t=new Yn.o("Decomposition.GetOCPSToken");return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=OCPS",method:"GET",qosEventName:"Decomposition.GetOCPSToken"},{},t).then((function(n){if(n)return{token:"".concat(n.replace(/['"]+/g,"")),CorrelationId:t.CorrelationId};throw new Error("Failed to get OCPS token via GetTokenForResource")}))},r.prototype.getFormsProToken=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=FormsPro",method:"GET",qosEventName:"Decomposition.GetFormsProToken"}).then((function(t){if(t)return"Bearer ".concat(t);throw new Error("Failed to get FormsPro token via GetTokenForResource")}))},r.prototype.unblockPhishingForm=function(t){return this.sendRequest({requestUri:this.Sb(t)+"/unblock",method:"PATCH",qosEventName:"AdminPage.UnblockPhishingForm"})},r.prototype.confirmPhishingForm=function(t){return this.sendRequest({requestUri:this.Sb(t)+"/confirmPhishing",method:"PATCH",qosEventName:"AdminPage.ConfirmPhishingForm"})},r.prototype.deleteEvilForm=function(t){return this.sendRequest({requestUri:this.Sb(t),method:"DELETE",qosEventName:"AdminPage.DeleteEvilForm"})},r.prototype.getAdminPhishingReviewForm=function(t,n){var e=this.Sb(t);return e+=Ne.getQueryParameters("?",n),this.sendRequest({requestUri:e,method:"GET",qosEventName:"AdminPage.GetPhisingReviewForm"})},r.prototype.createAdminPhishingReviewPermissionLink=function(t,n){return this.sendRequest({requestUri:this.Sb(t)+"/permissions",method:"POST",data:n,qosEventName:"AdminPage.CreateFormPermissionLink"})},r.prototype.getRestrictedUser=function(t){return this.sendRequest({requestUri:this.Nb(t),method:"GET",qosEventName:"AdminPage.GetRestrictedUser"})},r.prototype.unblockRestrictedUser=function(t){return this.sendRequest({requestUri:this.Nb(t),method:"DELETE",qosEventName:"AdminPage.UnblockRestrictedUser"})},r.prototype.getGroups=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups",method:"GET",qosEventName:"Groups.Get"})},r.prototype.getGroupId=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groupinfo/getgroupid?onedriveweburl="+encodeURIComponent(t),method:"GET",qosEventName:"Form.GetGroupId"})},r.prototype.getGroup=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups('".concat(t,"')"),method:"GET",qosEventName:"Group.Get"})},r.prototype.getGroupOwners=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups('".concat(t,"')/owners"),method:"GET",qosEventName:"Group.GetOwners"})},r.prototype.getGroupMembers=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups('".concat(t,"')/members"),qosEventName:"Group.GetMembers"})},r.prototype.getGroupPhotoDefinition=function(t){return this.gb({requestUri:this.getSurveyWebServiceUrl()+"groups('".concat(t,"')/photo"),method:"GET",qosEventName:"Group.GetPhotoDefinition"})},r.prototype.getGroupPhotoValue=function(t){return this.gb({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"groups('".concat(t,"')/photo/$value"),method:"GET",qosEventName:"Group.GetPhotoValue"})},r.prototype.getUserPhotoValue=function(t){return this.gb({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"light/users/".concat(t,"/photo/$value"),method:"GET",qosEventName:"User.GetPhotoValue"})},r.prototype.getGroupMemberPhotoDefinition=function(t,n){return this.gb({requestUri:this.getSurveyWebServiceUrl()+"groups('".concat(t,"')/members('").concat(n,"')/photo"),method:"GET",qosEventName:"Group.GetMemberPhotoDefinition"})},r.prototype.getGroupMemberPhotoValue=function(t,n){return this.gb({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"groups('".concat(t,"')/members('").concat(n,"')/photo/$value"),method:"GET",qosEventName:"Group.GetMemberPhotoValue"})},r.prototype.getAnalysisSurveyData=function(t,n){var e=this.getSurveyWebOwnerServiceUrl()+"".concat(Ie,"('").concat(t,"')/").concat(Oe);return null!=n&&""!==n&&(e=this.getSurveyWebOwnerServiceUrl()+"light/".concat(Ie,"('").concat(t,"')/").concat(Oe,"?").concat(n)),this.sendRequest({requestUri:e,qosEventName:"Analysis.AggregateSurveyData"})},r.prototype.getFilteredResponseCount=function(t,n){var e=this.getSurveyWebOwnerServiceUrl()+"light/".concat(Ie,"('").concat(t,"')/").concat(Pe,"/$count?").concat(n);return this.sendRequest({requestUri:e,qosEventName:"Analysis.FilteredResponseCount"})},r.prototype.getAnalysisQuizData=function(t){var n=this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/"+Ee;return this.sendRequest({requestUri:n,qosEventName:"Analysis.AggregateQuizData"})},r.prototype.getResultSharingAnalysisSurveyData=function(t){var n=this.getSurveyWebOwnerServiceUrl()+Ce+"('"+t+"')/"+Oe;return this.sendRequest({requestUri:n,qosEventName:"Analysis.ResultSharingAggregateSurveyData"})},r.prototype.getResultSharingAnalysisQuizData=function(t){var n=this.getSurveyWebOwnerServiceUrl()+Ce+"('"+t+"')/"+Ee;return this.sendRequest({requestUri:n,qosEventName:"Analysis.ResultSharingAggregateQuizData"})},r.prototype.getInsights=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"insights/getinsights?formId="+encodeURIComponent(t),method:"GET",qosEventName:"Form.GetInsights"})},r.prototype.getFormsWithToken=function(t,n,e){void 0===t&&(t=!1);var i=this.getSurveyWebServiceUrl()+Ie+Ne.getQueryParameters("?",n);return this.gb({requestUri:i,qosEventName:"Forms.Get"},{skipExpiredTokenCheck:!!e},e)},r.prototype.createFormWithToken=function(t,e){return this.gb({requestUri:this.getSurveyWebServiceUrl()+Ie,method:"POST",data:t,headers:this.vb(),qosEventName:"Form.Create",qosExtraData:{FormType:n(t)},entityType:1},{},e)},r.prototype.checkAnonymousAccess=function(t){var n=this.getSurveyWebOwnerServiceUrl()+"light/"+"runtimeForms('"+t+"')";return(0,ae.lW)({requestUri:n,headers:[]},{disableLog:!0,skipExpiredTokenCheck:!0}).then((function(){return!0}),(function(t){var n=(0,de.QX)(t);if(401===n.statusCode)return!1;throw n}))},r.prototype.getMeetingInfo=function(t){var n=this.getSurveyWebServiceUrl()+"light/meetingInfo?meetingId="+t;return this.sendRequest({requestUri:n,method:"GET",qosEventName:"MeetingInfo.GetMeetingInfo"})},r.prototype.getInactiveUserByIdOrEmail=function(t){var n=this.getSurveyWebServiceUrl()+"deleteduserinfo/byidemail/"+encodeURIComponent(t);return this.sendRequest({requestUri:n,isSensitiveUri:!0,method:"GET",qosEventName:"InactiveUserByIdOrEmail.Get"})},r.prototype.getUserSettings=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userSettings",method:"GET",qosEventName:"UserSettings.Get"})},r.prototype.updateUserSettings=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userSettings",method:this.partialUpdateHttpMethod,data:t,qosEventName:"UserSettings.Update"}).then((function(){return null}))},r.prototype.getAllLocaleResources=function(t){var n=this.getMultilingualBaseUrl(t);return this.sendRequest({requestUri:n,method:"GET",qosEventName:"Locale.GetAll"}).then((function(t){return t.filter((function(t){return!!t.elementValue}))}))},r.prototype.createLocaleItem=function(t,n){return this.sendRequest({requestUri:this.getMultilingualBaseUrl(t),method:"POST",data:n,qosEventName:"LocaleItem.Create"})},r.prototype.updateLocaleItem=function(t,n){var e=this.getMultilingualBaseUrl(t)+"/'"+n.locale+"'/";return e+=n.questionId?"question/'"+n.questionId+"'/'":"form/'",e+=n.elementKey+"'",this.sendRequest({requestUri:e,method:this.partialUpdateHttpMethod,data:{ElementValue:n.elementValue},qosEventName:"LocaleItem.Update"})},r.prototype.deleteLocale=function(t,n){return this.sendRequest({requestUri:this.getMultilingualBaseUrl(t)+"/'"+n+"'",method:"DELETE",qosEventName:"Locale.Delete"})},r.prototype.copyLocaleResources=function(t,n){var e=this.getSurveyWebOwnerServiceUrl()+"batch/"+"forms('"+t+"')/"+we;return this.sendRequest({requestUri:e,method:"POST",data:n,qosEventName:"LocaleItem.Copy"})},r.prototype.getSuspiciousEvidence=function(t){var n=this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/GetSuspiciousEvidence";return this.sendRequest({requestUri:n,method:"GET",qosEventName:"SuspiciousEvidence.Get"})},r.prototype.notifyAdminForApproval=function(t){var n=this.getSurveyWebOwnerServiceUrl()+Ie+"('"+t+"')/NotifyAdminForApproval";return this.sendRequest({requestUri:n,method:"POST",qosEventName:"Function.NotifyAdminForApproval"})},r.prototype.getOrCreateShortUrl=function(t,n){var e="".concat(this.getSurveyWebOwnerServiceUrl(),"light/").concat(Ie,"('").concat(t,"')/shortUrls/").concat(n);return this.sendRequest({requestUri:e,method:"PUT",qosEventName:"ShortUrl.GetOrCreate",qosExtraData:{LinkType:n}})},r.prototype.getCSVInfo=function(t){var n=this.Ib(t.$formId)+"GetCSVInfoList";return this.sendRequest({requestUri:n,method:"GET",headers:this.vb(),qosEventName:"ResponsesPage.GetCSVInfo"})},r.prototype.getCSVDownloadLink=function(t){var n=this.Ib(t.$formId)+"DownloadCSVFile/".concat(t.$fileName);return this.sendRequest({requestUri:n,method:"GET",headers:this.vb(),qosEventName:"ResponsesPage.GetCSVDownloadLink"})},r.prototype.deleteCSVFile=function(t){var n=this.Ib(t.$formId)+"DeleteCSVFile/".concat(t.$fileName);return this.sendRequest({requestUri:n,method:"DELETE",qosEventName:"ResponsesPage.DeleteCSVFile"})},r.prototype.generateCSVFile=function(t){var n=this.Ib(t.$formId)+"GenerateCSVFile";return this.sendRequest({requestUri:n,method:"PUT",headers:this.vb(),qosEventName:"ResponsesPage.GenerateCSVFile"})},r.prototype.getArchiveAndActiveResponseCount=function(t){var n=(0,Xn.kc)(t.$formId),e=n.OwnerId,i=n.OrgId,r=n.IsGroupOwner,o="".concat(this.getFormApiBaseServiceUrl(),"/").concat(i,"/").concat(r?"groups":"users","/").concat(e,"/light/forms('").concat(t.$formId,"')/Responses/archiveandacitvecount");return this.sendRequest({requestUri:o,method:"GET",qosEventName:"Function.GetArchiveAndActiveResponseCount"})},r.prototype.gb=function(t,n,e){var i=this;return Promise.resolve(e||this.getToken()).then((function(e){return t.headers=$.extend(!0,t.headers,i.getCommonHeaders(e)),he(t),(0,ae.lW)(t,n).then((function(t){return(0,me.EI)(t)}),me.W3)}))},r.prototype.vb=function(){var t,n="undefined"!=typeof Intl?Intl.DateTimeFormat():null,e=null===(t=null==n?void 0:n.resolvedOptions())||void 0===t?void 0:t.timeZone;return{__TimezoneOffset:(new Date).getTimezoneOffset().toString(),__TimezoneId:e||""}},r.prototype.yb=function(t){return this.kb()+"formapi/DownloadExcelFile.ashx?"+$.param(t)},r.prototype.kb=function(){return this.serviceUrl.slice(0,-12)},r.prototype.Sb=function(t){return this.getSurveyWebOwnerServiceUrl()+"admin/"+"forms('"+t+"')"},r.prototype.Nb=function(t){return this.getSurveyWebOwnerServiceUrl()+"admin/RestrictedUsers/"+t},r.prototype.Ib=function(t){var n=(0,Xn.kc)(t),e=n.OwnerId,i=n.OrgId,r=n.IsGroupOwner;return"".concat(this.getFormApiBaseServiceUrl(),"/").concat(i,"/").concat(r?"groups":"users","/").concat(e,"/forms('").concat(t,"')/")},r.prototype.xb=function(t,n){void 0===n&&(n=!1);var e=(0,Xn.kc)(t),i=e.OwnerId,r=e.OrgId,o=e.IsGroupOwner;return"".concat(this.getFormApiBaseServiceUrl(),"/").concat(r,"/").concat(o?"groups":"users","/").concat(i,"/forms('").concat(t,"')/notificationsettings")},r.prototype.Fb=function(t,n){var e=(0,p.pi)({},n);return e.InvitationList&&(e.InvitationList=JSON.stringify(e.InvitationList)),e},r.prototype.getNotificationSettings=function(t){return this.sendRequest({requestUri:this.xb(t),method:"GET",qosEventName:"SmartNotification.GetNotificationSettings"}).then((function(t){return t.InvitationList&&(t.InvitationList=(0,tt.d)(t.InvitationList)),t})).catch((function(){return null}))},r.prototype.updateNotificationSettings=function(t,n){return this.sendRequest({requestUri:this.xb(t),method:"PATCH",qosEventName:"SmartNotification.PatchNotificationSettings",data:this.Fb(t,n)})},r.prototype.createNotificationSettings=function(t,n){return this.sendRequest({requestUri:this.xb(t,!0),method:"POST",qosEventName:"SmartNotification.PostNotificationSettings",data:this.Fb(t,n)})},r}(t)}var Be=function(){function t(){}return t.prototype.getMixinFormApi=function(){return t.FormApiClass||(t.FormApiClass=_e(Ne)),t.FormApiClass},t}(),He=e(39923),Ge={Action:He.J4.reference(),AllFormList:He.J4.collectionOf(He.J4.reference()),AllFormListLoadState:He.J4.reference(),AllSharedFormList:He.J4.collectionOf(He.J4.reference()),Analysis:He.J4.boolean(),BranchingElementId:He.J4.string(),CdsInfoAvailableInUrl:He.J4.boolean(),CdsList:He.J4.reference(),CdsValidationMap:He.J4.reference(),CopyFormId:He.J4.string(),CriticalError:He.J4.reference(),CurrentProject:He.J4.reference(),CustomerVoiceDefaultEmailTemplates:He.J4.reference(),CustomerVoiceDefaultETsLoadState:He.J4.reference(),CustomerVoiceEmailTemplates:He.J4.reference(),CustomerVoiceView:He.J4.reference(),AllProjects:He.J4.reference(),AlertRules:He.J4.reference(),SMList:He.J4.reference(),ProjectMetrics:He.J4.reference(),FilterObj:He.J4.reference(),CurrentAggregateThemeList:He.J4.reference(),DataIdeas:He.J4.boolean(),DefaultCdsId:He.J4.string(),DefaultCdsInfoLoadState:He.J4.reference(),DefaultCdsUrl:He.J4.string(),DelegateInactiveUser:He.J4.reference(),EnvironmentListLoadState:He.J4.reference(),ErrorBarMessage:He.J4.string(),ErrorLevel:He.J4.reference(),ExecuteDownloadExcel:He.J4.boolean(),ExperienceType:He.J4.reference(),FlexPane:He.J4.reference(),ForceDesktopView:He.J4.boolean(),FormCollectionType:He.J4.reference(),FormId:He.J4.string(),FormList:He.J4.collectionOf(He.J4.reference()),FormListLoadState:He.J4.reference(),FormMaster:He.J4.reference(),FormsProToken:He.J4.string(),FormsTenantSettings:He.J4.reference(),Grading:He.J4.reference(),GroupMaster:He.J4.reference(),GroupMruFormListLoadState:He.J4.reference(),Host:He.J4.string(),InfoBarMessageType:He.J4.string(),IntelligenceSuggestionStatus:He.J4.reference(),IsDefaultCds:He.J4.boolean(),LastActiveTime:He.J4.number(),LastUsedEnv:He.J4.reference(),Locale:He.J4.string(),MeetingInfo:He.J4.reference(),pendingCalls:He.J4.reference(),PlaceholderList:He.J4.collectionOf(He.J4.reference()),PopupDialog:He.J4.reference(),Preview:He.J4.reference(),PreviousFlexPane:He.J4.reference(),RecycleBin:He.J4.collectionOf(He.J4.reference()),RelativeScrolHeight:He.J4.number(),ResponsePipeData:He.J4.reference(),Scenario:He.J4.string(),SearchContent:He.J4.string(),SectionElementId:He.J4.string(),SelectedCdsId:He.J4.string(),SelectedCdsRegion:He.J4.string(),SelectedCdsUrl:He.J4.string(),SelectedPortalForm:He.J4.reference(),SenderList:He.J4.reference(),SharedWithMeFormList:He.J4.collectionOf(He.J4.reference()),SharedWithMeFormListLoadState:He.J4.reference(),SharingToken:He.J4.string(),ShouldDisableAllClick:He.J4.boolean(),ShowBlockUsingFormsWarningPage:He.J4.boolean(),ShowExcelSurveyIntroductionDialog:He.J4.boolean(),ShowGroupListInPortal:He.J4.boolean(),ShowShimmer:He.J4.boolean(),ShowXLUnsyncedDialog:He.J4.boolean(),Store:He.J4.boolean(),TenantCountryCode:He.J4.string(),Title:He.J4.string(),Token:He.J4.string(),TopView:He.J4.reference(),UserActivities:He.J4.reference(),ValidationChecked:He.J4.reference(),XlWorkbookId:He.J4.string(),SurveyReportId:He.J4.string(),ResponseList:He.J4.reference(),LastPageIndex:He.J4.number(),Designer:He.J4.boolean(),DesignerCalloutType:He.J4.reference(),RandomizationCalloutType:He.J4.reference(),SidePaneVisible:He.J4.boolean(),NavPanelOpen:He.J4.boolean(),CurrentAlert:He.J4.reference(),CurrentAlertlist:He.J4.reference(),ShowCVSimplifiedEditor:He.J4.string(),OpenBranchingPanel:He.J4.boolean(),isAllProjectListLoaded:He.J4.boolean(),AddSimplifiedLogic:He.J4.reference(),RespondentList:He.J4.reference(),ResponseMap:He.J4.reference(),ResponseCount:He.J4.number(),FilteredResponseCount:He.J4.number(),DeletedResponseCount:He.J4.number(),UserTenantLevelSetting:He.J4.reference(),UserCVLicense:He.J4.boolean()},qe=function(t){function n(){var n=t.call(this)||this;return n.Pb=n.Pb.bind(n),n.bulkEdit((function(){var t=n.Model;t.Analysis=!1,t.BranchingElementId=null,t.IntelligenceSuggestionStatus={QuestionSuggestion:"Default",ThemeSuggestion:"Default",EstimatedTime:"Default"},t.DataIdeas=!1,t.IntelligeceQuestionSuggestionStatus="Default",t.PopupDialog="None",t.Store=!1,t.Grading=null,t.FormListLoadState="NotStarted",t.SharedWithMeFormListLoadState="NotStarted",t.GroupMruFormListLoadState="NotStarted",t.FormCollectionType="OwnedForms",t.MeetingInfo=null,t.SectionElementId=null,n.Model.LastActiveTime=Date.now(),t.CopyFormId=null,t.SharingToken=null,t.FormsTenantSettings={bingImageSearch:!1,externalCollaboration:!0,externalSendForm:!0,externalShareCollaboration:!0,externalShareResult:!0,externalShareTemplate:!0,InOrgSurveyIncentive:!0,recordIdentityByDefault:!0,OverSurveyManagement:!1,OverSurveyManagementDays:0,allowRecordIdentity:!0,allowFileUpload:!0,RestrictSurveyAccessEnabled:!1}})),n.Db(),n}return(0,p.ZT)(n,t),n.getInstance=function(){return this.instance||(this.instance=new n),this.instance},n.prototype.Db=function(){var t=this;["mousedown","keydown","touchstart"].forEach((function(n){return document.addEventListener(n,t.Pb,!0)}))},n.prototype.Pb=function(){var t=Date.now();this.Model.LastActiveTime<t-1e3&&(this.Model.LastActiveTime=Date.now())},n}(_.d.createObjectMasterClass("DesignPageUxState",Ge)),Ve=e(25366),ze=e(90819),Qe=e(3920),Ue={Action:He.J4.reference(),Analysis:He.J4.boolean(),BottomView:He.J4.reference(),DesignerView:He.J4.reference(),CopyFormId:He.J4.string(),CriticalError:He.J4.reference(),ErrorBarMessage:He.J4.string(),ErrorLevel:He.J4.reference(),FormCollectionType:He.J4.reference(),FormId:He.J4.string(),FormList:He.J4.collectionOf(He.J4.reference()),FormListLoadState:He.J4.reference(),FormMaster:He.J4.reference(),FormsTenantSettings:He.J4.reference(),InfoBarMessageType:He.J4.string(),LastActiveTime:He.J4.number(),Locale:He.J4.string(),QuestionId:He.J4.string(),QuestionInDesign:He.J4.reference(),SelectedPortalForm:He.J4.reference(),SharingToken:He.J4.string(),ShouldDisableAllClick:He.J4.boolean(),ShowHeadBar:He.J4.boolean(),ShowSavingSpinner:He.J4.boolean({IsLocalField:!0}),SurveyResults:He.J4.boolean(),Title:He.J4.string(),Token:He.J4.string()},$e=function(t){function n(){var n=t.call(this)||this;return n.Pb=n.Pb.bind(n),n.bulkEdit((function(t){t.Action="None",t.BottomView="None",t.DesignerView="None",t.FormListLoadState="NotStarted",t.FormCollectionType="OwnedForms",t.QuestionId=null,t.ShowHeadBar=!0,t.ShowSavingSpinner=!1,n.Model.LastActiveTime=Date.now(),t.FormsTenantSettings={bingImageSearch:!1,externalCollaboration:!0,externalSendForm:!0,externalShareCollaboration:!0,externalShareResult:!0,externalShareTemplate:!0,InOrgSurveyIncentive:!0,recordIdentityByDefault:!0,OverSurveyManagement:!1,OverSurveyManagementDays:0,allowRecordIdentity:!0,allowFileUpload:!0,RestrictSurveyAccessEnabled:!1}})),n.addRule({InterestedFields:[n.Schema.FormMaster],Name:"ClearRouting",onChange:function(t){n.Model.FormMaster||n.Lb()}}),n.addRule({InterestedFields:[n.Schema.QuestionInDesign],Name:"DesignQuestion",onChange:function(t){n.Model.QuestionInDesign?n.Model.QuestionId=n.Model.QuestionInDesign.Model.Id:n.Model.QuestionId=null}}),n.Db(),n}return(0,p.ZT)(n,t),n.getInstance=function(){return this.instance||(this.instance=new n),this.instance},n.prototype.Lb=function(){var t=this;this.bulkEdit((function(){var n=t.Model;n.FormMaster=void 0,n.Analysis=!1,n.BottomView="None",n.DesignerView="None",n.QuestionId=null,n.ShowHeadBar=!0,n.SurveyResults=!1}))},n.prototype.Db=function(){var t=this;["mousedown","keydown","touchstart"].forEach((function(n){return document.addEventListener(n,t.Pb,!0)}))},n.prototype.Pb=function(){var t=Date.now();this.Model.LastActiveTime<t-1e3&&(this.Model.LastActiveTime=Date.now())},n}(_.d.createObjectMasterClass("MobileDesignPageUxState",Ue)),je=e(40554),We=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){var t={ButtonsProps:[{ClassName:"upload-question-cancel-continue-button",ConveyDescription:!0,GlyphButtonStyle:"Horizontal",Key:"deleteItem",onClick:this.props.clickContinueButton,Text:(0,T.pm)().UploadFile_Dialog_Continue_Button,Title:(0,T.pm)().UploadFile_Dialog_Continue_Text}],ClassName:"upload-question-button-container",Description:this.props.description,FluentIcon:"Folder",IconClassName:"forms-icon-size36x36 upload-question-icon-class",ShowDialog:!0,TrapFocus:!1};return g.createElement("div",{className:"upload-question-confirm-dialog"},(0,je.s)(t))},n}(J.r);function Ke(t){return function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var i=t.apply(this,n)||this;return i.initializing?i.initializing.resolve():(0,q.$U)("ResponsePage.FormMasterMixin.initializing.undefined",{formMasterAttrs:Object.keys(i),isBasicLoaded:!(!window.$||!window._)}),i}return(0,p.ZT)(n,t),n}(t)}var Je=e(48333);var Ze,Xe=e(41293),Ye=e(41350),ti=e(46008);function ni(){return Ze||(Ze=new ei)}var ei=function(){function t(){this.Rb=new Ye.Y,this.Ab={}}return t.isValidUser=function(t){return!!(t&&t.userId&&t.displayName)},t.prototype.registerUsersStateChange=function(t){this.Rb.register(t)},t.prototype.unregisterUsersStateChange=function(t){this.Rb.unregister(t)},t.prototype.getUser=function(t){return y.clone(this.Ab[t])},t.prototype.getAllUsers=function(){return y.values((0,ti.I8)(this.Ab))},t.prototype.getUserCount=function(){return y.keys(this.Ab).length},t.prototype.addOrUpdateUser=function(n){if(t.isValidUser(n)){var e=this.Ab[n.userId];if(null!=e){if(t.isValidUser(e))return;y.extend(e,n)}else this.Ab[n.userId]=n;this.Rb.trigger()}},t.prototype.removeUser=function(t){delete this.Ab[t.userId]&&this.Rb.trigger()},t.prototype.removeAllUsers=function(){this.getUserCount()>0&&(this.Ab={},this.Rb.trigger())},t}(),ii=e(63795),ri=e(20987),oi=e(61018),si=function(){function t(){this.Eb={}}return t.createNotificationProvider=function(n,e,i){return this.notificationProvider||(this.notificationProvider=new t),this.notificationProvider},t.prototype.close=function(t){this.Eb[t]&&(this.Eb[t].close(),delete this.Eb[t])},t.prototype.open=function(t,n){if(!t)return Promise.reject("PushNotification has no formId.");this.close(t);var e=(0,Xn.kc)(t);return this.Ob(t,n,e)},t.prototype.Ob=function(t,n,e,i){return this.Eb[t]=new ai(oi.VY.getInstance().getCollabDBServiceUrl(),e.OrgId,e.OwnerId,e.TableId,e.IsGroupOwner,e.ContainerId,i),this.Eb[t].open(n)},t}(),ai=function(){function t(t,n,e,i,r,o,s){this._b=(0,O.GW)(),this.Bb=!0,this.Hb=null,this.Gb=0,this.qb=ui.MaxRetryCount;var a=(0,ii.Ee)(t,"/");s&&(a=ui.ComposedCDBRealtimeSliceFormat.format(s,a)),this.Vb=!1;var u=(0,Ct.vj)("RealtimeAzureConnectionPercentage",0);if(u>=0&&u<=100){var c=this.zb(e+i);this.Vb=Math.abs(c)%100<u}this.Vb?this.Qb=(r?ui.CDBRealtimeAzureUrlForGroupsFormat:ui.CDBRealtimeAzureUrlForUsersFormat).format(a,n,e,i):this.Qb=(r?ui.CDBRealtimeUrlForGroupsFormat:ui.CDBRealtimeUrlForUsersFormat).format(a,n,e,i),this.Ub=o}return t.prototype.reconnect=function(){this.Hb.stop(),this.Hb.start()},t.prototype.close=function(){var t=this;this.Bb=!0;var n=function(){4!==t.Hb.state&&t.$b(ui.UserHubName,ui.Leave).finally((function(){t.Hb.stop(!0,!0)}))};null!=this.Hb&&(0===this.Hb.state||2===this.Hb.state?this.Hb.stateChanged(n):n())},t.prototype.open=function(t){var n,e=this;return this.jb(this.Qb),(t=y.clone(t)).onFormUpdated&&this.Wb(ui.TableDefinitionHubName,ui.TableUpdated,(function(n,e){t.onFormUpdated(ci.toFormUpdatePayload(e),ci.toUserPayload(e._modifiedBy))})),t.onFormElementAdded&&this.Wb(ui.TableDefinitionHubName,ui.ColumnAdded,(function(n,e){"Comments"!==n.propertyName&&"ReleaseDate"!==n.propertyName&&"FormsProData"!==n.propertyName&&t.onFormElementAdded(ci.toFormElementPayload(e),ci.toUserPayload(e._modifiedBy))})),t.onFormElementDeleted&&this.Wb(ui.TableDefinitionHubName,ui.ColumnDeleted,(function(n,e){t.onFormElementDeleted(n.propertyName,ci.toUserPayload(e._modifiedBy))})),t.onFormElementUpdated&&this.Wb(ui.TableDefinitionHubName,ui.ColumnUpdated,(function(n,e){t.onFormElementUpdated(n.propertyName,ci.toFormElementUpdatePayload(e),ci.toUserPayload(e._modifiedBy))})),t.onChoiceAdded&&this.Wb(ui.TableDefinitionHubName,ui.ChoiceAdded,(function(n,e){t.onChoiceAdded(n.propertyName,ci.toChoicePayload(n,e),ci.toUserPayload(e._modifiedBy))})),t.onChoiceDeleted&&this.Wb(ui.TableDefinitionHubName,ui.ChoiceDeleted,(function(n,e){t.onChoiceDeleted(n.propertyName,n.choiceId,ci.toUserPayload(e._modifiedBy))})),t.onChoiceUpdated&&this.Wb(ui.TableDefinitionHubName,ui.ChoiceUpdated,(function(n,e){t.onChoiceUpdated(n.propertyName,n.choiceId,ci.toChoicePayload(n,e),ci.toUserPayload(e._modifiedBy))})),t.onResponseAdded&&this.Wb(ui.TableDataHubName,ui.RowAdded,(function(n,e){t.onResponseAdded(ci.toResponsePayload(e))})),t.onResponseDeleted&&this.Wb(ui.TableDataHubName,ui.RowDeleted,(function(n,e){t.onResponseDeleted(Number(n._id),{modifiedBy:ci.toUserPayload(e._modifiedBy),modifiedDateTime:new Date(e._modifiedBy.ModifiedDateTime)})})),t.onResponsesAllDeleted&&this.Wb(ui.TableDataHubName,ui.RowsAllDeleted,(function(n,e){t.onResponsesAllDeleted({modifiedBy:ci.toUserPayload(e._modifiedBy),modifiedDateTime:new Date(e._modifiedBy.ModifiedDateTime)})})),t.onResponseUpdated&&this.Wb(ui.TableDataHubName,ui.RowUpdated,(function(n,e){t.onResponseUpdated(Number(n._id),ci.toResponseUpdatePayload(e))})),t.onCommentAdded&&this.Wb(ui.TableDataHubName,ui.RelatedRecordAdded,(function(n,e,i){ci.isCommentPayload(n)&&t.onCommentAdded(Number(n.rowId),ci.toCommentPayload(i),{modifiedBy:ci.toUserPayload(e.modifiedBy),modifiedDateTime:new Date(e.modifiedDateTime)})})),t.onCommentDeleted&&this.Wb(ui.TableDataHubName,ui.RelatedRecordDeleted,(function(n,e,i){ci.isCommentPayload(n)&&t.onCommentDeleted(Number(n.rowId),Number(n.id),{modifiedBy:ci.toUserPayload(e.modifiedBy),modifiedDateTime:new Date(e.modifiedDateTime)})})),t.onLocaleResourceAdded&&this.Wb(ui.TableDefinitionHubName,ui.LocaleResourceAdded,(function(n,i){if(i){var r=i.localeResources;r.forEach((function(t){t.elementKey=e.Jb(t.elementKey)})),t.onLocaleResourceAdded(r,ci.toUserPayload(i._modifiedBy))}})),t.onLocaleResourceUpdated&&this.Wb(ui.TableDefinitionHubName,ui.LocaleResourceUpdated,(function(n,i){if(i){var r=y.clone(i);delete r._modifiedBy,r.elementKey=e.Jb(r.elementKey),t.onLocaleResourceUpdated(r,ci.toUserPayload(i._modifiedBy))}})),t.onLocaleResourceDeleted&&this.Wb(ui.TableDefinitionHubName,ui.LocaleResourceDeleted,(function(n,e){e&&t.onLocaleResourceDeleted(e,ci.toUserPayload(e._modifiedBy))})),t.onUserConnected&&this.Wb(ui.UserHubName,ui.UserConnected,(function(n,e){t.onUserConnected(ci.toUserPayload(n))})),t.onUserDisconnected&&this.Wb(ui.UserHubName,ui.UserDisconnected,(function(n,e){t.onUserDisconnected(ci.toUserPayload(n))})),this.Wb(ui.TableDefinitionHubName,ui.ForceReconnect,(function(){e.reconnect()})),this.Hb.starting((function(){(0,q.RF)("DataProvider.RealtimeClient.Connection.Starting",{clientId:e.getClientId(),connectionId:e.Hb.id,host:(0,_t.Lp)(e.Qb),azureSignalr:e.Vb})})),this.Hb.connectionSlow((function(){(0,q.RF)("DataProvider.RealtimeClient.Connection.Slow",{clientId:e.getClientId(),connectionId:e.Hb.id,host:(0,_t.Lp)(e.Qb),azureSignalr:e.Vb}),t.onConnectionSlow&&t.onConnectionSlow()})),this.Hb.error((function(i){(0,q.RF)("DataProvider.RealtimeClient.Connection.Error",{clientId:e.getClientId(),connectionId:e.Hb.id,host:(0,_t.Lp)(e.Qb),azureSignalr:e.Vb,error:e.Zb(i)}),n={errorObject:i},t.onConnectionError&&t.onConnectionError(i)})),this.Hb.reconnecting((function(){(0,q.RF)("DataProvider.RealtimeClient.Connection.Reconnecting",{clientId:e.getClientId(),connectionId:e.Hb.id,host:(0,_t.Lp)(e.Qb),azureSignalr:e.Vb}),t.onConnectionReconnecting&&t.onConnectionReconnecting()})),this.Hb.reconnected((function(){(0,q.RF)("DataProvider.RealtimeClient.Connection.Reconnected",{clientId:e.getClientId(),connectionId:e.Hb.id,host:(0,_t.Lp)(e.Qb),azureSignalr:e.Vb}),t.onConnectionReconnected&&t.onConnectionReconnected(void 0)})),this.Hb.disconnected((function(){if((0,q.RF)("DataProvider.RealtimeClient.Connection.Disconnected",{clientId:e.getClientId(),connectionId:e.Hb.id,remainingRetryCount:e.qb,host:(0,_t.Lp)(e.Qb),azureSignalr:e.Vb,lastError:n&&e.Zb(n.errorObject)}),e.qb-- >0){e.Gb++;var i={reconnectingCount:e.Gb,refreshToken:n&&n.errorObject&&n.errorObject.context&&401===n.errorObject.context.status,retryCount:ui.MaxRetryCount-e.qb,onSuccess:t.onConnectionReconnected,onError:t.onConnectionFailed};e.Xb(i).then((function(){n=void 0})).catch((function(){}))}else(0,q.RF)("DataProvider.RealtimeClient.Connection.Failed",{clientId:e.getClientId(),connectionId:e.Hb.id,lastError:n&&e.Zb(n.errorObject),host:(0,_t.Lp)(e.Qb),azureSignalr:e.Vb}),t.onConnectionDisconnected&&t.onConnectionDisconnected()})),(0,ri.Au)()&&(this.Hb.logging=!0,this.Hb.received((function(t){var n=new Date;console.log("[%s] %s: Received message: {%s}",n.toTimeString(),e._b,JSON.stringify(t))}))),this.Bb=!1,this.Xb({onSuccess:t.onConnectionStarted,onError:t.onConnectionFailed})},t.prototype.getClientId=function(){return this._b},t.prototype.zb=function(t){return t.split("").reduce((function(t,n){return(t<<5)-t+n.charCodeAt(0)|0}),0)},t.prototype.Jb=function(t){switch(t){case"thankyoumessage":return"thankYouMessage";case"formclosemessage":return"formCloseMessage";case"leftdescription":return"leftDescription";case"rightdescription":return"rightDescription";case"formsprortlocaleldescription":return"formsprortlocaleldescription";case"formsprortlocalerdescription":return"formsprortlocalerdescription";case"formsprocustomplaceholder":return"formsprocustomplaceholder";case"footertext":return"footerText";case"conditionalthankyoumessage":return"conditionalThankyouMessage";default:return t}},t.prototype.jb=function(t){this.Hb=$.hubConnection(t,{useDefaultPath:!1}),this.Hb.createHubProxy(ui.TableDefinitionHubName),this.Hb.createHubProxy(ui.TableDataHubName),this.Hb.createHubProxy(ui.UserHubName),this.Hb.qs={},this.ty()},t.prototype.ny=function(t){if(null==this.Hb)throw Error("Realtime connection has not been created yet.");var n=this.Hb.proxies[t.toLocaleLowerCase()];if(null==n)throw Error("Cannot find hub proxy {0}".format(t));return n},t.prototype.ey=function(t){var n=this;return oi.VY.getInstance().createDataProvider().getCdbToken().then((function(t){var e=t,i="Bearer ";e&&e.startsWith(i)&&(e=e.substring(i.length)),n.Hb.accessToken=e}))},t.prototype.ty=function(){this.Ub&&"0"!==this.Ub&&(this.Hb.qs=(0,p.pi)((0,p.pi)({},this.Hb.qs),{ContainerId:this.Ub}))},t.prototype.$b=function(t,n){for(var e,i=this,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(this.iy()){var s=new Yn.o("Connection.InvokeRemoteMethod");return s.start(),(0,Ft.Px)((e=this.ny(t)).invoke.apply(e,(0,p.ev)([n],r,!1))).then((function(t){return s.end({resultType:"Success",extraData:{clientId:i.getClientId(),connectionId:i.Hb.id,host:(0,_t.Lp)(i.Qb),azureSignalr:i.Vb,methodName:n}}),t}),(function(t){return s.end({resultType:i.iy()?"Failure":"ExpectedFailure",extraData:{clientId:i.getClientId(),connectionId:i.Hb.id,host:(0,_t.Lp)(i.Qb),azureSignalr:i.Vb,methodName:n,error:i.Zb(t)}}),t}))}return Promise.reject("Realtime connection has not been established yet.")},t.prototype.iy=function(){return null!=this.Hb&&1===this.Hb.state},t.prototype.Wb=function(t,n,e){e&&this.ny(t).on(n,e)},t.prototype.Zb=function(t){return t&&JSON.stringify(t,["message","description","transport"])},t.prototype.Xb=function(t){var n=this;if(this.Bb)return Promise.reject("Connection disposed");var e=new Promise((function(e,i){var r=new Yn.o("Connection.ConnectToCDBSignalR"),o=function(){r.end({resultType:"Success",extraData:{clientId:n.getClientId(),connectionId:n.Hb.id,host:(0,_t.Lp)(n.Qb),azureSignalr:n.Vb,reconnectingCount:t.reconnectingCount,retryCount:t.retryCount}}),n.qb=ui.MaxRetryCount,n.$b(ui.UserHubName,ui.Join),n.$b(ui.UserHubName,ui.GetActiveUsers).then((function(t){e(t)}),(function(t){i(t)}))},s=function(e){r.end({resultType:"Failure",extraData:{clientId:n.getClientId(),connectionId:n.Hb.id,host:(0,_t.Lp)(n.Qb),azureSignalr:n.Vb,reconnectingCount:t.reconnectingCount,retryCount:t.retryCount,connectionError:e.source?n.Zb(e):void 0,serviceError:e.source?void 0:JSON.stringify(e,["message","statusCode","statusText","innerCode"])}}),i(e)};r.start(),n.ey(t.refreshToken).then((function(){return n.Hb.start().then(o,s)}),(function(t){s(t),(0,q.RF)("DataProvider.RealtimeClient.Connection.Failed",{clientId:n.getClientId(),connectionId:n.Hb.id,host:(0,_t.Lp)(n.Qb),azureSignalr:n.Vb,lastError:n.Zb(t)})}))}));return t.onSuccess&&e.then((function(n){return t.onSuccess(n)})),t.onError&&e.catch((function(n){return t.onError(n)})),e},t}(),ui=function(){function t(){}return t.TableDefinitionHubName="TableDefinitionChangeHub",t.TableDataHubName="TableChangeHub",t.UserHubName="TableActivityHub",t.TableUpdated="tableDefinitionUpdated",t.ColumnAdded="columnDefinitionAdded",t.ColumnDeleted="columnDefinitionDeleted",t.ColumnUpdated="columnDefinitionUpdated",t.ChoiceAdded="choiceAdded",t.ChoiceUpdated="choiceUpdated",t.ChoiceDeleted="choiceDeleted",t.RowAdded="rowAdded",t.RowDeleted="rowDeleted",t.RowsAllDeleted="rowsAllDeleted",t.RowUpdated="rowUpdated",t.RelatedRecordAdded="relatedRecordAdded",t.RelatedRecordDeleted="relatedRecordDeleted",t.LocaleResourceAdded="localeResourceAdded",t.LocaleResourceUpdated="localeResourceUpdated",t.LocaleResourceDeleted="localeResourceDeleted",t.ForceReconnect="forceReconnect",t.UserConnected="userConnected",t.UserDisconnected="userDisconnected",t.GetActiveUsers="GetActiveUsers",t.Join="Join",t.Leave="Leave",t.MaxRetryCount=3,t.ComposedCDBRealtimeSliceFormat="{0}.{1}:797",t.ComposedCDBRealtimeAzureSliceFormat="{0}.{1}:779",t.CDBRealtimeUrlForUsersFormat="https://{0}/realtime/beta/{1}/users/{2}/tables/{3}/$notifications",t.CDBRealtimeUrlForGroupsFormat="https://{0}/realtime/beta/{1}/groups/{2}/tables/{3}/$notifications",t.CDBRealtimeAzureUrlForUsersFormat="https://{0}/realtimeazure/beta/{1}/users/{2}/tables/{3}/$azurenotifications",t.CDBRealtimeAzureUrlForGroupsFormat="https://{0}/realtimeazure/beta/{1}/groups/{2}/tables/{3}/$azurenotifications",t}(),ci=function(){function t(){}return t.toFormUpdatePayload=function(n){return n&&t.normalize({id:void 0,tableId:n.id,title:n.displayName,createdBy:n.createBy,modifiedDate:n.dateTimeLastUpdated,description:n.description,settings:n.formSettings,otherInfo:n.otherInfo,questions:void 0,header:t.toImagePayload(n.header),logo:t.toImagePayload(n.logo),background:t.toImagePayload(n.background),thankYouMessage:n.thankYouMessage,version:n.version,xlWorkbookId:n.xlWorkbookId,xlExportingTag:n.xlExportingTag,xlFileUnSynced:n.xlFileUnSynced,xlUnsyncedReason:n.xlUnsyncedReason,permissionTokens:t.toPermissionTokenPayload(n.permissionTokens),onlineSafetyLevel:n.onlineSafetyLevel,reputationTier:t.toReputationTier(n.onlineSafetyLevel),formsProRTTitle:n.formsProRTTitle,formsProRTDescription:n.formsProRTDescription})},t.toFormElementPayload=function(n){return n&&{id:n.propertyName,title:n.description||n.title||n.displayName,defaultValue:n.defaultValue,subtitle:n.subtitle,required:n.required,type:n.questionType,questionInfo:n.questionInfo,order:n.order,version:void 0,modifiedDate:n.questionModifiedDate,status:n.status,image:t.toImagePayload(n.image),isQuiz:n.isQuiz,titleHasPhishingKeywords:n.titleHasPhishingKeywords,subtitleHasPhishingKeywords:n.subtitleHasPhishingKeywords,formsProRTQuestionTitle:n.formsProRTQuestionTitle,formsProRTSubtitle:n.formsProRTSubtitle,choices:n.choices,groupId:n.columnGroupName,fileUploadSPOInfo:n.fileUploadSPOInfo&&JSON.parse(n.fileUploadSPOInfo),questionTagForIntelligence:n.questionTagForIntelligence,insightsInfo:n.insightsInfo,isFromSuggestion:n.isFromSuggestion}},t.toChoicePayload=function(n,e){return e&&t.normalize({id:n.choiceId,customProperties:e.customProperties,description:e.description,displayText:e.displayText,formsProDisplayRTText:e.formsProDisplayRTText,key:e.key,order:e.order})},t.toFormElementUpdatePayload=function(n){return t.normalize(t.toFormElementPayload(n))},t.toUserPayload=function(t){return{userId:t.Id||t.userId,displayName:t.DisplayName||t.displayName,firstName:t.FirstName||t.firstName,lastName:t.LastName||t.lastName,email:t.Email||t.email}},t.toImagePayload=function(t){return t?null==t.ResourceId||null!=t.ResourceUrl?{altText:t.AltText,contentType:t.ContentType,fileIdentifier:t.FileIdentifier,originalFileName:t.OriginalFileName,resourceId:t.ResourceId,resourceUrl:t.ResourceUrl}:void(0,q.zU)("InvalidCdbImagePayload"):t},t.toPermissionTokenPayload=function(t){return t?JSON.parse(t).map((function(t){return{principalId:t.PrincipalId,name:t.Name,type:t.Type}})):t},t.toResponsePayload=function(n){return null==n?n:{id:null==n._id?void 0:Number(n._id),startDate:n.StartDate,submitDate:n.SubmitDate,responder:n.Responder,responderName:n.ResponderName,answers:t.toAnswers(n),quizResult:void 0,releaseDate:n.ReleaseDate}},t.toAnswers=function(t){var n=y.difference(Object.keys(t).filter((function(t){return"_"!==t[0]})),["SubmitDate","ResponderName","Responder","StartDate","Comments_comments","Comments","ReleaseDate"]);return JSON.stringify(n.map((function(n){return{questionId:n,answer1:t[n]}})))},t.toResponseUpdatePayload=function(n){var e=t.normalize(t.toResponsePayload(n));return delete e.answers,e},t.isCommentPayload=function(t){return t&&"Comments_comments"===t.propertyName},t.toCommentPayload=function(n){return n&&{id:n.id,feedback:n.text,score:n.number,questionId:n.columnReference,createdDateTime:n.createdDateTime,createdBy:t.toUserPayload(n.createdBy)}},t.toReputationTier=function(t){return 0===t?1:80&t?4:8&t?0:2&t||16&t?3:128&t?2:1},t.normalize=function(t){var n=t;for(var e in n)void 0===n[e]&&delete n[e];return n},t}(),li=e(96680),fi=e(93271),hi=e(91091);var di=e(22810),mi=e(81380),vi=e(82963),gi=e(74871),pi=e(82205),bi=e(41275);var yi,wi=e(39271),Si=e(85866),Ni=e(51586);!function(t){t[t.None=0]="None",t[t.MoveInProgress=1]="MoveInProgress",t[t.CvsScanAllowed=2]="CvsScanAllowed"}(yi||(yi={}));var Ci=e(69260),Ii=e(64966),Ti=e(20469);function ki(){return(0,et.pd)(X.nC,et.t1)}function xi(){return(0,et.pd)(X.Df,et.t1)}var Fi=e(22617);var Pi=e(15934),Di=e(1014),Mi=e(36837);function Li(){var t,n,e=F.x;return t="exporting",n=3e5,e=function(e){function i(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=e.apply(this,t)||this;return i.observe((function(){i.ensureFieldsReady([F.x.Schema.XlExportingTag]).then((function(){return i.Model.XlExportingLocalTag=i.Model.XlExportingTag.toLocaleLowerCase()}))}),[F.x.Schema.XlExportingTag]),i}return(0,p.ZT)(i,e),i.prototype.downloadExcelFile=function(t,n){return(0,mi.lb)(this,t,n)},i.prototype.SetToExporting=function(){var n=this;this.ensureFieldsReady([F.x.Schema.XlExportingLocalTag]).then((function(){n.Model.XlExportingLocalTag=t}))},i.prototype.IsExporting=function(){var e,i=this,r=0;if(this.isFieldReady(F.x.Schema.XlExportingLocalTag)&&this.Model.XlExportingLocalTag&&this.Model.XlExportingLocalTag.indexOf(t)>=0)try{var o=JSON.parse(this.Model.XlExportingLocalTag),s=Date.parse(o.starttime.toUpperCase());e=(r=(new Date).getTime()-s)<n}catch(t){e=!0}else e=!1;return e?this.oy=this.oy||window.setTimeout((function(){i.Model.XlExportingLocalTag="timeout"}),n-r):window.clearTimeout(this.oy),e},i.prototype.IsExportingFailed=function(){return this.Model.XlExportingLocalTag.toLocaleLowerCase().indexOf("failed")>=0},i}(e),e=function(t){return function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var i=t.apply(this,n)||this;return i.sy=[],i.uy=Promise.resolve(),i}return(0,p.ZT)(n,t),n.prototype.startReceivingNotifications=function(){var t=this,n=F.x.Schema;return this.Model.RtcStatus=1,this.ensureFieldsReady([n.Id,n.OwnerId,n.OwnerTenantId,n.TableId]).then((function(){2!=t.Model.RtcStatus&&t.ly()}))},n.prototype.stopReceivingNotifications=function(){var t=this;this.existingOnServerSide().then((function(){si.createNotificationProvider(t.DataProviderType,t.Model.OwnerTenantId,t.Model.OwnerId).close(t.Model.Id),t.Model.RtcStatus=3,t.responsesQueryJob=null,ni().removeAllUsers()}))},n.prototype.refreshFormResponsesCount=function(){var t=this;return this.Synchronizer.query([F.x.Schema.ResponsesCount]).then((function(){t.Model.LastSyncTime=Date.now()}))},n.prototype.hy=function(t,n){if(ei.isValidUser(n)){var e=this.getElementById(t);e&&e.updateCoAuthors(n)}},n.prototype.ly=function(){var t=this,n=si.createNotificationProvider(this.DataProviderType,this.Model.OwnerTenantId,this.Model.OwnerId),e=0,i=Promise.resolve(),r=function(){var n=++e;i.then((function(){n===e&&(i=t.refreshFormResponsesCount())}))},o=(0,Ct.vj)("GetAggregateInterval",2e4),s=!1,a=function(){s||(s=!0,window.setTimeout((function(){s=!1,t.refreshFormResponsesCount()}),o))},u=function(){t.Synchronizer.query((0,li.E3)())},c=(0,St.M5)(),l={onConnectionStarted:function(n){t.vy(n),n&&n.length>1&&u(),t.Model.RtcStatus=2,t.Model.LastSyncTime=Date.now()},onConnectionFailed:function(n){t.Model.LastSyncTime=Date.now()},onConnectionReconnected:function(n){t.vy(n),n&&n.length>1&&u(),t.Model.LastSyncTime=Date.now()},onConnectionDisconnected:function(){t.Model.RtcStatus=3,t.Model.LastSyncTime=Date.now()},onResponseAdded:function(n){t.bulkEdit((function(){t.Model.Settings.IsQuizMode?a():r()}))},onResponseDeleted:function(n){t.bulkEdit((function(){t.Model.Settings.IsQuizMode?a():r()}))},onResponsesAllDeleted:function(){t.bulkEdit((function(){t.Model.Settings.IsQuizMode?a():r()}))},onFormElementAdded:c?null:function(n,e){var i=t.getElementById(n.id);if(i instanceof(0,k.zE)()){var r=n;r.choices||(r.choices=[]),i.Synchronizer.onSourceDataReceived(n)}else i instanceof x.Jv?i.Synchronizer.onSourceDataReceived(n):t.uy=(0,Ft.Bx)(t.uy.then((function(){Ve.H.isDescriptiveElement(n.type)?_.d.Collection.itemsAddedInSource(t.Model.DescriptiveElements,[_.d.convertFromSourceData(n,x.Jv.Schema)]):_.d.Collection.itemsAddedInSource(t.Model.Questions,[_.d.convertFromSourceData(n,(0,k.zE)().Schema)])})));t.hy(n.id,e),t.vy([e])},onFormElementDeleted:c?null:function(n,e){t.uy=(0,Ft.Bx)(t.uy.then((function(){var e=t.getElementById(n);if(e instanceof D.MF){var i=e.SubQuestionMasters.concat(e);_.d.Collection.itemsDeletedInSource(t.Model.Questions,i.map((function(t){return t.Model})))}else e instanceof x.Jv&&_.d.Collection.itemsDeletedInSource(t.Model.DescriptiveElements,[e.Model])}))),t.vy([e])},onFormElementUpdated:c?null:function(n,e,i){var r=t.getElementById(n);r&&((r instanceof D.MF||r instanceof x.Jv)&&r.Synchronizer.onSourceDataReceived(e),t.hy(n,i),t.vy([i]))},onChoiceAdded:c?null:function(n,e,i){var r=t.getQuestionById(n);if(r){var o;if(e.key){if(!r.getChoiceByKey(e.key)){var s=_.d.convertFromSourceData(e,fi.r.Schema);_.d.Collection.itemsAddedInSource(r.Model.ChoiceGroup,[s])}o=Promise.resolve()}else{var a=y.map(r.Model.ChoiceGroup,(function(t){return _.d.getObjectMasterFromModel(t).Synchronizer.existingInDataSource()}));o=Promise.all(a).then((function(){if(!r.getChoiceById(e.id)&&-1===_.d.Collection.getIndexWithKeyFields(r.Model.ChoiceGroup,{Id:e.id})){var t=_.d.convertFromSourceData(e,fi.r.Schema);_.d.Collection.itemsAddedInSource(r.Model.ChoiceGroup,[t])}}))}o.then((function(){t.hy(n,i),t.vy([i])}))}},onChoiceDeleted:c?null:function(n,e,i){var r=t.getQuestionById(n);if(r){var o=r.getChoiceById(e);o&&(o.Synchronizer.onDeletedInDataSource(),t.vy([i]))}},onChoiceUpdated:c?null:function(n,e,i,r){var o=t.getQuestionById(n);if(o){var s=o.getChoiceById(e);s&&(s.Synchronizer.onSourceDataReceived(i),t.hy(n,r),t.vy([r]))}},onUserConnected:c?null:function(n){t.vy([n])},onUserDisconnected:c?null:function(n){t.gy([n])},onFormUpdated:function(n,e){var i=y.map(t.Model.PermissionTokens,(function(t){return _.d.getObjectMasterFromModel(t).Synchronizer.existingInDataSource()}));Promise.all(i).then((function(){t.Synchronizer.onSourceDataReceived(n),t.vy([e])}))},onLocaleResourceAdded:c?null:function(n,e){t.bulkEdit((function(){y.forEach(n,(function(n){if("localename"===n.elementKey){var e={localeId:n.locale,localeName:n.elementValue};-1===_.d.Collection.getIndexWithKeyFields(t.Model.LocaleList,{localeId:e.localeId})&&(_.d.Collection.itemsAddedInSource(t.Model.LocaleList,[e]),(0,hi.an)(e,t))}else t.py(n)})),e&&t.vy([e])}))},onLocaleResourceUpdated:c?null:function(n,e){var i=_.d.Collection.getItemWithKeyFields(t.Model.LocaleList,{localeId:n.locale});if(i){if("localename"===n.elementKey){var r={localeName:n.elementValue};_.d.getObjectMasterFromModel(i).Synchronizer.onSourceDataReceived(r);var o=_.d.Collection.getItemWithKeyFields(t.Model.LocalizedResources,{localeId:n.locale});o&&_.d.getObjectMasterFromModel(o).Synchronizer.onSourceDataReceived(r)}else t.py(n);e&&t.vy([e])}},onLocaleResourceDeleted:c?null:function(n,e){if(n.hasOwnProperty("locale")){var i=n.locale,r=_.d.Collection.getItemWithKeyFields(t.Model.LocaleList,{localeId:i});r&&_.d.Collection.itemsDeletedInSource(t.Model.LocaleList,[r])}else if(n.hasOwnProperty("propertyName")){var o=n.propertyName;y.forEach(t.Model.LocalizedResources,(function(t){var n=_.d.Collection.getItemWithKeyFields(t.questionResources,{questionId:o});n&&_.d.getObjectMasterFromModel(n).Synchronizer.onDeletedInDataSource()}))}else(0,Xe._y)("Not supposed to happen.");e&&t.vy([e])}};n.open(this.Model.Id,l)},n.prototype.py=function(t){if(t.elementKey.startsWith("choiceid_")){var n=y.find(this.Model.LocalizedResources,(function(n){return n.localeId==t.locale}));if(n){var e=y.find(n.questionResources,(function(n){return n.questionId==t.propertyName}));if(e){var i=_.d.getObjectMasterFromModel(e),r=t.elementKey.substring("choiceid_".length),o=i.getChoiceLocalizedMaster(r),s={choiceId:r,description:t.elementValue,key:o.Model.key};o.Synchronizer.onSourceDataReceived(s)}}}else switch(t.elementKey){case"title":case"subtitle":case"formsprortlocaletitle":case"formsprortlocalesubtitle":"_id"===t.propertyName?this.by(t.locale,t.elementKey,t.elementValue):this.wy(t.locale,t.propertyName,t.elementKey,t.elementValue);break;case"thankYouMessage":case"formCloseMessage":case"footerText":case"conditionalThankyouMessage":"_id"===t.propertyName?this.by(t.locale,t.elementKey,t.elementValue):(0,Xe._y)("Not supposed to happen. Should be form level property.");break;case"leftDescription":case"rightDescription":case"formsprortlocaleldescription":case"formsprortlocalerdescription":case"formsprocustomplaceholder":case"option":"_id"===t.propertyName?(0,Xe._y)("Not supposed to happen. Should be question level property."):this.wy(t.locale,t.propertyName,t.elementKey,t.elementValue);break;default:(0,Xe._y)("Not supposed to happen. Unknown element key")}},Object.defineProperty(n.prototype,"DataProviderType",{get:function(){return this.isGroupForm?3:2},enumerable:!1,configurable:!0}),n.prototype.by=function(t,n,e){var i=y.find(this.Model.LocalizedResources,(function(n){return n.localeId==t}));if(i){var r=_.d.getObjectMasterFromModel(i),o={localeId:t};o[n]=e,r.Synchronizer.onSourceDataReceived(o)}},n.prototype.wy=function(t,n,e,i){var r=y.find(this.Model.LocalizedResources,(function(n){return n.localeId==t}));if(r){var o=y.find(r.questionResources,(function(t){return t.questionId==n}));if(o){var s=_.d.getObjectMasterFromModel(o),a={localeId:t};a[e]=i,s.Synchronizer.onSourceDataReceived(a)}}},n.prototype.getQuestionSyncBlocker=function(t){return this.sy.push((0,Ft.Bx)(t)),this.uy},n.prototype.existingOnServerSide=function(){return this.Synchronizer.existingInDataSource()},n.prototype.vy=function(t){var n=this;t&&t.length>0&&t.forEach((function(t){ni().addOrUpdateUser(t),n.Model.CoAuthors=null}))},n.prototype.gy=function(t){var n=this;t.length>0&&t.forEach((function(t){ni().removeUser(t),n.Model.CoAuthors=null}))},n}(t)}(e),e=function(t){return function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var i=t.apply(this,n)||this;i.Sy=!1;var r=i.Synchronizer;return r.observe((function(t){var n=r.Model.UpdateError;n&&i.Ny(n)}),[r.Schema.UpdateError]),i}return(0,p.ZT)(n,t),n.prototype.duplicateForm=function(t,n){var e=this;return this.ensureFieldsReady((0,li.DV)()).then((function(){var i=y.clone(e.getSnapshotToCopy());return i.OwnerId=t.OwnerId,i.OwnerTenantId=t.OwnerTenantId,i.Title=n,i.Settings=y.clone(i.Settings),i.Settings.AllowCopy=!1,i.Settings.ShareToken=null,(0,Ni.jg)(i,t.IsGroupForm)}))},n.prototype.ensureCreationDone=function(){var t=this,n=this.getImageMaster(F.x.Schema.Background),e=this.getImageMaster(F.x.Schema.Logo),i=(this.getImageMaster(F.x.Schema.HeaderBGImage),(0,p.ev)([n.Synchronizer.flush(),e.Synchronizer.flush().then((function(){return t.Synchronizer.flush()}))],this.formElementManager.AllElementMasters.map((function(t){return t.ensureCreationDone()})),!0));return Promise.all(i).then((function(){}))},n.prototype.ensureReadyForMruCard=function(){var t=F.x.Schema;return this.ensureFieldsReady([t.Title,t.ModifiedDate,t.Settings,t.XlWorkbookId,t.OwnerId,t.OwnerTenantId,t.Category,t.OtherInfo,t.Theme,t.RowCount,t.SoftDeleted])},n.prototype.moveToRecycleBin=function(){var t=this;return this.bulkEdit((function(){t.Model.MovingToRecycleBin=!0,t.Model.SoftDeleted=Si.d.SoftDeleted})),this.Synchronizer.flush().then((function(){t.Model.MovingToRecycleBin=!1}))},n.prototype.Cy=function(t){var n=this;this.Model.MovingToRecycleBin&&this.isSoftDeleted()&&(0,en.xP)(t)&&(6102===t.innerCode||6100===t.innerCode)&&this.bulkEdit((function(){return n.Model.SoftDeleted=Si.d.Normal}))},n.prototype.isNotSoftDeleted=function(){return!this.isFieldReady(this.Schema.SoftDeleted)||this.Model.SoftDeleted===Si.d.Normal},n.prototype.isSoftDeleted=function(){return!!this.isFieldReady(this.Schema.SoftDeleted)&&this.Model.SoftDeleted===Si.d.SoftDeleted},n.prototype.getQuestionError=function(){return(0,L.KR)(this)},Object.defineProperty(n.prototype,"IsSharedForm",{get:function(){return this.Sy},set:function(t){this.Sy=t},enumerable:!1,configurable:!0}),n.prototype.Ny=function(t){this.Cy(t)},n}(t)}(e),e=function(t){return function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(this,n)||this}return(0,p.ZT)(n,t),n.prototype.triggerShareAction=function(){if(!this.Ty&&(0,c.k0)().userInfo.IsMsa&&0==(this.Model.Flags&yi.CvsScanAllowed)){this.Ty=!0,oi.VY.getInstance().createDataProvider().postFormShareAction(this.Model.Id);var t=JSON.parse(this.Model.OtherInfo);t&&t.hasOwnProperty("TemplateId")&&(0,q.f)("MyTemplate.PostShare",{TemplateTitle:t.TemplateId})}},n.prototype.appendPermission=function(t){for(var n=this.Model.Permissions,e=function(e){if("OrgLink"===n[e].Type||"Link"===n[e].Type||"ShareToPeople"===n[e].Type){var i=n[e],r=(0,Ii.pg)(i),o=r.Model.Type;return r.Model.Type=t,{value:r.Synchronizer.flush().then((function(){return i.PrincipalId})).catch((function(t){throw r.Model.Type=o,t}))}}},i=0;i<n.length;i++){var r=e(i);if("object"==typeof r)return r.value}var o=_.d.Collection.addItems(n,[(0,Ii.yN)(t)]),s=(0,Ii.pg)(o[0]);return s.Synchronizer.existingInDataSource().then((function(){return s.Model.PrincipalId}))},n.prototype.appendSpecificPeoplePermissions=function(t){var n=this.Model.Permissions,e=_.d.Collection.addItems(n,t).map(Ii.pg).map((function(t){return t.Synchronizer.existingInDataSource().catch((function(e){var i=y.find(n,(function(n){return n.PrincipalId===t.Model.PrincipalId}));throw _.d.Collection.deleteItems(n,[i]),e}))}));return Promise.all(e).then((function(){}))},n.prototype.removeLinkPermission=function(){var t=this.ky();return this.removePermissions(t)},n.prototype.removePermissions=function(t){_.d.Collection.deleteItems(this.Model.Permissions,t);var n=t.map(Ii.pg).map((function(t){return t.Synchronizer.deletedFromDataSource()}));return Promise.all(n).then((function(){}))},n.prototype.canEditPermissionTokenByCoauthor=function(){return!y.some(this.Model.Permissions,(function(t){return"ShareToPeople"===t.Type}))},n.prototype.getPermissionToken=function(){var t=this;return this.Synchronizer.existingInDataSource().then((function(){var n=t.ky().map(Ii.pg);return 0!==n.length?n[0].Synchronizer.existingInDataSource().then((function(){return n[0].Model.PrincipalId})):null}))},n.prototype.refreshPermissions=function(){var t=this;return new Promise((function(n,e){return t.Synchronizer.query([F.x.Schema.Permissions]).then(n,e)}))},n.prototype.getUserOrGroupPermissions=function(){return y.filter(this.Model.Permissions,(function(t){return"Failed"!==t.SavingState&&("User"===t.Type||"Group"===t.Type)}))},n.prototype.refreshResponderPermissions=function(){var t=this;return new Promise((function(n,e){return t.Synchronizer.query([F.x.Schema.ResponderPermissions]).then(n,e)}))},n.prototype.appendResponderPermissionLink=function(){var t=this.Model.ResponderPermissions,n=_.d.Collection.addItems(t,[(0,Ti.kF)("SpecificResponder")]),e=(0,Ti.cp)(n[0]);return e.Synchronizer.existingInDataSource().then((function(){return e.Model.PrincipalId}))},n.prototype.appendSpecificResponderPermissions=function(t){var n=this.Model.ResponderPermissions,e=_.d.Collection.addItems(n,t).map(Ti.cp).map((function(t){return t.Synchronizer.existingInDataSource().catch((function(e){var i=y.find(n,(function(n){return n.PrincipalId===t.Model.PrincipalId}));throw _.d.Collection.deleteItems(n,[i]),e}))}));return Promise.all(e).then((function(){}))},n.prototype.getUserOrGroupPermissionsInResponder=function(){return y.filter(this.Model.ResponderPermissions,(function(t){return"Failed"!==t.SavingState&&("User"===t.Type||"Group"===t.Type)}))},n.prototype.getResponderPersonas=function(){var t=this.getUserOrGroupPermissionsInResponder();return t=y.filter(t,(function(t){return(0,Ti.cp)(t).isFieldReady(Ti.Qq.Schema.PrincipalName)})),y.map(t,(function(t){return{id:t.PrincipalId,optionalText:t.Type,primaryText:t.PrincipalName,secondaryText:t.PrincipalEmailAddress}}))},n.prototype.getResponderEmailList=function(){if(2!==this.getResponseCollectionType())return Promise.resolve(null);var t=_.d.convertToArray(this.getUserOrGroupPermissionsInResponder()).map((function(t){return(0,Ci.Kw)("User"===t.Type?"User":"Group",t.PrincipalId)}));return Promise.all(t).then((function(t){return encodeURIComponent(t.filter((function(t){return t.Mail})).map((function(t){return t.Mail})).join(";"))})).catch((function(){return null}))},n.prototype.removeResponderPermissionLink=function(){var t=this,n=this.xy();return this.removeResponderPermissions(n).then((function(){return t.refreshResponderPermissions()}))},n.prototype.removeResponderPermissions=function(t){_.d.Collection.deleteItems(this.Model.ResponderPermissions,t);var n=t.map(Ti.cp).map((function(t){return t.Synchronizer.deletedFromDataSource()}));return Promise.all(n).then((function(){}))},n.prototype.getResponseCollectionType=function(){var t=this.SettingMaster.Model,n=(0,k.f5)().Model.FormsTenantSettings,e=t.IsAnonymous,i=n&&!n.externalSendForm,r=0;if((!e||i)&&this.isFieldReady(F.x.Schema.ResponderPermissions)){var o=this.Model.ResponderPermissions;r=y.find(o,(function(t){return"SpecificResponder"===t.Type}))?2:1}return r},n.prototype.xy=function(){return y.filter(this.Model.ResponderPermissions,(function(t){return"SpecificResponder"===t.Type}))},n.prototype.ky=function(){return y.filter(this.Model.Permissions,(function(t){return"Link"===t.Type||"OrgLink"===t.Type||"ShareToPeople"===t.Type}))},n}(t)}(e),e=function(t){return function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(this,n)||this}return(0,p.ZT)(n,t),n.prototype.setResponseComment=function(t,n){var e=this.Dy(t);e&&(e.Model.Feedback=n,this.My(e.Model))},n.prototype.setAnswerGrading=function(t,n,e,i){var r=this.Dy(t);r&&(r.setAnswerGrading(n,e,i),this.My(r.Model))},n.prototype.setReleaseDate=function(t,n){var e=this.Dy(t);e&&(e.Model.ReleaseDate=n,this.My(e.Model))},n.prototype.Dy=function(t){var n=this,e=this.getResponseModelById(t);if(!e){var i=this.Model.Responses,r=y.findIndex(i,(function(n){return n.Id===t}));if(r<0)return!1;this.bulkEdit((function(){e=_.d.Collection.itemsAddedInSource(n.Model.ResponseModels,[i[r]])[0],i[r]=e}))}return(0,bi._p)(e)},n.prototype.My=function(t){if((0,dt.GF)()&&(0,dt.CE)()&&this.IsAssignmentForm&&(0,I.cr)("AssignmentsIFrameLimitParentHeaders")){var n=y.reduce(t.Answers,(function(t,n){return t+(n.Score||0)}),0);(0,I.cr)("FixEslintTeamsPostMessageError")?window.parent.postMessage({eventName:"FormGradingChangePerformed",responseId:t.Id,responder:t.Responder,responseScore:n,feedback:t.Feedback,isReturned:"0001-01-01T00:00:00Z"!==t.ReleaseDateAsString},"https://assignments.onenote.com"):window.parent.postMessage({eventName:"FormGradingChangePerformed",responseId:t.Id,responder:t.Responder,responseScore:n,feedback:t.Feedback,isReturned:"0001-01-01T00:00:00Z"!==t.ReleaseDateAsString},"*")}},n}(t)}(e),e=function(t){return function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(this,n)||this}return(0,p.ZT)(n,t),n.prototype.createLocale=function(t,n){var e={localeId:t,localeName:n};_.d.Collection.addItems(this.Model.LocaleList,[e]),(0,hi.an)(e,this)},n.prototype.deleteLocale=function(t){var n=_.d.Collection.getItemWithKeyFields(this.Model.LocaleList,{localeId:t});n&&(_.d.Collection.deleteItems(this.Model.LocaleList,[n]),(0,hi.tc)(t,this))},n.prototype.getAllLocaleResources=function(){return(0,mi.o7)(this.Model.Id).getAllLocaleResources(this.Model.Id).then((function(t){return(0,hi.n$)(t)}))},n}(t)}(e),e=function(t){return function(t){function n(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r=t.apply(this,e)||this;return r.Ly(),r.qi(),r.Model.YouTubeMessageBarState=null,n.DesignOnlyRules.forEach((function(t){return r.addRule(t)})),(0,Qe.CU)(r,F.x.Schema.Logo,F.x.Schema.LogoInfo),r}return(0,p.ZT)(n,t),n.prototype.isCurrentUserFormOwnerOrGroupMember=function(){return this.Ay},n.prototype.ensureReadyToDesign=function(){var t=this;return this.ensureFieldsReady((0,li.E3)()).then((function(n){return null==t.Ay&&t.Ey(),n}))},n.prototype.ensureReadyToAdminPhishingReview=function(){var t=(0,li.Co)();return t.push(this.Schema.CreatedBy),this.ensureFieldsReady(t)},n.prototype.reachedQuestionNumberLimitation=function(){return this.formElementManager.QuestionMasters.filter((function(t){return"Question.MatrixChoiceGroup"!=t.Model.Type})).length>=(0,X.gX)()},n.prototype.searchResponseById=function(t){var n=this,e={name:"id",operator:"eq",value:t};return this.Synchronizer.existingInDataSource().then((function(){return(0,vi.aj)(n,1,0,e)})).then((function(t){return t&&t[0]}))},n.prototype.syncFormResponses=function(){var t=this;return this.responsesQueryJob&&this.responsesQueryJob.states()===Ft.Cb.Pending||(this.responsesQueryJob=new Ft.bC(this.Synchronizer.existingInDataSource().then((function(){var n=[F.x.Schema.Questions];n.push(F.x.Schema.Settings);var e=t.ensureFieldsReady(n);return Promise.all([(0,vi.aj)(t),e]).then((function(n){var e=n[0];n[1],t.updatingResponsesFromServer=!0,t.bulkEdit((function(){t.Model.Responses=t.normalizeResponses(e),t.Synchronizer.onSourceDataReceived({rowCount:e.length})})),t.updatingResponsesFromServer=!1}))})))),this.responsesQueryJob.promise()},n.prototype.syncFormResponsesByPaging=function(t,n){var e=this;return this.getFormResponsesByPaging(t,n).then((function(t){e.updatingResponsesFromServer=!0,e.Model.BufferResponses=t,e.updatingResponsesFromServer=!1}))},n.prototype.getFormResponsesByPaging=function(t,n){var e=this,i=[F.x.Schema.Questions];i.push(F.x.Schema.Settings);var r=this.ensureFieldsReady(i),o=this.Synchronizer.existingInDataSource().then((function(){return(0,vi.aj)(e,t,n)}));return Promise.all([o,r]).then((function(t){var n=t[0];return t[1],e.normalizeResponses(n)}))},n.prototype.getFormResponsesCountByAPICall=function(){var t=this;return this.Synchronizer.existingInDataSource().then((function(){return(0,mi.rl)(t)})).then((function(n){t.Model.ResponsesCount=n}))},n.prototype.deleteAllResponses=function(){var t=this;return this.Synchronizer.existingInDataSource().then((function(){return(0,vi._n)(t)})).then((function(){var n={Responses:[],ResponsesCount:0};t.updatingResponsesFromServer=!0,t.setData(n),t.updatingResponsesFromServer=!1}))},n.prototype.deleteBufferResponse=function(t){var n=this;return this.Synchronizer.existingInDataSource().then((function(){return(0,vi.q4)(n.Model.Id,[t])})).then((function(){var e=_.d.getCollectionMasterFromModel(n.Model.BufferResponses),i=e.getItemWithKeyFields({Id:t});i&&n.bulkEdit((function(){e.itemsDeletedInSource([i]),--n.Model.ResponsesCount}))}))},n.prototype.resetBranchInfo=function(){this.FormElementManager.AllElementMasters.forEach((function(t){return t.resetBranchInfo()}))},n.prototype.formOwnedByMe=function(){return this.Model.OwnerId&&this.Model.OwnerId===(0,c.k0)().userInfo.UserId},n.prototype.fileUploadAnonymousDisabled=function(){return!(0,I.cr)("EnableAnonymousUploadLink")&&!!y.find(this.Model.Questions,(function(t){return"Question.FileUpload"===t.Type}))},n.prototype.qi=function(){var t=this;(0,pi.vG)(this),this.By="Idle",this.Hy="Idle",this.qy="Idle",this.fieldsReady([F.x.Schema.Questions]).then((function(){var n=_.d.getCollectionMasterFromModel(t.Model.Questions);(0,pi.v)(n,n.Schema[0].IntegratedSavingState,(function(n){t.By=n,t.updateIntegratedSavingState()}))})),this.fieldsReady([F.x.Schema.DescriptiveElements]).then((function(){var n=_.d.getCollectionMasterFromModel(t.Model.DescriptiveElements);(0,pi.v)(n,n.Schema[0].IntegratedSavingState,(function(n){t.qy=n,t.updateIntegratedSavingState()}))}));var n=_.d.getCollectionMasterFromModel(this.Model.ResponseModels);(0,pi.v)(n,n.Schema[0].IntegratedSavingState,(function(n){t.Hy=n,t.updateIntegratedSavingState()})),this.updateIntegratedSavingState()},n.prototype.updateIntegratedSavingState=function(){var t=this;if(this.syncBlocker.states()===Ft.Cb.Pending)return this.Model.IntegratedSavingState="NotStarted",void this.syncBlocker.promise().then((function(){return t.updateIntegratedSavingState()}));var n=[this.Model.SavingState,this.By,this.Hy],e=F.x.Schema;this.isFieldReady(e.DescriptiveElements)&&n.push(this.qy),this.isFieldReady(e.Logo)&&n.push(this.Model.Logo.SavingState),this.isFieldReady(e.Background)&&n.push(this.Model.Background.SavingState),this.Model.IntegratedSavingState=(0,pi.IM)(n)},Object.defineProperty(n,"DesignOnlyRules",{get:function(){if(!n.designOnlyRules){var t=F.x.Schema,e=_.d.getSubFieldSchemas(t).filter((function(t){return!_.d.getFieldSchemaInfo(t).Attributes.IsLocalField})),i=[t.Background.SavingState,t.Logo.SavingState,t.SavingState];n.designOnlyRules=[{Name:"IntegrateSavingState",InterestedFields:i,onChange:function(t){return t.Master.updateIntegratedSavingState()}},{Name:"Modified",InterestedFields:y.without(e,t.SoftDeleted),onChange:function(n){if(!n.BeingDeleted&&!y.contains(n.FieldSchemas,t.Modified)){var i=n.Master;y.contains(n.FieldSchemas,t.ModifiedDate)?i.Model.Modified=i.Model.ModifiedDate:i.isFieldReady(t.Modified)&&y.intersection(n.FieldSchemas,e).map(_.d.getFieldSchemaInfo).map((function(t){return t.Name})).some((function(t){return t in n.OldValues}))&&(i.Model.Modified=(new Date).toISOString())}}},{Name:"RowCount",InterestedFields:[t.RowCount],onChange:function(t){if(!t.BeingDeleted){var n=t.Master.Model;n.ResponsesCount=n.RowCount}}},{Name:"SerializeSettings",InterestedFields:[F.x.Schema.Settings],onChange:function(t){if(!t.BeingDeleted){var n=t.Master.Model;n.SerializedSettings=gi.w.serialize(n.Settings)}}},{Name:"SerializePredefinedResponses",InterestedFields:[F.x.Schema.PredefinedResponses],onChange:function(t){if(!t.BeingDeleted){var n=t.Master.Model;n.SerializedPredefinedResponses=(0,li.eT)(n.PredefinedResponses)}}},{Name:"DeleteResponseModels",InterestedFields:[t.Responses],onChange:function(t){var n=t.Master,e=_.d.getCollectionMasterFromModel(n.Model.Responses),i=[],r=[];t.SubChanges.filter((function(t){return t.Master===e})).forEach((function(t){return t.RemovedModels.forEach((function(t){var e=n.getResponseModelById(t.Id);e?i.push(e):r.push(t.Id)}))}));var o=_.d.getCollectionMasterFromModel(n.Model.ResponseModels);n.updatingResponsesFromServer?o.itemsDeletedInSource(i):(o.deleteItems(i),(0,bi.q4)(n,r))}},{Name:"ResponsesCount",InterestedFields:[t.ResponsesCount],onChange:function(n){var e=n.Master;e.isFieldReady(t.ResponsesCount)&&-1===e.Model.ResponsesCount&&(e.Model.ResponsesCount=null)}},{Name:"ResponseModel Change",InterestedFields:[t.ResponseModels],onChange:function(t){var n=t.Master,e=_.d.getCollectionMasterFromModel(n.Model.ResponseModels),i=_.d.getCollectionMasterFromModel(n.Model.Responses);t.SubChanges.filter((function(t){return t.Master===e})).forEach((function(t){t.SubChanges.forEach((function(t){var n=y.indexOf(i.Model,t.Master.Model);n>=0&&i.markAsChanged(n)}))}))}}]}return n.designOnlyRules},enumerable:!1,configurable:!0}),n.prototype.Ly=function(){this.isFieldReady(F.x.Schema.RowCount)&&(this.Model.ResponsesCount=this.Model.RowCount)},n.prototype.Ey=function(){var t=this;this.Ay=this.Model.Permissions&&this.Model.Permissions.length<=1||!this.isGroupForm&&this.formOwnedByMe(),this.isGroupForm&&!this.Ay&&(0,di.o6)(this.Model.OwnerId).then((function(n){t.Ay=n.value.length>0}))},n}(t)}(e),e=Ke(e)}function Ri(){return Ke(function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var i=t.apply(this,n)||this,r=i.originalInitialData;return i.duplicatingImage&&i.Synchronizer.existingInDataSource().then((function(){return i.Vy(r)})),i}return(0,p.ZT)(n,t),n.prototype.addImage=function(t){var n,e,i=this,r=new Yn.o("Image.Add");if(r.start(),t.File)e="File",n=function(){return i.zy(t.File,(0,X.vM)(),(0,X.HJ)())};else{if(!t.FromUrl)throw Error("Invalid picked image result.");e="FromUrl",n=function(){return i.Qy(t.FromUrl.Url,t.FromUrl.Size,t.FromUrl.Width,t.FromUrl.Height)}}return this.Model.ImageProcessingStatus=ze.nv.Picking,this.Synchronizer.existingInDataSource().then(n).then((function(){i.Model.AltText=null,r.end({resultType:"Success",extraData:{imageSource:e}})})).catch((function(){r.end({resultType:"Failure",extraData:{imageSource:e}})}))},n.prototype.getImageErrorMessage=function(){switch(this.Model.ErrorType){case ze.dL.NoError:return null;case ze.dL.SizeTooLarge:return(0,T.pm)().Error_Message_5208;case ze.dL.InvalidType:return(0,T.pm)().Error_Message_5209;case ze.dL.BrokenImage:return(0,T.pm)().ImagePicker_Broken_Image;case ze.dL.ServerError:return this.$y();case ze.dL.DeleteFailError:return(0,T.pm)().Image_Delete_Fail}},n.prototype.clear=function(){var t=this,n=this.Model;return n.ResourceUrl?n.IsPredefined?(this.setData({AltText:null,ContentType:null,FileIdentifier:null,OriginalFileName:null,ResourceId:null,ResourceUrl:null,IsPredefined:!1,UploadParameters:null,ErrorType:ze.dL.NoError,ResponseError:null,ImageProcessingStatus:ze.nv.Idle,Width:null,Height:null}),Promise.resolve()):(this.bulkEdit((function(){n.ImageProcessingStatus=ze.nv.Deleting,n.UploadParameters={Delete:!0}})),this.jy((function(){return t.setData((0,ze.w9)())}))):Promise.resolve()},n.prototype.updateSettings=function(t,n){this.getSettingsMaster()&&this.getSettingsMaster().updateWith(this.Model,t,n)},n.prototype.Vy=function(t){var n=this;if(this.Model.ResourceUrl){var e=t.AltText,i=this.getSettingsMaster(),r={};i&&(r=y.clone(i.getSnapshot())),this.Synchronizer.existingInDataSource().then((function(){return n.Qy(t.ResourceUrl,0,r?r.NaturalWidth:(0,X.vM)(),r?r.NaturalHeight:(0,X.HJ)())})).then((function(){n.Model.AltText=e,i&&(delete r.NaturalHeight,delete r.NaturalWidth,i.setData(r))}))}},n.prototype.Qy=function(t,n,e,i){var r=this;(0,q.$U)("DesignPage.ImageLayout.ImageSize",{width:e,height:i});var o=this.Model;return this.bulkEdit((function(){var s=(0,ze.bN)(e,i,800,600);return o.ErrorType=r.Ky(n),o.ErrorType!==ze.dL.NoError?(o.ImageProcessingStatus=ze.nv.Idle,Promise.reject(o.ErrorType)):(r.resetStatus(ze.nv.Picking),o.UploadParameters={Url:t,Size:n},r.jy(void 0,s.width,s.height))}))},n.prototype.zy=function(t,n,e){var i=this,r=this.Model;return this.bulkEdit((function(){var n=i.Ky(t.size,t.type);return n===ze.dL.NoError?(i.resetStatus(ze.nv.Uploading),r.UploadParameters={ImageFile:t},i.jy()):(r.ErrorType=n,r.ImageProcessingStatus=ze.nv.Idle,Promise.reject(r.ErrorType))}))},n.prototype.jy=function(t,n,e){var i=this;return this.Synchronizer.flush().finally((function(){return i.Model.ImageProcessingStatus=ze.nv.Idle})).catch((function(){})).then(t).then((function(){return i.updateSettings(n,e)})).catch((function(t){i.Jy()}))},n.prototype.$y=function(){var t=this.Model,n=t.ResponseError&&t.ResponseError.innerCode;return(0,Fi.D)("".concat(n))||(0,T.pm)().Image_Upload_Fail},n.prototype.Ky=function(t,n,e,i){var r=ze.dL.NoError;return t>(0,X.yi)()&&(r=ze.dL.SizeTooLarge),n&&$.inArray(n,["image/bmp","image/gif","image/jpeg","image/png"])<0&&(r=ze.dL.InvalidType),r},n.prototype.Jy=function(){this.setData((0,ze.w9)(),_.d.getSubFieldSchemas(ze.Xf.Schema)),this.updateSettings()},n}(ze.Xf))}function Ai(){return Ke(function(t){function n(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r=t.apply(this,e)||this;return(0,pi.vG)(r),r.updateIntegratedSavingState(),n.DesignOnlyRules.forEach((function(t){return r.addRule(t)})),r}return(0,p.ZT)(n,t),Object.defineProperty(n,"DesignOnlyRules",{get:function(){if(!n.designOnlyRules){var t=D.MF.Schema;n.designOnlyRules=[{Name:"block id changes",InterestedFields:[t.Id],onChange:function(t){var n,e=t.Master.Model,i=e.Id,r=t.OldValues.Id;e.Id=r;try{throw Error("Changing question id")}catch(t){n=t}(0,q.zU)("UpdatingQuestionId",{newId:i,oldId:r,stack:n.stack})}},{Name:"update CombinedTitle",InterestedFields:[t.Title,t.IsMathQuiz,t.Subtitle],onChange:function(t){return(0,Mi.k)(t.Master.Model)}},{Name:"update Title",InterestedFields:[t.CombinedTitle],onChange:function(t){return(0,Mi.S)(t.Master.Model)}},{Name:"IntegrateSavingState",InterestedFields:[t.ImageInfo.SavingState,t.SavingState],onChange:function(t){return t.Master.updateIntegratedSavingState()}},{Name:"IsQuiz",InterestedFields:[t.IsQuiz],onChange:function(t){var n=t.Master.Model;n.IsQuiz||(n.IsMathQuiz=null,_.d.convertToArray(n.Choices).forEach((function(t){t.IsAnswerKey=null})))}},{Name:"IsMathQuiz",InterestedFields:[t.IsMathQuiz],onChange:function(t){var n=t.Master.Model;n.IsMathQuiz||(n.IsMathQuiz=null,n.IsPlainTextInMathField=null,n.IsMathInputDefault=null,n.InputSwitcherDisabled=null,n.LastMathMLFormula=null,n.MathAriaLabels=null,n.MathTemplateID=null)}},{Name:"NumberValidationRule",InterestedFields:[t.IsNumber],onChange:function(t){var n=t.Master.Model;n.IsNumber?null==n.NumberValidationRule&&(n.NumberValidationRule=D.pW.None):n.NumberValidationRule=null}},{Name:"JustifyNumberBoundaries",InterestedFields:[t.NumberValidationRule],onChange:function(t){return t.Master.justifyNumberBoundaries()}}]}return n.designOnlyRules},enumerable:!1,configurable:!0}),n.prototype.ensureCreationDone=function(){var t=this;return this.ImageInfoMaster.Synchronizer.flush().then((function(){return t.Synchronizer.flush()}))},n.prototype.setVideoUrl=function(t,n){var e=this.Model.VideoInfo;_.d.getObjectMasterFromModel(e).bulkEdit((function(){e.Url=(0,Di.Qn)(t,(0,te.k)()),e.Title="",e.Author="",e.Thumbnail_url="",e.OriginalWidth=459,e.OriginalHeight=256,e.ShowWarningBar=n&&(0,Pi.M4)(t)}))},n.prototype.clearVideoInfo=function(){this.Model.VideoInfo={}},n.prototype.addSubQuestion=function(t){t.GroupId=this.Model.Id,t.Required=this.Model.Required,this.Form.FormElementManager.insertElementAfter(t,this)},n.prototype.deleteSubQuestion=function(t){this.Form.getQuestionById(t).Deleted=!0},n.prototype.updateCoAuthors=function(t){var n=this,e=_.d.getCollectionMasterFromModel(this.Model.CoAuthors),i=y.filter(this.Model.CoAuthors,(function(n){return t.userId===n.userId}))[0],r=function(){i&&e.deleteItems([i]),t.userId in n.coAuthorTimers&&(clearTimeout(n.coAuthorTimers[t.userId]),delete n.coAuthorTimers[t.userId])};e.bulkEdit((function(){r(),i=_.d.Collection.addItems(n.Model.CoAuthors,[t])[0]})),this.coAuthorTimers[t.userId]=window.setTimeout(r,1e4)},n.prototype.hasSectionBranching=function(){var t=this.Model;return y.map(t.Choices,(function(t){return t.BranchInfo})).concat([t.BranchInfo,t.BranchInfoForOtherChoice]).map(_.d.getObjectMasterFromModel).some((function(t){return t.hasSectionBranching()}))},n.prototype.needObserveSettings=function(){return"Question.FileUpload"===this.Model.Type},n.prototype.getErrorMessage=function(){var t=this.Model.FileUploadSPOInfo;return this.Synchronizer.Model.CreationError?this.getCreationError():(null==t?void 0:t.errorCode)?(0,L.nX)(t.errorCode):(null==t?void 0:t.linkInfo)?(0,L.uV)(Number(t.linkInfo),!1):(null==t?void 0:t.anonymousLinkInfo)&&this.Form.SettingMaster.Model.IsAnonymous?(0,L.uV)(Number(t.anonymousLinkInfo),!0):void 0},n.prototype.getCreationError=function(){var t,n=null===(t=this.Synchronizer.Model)||void 0===t?void 0:t.CreationError,e=null==n?void 0:n.innerMessage,i=null==n?void 0:n.innerCode;if("6614"==i){var r=e.match(/disableReason:([-0-9]*);/);if(r){var o=Number(r[1]);return(0,L.uV)(o,!1)}}else if(i)return(0,L.nX)(i);return null},n.prototype.updateIntegratedSavingState=function(){this.isFieldReady(D.MF.Schema.ImageInfo)?this.Model.IntegratedSavingState=(0,pi.IM)([this.Model.ImageInfo.SavingState,this.Model.SavingState]):this.Model.IntegratedSavingState=this.Model.SavingState},n}(D.MF))}function Ei(){return function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(this,n)||this}return(0,p.ZT)(n,t),n.prototype.appendElement=function(t,n){var e=this,i=[];t.Id||((t=y.clone(t)).Id=this.Zy());var r=this.getAllElements(),o=r.length>0?r[r.length-1].Order:Ve.H.QuestionOrderFloor;if(t.Order=o+Ve.H.QuestionOrderDefaultStep,n&&(i=n.map((function(n,i){return(n=y.clone(n)).Id=e.Zy(),n.GroupId=t.Id,n.Order=t.Order+(i+1)*Ve.H.QuestionOrderDefaultStep,n}))),Ve.H.isDescriptiveElement(t.Type)){var s=_.d.Collection.addItems(this.formMaster.Model.DescriptiveElements,[t]);return(0,x.PQ)(s[0])}var a=[t];return a=a.concat(i),s=_.d.Collection.addItems(this.formMaster.Model.Questions,a),(0,D.vV)(s[0])},n.prototype.duplicateElement=function(t){var n=t.getSnapshotWithoutBranchInfo();delete n.Id;var e=t.SubQuestionMasters.map((function(t){var n=t.getSnapshotWithoutBranchInfo();return delete n.Id,delete n.GroupId,delete n.QuestionInfo,n}));return this.insertElementAfter(n,t,e)},n.prototype.duplicateSectionAndSubElements=function(t){var n=this,e=this.findQuestionsInSection(t,!0),i=y.find(this.SectionMasters,(function(n){return n.Model.Order>t.Model.Order})),r=t.Model.Order,o=t.Model.Order+Ve.H.QuestionOrderDefaultStep*(e.length+1);e.length>0&&(r=y.last(e).Model.Order),i&&(o=i.Model.Order);var s=(o-r)/(e.length+2),a=y.clone(t.getSnapshot());a.Id=this.Zy(),a.Order=r+s,a.FormsProRTQuestionTitle&&(a.FormsProRTQuestionTitle=(0,T.pm)().Title_For_Duplicate_Section.format(a.FormsProRTQuestionTitle)),a.Title=(0,T.pm)().Title_For_Duplicate_Section.format(a.Title);var u,c=[{newId:a.Id,oldId:t.Model.Id}],l=[];return e&&e.forEach((function(t,e){var i=y.clone(t.getSnapshot());switch(i.Id=n.Zy(),i.Order=a.Order+s*(e+1),l.push(i),i.Type){case"Question.MatrixChoiceGroup":u=i.Id;break;case"Question.MatrixChoice":i.GroupId=u}c.push({newId:i.Id,oldId:t.Model.Id})})),this.formMaster.bulkEdit((function(){_.d.Collection.addItems(n.formMaster.Model.DescriptiveElements,[a]),_.d.Collection.addItems(n.formMaster.Model.Questions,l)})),(0,hi.fK)(t.Form.Model.LocalizedResources,c),this.getDescriptiveElementMasterById(a.Id)},n.prototype.deleteFormQuestion=function(t){_.d.Collection.itemsDeletedInSource(t.Form.Model.Questions,t.SubQuestionMasters.map((function(t){return t.Model}))),t.Deleted=!0},n.prototype.deleteSectionAndSubElements=function(t){var n=this,e=this.findQuestionsInSection(t);this.formMaster.bulkEdit((function(){e.forEach((function(t){return n.deleteFormQuestion(t)})),t.Deleted=!0}))},n.prototype.moveElementDown=function(t){var n=this,e=this.TopElementMasters,i=y.indexOf(e,t);if(i!==e.length-1){var r=e[i+1],o=r instanceof D.MF&&r.SubQuestionMasters.length>0?r.SubQuestionMasters[r.SubQuestionMasters.length-1].Model.Order:r.Model.Order,s=o+Ve.H.QuestionOrderDefaultStep;i+1<e.length-1&&(s=e[i+2].Model.Order);var a=t.SubQuestionMasters.map((function(t){return t.Model}));this.formMaster.bulkEdit((function(){return n.Yy(t.Model,a,o,s)}))}},n.prototype.moveElementUp=function(t){var n=this,e=this.TopElementMasters,i=y.indexOf(e,t);if(!(i<=0)){var r=Ve.H.QuestionOrderFloor,o=e[i-1],s=y.indexOf(this.AllElementMasters,o);s>0&&(r=this.AllElementMasters[s-1].Model.Order);var a=e[i-1].Model.Order,u=t.SubQuestionMasters.map((function(t){return t.Model}));this.formMaster.bulkEdit((function(){return n.Yy(t.Model,u,r,a)}))}},n.prototype.moveSectionTo=function(t,n){var e,i=this,r=Ve.H.QuestionOrderFloor,o=this.SectionMasters,s=y.indexOf(o,t),a=y.indexOf(o,n),u=y.last(this.HeaderTopQuestionMasters);u&&(r=u.Model.Order);var c=this.findQuestionsInSection(t,!0).map((function(t){return t.Model}));if(s>a)e=n.Model.Order,a>0&&(r=o[a-1].Model.Order,(l=this.findQuestionsInSection(o[a-1])).length>0&&(r=y.max(y.map(l,(function(t){return t.Model.Order})))));else{if(!(s<a))return;var l=this.findQuestionsInSection(n);r=o[a].Model.Order,l.length>0&&(r=y.max(y.map(l,(function(t){return t.Model.Order})))),e=r+Ve.H.QuestionOrderDefaultStep*(c.length+1),a+1<o.length&&(e=o[a+1].Model.Order)}this.formMaster.bulkEdit((function(){return i.tw(t.Model,c,r,e)}))},n.prototype.insertElementAfter=function(t,n,e){var i=this;t=y.clone(t);var r=[];e&&(r=e.map(y.clone));var o=this.getAllElements(),s=Ve.H.QuestionOrderFloor,a=s+Ve.H.QuestionOrderDefaultStep;if(n){n instanceof D.MF&&n.SubQuestionMasters.length>0&&(n=n.SubQuestionMasters[n.SubQuestionMasters.length-1]);var u=y.indexOf(o,n.Model);u!==o.length-1?(s=n.Model.Order,a=o[u+1].Order):(s=n.Model.Order,a=n.Model.Order+Ve.H.QuestionOrderDefaultStep)}else o.length>0&&(a=o[0].Order);if(this.Yy(t,r,s,a),t.Id||(t.Id=this.Zy(),r.forEach((function(n){n.Id=i.Zy(),n.GroupId=t.Id}))),Ve.H.isDescriptiveElement(t.Type)){var c=_.d.Collection.addItems(this.formMaster.Model.DescriptiveElements,[t]);return(0,x.PQ)(c[0])}var l=[t];return l=l.concat(r),c=_.d.Collection.addItems(this.formMaster.Model.Questions,l),(0,D.vV)(c[0])},n.prototype.Zy=function(){return"r"+(0,O.GW)().replace(/-/g,"")},n.prototype.Yy=function(t,n,e,i){var r=(i-e)/(n.length+2);t.Order=e+r,n.forEach((function(n,e){n.Order=t.Order+r*(e+1)}))},n.prototype.tw=function(t,n,e,i){var r=(i-e)/(n.length+2);t.Order=e+r,n.forEach((function(n,e){n.Order=t.Order+r*(e+1)}))},n}(Ve.H)}function Oi(){return function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(this,n)||this}return(0,p.ZT)(n,t),n.prototype.updateWith=function(t,n,e){var i=this;this.bulkEdit((function(){i.clear(),i.initImageSetting(t,n,e)}))},n.prototype.initImageSetting=function(t,n,e){var i=this,r=this.Model;this.bulkEdit((function(){null==r.Layout&&(t.ResourceUrl||t.ImageProcessingStatus!==ze.nv.Idle?(r.NaturalWidth=t.Width||n,r.NaturalHeight=t.Height||e,i.nw(),i.ew()):i.clear())}))},n.prototype.onImageStyleChange=function(t){var n=this,e=this.Model;e.Size!==t&&this.bulkEdit((function(){e.Size=t,n.ew()}))},n.prototype.clear=function(){return this.setData({},_.d.getSubFieldSchemas(this.Schema))},n.prototype.nw=function(){var t=this.Model;if(this.IsFormLogo)t.Size=Qe.h2.Small;else{var n=t.NaturalHeight/t.NaturalWidth;t.Layout=n>1?Qe.RZ.Vertical:n<1?Qe.RZ.Horizontal:Qe.RZ.Square,t.Size=n<.5?Qe.h2.Large:Qe.h2.Small}},n.prototype.ew=function(){var t=this.Model,n=this.getDefaultImageSettings();for(var e in n)t[e]=Math.round(n[e])},n}(Qe.Vj)}function _i(){return function(t){function n(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var i=t.apply(this,n)||this;return i.addRule({InterestedFields:[i.Schema.FormMaster],Name:"ClearRouting",onChange:function(t){i.Model.FormMaster||i.Lb()}}),i.addRule({InterestedFields:[i.Schema.FlexPane],Name:"RecordFlexPaneType",onChange:function(t){i.Model.PreviousFlexPane=t.OldValues.FlexPane}}),i}return(0,p.ZT)(n,t),n.getInstance=function(){return this.instance||(this.instance=new n),this.instance},n.prototype.designForm=function(t){var e=n.getInstance(),i=e.Model;(0,q.$U)("DesignPage.Form.Navigate",{isGroupForm:t.IsGroupForm,myForm:t.Model.OwnerId===(0,c.k0)().userInfo.UserId}),e.bulkEdit((function(){i.Analysis=!1,i.Grading=null,i.FormId=null,i.FormMaster=t,t.IsGroupForm||(i.GroupMaster=null),t.existingOnServerSide().then((function(){i.FormMaster===t&&(i.FormId=t.Model.Id)}))}))},n.prototype.copyBySharingLinkFinished=function(t){var n=this;window.history.replaceState({},"","#FormId=".concat(t.Model.Id)),this.bulkEdit((function(){var e=n.Model;e.CopyFormId=null,e.SharingToken=null,e.FormId=null==t?void 0:t.Model.Id,e.FormMaster=t}))},n.prototype.shouldShowDesignView=function(){var t=this.Model;return!!(t.FormId||t.CopyFormId||t.FormMaster)},n.prototype.showTopView=function(t,n){this.Model.TopView=t,this.topViewCloseCallback=n},n.prototype.hideTopView=function(){this.Model.TopView="None"},n.prototype.resetTopViewCloseCallback=function(){var t=this.topViewCloseCallback;return this.topViewCloseCallback=void 0,t},n.prototype.collapseFlexPaneIfNeeded=function(t){var e=n.getInstance().Model,i=e.FlexPane;if("None"!==i){var r="flex-pane-container-"+i,o=document.getElementById(r);o&&!o.contains(t)&&(e.FlexPane="None")}},n.prototype.getUniqueFormName=function(t,e){void 0===e&&(e=!1);var i=n.getInstance(),r=[];if(e)r=i.Model.GroupMaster.FormMasters.filter((function(t){return!t.Deleted})).map((function(t){return t.Model.Title}));else{r=_.d.convertToArray(i.Model.FormList).map((function(t){return t.Model.Title}));var o=_.d.convertToArray(i.Model.PlaceholderList).map((function(t){return t.Title}));r=r.concat(o)}return(0,Je.o)(t,(0,T.pm)().Designer_Title_autoRenameFormat,r)},n.prototype.Lb=function(){var t=this;this.bulkEdit((function(){var n=t.Model;n.FormMaster=void 0,n.DataIdeas=!1,n.Analysis=!1,n.BranchingElementId=null,n.SectionElementId=null,n.Store=!1,n.Grading=null,n.Preview=null,n.FlexPane="None"}))},n}(qe)}var Bi=function(){function t(){}return t.prototype.getMixinFormMaster=function(){return t.FormMasterClass||(t.FormMasterClass=Li()),t.FormMasterClass},t.prototype.getMixinImageInfoMaster=function(){return t.ImageInfoMasterClass||(t.ImageInfoMasterClass=Ri()),t.ImageInfoMasterClass},t.prototype.getMixinQuestionMaster=function(){return t.QuestionMasterClass||(t.QuestionMasterClass=Ai()),t.QuestionMasterClass},t.prototype.getMixinFormApi=function(){return t.FormApiClass||(t.FormApiClass=_e(Ne)),t.FormApiClass},t.prototype.getMixinFormElementManager=function(){return t.FormElementManagerClass||(t.FormElementManagerClass=Ei()),t.FormElementManagerClass},t.prototype.getMixinImageSettingsMaster=function(){return t.ImageSettingsMasterClass||(t.ImageSettingsMasterClass=Oi()),t.ImageSettingsMasterClass},t.prototype.getMixinDesignPageUxStateMaster=function(){return t.DesignPageUxStateMasterClass||(t.DesignPageUxStateMasterClass=_i()),t.DesignPageUxStateMasterClass},t.prototype.getMobileDesignPageUxStateMaster=function(){return $e},t.prototype.getFileUploadConfirmDialog=function(){return We},t}(),Hi=function(){function t(){this.iw=new Ye.Y,this.rw=!1}return t.prototype.addBootCompleteListener=function(t){this.rw?t():this.iw.register(t)},t.prototype.raiseBootComplete=function(){this.rw=!0,this.iw.trigger(),this.iw.clear()},t}();var Gi=e(84950),qi=function(){function t(){this.ow=[],this.sw="",this.aw=""}return t.prototype.addUserActionSignal=function(t,n,e,i){var r=this;if(void 0===i&&(i=!1),!(0,ht.x8)()){var o=(0,St.x_)();if(o){var s={UserActionName:t,UserActionType:n,InteractiveContent:e?JSON.stringify(e):"",SessionId:(0,te.k)()},a=(0,k.f5)().Model;if(a&&a.FormMaster&&a.FormMaster.Model)(function(t){return t.fieldsReady([F.x.Schema.Title,F.x.Schema.Questions]).then((function(){var n,e=_.d.convertToArray(t.Model.Questions)||[],i=[];e.forEach((function(t){var n=[],e=t.ChoiceGroup;(_.d.convertToArray(e).map(fi.k)||[]).forEach((function(t){if(t.isFieldReady(t.Schema.Id)&&t.isFieldReady(t.Schema.Description)&&t.isFieldReady(t.Schema.Order)){var e={DisplayText:t.Model.Description,ChoiceId:t.Model.Id.toString(),ChoiceOrder:t.Model.Order};n.push(e)}}));var r={QuestionId:t.Id,QuestionTitle:t.Title,QuestionType:t.Type,QuestionInfo:t.QuestionInfo,QuestionOrder:t.Order,QuestionSubtitle:t.Subtitle,Choices:n,Required:t.Required,IsQuiz:t.IsQuiz};i.push(r)}));var r=null===(n=t.FormElementManager)||void 0===n?void 0:n.SectionMasters;r&&r.length>0&&r.forEach((function(t){i.push({QuestionId:t.Model.Id,QuestionTitle:t.Model.Title,QuestionType:t.Model.Type,QuestionInfo:t.Model.QuestionInfo,QuestionOrder:t.Model.Order,QuestionSubtitle:t.Model.Subtitle})}));var o={FormTitle:t.Model.Title,FormType:t.Model.Type,FormDescription:t.Model.Description,Questions:i};return JSON.stringify(o)}))})(a.FormMaster).then((function(t){var n,a,u=(0,Ct.vj)("UserActionSignalMaxQueueLength",10),c=(new Date).toUTCString();if(s.UpdateActionUTCTime=[],r.sw===o||""===r.sw){var l=r.cw(s),f=null!=e&&((null===(n=e.AdoptedCandidates)||void 0===n?void 0:n.length)>0||(null===(a=e.Candidates)||void 0===a?void 0:a.length)>0);if(l&&!f){var h=l.UpdateActionUTCTime;h.push(c),s.UpdateActionUTCTime=h}else s.UpdateActionUTCTime.push(c),r.ow.push(s);var d=0;r.ow.forEach((function(t){d+=t.UpdateActionUTCTime.length})),r.sw=o,r.aw=t,(i||d>=u)&&((0,Gi.qe)(o,r.ow,t),r.lw())}else(0,Gi.qe)(r.sw,r.ow,r.aw),r.lw(o,t,[]),s.UpdateActionUTCTime.push(c),r.ow.push(s)}))}}},t.prototype.lw=function(t,n,e){void 0===t&&(t=""),void 0===n&&(n=""),void 0===e&&(e=[]),this.sw=t,this.aw=n,this.ow=e},t.prototype.cw=function(t){return this.ow&&w().find(this.ow,(function(n){return n.UserActionName===t.UserActionName&&n.UserActionType===t.UserActionType}))},t}();var Vi=e(80820),zi=e(78587),Qi=e(46407),Ui=e(32782),$i=e(29295);function ji(){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(274).then(e.bind(e,91976))];case 1:return[2,{default:t.sent().FileUploadRenderer}]}}))}))}function Wi(t){var n=(0,$i.J)(Wi,ji);return g.createElement(Ui.Z,null,g.createElement(n,(0,p.pi)({},t)))}var Ki=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.getElementTypeName=function(){return"Question.MatrixChoice"},n.prototype.verify=function(t){return!this.Model.Required||t&&0!==t.length?D.ej.Success:D.ej.RequiredError},n.prototype.getTypeDisplayName=function(){return"MatrixChoice"},n.prototype.getNormalizedAnswer=function(t){return t},n}(P.P);var Ji=e(58537);var Zi=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.fw=g.createRef(),n}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=y.extend({},this.props.HTMLAttributes,{id:"preview-setting-pane",role:"tablist",onKeyUp:this.hw.bind(this)});return t.className=(0,N.j)("preview-setting-pane",t.className),g.createElement("div",t,this.createViewModeButtons())},n.prototype.createViewModeButtons=function(){return[this.dw(Ji.w.Desktop,"Desktop",(0,T.pm)().Response_Preview_DeviceType_Desktop,(0,T.pm)().Response_Preview_DeviceType_Desktop_ScreenReader),this.dw(Ji.w.Mobile,"Phone",(0,T.pm)().Response_Preview_DeviceType_Mobile,(0,T.pm)().Response_Preview_DeviceType_Mobile_ScreenReader)]},n.prototype.dw=function(t,n,e,i){var r=this,o="preview-mode-button office-form-theme-button-color office-form-theme-select-color",s=t===this.props.Value,a={"aria-label":i,className:s?"".concat(o," ").concat("active"):o,onClick:function(){r.props.onValueChange(t),(0,q.$U)("DesignPage.PreView.Navigate",{previewMode:Ji.w[t]})},"aria-selected":s,role:"tab",ref:s?null:this.fw};return(0,z.F)({ButtonStyle:1,HTMLAttributes:a,FluentIcon:n,IconClassName:(0,dt.QR)()?"forms-icon-size16x16":"forms-icon-size20x20",key:Ji.w[t],Text:e,TextClassName:"preview-mode-button-text"})},n.prototype.hw=function(t){var n;switch(t.keyCode){case 37:case 38:case 39:case 40:this.props.Value===Ji.w.Desktop?this.props.onValueChange(Ji.w.Mobile):this.props.onValueChange(Ji.w.Desktop),null===(n=this.fw.current)||void 0===n||n.focus()}},n}(J.r),Xi=e(24742),Yi=e(92575),tr=e(29952),nr=e(43367),er=e(22768),ir=e(24497),rr=e(155),or=e(22530),sr=e(17764),ar=e(61111),ur=e(20572),cr=e(65863),lr=function(t){function n(n){var e=t.call(this,n)||this;return e.mw=e.mw.bind(e),e}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=this.props.Choice,n=this.props.ContainerClassName;this.props.IsChecked&&this.props.IsMobile&&(n=(0,N.j)(n,"active"));var e=(0,N.j)("office-form-question-choice-row",this.props.ClassNameForLabel),i=(0,et.pd)((function(){return t.Description}),et.t1);return g.createElement("div",{className:n},g.createElement("div",{className:this.props.IsSingleChoice?"radio":"checkbox"},g.createElement("label",{className:e},g.createElement("input",(0,p.pi)({"aria-checked":this.props.IsChecked,"aria-label":i,checked:this.props.IsChecked,disabled:this.props.Disabled,onChange:this.mw,type:this.props.IsSingleChoice?"radio":"checkbox",value:t.Description},this.props.HTMLPropsForInput)),this.props.children,this.gw())),this.bw())},n.prototype.gw=function(){var t,n;switch(this.props.AnswerType){case"Correct":n="Checkmark",t=this.props.IsMobile&&this.props.IsChecked?"image-button-checked-answerkey-mobile office-form-answerkey":"image-button-answerkey office-form-answerkey";break;case"Wrong":t=this.props.IsMobile?"image-button-checked-wrong-answer-mobile office-form-answerkey":"",n=this.props.IsMobile?"Dismiss":""}if(n)return(0,V.M)({FluentIcon:n,HTMLAttributes:{className:(0,N.j)(t,"forms-icon-size20x20"),role:"tooltip",title:this.props.ToolTipForAnswer}})},n.prototype.bw=function(){if(this.props.AnswerHint){var t=void 0;return t="Correct"===this.props.AnswerType?this.props.IsMobile?"validation-success-mobile":"validation-success":this.props.IsMobile?"validation-error-mobile":"validation-error",t=(0,N.j)("office-form-answerhint",t),g.createElement("div",{className:t},this.props.AnswerHint)}},n.prototype.mw=function(){this.props.onChange(this.props.Choice.Description)},n}(J.r),fr=e(88448),hr="6c660282-db72-436c-87bb-8272cba504d3",dr=function(t){function n(n){var e=t.call(this,n)||this;e.yw=g.createRef(),e.ww=(0,O.GW)();var i=e.Sw(),r=e.Cw(),o=e.Iw();return e.state={ChoiceOptions:r,IsOtherOptionSelected:!!i.OtherAnswer,LocalizedOptions:e.questionLocalizedItemMaster&&e.questionLocalizedItemMaster.Model.option,OptionsOrder:o,OrderedChoices:y.map(o,(function(t){return r[t]})),OtherOptionText:i.OtherAnswer,ReachMaxLengthLimit:!1,SelectedOptions:i.SelectedOptions},e.Dc=e.Dc.bind(e),e.Tw=e.Tw.bind(e),e.kw=e.kw.bind(e),e.xw=e.xw.bind(e),e.Fw=e.Fw.bind(e),e.Pw=e.Pw.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this.props.Master.Question.observe(this.kw),(this.props.ShowQuizResult||this.props.IncrementalLoadFormsEnabled)&&this.props.Master.observe(this.Fw,[or.r.Schema.Answer]),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.xw,[rr.A.Schema.choicesV1]);var n=[];n=(0,nr.addIoCSurveyFontToSchemas)(n),this.props.Master.Question.Form.observe(this.update,n)},n.prototype.componentWillUnmount=function(){this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.xw),this.props.Master.Question.Form.unobserve(this.update),this.props.Master.Question.unobserve(this.kw),(this.props.ShowQuizResult||this.props.IncrementalLoadFormsEnabled)&&this.props.Master.unobserve(this.Fw,[or.r.Schema.Answer]),t.prototype.componentWillUnmount.call(this)},n.prototype.componentWillReceiveProps=function(n){this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.xw),t.prototype.componentWillReceiveProps.call(this,n),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.xw,[rr.A.Schema.choicesV1])},n.prototype.shouldComponentUpdate=function(t,n){var e=!y.isEqual(t,this.props),i=!y.isEqual(n,this.state);return e||i},n.prototype.createReactNodes=function(){var t=this.props.Master.Question,n=t.Model,e=n.ChoiceType===D.T6.SingleChoice;return this.props.IsPrintViewDesignTime||this.props.ExpandAll||!t.showAsDropdown()||n.IsQuiz&&this.props.ShowQuizResult?[this.createChoices(e),this.getErrorMessageLabel()]:[this.Lw()]},n.prototype.getFormattedDataForImmersiveReader=function(){var n=t.prototype.getFormattedDataForImmersiveReader.call(this),e=null,i=document.createElement("ul");return y.forEach(this.state.OrderedChoices,(function(t){var n=document.createElement("li"),r=null;if(t.IsMathOption&&"undefined"!=typeof MathJax){e=e||MathJax.Hub.getAllJax(null);var o=y.find(e,(function(n){return n.originalText===t.Description}));if(o){var s=o.root&&o.root.toMathML&&o.root.toMathML();s&&(s=s.replace(/\n\s*/g,""),r="\x3c!--[if mathML]&#62;".concat((0,pt.F1)(s,!0),"&#60;![endif]--\x3e"))}}if(r)(0,Yi.p)(n,r);else{var a=document.createTextNode(t.Description);n.appendChild(a)}i.appendChild(n)})),i.appendChild(document.createElement("br")),n.splice(n.length-1,0,{content:i.outerHTML,mimeType:"text/html"}),n},n.prototype.Fw=function(){var t=this.Sw(),n=!!t.OtherAnswer,e=this.props.Master.Question.Model.ChoiceType===D.T6.SingleChoice;(0,et.hl)((function(){e&&(n=!!t.OtherAnswer&&0===t.SelectedOptions.length)})),this.setState({IsOtherOptionSelected:n,OtherOptionText:t.OtherAnswer,SelectedOptions:t.SelectedOptions})},n.prototype.Aw=function(t){},n.prototype.Ow=function(){var t,n=this,e=[],i=this.props.Master.Question.Model.ChoiceType===D.T6.SingleChoice,r=this.state.SelectedOptions;r&&r.forEach((function(t){return e.push(t)}));var o=this.state.OtherOptionText;if((0,et.pd)((function(){n.state.IsOtherOptionSelected&&o&&-1===e.indexOf(o)&&e.push(o)}),et.t1),i)t=e[0];else if(e.length){var s=this._w(e);t=JSON.stringify(s)}this.props.Master.Model.Answer=t},n.prototype.createChoices=function(t){var e=this,i=this.props.Master.Question.Model,r=this.state.OrderedChoices.length+(i.AllowOtherAnswer?1:0),o=this.props.Master.Question.Form,s=(0,C.w)(o,"ResponsePage.PollView"),a=(0,N.j)(this.props.IsMobile&&!s?"office-form-question-choice-mobile office-form-theme-page-background-active":"office-form-question-choice"),u=this.state.OrderedChoices.map((function(i,o){var s,u,c=-1!==e.state.SelectedOptions.indexOf(i.Description),l=e.props.Master.Question.Model.IsQuiz?"office-form-question-choice-quiz-row":"";if(e.props.Master.Question.Model.IsMathQuiz&&i.IsMathOption){var f=(0,er.Rq)({DisableLinebreaks:e.props.DisableFormulaLinebreak,Formula:i.Description,onRenderComplete:e.props.onHeightChange}),h="office-form-question-choice-formula";(0,vt.vh)()&&(h+=" formula-renderer-container-safari9"),u=g.createElement("div",{className:h},f)}else{l=(0,N.j)(l,"office-form-question-choice-text-row");var d=null===(s=e.questionLocalizedItemMaster)||void 0===s?void 0:s.getChoiceV1LocalizedMaster(e.state.OptionsOrder[o]),m=(0,ir.wg)(i.Description,i.FormsProDisplayRTText);d&&(m=(0,ir.wg)(d.Model.description,d.Model.formsProDisplayRTText)||m);var v={Text:(0,nr.getIoCModifiedTextField)(m,!1),ContainsHtml:!0,RenderMode:"RichText"};u=g.createElement("span",{className:"office-form-question-choice-text-span"},(0,cr.q)(v))}var p,b=n.getAnswerKeyMark(e.props,i,c);switch(b){case"Correct":p=e.props.LocalizedStrings.Quiz_CorrectAnswer;break;case"Wrong":p=e.props.LocalizedStrings.Quiz_WrongAnswer}var w={name:e.ww};return t&&y.extend(w,{"aria-posinset":o+1,"aria-setsize":r}),g.createElement(lr,{AnswerHint:n.getAnswerHintLabel(e.props,i,c),AnswerType:b,ToolTipForAnswer:p,Choice:i,ClassNameForLabel:l,ContainerClassName:a,Disabled:e.props.Disabled,HTMLPropsForInput:w,IsChecked:c,IsMobile:e.props.IsMobile,IsSingleChoice:t,key:o,LocalizedStrings:e.props.LocalizedStrings,onChange:e.Dc},u)})),c=this.getElementProps({key:"choicequestion-choices",role:t?"radiogroup":"group"});return g.createElement("div",(0,p.pi)({},c),u,this.Bw(t))},n.prototype.Bw=function(t){var n=this.props.Master.Question.Form,e=(0,C.w)(n,"ResponsePage.PollView");if(this.props.Master.Question.Model.AllowOtherAnswer){var i={className:this.props.IsMobile&&!e?"office-form-other-answer-mobile":"office-form-other-answer",key:"other-answer"};return g.createElement("div",(0,p.pi)({},i),g.createElement("div",{className:"radio"},g.createElement("label",null,this.Hw(t),this.qw())))}},n.prototype.Hw=function(t){var n=this.state.ChoiceOptions,e={"aria-label":this.props.LocalizedStrings.Response_Page_OtherAnswerTitle,checked:this.state.IsOtherOptionSelected,disabled:this.props.Disabled,name:t?this.ww:void 0,onChange:this.Tw,ref:"otherAnswerInput",role:"checkbox",type:"checkbox",value:this.state.OtherOptionText||""};return t&&(e.role="radio",e.type="radio",e["aria-posinset"]=n.length+1,e["aria-setsize"]=n.length+1),g.createElement("input",(0,p.pi)({},e))},n.prototype.Tw=function(){var t=this,n=this.state.IsOtherOptionSelected,e=y.clone(this.state.SelectedOptions);if(!n){this.props.Master.Question.Model.ChoiceType===D.T6.SingleChoice&&(e=[]);var i=this.yw.current;i&&i.focus()}this.setState({IsOtherOptionSelected:!n,SelectedOptions:e},(function(){return t.Ow()}))},n.prototype.qw=function(){var t={"aria-label":this.props.LocalizedStrings.Response_Page_OtherAnswerTitle,className:"office-form-other-answer-textbox"},n=this.props.IsPrintViewDesignTime?"":this.props.LocalizedStrings.Designer_OtherAnswer,e={AutoSelection:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"inline-display office-form-other-answer-margin-left-mobile"},MaxLength:(0,X.kA)(),onValueChange:this.Pw,Options:{HTMLPropsForInnerElement:t},Placeholder:n,ref:this.yw,Value:this.state.OtherOptionText||""},i=this.props.IsPrintViewDesignTime&&g.createElement("div",{className:"print-choice-other-answer-hint"},this.props.LocalizedStrings.Designer_OtherAnswer);return g.createElement("div",{className:"office-form-other-answer-inline"},(0,ur.ZA)(e),i)},n.prototype.Pw=function(t){var n=this,e=this.state.SelectedOptions;this.props.Master.Question.Model.ChoiceType===D.T6.SingleChoice&&(e=[]),this.setState({IsOtherOptionSelected:!!t,OtherOptionText:t,SelectedOptions:e},(function(){return n.Ow()}))},n.prototype.kw=function(){var t=this.Sw();this.setState({ChoiceOptions:this.Cw(),OptionsOrder:this.Iw(),OrderedChoices:this.zw(),OtherOptionText:t.OtherAnswer,SelectedOptions:t.SelectedOptions})},n.prototype.xw=function(){this.setState({LocalizedOptions:this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.Model.option})},n.prototype.Dc=function(t){var n=this,e=y.clone(this.state.SelectedOptions),i=this.props.Master.Question.Model.ChoiceType===D.T6.SingleChoice,r=this.state.IsOtherOptionSelected,o=!1;if(i){if(t===e[0])return;r=!1,e=[t]}else{var s=e.indexOf(t);-1===s?e.push(t):e.splice(s,1),o=JSON.stringify(e).length>Y.L.MaxAnswerLength}this.setState({IsOtherOptionSelected:r,ReachMaxLengthLimit:o,SelectedOptions:e,OtherOptionText:i?"":this.state.OtherOptionText},(function(){return n.Ow()}))},n.prototype.getErrorMessageLabel=function(){if(this.state.ReachMaxLengthLimit)return(0,sr._)({Alert:!0,HTMLAttributes:{className:"validation-error-message-label",role:"alert"},key:"textquestion-errorlabel",Label:this.props.LocalizedStrings.Error_Message_Question_Reach_Limit})},n.prototype.Lw=function(){var t,n,e=this,i=this.props.Master,r=i.Question.Model,o=this.state.OrderedChoices.map((function(t,n){var i,r=null===(i=e.questionLocalizedItemMaster)||void 0===i?void 0:i.getChoiceV1LocalizedMaster(e.state.OptionsOrder[n]);return{DisplayName:(0,ir.wg)(null==r?void 0:r.Model.description,null==r?void 0:r.Model.formsProDisplayRTText)||(0,ir.wg)(t.Description,t.FormsProDisplayRTText),Key:_.d.getObjectMasterFromModel(t).getInstanceId(),Value:t.Description}})),s=i.Model.Answer;r.AllowOtherAnswer&&o.push(this.Qw()),this.state.IsOtherOptionSelected&&(s=hr),!this.props.ShowDesignInfo&&this.state.IsOtherOptionSelected&&(t=this.Uw()),n=function(t){return e.jw(t)};var a=(0,tr.Oy)()?this.props.LocalizedStrings.Question_Choice_Placeholder:this.props.LocalizedStrings.Dropdown_DefaultHint,u=(0,ar.E)({AllowWrap:!0,HTMLAttributes:this.getElementProps({className:"office-form-question-dropdown",disabled:this.props.Disabled,title:r.Hint||a}),Label:r.Hint||a,key:"choicequestion-dropdown",onValueChange:n,Placeholder:r.Hint||a,SelectOptions:o,Value:s,NeedScroll:this.props.IsMobile});return g.createElement("div",{className:this.getValidationStyle()},u,t)},n.prototype.jw=function(t){var n=this,e=t===hr,i=e?[]:[t];(0,et.pd)((function(){n.setState({IsOtherOptionSelected:e,SelectedOptions:i},(function(){return n.Ow()}))}),et.t1)},n.prototype.Qw=function(){return{DisplayName:this.props.LocalizedStrings.Designer_OtherAnswer,Key:hr,Value:hr}},n.prototype.Uw=function(){var t=this,n=(0,tr.Oy)()?this.props.LocalizedStrings.Question_TextFiled_Placeholder:this.props.LocalizedStrings.TextField_DefaultPlaceholder,e={"aria-label":n,className:"office-form-other-answer-textbox"},i={AutoFocus:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"office-form-other-answer office-form-dropdown-other-answer"},onValueChange:function(n){t.setState({OtherOptionText:n,SelectedOptions:[]},(function(){return t.Ow()}))},Options:{HTMLPropsForInnerElement:e},Placeholder:n,ref:this.yw,Value:this.state.OtherOptionText};return(0,ur.ZA)(i)},n.prototype._w=function(t){var n=this.props.Master.Question.Model.Choices,e=y.map(n,(function(t){return t.Description}));return t.sort((function(t,n){return e.indexOf(t)-e.indexOf(n)}))},n.isQuizResultAnswerKey=function(t,n){if(!t||!t.IsAnswerKeys)return!1;var e=t.Choices;return!!e&&t.IsAnswerKeys[e.indexOf(n.Description)]},n.getAnswerKeyMark=function(t,e,i){var r=t.Master,o=r.Model.QuizResult,s=r.Question,a=n.isQuizResultAnswerKey(o,e);return e.IsAnswerKey&&t.ShowDesignInfo&&s.Model.IsQuiz||a?"Correct":i&&o&&o.IsAnswerKeys&&o.IsAnswerKeys.some((function(t){return t}))&&!a?"Wrong":"Normal"},n.getAnswerHintLabel=function(t,n,e){var i=t.Master.Model.QuizResult;if(!t.ShowDesignInfo&&e&&i){var r=i.Choices,o=r?r.indexOf(n.Description):-1;return i.AnswerHints&&i.AnswerHints[o]}},n.prototype.Cw=function(){var t=this.props.Master.Question.Model;return this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.getChoiceV1LocalizedMaster(t.Choices.length-1),_.d.convertToArray(t.Choices)},n.prototype.zw=function(){var t=this;return y.map(this.state.OptionsOrder,(function(n){return t.state.ChoiceOptions[n]}))},n.prototype.Iw=function(){for(var t=this.props.Master.Question.Model,n=[],e=0;e<t.Choices.length;e++)n[e]=e;return this.props.ShowQuizResult||!t.ShuffleOptions||this.props.DisableShuffle?n:y.shuffle(n)},n.prototype.Sw=function(){var t,n=this.props.Master,e=n.Model,i=n.Question.Model,r=i.ChoiceType===D.T6.SingleChoice,o=[],s=(0,Y.P)(e.Answer,i).SelectedOptions;s.length>0&&(r?[e.Answer]:s).forEach((function(n){-1!==y.findIndex(i.Choices,(function(t){return t.Description===n}))?o.push(n):i.AllowOtherAnswer&&(t=n)}));return{OtherAnswer:t,SelectedOptions:o}},n}(fr.e),mr=function(){function t(){}return t.prototype.createPreviewSettingPane=function(t){return function(t){return g.createElement(Zi,t)}(t)},t.prototype.addHeaderFontToSchemas=function(t){return t},t.prototype.addSurveyFontToSchemas=function(t){return t},t.prototype.getModifiedTextField=function(t,n){return t},t.prototype.getFooterElement=function(t){return t},t.prototype.getLazyLoadThemes=function(){return e.e(985).then(e.t.bind(e,79881,19)).then((function(t){return t.default}))},t.prototype.getDefaultTheme=function(){return{BackgroundColor:Vi.lP,BackgroundImage:null,Name:Qi.kC,PrimaryColor:Vi.tu,SecondaryColor:Vi.oc,Thumbnail:(0,zi.Jn)("/Images/Theme/new-teal-thumbnail.png")}},t.prototype.getThemeBackground=function(t){return t},t.prototype.getThemeStyle=function(t){return""},t.prototype.getMediaPickerPaneText=function(){return null},t.prototype.areImageUploadButtonsEnabled=function(){return!0},t.prototype.getMediaPickerPaneTitle=function(){return null},t.prototype.getMediaPickerPaneInfoContent=function(){return null},t.prototype.getImagePickerLocalContainerClassName=function(){return null},t.prototype.getFlexPaneWidth=function(){return 600},t.prototype.getErrorPage=function(){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(653).then(e.bind(e,22083))];case 1:return[2,{default:t.sent().ErrorPage}]}}))}))},t.prototype.callUpdatePR=function(t,n,e,i,r,o){return null},t.prototype.callGetPausedResponse=function(t,n){return Promise.resolve(null)},t.prototype.callSetLocaleItem=function(t,n,e,i){return null},t.prototype.callDeletePausedResponse=function(t,n){return null},t.prototype.callUpdatePRForTextQuestion=function(t,n,e,i,r){return null},t.prototype.getConditionalThankyouControl=function(t){return null},t.prototype.createHeaderThemeRenderer=function(t){return null},t.prototype.derivedThankYouMessageKey=function(t,n,e){return(0,p.mG)(this,void 0,Promise,(function(){return(0,p.Jh)(this,(function(t){return[2,Promise.resolve("")]}))}))},t.prototype.getMessageContent=function(t){return g.createElement(Xi.E,t)},t.prototype.createFileUploadQuestionRenderer=function(t){return Wi(t)},t.prototype.createCascadeQuestionRenderer=function(t){return null},t.prototype.getQuestionDelegatorClass=function(t){return function(t){switch(t){case"Question.Choice":return Y.L;case"Question.TextField":return st;case"Question.DateTime":return M;case"Question.Rating":return H;case"Question.Ranking":return B;case"Question.MatrixChoice":return Ki;case"Question.MatrixChoiceGroup":return A;case"Question.NPS":return E;case"Question.FileUpload":return R;default:throw Error(t+" is not supported")}}(t)},t.prototype.getCustomLanguageFriendlyName=function(t){return t},t.prototype.createChoiceQuestionRenderer=function(t){return g.createElement(dr,t)},t.prototype.getQuestionRendererFooter=function(t){return null},t.prototype.handleSubmitButtonClick=function(t,n){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(i){switch(i.label){case 0:return[4,e.e(653).then(e.bind(e,32286))];case 1:return[2,(0,i.sent().default)(t,n)]}}))}))},t.prototype.cvOnlyLanguageUtility=function(){return null},t}();var vr,gr,pr=e(36476);function br(){return e.e(514).then(e.t.bind(e,50964,19)).then((function(t){return t.default}))}function yr(){return vr||(vr=e.e(708).then(e.t.bind(e,1512,19)).then((function(t){return t.default})).then(Sr)),vr}function wr(t){var n=y.clone(t);n.OwnerId=(0,c.k0)().userInfo.UserId,n.OwnerTenantId=(0,c.k0)().userInfo.TenantId,n.Background.ResourceUrl=(0,_t.WN)(n.Background.ResourceUrl),n.Settings=JSON.parse(n.settings);var e=n.OtherInfo,i=(0,Ni.kJ)(n,"User",!1);return i.Model.Background.IsPredefined=!0,i.Model.OtherInfo=e,i.fieldsReady([F.x.Schema.Id]).then((function(){return(0,q.$U)("PortalView.Templates.Edit",{FormId:i?i.Model.Id:""}),i}))}function Sr(t){var n=(0,c.k0)().isCdnEnabled;return(0,T.ay)().then((function(e){return y.map(t,(function(t){var i=JSON.stringify(t);return i=i.replace(/Template_\w*/g,(function(t,n,i){return e[t]?JSON.stringify(e[t]).slice(1,-1):t})),n&&(i=i.replace(/\/Images\/MSATemplate/g,(0,pr.$B)("/Images/MSATemplate"))),JSON.parse(i)}))}))}function Nr(){return br().then((function(t){var n={},e=[];return Object.keys(t).map((function(n){return t[n].Questions})).forEach((function(t){y.forEach(t,(function(t){var i=y.find(e,(function(n){return n.GroupId===t.GroupId&&n.Title===t.Title}));t.GroupId&&"Question.MatrixChoice"===t.Type&&!i&&e.push(t),!!t.QuestionTagForIntelligence&&"Subjective"!==t.QuestionTagForIntelligence&&"Unknown"!==t.QuestionTagForIntelligence&&(n[t.QuestionTagForIntelligence]=t)}))})),{Item_1:n,Item_2:e}})).catch((function(t){return console.error(t),null}))}var Cr=function(){function t(){}return t.prototype.getMetricDeleteDialog=function(t){return null},t}();var Ir=e(38174),Tr=e(54496),kr=e(63481),xr=function(t){function n(n){var e=t.call(this,n)||this;return e.Ww=g.createRef(),e.Jw=e.Jw.bind(e),e.Zw=e.Zw.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this.Ww.current;t&&((0,kr.mZ)(b.findDOMNode(this)),t.focus())},n.prototype.componentDidUpdate=function(t){if(this.props.Shown&&!t.Shown){var n=this.Ww.current;n&&((0,kr.mZ)(b.findDOMNode(this)),n.focus())}},n.prototype.render=function(){if(!this.props.Shown)return null;var t={className:(0,N.j)("dialog-container",this.props.ClassName),onKeyDown:this.Zw,role:"dialog",tabIndex:-1};return g.createElement("div",(0,p.pi)({},t),this.Yw())},n.prototype.Yw=function(){var t=(0,Tr.p2)(this.props.HTMLAttributes,{className:"dialog-content",onBlur:this.Jw,ref:this.Ww,tabIndex:0});return g.createElement("div",(0,p.pi)({},t),this.props.children)},n.prototype.Jw=function(t){if(this.props.onBlur){var n=(0,Ir.y3)(t),e=this.Ww.current;e&&e.contains(n)||this.props.onBlur()}},n.prototype.Zw=function(t){27===t.keyCode&&(t.preventDefault(),t.stopPropagation(),this.props.onClose())},n}(J.r),Fr=e(25306),Pr=e(7899),Dr=e(93387),Mr=function(t){function n(n){var e=t.call(this,n)||this;return e.tS=-1,e.nS=g.createRef(),e.eS=!1,e.state={SortedElements:y.clone(e.props.AllElements)},e.iS=e.iS.bind(e),e.rS=e.rS.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this;(0,Pr.y)("Sortable").then((function(){t.setState({SortableLoaded:!0})}))},n.prototype.componentWillUnmount=function(){this.oS&&(this.oS.destroy(),this.oS=void 0)},n.prototype.componentWillReceiveProps=function(t){y.isEqual(this.props.AllElements,t.AllElements)||(this.setState({SortedElements:y.clone(t.AllElements)}),this.oS&&(this.oS.destroy(),this.oS=void 0))},n.prototype.componentDidMount=function(){var t=this.nS.current;this.state.SortableLoaded&&t&&this.sS(t),this.aS()},n.prototype.componentDidUpdate=function(t,n){if(this.state.SortedElements.length>0&&-1!==this.tS&&this.aS(),this.state.SortableLoaded&&!this.oS){var e=this.nS.current;e&&this.sS(e)}},n.prototype.render=function(){var t=this,n={className:this.props.IsMobile?"office-form-mobile-sort-list":"office-form-sort-list",ref:this.nS,role:"listbox"};return g.createElement("div",(0,p.pi)({},n,{key:"Ranking"}),y.map(this.state.SortedElements,(function(n,e){return t.fS(n,e)})))},n.prototype.sS=function(t){var n=this,e={animation:150,chosenClass:"office-form-sortable-chosen",delay:this.props.IsMobile?150:0,fallbackClass:"office-form-sortable-fallback",filter:".office-form-ranking-arrow",forceFallback:!0,ghostClass:"office-form-sortable-ghost",handle:".office-form-move-control-item",onEnd:function(e){var i=e.newIndex,r=e.oldIndex;r===i?e.item.firstChild.focus():(n.tS=0,r<i?$(t).find(".office-form-sortable-list-item-container:eq(".concat(r,")")).before($(e.item)):r>i&&$(t).find(".office-form-sortable-list-item-container:eq(".concat(r,")")).after($(e.item)),n.hS(r,i))},preventOnFilter:!1};try{this.oS=Sortable.create(t,e),this.eS||(0,q.$U)("DesignPage.Section.OpenMovePane",{Successful:!0}),this.eS=!0}catch(t){(0,q.$U)("DesignPage.Sections.SortableInitialization",{Successful:!1}),this.eS=!1}},n.prototype.fS=function(t,e){var i,r=this.dS(t.Model.Id);this.props.IsMobile&&(i=n.createDragHandleIcon());var o,s=(0,N.j)("office-form-sort-item",!this.props.Disabled&&r?"office-form-move-control-item office-form-theme-sort-item office-form-selected-item":"office-form-move-control-disabled-item"),a="".concat(t.Model.Id,"-").concat(e),u={"aria-posinset":e+1,"aria-setsize":this.state.SortedElements.length,className:s,disabled:this.props.Disabled,id:a,role:"option",tabIndex:!this.props.Disabled&&r?0:void 0};if(!this.props.Disabled&&r){var c={disabled:!0,tabIndex:-1},l=0===e,f={"aria-describedby":a,"aria-label":(0,T.pm)().Section_MovePanel_ArrowUp_Narrator,className:(0,N.j)("office-form-ranking-arrow",l?"office-sort-disabled-arrow":"office-form-active-arrow"),onClick:l?void 0:this.iS,title:(0,T.pm)().Section_MovePanel_ArrowUp_Narrator};f=l?(0,Tr.p2)(f,c):f;var h={ButtonStyle:1,children:(0,V.M)({FluentIcon:"Arrow Up",HTMLAttributes:{className:"forms-icon-size18x18"}}),HTMLAttributes:f,key:"form-up-arrow"+e},d=g.createElement(Dr.zx,(0,p.pi)({},h)),m=e===this.state.SortedElements.length-1,v={"aria-describedby":a,"aria-label":(0,T.pm)().Section_MovePanel_ArrowDown_Narrator,className:(0,N.j)("office-form-ranking-arrow",m?"office-sort-disabled-arrow":"office-form-active-arrow"),onClick:m?void 0:this.rS,title:(0,T.pm)().Section_MovePanel_ArrowDown_Narrator};v=m?(0,Tr.p2)(v,c):v;var b={ButtonStyle:1,children:(0,V.M)({FluentIcon:"Arrow Down",HTMLAttributes:{className:"forms-icon-size18x18"}}),HTMLAttributes:v,key:"form-down-arrow"+e},y=g.createElement(Dr.zx,(0,p.pi)({},b));o=g.createElement("div",{className:"office-form-sort-list-arrows"},d,y)}var w=(0,T.pm)().Designer_Sections_DefaultDescriptionWithTitle.format(e+1,t.Model.Title),S=g.createElement("div",(0,p.pi)({},u,{"data-index":e}),g.createElement("div",{className:"office-form-sort-item-indicator"},i),g.createElement("p",{className:"office-form-move-control-item-content"},w),o);return g.createElement("div",{className:"office-form-sortable-list-item-container office-form-unselectable",key:t.Model.Id},S)},n.prototype.iS=function(){this.vS(0)},n.prototype.rS=function(){this.vS(1)},n.prototype.gS=function(){var t=this;return y.findIndex(this.state.SortedElements,(function(n){return t.dS(n.Model.Id)}))},n.prototype.vS=function(t){var n=this.gS(),e=n;0===t?(this.tS=1,--e):(this.tS=2,++e),this.hS(n,e)},n.createDragHandleIcon=function(){return g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},g.createElement("circle",{cx:"9.5",cy:"6.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"14.5",cy:"6.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"9.5",cy:"12.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"14.5",cy:"12.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"9.5",cy:"18.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"14.5",cy:"18.5",r:"1.5",fill:"currentColor"}))},n.prototype.aS=function(){var t=this.gS(),n=this.nS.current;if(n){var e=n.children[t];if(e)if(0===this.tS)e.firstElementChild.focus();else{var i=void 0;i=1===this.tS?0===t?1:0:e===n.lastElementChild?0:1;var r=".office-form-sort-list-arrows > button:nth-child(".concat(i+1,")");e.querySelector(r).focus()}}this.tS=-1},n.prototype.dS=function(t){return t===this.props.Master.Model.Id},n.prototype.hS=function(t,n){var e=y.clone(this.state.SortedElements),i=e.splice(t,1)[0];e.splice(n,0,i),this.props.setDestIndex(n),this.setState({SortedElements:e})},n}(J.r),Lr=function(t){function n(n){var e=t.call(this,n)||this;e.pS=-1,e.bS=g.createRef(),e.sectionElementRef=g.createRef();return e.state={ShowDialogType:"None"},e.yS=e.yS.bind(e),e.wS=e.wS.bind(e),e.SS=e.SS.bind(e),e.NS=e.NS.bind(e),e.CS=e.CS.bind(e),e.IS=e.IS.bind(e),e.kS=e.kS.bind(e),e.xS=e.xS.bind(e),e.FS=e.FS.bind(e),e.PS=e.PS.bind(e),e}return(0,p.ZT)(n,t),n.prototype.render=function(){return g.createElement("div",{className:"form-designer-section-header",ref:this.sectionElementRef},g.createElement("h2",{className:"designer-section-title"},(0,T.pm)().Designer_Sections_DefaultDescription.format(this.props.Ordinal)),g.createElement("div",{className:"designer-section-action-bar",key:"ActionBar"},this.createMoreMenu(),"None"!==this.state.ShowDialogType?this.createDialog():void 0))},n.prototype.createMoreMenu=function(){var t={"aria-label":(0,T.pm)().SectionCard_DesignTime_Menu_Tooltip,children:(0,V.M)({FluentIcon:"More Horizontal",HTMLAttributes:{className:"forms-icon-size18x18"}}),className:"design-question-more-options",title:(0,T.pm)().SectionCard_DesignTime_Menu_Tooltip};return g.createElement(Q.Th,{AriaLabel:(0,T.pm)().Section_More_Settings,AriaLabelForSubmenu:(0,T.pm)().Section_More_Remove_Settings,ButtonStyle:1,ClassName:"design-section-actionbar-menu",ClassNameForContainer:"designer-section-menu-button",HTMLAttributes:t,MenuItemType:0,onMenuExpand:this.CS,ref:this.bS},this.createMoreMenuItems())},n.prototype.DS=function(){var t=g.createElement(j.s,{Active:!0,key:"removeSection",onClick:this.wS},g.createElement("div",{className:"designer-more-options-section-item"},g.createElement("span",null,(0,T.pm)().Designer_SectionActionBar_RemoveSection))),n=this.props.Master;return[t,g.createElement(j.s,{Active:!0,Disabled:0===n.Form.FormElementManager.findQuestionsInSection(n).length,key:"removeAll",onClick:this.IS},g.createElement("div",{className:"designer-more-options-section-item"},g.createElement("span",null,(0,T.pm)().Designer_SectionActionBar_RemoveAll)))]},n.prototype.createMoreMenuItems=function(){var t=this,n=g.createElement(j.s,{Active:!0,key:"duplicateSection",onClick:this.yS},g.createElement("div",{className:"designer-more-options-section-item"},g.createElement("span",null,(0,T.pm)().Designer_SectionActionBar_Duplicate))),e={children:g.createElement("div",{className:"designer-more-options-section-submenu"},g.createElement("span",null,(0,T.pm)().Designer_SectionActionBar_Remove),g.createElement(V.F,{FluentIcon:"Chevron Right",HTMLAttributes:{className:"forms-icon-size16x16 menu-section-item-icon"}})),className:"designer-more-options-section-item"},i=[n,g.createElement(j.s,{Active:!0,HTMLAttributes:e,key:"removeSectionMenu",SubMenu:!0},this.DS()),g.createElement(j.s,{Active:!0,Disabled:1===this.props.Master.Form.FormElementManager.SectionMasters.length,key:"moveSection",onClick:this.NS},g.createElement("div",{className:"designer-more-options-section-item"},g.createElement("span",null,(0,T.pm)().Designer_SectionActionBar_Move)))];return(0,et.hl)((function(){var n=g.createElement(j.s,{Active:!0,key:"addBranch",onClick:t.PS},g.createElement("div",{className:"designer-more-options-section-item"},g.createElement("span",null,(0,T.pm)().Designer_MenuItemForAddBranch)));i.push(n)})),i},n.prototype.yS=function(){var t=this.props.Master,n=t.Form.FormElementManager,e=n.findQuestionsInSection(t).length,i=n.duplicateSectionAndSubElements(t);this.props.designElement(i),(0,q.$U)("DesignPage.Section.Duplicate",{QuestionCount:e,questionType:t.Model.Type}),"survey"===t.Form.Model.Type&&2===t.Form.totalSectionCount()&&((0,q.$U)("DesignPage.Setting.ProgressBarEnabled"),t.Form.Model.ProgressBarEnabled="true")},n.prototype.wS=function(){var t=this,e=this.props.Master,i=e.Form.FormElementManager,r=this.props.MixerRef.current;if(r&&r.state.InDesignMode){var o=i.TopElementMasters,s=o.indexOf(e),a=o[s+1];this.props.designElement(a),this.props.DesignFocus.setLocked(!0),setTimeout((function(){t.props.DesignFocus.setLocked(!1)}))}n.tryMoveNextSectionToTop(i,e),e.Deleted=!0,(0,q.$U)("DesignPage.Section.Delete",{questionType:e.Model.Type}),this.MS()},n.prototype.MS=function(){var t=this.props.Master.Form;t.totalSectionCount()<=1&&((0,q.$U)("DesignPage.Setting.ProgressBarDisabled"),t.Model.ProgressBarEnabled="false")},n.tryMoveNextSectionToTop=function(t,n){var e=t.SectionMasters,i=e.indexOf(n),r=t.findQuestionsInSection(n,!0);0===i&&r.length>0&&e.length>1&&(e[i+1].Model.Order=n.Model.Order)},n.prototype.SS=function(){var t=this.props.Master,n=t.Form.FormElementManager.findQuestionsInSection(t).length;t.Form.FormElementManager.deleteSectionAndSubElements(t),(0,q.$U)("DesignPage.Section.DeleteWithQuestions",{QuestionCount:n,questionType:t.Model.Type}),this.MS()},n.prototype.xS=function(){var t=this.props.Master,n=this.pS;if(t&&n>=0){var e=t.Form.FormElementManager.SectionMasters;if(n<e.length){var i=e[n];if(t.Model.Id!==i.Model.Id){this.props.trackMoveElement();var r=t.Form.FormElementManager.findQuestionsInSection(t).length;t.Form.FormElementManager.moveSectionTo(t,i),(0,q.$U)("DesignPage.Section.Move",{QuestionCount:r})}}}this.kS()},n.prototype.FS=function(t){this.pS=t},n.prototype.IS=function(){this.setState({ShowDialogType:"DeletedConfirm"})},n.prototype.NS=function(){this.setState({ShowDialogType:"MoveSection"})},n.prototype.kS=function(){var t=this;this.setState({ShowDialogType:"None"},(function(){var n=t.bS.current;n&&n.focus()}))},n.prototype.PS=function(){var t=this.props.Master.Model;if(t.Id){(0,k.f5)().Model.SectionElementId=t.Id;var n=this.sectionElementRef.current;if(n){var e=n.parentElement.getBoundingClientRect().top;(0,k.f5)().Model.RelativeScrollHeight=e}}(0,k.f5)().Model.TopView="Branch",(0,q.$U)("DesignPage.Section.AddBranch",{sectionId:t.Id})},n.prototype.createDialog=function(){var t="MoveSection"===this.state.ShowDialogType;return g.createElement(xr,{HTMLAttributes:{className:t?"section-move-control-dialog":void 0},onClose:this.kS,Shown:"None"!==this.state.ShowDialogType},t?this.LS():this.AS())},n.prototype.getSectionDeleteAllMessage=function(){return(0,T.pm)().SectionCard_DesignTime_ConfirmDelete_Description.format(this.props.Master.Model.Title)},n.prototype.AS=function(){var t={ButtonStyle:1,HTMLAttributes:{className:"section-designer-action-button",onClick:this.kS},Text:(0,T.pm)().Common_Cancel_Text},n=g.createElement(Fr.A,(0,p.pi)({},t)),e={ButtonStyle:1,HTMLAttributes:{className:"section-designer-action-button",onClick:this.SS},Text:(0,T.pm)().Common_Yes_Text},i=g.createElement(Fr.A,(0,p.pi)({},e)),r=this.getSectionDeleteAllMessage();return[g.createElement("p",{className:"dialog-body",key:"body"},r),g.createElement("div",{className:"dialog-action-container right",key:"footer"},n,i)]},n.prototype.LS=function(){var t={ButtonStyle:1,HTMLAttributes:{className:"section-designer-action-button lg office-form-dark-theme-button",onClick:this.kS},Text:(0,T.pm)().Common_Cancel_Text},n=g.createElement(Fr.A,(0,p.pi)({},t)),e={ButtonStyle:1,HTMLAttributes:{className:"section-designer-action-button lg office-form-theme-button",onClick:this.xS},Text:(0,T.pm)().DesignPage_SectionDialog_Done},i=g.createElement(Fr.A,(0,p.pi)({},e)),r=(0,z.F)({ButtonStyle:0,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"dialog-close",onClick:this.kS},FluentIcon:"Dismiss",IconClassName:"forms-icon-size16x16",Text:(0,T.pm)().Common_Close_Text});return[g.createElement("div",{className:"dialog-header",key:"header"},g.createElement("h6",{className:"dialog-title"},(0,T.pm)().MoveSection_Title),r),g.createElement("div",{className:"dialog-body section-move-control-items",key:"body"},g.createElement(Mr,{AllElements:this.props.Master.Form.FormElementManager.SectionMasters,IsMobile:this.props.IsMobile,Master:this.props.Master,setDestIndex:this.FS})),g.createElement("div",{className:"dialog-action-container right",key:"footer"},n,i)]},n.prototype.CS=function(){(0,q.$U)("DesignPage.Section.OpenMenu",{questionType:this.props.Master.Model.Type})},n}(J.r);var Rr=function(){function t(){}return t.prototype.createSectionHeaderDesigner=function(t){return function(t){return g.createElement(Lr,t)}(t)},t}();function Ar(){return Promise.all([e.e(18).then(e.t.bind(e,55074,23)),e.e(18).then(e.t.bind(e,51544,23))]).then((function(){return h.Pv.Register(23).UsingSingleton((function(){return window.OfficeBrowserFeedback})),Er()}))}function Er(){return h.Pv.Resolve(23)}var Or,_r=e(66676),Br=function(){function t(){}return t.prototype.isActive=function(){return!0},t.prototype.onDismissCallback=function(t,n){},t}();function Hr(t){return"FluidFormPage.".concat(t)}function Gr(t,n){var e=Hr(t);(0,q.$U)(e,n,Or)}var qr="f50c10e9-5ff2-4868-a489-5bc207006122",Vr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.onDismissCallback=function(t,n){var e;t===qr&&Gr("LoopPollFps",{score:null===(e=n.getComponent("Rating").getSelectedRating())||void 0===e?void 0:e.substring(0,1)})},n.prototype.getCampaignDefinition=function(){return{CampaignId:qr,EndTimeUtc:"2023-07-31T16:00:00Z",GovernedChannelType:1,AdditionalDataRequested:["EmailAddress"],NominationScheme:{CooldownPeriod:{IntervalSeconds:1209600,Type:0},NominationPeriod:{IntervalSeconds:60,Type:0},PercentageDenominator:100,PercentageNumerator:100,Type:0},Scope:{Type:0},StartTimeUtc:"2023-02-13T02:29:22Z",SurveyTemplate:{Type:2,ActivationEvent:{Sequence:[{Activity:"LoopPollResume",Count:1,IsAggregate:!1,Type:0}],Type:1},Content:{Prompt:{Question:(0,T.pm)().Mobile_FPS_Question_Title,Title:(0,T.pm)().Polls_NPS_Title,YesLabel:(0,T.pm)().SuiteHeader_FPS_Prompt_YesLabel,NoLabel:(0,T.pm)().SuiteHeader_FPS_Prompt_NoLabel},Question:{Question:(0,T.pm)().Loop_Poll_FPS_Text_Question_Title},Rating:{Question:(0,T.pm)().Loop_Poll_FPS_Rating_Question_Title,RatingValuesAscending:[(0,T.pm)().Collection_FPS_RatingQuestion_Option1,(0,T.pm)().Collection_FPS_RatingQuestion_Option2,(0,T.pm)().Collection_FPS_RatingQuestion_Option3,(0,T.pm)().Collection_FPS_RatingQuestion_Option4,(0,T.pm)().Collection_FPS_RatingQuestion_Option5]}}}}},n}(Br),zr="a515efaf-b15f-4b3d-902d-7ad3c05d08a3",Qr=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.ls=(0,T.pm)(),n}return(0,p.ZT)(n,t),n.prototype.onDismissCallback=function(t,n){var e;zr===t&&Gr("QuickPollAddInFps",{score:null===(e=n.getComponent("Rating").getSelectedRating())||void 0===e?void 0:e.substring(0,1)})},n.prototype.getCampaignDefinition=function(){return{CampaignId:zr,EndTimeUtc:"2023-12-31T16:00:00Z",GovernedChannelType:1,AdditionalDataRequested:["EmailAddress"],NominationScheme:{CooldownPeriod:{IntervalSeconds:604800,Type:0},NominationPeriod:{IntervalSeconds:10,Type:0},PercentageDenominator:100,PercentageNumerator:100,Type:0},Scope:{Type:0},StartTimeUtc:"2023-04-03T02:29:22Z",SurveyTemplate:{Type:2,ActivationEvent:{Sequence:[{Activity:"QuickPollResume",Count:1,IsAggregate:!1,Type:0}],Type:1},Content:{Prompt:{Question:this.ls.Mobile_FPS_Question_Title,Title:this.ls.Polls_NPS_Title,YesLabel:this.ls.SuiteHeader_FPS_Prompt_YesLabel,NoLabel:this.ls.SuiteHeader_FPS_Prompt_NoLabel},Question:{Question:this.ls.Quick_Poll_Add_In_Suggestion_Question},Rating:{Question:this.ls.Quick_Poll_Add_In_Rating_Question,RatingValuesAscending:[this.ls.Collection_Quick_Poll_FPS_RatingQuestion_Option1,this.ls.Collection_FPS_RatingQuestion_Option2,this.ls.Collection_FPS_RatingQuestion_Option3,this.ls.Collection_FPS_RatingQuestion_Option4,this.ls.Collection_Quick_Poll_FPS_RatingQuestion_Option5]}}}}},n}(Br),Ur=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.isActive=function(){return(0,dt.Kw)()},n.prototype.onDismissCallback=function(t,n){var e;if("59e99581-75ea-4d84-bcc4-c2776b4a1aad"===t){var i=null===(e=n.getComponent("Rating").getSelectedRating())||void 0===e?void 0:e.substring(0,1);(0,q.$U)("TeamsMeetingPollNPS.RatingScore",{score:i})}},n.prototype.getCampaignDefinition=function(){return{CampaignId:"59e99581-75ea-4d84-bcc4-c2776b4a1aad",EndTimeUtc:"2025-12-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{CooldownPeriod:{IntervalSeconds:7776e3,Type:0},NominationPeriod:{IntervalSeconds:2592e3,Type:0},PercentageDenominator:100,PercentageNumerator:25,Type:0},Scope:{Type:0},StartTimeUtc:"2021-12-01T00:00:00Z",SurveyTemplate:{ActivationEvent:{Sequence:[{Activity:"TeamsMeetingPollUsageTime",Count:180,IsAggregate:!0,Type:0},{Activity:"TeamsMeetingPollResume",Count:1,IsAggregate:!1,Type:0}],Type:1},Type:4,Content:{Prompt:{Question:(0,T.pm)().Mobile_FPS_Question_Title,Title:(0,T.pm)().Polls_NPS_Title,YesLabel:(0,T.pm)().SuiteHeader_FPS_Prompt_YesLabel,NoLabel:(0,T.pm)().SuiteHeader_FPS_Prompt_NoLabel},Question:{Question:(0,T.pm)().Mobile_FPS_Text_Question_Title},Rating:{Question:(0,T.pm)().Polls_NPS_Rating_Question_Title,RatingValuesAscending:[(0,T.pm)().Mobile_FPS_Rating_Option1,(0,T.pm)().Mobile_FPS_Rating_Option2,(0,T.pm)().Mobile_FPS_Rating_Option3,(0,T.pm)().Mobile_FPS_Rating_Option4,(0,T.pm)().Mobile_FPS_Rating_Option5]}}}}},n}(Br),$r=e(8759);function jr(){return(0,et.pd)((function(){return"cafa0a7d-6a20-422a-a48b-ccd4cef6f8fe"}),et.t1)}var Wr,Kr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.onDismissCallback=function(t,n){var e;if(t===jr()){var i=null===(e=n.getComponent("Rating").getSelectedRating())||void 0===e?void 0:e.substr(0,1);(0,q.$U)("NPS.RatingScore",{score:i})}},n.prototype.getCampaignDefinition=function(){var t=(0,c.k0)().userInfo.IsMsa;return{AdditionalDataRequested:(0,et.pd)((function(){return t?["EmailAddress"]:[]}),et.t1),CampaignId:jr(),EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{CooldownPeriod:{IntervalSeconds:7776e3,Type:0},NominationPeriod:{IntervalSeconds:2592e3,Type:0},PercentageDenominator:100,PercentageNumerator:(0,et.pd)((function(){return t?50:25}),et.t1),Type:0},Scope:{Type:0},StartTimeUtc:"2017-01-01T00:00:00Z",SurveyTemplate:{ActivationEvent:{Sequence:[{Activity:"AppUsageTime",Count:300,IsAggregate:!0,Type:0},{Activity:"AppResume",Count:1,IsAggregate:!1,Type:0}],Type:1},Type:0}}},n}(Br),Jr="53d298c0-8a8f-4ad7-82f1-b88cfa2b867a",Zr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.isActive=function(){return"AdminPhishingReviewPage"===(0,Lt.C2)()},n.prototype.onDismissCallback=function(t,n){if(t===Jr){var e=n.getComponent("Rating").getSelectedRating();(0,q.$U)("AdminUnblock.IsFP",{IsFP:e===(0,T.pm)().AdminPhishingReview_Page_Unblock_Dialog_Option1})}},n.prototype.getCampaignDefinition=function(){return{AdditionalDataRequested:["EmailAddress"],CampaignId:Jr,EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{CooldownPeriod:{IntervalSeconds:7776e3,Type:0},NominationPeriod:{IntervalSeconds:2592e3,Type:0},PercentageDenominator:100,PercentageNumerator:100,Type:0},Scope:{Type:0},StartTimeUtc:"2020-11-10T00:00:00Z",SurveyTemplate:{ActivationEvent:{Sequence:[{Activity:"AdminUnblockForm",Count:1,IsAggregate:!0,Type:0}],Type:1},Content:{Prompt:{NoLabel:(0,T.pm)().SuiteHeader_FPS_Prompt_NoLabel,Question:(0,T.pm)().AdminPhishingReview_Page_Unblock_Dialog_Question_Title,Title:(0,T.pm)().AdminPhishingReview_Page_Unblock_Dialog_Help_Title,YesLabel:(0,T.pm)().SuiteHeader_FPS_Prompt_YesLabel},Question:{Question:(0,T.pm)().AdminPhishingReview_Page_Unblock_Dialog_Comment_Question},Rating:{Question:(0,T.pm)().AdminPhishingReview_Page_Unblock_Dialog_Title,RatingValuesAscending:[(0,T.pm)().AdminPhishingReview_Page_Unblock_Dialog_Option3,(0,T.pm)().AdminPhishingReview_Page_Unblock_Dialog_Option2,(0,T.pm)().AdminPhishingReview_Page_Unblock_Dialog_Option1]}},Type:2}}},n}(Br),Xr=[],Yr=[];function to(t){t.isActive()&&(Xr.push(t.getCampaignDefinition()),Yr.push(t.onDismissCallback))}function no(t,n){Wr=n,t.launch()}function eo(t,n){n&&Wr&&Yr.forEach((function(n){return n(t,Wr)}))}function io(t,n){var i=new Yn.o("OfficeNPS.load");i.start();var r=(0,c.k0)(),o=r.userInfo,s=o.TenantId,a=(20&t)>0;return Promise.all([Ar(),e.e(18).then(e.t.bind(e,23630,23)).then((function(t){return t.default.parse(window.navigator.userAgent)})),(0,$r.bG)()]).then((function(e){var i=e[0],u=e[1],c=e[2],l=(0,S.ro)()&&c&&c.legalAgeGroup;return l=l&&-1!==l?l:0,i.initOptions={ageGroup:l,appId:(0,et.pd)((function(){return(0,dt.P_)()?2617:2229}),et.t1),applicationGroup:{appData:JSON.stringify({Host:n||"Desktop",TenantType:t})},authenticationType:a?0:0===t?2:1,build:r.serverBuild,environment:(0,ht.yv)()?0:1,intlUrl:(0,zi.Go)("/Scripts/Vendors/officebrowserfeedback/1.8.3/intl/"),locale:(0,_r.K)()||"en-us",primaryColour:Vi.tu,secondaryColour:Vi.oc,sessionId:(0,te.k)(),stylesUrl:(0,zi.oE)("vendors/officebrowserfeedback/1.8.3/officebrowserfeedback.min.css",!1),telemetryGroup:{audienceGroup:(0,ht.yv)()?(0,Et.$O)()?"First Release":(0,S.ZL)()?"Microsoft":"Production":void 0,channel:r.ring,deviceType:u.platform.type,flights:r.flights,loggableUserId:a?"p:"+r.userInfo.PUID:0===t?r.userInfo.UserId:"a:"+r.userInfo.UserId,officeUILang:r.cultureInfo.LCID,platform:"".concat(u.os.name," ").concat(u.os.version),sku:r.userLicenseInfo?JSON.stringify(r.userLicenseInfo.licenses):void 0,tenantId:s},userEmail:o.Email,webGroup:{browser:u.browser.name,browserVersion:u.browser.version,dataCenter:r.datacenter,sourcePageName:(0,Lt.C2)(),sourcePageURI:window.location.pathname}},i.floodgate.initOptions={campaignDefinitions:(Xr.length||(to(new Kr),to(new Zr),to(new Ur),to(new Vr),to(new Qr)),Xr),onDismiss:eo,onSurveyActivatedCallback:{onSurveyActivated:no}},i.floodgate.initialize().then((function(){return i}))})).then((function(t){return t.floodgate.start().then((function(){return t}))})).then((function(t){window.addEventListener("focus",(function(){t.floodgate&&t.floodgate.start()})),window.addEventListener("blur",(function(){t.floodgate&&t.floodgate.stop()})),window.addEventListener("unload",(function(){t.floodgate&&(t.floodgate.getEngine().getActivityListener().logActivityStopTime("AppUsageTime"),t.floodgate.stop())})),i.end({resultType:"Success"})})).catch((function(t){var n=t&&t.toString().indexOf("window.localStorage is not available")>=0&&!(0,ne.y1)(),e=t instanceof Error&&t.stack;throw i.end({extraData:{ServiceError:e?{stack:t.stack,message:t.message}:t},resultType:n?"ExpectedFailure":"Failure"}),t}))}var ro,oo=Date.now(),so={},ao={},uo=function(){try{var t="FormsVersion"+window.location.pathname,n=window.localStorage.getItem(t),e=(0,c.k0)().version;return n===e||(window.localStorage.setItem(t,e),!1)}catch(t){return!1}}();function co(t,n){var e=Date.now(),i={sa:e-oo};return so[t]=i,n.then((function(t){return i.d=Date.now()-e,t})).catch((function(t){throw i.d=Date.now()-e,i.f=1,t}))}function lo(t,n,e){if(void 0===e&&(e=!1),!ro){var i=e?Promise.resolve():co("strings",(0,T.ay)()),r=h.Pv.Resolve(24);ro=i.then(t).then((function(t){return r(t,n)}))}return ro}function fo(t,n,e,i){lo(t,i).then((function(){Er().floodgate.getEngine().getActivityListener().logActivity(n,e)}),(function(){}))}function ho(t,n,e,i){lo(t,i).then((function(){Er().floodgate.getEngine().getActivityListener().logActivityStartTime(n,e)}),(function(){}))}function mo(t,n,e,i){lo(t,i).then((function(){Er().floodgate.getEngine().getActivityListener().logActivityStopTime(n,e)}),(function(){}))}var vo=e(77356),go=e(40947),po=e(46872);function bo(t){var n=0,e=!1;if(y.forEach(t.Questions,(function(t){t.IsQuiz&&(n+=t.Point||0,e=!0)})),e&&n)return g.createElement("span",{className:"office-form-theme-quiz-totalPoints-bar",key:"points"},(0,po.f)(n))}var yo=e(47432),wo=e(29774);function So(t){return h.Pv.Resolve("ICustomerVoiceTitleDesignerFactory").designerTitleCreate(t)}function No(){return h.Pv.Resolve("ICustomerVoiceQuestionUxFactory")}var Co=e(17290),Io=e(33447),To=function(){function t(n){if(t._instance)return t._instance;t._instance=this,this.ES=n,(0,ti.hu)(this.ES,"math service url is null")}return t.getInstance=function(){return new t(t.getFormMathServiceUrl())},t.getFormMathServiceUrl=function(){return oi.VY.getInstance().getServiceUrl("formmath/api/")},t.prototype.mathFormulaCalculation=function(t){if(!t||!t.QuestionMathML){return Promise.resolve({Aria:"",MatchedTemplateIDs:[],Responses:[]})}return ko({data:{Context:t.Context,Formulas:(0,p.ev)([t.QuestionMathML],t.ExistingAnswers,!0),InputFormat:"MathML",Locale:navigator.language,Mode:1,Origin:t.Origin,OutputFormat:"latex",RequiredIncorrectAnswerCount:t.IncorrectAnswerCount},method:"POST",requestUri:this.ES+"mathapi/calculation?formId="+t.FormId+"&questionId="+t.QuestionId,qosEventName:"Question.MathCalculation"})},t.prototype.mathQuestionGeneration=function(t,n){if(!t.Context){return Promise.resolve({Features:0,Results:[]})}var e={data:{Features:t.Features,Input:t.Context,InputFormat:"MathML",Locale:navigator.language,Origin:t.Origin,OutputFormat:"latex",RequiredQuestionsCount:t.QuestionCount,RequiredIncorrectAnswerCount:t.IncorrectAnswerCount},method:"POST",requestUri:this.ES+"mathapi/questions?formId="+t.FormId+"&questionId="+t.QuestionId,qosEventName:"Question.MathQuestionGeneration"};return n&&"error"!==n?function(t,n,e){return Promise.resolve(e||xo()).then((function(e){var i;return t.headers=$.extend(!0,t.headers,(i=e,{Accept:"application/json",AnalyzerToken:(0,gt.NW)().AnalyzerToken,Authorization:i?"Bearer "+i:"",ShareInvitationKey:(0,gt.$p)().Token||(0,gt.NW)().Token||(0,gt.NW)().sharetoken,ValidationToken:(0,gt.NW)().vt,__RequestVerificationToken:(0,c.k0)().antiForgeryToken})),(0,ae.lW)(t,n).then(me.EI,me.W3)}))}(e,{},n):ko(e)},t}();function ko(t){return xo().then((function(n){return t.headers=$.extend(!0,t.headers,{Accept:"application/json",Authorization:n?"Bearer "+n:"",__RequestVerificationToken:(0,c.k0)().antiForgeryToken}),(0,ae.lW)(t).then((function(t){(0,ti.hu)(t,"math calculation result is null");var n=(0,me.EI)(t);return(0,ti.hu)(n,"math calculation result parse failure"),n}),me.W3)}))}function xo(){return(0,se.a)().AuthContext.getFormApiToken()}function Fo(t){return t.IsMathQuiz&&!!t.ShowSubtitle&&!!t.Subtitle?(0,er.Rq)({Formula:t.Subtitle}):null}function Po(t){return(0,ze.UO)(t.ImageInfo)}function Do(t){return t.IsMathOption&&!!t.Description?(0,er.Rq)({Formula:t.Description,DisableLinebreaks:!0}):(0,cr.q)({Text:(0,ir.wg)(t.Description,t.FormsProDisplayRTText),RenderMode:"RichText",ContainsHtml:!0})}function Mo(t,n){return y.find(t.getWrappedForm().FormElementManager.QuestionMasters,(function(t){return t.Model.Id===n}))}function Lo(t,n){return t.IsQuiz?0:n?2:1}var Ro=e(68246),Ao="HistoryTemplateIdentify",Eo=0,Oo=0,_o=0,Bo=0,Ho={ChoiceOptionSuggestsOption:0};function Go(t){return!t||t.indexOf((0,T.pm)().Designer_DefaultFormTitle)>=0||t.indexOf((0,T.pm)().Designer_DefaultQuizTitle)>=0}function qo(t){var n;switch(t.QuestionType){case"Question.Choice":(n=Y.L.createDefaultDefinition()).Choices=t.ChoiceCandidates.map((function(t){return{Description:t,IsGenerated:!0}}));break;case"Question.DateTime":n=M.createDefaultDefinition();break;case"Question.TextField":(n=st.createDefaultDefinition()).Multiline=!!t.QuestionSettings&&t.QuestionSettings.Multiline;break;case"Question.Rating":n=H.createDefaultDefinition();break;default:return null}return n.Title=t.QuestionTitle,n}function Vo(t,n){var e=t;return e&&e.Results&&e.Results.length&&e.Results[0].Result&&e.Results[0].Result.ChoiceCandidates?{MatchQuery:n===Eo,Suggestion:e.Results[0].Result}:null}function zo(t,n){return Ro.A.createIntelligenceProvider().textAnalyzeWithFeatures(t,n)}var Qo,Uo={askSuggestion:function(t){var n=++Ho[t.Feature];return Ro.A.createIntelligenceProvider().askSuggestion(t).then((function(e){return e.MatchQuery=n===Ho[t.Feature],function(t,n){var e;(0,q.$U)("Intelligence.".concat(n.Feature,".Ask"),{ActionSubCategory:t,DetectedLanguage:n.DetectedLang,Feature:n.Feature,HasSuggestion:(null===(e=n.Suggestion)||void 0===e?void 0:e.length)>0,ModelName:n.ModelName,SuggestionId:n.SuggestionId,Variation:n.Variation})}("Ask",e),e}))},createQuestionByType:qo,getChoiceOptionSuggestion:function(t){var n=++Eo;return Ro.A.createIntelligenceProvider().textAnalyzeWithFeatures(256,t).then((function(t){return Vo(t,n)}))},getDefaultQuestionResult:function(){return Promise.resolve({MatchQuery:!0,Templates:[]})},getFilteredTemplates:function(t){return t.filter((function(t){return!!t})).filter((function(t){return t.Questions&&t.Questions.filter((function(t){return"Question.MatrixChoice"!==t.Type})).length>0}))},getHistoryFormSuggestion:function(t,n,e){var i=++Oo,r={MatchQuery:!0,Templates:[]};return Go(t)?Promise.resolve(r):Ro.A.createIntelligenceProvider().getHistorySuggestion(t,n,e).then((function(t){if(t&&t.Result){var o=t.Result;r.Templates.push({AlgorithmType:t.SuggestionType,FormTitle:o.Title||"",Questions:_.d.convertToArray(o.Questions),TemplateId:Ao}),r.Templates=Uo.getFilteredTemplates(r.Templates),r.Templates.forEach((function(t){return t.Questions.forEach((function(t){return function(t){if(t.QuestionInfo&&JSON.parse(t.QuestionInfo).IsMathQuiz&&t.Title){t.IsMathQuiz=!0;var n=t.Title;t.Title=n.split(Io.J)[0]}}(t)}))}))}return(0,q.$U)("Ingelligence.HistorySuggestion.Get",{Addressable:t.IsAddressable,FormId:n,IsQuiz:e}),r.MatchQuery=i===Oo,r}))},getLikertQuestionSuggest:function(t){var n=++Eo;return zo(8192,t).then((function(t){return Vo(t,n)}))},getOptionToOptionSuggestion:function(t,n){return function(t,n,e){void 0===e&&(e="None");var i=++Eo;return Ro.A.createIntelligenceProvider().getOptionToOptionSuggestion(t,n,e).then((function(t){var n={MatchQuery:i===Eo,Result:{ChoiceCandidates:[],MatchingPart:null,QuestionType:null}};return n.MatchQuery&&t&&t.ChoiceCandidates&&t.ChoiceCandidates.length>0?n.Result=t:n.MatchQuery&&t&&(n.Result.MatchingPart=t.MatchingPart),n}))}(t,n)},getQuestionsIntelligenceResult:function(t){var n=++Bo;return zo(2048,JSON.stringify(t)).then((function(t){var e,i=t;if(i&&i.Results&&i.Results.length&&i.Results[0].Result&&i.Results[0].Result.Questions){var r=i.Results[0].Result,o=[];r.Questions.map((function(t){var n=qo(t);n&&o.push(n)})),(e={MatchQuery:n===Bo,Templates:[]}).Templates.push({Questions:o,TemplateId:r.Id}),e.Templates=Uo.getFilteredTemplates(e.Templates)}return e})).catch((function(t){throw t}))},getQuestionsSuggestion:function(t){var n=++Bo;return zo(2048,JSON.stringify(t)).then((function(t){var e={MatchQuery:n===Bo,Templates:[]},i=t;if(i&&i.Results&&i.Results.length&&i.Results[0].Result&&i.Results[0].Result.Questions){var r=[];i.Results[0].Result.Questions.map((function(t){var n=qo(t);n&&r.push(n)})),e.Templates.push({Questions:r,TemplateId:i.Results[0].Result.Id}),e.Templates=Uo.getFilteredTemplates(e.Templates)}return e})).catch((function(t){throw t}))},getThemeSuggestion:function(t){var n=++_o,e={MatchQuery:!0,ThemeCategories:[]};return Go(t)?Promise.resolve(e):zo(65536,t).then((function(t){if(t&&t.Results&&t.Results.length&&t.Results[0].Result){var i=t.Results[0].Result;y.isArray(i)&&(e.ThemeCategories=i)}return e.MatchQuery=n===_o,e}))},HISTORYTEMPLATEID:Ao,isDefaultTitle:Go,logSuggestionKept:function(t,n,e){void 0===e&&(e="None")},logSuggestionSeen:function(t,n){},logUserSignal:function(t){return Ro.A.createIntelligenceProvider().logUserSignal(t)},predictResponseTime:function(t,n){return void 0===n&&(n=!1),new Promise((function(e,i){t.fieldsReady([F.x.Schema.Title,F.x.Schema.Questions]).then((function(){var r=y.filter(t.Model.Questions,(function(t){return"Question.Choice"===t.Type})),o=0,s=0,a=0;r.forEach((function(t){a+=t.Title.length,s+=t.Choices.length,y.forEach(t.Choices,(function(t){o+=t.Description.length}))}));var u=y.filter(t.Model.Questions,(function(t){return"Question.MatrixChoiceGroup"===t.Type})),c=0,l=0,f=0;u.forEach((function(t){c+=t.ChoiceGroup.length,f+=t.Title.length,y.forEach(t.ChoiceGroup,(function(t){l+=t.Description.length}))}));var h=y.filter(t.Model.Questions,(function(t){return"Question.Rating"===t.Type})),d=0,m=0;h.forEach((function(t){d+=t.Length,m+=t.Title.length}));var v=y.filter(t.Model.Questions,(function(t){return"Question.Ranking"===t.Type})),g=0,p=0,b=0;v.forEach((function(t){p+=t.ChoiceGroup.length,b+=t.Title.length,y.forEach(t.ChoiceGroup,(function(t){g+=t.Description.length}))}));var w=t.Model.Title,S={ChoiceCount:r.length,ChoiceTotalChoiceCount:s,ChoiceTotalChoiceLength:o,ChoiceTotalTitleLength:a,DateCount:y.filter(t.Model.Questions,(function(t){return"Question.DateTime"===t.Type})).length,LikertAverageOptionCount:c/u.length,LikertCount:u.length,LikertTotalOptionLength:l,LikertTotalStatementCount:y.filter(t.Model.Questions,(function(t){return"Question.MatrixChoice"===t.Type})).length,LikertTotalTitleLength:f,NPSCount:y.filter(t.Model.Questions,(function(t){return"Question.NPS"===t.Type})).length,RankingCount:v.length,RankingTotalChoiceCount:p,RankingTotalChoiceLength:g,RankingTotalTitleLength:b,RatingAverageOptionCount:d/h.length,RatingCount:h.length,RatingTotalTitleLength:m,TextCount:y.filter(t.Model.Questions,(function(t){return"Question.TextField"===t.Type})).length,TextTotalTitleLength:w?w.length:0};return Ro.A.createIntelligenceProvider().predictResponseTime(S).then((function(t){return n&&(0,q.$U)("Intelligence.PredictResponseTime.Time",{EstimatedTimeInSeconds:t.EstimatedTimeInSeconds,NonTextPartEstimatedTimeInSeconds:t.NonTextPartEstimatedTimeInSeconds}),t})).then(e,i)}))}))},textAnalyzeWithFeatures:zo};!function(t){t[t.None=0]="None",t[t.OptionSuggestionFromTitle=1]="OptionSuggestionFromTitle",t[t.OptionSuggestionFromOption=2]="OptionSuggestionFromOption",t[t.Math=3]="Math"}(Qo||(Qo={}));var $o=function(t){function n(n){var e=t.call(this,n)||this;return e.OS=g.createRef(),e._S=e._S.bind(e),e.HS=e.HS.bind(e),e}return(0,p.ZT)(n,t),n.prototype.shouldComponentUpdate=function(t){return!this.GS||(this.VS=!0,!1)},n.prototype.componentWillMount=function(){var t=this;(0,Pr.y)("Sortable").then((function(){t.setState({SortableLoaded:!0})}))},n.prototype.componentDidMount=function(){this.state.SortableLoaded&&!this.props.Disabled&&this.sS()},n.prototype.componentDidUpdate=function(){this.props.Disabled||this.oS||!this.state.SortableLoaded||this.sS()},n.prototype.componentWillUnmount=function(){this.oS&&this.oS.destroy()},n.prototype.render=function(){return g.createElement("div",{ref:this.OS},this.props.children)},n.prototype.sS=function(){var t=this.OS.current;t&&(this.oS=Sortable.create(t,{animation:100,chosenClass:this.props.ChosenClass,fallbackClass:this.props.FallbackClass,forceFallback:!0,ghostClass:this.props.GhostClass,handle:".".concat(this.props.Handler),onEnd:this._S,onStart:this.HS,preventOnFilter:!1}))},n.prototype._S=function(t){this.GS=!1;var n=!1,e=t.oldIndex,i=t.newIndex;if(e!==i){var r=this.OS.current;e<i?$(r).children(":eq(".concat(e,")")).before($(t.item)):e>i&&$(r).children(":eq(".concat(e,")")).after($(t.item)),n=this.props.onExchange(e,i)}this.VS&&!n&&(this.forceUpdate(),this.VS=!1)},n.prototype.HS=function(){this.GS=!0},n}(J.r),jo=e(65434),Wo=e(71209),Ko=function(t){function n(n,e){var i=t.call(this,n)||this;return i.zS=e,i.blockEndDesignMode=i.blockEndDesignMode.bind(i),i.mathCalculation=i.mathCalculation.bind(i),i.QS=i.QS.bind(i),i.US=i.US.bind(i),i.$S=i.$S.bind(i),i}return(0,p.ZT)(n,t),n.prototype.createMathBar=function(){var t=this.props.Master.Model;if(t.IsPlainTextInMathField){var n={AutoFocus:v.Wr===this.state.SelectedElementIndex,AutoSelection:!0,HTMLAttributes:(0,Tr.p2)(this.getElementFocusingProps(v.Wr),{className:"design-question-math-plaintext-text"}),MaxLength:(0,X.ED)(),MinimalHeight:(0,X.gj)(),onValueChange:this.QS,Options:{HTMLPropsForInnerElement:{className:"design-question-math-plaintext-text"}},Placeholder:(0,T.pm)().Designer_PlaceholderForQuestionSubtitle,Value:t.Subtitle||""};return g.createElement("div",{className:"design-question-math-plaintext",ref:this.getElementRef(v.Wr)},(0,ur.ZA)(n),this.jS())}var e=(0,Tr.p2)(this.getElementFocusingProps(v.Wr),{className:this.state.SelectedElementIndex===v.Wr?"active":""});return g.createElement("div",{className:"design-question-math-container",ref:this.getElementRef(v.Wr)},g.createElement(er.qS,{blockEndDesignMode:this.blockEndDesignMode,Disabled:!1,HasFocus:v.Wr===this.state.SelectedElementIndex,HTMLAttributes:e,Location:this.zS,onRenderComplete:this.mathCalculation,onValueChange:this.QS,Placeholder:(0,T.pm)().Designer_PlaceholderForQuestionFormula,QuestionId:t.Id,Value:t.Subtitle||""},this.jS()))},n.prototype.createMathItem=function(){var t,n=this.props.Master.Model;return n.IsQuiz&&!(0,ht.x8)()&&(t={Checked:n.IsMathQuiz,Description:(0,T.pm)().Designer_MenuItemForMathLabel,Key:"mathItem",MenuItemType:1,onExecute:this.US}),t},n.prototype.mathCalculation=function(t,n){},n.prototype.blockEndDesignMode=function(t){this.props.DesignFocus.setLocked(t)},n.prototype.QS=function(t){this.props.Master.Model.Subtitle=t},n.prototype.jS=function(){var t,n,e,i=this.props.Master.Model,r="design-question-choice-to-math-button";return this.props.IsMobile&&(r=(0,N.j)(r,"isMobile")),v.Wr===this.state.SelectedElementIndex&&(r=(0,N.j)(r,"active-choice")),i.IsPlainTextInMathField?(t={className:r,onClick:this.$S},n=(0,T.pm)().Designer_Question_Equation_Button,e=(0,T.pm)().Designer_Question_Equation_Button_Tooltip):(t={className:r,onClick:this.$S},n=(0,T.pm)().Designer_Question_EquationToText_Button,e=(0,T.pm)().Designer_Question_EquationToText_Button_Tooltip),(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:(0,Tr.p2)(this.getElementFocusingProps(v.Wr),t),FluentIcon:i.IsPlainTextInMathField?"Math Formula":"Text Field",IconClassName:"forms-icon-size24x24",Text:n,Tooltip:e})},n.prototype.$S=function(t){var n=this.props.Master.Model;n.IsPlainTextInMathField=!n.IsPlainTextInMathField,(0,q.$U)(n.IsPlainTextInMathField?"DesignPage.Quiz.SwitchMathToTextInput":"DesignPage.Quiz.SwitchTextToMathInput",{location:this.zS,questionId:n.Id}),this.forceUpdate()},n.prototype.US=function(){var t=this.props.Master,n=t.Model;(0,q.$U)("DesignPage.QuestionMenu.MathOption",{questionType:n.Type,value:!!n.IsMathQuiz}),t.bulkEdit((function(){n.IsMathQuiz=!n.IsMathQuiz;var t=new it.E(n).getAnswers();n.IsMathQuiz?(n.ShowSubtitle=!0,n.OptionDisplayStyle=D.h3.ListAll,y.forEach(n.Choices,(function(t){t.IsGenerated&&(t.Description=""),t.IsMathOption=!0})),n.IsAnswerPlainText=!1,"Question.TextField"===n.Type&&(t&&t.length>0?(n.IsMathInputDefault=!1,n.InputSwitcherDisabled=!0):(n.IsMathInputDefault=!0,n.InputSwitcherDisabled=!1))):(y.forEach(n.Choices,(function(t){t.IsMathOption=!1})),n.IsAnswerPlainText=!0,"Question.TextField"===n.Type&&(y.each(t,(function(t){t.isMath=!1})),n.GradingBasis=JSON.stringify(t),n.InputSwitcherDisabled=!0,n.IsMathInputDefault=!1))}))},n}(Wo.v),Jo=function(t){function n(n){var e=t.call(this,n,"Choice.Subtitle")||this;return e.WS=g.createRef(),e.KS=g.createRef(),e.vo=!0,e.JS="",e.ZS={QuestionMathML:"",OriginalText:""},e.XS=!1,e.YS=!1,e.tN=null,e.nN=null,e.eN=-1,e.iN=-1,e.rN=function(){return e.oN()},e.sN=e.sN.bind(e),e.aN=e.aN.bind(e),e.uN=e.uN.bind(e),e.cN=e.cN.bind(e),e.lN=e.lN.bind(e),e.fN=e.fN.bind(e),e.dN=e.dN.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){if(t.prototype.componentDidMount.call(this),this.mN(),!(0,ht.x8)()){var n=this.props.Master;n.observe(this.rN,[n.Schema.Choices[0].Description])}},n.prototype.componentWillUnmount=function(){(this.vo=!1,t.prototype.componentWillUnmount.call(this),(0,ht.x8)())||this.props.Master.unobserve(this.rN)},n.prototype.createReactNodes=function(){var t=this;return(0,et.pd)((function(){return[t.vN(),t.createAnswerTagDiv(t.props.Master.Model.FormsProAnswerTag)]}),et.t1)},n.prototype.onTitleValueChange=function(){this.mN(),this.gN()},n.prototype.createMoreMenuItems=function(){var n,e,i=this.props.Master.Model;if("Question.Choice"===i.Type){n={Checked:i.ShuffleOptions,Description:(0,T.pm)().Designer_QuestinMenu_ShuffleOptions,Key:"shuffleItem",MenuItemType:1,onExecute:function(){(0,q.$U)("DesignPage.QuestionMenu.ShuffleOptions",{questionType:i.Type,value:i.ShuffleOptions}),i.ShuffleOptions=!i.ShuffleOptions}}}"Question.Choice"!==i.Type||i.IsMathQuiz||i.ChoiceType===D.T6.MultiChoice||(e={Checked:i.OptionDisplayStyle===D.h3.Dropdown,Description:(0,T.pm)().Designer_AllowDropDown,Key:"dropdownItem",MenuItemType:1,onExecute:function(){(0,q.$U)("DesignPage.QuestionMenu.DropDown",{questionType:i.Type}),i.OptionDisplayStyle=i.OptionDisplayStyle===D.h3.Dropdown?D.h3.ListAll:D.h3.Dropdown}});var r=[n,this.createValidationItem(),e,this.createMathItem(),!1].filter((function(t){return!!t}));return r=r.concat(t.prototype.createMoreMenuItems.call(this))},n.prototype.createSuggestionBar=function(){var t=this,n=this.state;if(this.state.ChoiceCandidates&&(this.props.Master.Model.IsMathQuiz||n.IntelligenceProvider!==Qo.Math)){var e=n.ChoiceCandidates.filter((function(e){return!t.wN(e.text,n.IntelligenceProvider===Qo.Math)}));if(e.length){n.IntelligenceProvider===Qo.Math?this.SN():this.XS||(this.NN(),this.XS=!0);var i=[],r=void 0,o=void 0,s=(0,N.j)("design-question-choice-candidate office-form-theme-primary-foreground","office-form-theme-bgcolor-hover"),a="design-question-choice-candidate office-form-theme-button";switch(n.IntelligenceProvider){case Qo.OptionSuggestionFromTitle:i=[(0,T.pm)().Designer_Intelligence_Options];var u={ButtonStyle:1,HTMLAttributes:{className:a,onClick:function(){e.forEach((function(n){return t.CN(n.text)})),t.setFocusToTitleElement()}},key:"option_addAll",Text:(0,T.pm)().Designer_Intelligence_AddAll};r=g.createElement(Fr.A,(0,p.pi)({},u)),o=e.map((function(n,i){var r={ButtonStyle:1,HTMLAttributes:{className:s,onClick:function(r){t.CN(n.text),1!==e.length&&i!==e.length-1||t.setFocusToTitleElement()}},Text:n.text};return g.createElement(Fr.A,(0,p.pi)({key:"option_"+i},r))}));break;case Qo.Math:if(i=[(0,T.pm)().Designer_Intelligence_Results],e.length>1){var c={ButtonStyle:1,HTMLAttributes:{className:a,onClick:function(){e.forEach((function(n){return t.CN(n.text,n.isAnswer,n.templateId)})),t.setFocusToTitleElement()}},key:"option_addAll",Text:(0,T.pm)().Designer_Intelligence_AddAll};r=g.createElement(Fr.A,(0,p.pi)({},c))}o=e.map((function(n,e){return(0,z.F)({ButtonStyle:1,children:(0,er.Rq)({Formula:n.text}),GlyphButtonStyle:"Horizontal",HTMLAttributes:{className:(0,N.j)("design-question-choice-candidate-math office-form-theme-primary-foreground","office-form-theme-bgcolor-hover"),onClick:function(){t.CN(n.text,n.isAnswer,n.templateId),t.setState({SelectedElementIndex:v.Wr});var e=t.getElementRef(v.Wr).current;e&&(0,Co.x)($(e).find(".design-formula-mixer"))},title:n.isAnswer?(0,T.pm)().GradingView_CorrectAnswer_AccessibilityLabel:(0,T.pm)().GradingView_IncorrectAnswer_AccessibilityLabel},FluentIcon:n.isAnswer?"Checkmark":"",IconClassName:n.isAnswer?"design-question-choice-candidate-icon-correct forms-icon-size16x16":void 0,key:"option_"+e})}))}return g.createElement("div",{className:"design-question-candidate-bar","aria-live":"polite"},i.concat(r,o))}}},n.prototype.mathCalculation=function(t,n){var e=this;if(this.ZS={QuestionMathML:n,OriginalText:t},t&&n){this.props.Master.Model.LastMathMLFormula=n;var i=this.props.Master.Model.Title+Io.J+t,r=y.map(this.props.Master.Model.Choices,(function(t){return t.Description})),o=this.props.Master.Form.Model.Id,s=this.props.Master.Model.Id;To.getInstance().mathFormulaCalculation({Context:i,FormId:o,IncorrectAnswerCount:3,QuestionMathML:n,ExistingAnswers:r,Origin:"ChoiceQuestion",QuestionId:s}).then((function(t){e.vo&&((0,ti.hu)(t&&t.Responses,"math calculation result is null in question designer"),e.setState({ChoiceCandidates:t.Responses.map((function(t){return{isAnswer:t.Answer.IsCorrect,templateId:t.Answer.TemplateID,text:t.Answer.Formula,title:t.Answer.IsCorrect?(0,T.pm)().Designer_Question_Choice_CorrectAnswer_Tooltip:(0,T.pm)().Designer_Question_Choice_IncorrectAnswer_Tooltip}})),IntelligenceProvider:Qo.Math,TemplateIds:t.MatchedTemplateIDs}))}))}else this.setState({ChoiceCandidates:[],IntelligenceProvider:Qo.None})},n.prototype.IN=function(){return this.state.ShowDeleteOptionDialog&&this.TN()},n.prototype.TN=function(){(0,T.pm)().MFPBranchingRules_Delete_Option_Popup_Desc;return!1},n.prototype.fN=function(){this.setState({ShowDeleteOptionDialog:!1})},n.prototype.dN=function(){this.setState({ShowDeleteOptionDialog:!1}),this.kN(null,this.iN)},n.prototype.mN=function(){var t=this,n=this.props.Master.Model;if(!n.IsMathQuiz){window.clearTimeout(this.xN),this.xN=window.setTimeout((function(){Uo.getChoiceOptionSuggestion(n.Title).then((function(n){t.vo&&(n&&n.MatchQuery&&n.Suggestion?t.setState({ChoiceCandidates:n.Suggestion.ChoiceCandidates.map((function(t){return{text:t}})),IntelligenceProvider:Qo.OptionSuggestionFromTitle,MatchingPart:n.Suggestion.MatchingPart}):t.setState({ChoiceCandidates:[],IntelligenceProvider:Qo.None}))})).catch((function(n){t.vo&&t.setState({ChoiceCandidates:[],IntelligenceProvider:Qo.None})}))}),500)}},n.prototype.oN=function(){var t=this,n=this.props.Master.Model;if(!(n.IsMathQuiz||this.state.ChoiceCandidates&&this.state.ChoiceCandidates.length>0&&this.state.IntelligenceProvider!==Qo.OptionSuggestionFromOption)){var e=y.filter(n.Choices,(function(t){return!t.IsGenerated}));if(0!==e.length){window.clearTimeout(this.xN);this.xN=window.setTimeout((function(){var n={Data:e.map((function(t){return t.Description})),Feature:"ChoiceOptionSuggestsOption"};Uo.askSuggestion(n).then((function(n){t.FN(n.MatchQuery,n.Suggestion,JSON.stringify(n.ExtraData),n)})).catch((function(n){t.vo&&t.setState({ChoiceCandidates:[],IntelligenceProvider:Qo.None})}))}),500)}else this.setState({ChoiceCandidates:[],IntelligenceProvider:Qo.None})}},n.prototype.FN=function(t,n,e,i){var r=this;void 0===i&&(i=null),this.vo&&t&&(n&&n.length>0?this.setState({ChoiceCandidates:n.map((function(t){return{text:t}})),IntelligenceProvider:Qo.OptionSuggestionFromOption,MatchingPart:e},(function(){r.JS=(0,O.GW)(),r.NN(),r.tN=i,Uo.logSuggestionSeen("Show",i)})):this.setState({ChoiceCandidates:[],IntelligenceProvider:Qo.None}))},n.prototype.gN=function(){var t=this,n=this.props.Master.Model;if(n.IsMathQuiz&&!n.IsPlainTextInMathField){window.clearTimeout(this.PN),this.PN=window.setTimeout((function(){t.mathCalculation(t.ZS.OriginalText,t.ZS.QuestionMathML)}),1e3)}},n.prototype.wN=function(t,n){var e=this.props.Master.Model.Choices;return y.some(e,(function(e){return!!e.Description&&(n?e.Description.replace(/\s/g,"")===t.replace(/\s/g,""):e.Description===t)}))},n.prototype.CN=function(t,n,e){this.state.IntelligenceProvider===Qo.Math?this.DN(t,n,e):this.MN(t);var i=this.props.Master,r=i.insertChoice(t,this.state.IntelligenceProvider===Qo.Math);n&&i.setAnswerKey(r,!0)},n.prototype.vN=function(){var t,n=this,e=this.props.Master.Model,i=e.Choices,r=i.length,o=g.createElement("div",{className:"design-question-choice-options-div",key:"choiceMainContainer"},g.createElement($o,{ChosenClass:"design-question-choice-chosen",Disabled:!1,FallbackClass:"design-question-drag-fallback",GhostClass:"design-question-drag-ghost",Handler:"design-question-drag-handler",onExchange:this.lN},y.map(i,(function(t,e){return n.RN(t,e)})))),s={className:"design-question-button office-form-theme-button-color",onClick:function(){(0,q.$U)("DesignPage.Questions.AddOption",{index:r,questionId:e.Id,questionType:e.Type}),n.AN(r)}},a=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"Horizontal",HTMLAttributes:s,FluentIcon:"Add",IconClassName:"forms-icon-size18x18 office-form-theme-primary-foreground",ref:this.WS,Text:(0,T.pm)().Designer_AddOneMore,TextClassName:"design-question-addonemore"});if(!e.AllowOtherAnswer&&!e.IsQuiz){var u={className:"design-question-button office-form-theme-button-color",onClick:this.aN};t=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"Horizontal",HTMLAttributes:u,Text:(0,T.pm)().Designer_AllowOtherAnswer,TextClassName:"design-question-addothermore"})}return g.createElement("div",{className:"design-question-all-choices",key:"choices"},o,this.EN(),this.ON(),g.createElement("div",{className:"design-question-add-option-container",key:"addOptionContainer"},g.createElement("div",{className:"design-question-add-option-element"},a),g.createElement("div",{className:"design-question-add-option-element"},t)))},n.prototype.lN=function(t,n){var e=this.props.Master,i=e.getSnapshot([(0,k.zE)().Schema.Choices]).Choices;return!(t>=i.length||n>=i.length)&&(e.bulkEdit((function(r){var o=_.d.convertToArray(i),s=o.splice(t,1);o.splice(n,0,s[0]),r.Choices=o,r.IsQuiz||(0,St.M5)()||rr.A.handleChoicesV1Exchange(t,n,r.Id,e.Form)})),!0)},n.prototype.aN=function(){var t=this;(0,q.$U)("DesignPage.Questions.AddOtherOption",{questionType:this.props.Master.Model.Type}),this.onUpdateDone((function(){var n=t.WS.current;n&&n.focus()})),this.props.Master.Model.AllowOtherAnswer=!0},n.prototype.RN=function(t,e){var i=this.props.Master,r=i.Model,o=!1,s=i.showAsDropdown(),a=r.DefaultValue&&JSON.parse(r.DefaultValue);a&&a.hasOwnProperty(e)&&(o=!0);var u=[n.createDragHandleIcon()],c="unselectable-text design-question-choice-label";if(s)c+=" design-question-dropdown-label";else{var l=r.ChoiceType===D.T6.MultiChoice?"checkbox":"radio";u.push(g.createElement("input",{"aria-label":(0,T.pm)().DesignPage_ChoiceOptionRadioBox_AriaLabel.format(e+1),disabled:!0,className:"design-question-choice-icon",type:l,key:"choiceIcon"})),c+=" design-question-choice-sortable"}var f,h=g.createElement("div",{className:"design-question-choice-icon-group"},u);r.IsMathQuiz&&(t.IsMathOption?(e===this.eN&&(this.eN=-1),f=g.createElement(er.qS,{blockEndDesignMode:this.blockEndDesignMode,HasFocus:this.state.SelectedElementIndex===e,HTMLAttributes:this.getElementFocusingProps(e),Location:"Choice.Option",onValueChange:this._N.bind(this,e),Placeholder:(0,T.pm)().Designer_Choices_Euqation_Placeholder,QuestionId:"",Value:t.Description},this.BN(e))):f=g.createElement("div",{className:"design-choice-option-text-input-container",key:"choiceContent"},this.HN(t.Description,e,o),this.BN(e)));var d=this.GN(t.Description,e),m=this.qN(e),v=this.VN(t.Description,e),p=(0,ir.wg)(t.Description,t.FormsProDisplayRTText);return g.createElement("div",{className:"design-question-choice",key:_.d.getObjectMasterFromModel(t).getInstanceId()},g.createElement("div",{className:c,ref:this.getElementRef(e),key:"choiceContentContianer"},h,f||this.HN(p,e,o),d,!1,m,v),this.zN(t,e))},n.createDragHandleIcon=function(){return g.createElement("span",{className:"design-question-drag-handler",key:"dragIcon"},g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},g.createElement("circle",{cx:"9.5",cy:"6.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"14.5",cy:"6.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"9.5",cy:"12.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"14.5",cy:"12.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"9.5",cy:"18.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"14.5",cy:"18.5",r:"1.5",fill:"currentColor"})))},n.prototype.BN=function(t){var n,e,i,r=this.props.Master.Model.Choices[t],o="design-question-choice-to-math-button";return this.props.IsMobile&&(o=(0,N.j)(o,"isMobile")),t===this.state.SelectedElementIndex&&(o=(0,N.j)(o,"active-choice")),r.IsMathOption?(n={className:o,onClick:this.sN(t)},e=(0,T.pm)().Designer_Question_EquationToText_Button,i=(0,T.pm)().Designer_Question_EquationToText_Button_Tooltip):(n={className:o,onClick:this.sN(t)},e=(0,T.pm)().Designer_Question_Equation_Button,i=(0,T.pm)().Designer_Question_Equation_Button_Tooltip),(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:n,FluentIcon:r.IsMathOption?"Text Field":"Math Formula",IconClassName:"design-question-choice-to-math-button-icon",Text:e,Tooltip:i})},n.prototype.sN=function(t){var n=this;return function(e){var i=n.props.Master.Model.Choices;if(!(t>=i.length)){var r=i[t];r&&(n.eN=t,r.IsMathOption=!r.IsMathOption,n.forceUpdate(),(0,q.$U)(r.IsMathOption?"DesignPage.Quiz.SwitchTextToMathInput":"DesignPage.Quiz.SwitchMathToTextInput",{location:"Choice.Option",questionId:n.props.Master.Model.Id}))}}},n.prototype.HN=function(n,e,i){var r=this,o=this.props.Master,s=o.Model.IsMathQuiz?"design-question-textbox-with-switcher":"inline-display design-question-choice-option-textbox",a={AutoFocus:this.state.SelectedElementIndex===e,AutoSelection:!0,AllowRichText:!0,HTMLAttributes:(0,Tr.p2)(this.getElementFocusingProps(e),{className:s,onFocus:function(){var t=o.Model.Choices[e];o.Model.IsMathQuiz&&t.IsGenerated&&(t.Description="")},onKeyDown:this.gf(e)}),LeaveFirstLineOnlyWhenPaste:!0,MaxLength:(0,X.Mh)(),onValueChange:function(s){s=(0,ii.bC)(s),t.prototype.updateInlineRule.call(r,n,(0,ir.Mw)(s,!0)),o.bulkEdit((function(t){t.Choices[e].IsGenerated&&t.Choices[e].Description!==s&&(t.Choices[e].IsGenerated=null),(0,ir.v1)(t.Choices[e],s,"Description","FormsProDisplayRTText");var n=t.DefaultValue&&JSON.parse(t.DefaultValue);i&&n&&(n[e]=s),t.DefaultValue=JSON.stringify(n)}))},onRichEditorPaste:this.cN,Options:{HTMLPropsForInnerElement:{"aria-label":(0,T.pm)().DesignPage_ChoiceOptionInputBox_AriaLabel}},Placeholder:(0,T.pm)().Designer_Choices_Placeholder,Value:n,TextFieldLocation:{Location:(0,jo.bF)(this.props.Master.Model.Type),Suffix:4}};return(0,ur.ZN)(a)},n.prototype._N=function(t,n){var e=this.props.Master;e.bulkEdit((function(){var i=e.Model.Choices[t];i.Description=n,n&&(i.IsGenerated=null)}))},n.prototype.zN=function(t,n){if(this.props.Master.Model.IsQuiz&&null!==t.AnswerHint)return(0,ur.ZN)({AutoFocus:!0,AutoSelection:!0,HTMLAttributes:(0,Tr.p2)(this.getElementFocusingProps(n),{className:"design-question-choice-answer-hint"}),MaxLength:(0,X.Tl)(),MinimalHeight:(0,X.gj)(),onValueChange:function(n){return t.AnswerHint=n},Placeholder:(0,T.pm)().Designer_Choices_AnswerHint_Placeholder,TextFieldType:2,Value:t.AnswerHint})},n.prototype.GN=function(t,n){var e=this,i=n===this.state.SelectedElementIndex?"option-edit-button active-choice":"option-edit-button choice-option-edit-button";return(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:(0,Tr.p2)(this.getElementFocusingPropsScan(n),{className:i,onClick:function(){e.onUpdateDone((function(){var t=e.props.Master.Model;if(n===t.Choices.length){var i=t.AllowOtherAnswer?e.KS.current:e.WS.current;i&&i.focus()}else{var r=e.getElementRef(n).current;r&&(0,Co.x)($(r).find(".office-form-textfield-input"))}})),(0,et.pd)((function(){e.kN(t,n)}),et.t1)},"data-id":"Delete"}),FluentIcon:"Delete",IconClassName:"option-edit-button-img forms-icon-size16x16",Text:(0,T.pm)().Designer_QuestionMenu_Choice_Delete_Button_AriaLabel.format(t)})},n.prototype.qN=function(t){if(this.props.Master.Model.IsQuiz){var n=this.props.Master.Model.Choices,e=t===this.state.SelectedElementIndex?"option-edit-button active-choice":"option-edit-button";return(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:(0,Tr.p2)(this.getElementFocusingProps(t),{className:e,onClick:this.QN(t)}),FluentIcon:"Chat",IconClassName:"option-edit-button-img forms-icon-size16x16",Text:(0,T.pm)().Quiz_AnswerHint,ToggleActive:null!==n[t].AnswerHint})}},n.prototype.VN=function(t,n){var e=this;if(this.props.Master.Model.IsQuiz){var i=this.props.Master.Model.Choices,r=n===this.state.SelectedElementIndex||i[n].IsAnswerKey?"option-edit-button active-choice":"option-edit-button";return(0,z.F)({ButtonStyle:1,GlyphButtonStyle:i[n].IsAnswerKey?"Horizontal":"GlyphOnly",HTMLAttributes:(0,Tr.p2)(this.getElementFocusingProps(n),{className:r,onClick:function(){(0,q.$U)("DesignPage.Questions.ToggleCorrectChoice",{index:n,questionId:e.props.Master.Model.Id,questionType:e.props.Master.Model.Type,value:!i[n].IsAnswerKey}),e.props.Master.setAnswerKey(i[n],!i[n].IsAnswerKey)}}),FluentIcon:"Checkmark",IconClassName:"option-edit-button-img forms-icon-size18x18",Text:(0,T.pm)().Quiz_CorrectAnswer,TextClassName:"designer-quiz-option-correct",ToggleActive:!!i[n].IsAnswerKey})}},n.prototype.ON=function(){var t,n,e=this,i=this.props.Master,r=i.Model;if(i.showAsDropdown()?t="design-question-choice-label design-question-dropdown-label":(t="design-question-choice-label",n=g.createElement("input",{"aria-label":(0,T.pm)().DesignPage_OtherChoiceOptionRadioBox_AriaLabel,className:"design-question-choice-icon",disabled:!0,type:r.ChoiceType===D.T6.MultiChoice?"checkbox":"radio"})),r.AllowOtherAnswer){var o={HTMLAttributes:{className:"inline-display design-question-choice-option-textbox other-option",onFocus:function(){e.setState({SelectedElementIndex:v.Et})}},MaxLength:(0,X.Mh)(),onValueChange:function(){},Options:{HTMLPropsForInnerElement:{"aria-label":(0,T.pm)().DesignPage_OtherChoiceOptionInputBox_AriaLabel,className:"office-form-unselectable",readOnly:!0}},Placeholder:(0,T.pm)().Designer_OtherAnswer,Value:""},s=(0,ur.ZN)(o),a=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:this.state.SelectedElementIndex===v.Et?"option-edit-button active-choice":"option-edit-button choice-option-edit-button",onBlur:function(){e.setState({SelectedElementIndex:v.Et})},onClick:function(){e.onUpdateDone((function(){var t=e.WS.current;t&&t.focus()})),r.AllowOtherAnswer=!1}},FluentIcon:"Delete",IconClassName:"option-edit-button-img forms-icon-size16x16",ref:this.KS,Text:(0,T.pm)().Common_Delete_Text});return g.createElement("div",{className:"design-question-choice",key:"otherChoiceOption"},g.createElement("div",{className:t},n,s,a))}},n.prototype.AN=function(t){var n,e=this.props.Master.Model,i=e.Choices,r=null;e.IsMathQuiz?(n="",r=!0):n=(0,T.pm)().Designer_Choices_DefaultDescription.format(t+1),e.Choices=_.d.convertToArray(i).concat({Description:n,IsGenerated:!0,IsMathOption:r}),this.setState({SelectedElementIndex:t})},n.prototype.UN=function(t,n){FormsPro.getRuleValidator((0,k.f5)().Model.FormMaster).optionReferred(this.props.Master.Model.Id,t)?this.setState({ShowDeleteOptionDialog:!0}):this.kN(t,n)},n.prototype.kN=function(t,n){var e=this.props.Master,i=e.Model,r=i.Choices,o=i.DefaultValue&&JSON.parse(i.DefaultValue);if(o&&Object.keys(o).length>0){o.hasOwnProperty(n)&&delete o[n];for(var s=n+1;s<r.length;s++)if(o.hasOwnProperty(s)){var a=o[s];o[s-1]=a,delete o[s]}}e.bulkEdit((function(){_.d.getObjectMasterFromModel(r[n]).Deleted=!0,i.DefaultValue=JSON.stringify(o),rr.A.handleChoicesV1Deleted(n,i.Id,e.Form)}))},n.prototype.QN=function(t){var n=this;return function(){var e=n.props.Master.Model.Choices;t>=0&&t<e.length&&((0,q.$U)("DesignPage.Quiz.AnswerHint",{toggleOn:null===e[t].AnswerHint}),e[t].AnswerHint=null===e[t].AnswerHint?(0,T.pm)().Designer_Choices_AnswerHint_Placeholder:null)}},n.prototype.gf=function(t){var n=this;return function(e){var i=n.props.Master.Model.Choices,r=i.length;if(13===e.keyCode)if(t===r-1)n.AN(r);else{var o=b.findDOMNode(n),s=$(o).find(".design-question-choice")[t+1];if(i[t+1].IsMathOption){var a=$(s).find(".design-formula-mixer")[0];a&&a.focus()}else{var u=$(s).find(".design-question-choice-option-textbox .roosterjs-editor-box").not(".text-field-placeholder-box")[0];u&&u.focus()}}}},n.prototype.cN=function(t){var n=t.$copyText,e=t.$copyRichText;if(n&&n.replace(/\r/g,"").split("\n").map((function(t){return t.trim()})).filter((function(t){return!!t})).length>1){var i=this.props.Master,r=i.Model,o=_.d.convertToArray(i.getSnapshot().Choices),s=Math.max(this.state.SelectedElementIndex,0),a=o.length,u=(0,ir.gA)(e).split(/(.*?)<br>/g).filter((function(t){return(null==t?void 0:t.trim())&&"<br>"!==t})).map(Tr.bq);u.shift();var c=u.map((function(t){return{Description:(0,ir.Mw)(t,!0),FormsProDisplayRTText:t,IsGenerated:!1,IsMathOption:!1}}));o.splice.apply(o,(0,p.ev)([s+1,0],c,!1)),r.Choices=o,(0,q.$U)("DesignPage.Questions.PasteChoiceOptions",{LinesAfter:o.length,LinesBefore:a,SelectedElementIndex:this.state.SelectedElementIndex})}},n.prototype.uN=function(t){var n=t.clipboardData.getData("text");if(n){var e=n.replace(/\r/g,"").split("\n").map((function(t){return t.trim()})).filter((function(t){return!!t}));if(e.length>1){var i=this.props.Master,r=_.d.convertToArray(i.getSnapshot().Choices),o=Math.max(this.state.SelectedElementIndex,0),s=e.map((function(t){return{Description:t,IsGenerated:!1,IsMathOption:!1}})),a=r.length,u=t.target;s[0]=(0,p.pi)((0,p.pi)({},r[o]),{Description:u.value.substring(0,u.selectionStart)+s[0].Description}),s[s.length-1].Description+=u.value.substring(u.selectionEnd),r.splice.apply(r,(0,p.ev)([o,1],s,!1)),i.Model.Choices=r,(0,q.$U)("DesignPage.Questions.PasteChoiceOptions",{LinesAfter:r.length,LinesBefore:a,SelectedElementIndex:this.state.SelectedElementIndex}),t.preventDefault()}}t.stopPropagation()},n.prototype.EN=function(){var t=this;if((0,ht.x8)())return null;var n=(this.state.ChoiceCandidates||[]).filter((function(n){return!t.wN(n.text)})),e=null;if(!this.props.Master.Model.IsMathQuiz&&this.state.IntelligenceProvider===Qo.OptionSuggestionFromOption&&n&&n.length>0){var i=(0,T.pm)().DesignPage_OptionSuggestionItem_AriaLabel,r=(0,T.pm)().DesignPage_OptionSuggestionBar_AriaLabel,o=n.map((function(n,e){var r={ButtonStyle:1,HTMLAttributes:{"aria-label":i.format(e+1,n.text),className:(0,N.j)("design-question-choice-candidate office-form-theme-primary-foreground","office-form-theme-bgcolor-hover"),onClick:function(e){t.CN(n.text),t.$N()}},Text:n.text};return g.createElement(Fr.A,(0,p.pi)({key:e},r))}));e=g.createElement("div",{"aria-label":r.format(n.length),className:"design-question-candidate-bar"},o)}var s=(0,N.j)("design-question-candidate-bar-container",this.props.Master.showAsDropdown()?"choice-option-candidate-dropdown":"choice-option-candidate");return g.createElement("div",{"aria-live":"polite",className:s,key:"suggestionBarForOption"},e)},n.prototype.SN=function(){var t=this.state.ChoiceCandidates;this.nN&&this.nN===t||(this.nN=t,this.NN())},n.prototype.DN=function(t,n,e){var i={candidateLength:t?t.length:0,candidatePosition:y.findIndex(this.state.ChoiceCandidates,(function(n){return n.text===t})),candidateType:Qo[this.state.IntelligenceProvider],currentOptionCount:this.props.Master.Model.Choices.length,isCorrectAnswer:n,msftUser:(0,c.k0)().userInfo.TenantId===(0,ht.rq)(),templateId:e,questionId:this.props.Master.Model.Id};null!=this.state.TemplateIds&&(i.MatchedTemplateIds=this.state.TemplateIds),(0,q.$U)("Intelligence.ChoiceOptionSuggestion.Choose",{candidateType:Qo[this.state.IntelligenceProvider]})},n.prototype.MN=function(t){if(!this.YS||this.state.IntelligenceProvider===Qo.OptionSuggestionFromOption){var n={candidateLength:t?t.length:0,candidateType:Qo[this.state.IntelligenceProvider],isQuiz:this.props.Master.Model.IsQuiz,msftUser:(0,c.k0)().userInfo.TenantId===(0,ht.rq)(),optionSuggestionId:this.JS,questionId:this.props.Master.Model.Id};if(null!=this.state.MatchingPart&&(n.matchingPart=this.state.MatchingPart,n.firstChosen=t,n.firstChosenPosition=y.findIndex(this.state.ChoiceCandidates,(function(n){return n.text===t}))),(0,q.$U)("Intelligence.ChoiceOptionSuggestion.Choose",{candidateType:Qo[this.state.IntelligenceProvider]}),this.tN){var e={candidateLength:t?t.length:0,candidateType:Qo[this.state.IntelligenceProvider],isQuiz:this.props.Master.Model.IsQuiz};null!=this.tN.ExtraData&&(e.firstChosen=t,e.firstChosenPosition=y.findIndex(this.tN.Suggestion,(function(n){return n===t}))),Uo.logSuggestionKept("Choose",this.tN,JSON.stringify(e))}this.YS=!0}},n.prototype.NN=function(){var t={candidatesCount:this.state.ChoiceCandidates?this.state.ChoiceCandidates.length:0,candidateType:Qo[this.state.IntelligenceProvider],isQuiz:this.props.Master.Model.IsQuiz,msftUser:(0,c.k0)().userInfo.TenantId===(0,ht.rq)(),optionSuggestionId:this.JS,questionId:this.props.Master.Model.Id};null!=this.state.MatchingPart&&(t.matchingPart=this.state.MatchingPart),null!=this.state.TemplateIds&&(t.MatchedTemplateIds=this.state.TemplateIds),(0,q.$U)("Intelligence.ChoiceOptionSuggestion.Show",{candidateType:Qo[this.state.IntelligenceProvider]})},n.prototype.$N=function(){var t=this.props.Master.Model.Choices;if(t&&t.length>0){var n=t.length-1;this.setState({SelectedElementIndex:n});var e=this.getElementRef(n).current;e&&(0,Co.x)($(e))}},n}(Ko),Zo=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createReactNodes=function(){var t=(0,T.pm)(),n=(0,V.M)({FluentIcon:"Calendar LTR",HTMLAttributes:{className:"date-snapshot-event-icon forms-icon-size22x22"}}),e=(0,tr.Oy)()?t.Question_Date_Placeholder:t.QuestionType_DateTime_PlaceHolder.format((0,c.k0)().cultureInfo.DateTimeFormat.ShortDatePattern);return g.createElement("div",{className:"design-question-element"},g.createElement("div",{className:"design-question-date-snapshot"},n,g.createElement("input",{className:"form-control office-form-unselectable",disabled:!0,placeholder:e,"aria-label":(0,T.pm)().Designer_QuestionType_DateTime_AriaLabel})))},n}(Wo.v),Xo=e(72855);function Yo(t){return h.Pv.Resolve("ICustomerVoiceMetricUtilities").getMetricDeleteDialog(t)}var ts=function(t){function n(n){var e=t.call(this,n)||this;return e.vo=!0,e.jN=500,e.YS=!1,e.logLikertOptionsCandidatesAdopt=e.logLikertOptionsCandidatesAdopt.bind(e),e.logLikertOptionsCandidatesShown=e.logLikertOptionsCandidatesShown.bind(e),e.applyCandidate=e.applyCandidate.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.vo=!1},n.prototype.render=function(){var t=this;if(!this.props.ShouldShow)return null;var n=this.props.Master.Model.ChoiceGroup,e=y.filter(n,(function(t){return!t.IsGenerated&&!!t.Description})).length,i=(this.state.LikertOptionsCandidate||[]).filter((function(n){return!t.hasOption(n)}));return!i||i.length<=0||e>=xi()?null:this.createSuggestionBar()},n.prototype.hasOption=function(t){var n=this.props.Master.Model.ChoiceGroup;return y.some(n,(function(n){return!!n.Description&&n.Description.replace(/\s/g,"")===t.replace(/\s/g,"")}))},n.prototype.setLikertOptionsCandidates=function(t,n,e,i){this.vo&&(t&&n&&n.length>0?this.setState({DetectedLang:i,LikertOptionsCandidate:n,MatchingPart:e},this.logLikertOptionsCandidatesShown):this.resetLikertOptionsCandidates())},n.prototype.resetLikertOptionsCandidates=function(){this.vo&&this.setState({DetectedLang:void 0,LikertOptionsCandidate:[],MatchingPart:void 0})},n.prototype.logLikertOptionsCandidatesShown=function(){(0,q.$U)("Intelligence.LikertOptionSuggestion.Show",{IsQuiz:this.props.Master.Model.IsQuiz,IsTitleSuggestion:this.isSuggestionFromTitle()})},n.prototype.logLikertOptionsCandidatesAdopt=function(){this.YS&&this.isSuggestionFromTitle()||((0,q.$U)("Intelligence.LikertOptionSuggestion.Choose",{IsQuiz:this.props.Master.Model.IsQuiz,IsTitleSuggestion:this.isSuggestionFromTitle()}),this.YS=!0)},n.prototype.applyCandidate=function(t,n){this.logLikertOptionsCandidatesAdopt(),this.props.applyCandidateOption(t,n)},n.prototype.getTextAnalysisInterval=function(){return this.jN},n.prototype.resetTextAnalysisTimeout=function(t){window.clearTimeout(this.xN),this.xN=t},n}(J.r),ns=function(t){function n(n){var e=t.call(this,n)||this;return e.KN=e.KN.bind(e),e}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=this.props.candidateOption;return(0,z.F)({ButtonStyle:1,HTMLAttributes:{"aria-label":this.props.arialabel,className:this.props.className,onClick:this.KN},key:this.props.index,Text:t})},n.prototype.KN=function(){var t=this.props;t.applyCandidateOption(t.candidateOption,t.setFocus)},n}(J.r),es=function(t){function n(n){var e=t.call(this,n)||this;return e.oN=e.oN.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){t.prototype.componentWillUnmount.call(this),this.props.Master.unobserve(this.oN)},n.prototype.componentDidMount=function(){var t=this.props.Master;t.observe(this.oN,[t.Schema.ChoiceGroup[0].Description])},n.prototype.createSuggestionBar=function(){var t=this,n=(this.state.LikertOptionsCandidate||[]).filter((function(n){return!t.hasOption(n)})),e=(0,T.pm)().DesignPage_OptionSuggestionItem_AriaLabel,i=(0,T.pm)().DesignPage_OptionSuggestionBar_AriaLabel,r=(0,N.j)("design-question-choice-candidate office-form-theme-primary-foreground","office-form-theme-bgcolor-hover","likert-option-candidate"),o=n.map((function(n,i){var o=e.format(i+1,n);return g.createElement(ns,{arialabel:o,applyCandidateOption:t.applyCandidate,className:r,candidateOption:n,index:i,key:i,setFocus:!0})}));return g.createElement("div",{"aria-label":i.format(n.length),className:"design-question-candidate-bar likert-option-candidate"},o)},n.prototype.isSuggestionFromTitle=function(){return!1},n.prototype.oN=function(){var t=this;if(this.props.ShouldShow){var n=y.filter(this.props.Master.Model.ChoiceGroup,(function(t){return!t.IsGenerated}));if(0!==n.length){var e=window.setTimeout((function(){Uo.getOptionToOptionSuggestion(n.map((function(t){return t.Description})),"LikertOptionSuggestsOption").then((function(n){n?t.setLikertOptionsCandidates(n.MatchQuery,n.Result.ChoiceCandidates,n.Result.MatchingPart,n.Result.DetectedLanguage):t.resetLikertOptionsCandidates()})).catch(t.resetLikertOptionsCandidates)}),this.getTextAnalysisInterval());this.resetTextAnalysisTimeout(e)}else this.resetLikertOptionsCandidates()}},n}(ts),is=function(t){function n(n){var e=t.call(this,n)||this;return e.KN=e.KN.bind(e),e}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=this,n=this.props.candidateOptions;return(0,z.F)({ButtonStyle:1,HTMLAttributes:{className:this.props.className,onClick:function(){n.forEach((function(e,i){return t.KN(e,i===n.length-1)}))}},Text:(0,T.pm)().Designer_Intelligence_AddAll})},n.prototype.KN=function(t,n){this.props.applyCandidateOption(t,n)},n}(J.r),rs=function(t){function n(n){var e=t.call(this,n)||this;return e.JN=e.JN.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){t.prototype.componentWillUnmount.call(this),this.props.Master.unobserve(this.JN)},n.prototype.componentDidMount=function(){var t=this.props.Master;t.observe(this.JN,[t.Schema.Title]),this.JN()},n.prototype.createSuggestionBar=function(){var t=this,n=(this.state.LikertOptionsCandidate||[]).filter((function(n){return!t.hasOption(n)})),e=g.createElement(is,{applyCandidateOption:this.applyCandidate,candidateOptions:n,className:"design-question-choice-candidate office-form-theme-button"}),i=n.map((function(n,e){return g.createElement(ns,{applyCandidateOption:t.applyCandidate,className:"design-question-choice-candidate office-form-theme-primary-foreground office-form-theme-bgcolor-hover",candidateOption:n,index:e,key:e,setFocus:!0})}));return g.createElement("div",{className:"design-question-candidate-bar"},(0,T.pm)().Designer_Intelligence_Options,e,i)},n.prototype.isSuggestionFromTitle=function(){return!0},n.prototype.JN=function(){var t=this;if(this.props.ShouldShow){var n=this.props.Master.Model;if(!n.IsMathQuiz){var e=window.setTimeout((function(){Uo.getLikertQuestionSuggest(n.Title).then((function(n){n?t.setLikertOptionsCandidates(n.MatchQuery,n.Suggestion.ChoiceCandidates,n.Suggestion.MatchingPart,n.Suggestion.DetectedLanguage):t.resetLikertOptionsCandidates()})).catch(t.resetLikertOptionsCandidates)}),this.getTextAnalysisInterval());this.resetTextAnalysisTimeout(e)}}},n}(ts),os=function(t){function n(n){var e=t.call(this,n)||this;return e.XN=g.createRef(),e.state={IsFocused:!1},e.YN=e.YN.bind(e),e.mf=e.mf.bind(e),e.kN=e.kN.bind(e),e.gf=e.gf.bind(e),e}return(0,p.ZT)(n,t),n.prototype.render=function(){var t={AllowHeightAdjustment:!0,AllowRichText:!0,AutoSelection:!0,HTMLAttributes:{className:this.state.IsFocused?"design-question-matrix-editor office-form-theme-border":"design-question-matrix-editor",onFocus:this.YN,onKeyDown:this.gf},MinimalHeight:(0,X.gj)(),onValueChange:this.props.onValueChange,Options:{HTMLPropsForInnerElement:this.props.HTMLAttributes},Placeholder:this.props.Placeholder,TextFieldType:0,TextFieldLocation:{Location:this.props.IsColumn?8:9,Suffix:this.props.IsColumn?4:1},Value:this.props.Value},n=this.props.IsColumn?(0,ur.ZA)(t):(0,ur.ZN)(t);return g.createElement("div",{className:"design-question-matrix-cell-box",onBlur:this.mf,ref:this.XN},n,this.props.Deletable?this.iC():void 0)},n.prototype.focus=function(){var t=this.XN.current;if(t&&!t.contains(document.activeElement)){var n=t.querySelector(".office-form-textfield-input:not(.text-field-placeholder-box)");n&&n.focus()}},n.prototype.YN=function(){this.setState({IsFocused:!0})},n.prototype.mf=function(t){var n=this,e=(0,Ir.y3)(t);t.currentTarget.contains(e)||window.setTimeout((function(){e.className.indexOf("design-question-choice-candidate")>=0&&n.props.setCandidateApplyingTarget&&n.props.setCandidateApplyingTarget(),n.setState({IsFocused:!1})}),0)},n.prototype.kN=function(){var t=this.XN.current;t&&(0,kr.su)(t),this.props.delete()},n.prototype.gf=function(t){if(13===t.keyCode)if(t.preventDefault(),this.props.FocusOut){var n=this.XN.current;n&&(0,kr.su)(n)}else this.props.onKeyDown&&this.props.onKeyDown()},n.prototype.iC=function(){var t=(0,z.F)({GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"design-question-matrix-remove-icon",onClick:this.kN},FluentIcon:"Delete",IconClassName:"option-remove-button-img forms-icon-size16x16",Text:(0,T.pm)().Common_Delete_Text}),n=(0,N.j)("design-question-matrix-remove-container",this.state.IsFocused?"office-form-theme-primary-background active-choice":"");return g.createElement("div",{className:n,tabIndex:-1},t)},n}(J.r),ss=function(t){function n(n){var e=t.call(this,n)||this;return e.rC=e.rC.bind(e),e.oC=e.oC.bind(e),e.sC=e.sC.bind(e),e.aC=e.aC.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this;this.uC=function(){return t.forceUpdate()},this.props.Master.observe(this.uC,[fi.r.Schema.Description])},n.prototype.componentWillUnmount=function(){this.props.Master.unobserve(this.uC)},n.prototype.render=function(){var t=this.props.Master.Model,n=this.props.saveRef(this.props.Master.getInstanceId());return g.createElement("td",(0,p.pi)({},{className:"design-question-matrix-column-td"}),g.createElement(os,{onKeyDown:this.props.IsLast?this.props.addOption:void 0,Deletable:this.props.Count>1,delete:this.aC,HTMLAttributes:{"aria-label":(0,T.pm)().Designer_Choices_Placeholder},FocusOut:!this.props.IsLast,onValueChange:this.oC,Placeholder:(0,T.pm)().Designer_Choices_DefaultDescription.format(""),ref:n,Value:(0,ir.wg)(t.Description,t.FormsProDisplayRTText,!0),setCandidateApplyingTarget:this.sC,IsColumn:!0}))},n.prototype.aC=function(){var t=this;(0,et.pd)((function(){t.rC()}),et.t1)},n.prototype.rC=function(){var t=this.props.Master;t.Deleted=!0,(0,q.$U)("DesignPage.Questions.DeleteLikertOption",{questionId:t.Question.Model.Id})},n.prototype.oC=function(t){this.props.Master.bulkEdit((function(n){n.IsGenerated=!1,(0,ir.v1)(n,t,"Description","FormsProDisplayRTText")}))},n.prototype.sC=function(){this.props.setCandidateApplyingTarget(this.props.Master.Model)},n}(J.r),as=function(t){function n(n){var e=t.call(this,n)||this;return e.cC=e.cC.bind(e),e.oC=e.oC.bind(e),e.lC=e.lC.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this;this.fC=function(){return t.forceUpdate()},this.props.Master.observe(this.fC,[(0,k.zE)().Schema.Title])},n.prototype.componentWillUnmount=function(){this.props.Master.unobserve(this.fC)},n.prototype.render=function(){var t=this.props.Master.Model;return g.createElement("tr",{className:"design-question-matrix-str"},g.createElement("td",{className:"design-question-matrix-row-td",key:"subQuestion"},g.createElement(os,{onKeyDown:this.props.IsLast?this.props.addQuestion:void 0,Deletable:this.props.Count>1,delete:this.lC,HTMLAttributes:{"aria-label":(0,T.pm)().Designer_LabelForLikertRowTitle},FocusOut:!this.props.IsLast,onValueChange:this.oC,Placeholder:(0,T.pm)().Desinger_Likert_DefaultDescription.format(""),ref:this.props.saveRef(t.Id),Value:(0,ir.wg)(t.Title,t.FormsProRTQuestionTitle)})),this.props.children,g.createElement("td",{key:"emptyTd"}))},n.prototype.lC=function(){var t=this;(0,et.pd)((function(){t.cC()}),et.t1)},n.prototype.cC=function(){var t=this.props.Master,n=t.Model.Id,e=t.ParentQuestionMaster;e.deleteSubQuestion(n),(0,q.$U)("DesignPage.Questions.DeleteLikertSubquestion",{questionId:e.Model.Id})},n.prototype.oC=function(t){this.props.Master.bulkEdit((function(n){(0,ir.v1)(n,t,"Title","FormsProRTQuestionTitle")}))},n}(J.r),us=function(t){function n(n){var e=t.call(this,n)||this;return e.vo=!0,e.dC={},e.mC=[],e.vC=g.createRef(),e.pC=e.pC.bind(e),e.yC=e.yC.bind(e),e.wC=e.wC.bind(e),e.SC=e.SC.bind(e),e.NC=e.NC.bind(e),e.sC=e.sC.bind(e),e.CC=e.CC.bind(e),e.fN=e.fN.bind(e),e.dN=e.dN.bind(e),e.IC=e.IC.bind(e),e.TC=e.TC.bind(e),e.xC=e.xC.bind(e),e.FC=e.FC.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.vo=!1,_.d.getCollectionMasterFromModel(this.props.Master.Form.Model.Questions).unobserve(this.SC),t.prototype.componentWillUnmount.call(this)},n.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),_.d.getCollectionMasterFromModel(this.props.Master.Form.Model.Questions).observe(this.SC)},n.prototype.createReactNodes=function(){var t=this.props.Master,n=this.PC(),e=this.DC(),i=g.createElement("div",{className:"design-question-matrix-table",key:"matrixs"},g.createElement("table",{role:"group",className:"likert-question-table"},n,e)),r=(this.state.ShowDeleteOptionDialog&&this.TN(!1,this.dN,(0,T.pm)().MFPBranchingRules_Delete_Option_Popup_Desc),this.state.ShowDeleteLikertSubDialog&&this.TN(!0,this.xC,(0,T.pm)().MFPBranchingRules_Delete_Question_Popup_Desc),this.state.SMDeleteLikertSubInformation&&Yo({deleteInformation:this.state.SMDeleteLikertSubInformation,clickDeleteQuestion:this.xC,clickCancelButton:this.TC,clickDismissButton:this.TC}),t.SubQuestionMasters.length),o=(0,X.gn)()>r?this.MC():void 0;return(0,et.pd)((function(){return[i,o]}),et.t1)},n.prototype.TN=function(t,n,e){return!1},n.prototype.createSuggestionBar=function(){return g.createElement(rs,{applyCandidateOption:this.NC,Master:this.props.Master,ShouldShow:this.vo,ref:this.vC})},n.prototype.fN=function(){this.setState({ShowDeleteOptionDialog:!1})},n.prototype.dN=function(){this.setState({ShowDeleteOptionDialog:!1}),this.LC.Deleted=!0,(0,q.$U)("DesignPage.Questions.DeleteLikertOption",{questionId:this.LC.Question.Model.Id})},n.prototype.TC=function(){this.setState({ShowDeleteLikertSubDialog:!1,SMDeleteLikertSubInformation:void 0})},n.prototype.xC=function(){this.setState({ShowDeleteLikertSubDialog:!1,SMDeleteLikertSubInformation:void 0});var t=this.EC,n=t.Model.Id,e=t.ParentQuestionMaster;e.deleteSubQuestion(n),(0,q.$U)("DesignPage.Questions.DeleteLikertSubquestion",{questionId:e.Model.Id})},n.prototype.SC=function(t){var n=this.props.Master.Model.Id;if(t.AddedModels.concat(_.d.convertToArray(t.RemovedModels)).map(_.d.getObjectMasterFromModel).some((function(t){return t.Model.GroupId===n}))){var e=this.mC;this.mC=[],this.forceUpdate((function(){return e.forEach((function(t){return t()}))}))}},n.prototype.PC=function(){var t=this,n=this.props.Master.Model,e=n.ChoiceGroup,i=e.length,r=[g.createElement("td",{key:"matrixTd"})],o=y.map(e,(function(n,e){var r=_.d.getObjectMasterFromModel(n);return g.createElement(ss,{addOption:t.yC,Count:i,IsLast:e===i-1,key:r.getInstanceId(),Master:r,saveRef:t.pC,setCandidateApplyingTarget:t.sC,showDeleteOptionDialog:t.CC})}));r=r.concat(o);var s,a=(0,z.F)({GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{onClick:this.yC},FluentIcon:"Add",IconClassName:"forms-icon-size16x16",Text:(0,T.pm)().Designer_AddOneMore});e.length<xi()&&(s=g.createElement("td",{className:"design-question-add-option"},a));var u=g.createElement("tr",{className:"design-question-matrix-pr"},r,s),c=n.ChoiceGroup.length,l=c<xi()?c+2:c+1,f=this.vC.current,h=!!f&&f.state.LikertOptionsCandidate&&f.state.LikertOptionsCandidate.length>0,d=g.createElement("tr",null,g.createElement("td",{"aria-live":"polite",className:"design-question-candidate-bar-container likert-option-candidate",colSpan:l},g.createElement(es,{applyCandidateOption:this.NC,Master:this.props.Master,ShouldShow:!h})));return g.createElement("thead",{className:"design-question-matrix-pthead"},u,d)},n.prototype.yC=function(){var t=this,e=this.props.Master.Model,i=e.ChoiceGroup.length;if(i<xi()){(0,q.$U)("DesignPage.Questions.AddLikertOption",{index:i,questionId:e.Id}),this.onUpdateDone((function(){var n=_.d.getObjectMasterFromModel(e.ChoiceGroup[i]).getInstanceId(),r=t.dC[n].current;r&&r.focus()}));var r={Description:(0,T.pm)().Designer_Choices_DefaultDescription.format(i+1),IsGenerated:!0,Order:n.generateNonDuplicateID()};_.d.Collection.addItems(e.ChoiceGroup,[r])}},n.generateNonDuplicateID=function(){return Date.now()},n.prototype.DC=function(){var t=this,e=this.props.Master,i=e.Model,r=y.map(i.ChoiceGroup,(function(t,e){return n.createMatrixRadio(e,t.Description)})),o=e.SubQuestionMasters,s=o.length,a=y.map(o,(function(n,e){return g.createElement(as,{addQuestion:t.wC,Count:s,IsLast:e===s-1,key:n.Model.Id,Master:n,saveRef:t.pC,showSMDeleteQuestionDialog:t.FC,showDeleteQuestionDialog:t.IC},r)}));return g.createElement("tbody",{className:"design-question-matrix-stbody"},a)},n.prototype.IC=function(t){},n.prototype.FC=function(t,n){},n.prototype.MC=function(){var t=(0,z.F)({ButtonStyle:1,HTMLAttributes:{className:"design-question-button office-form-theme-button-color",onClick:this.wC},FluentIcon:"Add",IconClassName:"forms-icon-size18x18 office-form-theme-primary-foreground",Text:(0,T.pm)().Designer_AddOneMoreRow,TextClassName:"design-question-addonemore"});return g.createElement("div",{className:"design-question-addbutton-container",key:"addButton"},t)},n.prototype.wC=function(){var t=this,n=this.props.Master.SubQuestionMasters.length;if(n+1>=(0,X.gn)()&&(0,q.$U)("DesignPage.Questions.AddItemHitLimitation",{questionId:this.props.Master.Model.Id,questionType:this.props.Master.Model.Type}),n<(0,X.gn)()){(0,q.$U)("DesignPage.Questions.AddLikertSubquestion",{index:n,questionId:this.props.Master.Model.Id}),this.mC.push((function(){var e=t.dC[t.props.Master.SubQuestionMasters[n].Model.Id].current;e&&e.focus()}));var e={Title:(0,T.pm)().Desinger_Likert_DefaultDescription.format(n+1),Type:"Question.MatrixChoice"};this.props.Master.addSubQuestion(e)}},n.createMatrixRadio=function(t,n){return g.createElement("td",{className:"design-question-matrix-radio",key:t},g.createElement("input",{"aria-disabled":!0,"aria-label":n,className:"design-question-matrix-radio",disabled:!0,name:"subquestion-radio",type:"radio"}))},n.prototype.pC=function(t){return this.dC[t]||(this.dC[t]=g.createRef()),this.dC[t]},n.prototype.sC=function(t){this.OC=t},n.prototype.CC=function(t){},n.prototype.NC=function(t,e){var i,r=this,o=this.props.Master.Model,s=o.ChoiceGroup;if(this.OC)if(this.OC.IsGenerated||!this.OC.Description)i=this.OC;else if(o.ChoiceGroup.length===xi())i=y.find(s,(function(t){return t.IsGenerated}));else{var a=y.sortBy(o.ChoiceGroup,(function(t){return t.Order})).filter((function(t){return r.OC&&t.IsGenerated&&t.Order>r.OC.Order}));i=a.length>0?a[0]:null}else i=y.find(s,(function(t){return t.IsGenerated}));if(i)_.d.getObjectMasterFromModel(i).bulkEdit((function(n){n.Description=t,n.IsGenerated=null,n.IsMathOption=!1})),e&&this.BC(i);else if(e&&this.onUpdateDone((function(){r.BC(o.ChoiceGroup[s.length-1])})),s.length<xi()){var u={Description:t,IsGenerated:!1,Order:n.generateNonDuplicateID()};_.d.Collection.addItems(s,[u])}this.OC=null},n.prototype.BC=function(t){var n=_.d.getObjectMasterFromModel(t).getInstanceId(),e=this.dC[n].current;e&&e.focus()},n}(Wo.v),cs=e(71170),ls=function(t){function n(n){var e=t.call(this,n)||this,i=e.props.Master;return e.HC=function(t){return i.bulkEdit((function(n){(0,ir.v1)(n,t,"LeftDescription","FormsProRTLeftDescription")}))},e.GC=function(t){return i.bulkEdit((function(n){(0,ir.v1)(n,t,"RightDescription","FormsProRTRightDescription")}))},e}return(0,p.ZT)(n,t),n.prototype.createReactNodes=function(){return[g.createElement("div",{className:"design-question-element design-question-nps-container",key:"npsContainer"},g.createElement(cs.P,{Disabled:!0,Value:void 0}),this.xh()),this.createAnswerTagDiv(this.props.Master.Model.FormsProAnswerTag)]},n.prototype.createMoreMenuItems=function(){var n=this;return(0,et.pd)((function(){return t.prototype.createMoreMenuItems.call(n)}),et.t1)},n.prototype.xh=function(){var t=this.props.Master.Model,n=t.LeftDescription,e=t.RightDescription;n=(0,ir.wg)(t.LeftDescription,t.FormsProRTLeftDescription),e=(0,ir.wg)(t.RightDescription,t.FormsProRTRightDescription);var i=(0,ur.ZN)({AllowHeightAdjustment:!0,AllowRichText:!0,HTMLAttributes:{className:"rating-option-description-designer"},MinimalHeight:25,onValueChange:this.HC,Options:{HTMLPropsForInnerElement:{"aria-label":(0,T.pm)().Designer_NPSDescription_Label.format(0)}},Placeholder:(0,T.pm)().Designer_PlaceholderForRatingDescription,TextFieldType:0,TextFieldLocation:{Location:(0,jo.bF)(t.Type),Suffix:3},Value:n}),r=(0,ur.ZN)({AllowHeightAdjustment:!0,AllowRichText:!0,HTMLAttributes:{className:"rating-option-description-designer"},MinimalHeight:25,onValueChange:this.GC,Options:{HTMLPropsForInnerElement:{"aria-label":(0,T.pm)().Designer_NPSDescription_Label.format(10)}},Placeholder:(0,T.pm)().Designer_PlaceholderForRatingDescription,TextFieldType:0,TextFieldLocation:{Location:(0,jo.bF)(t.Type),Suffix:3},Value:e});return g.createElement("div",{className:"nps-label-container clearfix"},i,r)},n}(Wo.v),fs=function(t){function n(n){var e=t.call(this,n)||this;return e.lN=e.lN.bind(e),e.gf=e.gf.bind(e),e.setState({ChangeWithPaste:!1}),e}return(0,p.ZT)(n,t),n.prototype.createReactNodes=function(){return[this.qC(),this.VC(),this.zC()]},n.prototype.VC=function(){return g.createElement("div",{className:"design-sort-list",key:"itemsList"},g.createElement($o,{Disabled:!1,FallbackClass:"design-question-drag-fallback",GhostClass:"design-question-drag-ghost",Handler:"design-question-drag-handler",onExchange:this.lN},this.UC()))},n.prototype.lN=function(t,n){var e=this.props.Master,i=e.Model.ChoiceGroup;return!(t>=i.length||n>=i.length)&&(e.bulkEdit((function(e){var r=_.d.convertToArray(i).sort((function(t,n){return t.Order-n.Order}));if(t>n){for(var o=r[n].Order,s=n;s<t;++s)r[s].Order=r[s+1].Order;r[t].Order=o}else{for(o=r[n].Order,s=n;s>t;--s)r[s].Order=r[s-1].Order;r[t].Order=o}e.GradingBasis=JSON.stringify(r.sort((function(t,n){return t.Order-n.Order})).map((function(t){return t.Key})))})),!0)},n.prototype.UC=function(){var t=this,e=this.props.Master,i=e.Model,r=_.d.convertToArray(i.ChoiceGroup).sort((function(t,n){return t.Order-n.Order})),o=n.createDragHandleIcon();return y.map(r,(function(n,s){var a=(0,ir.wg)(n.Description,n.FormsProDisplayRTText,!0),u={AllowRichText:!0,AutoFocus:t.state.SelectedElementIndex===s,AutoSelection:!0,HTMLAttributes:{className:"design-sort-list-item",onFocus:function(){t.setState({SelectedElementIndex:s})},onKeyDown:t.gf(s)},MaxLength:(0,X.Mh)(),onValueChange:t.jC(s),Options:{HTMLPropsForInnerElement:{"aria-label":(0,T.pm)().DesignPage_RankingOptionInputBox_AriaLabel}},Placeholder:(0,T.pm)().Designer_Choices_Placeholder,ref:t.getElementRef(s),Value:a,TextFieldLocation:{Location:(0,jo.bF)(i.Type),Suffix:5}},c=t.state.SelectedElementIndex===s?"design-sort-item-button inline-block-display":"design-sort-item-button none-display",l=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:c,onClick:function(){(0,q.$U)("DesignPage.Questions.DeleteRankingOption",{questionId:i.Id,questionType:i.Type});var n=_.d.convertToArray(r).sort((function(t,n){return t.Order-n.Order})),o=n[s];if(_.d.getObjectMasterFromModel(o).isFieldReady(fi.r.Schema.Id)){n.splice(s,1);var a=JSON.parse(i.GradingBasis),u=a.indexOf(o.Key);-1!==u&&a.splice(u,1),e.bulkEdit((function(){i.GradingBasis=JSON.stringify(a),i.ChoiceGroup=n,t.setState({SelectedElementIndex:s})}))}}},FluentIcon:"Delete",IconClassName:"forms-icon-size16x16",Text:(0,T.pm)().Common_Delete_Text});return g.createElement("div",{className:"design-sort-item",key:n.Key},g.createElement("div",{className:"design-sort-item-parents"},o,(0,ur.ZA)(u)),l)}))},n.prototype.qC=function(){var t=this.props.Master.Model.IsQuiz,n=(0,T.pm)().Designer_Ranking_Tip;return t?g.createElement("div",{className:"design-sort-tip-container",key:"correctAnswerTip"},g.createElement(V.F,(0,p.pi)({},{FluentIcon:"Checkmark",HTMLAttributes:{className:"design-sort-list-tip forms-icon-size14x14"}})),g.createElement("span",null,n)):void 0},n.prototype.zC=function(){var t=this,n=this.props.Master.Model,e=_.d.convertToArray(n.ChoiceGroup).sort((function(t,n){return t.Order-n.Order}));if(!(e.length>=(0,X.NI)())){var i={className:"design-question-button office-form-theme-button-color",onClick:function(){(0,q.$U)("DesignPage.Questions.AddRankingOption",{index:e.length,questionId:n.Id,questionType:n.Type}),t.AN()}},r=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"Horizontal",HTMLAttributes:i,FluentIcon:"Add",IconClassName:"forms-icon-size18x18 office-form-theme-primary-foreground",Text:(0,T.pm)().Designer_AddOneMore,TextClassName:"design-question-addonemore"});return g.createElement("div",{className:"design-question-addbutton-container",key:"addOptionButton"},r)}},n.prototype.AN=function(){var t=this,e=this.props.Master,i=e.Model,r=i.ChoiceGroup,o=_.d.convertToArray(r).sort((function(t,n){return t.Order-n.Order})),s=r.length,a=(0,T.pm)().Designer_Choices_DefaultDescription.format(s+1),u=(0,O.GW)(),c={Description:a,Key:u,Order:n.generateNonDuplicateOrder()};o.push(c),o.length>=(0,X.NI)()&&(0,q.$U)("DesignPage.Questions.AddItemHitLimitation",{questionId:i.Id,questionType:i.Type});var l=JSON.parse(i.GradingBasis);l.push(u),e.bulkEdit((function(){i.GradingBasis=JSON.stringify(l),i.ChoiceGroup=o,t.setState({SelectedElementIndex:i.ChoiceGroup.length-1})}))},n.prototype.jC=function(t){var n=this;return this.state.ChangeWithPaste?function(){n.setState({ChangeWithPaste:!1})}:function(e){n.props.Master.bulkEdit((function(n){var i=_.d.convertToArray(n.ChoiceGroup).sort((function(t,n){return t.Order-n.Order}))[t];i&&i.Description!==e&&(0,ir.v1)(i,e,"Description","FormsProDisplayRTText")}))}},n.prototype.gf=function(t){var n=this;return function(e){var i=n.props.Master.Model.ChoiceGroup.length;if(13===e.keyCode)if(t===i-1&&t<(0,X.NI)()-1)n.AN();else{var r=n.getElementRef(t+1).current;r&&r.focus()}}},n.generateNonDuplicateOrder=function(){return Date.now()},n.createDragHandleIcon=function(){return g.createElement("span",{className:"design-question-drag-handler",key:"dragIcon"},g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},g.createElement("circle",{cx:"9.5",cy:"6.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"14.5",cy:"6.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"9.5",cy:"12.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"14.5",cy:"12.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"9.5",cy:"18.5",r:"1.5",fill:"currentColor"}),g.createElement("circle",{cx:"14.5",cy:"18.5",r:"1.5",fill:"currentColor"})))},n}(Wo.v);var hs=e(11807),ds=function(t){function n(n){var e=t.call(this,n)||this;return e.WC=g.createRef(),e.KC=e.KC.bind(e),e.JC=e.JC.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this)},n.prototype.componentDidUpdate=function(){t.prototype.componentDidUpdate.call(this)},n.prototype.createMoreMenuItems=function(){var n={Checked:this.props.Master.Model.ShowRatingLabel,Description:(0,T.pm)().Designer_MenuItemForRatingLabel,Key:"labelItem",MenuItemType:1,onExecute:this.KC};return t.prototype.createMoreMenuItems.call(this).concat(this.createValidationItem(),n,this.createAnswerTagMenuItem())},n.prototype.createReactNodes=function(){var t,n=this.props.Master.Model,e=y.range(2,11),i=(0,sr._)({HTMLAttributes:{className:"question-setting-label"},Label:(0,T.pm)().Designer_DescriptionForRatingRange}),r=e.map((function(t){return{DisplayName:t.toString(),Key:t,Value:t}})),o=(0,ar.E)({Label:(0,T.pm)().Designer_DescriptionForRatingRange,onValueChange:function(t){n.Length=t,(0,q.$U)("DesignPage.Questions.RatingLevelModified",{operation:"ModifyRatingLevel",questionType:n.Type})},SelectOptions:r,Value:n.Length,disableSelectOnArrowKeys:!0});t=g.createElement("div",{className:"question-setting-dropdown",style:{width:"110px"}},o);var s,a=g.createElement("div",{className:"rating-question-dropdown-container",key:"range"},i,t),u=(0,sr._)({HTMLAttributes:{className:"question-setting-label"},Label:(0,T.pm)().Designer_DescriptionForRatingShape}),c=[{DisplayName:(0,T.pm)().Common_Number_Text,Key:D.le.Number,Value:D.le.Number},{DisplayName:(0,T.pm)().Designer_DescriptionForRatingShapeStar,Key:D.le.Star,Value:D.le.Star}],l=(0,ar.E)({Label:(0,T.pm)().Designer_DescriptionForRatingShape,onValueChange:function(t){n.RatingShape=t},SelectOptions:c,Value:n.RatingShape,disableSelectOnArrowKeys:!0});s=g.createElement("div",{className:"question-setting-dropdown",style:{width:"110px"}},l);var f,h=g.createElement("div",{className:"rating-question-dropdown-container",key:"shape"},u,s),d=(0,et.pd)((function(){return g.createElement("div",{className:"question-setting-container",key:"setting"},a,h)}),et.t1),m=n.MinRating;m||(m=1),n.ShowRatingLabel&&(f=g.createElement("div",{className:"rating-description-container",key:"description"},this.ZC(!0,this.WC),this.ZC(!1)));var v,p,b,w=this.createAnswerTagDiv(n.FormsProAnswerTag);if(n.RatingShape===D.le.Number){var S=y.range(m,n.Length+1),N=S.map((function(t,n){return g.createElement("td",{className:"office-form-question-rating-title-td",key:n},t)})),C=g.createElement("tr",{className:"office-form-question-rating-tr"},N),I=y.uniqueId("rating."),k=S.map((function(t,n){return g.createElement("td",{className:"office-form-question-rating-td",key:n},g.createElement("input",{"aria-label":t.toString(),disabled:!0,name:I,type:"radio"}))})),x=g.createElement("tr",{className:"office-form-question-rating-tr"},k);return[g.createElement("table",{className:"design-question-element",key:"iconTable"},C,x),d,f,w]}return n.RatingShape===D.le.Smiley?(v=n.Length,p=FormsPro.getSentimentArray(v),b=[],p.forEach((function(t){b.push(function(t,n){var e=null!=n?n:(0,T.pm)();switch(t){case"Dissatisfied":return e.SmileyControl_Dissatisfied;case"Label_Disabled_Title":return e.SmileyControl_Label_Disabled_Title;case"Neutral":return e.SmileyControl_Neutral;case"Satisfied":return e.SmileyControl_Satisfied;case"VeryDissatisfied":return e.SmileyControl_VeryDissatisfied;case"VerySatisfied":return e.SmileyControl_VerySatisfied;default:return""}}(t))})),n.FormsProSmileyList=JSON.stringify(b),[FormsPro.createSmileyRating({ContainerClass:"design-question-element",Disabled:!0,EditMode:!0,Model:this.props.Master.Model}),d,null,w]):[(0,hs.w)({Disabled:!0,HTMLAttributes:{className:"design-question-element"},key:"ratingelement",Length:this.props.Master.Model.Length,NoTabFocus:!0,onValueChange:function(){},ShowRatingLabel:!1,Value:0}),d,f,w]},n.prototype.ZC=function(t,n){var e,i,r=this.props.Master,o=r.Model.MinRating||1;r.Model.RatingShape===D.le.Number?(e="office-form-rating-description-label-number",i=t?o.toString():r.Model.Length.toString()):(e="office-form-rating-description-label-star",i=t?(0,T.pm)().RatingDescriptionTitle.format(o):(0,T.pm)().RatingDescriptionTitlePlural.format(r.Model.Length));var s=(0,ur.ZN)({AllowHeightAdjustment:!0,AllowRichText:!0,HTMLAttributes:{className:"rating-option-description-designer"},MinimalHeight:25,onValueChange:function(n){r.bulkEdit((function(e){(0,ir.v1)(e,n,t?"LeftDescription":"RightDescription",t?"FormsProRTLeftDescription":"FormsProRTRightDescription")}))},Options:{HTMLPropsForInnerElement:{"aria-label":(0,T.pm)().Designer_RatingDescription_Label.format(i)}},Placeholder:(0,T.pm)().Designer_PlaceholderForRatingDescription,ref:n,TextFieldType:(0,et.pd)((function(){return 0}),et.t1),TextFieldLocation:{Location:(0,jo.bF)(this.props.Master.Model.Type),Suffix:3},Value:this.XC(t),AutoFocus:t});return g.createElement("div",{className:"rating-description-div"},g.createElement("div",{className:e},i),s)},n.prototype.XC=function(t){var n=this.props.Master.Model;return t?(0,ir.wg)(n.LeftDescription,n.FormsProRTLeftDescription):(0,ir.wg)(n.RightDescription,n.FormsProRTRightDescription)},n.prototype.JC=function(){var t=this;(0,et.hl)((function(){t.WC.current&&t.WC.current.focus()}))},n.prototype.KC=function(){var t=this.props.Master.Model;(0,q.$U)("DesignPage.QuestionMenu.RatingLabel",{questionType:t.Type,value:t.ShowRatingLabel}),t.ShowRatingLabel=!t.ShowRatingLabel,t.ShowRatingLabel&&window.setTimeout(this.JC,0)},n}(Wo.v),ms=e(18260);var vs=function(t){function n(n){var e=t.call(this,n,"TextField.Subtitle")||this;return e.YC=g.createRef(),e.tI=g.createRef(),e.nI=e.nI.bind(e),e.eI=e.eI.bind(e),e.rI=e.rI.bind(e),e.oI=e.oI.bind(e),e.sI=e.sI.bind(e),e.state=(0,p.pi)((0,p.pi)({},e.state),{IsLastPossibleAnswerEditable:!1,ShouldShowNewPossibleAnswerInputField:!1,ShowConfirmDialog:!1,TemporaryNewPossibleAnswerNotSavedInBackEnd:""}),e.aI=!1,e.uI(),e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){t.prototype.componentWillMount.call(this)},n.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this.aI=this.props.Master.Model.IsNumber},n.prototype.componentWillUnmount=function(){t.prototype.componentWillUnmount.call(this)},n.prototype.componentDidUpdate=function(){var t;!1===this.props.Master.Model.IsNumber&&this.aI&&(this.aI=!1),!0!==this.props.Master.Model.IsNumber||this.aI||(null===(t=this.tI.current)||void 0===t||t.focus(),this.aI=!0)},n.prototype.createReactNodes=function(){var t=this,n=this.props.Master,e=n.Model,i=e.Multiline?(0,T.pm)().Designer_Question_Text_Answer_Long:(0,T.pm)().Designer_Question_Text_Answer_Short,r=(0,tr.Oy)()?(0,T.pm)().Question_TextFiled_Placeholder:(0,T.pm)().TextField_DefaultPlaceholder;if(e.IsNumber)r=n.getNumberValidationErrorMessage();else if(e.IsMathQuiz){var o=new it.E(e).getAnswers();o&&o.length>0&&o[0].isMath&&!o.some((function(t){return t.isMath!==o[0].isMath}))&&(r=(0,T.pm)().TextField_EnterMathAnswer)}var s,a={"aria-label":i,className:"form-control office-form-unselectable",disabled:!0,placeholder:r,readOnly:!0,type:"text"};s=e.Multiline?g.createElement("textarea",(0,p.pi)({},a)):g.createElement("input",(0,p.pi)({},a));var u,c=g.createElement("div",{className:"design-question-element",key:"icon"},g.createElement("div",{className:"design-question-text-snapshot"},s)),l=e.IsQuiz&&!e.Multiline?this.cI():void 0;(0,et.pd)((function(){e.IsNumber&&(u=t.lI())}),et.t1);var f=this.createAnswerTagDiv(e.FormsProAnswerTag);return[c,l,u,f]},n.prototype.createValidationItem=function(){var t=this.props.Master.Model;return{Checked:t.IsNumber,Description:(0,T.pm)().NumberValidation_Rule_Description_Label,Key:"validationItem",MenuItemType:1,onExecute:function(){return(0,q.$U)("DesignPage.QuestionMenu.Validation",{questionType:t.Type,value:t.IsNumber}),t.IsNumber=!t.IsNumber,t.NumberValidationRule=t.NumberValidationRule||D.pW.None,t.IsNumber}}},n.prototype.createMoreMenuItems=function(){return t.prototype.createMoreMenuItems.call(this).concat(this.createValidationItem(),this.createMathItem(),this.createAnswerTagMenuItem())},n.prototype.createPhishingWarningBar=function(){return function(t){switch(t.Master.Model.SuspiciousEvidence){case 1:return(0,ms.vV)({Info:(0,T.pm)().Phishing_Question_Level_Message_Suspicous,InlineHrefInfo:(0,T.pm)().Notify_Your_Admin_For_Approval_Link,onClickInlineHref:function(){(0,mi.lK)(t.Master.Form).notifyAdminForApproval(t.Master.Form.Model.Id).then((function(){t.Master.Model.SuspiciousEvidence=3,t.Master.Form.Model.NotifiedAdminForApproval=!0}))},TipBarIconClassName:"ms-Icon ms-Icon--Error forms-icon-size20x20",TipBarLocation:"Question",TipBarStyle:"RedBackground"});case 2:return(0,ms.vV)({Info:(0,T.pm)().Phishing_Question_Level_Message_Good,TipBarIconClassName:"ms-Icon ms-Icon--Completed forms-icon-size20x20",TipBarLocation:"Question",TipBarStyle:"GreenBackground"});case 3:return(0,ms.vV)({Info:(0,T.pm)().Phishing_Question_Level_Message_Admin_Notified,TipBarIconClassName:"ms-Icon ms-Icon--Recent forms-icon-size20x20",TipBarLocation:"Question",TipBarStyle:"RedBackground"});default:return null}}({Master:this.props.Master})},n.prototype.cI=function(){var t=this.props.Master.Model,n=new it.E(t).getAnswers(),e=this.fI(n),i=this.hI(n,t),r=this.mI();return g.createElement("div",{className:"design-question-element",key:"correctAnswer"},g.createElement("div",null,(0,T.pm)().Designer_ShortText_PossibleAnswers_Label),e,i,r)},n.prototype.fI=function(t){var n=[];if(t&&t.length>0)for(var e=this.state.IsLastPossibleAnswerEditable?t.length-2:t.length-1,i=0;i<=e;i++){var r=this.vI(t[i]);n.push(r)}return n},n.prototype.hI=function(t,n){var e,i=this,r=!1,o=function(t){},s=new it.E(n);if(this.state.IsLastPossibleAnswerEditable){var a=t[t.length-1];e=a.answer,o=function(t){""===t?(s.deleteAnswer(a.id),n.GradingBasis=s.serialize(),i.gI(),i.pI(),i.setState({IsLastPossibleAnswerEditable:!1,ShouldShowNewPossibleAnswerInputField:!0})):(!s.updateAnswer(a.id,t,!n.IsAnswerPlainText)&&(s.deleteAnswer(a.id),i.pI(),i.setState({IsLastPossibleAnswerEditable:!1,ShouldShowNewPossibleAnswerInputField:!0,TemporaryNewPossibleAnswerNotSavedInBackEnd:t})),n.GradingBasis=s.serialize(),i.gI());s.areAnyAnswersDefined()||i.bI()}}else this.state.ShouldShowNewPossibleAnswerInputField&&(e=this.state.TemporaryNewPossibleAnswerNotSavedInBackEnd,r=!0,o=function(t){if(""!==t){var e=s.areAnyAnswersDefined();if(!s.addAnswer(t,!n.IsAnswerPlainText))return void i.setState({TemporaryNewPossibleAnswerNotSavedInBackEnd:t});e||i.wI(),i.SI(),n.GradingBasis=s.serialize(),i.gI(),i.setState({IsLastPossibleAnswerEditable:!0,ShouldShowNewPossibleAnswerInputField:!1,TemporaryNewPossibleAnswerNotSavedInBackEnd:""})}else i.setState({TemporaryNewPossibleAnswerNotSavedInBackEnd:""})});if(this.state.IsLastPossibleAnswerEditable||this.state.ShouldShowNewPossibleAnswerInputField){var u=s.areAnyAnswersDefined()?(0,T.pm)().Designer_ShortText_NextNewPossibleAnswer_Placeholder:(0,T.pm)().Designer_ShortText_FirstNewPossibleAnswer_Placeholder;if(n.IsMathQuiz){if(n.IsAnswerPlainText){var c=(0,ur.ZA)({AutoFocus:!0,HTMLAttributes:{className:"office-form-textfield-input",id:"newCorrectMathAnswerInputBox"},onValueChange:o,Options:{HTMLPropsForInnerElement:{className:"design-question-short-correct-answer-input",onBlur:this.oI,onKeyDown:this.sI}},Placeholder:u,Value:e});return g.createElement("div",{className:"design-question-short-correct-math-answer-container",ref:this.YC},c,this.II())}var l={className:"office-form-textfield-input",id:"newCorrectMathAnswerFormulaDesigner",onKeyDown:this.sI};return g.createElement("div",{className:"design-question-short-correct-math-answer-container"},g.createElement(er.qS,{blockEndDesignMode:this.blockEndDesignMode,Disabled:!1,ForceDesignMode:!0,HasFocus:!0,HTMLAttributes:l,key:"textmathquestion",Location:"TextField.Answer",onBoxBlur:this.oI,onRenderComplete:this.mathCalculation,onValueChange:o,Placeholder:u,QuestionId:n.Id,containerRef:this.YC,Value:e},this.II()))}return(0,ur.ZA)({AutoFocus:r,HTMLAttributes:{className:"office-form-textfield-input design-question-short-correct-answer-container",id:"newCorrectAnswerInputBox",onBlur:this.oI,onKeyDown:this.sI},onValueChange:o,Options:{HTMLPropsForInnerElement:{className:"design-question-short-correct-answer-input"}},Placeholder:u,Value:e})}},n.prototype.mI=function(){var t=this;if(!this.state.IsLastPossibleAnswerEditable&&!this.state.ShouldShowNewPossibleAnswerInputField){var n={className:"design-question-button design-question-short-add-answer-button office-form-theme-button-color",onClick:function(){t.TI()},ref:"addAnswerButton"};return(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"Horizontal",HTMLAttributes:n,Icon:"Add",IconClassName:"forms-icon-size18x18 office-form-theme-primary-foreground",Text:(0,T.pm)().Designer_ShortText_AddNewPossibleAnswerButton_Label,TextClassName:"design-question-addonemore"})}},n.prototype.vI=function(t){var n=this,e=this.props.Master.Model,i="correctAnswer"+t.id,r=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"design-question-short-correct-answer-delete-button",onClick:function(){return n.xI(e,t.id)}},FluentIcon:"Delete",IconClassName:"forms-icon-size16x16",Text:(0,T.pm)().Designer_ShortText_DeleteCorrectAnswerButton_AccessibilityFormat.format(t.answer)}),o=(0,V.M)({FluentIcon:"Checkmark",HTMLAttributes:{className:"office-form-right-answerkey forms-icon-size16x16",role:"presentation"}}),s=this.state.ActivatedPossibleAnswerId===t.id?r:o,a=this.state.IsLastPossibleAnswerEditable||this.state.ShouldShowNewPossibleAnswerInputField?"":" design-question-short-correct-answer-box-margin",u=(0,T.pm)().Designer_ShortText_CorrectAnswer_AccessibilityFormat.format(t.answer),c=t.isMath?(0,er.Rq)({Formula:t.answer}):t.answer;return g.createElement("div",{"aria-labelledby":i,className:"design-question-short-correct-answer-box"+a,key:i,onFocus:this.eI(t.id),onMouseEnter:this.eI(t.id),onMouseLeave:this.rI,tabIndex:0},g.createElement("a",{className:"screenReaderVisible",id:i},u),g.createElement("span",{"aria-hidden":"true",role:"presentation"},c),s)},n.prototype.II=function(){var t,n,e,i=this.props.Master.Model,r="design-question-choice-to-math-button",o="textFieldAnswerMathSwitcher";return this.props.IsMobile&&(r=(0,N.j)(r,"isMobile")),v.Wr===this.state.SelectedElementIndex&&(r=(0,N.j)(r,"active-choice")),i.IsAnswerPlainText?(t={className:r,id:o,onClick:this.nI},n=(0,T.pm)().Designer_Question_Equation_Button,e=(0,T.pm)().Designer_Question_Equation_Button_Tooltip):(t={className:r,id:o,onClick:this.nI},n=(0,T.pm)().Designer_Question_EquationToText_Button,e=(0,T.pm)().Designer_Question_EquationToText_Button_Tooltip),(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:(0,Tr.p2)(this.getElementFocusingProps(v.Wr),t),FluentIcon:i.IsAnswerPlainText?"Math Formula":"Text Field",IconClassName:"forms-icon-size24x24",Text:n,Tooltip:e})},n.prototype.nI=function(){var t=this.props.Master.Model;t.IsAnswerPlainText=!t.IsAnswerPlainText,(0,q.$U)(t.IsAnswerPlainText?"DesignPage.Quiz.SwitchMathToTextInput":"DesignPage.Quiz.SwitchTextToMathInput",{location:"TextField.Answer",questionId:t.Id}),this.forceUpdate()},n.prototype.gI=function(){this.props.Master.Model.IsMathQuiz&&this.uI()},n.prototype.uI=function(){var t=this.props.Master.Model;if(!t.IsMathQuiz)return t.IsAnswerPlainText=!0,t.IsMathInputDefault=!1,void(t.InputSwitcherDisabled=!0);var n=new it.E(t).getAnswers();n&&n.length>0?(n[n.length-1].isMath?t.IsAnswerPlainText=!1:t.IsAnswerPlainText=!0,t.IsMathInputDefault=n.some((function(t){return t.isMath})),t.InputSwitcherDisabled=!n.some((function(t){return t.isMath!==n[0].isMath}))):(t.IsAnswerPlainText=!1,t.IsMathInputDefault=!0,t.InputSwitcherDisabled=!1)},n.prototype.eI=function(t){var n=this;return function(){n.setState({ActivatedPossibleAnswerId:t})}},n.prototype.rI=function(){this.setState({ActivatedPossibleAnswerId:void 0})},n.prototype.oI=function(t){if(t){var n=(0,Ir.y3)(t),e=this.YC.current;if(n&&e&&e===n.parentElement)return}if(this.state.IsLastPossibleAnswerEditable){var i=this.props.Master.Model,r=new it.E(i),o=r.getAnswers();if(o&&o.length>0){var s=o[o.length-1],a=s.answer.trim();if(a!==s.answer||!i.IsAnswerPlainText!==s.isMath)!r.updateAnswer(s.id,a,!i.IsAnswerPlainText)&&r.deleteAnswer(s.id),i.GradingBasis=r.serialize(),this.gI()}}this.setState({IsLastPossibleAnswerEditable:!1,ShouldShowNewPossibleAnswerInputField:!1,TemporaryNewPossibleAnswerNotSavedInBackEnd:""})},n.prototype.sI=function(t){13===t.keyCode&&(this.oI(),this.TI())},n.prototype.TI=function(){this.setState({ShouldShowNewPossibleAnswerInputField:!0})},n.prototype.xI=function(t,n){var e=new it.E(t);e.deleteAnswer(n),t.GradingBasis=e.serialize(),this.gI(),e.areAnyAnswersDefined()||this.bI(),this.pI()},n.prototype.SI=function(){(0,q.$U)("DesignPage.Questions.ShortTextAnswerAdded",{isMathAnswer:!this.props.Master.Model.IsAnswerPlainText,isMathQuestion:this.props.Master.Model.IsMathQuiz,questionId:this.props.Master.Model.Id})},n.prototype.pI=function(){(0,q.$U)("DesignPage.Questions.ShortTextAnswerDeleted",{isMathAnswer:!this.props.Master.Model.IsAnswerPlainText,isMathQuestion:this.props.Master.Model.IsMathQuiz,questionId:this.props.Master.Model.Id})},n.prototype.wI=function(){(0,q.$U)("DesignPage.Questions.FirstShortTextAnswerAdded",{isMathAnswer:!this.props.Master.Model.IsAnswerPlainText,isMathQuestion:this.props.Master.Model.IsMathQuiz,questionId:this.props.Master.Model.Id})},n.prototype.bI=function(){(0,q.$U)("DesignPage.Questions.LastRemainingShortTextAnswerDeleted",{isMathAnswer:!this.props.Master.Model.IsAnswerPlainText,isMathQuestion:this.props.Master.Model.IsMathQuiz,questionId:this.props.Master.Model.Id})},n.prototype.FI=function(){var t,e,i,r,o,s,a,u,c=this,l=this.props.Master,f=l.Model;if(f.IsNumber||f.HasTFRestrictionForPro){t=(0,sr._)({HTMLAttributes:{className:"question-setting-label"},Label:(0,T.pm)().NumberValidation_Rule_Description_Label});var h=(0,ar.E)({onValueChange:function(t){var n;f.NumberValidationRule=t,(null===(n=c.props.Master)||void 0===n?void 0:n.Form.SettingMaster.Model.PauseAndResumeSurvey)&&(c.props.Master.Form.Model.SurveyLastModifiedAt=(new Date).toUTCString())},SelectOptions:n.getNumberValidationRuleDisplayNames(),Value:f.NumberValidationRule,Label:(0,T.pm)().Designer_Question_Text_Restriction_Condition_AriaLabel}),d=!1,m=!0,v=!0,p=f.NumberValidationRule;f.FormsProValidationType===D.PA.Email?(m=!1,v=!1):f.FormsProValidationType===D.PA.Custom?(d=!0,m=!1,v=!1):f.IsNumber&&(e=g.createElement("div",{className:"question-setting-dropdown",style:{width:"200px"}},h));var b=(0,ar.E)({onValueChange:function(t){return function(t){var n;(0,q.JG)({eventInfo:{validationType:f.FormsProValidationType},type:"DesignPage.QuestionMenu.ValidationType"}),f.FormsProValidationType=t,(null===(n=c.props.Master)||void 0===n?void 0:n.Form.SettingMaster.Model.PauseAndResumeSurvey)&&(c.props.Master.Form.Model.SurveyLastModifiedAt=(new Date).toUTCString())}(t)},SelectOptions:n.getRestTypeDisplayNames(),Value:f.FormsProValidationType,Label:(0,T.pm)().Designer_Question_Text_Restriction_Type_AriaLabel});if(i=g.createElement("div",{className:"question-setting-dropdown",style:{width:"185px"}},b),d&&(r=(0,ur.ZA)({AutoFocus:!0,AutoSelection:!0,HTMLAttributes:{className:"number-validation-boundary-div customregex-validation-boundary-width",onBlur:function(){return c.DI()}},onValueChange:function(t){var n;f.FormsProCustomRegEx=t,(null===(n=c.props.Master)||void 0===n?void 0:n.Form.SettingMaster.Model.PauseAndResumeSurvey)&&(c.props.Master.Form.Model.SurveyLastModifiedAt=(new Date).toUTCString())},Options:{HTMLPropsForInnerElement:{className:"number-validation-content"}},Placeholder:(0,T.pm)().CustomRegExPlaceholder,Value:f.FormsProCustomRegEx})),f.FormsProValidationType!==D.PA.Number||p!==D.pW.Between&&p!==D.pW.NotBetween)switch(p){case D.pW.None:m=!1,v=!1;break;case D.pW.Less:case D.pW.LessOrEqual:m=!1;break;default:v=!1}else a=(0,sr._)({HTMLAttributes:{className:"number-validation-between-label"},Label:(0,T.pm)().NumberValidation_Between_Label});m&&(o=(0,ur.ZA)({AutoSelection:!0,HTMLAttributes:{className:"number-validation-boundary-div number-validation-boundary-width",onBlur:function(){return l.justifyNumberBoundaries()}},onValueChange:function(t){var n;f.NumberMinBoundary=t,(null===(n=c.props.Master)||void 0===n?void 0:n.Form.SettingMaster.Model.PauseAndResumeSurvey)&&(c.props.Master.Form.Model.SurveyLastModifiedAt=(new Date).toUTCString())},Options:{HTMLPropsForInnerElement:{className:"number-validation-content"}},Value:f.NumberMinBoundary})),v&&(s=(0,ur.ZA)({AutoSelection:!0,HTMLAttributes:{className:"number-validation-boundary-div number-validation-boundary-width",onBlur:function(){return l.justifyNumberBoundaries()}},onValueChange:function(t){var n;f.NumberMaxBoundary=t,(null===(n=c.props.Master)||void 0===n?void 0:n.Form.SettingMaster.Model.PauseAndResumeSurvey)&&(c.props.Master.Form.Model.SurveyLastModifiedAt=(new Date).toUTCString())},Options:{HTMLPropsForInnerElement:{className:"number-validation-content"}},Value:f.NumberMaxBoundary})),u=this.MI()}return g.createElement("div",{className:"question-setting-container",key:"FormsProNumberValidation"},t,i,e,r,o,a,s,u)},n.prototype.LI=function(){var t=this.props.Master.Model,n=!0;try{new RegExp(t.FormsProCustomRegEx)}catch(t){n=!1}return n},n.prototype.DI=function(){var t=this.props.Master.Model;t.FormsProCustomRegEx&&this.LI()||(t.FormsProCustomRegEx=".*")},n.prototype.lI=function(){var t,e,i,r,o,s,a=this.props.Master,u=a.Model;if(u.IsNumber){t=(0,sr._)({HTMLAttributes:{className:"question-setting-label"},Label:(0,T.pm)().NumberValidation_Rule_Description_Label});var c=(0,T.pm)().NumberValidation_Rule_Description_Label,l=(0,ar.E)({Label:"".concat(c," ").concat(rt(u.NumberValidationRule)),onValueChange:function(t){return u.NumberValidationRule=t},SelectOptions:n.getNumberValidationRuleDisplayNames(),Value:u.NumberValidationRule,ref:this.tI});e=g.createElement("div",{className:"question-setting-dropdown",style:{width:"240px"}},l);var f=!0,h=!0,d=u.NumberValidationRule;if(d!==D.pW.Between&&d!==D.pW.NotBetween)switch(d){case D.pW.None:f=!1,h=!1;break;case D.pW.Less:case D.pW.LessOrEqual:f=!1;break;default:h=!1}else o=(0,sr._)({HTMLAttributes:{className:"number-validation-between-label"},Label:(0,T.pm)().NumberValidation_Between_Label});f&&(i=(0,ur.ZA)({AutoSelection:!0,HTMLAttributes:{className:"number-validation-boundary-div",onBlur:function(){return a.justifyNumberBoundaries()}},onValueChange:function(t){u.NumberMinBoundary=t},Options:{HTMLPropsForInnerElement:{className:"number-validation-content"}},Value:u.NumberMinBoundary})),h&&(r=(0,ur.ZA)({AutoSelection:!0,HTMLAttributes:{className:"number-validation-boundary-div",onBlur:function(){return a.justifyNumberBoundaries()}},onValueChange:function(t){u.NumberMaxBoundary=t},Options:{HTMLPropsForInnerElement:{className:"number-validation-content"}},Value:u.NumberMaxBoundary})),s=this.RI()}return g.createElement("div",{className:"question-setting-container",key:"numberValidation"},t,e,i,o,r,s)},n.prototype.MI=function(){var t=this.props.Master.Model;if(t.HasTFRestrictionForPro)switch(t.FormsProValidationType){case D.PA.Custom:if(!t.FormsProCustomRegEx||!this.LI())return(0,sr._)({HTMLAttributes:{className:"validation-design-error-message-label"},Label:(0,T.pm)().ValidCustomRegExErrMsg});break;case D.PA.Number:return this.RI()}return null},n.prototype.RI=function(){var t,n=this.props.Master.Model,e=n.NumberMinBoundary||"",i=n.NumberMaxBoundary||"",r=n.NumberValidationRule,o="";switch(n.NumberMinBoundary&&((0,nt.ZR)(e)||(o=(0,T.pm)().Invalid_Number_Errmessage_In_DesignTime_Label)),n.NumberMaxBoundary&&((0,nt.ZR)(i)||(o=(0,T.pm)().Invalid_Number_Errmessage_In_DesignTime_Label)),r){case D.pW.Between:case D.pW.NotBetween:if(n.NumberMinBoundary&&n.NumberMaxBoundary){var s=parseFloat((0,nt.Q5)(e)),a=parseFloat((0,nt.Q5)(i));!isNaN(s)&&!isNaN(a)&&s>a&&(o=(0,T.pm)().Invalid_Boundary_ErrMessage_In_DesignTime_Label)}}return o&&(t=(0,sr._)({HTMLAttributes:{className:"validation-design-error-message-label",role:"alert","aria-label":o},Label:o})),t},n.getRestTypeDisplayNames=function(){for(var t=[],n=D.PA.Number;n<=D.PA.Custom;n++)t.push({DisplayName:ot(n),Key:n,Value:n});return t},n.getNumberValidationRuleDisplayNames=function(){for(var t=[],n=D.pW.None;n<D.pW.Max;++n)t.push({DisplayName:rt(n),Key:n,Value:n});return t},n}(Ko);function gs(t){var n=function(t){switch(t){case"Question.Choice":return Jo;case"Question.TextField":return vs;case"Question.DateTime":return Zo;case"Question.FileUpload":return Xo.p;case"Question.MatrixChoiceGroup":case"Question.MatrixChoice":return us;case"Question.NPS":return ls;case"Question.Ranking":return fs;case"Question.Rating":return ds;default:throw Error('Type "'.concat(t,'" has not been registered.'))}}(t.Master.Model.Type);if(n)return g.createElement(n,t)}var ps=e(70642);var bs=e(15321),ys=e(25664),ws=e(83735);window.performance;var Ss=window.performance;function Ns(){if(window.performance&&window.performance.getEntriesByType)return function(){for(var t=[],n=window.performance.getEntriesByType("navigation"),e=0,i=n;e<i.length;e++){var r=i[e];if(r.name){var o=Cs(r);o.name=location.pathname,o.connectStart=Math.round(r.connectStart),o.domainLookupStart=Math.round(r.domainLookupStart),o.redirectStart=Math.round(r.redirectStart),o.redirectEnd=Math.round(r.redirectEnd),o.domainLookupEnd=Math.round(r.domainLookupEnd),o.secureConnectionStart=Math.round(r.secureConnectionStart),o.connectEnd=Math.round(r.connectEnd),o.type=r.type,o.duration=Math.round(r.duration),t.push(o);break}}return t}()}function Cs(t){return{fetchStart:Math.round(t.fetchStart),name:Is(t.name),requestStart:Math.round(t.requestStart),responseEnd:Math.round(t.responseEnd),responseStart:Math.round(t.responseStart),transferSize:function(t){return void 0===t?-1:t}(t.transferSize),type:t.entryType}}function Is(t){try{var n=new URL(t,location.href);return"".concat(n.origin).concat(n.pathname,"$")}catch(t){return null}}var Ts,ks,xs={};function Fs(t){ks=t}function Ps(){return ks}function Ds(t){if(!window.performance)return{};var n=(0,c.k0)(),e=n.AuthDuration,i=void 0===e?0:e,r=n.IsSwReload,o=void 0!==r&&r,s=(0,gt.NW)(),a=window.performance.timing.navigationStart,u=t||(0,rn.dg)(),l=window.NavKeyPoints,f=xs;f.navigationStart=a,f.serverPageTime=l?l.ServerPageTime:0,f.pageLoaded=l?l.PageStartTime:0,f.basicJsLoaded=l?l.BasicJsLoadedTime:0,f.mainJsLoaded=l?l.MainJsLoadedTime:0,f.formRenderEnd=u,f.timeToContentReady=u-a,f.timeToSpin=f.pageLoaded-a,function(t){try{Ss&&Ss.getEntriesByType&&(Ss.getEntriesByType("measure")||[]).forEach((function(n){if(n&&n.name&&0===n.name.indexOf("FP_")){var e=n.duration,i=n.name;t[i]=e}}))}catch(t){}}(f),s.Host&&(f.host=s.Host);var h,d=Ns();return f.resourceTiming=d,f.mainJsStart=l?l.MainJsStartTime:0,f.mainCssStart=l?l.MainCssStartTime:0,f.mainCssLoaded=l?l.MainCssLoadedTime:0,f.PrefetchStart=l?l.PrefetchStart:0,f.PrefetchEnd=l?l.PrefetchEnd:0,f.fetchDataAndJsStart=l?l.FetchDataAndJsStart:0,f.fetchDataAndJsEnd=l?l.FetchDataAndJsEnd:0,f.lazyMainJsLoaded=l?l.LazyMainJsLoaded:0,f.getAuthTokenStart=l?l.GetAuthTokenStart:0,f.getAuthTokenEnd=l?l.GetAuthTokenEnd:0,f.getRuntimeFormEnd=l?l.GetRuntimeFormEnd:0,f.getResponsesEnd=l?l.GetResponsesEnd:0,f.getUserInfoEnd=l?l.GetUserInfoEnd:0,f.getThemesEnd=l?l.GetThemesEnd:0,f.authDuration=i,f.swEnabled=(0,Ot.eg)(),f.isWebdriver=(0,Ht.u)(),f.supportLCP=(h="largest-contentful-paint",!(!window.PerformanceObserver||!window.PerformanceObserver.supportedEntryTypes)&&window.PerformanceObserver.supportedEntryTypes.indexOf(h)>-1),o&&l.LastNavStart&&(f.lastNavigationStart=l.LastNavStart),f}function Ms(t,n){xs[t]=n}var Ls,Rs=!0,As=!1;function Es(t){Ls=Date.now(),Rs=!0,As=t}function Os(){var t=Ls>0?Ls:window.performance?window.performance.timing.navigationStart:Number.NaN,n={};return"boot"===_s()&&(n=Ds()),n.navigationStart=t,n.cached=As,n.type=_s(),n.formRenderEnd=(0,rn.dg)(),Rs=!1,As=!1,Ls=0,n}function _s(){return Ls>0?"withinPage":"boot"}var Bs=e(96539),Hs=function(t){function n(n){var e=t.call(this,n)||this;return e.AI=e.AI.bind(e),e.OI=e.OI.bind(e),e.state={closePopUp:!1,dialogIndex:0},e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){document.addEventListener("keyup",this.AI,!1)},n.prototype.componentWillUnmount=function(){document.removeEventListener("keyup",this.AI,!1)},n.prototype.render=function(){return this.state.closePopUp?null:this.BI()},n.prototype.BI=function(){return g.createElement("div",{className:"form-introduction-dialog-div"},g.createElement("div",{className:"form-introduction-dialog-get-start-container"},this.VI(),this.qf(),this.zI(),this.QI()),this.UI())},n.prototype.$I=function(){var t=null;switch(this.state.dialogIndex){case 0:t=qs("/Images/excelSurveyIntroductionDialog/ExcelSurvey_AccessSurvey.png",(0,T.pm)().ExcelSurvey_IntroductionDialog_AcessInfo.format((0,T.pm)().HeaderBar_AppTitle));break;case 1:t=qs("/Images/excelSurveyIntroductionDialog/ExcelSurvey_OneDrive.png",(0,T.pm)().ExcelSurvey_IntroductionDialog_SwitchInfo);break;case 2:t=g.createElement("div",null,Gs("/Images/PortalMyForms/Forms_info_1.png","excelsurvey-introduction-fre-welcome-img",(0,T.pm)().Form_Introduction_Dialog_Introduction_1),Gs("/Images/PortalMyForms/Forms_info_2.png","excelsurvey-introduction-fre-welcome-img",(0,T.pm)().Form_Introduction_Dialog_Introduction_2),Gs("/Images/PortalMyForms/Forms_info_3.png","excelsurvey-introduction-fre-welcome-img",(0,T.pm)().Form_Introduction_Dialog_Introduction_3))}return t},n.prototype.VI=function(){return g.createElement("div",{className:"excelsurvey-introduction-dialog-container"},g.createElement("div",{className:"excelsurvey-introduction-dialog-title-container"},g.createElement("div",{className:"excelsurvey-introduction-dialog-title1"},(0,T.pm)().Form_Introduction_Dialog_Title2),g.createElement("div",{className:"excelsurvey-introduction-dialog-title2"},(0,T.pm)().ExcelSurvey_IntroductionDialog_SubTitle)),g.createElement("div",{className:"excelsurvey-introduction-dialog-image-container"},this.$I(),this.WI()))},n.prototype.OI=function(t,n){switch(t.keyCode){case 32:case 13:this.setState({dialogIndex:n})}},n.prototype.UI=function(){for(var t=this,n=[],e=function(e){var r="excelsurvey-introduction-dialog-gallery-dot",o={className:r=(0,N.j)(r,e===i.state.dialogIndex?"active":"inactive"),onClick:function(){t.setState({dialogIndex:e})},onKeyUp:function(n){return t.OI(n,e)},tabIndex:0};n.push(g.createElement("div",(0,p.pi)({},o)))},i=this,r=0;r<3;r++)e(r);return g.createElement("div",{className:"excelsurvey-introduction-dialog-gallery"},g.createElement("div",{className:"excelsurvey-introduction-dialog-gallery-dots-container"},n))},n.prototype.qf=function(){var t=this;return(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"excelsurvey-introduction-dialog-close-button",onClick:function(){t.KI()}},FluentIcon:"Dismiss",IconClassName:"excelsurvey-introduction-dialog-close-icon forms-icon-size16x16",Text:(0,T.pm)().Common_Close_Text})},n.prototype.AI=function(t){27===t.keyCode&&this.KI()},n.prototype.WI=function(){var t=this;return 2===this.state.dialogIndex?(0,Fr.E)({ButtonStyle:1,HTMLAttributes:{className:"excelsurvey-introduction-dialog-gotit-button",onClick:function(){t.KI()}},Text:(0,T.pm)().TeachingUi_GotIt}):null},n.prototype.zI=function(){var t=this;return this.state.dialogIndex>0&&this.state.dialogIndex<3?(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"excelsurvey-introduction-dialog-previous-button",onClick:function(){t.setState({dialogIndex:t.state.dialogIndex-1})}},FluentIcon:(0,_r.t)()?"Chevron Right":"Chevron Left",IconClassName:"excelsurvey-introduction-dialog-previous-icon forms-icon-size36x36"}):null},n.prototype.QI=function(){var t=this;return this.state.dialogIndex>=0&&this.state.dialogIndex<2?(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"excelsurvey-introduction-dialog-next-button",onClick:function(){t.setState({dialogIndex:t.state.dialogIndex+1})}},FluentIcon:(0,_r.t)()?"Chevron Left":"Chevron Right",IconClassName:"excelsurvey-introduction-dialog-next-icon forms-icon-size36x36"}):null},n.prototype.KI=function(){this.setState({closePopUp:!0}),(0,ws.b4)().Model.ExcelSurveyIntroduction=Bs.BT.toString()},n}(J.r);function Gs(t,n,e){return g.createElement("div",{className:"excelsurvey-introduction-dialog-welcome-image"},g.createElement(Z.z,{className:n,src:t,"aria-hidden":"true"}),g.createElement("div",{className:"excelsurvey-introduction-dialog-image-welcome-text"},e))}function qs(t,n){return g.createElement("div",{className:"excelsurvey-introduction-dialog-image"},g.createElement("div",{className:"excelsurvey-introduction-dialog-image-text"},n),g.createElement(Z.z,{className:"excelsurvey-introduction-fre-img",src:t,"aria-hidden":"true"}))}function Vs(){var t={ar:"ar-sa",bg:"bg-bg",ca:"es-es",cs:"cs-cz",da:"da-dk",de:"de-de",el:"el-gr",en_us:"en-us",es:"es-es",et:"et-ee",eu:"es-es",fi:"fi-fi",fr:"fr-fr",gl:"es-es",he:"he-il",hi:"hi-in",hr:"hr-hr",hu:"hu-hu",id:"id-id",it:"it-it",ja:"ja-jp",kk:"kk-kz",ko:"ko-kr",lt:"lt-lt",lv:"lv-lv",ms:"ms-my",nb_no:"nb-no",nl:"nl-nl",pl:"pl-pl",pt_br:"pt-br",pt_pt:"pt-pt",ro:"ro-ro",ru:"ru-ru",sk:"sk-sk",sl:"sl-si",sr_cyrl_rs:"sr-cyrl-rs",sr_latn_rs:"sr-latn-rs",sv:"sv-se",sy_latn_rs:"sy-latn-rs",th:"th-th",tr:"tr-tr",uk:"uk-ua",vi:"vi-vn",zh_cn:"zh-cn",zh_tw:"zh-tw"},n=(0,c.k0)().cultureInfo.Name.toLowerCase(),e="en-us";for(var i in t)if(n===t[i]||n===i){e=t[i];break}return"https://o15.officeredir.microsoft.com/r/rlidOfficeWebHelp?p1=microsoftforms&clid="+"".concat(e,"&ver=16&mode=Touch")}var zs=e(59749);var Qs,Us,$s=e(59122),js="https://products.office.com/";function Ws(t){var n,e,i,r="true"===(0,gt.NW)().dimeppe,o="https://content.lifecycle.".concat(r?"officeppe":"office",".net/dime/v1/dime.js"),s=r?(0,Ct.Gw)("DimeJsPPEUrl"):(0,Ct.Gw)("DimeJsProdUrl");s||(s=o),n=s,e=t||Js,(i=document.createElement("script")).type="text/javascript",(0,zs.M5)(i,n),i.onload=e,document.head.appendChild(i)}function Ks(t){var n=g.useState(!1),e=n[0],i=n[1],r=t.goPremiumString;return!e&&g.createElement("span",{"aria-label":r,className:"upsell-button o365sx-button",onClick:function(){return n=function(){t.onUpsellSuccess(),i(!0)},void(Us?(0,$s.K)(js):Qs?(Qs.launch({experience:"gopremium"},n).then((function(t){(0,q.$U)("UpsellDialogClosed",t)})).catch((function(t){Us=!0,(0,q.zU)("LaunchDimeFailed",t)})),(0,q.$U)("LaunchDime")):(0,$s.K)(js));var n},style:{lineHeight:"normal"}},g.createElement("span",{className:"upsell-button-icon ms-Icon ms-forms-Icon--Diamond"}),g.createElement("span",{className:"upsell-button-text"},r))}function Js(){if(!Qs)try{var t=(0,c.k0)().userInfo;Qs=new Dime({authHint:t.Email,language:(0,_r.K)(),partnerId:"forms",sessionId:(0,te.k)(),userInfo:{puid:t.PUID}}),(0,q.$U)("InitializeDime")}catch(t){Us=!0,(0,q.zU)("InitializeDimeFailed")}return Qs}var Zs=e(3864);function Xs(t){return g.createElement(Ys,t)}var Ys=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.JI=function(){return(0,p.mG)(n,void 0,void 0,(function(){return(0,p.Jh)(this,(function(t){return this.forceUpdate(),this.ZI(),[2]}))}))},n}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this;this.props.Form.observe(this.JI,[F.x.Schema.IntegratedSavingState]),(0,T.pm)()||(0,T.ay)().then((function(){return t.JI()}))},n.prototype.componentWillUnmount=function(){this.props.Form.unobserve(this.JI),window.onbeforeunload=null},n.prototype.render=function(){var t=y.extend({},this.props.HTMLAttributes);if(!(0,T.pm)())return null;if(t["aria-live"]="polite",wa())return t.className="suiteheader-savingstatus",g.createElement("span",t,this.XI());var n="saving-state";return(0,dt.GF)()&&window.parent&&(n="saving-state-assignments"),(0,dt.Rw)()&&(n=(0,vt.tq)()?"saving-quiz-mobile":"saving-quiz-desktop"),t.className=(0,N.j)(t.className,n,!1),g.createElement("div",t,this.YI(),this.XI())},n.prototype.YI=function(){var t=this.props.Form.Model.IntegratedSavingState;if(("Saving"===t||"Scheduled"===t)&&!(0,dt.GF)())return(0,V.M)({FluentIcon:"Arrow Sync",HTMLAttributes:{className:"auto-saving-icon forms-icon-size14x14"}})},n.prototype.XI=function(){switch(this.props.Form.Model.IntegratedSavingState){case"Saving":case"Scheduled":return(0,T.pm)().Designer_AutoSaver_Saving;case"Failed":case"NotStarted":return null;case"Idle":return(0,T.pm)().Designer_AutoSaver_Saved;default:(0,Xe._y)("Not supported")}},n.prototype.ZI=function(){var t,n=this.props.Form;switch(n.Model.IntegratedSavingState){case"Saving":case"Scheduled":window.onbeforeunload=function(){return""},(0,dt.GF)()&&window.parent&&(window.onbeforeunload=null,(0,I.cr)("FixEslintTeamsPostMessageError")?window.parent.postMessage("Saving","https://assignments.onenote.com"):window.parent.postMessage("Saving","*"));break;default:if(window.onbeforeunload=null,(0,dt.GF)()&&window.parent){n.Model.Questions&&(t=y.reduce(n.Model.Questions,(function(t,n){return t+(n.Point||0)}),0));var e={FormID:n.Model.Id,FormTitle:n.Model.Title,FormScore:t};(0,I.cr)("FixEslintTeamsPostMessageError")?(window.parent.postMessage("Saved","https://assignments.onenote.com"),window.parent.postMessage(e,"https://assignments.onenote.com")):(window.parent.postMessage("Saved","*"),window.parent.postMessage(e,"*"))}}},n}(J.r),ta=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){var t=(0,k.f5)();this.tT=this.tT.bind(this),t.observe(this.tT,[t.Schema.FormMaster]),this.onDidMount()},n.prototype.componentWillUnmount=function(){(0,k.f5)().unobserve(this.tT),this.onWillUnmount()},n.prototype.render=function(){return this.createControl()},n.prototype.onDidMount=function(){},n.prototype.onWillUnmount=function(){},n.prototype.tT=function(){this.onFormChanged()},n}(J.r),na=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createControl=function(){return this.rT&&this.rT.isFieldReady(this.rT.Schema.Title)?g.createElement("span",{className:"suiteheader-formname-container","aria-live":"polite"},g.createElement("span",{className:"suiteheader-formtitle"},this.state.FormName),g.createElement("span",{className:"suiteheader-savingstatusdash","aria-hidden":"true"},this.oT()),Xs({Form:this.rT})):null},n.prototype.onFormChanged=function(){this.onWillUnmount(),this.onDidMount()},n.prototype.onDidMount=function(){this.sT=this.sT.bind(this),this.rT=(0,k.f5)().Model.FormMaster,this.rT&&this.rT.observe(this.sT,[this.rT.Schema.Title,this.rT.Schema.IntegratedSavingState]),this.sT()},n.prototype.onWillUnmount=function(){this.rT&&(this.rT.unobserve(this.sT),this.rT=void 0)},n.prototype.sT=function(){var t=this;this.rT?this.rT.ensureFieldsReady([this.rT.Schema.Title]).then((function(){t.rT&&t.setState({FormName:t.rT.Model.Title})})):this.setState({FormName:""})},n.prototype.oT=function(){return this.state.FormName&&"-"},n}(ta),ea=e(34570);function ia(t){return Promise.all([oa(),(0,T.ay)()]).then((function(n){var e=n[0],i={Id:"switchToFormsLink",Text:(0,T.pm)().HeadBar_FormsSwitcher_Text,Title:(0,T.pm)().HeadBar_FormsSwitcher_Title,Url:"javascript: FormsPro.onClickToggleFormsExperienceSwitchToForms()"},r={Id:"switchToFormsProLink",Text:(0,T.pm)().HeadBar_FormsProSwitcher_Text,Title:(0,T.pm)().HeadBar_FormsProSwitcher_Title,Url:"javascript: FormsPro.onClickToggleFormsExperienceSwitchToFormsPro()"};return e&&((0,c.k0)().isProPortal?t.push(i):t.push(r)),t}))}function ra(){(0,q.$U)("DesignPage.ProIntroductionDialog.SwitchExperienceToFormsPro"),oi.VY.getInstance().createDataProvider().updateExperienceType((0,c.k0)().userInfo.TenantId,(0,c.k0)().userInfo.UserId,"1").then((function(t){if(t){var n=window.location.pathname;n.toLowerCase().startsWith(ea.t.toLowerCase())||(n=ea.t+n);var e=location.origin+n;if((0,I.cr)("BaseProFRE")&&!(location.href.indexOf("switch=")>=0)){var i="switch=true";e+=i=0===location.search.length?"?"+i:"&"+i}(0,Dn.mj)(e)}}))}function oa(){return Promise.all([(0,Fn.UF)(),(0,Fn.sK)(),(0,Fn.nY)(),(0,Fn.GO)()]).then((function(t){var n=t[0],e=t[1],i=t[2];return t[3]&&(n||e||i)}),(function(){return!1}))}FormsPro.onClickToggleFormsExperienceSwitchToForms=function(){(0,q.JG)({eventInfo:{Component:"ProIntroductionDialog",pageName:"PortalPage",tenantId:(0,c.k0)().userInfo.TenantId,userId:(0,c.k0)().userInfo.UserId},type:"MFPUI_BaseExperienceSwitcherClick"}),oi.VY.getInstance().createDataProvider().updateExperienceType((0,c.k0)().userInfo.TenantId,(0,c.k0)().userInfo.UserId,"0").then((function(t){if(t){var n=window.location.pathname;n.toLowerCase().startsWith(ea.t.toLowerCase())&&(n=n.substring(ea.t.length)),(0,Dn.mj)(location.origin+n)}}))},FormsPro.onClickToggleFormsExperienceSwitchToFormsPro=function(){if((0,q.$U)("DesignPage.SuiteHeader.SwitchExperienceToFormsPro"),(0,I.cr)("BaseProFRE")){var t=(0,k.f5)();t.bulkEdit((function(){t.Model.TopView="ShowProFRE"}))}else ra()},FormsPro.onConfirmSwitchToFormsPro=ra,FormsPro.shouldShowExpTeachingCallout=function(){return(0,I.cr)("BaseProFRE")&&location.href.indexOf("switch=true")>=0};var sa=e(32557),aa=e(40935),ua=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createControl=function(){return this.state.GroupName?g.createElement("span",{className:"suiteheader-groupname-container"},g.createElement("a",{href:"javascript:void(0)",onClick:n.gotoGroupFormList},this.state.GroupName)):null},n.prototype.onFormChanged=function(){this.aT((0,k.f5)().Model)},n.prototype.onDidMount=function(){this.aT((0,k.f5)().Model)},n.prototype.aT=function(t){var n=this,e=t.FormMaster,i=t.GroupMaster;if(e&&e.IsGroupForm)if(i)i.ensureFieldsReady([i.Schema.displayName]).then((function(){n.setState({GroupName:i.Model.displayName})}));else{var r=(0,aa.F)();r.ensureFieldsReady([r.Schema.groups]).then((function(){var i=y.find(r.Groups,(function(t){return t.Model.id===e.Model.OwnerId}));i&&(t.GroupMaster=i,i.ensureFieldsReady([i.Schema.displayName]).then((function(){n.setState({GroupName:i.Model.displayName})})),i.ensureFieldsReady([i.Schema.formReferences]))}))}else this.setState({GroupName:""})},n.gotoGroupFormList=function(){var t=(0,k.f5)();if((0,Rt.hp)()){var n=null==(e=t.Model.GroupMaster)?void 0:e.Model.id;(0,sa.lG)(n)}else if((0,I.Be)()){var e;n=null==(e=t.Model.GroupMaster)?void 0:e.Model.id;(0,sa.tC)(n)}else t.bulkEdit((function(n){t.hideTopView(),n.FormId=null,n.FormMaster=void 0,n.CriticalError=void 0,n.Token=null,n.SearchContent="",n.FormCollectionType="GroupForms",(0,Zs.XA)()})),(0,ys.bx)()},n}(ta),ca=e(55411),la={Primary:Vi.tu};function fa(){"undefined"!=typeof O365Shell&&((0,c.k0)().userInfo.IsMsa?ha():ha((function(){oi.VY.getInstance().createDataProvider().getShellNavBarData((0,c.k0)().cultureInfo.Name).then((function(t){if(t.navBarDataJson){var n=JSON.parse(t.navBarDataJson);n.AppBrandTheme=la,n.DisableTheming=!0,O365Shell.SetData(n),ba()}}))})))}function ha(t){var n=this;Promise.all([(0,sa.pw)(),(0,T.ay)()]).then((function(e){var i=e[0];e[1];return(0,p.mG)(n,void 0,void 0,(function(){var n,e;return(0,p.Jh)(this,(function(r){switch(r.label){case 0:return e=(n=O365Shell).RenderAsync,[4,da(i)];case 1:return e.apply(n,[r.sent(),function(){var n;(0,q.$U)("SuiteHeader.Rendered"),t&&t(),ba(),(n=(0,k.f5)()).observe(ya,[n.Schema.TopView])},function(){}]),O365Shell.OnSignOut((function(t){t&&t.triggerEvent&&t.triggerEvent.preventDefault(),(0,q.$U)("SuiteHeader.SignOut"),(0,se.a)().AuthContext.signOut()})),[2]}}))}))}))}function da(t){return(0,p.mG)(this,void 0,Promise,(function(){var n,e,i;return(0,p.Jh)(this,(function(r){switch(r.label){case 0:return n={AppBrandTheme:la,Culture:(0,c.k0)().cultureInfo.Name||"en-us",DisableTheming:!0,IsConsumer:(0,c.k0)().userInfo.IsMsa,ShellBootHost:(0,c.k0)().o365ShellBootHost,UPN:(0,c.k0)().userInfo.Upn,UserDisplayName:(0,c.k0)().userInfo.DisplayName,UserID:(0,c.k0)().userInfo.PUID,WorkloadId:"OfficeForms"},e=[],(0,ca.WT)()?[3,2]:[4,ia(e)];case 1:e=r.sent(),r.label=2;case 2:return i={initialRenderData:n},[4,ma()];case 3:return i.layout=r.sent(),i.OnHelpButtonClick=function(){return(0,q.$U)("SuiteHeader.Help"),!1},i.sessionID=(0,te.k)(),i.shellDataOverrides={OCVFeedbackMAXEnabled:!0,CommunityLink:null,FeedbackLink:null,HelpLink:{Id:"FormHelpLink",TargetWindow:"_blank",Text:(0,T.pm)().DesignPage_NavBar_Help,Url:Vs()},PrivacyLink:{Id:"FormPrivacyLink",TargetWindow:"_blank",Text:(0,T.pm)().Form_Footer_PrivacyStatement,Url:t}},i.top="reactshellheader",i.workloadMeSubLinks=e,[2,i]}}))}))}function ma(){return(0,p.mG)(this,void 0,Promise,(function(){var t,n,e,i;return(0,p.Jh)(this,(function(r){switch(r.label){case 0:return n={},e={},t=[{children:[{nativeControlID:"O365Branding",id:"O365Branding"}],justifyContent:"flex-start"},{children:[{flex:"1 0 auto",id:"FormCenterHeader",render:function(t){var n=g.createElement("div",null,[g.createElement(ua,{key:"headerGroupName"}),g.createElement(na,{key:"headerFormName"})]);b.render(n,t)},responsiveBehavior:{delayMinimize:!1,minimizeBehavior:"hide",responsivePriority:1}}],flex:"1 0 auto",justifyContent:"center"}],i={},[4,Sa()];case 1:return[2,(n.centerCustomizationRegion=(e.children=t.concat([(i.children=r.sent(),i.justifyContent="flex-end",i)]),e),n.flexPaneCollection=[],n.leftCustomizationRegion={includeAppLauncher:!0},n.rightCustomizationRegion={includeMeControl:!0},n)]}}))}))}function va(t){wa()&&"undefined"!=typeof O365Shell&&O365Shell.FlexPane&&O365Shell.FlexPane.OnFlexPaneVisibilityChanged(t)}function ga(t){wa()&&"undefined"!=typeof O365Shell&&O365Shell.FlexPane&&O365Shell.FlexPane.RemoveOnFlexPaneVisibilityChanged(t)}function pa(){wa()&&"undefined"!=typeof O365Shell&&O365Shell.FlexPane&&O365Shell.FlexPane.CloseFlexPaneForProvider(null)}function ba(){(0,I.Be)()?O365Shell.Header.UpdateHeaderLink("Forms","javascript: FormsOnHeaderAppNameClick()"):O365Shell.Header.UpdateHeaderLink("Forms",(0,Rt.OE)()||"javascript: FormsOnHeaderAppNameClick()")}function ya(t){var n="";switch((0,k.f5)().Model.TopView){case"Preview":case"Branch":case"Grading_ReviewAnswers":case"Grading_PostGrades":case"MultiLingualEditionView":case"SurveyResults":n="none",pa()}$("#reactshellheader").css("display",n)}function wa(){return!(0,dt.QR)()&&!!(0,c.k0)().o365ShellBootHost}function Sa(){return(0,p.mG)(this,void 0,Promise,(function(){var t,n,e;return(0,p.Jh)(this,(function(i){switch(i.label){case 0:return t=[],[4,(0,Fn.qH)()];case 1:return n=i.sent(),[4,(0,$r.bG)()];case 2:return e=i.sent(),n&&e&&(void 0!==(r=e.legalAgeGroup)&&1!==r&&2!==r)&&(t.push({id:"GoPremiumDiamond",render:function(t){b.render(g.createElement(Ks,{onUpsellSuccess:Fn.sE,goPremiumString:(0,T.pm)().GoPremium}),t)}}),(0,q.$U)("ShowUpsellDiamond")),(0,ht.A2)()||t.push({nativeControlID:"HelpIcon",id:"HelpIcon"}),[2,t]}var r}))}))}window.FormsOnHeaderAppNameClick=function(){(0,q.$U)("AppNameClick"),(0,I.Be)()?(0,sa.tC)():(Es("Loaded"===(t=(0,k.f5)()).Model.FormListLoadState),t.bulkEdit((function(n){t.hideTopView(),n.FormId=null,n.FormMaster=void 0,n.CriticalError=void 0,n.Token=null,n.FormCollectionType="OwnedForms",n.SearchContent="",(0,Zs.XA)()})),(0,ys.bx)());var t};var Na=e(19976),Ca=function(){function t(){this.uT=!1,this.cT=!1,this.fT={},this.dT=this.dT.bind(this),this.mT=new Ia(this,this.dT),this.vT=function(){},this.mT.grab()}return t.prototype.getDefaultGrabber=function(){return this.mT},t.prototype.getCurrentOwner=function(){return this.gT},t.prototype.getLocked=function(){return this.cT},t.prototype.setLocked=function(t){this.cT=!!t},t.prototype.createGrabber=function(t){if(t&&t in this.fT)throw Error("Duplicated key while creating grabber");var n=new Ta(this,this.dT,t);return t&&(this.fT[t]=n),n},t.prototype.getGrabberByName=function(t){return this.fT[t]},t.prototype.dT=function(t,n){if(this.uT||this.cT)return!1;this.uT=!0;var e=this.vT;return this.gT=t,this.vT=n,e(),this.uT=!1,!0},t}(),Ia=function(){function t(t,n){this.pT=new Ye.Y,this.grabbable=t,this.bT=n,this.vT=this.vT.bind(this)}return t.prototype.getName=function(){return null},t.prototype.grab=function(){return!!this.bT(this,this.vT)&&(this.pT.trigger("grabbed"),!1)},t.prototype.focus=function(){return!!this.bT(this,this.vT)&&(this.pT.trigger("focused"),!1)},t.prototype.currentlyOwning=function(){return this.grabbable.getCurrentOwner()===this},t.prototype.lock=function(){return!!this.currentlyOwning()&&(this.grabbable.setLocked(!0),!0)},t.prototype.unlock=function(){this.currentlyOwning()&&this.grabbable.setLocked(!1)},t.prototype.observe=function(t){this.pT.register(t)},t.prototype.unobserve=function(t){this.pT.unregister(t)},t.prototype.vT=function(){this.pT.trigger("released")},t}(),Ta=function(t){function n(n,e,i){var r=t.call(this,n,e)||this;return r.yT=i||null,r}return(0,p.ZT)(n,t),n.prototype.getName=function(){return this.yT},n.prototype.handsOff=function(){this.currentlyOwning()&&this.grabbable.getDefaultGrabber().grab()},n}(Ia),ka=e(70877),xa=e(49306),Fa=e(51150),Pa=e(69094),Da=e(77145),Ma=function(){function t(t,n,e,i){this.ST=t,this.CT=e&&n.getGrabberByName(e)||n.createGrabber(e),i&&this.CT.grab(),this.IT=this.IT.bind(this),this.CT.observe(this.IT)}return Object.defineProperty(t.prototype,"Grabber",{get:function(){return this.CT},enumerable:!1,configurable:!0}),t.prototype.release=function(){this.CT.unobserve(this.IT),this.CT.handsOff()},t.prototype.IT=function(t){this.ST.setState({InDesignMode:"grabbed"===t})},t}();function La(){throw Error("Never called.")}function Ra(){throw Error("Never called.")}var Aa=function(t){function n(n){var e=t.call(this,n)||this;return e.TT=g.createRef(),e.If=e.If.bind(e),e.kT=e.kT.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){this.xT()},n.prototype.componentDidUpdate=function(t,n){n.InDesignMode||this.xT()},n.prototype.getContainerProps=function(){var n,e=this;return(0,et.pd)((function(){return e.state.InDesignMode}),et.t1)?n="design-time-editing":this.props.DesignFocus.getLocked()?n="design-time-mixer locked":(n="design-time-mixer",this.props.ShowWarning&&(n=(0,N.j)(n,"design-time-editing-error"))),(0,Tr.p2)(t.prototype.getContainerProps.call(this),{className:n,onClick:this.If,onKeyUp:this.kT})},n.prototype.getButtonProps=function(){return(0,Tr.p2)(t.prototype.getButtonProps.call(this),{"aria-describedby":this.props.DescriptionElementId,"aria-expanded":!1,"aria-label":this.props.Label,onClick:this.If,ref:this.TT})},n.prototype.kT=function(t){var n;this.state.InDesignMode&&27===t.keyCode&&(t.stopPropagation(),this.leaveDesignMode(),null===(n=this.TT.current)||void 0===n||n.focus())},n.prototype.If=function(t){this.state.InDesignMode||(this.enterDesignMode(),t.stopPropagation())},n.prototype.xT=function(){this.state.InDesignMode&&this.props.scrollToDesigner&&this.props.scrollToDesigner()},n}(function(t){function n(n){var e=t.call(this,n)||this;return e.FT=new Ma(e,e.props.DesignFocus,e.props.Name,e.props.AutoFocus),e.state={InDesignMode:e.FT.Grabber.currentlyOwning()},e}return(0,p.ZT)(n,t),Object.defineProperty(n,"Designer",{get:function(){return La},enumerable:!1,configurable:!0}),Object.defineProperty(n,"Renderer",{get:function(){return Ra},enumerable:!1,configurable:!0}),n.prototype.componentWillUnmount=function(){this.FT.release()},n.prototype.render=function(){var t=this.state.InDesignMode,e=this.props.ShowWarning&&!t&&(0,V.M)({FluentIcon:"Error Circle",HTMLAttributes:{className:"design-time-editing-error-icon"}});return g.createElement("div",(0,p.pi)({},this.getContainerProps()),e,!t&&this.PT(),t&&this.DT(n.Designer),!t&&this.DT(n.Renderer))},n.prototype.enterDesignMode=function(){return this.props.scrollToDesigner&&this.props.scrollToDesigner(),this.FT.Grabber.grab()},n.prototype.leaveDesignMode=function(){this.FT.Grabber.handsOff()},n.prototype.getContainerProps=function(){return{"aria-label":this.props.Title}},n.prototype.getButtonProps=function(){return this.props.HTMLAttributes},n.prototype.PT=function(){return g.createElement("button",(0,p.pi)({},this.getButtonProps()))},n.prototype.DT=function(t){var n=g.Children.toArray(this.props.children).filter((function(n){return n&&n.type===t}))[0];return n&&n.props.children},n}(J.r)),Ea=function(t){function n(n){var e=t.call(this,n)||this;e.MT=g.createRef();var i=n.DesignFocus.getDefaultGrabber();return e.state.InDesignMode=i.currentlyOwning(),e.IT=e.IT.bind(e),i.observe(e.IT),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.props.DesignFocus.getDefaultGrabber().unobserve(this.IT)},n.prototype.componentDidUpdate=function(){this.state.FocusByDefault&&this.MT.current&&this.MT.current.setFocusOnAddButton&&this.MT.current.setFocusOnAddButton()},n.prototype.render=function(){return this.state.InDesignMode&&g.createElement(Ig,{designElement:this.props.designElement,Form:this.props.Form,ref:this.MT})},n.prototype.IT=function(t){this.setState({InDesignMode:"grabbed"===t||"focused"===t,FocusByDefault:"focused"===t})},n}(J.r);function Oa(t){return h.Pv.Resolve("ICustomerVoiceSectionHeaderDesignerFactory").createSectionHeaderDesigner(t)}var _a=e(16717),Ba=e(22580),Ha=e(13663),Ga=e(8009),qa=e(41040),Va=function(t){function n(n){var e=t.call(this,n)||this;return e.state={ImageLoadStatus:0,ShowAltTextButton:!0},e.Td=e.Td.bind(e),e.Cd=e.Cd.bind(e),e.LT=e.LT.bind(e),e.RT=e.RT.bind(e),e.AT=e.AT.bind(e),e.ET=e.ET.bind(e),e.HT=e.HT.bind(e),e.GT=e.GT.bind(e),e.Le=e.Le.bind(e),e.qT=e.qT.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){var t=(0,k.Cu)().Schema;this.props.ImageInfoMaster.observe(this.qT,[t.ErrorType,t.AltText,t.ResourceUrl])},n.prototype.componentWillUnmount=function(){this.VT(),this.props.ImageInfoMaster.unobserve(this.qT);var t=this.props.ImageInfoMaster.Model;t&&t.ErrorType!==ze.dL.NoError&&(t.ErrorType=ze.dL.NoError)},n.prototype.render=function(){return g.createElement("div",{className:"title-designer-image-editor"},this.Hd(),this.Vd())},n.prototype.Hd=function(){var t=this.props.ImageInfoMaster.Model,e=!1;if(t.ErrorType!==ze.dL.NoError||2===this.state.ImageLoadStatus)return null;var i,r,o,s="title-designer-image design-question-title-image-hidden",a=(0,N.j)("title-designer-image-content design-question-title-image-button office-form-theme-focus-border",this.props.ImageWidth?"inline-block-display":"");return this._u()?(a=(0,N.j)(a,"office-form-theme-outline"),s=(0,N.j)(s,1===this.state.ImageLoadStatus?"design-question-title-image-gray visiable":""),i=n.createSpinner()):(s=(0,N.j)(s,t.ResourceUrl?"visiable":""),i=this.zT(),e=!0),this.props.ImageWidth?("number"==typeof(r=this.props.ImageWidth)&&e&&r<59&&(r=59),o=this.props.ImageHeight):(r="100%",o="auto"),g.createElement("div",{"aria-label":(0,T.pm)().DesignPage_Image_ImageDesigner,className:a},g.createElement("img",{alt:t.AltText,className:s,height:o,onError:t.ResourceUrl?this.Td:void 0,onLoad:this.Cd,src:t.ResourceUrl?t.ResourceUrl:void 0,title:t.AltText,width:r}),i)},n.prototype.zT=function(){var t;return this.props.Resizable&&(t=this.Kh()),g.createElement("div",{className:"image-edit-pane-container office-form-theme-border image-edit-pane-container-nowrap"},t,this.Yh(),this.nd())},n.prototype.Kh=function(){var t,n="image-edit-pane-inner-button office-form-theme-button-foreground",e=this.props.ImageSettingMaster.Model.Size;e===Qe.h2.Small&&(n=(0,N.j)(n,"active"),t=!0);var i,r={ButtonStyle:1,children:(0,V.M)({FluentIcon:"Resize Small",HTMLAttributes:{className:"image-edit-pane-inner-button-icon forms-icon-size14x14"}}),HTMLAttributes:{"aria-label":(0,T.pm)().ImageEditPane_SmallSize_Button,className:n,disabled:t,onClick:this.AT},Tooltip:(0,T.pm)().ImageEditPane_SmallSize_Button},o=g.createElement(Dr.zx,(0,p.pi)({},r)),s="image-edit-pane-inner-button office-form-theme-button-foreground";e===Qe.h2.Large&&(s=(0,N.j)(s,"active"),i=!0);var a={ButtonStyle:1,children:(0,V.M)({FluentIcon:"Resize Large",HTMLAttributes:{className:"image-edit-pane-inner-button-icon forms-icon-size14x14"}}),HTMLAttributes:{"aria-label":(0,T.pm)().ImageEditPane_LargeSize_Button,className:s,disabled:i,onClick:this.ET},Tooltip:(0,T.pm)().ImageEditPane_LargeSize_Button},u=g.createElement(Dr.zx,(0,p.pi)({},a));return g.createElement("div",{className:"image-edit-pane-element-container office-form-theme-border",key:"size-button"},o,u)},n.prototype.sd=function(t){var n=this.props.ImageInfoMaster.Model,e=this.props.ImageSettingMaster;(0,q.$U)("DesignPage.ImageEditPane.Style",{imageId:n.ResourceId,style:t}),e.onImageStyleChange(t)},n.prototype.AT=function(){this.sd(Qe.h2.Small)},n.prototype.ET=function(){this.sd(Qe.h2.Large)},n.prototype.nd=function(){var t=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"image-edit-pane-inner-button office-form-theme-button-foreground",onClick:this.Le},FluentIcon:"Delete",IconClassName:"forms-icon-size14x14",Text:(0,T.pm)().Common_Delete_Text});return g.createElement("div",{className:"image-edit-pane-delete",key:"delete-button"},t)},n.prototype.Yh=function(){if(this.state.ShowAltTextButton){var t=(0,T.pm)(),n=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"image-edit-pane-inner-button office-form-theme-button-foreground",onClick:this.HT},FluentIcon:"Text Field",IconClassName:"edit-pane-fieldText",Text:t.Common_Fullstop.format(t.ImageEditPane_AltText_Button,t.Click_Enter_Edit)});return g.createElement("div",{className:"image-edit-pane-alttext-button office-form-theme-border",key:"alttext-button"},n)}var e=(0,ur.ZA)({AutoFocus:!0,AutoSelection:!0,MaxLength:(0,X.jz)(),MinimalHeight:28,onValueChange:this.GT,Options:{HTMLPropsForInnerElement:{onBlur:this.RT}},Placeholder:(0,T.pm)().ImageEditPane_AltText_PlaceHolder,ref:"edit-pane-alttext",TextFieldType:0,Value:this.props.ImageInfoMaster.Model.AltText});return g.createElement("div",{className:"image-edit-pane-alttext office-form-theme-border",key:"alttext"},e)},n.prototype.GT=function(t){this.props.ImageInfoMaster.Model.AltText=t},n.prototype.HT=function(){(0,q.$U)("DesignPage.ImageEditPane.AltText",{Id:this.props.ImageInfoMaster.Model.ResourceId}),this.setState({ShowAltTextButton:!1})},n.prototype.RT=function(){var t=this;this.QT=window.setTimeout((function(){t.QT=null,t.setState({ShowAltTextButton:!0})}),150)},n.prototype.VT=function(){this.QT&&(window.clearTimeout(this.QT),this.QT=null)},n.prototype.Td=function(){(0,q.w6)("Image.ImageOnLoad.Failure",{imageType:this.props.ImageSettingMaster.IsFormLogo?"Logo":"Section",location:"0"}),(0,Nt.OE)(1,{$imageType:this.props.ImageSettingMaster.IsFormLogo?"Logo":"Section",$location:"DesignCard"}),this.setState({ImageLoadStatus:2})},n.prototype.Cd=function(){(0,q.w6)("Image.ImageOnLoad.Success",{imageType:this.props.ImageSettingMaster.IsFormLogo?"Logo":"Section",location:"0"}),(0,Nt.OE)(2,{$imageType:this.props.ImageSettingMaster.IsFormLogo?"Logo":"Section",$location:"DesignCard"}),this.setState({ImageLoadStatus:1})},n.prototype.Vd=function(){var t,e,i=this.props.ImageInfoMaster,r=i.Model;if(r.ErrorType===ze.dL.NoError&&2!==this.state.ImageLoadStatus)return null;r.ErrorType===ze.dL.DeleteFailError||2===this.state.ImageLoadStatus?(t=n.createOperationButton((0,T.pm)().Common_Delete_Text,"office-form-theme-primary-foreground","Horizontal","Delete","forms-icon-size12x12",this.Le),e=n.createOperationButton((0,T.pm)().Common_Refresh_Text,"office-form-theme-primary-foreground","Horizontal","Arrow Sync","forms-icon-size12x12",this.LT)):t=n.createOperationButton((0,T.pm)().Common_Try_again_Text,"office-form-theme-primary-foreground","Horizontal","Image","forms-icon-size12x12",this.props.addImage);var o=(0,V.M)({FluentIcon:"Emoji Sad",HTMLAttributes:{className:"image-error-frowny-icon"}}),s=(0,sr._)({HTMLAttributes:{className:"error-message"},Label:i.getImageErrorMessage()||(0,T.pm)().Error_Message_5205}),a={height:this.props.ImageHeight||"120px",width:this.props.ImageWidth||(0,X.Rr)()+"px"};return g.createElement("div",{className:"design-image-error office-form-theme-border",style:a},g.createElement("div",{className:"error-message-box"},o,s),g.createElement("div",null,e,t))},n.prototype.Le=function(){var t=this.props.ImageInfoMaster,n=this.props.ImageSettingMaster;(0,q.$U)("DesignPage.ImageEditPane.Delete",{imageKind:n.IsFormLogo?"Logo":"Section"}),t.clear().then((function(){return n.clear()}))},n.prototype.LT=function(){this.setState({ImageLoadStatus:0})},n.createOperationButton=function(t,n,e,i,r,o){return(0,z.F)({ButtonStyle:1,GlyphButtonStyle:e,FluentIcon:i,HTMLAttributes:{className:n,onClick:o},IconClassName:r,Text:t})},n.prototype._u=function(){return this.props.ImageInfoMaster.Model.ImageProcessingStatus!==ze.nv.Idle||0===this.state.ImageLoadStatus},n.prototype.qT=function(){this.forceUpdate()},n.createSpinner=function(){var t=g.createElement(qa.P,(0,p.pi)({},{ClassName:"designPage-question-tileUploadImage-spinner",Ignorable:!1}));return g.createElement("div",{className:"image-spinner"},t)},n}(J.r),za=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.om=g.createRef(),n}return(0,p.ZT)(n,t),n.prototype.focus=function(){var t=this.om.current;t&&t.focus()},n.prototype.render=function(){var t=y.extend({},this.props.HTMLAttributes);return t.className=(0,N.j)(t.className,"title-designer-container"),g.createElement("div",(0,p.pi)({},t),this.Sg(),this.vg())},n.prototype.UT=function(){return"Section"===this.props.TitleContainerType?(0,T.pm)().Designer_SectionTitle:(0,T.pm)().Designer_FormTitle},n.prototype.jT=function(){return"Section"===this.props.TitleContainerType?(0,T.pm)().Designer_SectionSubtitle:(0,T.pm)().Designer_FormSubtitle},n.prototype.Sg=function(){var t=(0,X.gj)(),n=2;this.props.TitleHeight&&"Top"!==this.props.MediaLayout&&"Bottom"!==this.props.MediaLayout&&(n=1,t=this.props.TitleHeight);var e=(0,N.j)("title-designer-title-box",this.props.MediaLayout.toLowerCase()),i=(0,ur.ZN)({AllowRichText:!0,AutoFocus:!0,AutoSelection:!0,HTMLAttributes:{className:"title-designer-title-editor word-break"},MaxLength:ki(),MinimalHeight:t,onValueChange:this.props.onValueChange,Options:{HTMLPropsForInnerElement:{"aria-label":this.UT(),className:"mixer-focus-target"}},Placeholder:(0,T.pm)().Designer_PlaceholderForFormTitle,ref:this.om,TextFieldType:n,TextFieldLocation:{Location:(0,jo.bF)(this.props.TitleContainerType),Suffix:1},Value:this.props.Value},this.props.Form,"Form"!==this.props.TitleContainerType,"Form"!==this.props.TitleContainerType);return g.createElement("div",{className:e},i,this.props.children)},n.prototype.vg=function(){return(0,ur.ZN)({AllowRichText:!0,AutoSelection:!0,HTMLAttributes:{className:"title-designer-subtitle-editor"},MaxLength:(0,X.hT)(),MinimalHeight:(0,X.gj)(),onValueChange:this.props.onSubTitleChange,Options:{HTMLPropsForInnerElement:{"aria-label":this.jT()}},Placeholder:(0,T.pm)().Designer_PlaceholderForFormSubtitle,TextFieldType:2,TextFieldLocation:{Location:(0,jo.bF)(this.props.TitleContainerType),Suffix:2},Value:this.props.SubTitle},this.props.Form,!0,"Form"!==this.props.TitleContainerType)},n}(J.r),Qa=e(62335),Ua=e(54164),$a=function(t){function n(n){var e=t.call(this,n)||this;return e.Bo=g.createRef(),e.KT=e.KT.bind(e),e.QS=e.QS.bind(e),e.As=e.As.bind(e),e.JT=e.JT.bind(e),e.dm=e.dm.bind(e),e.XT=e.XT.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this.props.Master,n=x.Jv.Schema;t.observe(this.As,[n.Title,n.Subtitle,n.ImageInfo,n.VideoInfo,n.CoAuthors]);var e=t.ImageInfoMaster,i=(0,k.Cu)().Schema;e.observe(this.As,[i.ImageProcessingStatus,i.ErrorType,i.UploadParameters]);var r=t.ImageSettingsMaster,o=Qe.Vj.Schema;r.observe(this.As,[o.NaturalWidth,o.NaturalHeight,o.Size])},n.prototype.componentWillUnmount=function(){var t=this.props.Master;t.unobserve(this.As),t.ImageSettingsMaster.unobserve(this.As),t.ImageInfoMaster.unobserve(this.As)},n.prototype.render=function(){var t=this.props.Master,e=t.Model,i=y.extend({},this.props.HTMLAttributes);i.className=(0,N.j)(i.className,"__section-title-designer__ form-designer-section-title office-form-theme-focus-border");var r,o,s="Right",a=t.ImageInfoMaster,u=t.ImageSettingsMaster,c=a.Model,l=e.VideoInfo;if(c.ImageProcessingStatus===ze.nv.Picking||c.ErrorType||(0,ze.UO)(c)){var f=n.calcImageInfo(u.Model);r=f.Height,s=f.ImageLayout,o=g.createElement(Va,{addImage:this.JT,ImageHeight:f.Height,ImageInfoMaster:a,ImageSettingMaster:u,ImageWidth:f.Width,Resizable:!0})}else if(t.hasValidVideoUrl()){var h=(0,ka.B9)(l.Url,t.Form);s="Bottom",h&&(i.className="".concat(i.className," youTubeDisabled"));var d=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"video-delete-button office-form-theme-button-foreground",onClick:this.XT},FluentIcon:"Delete",IconClassName:h?"forms-icon-size14x14":"forms-icon-size18x18",Text:(0,T.pm)().VideoEditPane_Delete_Button});o=g.createElement(Ga.C,{HTMLAttributes:{className:"design-question-image-title-big-horizontal"},ClassNameForIFrame:"design-question-title-video-frame",Url:l.Url,InDesignMode:!0,IsMobile:(0,vt.tq)(),ShowVideoUrl:h,LocalizedStrings:(0,T.pm)()},d)}else o=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"form-designer-title-editor-image-picker office-form-theme-button",onClick:this.JT},FluentIcon:"Image",IconClassName:"forms-icon-size20x20",key:"ImagePicker",ref:this.Bo,Text:(0,T.pm)().ImagePicker_Insert_Mdeia_button});var m=x.Jv.Schema,v=t.isFieldReady(m.FormsProRTSubtitle)&&t.isFieldReady(m.FormsProRTQuestionTitle);return g.createElement(za,{Form:this.props.Master.Form,HTMLAttributes:i,MediaLayout:s,onHeightChange:this.props.onHeightChange,onSubTitleChange:this.QS,onValueChange:this.KT,SubTitle:(0,ir.wg)(e.Subtitle,v&&e.FormsProRTSubtitle),TitleContainerType:"Section",TitleHeight:r,Value:(0,ir.wg)(e.Title,v&&e.FormsProRTQuestionTitle)},this.Am(),o,this.ym())},n.prototype.XT=function(){(0,q.$U)("DesignPage.VideoEditPane.Delete"),this.props.Master.clearVideoInfo();var t=this.props.Master.Form;(0,ka.ax)(t)||t.Model.YouTubeMessageBarState!==Fa.E.Shown||(t.Model.YouTubeMessageBarState=Fa.E.Default)},n.prototype.ym=function(){var t=this,n=this.props.Master.Model.CoAuthors;if(n&&n.length>0&&n[n.length-1].userId!==(0,c.k0)().userInfo.UserId)return g.createElement("div",{className:"question-coAuthor-notification-container-design-mode"},y.map(n,(function(n){return t.Nm(n)})))},n.prototype.Nm=function(t){if(t.userId!==(0,c.k0)().userInfo.UserId){var n=(0,T.pm)().DesignPage_NavBar_CoAuthor_Section_Screen_Reader.format(t.displayName||t.userId,this.props.Ordinal);return g.createElement(Qa.k,{ariaLabel:n,displayText:(0,Ua.c)(t.displayName,t.firstName,t.lastName),email:t.email,key:t.userId,name:t.displayName,tooltip:t.displayName||t.userId})}},n.prototype.JT=function(){var t=this,n=this.props.Master,e=n.Model;(0,q.$U)("DesignPage.Questions.AddImage",{questionId:e.Id,questionType:e.Type}),(0,Ha.b)().then((function(t){t.Image?n.ImageInfoMaster.addImage(t.Image):t.Video&&n.setVideoUrl(t.Video,!0)})).catch((function(n){var e=t.Bo.current;n&&e&&e.focus()}))},n.prototype.Am=function(){if((0,ti.Fp)()&&this.props.Master.Model.VideoInfo.ShowWarningBar){var t=this.props.Master.Form.SettingMaster,n=t.Model.IsAnonymous?(0,T.pm)().Designer_QuestionTitle_StreamVideoTipForAnonymousForm:(0,T.pm)().Designer_QuestionTitle_StreamVideoTip;return(0,ms.vV)({Info:n,onClose:this.dm,ShouldClose:!0,TipBarIconClassName:"ms-Icon ms-Icon--Info forms-icon-size16x16",TipBarLocation:"Up",TipBarStyle:t.Model.IsAnonymous?"RedBackground":"YellowBackground"})}},n.prototype.dm=function(t){t.stopPropagation(),t.preventDefault(),this.props.Master.Model.VideoInfo.ShowWarningBar=!1},n.calcImageInfo=function(t){return t.NaturalWidth?t.Layout===Qe.RZ.Horizontal&&t.Size===Qe.h2.Large?{ImageLayout:"Bottom"}:{Height:t.ContainerHeight,ImageLayout:"Right",Width:t.ContainerWidth}:{Height:(0,X.w_)(),ImageLayout:"Right",Width:(0,X.Rr)()}},n.prototype.KT=function(t){this.props.Master.bulkEdit((function(n){(0,ir.v1)(n,t,"Title","FormsProRTQuestionTitle")}))},n.prototype.QS=function(t){this.props.Master.bulkEdit((function(n){(0,ir.v1)(n,t,"Subtitle","FormsProRTSubtitle")}))},n.prototype.As=function(){var t=this;this.forceUpdate((function(){var n=t.props.onHeightChange;n&&n()}))},n}(J.r),ja=function(t){function n(n){var e=t.call(this,n)||this;return e.YT=g.createRef(),e.tk=g.createRef(),e.ek=e.ek.bind(e),n.Master.observe((function(){return e.forceUpdate()}),[n.Master.Schema.Title]),e}return(0,p.ZT)(n,t),n.prototype.componentDidUpdate=function(){this.ik&&(this.rk(),this.ik=!1)},n.prototype.render=function(){var t=this,n=this.props,e="__section__ form-designer-section";return n.MergeWithHeader&&(e=(0,N.j)(e,"form-designer-section-merge")),g.createElement("div",{className:e,ref:this.YT,"aria-label":(0,T.pm)().Designer_Sections_DefaultDescription.format(this.props.Ordinal)},Oa({designElement:n.designElement,DesignFocus:n.DesignFocus,Master:n.Master,MixerRef:this.tk,Ordinal:n.Ordinal,scrollToDesigner:n.scrollToDesigner,trackMoveElement:this.ek}),g.createElement("div",{className:"form-designer-section-content"},g.createElement(Aa,{AutoFocus:n.AutoFocus,DesignFocus:n.DesignFocus,Label:n.Master.Model.Title,Name:n.Master.Model.Id,Title:(0,T.pm)().Designer_Section_Label,ref:this.tk,scrollToDesigner:this.props.scrollToDesigner},g.createElement(Aa.Designer,null,g.createElement($a,{Master:n.Master,onHeightChange:n.onHeightChange,Ordinal:this.props.Ordinal,ref:n.TitleDesignerRef}),g.createElement(Ng,{designElement:this.props.designElement,Form:n.Master.Form,Section:n.Master})),g.createElement(Aa.Renderer,null,g.createElement(_a.U.Consumer,null,(function(e){var i=e.LocalizedStrings;return g.createElement(Ba.$,{Master:n.Master,LocalizedStrings:i,onHeightChange:n.onHeightChange,Ordinal:t.props.Ordinal})})),!1)),n.children))},n.prototype.ek=function(){this.ak=$(this.YT.current).offset().top,this.ik=!0},n.prototype.rk=function(){var t=this.YT.current;if(t){var n=$(t),e=$(t.parentElement);e.scrollTop(e.scrollTop()+(n.offset().top-this.ak))}},n}(J.r),Wa=e(79068),Ka=e(90927),Ja=function(t){function n(n){var e=t.call(this,n)||this;return e.vo=!0,e.lk=0,e.fk=new Ca,e.hk=g.createRef(),e.im=[],e.dk="",e.vk={},e.state={ReputationTier:e.props.Form.Model.ReputationTier},e.gk=e.gk.bind(e),e.pk=e.pk.bind(e),e.tp=e.tp.bind(e),e.bk=e.bk.bind(e),e.wk=e.wk.bind(e),e.As=e.As.bind(e),e.Sk=e.Sk.bind(e),e.Nk=e.Nk.bind(e),((0,C.w)(e.props.Form,"DisableEditForm")||(0,K.kl)(e.state.ReputationTier))&&e.fk.setLocked(!0),e.Nk(),e.props.Form.observe(e.As,[F.x.Schema.ReputationTier]),e.props.Form.observe((function(){return e.forceUpdate()}),[F.x.Schema.Questions]),e.props.Form.observe(e.Sk,[F.x.Schema.Title,F.x.Schema.Settings.IsAnonymous]),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){br(),(0,Pa.c4)();var t=(0,c.k0)().userInfo;t&&t.TenantId&&t.UserId&&(0,mi.W2)(t.TenantId,t.UserId),this.Ck(),!(0,S.Wh)()&&(0,ht.yv)()||(0,c.k0)().userInfo.IsMsa||(0,xa.I)(),this.Ik(),this.Tk()},n.prototype.componentDidUpdate=function(){this.Ik()},n.prototype.componentWillUnmount=function(){var t=this;this.vo=!1;var n=this.props.Form;$("#body-scrollable-content").unbind("scroll"),_.d.getCollectionMasterFromModel(n.Model.Questions).unobserve(this.bk),_.d.getCollectionMasterFromModel(n.Model.DescriptiveElements).unobserve(this.bk),y.keys(this.vk).forEach((function(n){return t.vk[n].release()})),this.props.Form.observe(this.As),this.props.Form.unobserve(this.Sk)},n.prototype.shouldComponentUpdate=function(t){return this.props.Form!==t.Form},n.prototype.$a=function(){return(0,et.pd)((function(){return null}),et.t1)},n.prototype.render=function(){var t=this,n=y.extend({},this.props.HTMLAttributes);n.id="form-designer-container",n.onMouseDown=function(n){var e=n.target;!e||"form-designer-container"!==e.id&&"form-designer"!==e.id||t.endCurrentDesignMode()};return g.createElement("div",(0,p.pi)({},this.props.HTMLAttributes,{id:"design-view"}),g.createElement("div",(0,p.pi)({},n,{tabIndex:-1,"aria-label":this.props.Form.Model.Title,role:this.props.IsEmbed?void 0:"main"}),this.Ta(),g.createElement("div",{id:"form-designer"},this.xk()),null,null,null))},n.prototype.endCurrentDesignMode=function(){this.fk.getDefaultGrabber().grab()},n.prototype.Fk=function(t){this.im.push(t)},n.prototype.Pk=function(t){var n=this,e=this.props.Form,i=0===e.FormElementManager.SectionMasters.length;return g.createElement("div",{key:"headerTopQuestions",className:"form-designer-section"},tg().createFormTitleAuthoringContianer({Form:e,designElement:this.pk,DesignFocus:this.fk,onHeightChange:this.gk,scrollToDesigner:this.wk}),e.FormElementManager.HeaderTopQuestionMasters.map((function(e,i){return n.Dk(e,i,t)})),i&&this.Rk(),(0,et.hl)((function(){return n.Ek()})))},n.prototype.xk=function(){var t=this,n=this.props.Form,e=n.FormElementManager.TopElementMasters,i=n.FormElementManager.TopQuestionMasters,r=n.FormElementManager.SectionMasters,o=0===n.FormElementManager.HeaderTopQuestionMasters.length&&r.length>=1&&r[0],s=[this.Pk(e),g.createElement(Ka.w,{key:"themeRender",ThemeMaster:n.ThemeMaster})];return r&&r.length&&(s=s.concat(r.map((function(n,s){return t.Ok(n,s,r,i,e,n===o)})))),i.length&&this.dk===i[0].Model.Id&&($("#body-scrollable-content").scrollTop(0),this.dk=""),s},n.prototype.Ta=function(){if(!(!(0,S.Wh)()&&(0,ht.yv)()||(0,c.k0)().userInfo.IsMsa))return g.createElement(Da.d,{FormMaster:this.props.Form,HTMLAttributes:{className:"form-designer-classification-label"},DesignTimeView:!0})},n.prototype.Dk=function(t,n,e){var i=Aa,r=this.Bk===t;r&&(this.Bk=null);var o=!!t.getErrorMessage(),s={DesignFocus:this.fk,designElement:this.pk,focusOnAddButton:this.tp,Master:t,Ordinal:n+1,IsFirstElement:this.Hk(e,t),IsLastElement:e[e.length-1]===t,ref:this.hk},a=(0,et.pd)((function(){return tg().createQuestionDesigner(s)}),et.t1);return g.createElement(i,{AutoFocus:r,DesignFocus:this.fk,Label:(0,T.pm)().Designer_LabelForQuestionTitle.format(n+1,t.Model.Title),Name:t.Model.Id,key:t.Model.Id,scrollToDesigner:this.wk,IsDesignModeDisabled:!1,ShowWarning:o,Title:(0,T.pm)().Designer_Question_Label.format(this.Gk(t.Model.Type)),DescriptionElementId:"".concat(t.Model.Id,"-description")},g.createElement(i.Designer,null,a,g.createElement(Cg,{designElement:this.pk,Form:this.props.Form,Question:t})),g.createElement(i.Renderer,null,tg().createQuestionRenderer({Master:this.qk(t),LocalizedStrings:(0,T.pm)(),Ordinal:n+1,DisableShuffle:!0,Disabled:!0,onHeightChange:this.gk,ShowDesignInfo:!0,designElement:this.pk,DescriptionElementId:"".concat(t.Model.Id,"-description")}),!1))},n.prototype.Hk=function(t,n){return t[0]===n||!!(t.length>=2&&t[1]===n&&Ve.H.isSection(t[0].Model.Type))},n.prototype.Ok=function(t,n,e,i,r,o){var s=this,a=this.Bk===t;a&&(this.Bk=null);var u=this.props.Form.FormElementManager.findQuestionsInSection(t),c=y.indexOf(i,u[0]),l=n===e.length-1;return g.createElement(ja,{AutoFocus:a,designElement:this.pk,DesignFocus:this.fk,key:t.Model.Id+"-section-designer",Master:t,MergeWithHeader:o,onHeightChange:this.gk,Ordinal:n+1,scrollToDesigner:this.wk,TitleDesignerRef:this.hk},u.map((function(t,n){return s.Dk(t,n+c,r)})),l&&this.Rk())},n.prototype.Rk=function(){return g.createElement(Ea,{DesignFocus:this.fk,Form:this.props.Form,designElement:this.pk})},n.prototype.Ek=function(){return(0,I.cr)("EstimationTimeUIFix")&&!this.props.IsEmbed&&(0,Wa.N4)()&&!(0,k.f5)().Model.Analysis?(0,wo.Ws)({Form:this.props.Form}):null},n.prototype.qk=function(t){var n=this.vk[t.Model.Id];return n||(n=new or.r(t,null),this.vk[t.Model.Id]=n),n},n.prototype.pk=function(t){var n=this.props.Form;if(!(0,C.w)(n,"DisableEditForm"))if(t){var e=this.fk.getGrabberByName(t.Model.Id);e?e.grab():(this.Fk(this.wk),this.Bk=t,this.dk=t.Model.Id,this.forceUpdate())}else this.fk.getDefaultGrabber().grab()},n.prototype.tp=function(){var t=this.props.Form;(0,C.w)(t,"DisableEditForm")||this.fk.getDefaultGrabber().focus()},n.prototype.Gk=function(t){switch(t){case"Question.Choice":return(0,T.pm)().QuestionCategory_Choice;case"Question.TextField":return(0,T.pm)().QuestionCategory_Text;case"Question.Rating":return(0,T.pm)().QuestionCategory_Rating;case"Question.DateTime":return(0,T.pm)().QuestionCategory_DateTime;case"Question.Ranking":return(0,T.pm)().QuestionCategory_Ranking;case"Question.MatrixChoiceGroup":return(0,T.pm)().QuestionCategory_Likert;case"Question.NPS":return(0,T.pm)().QuestionCategory_NPS;case"Question.FileUpload":return(0,T.pm)().QuestionCategory_UploadFile;default:return""}},n.prototype.bk=function(t){var n=this;(t.AddedModels.length||t.RemovedModels.length||y.contains(t.FieldSchemas,t.Master.Schema[0].Order))&&(this.forceUpdate((function(){n.props.Form.FormElementManager.getElementMasterById(n.fk.getCurrentOwner().getName())&&n.gk(),n.sm()})),this.Tk())},n.prototype.Vk=function(){var t=this.hk.current;if(t){var n=b.findDOMNode(t);n&&(this.lk=$(n).offset().top)}},n.prototype.wk=function(){var t=this.hk.current;if(t){var e=b.findDOMNode(t);if(e){var i=$(e);n.scrollToElement(i),this.lk=i.offset().top}}},n.scrollToElement=function(t){var n=$("#body-scrollable-content"),e=.03*n.outerHeight(),i=Math.max(.15*n.outerHeight(),50);if((0,Tr.n1)(t,n,e,i),(0,vt.w1)()||(0,vt.G6)()){var r=n.find(".roosterjs-editor-box")[0];r&&(r.focus(),(0,Tr.n1)($(r),n,e,i))}},n.prototype.gk=function(){var t=this.hk.current;if(t){var n=b.findDOMNode(t);if(n){var e=$("#body-scrollable-content"),i=e.scrollTop()+($(n).offset().top-this.lk);e.scrollTop(i),this.lk=$(n).offset().top}}},n.prototype.Ck=function(){var t=this,n=this.props.Form;$("#body-scrollable-content").on("scroll",(function(){t.Vk()})),_.d.getCollectionMasterFromModel(n.Model.Questions).observe(this.bk),_.d.getCollectionMasterFromModel(n.Model.DescriptiveElements).observe(this.bk)},n.prototype.sm=function(){var t=this.im;this.im=[],this.forceUpdate((function(){t.forEach((function(t){return t()}))}))},n.prototype.As=function(){this.vo&&(this.setState({ReputationTier:this.props.Form.Model.ReputationTier}),(0,K.kl)(this.props.Form.Model.ReputationTier)?this.fk.setLocked(!0):this.fk.setLocked(!1))},n.prototype.Sk=function(){this.forceUpdate()},n.prototype.Ik=function(){var t=this.props.Form.FormElementManager.QuestionMasters,n=y.find(t,(function(t){return!!t.getErrorMessage()}));n?(0,Zs.r)(n.getErrorMessage()):(0,Zs.r)(null)},n.prototype.Tk=function(){var t=this.props.Form.Model.YouTubeMessageBarState;(0,ka.ax)(this.props.Form)?t===Fa.E.Default&&(this.props.Form.Model.YouTubeMessageBarState=Fa.E.Shown):t===Fa.E.Shown&&(this.props.Form.Model.YouTubeMessageBarState=Fa.E.Default)},n.prototype.Nk=function(){if((0,ka.ax)(this.props.Form)){var t=(0,ne.$o)().getItem(ka.N3),n=void 0;t&&(n=JSON.parse(t)),n&&this.props.Form.isFieldReady(F.x.Schema.Id)&&n.indexOf(this.props.Form.Model.Id)?this.props.Form.Model.YouTubeMessageBarState=Fa.E.Closed:this.props.Form.Model.YouTubeMessageBarState=Fa.E.Default}},n}(J.r),Za=e(79873),Xa=function(t){function n(n){var e=t.call(this,n)||this;return e.zk=e.zk.bind(e),e.Qk=e.Qk.bind(e),e}return(0,p.ZT)(n,t),n.prototype.render=function(){this.Uk=this.props.Selected;var t="navbar-button";this.props.Disabled&&(t=(0,N.j)(t,"disabled","highContrast-text-disabled"));var n=y.extend({},this.props.HTMLAttributes),e=this.props.TabName;if((0,vt.tq)()){var i=(0,T.pm)().TabItem_Count_Description.format(this.props.Index+1,this.props.TotalItems);e="".concat(this.props.TabName," ").concat(i)}return g.createElement("div",(0,p.pi)({},n),g.createElement("div",{"aria-disabled":this.props.Disabled,"aria-hidden":this.props.Disabled,"aria-label":e,"aria-posinset":this.props.Index+1,"aria-selected":this.Uk,"aria-setsize":this.props.TotalItems,className:t,id:"navi-item-index-".concat(this.props.Index),onClick:this.zk,onKeyDown:this.Qk,role:"tab",tabIndex:this.props.originAssignments?-1:this.Uk?0:-1,title:this.props.ButtonTitle},this.props.TabName,this.props.NotificationShowedOnTab))},n.prototype.zk=function(){this.props.Disabled||this.props.onClick(this.props.Index)},n.prototype.Qk=function(t){39===t.keyCode&&this.props.Index+1<this.props.TotalItems?Ya(t,"navi-item-index-".concat(this.props.Index),"navi-item-index-".concat(this.props.Index+1)):37===t.keyCode&&this.props.Index-1>=0?Ya(t,"navi-item-index-".concat(this.props.Index),"navi-item-index-".concat(this.props.Index-1)):13!==t.keyCode&&32!==t.keyCode||this.zk()},n}(J.r);function Ya(t,n,e){t.stopPropagation(),t.preventDefault();var i=document.getElementById(n),r=document.getElementById(e);r&&(r.focus(),$(r).attr("tabindex",0),$(i).attr("tabindex",-1))}var tu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){return this.props.children},n}(J.r),nu=function(t){function n(n){var e=t.call(this,n)||this;return e.$k=e.$k.bind(e),e.state={SelectIndex:e.props.DefaultSelectIndex||0},e}return(0,p.ZT)(n,t),n.getNavBarContainer=function(){return $(".navbar-content")},n.prototype.componentWillReceiveProps=function(t){t.DefaultSelectIndex!==this.props.DefaultSelectIndex&&this.setState({SelectIndex:t.DefaultSelectIndex})},n.prototype.render=function(){var t,n=this,e=this.props,i=e.Style,r=e.originAssignmentsCreateQuiz,o=g.Children.toArray(this.props.children).filter((function(t){return t&&t.type===tu})),s=o.map((function(t,e){var s=r?{className:"navbar-item navbar-item-single"}:{className:"navbar-item"},a=n.state.SelectIndex===e;return a&&"ThemeBackground"!==i&&(s.className=(0,N.j)(s.className,"office-form-theme-border-top","office-form-theme-shadow","office-form-theme-primary-foreground is-active")),"ThemeBackground"===i&&(s.className=(0,N.j)(s.className,"office-form-theme-primary-foreground",a&&"office-form-theme-border-bottom-for-mobile is-active")),g.createElement(Xa,{ButtonTitle:t.props.ButtonTitle,Disabled:t.props.Disabled,HTMLAttributes:s,Index:e,key:"tab-control-button-".concat(e),NotificationShowedOnTab:t.props.NotificationShowedOnTab,onClick:n.$k,Selected:a,TabName:t.props.TabName,TotalItems:o.length,originAssignments:r})})),a=this.state.SelectIndex||0,u="navbar-content office-form-page-padding";return"ThemeBackground"===this.props.Style&&(u=(0,N.j)(u,"office-form-nav-bottom-shadow","office-form-theme-primary-foreground")),a>=0&&a<o.length&&(t=o[a]),g.createElement(g.Fragment,null,g.createElement("div",{className:u,role:"navigation"},g.createElement("div",{className:"navbar-items",role:"tablist"},s)),t)},n.prototype.$k=function(t){this.props.onSelectTabChange(t),this.setState({SelectIndex:t})},n}(J.r);Za.r.getNavBarContainer=nu.getNavBarContainer;var eu=e(9743),iu=e(19930),ru=function(){return function(){}}(),ou=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.aggregate=function(t,n){var e=uu(n),i=null==t?void 0:t.quizSummaryData;e&&e.isAverageResultEnabled?n.AverageScore=null==i?void 0:i.averageScore:n.AverageSubmitTime=1e3*(null==i?void 0:i.averageSubmitTimeSeconds),n.TotalResponseCount=(null==i?void 0:i.count)||0,n.IsAggregationReady=!0},n}(ru),su=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.aggregate=function(t,n){var e=null==t?void 0:t.summaryData;n.AverageSubmitTime=1e3*(null==e?void 0:e.averageSubmitTimeSeconds),n.TotalResponseCount=(null==e?void 0:e.count)||0,n.IsAggregationReady=!0},n}(ru),au={AverageSubmitTime:He.J4.number(),FormStatus:He.J4.enumeration((function(){return iu.r})),IsAggregationReady:He.J4.boolean(),IsAggregationFailed:He.J4.boolean(),TotalResponseCount:He.J4.number(),BranchPoint:He.J4.number(),AverageScore:He.J4.number()};function uu(t){return _.d.getObjectMasterFromModel(t)}var cu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.aggregate=function(t){var n=this;this.bulkEdit((function(){(function(t){if(t)return t.SettingMaster.Model.IsQuizMode?new ou:new su})(n.FormMaster).aggregate(t,n.Model),n.Model.FormStatus=n.FormMaster.SettingMaster.getFormStatus(),n.Model.IsAggregationReady=!0})),this.Model.TotalResponseCount!==this.FormMaster.Model.ResponsesCount&&this.FormMaster.getFormResponsesCountByAPICall()},Object.defineProperty(n.prototype,"isAverageResultEnabled",{get:function(){var t=0;return y.forEach(this.FormMaster.Model.Questions,(function(n){n.IsQuiz&&n.Point&&(t+=n.Point)})),this.FormMaster.Model.QuizQuestionsCount>0&&t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"FormMaster",{get:function(){return this.Parent.FormMaster},enumerable:!1,configurable:!0}),n}(_.d.createObjectMasterClass("FormSummaryAggregation",au));var lu,fu=function(){return function(){}}(),hu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.aggregate=function(t,n){if(t){var e=this.jk(t);n.NPSQuestionAggregation={Promoters:e.promoters,Passives:e.passives,Detractors:e.detractors,ResponseCount:t.npsData.count}}else this.setDefaultAggregateToModel(n)},n.prototype.setDefaultAggregateToModel=function(t){t.NPSQuestionAggregation={Promoters:0,Passives:0,Detractors:0,ResponseCount:0}},n.prototype.jk=function(t){var n=t.npsData.distributed,e={promoters:0+n[9]+n[10],passives:0+n[7]+n[8],detractors:t.npsData.distributed.slice(0,7).reduce((function(t,n){return t+n}),0)};return e},n}(fu),du=e(18113),mu=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Wk="answer_other",n}return(0,p.ZT)(n,t),n.prototype.aggregate=function(t,n){t?this.aggregateInternal(t,n):this.setDefaultAggregateToModel(n)},n.prototype.aggregateInternal=function(t,n){var e=_u(n).QuestionMaster,i=n.ChoiceQuestionAggregation;i.ChoiceSummary=_.d.convertToArray(e.Model.Choices).map((function(n){var e=y.find(t.formChoiceData,(function(t){return t.id===n.Description}));return{Choice:(0,du.fq)(n.FormsProDisplayRTText)||n.Description,Count:null==e?0:e.count,IsFormula:n.IsMathOption}}));var r=y.find(t.formChoiceData,(function(t){return"_Other"==t.id}));(r||_u(n).QuestionMaster.Model.AllowOtherAnswer)&&_.d.Collection.addItems(i.ChoiceSummary,[{Choice:this.Wk,Count:r?r.count:0,IsFormula:!1}])},n.prototype.setDefaultAggregateToModel=function(t){var n=_u(t).QuestionMaster,e=t.ChoiceQuestionAggregation;e.ChoiceSummary=_.d.convertToArray(n.Model.Choices).map((function(t){return{Choice:(0,du.fq)(t.FormsProDisplayRTText)||t.Description,Count:0,IsFormula:t.IsMathOption}})),_u(t).QuestionMaster.Model.AllowOtherAnswer&&_.d.Collection.addItems(e.ChoiceSummary,[{Choice:this.Wk,Count:0,IsFormula:!1}])},n}(fu),vu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.aggregateInternal=function(n,e){t.prototype.aggregateInternal.call(this,n,e);var i=n.correctCount,r=n.totalCount;e.GradeStatistics={CorrectCount:i,WrongCount:r-i}},n}(mu),gu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.aggregate=function(t,n){var e=this;if(t){var i=n.DateQuestionAggregation;i.ResponseCount=t.dateData.count,i.TopDate=t.dateData.recentValues.filter((function(t){return null!=t})).map((function(t){return{Id:void 0,Answer:e.Kk(t)}}))}else this.setDefaultAggregateToModel(n)},n.prototype.setDefaultAggregateToModel=function(t){var n=t.DateQuestionAggregation;n.ResponseCount=0,n.TopDate=null},n.prototype.Kk=function(t){var n=(0,X.gC)();return t.length>n.length?Date.parseDate(t,"MM/dd/yyyy hh:mm:ss tt",(0,c.k0)().cultureInfo):Date.parseDate(t,n,(0,c.k0)().cultureInfo)},n}(fu),pu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n}(gu),bu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.aggregate=function(t,n){t?this.aggregateInternal(t,n):this.setDefaultAggregateToModel(n)},n.prototype.setDefaultAggregateToModel=function(t){var n=t.FileUploadQuestionAggregation;n.ResponseCount=0,n.RecentFile=null},n}(fu),yu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.aggregateInternal=function(t,n){var e=n.FileUploadQuestionAggregation,i=t.longTextData;e.ResponseCount=i.count;var r=[];i.recentValues.filter((function(t){return null!=t})).forEach((function(t){t&&JSON.parse(t).reverse().forEach((function(t){r.length<3&&r.push({Answer:t})}))})),e.RecentFile=r},n}(bu),wu=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.choiceIdsIndex={},n.likertStatistics={},n}return(0,p.ZT)(n,t),n.prototype.aggregate=function(t,n){t?(this.initializeDelegator(n),this.aggregateInternal(t,n)):this.setDefaultAggregateToModel(n)},n.prototype.initializeDelegator=function(t){var n=this;this.questionMaster=_u(t).QuestionMaster,this.subQuestions=y.pluck(this.questionMaster.SubQuestionMasters,"Model"),this.choiceGroup=this.questionMaster.Model.ChoiceGroup;var e=[];y.forEach(this.choiceGroup,(function(t,i){n.choiceIdsIndex[t.Id]=i,e.push(0)})),y.forEach(this.subQuestions,(function(t){n.likertStatistics[t.Id]={Name:t.FormsProRTQuestionTitle||t.Title,Statistics:e.slice()}}))},n.prototype.aggregateInternal=function(t,n){var e=this;t.likertChoiceData.forEach((function(t){t.subQuestionData.forEach((function(n){e.likertStatistics[t.subQuesionId].Statistics[e.choiceIdsIndex[n.id]]=n.count}))}));var i=y.map(this.choiceGroup,y.property("Description")),r=y.map(this.choiceGroup,y.property("FormsProDisplayRTText"));i=r.map((function(t,n){return(0,ir.wg)(i[n],(0,du.fq)(t))})),n.LikertQuestionAggregation={Options:i,LikertResults:this.getLikertStatistics()}},n.prototype.setDefaultAggregateToModel=function(t){},n.prototype.getLikertStatistics=function(){var t=this;return y.map(this.subQuestions,(function(n){return{SubQuestionId:n.Id,SubQuestionName:t.likertStatistics[n.Id].Name,Statistics:t.likertStatistics[n.Id].Statistics}}))},n}(fu),Su=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n}(wu),Nu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.aggregate=function(t,n){t?(this.questionMaster=_u(n).QuestionMaster,this.choiceGroup=this.questionMaster.Model.ChoiceGroup,this.aggregateInternal(t,n)):this.setDefaultAggregateToModel(n)},n.prototype.aggregateInternal=function(t,n){var e=this;n.RankingQuestionAggregation=y.map(this.choiceGroup,(function(n){var i=y.find(t.rankingData,(function(t){return t.id===n.Id}));return i=i||{id:n.Id,rankingCount:[]},{Id:n.Id,Name:(0,ir.wg)(n.Description,n.FormsProDisplayRTText),Statistics:e.getRankerStatistics(i),Weight:e.getRankerWeight(i)}})).sort((function(t,n){return n.Weight-t.Weight}))},n.prototype.setDefaultAggregateToModel=function(t){},n}(fu),Cu=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Jk=[],n}return(0,p.ZT)(n,t),n.prototype.aggregateInternal=function(n,e){this.Zk(),t.prototype.aggregateInternal.call(this,n,e);var i=n.correctCount,r=n.totalCount;e.GradeStatistics={CorrectCount:i,WrongCount:r-i}},n.prototype.Zk=function(){var t=this,n=JSON.parse(this.questionMaster.Model.GradingBasis);this.Jk=y.map(Array.apply(null,Array(n.length)),Number.prototype.valueOf,0),y.forEach(this.choiceGroup,(function(e){return t.Jk[n.indexOf(e.Key)]=e.Id}))},n.prototype.getRankerStatistics=function(t){var n=this.Jk.indexOf(t.id)+1,e=y.find(t.rankingCount,(function(t){return t.rank===n})),i=e?e.count:0,r=t.rankingCount.map((function(t){return t.count})).reduce((function(t,n){return t+n}),0);return[i,r-i]},n.prototype.getRankerWeight=function(t){return this.Jk.indexOf(t.id)},n}(Nu),Iu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.aggregate=function(t,n){if(t){var e=n.RatingQuestionAggregation;e.ResponseCount=t.numberData.count,e.AverageRating=t.numberData.average}else this.setDefaultAggregateToModel(n)},n.prototype.setDefaultAggregateToModel=function(t){var n=t.RatingQuestionAggregation;n.ResponseCount=0,n.AverageRating=0},n}(fu),Tu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n}(Iu),ku=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.aggregate=function(t,n){t?this.aggregateInternal(t,n):this.setDefaultAggregateToModel(n)},n.prototype.setDefaultAggregateToModel=function(t){},n}(fu),xu=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Wk="answer_other",n}return(0,p.ZT)(n,t),n.prototype.aggregateInternal=function(t,n){var e=_u(n).QuestionMaster;e.Model.Multiline||!e.hasCorrectAnswers()?this.Xk(t,n):this.Yk(t,n);var i=t.correctCount,r=t.totalCount;n.GradeStatistics={CorrectCount:i,WrongCount:r-i}},n.prototype.Xk=function(t,n){var e=n.TextQuestionAggregation,i=y.first(t.quizTextData).surveyData;e.ResponseCount=i.count,e.TopAnswers=i.recentValues.filter((function(t){return null!=t})).map((function(t){var e;if(n.IsMathQuestion&&"_Other"!=t){var i=(0,tt.d)(t);t=null==i.Answer?t:i.Answer,e=i.IsMath}return{Id:void 0,Answer:t,IsMath:e}}))},n.prototype.Yk=function(t,n){var e=this;n.TextQuestionAggregation.TextSummary=t.quizTextData.map((function(t){var i,r=t.quizData.id;if(n.IsMathQuestion&&"_Other"!=r){var o=(0,tt.d)(r);r=null==o.Answer?r:o.Answer,i=o.IsMath}return{Text:"_Other"==r?e.Wk:r,Count:t.quizData.count,IsMath:i}})).sort((function(t,n){return n.Text==e.Wk?-1:n.Count-t.Count}))},n}(ku),Fu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n}(mu),Pu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n}(gu),Du=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.aggregateInternal=function(t,n){var e=n.FileUploadQuestionAggregation;e.ResponseCount=t.longTextData.count;var i=[];t.longTextData.recentValues.filter((function(t){return null!=t})).forEach((function(t){t&&JSON.parse(t).reverse().forEach((function(t){i.length<3&&i.push({Answer:t})}))})),e.RecentFile=i},n}(bu),Mu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n}(wu),Lu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.nx=function(t,n){var e=y.times(n,y.constant(0));return t.forEach((function(t){t.rank>n?(0,q.zU)("InvalidServerAggregatePayload","Fatal Error: RankingAggregationDelegatorBase.calculateRankerRenct ranker key shouldn't large than rankers count"):e[t.rank-1]=t.count})),e},n.prototype.getRankerStatistics=function(t){return this.nx(t.rankingCount,this.choiceGroup.length)},n.prototype.getRankerWeight=function(t){var n=this.choiceGroup.length;return t.rankingCount.map((function(t){return t.count*(n-t.rank)})).reduce((function(t,n){return t+n}),0)},n}(Nu),Ru=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n}(Iu),Au=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.aggregateInternal=function(t,n){var e=n.TextQuestionAggregation;e.ResponseCount=t.textData.count,e.TopAnswers=t.textData.recentValues.filter((function(t){return null!=t})).map((function(t){return{Id:void 0,Answer:t,IsMath:void 0}}))},n}(ku);function Eu(t,n){var e=function(t,n){if(t===lu.Quiz)switch(n){case"Question.Choice":return vu;case"Question.DateTime":return pu;case"Question.FileUpload":return yu;case"Question.MatrixChoiceGroup":return Su;case"Question.Ranking":return Cu;case"Question.Rating":return Tu;case"Question.TextField":return xu;case"Question.NPS":return hu}else if(t===lu.Survey)switch(n){case"Question.Choice":return Fu;case"Question.DateTime":return Pu;case"Question.FileUpload":return Du;case"Question.MatrixChoiceGroup":return Mu;case"Question.Ranking":return Lu;case"Question.Rating":return Ru;case"Question.TextField":return Au;case"Question.NPS":return hu}}(n,t);if(!e)throw Error(t+" is not supported");return new e}!function(t){t.Survey="Survey",t.Quiz="Quiz"}(lu||(lu={}));var Ou={QuestionId:He.J4.create(He.J4.string(),{IsKeyField:!0}),IsAggregationReady:He.J4.boolean(),IsAggregationFailed:He.J4.boolean(),IsMathQuestion:He.J4.boolean(),ChoiceQuestionAggregation:He.J4.create({ChoiceSummary:He.J4.collectionOf({Choice:He.J4.string(),Count:He.J4.number(),IsFormula:He.J4.boolean()})}),TextQuestionAggregation:He.J4.create({TopAnswers:He.J4.collectionOf({Id:He.J4.number(),Answer:He.J4.string(),IsMath:He.J4.boolean()}),ResponseCount:He.J4.number(),TextSummary:He.J4.collectionOf({Text:He.J4.string(),Count:He.J4.number(),IsMath:He.J4.boolean()})}),RatingQuestionAggregation:He.J4.create({AverageRating:He.J4.number(),ResponseCount:He.J4.number()}),DateQuestionAggregation:He.J4.create({TopDate:He.J4.collectionOf({Id:He.J4.number(),Answer:He.J4.reference()}),ResponseCount:He.J4.number()}),RankingQuestionAggregation:He.J4.collectionOf({Id:He.J4.number(),Name:He.J4.string(),Statistics:He.J4.collectionOf(He.J4.number()),Weight:He.J4.number()}),LikertQuestionAggregation:He.J4.create({Options:He.J4.collectionOf(He.J4.string()),LikertResults:He.J4.collectionOf({SubQuestionId:He.J4.string(),SubQuestionName:He.J4.string(),Statistics:He.J4.collectionOf(He.J4.number())})}),FileUploadQuestionAggregation:He.J4.create({RecentFile:He.J4.collectionOf({Answer:He.J4.string()}),ResponseCount:He.J4.number()}),NPSQuestionAggregation:He.J4.create({Promoters:He.J4.number(),Passives:He.J4.number(),Detractors:He.J4.number(),ResponseCount:He.J4.number()}),GradeStatistics:He.J4.create({CorrectCount:He.J4.number(),WrongCount:He.J4.number()})};function _u(t){return _.d.getObjectMasterFromModel(t)}var Bu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.getIoCQuestionMaster=function(){throw new Error("Method not implemented.")},n.prototype.aggregate=function(t){var n=this;this.bulkEdit((function(){var e=n.FormMaster.Model.Settings.IsQuizMode?lu.Quiz:lu.Survey;Eu(n.QuestionType,e).aggregate(t,n.Model)}))},Object.defineProperty(n.prototype,"FormMaster",{get:function(){return this.Parent.Parent.FormMaster},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"QuestionMaster",{get:function(){return this.FormMaster.getQuestionById(this.Model.QuestionId)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"QuestionType",{get:function(){return this.QuestionMaster.Model.Type},enumerable:!1,configurable:!0}),n}(_.d.createObjectMasterClass("QuestionAggregation",Ou)),Hu={SummaryAggregation:He.J4.fromMasterClass((function(){return cu})),QuestionAggregations:He.J4.collectionOf((function(){return Bu}))};function Gu(t){return{SummaryAggregation:{AverageSubmitTime:0,FormStatus:t.SettingMaster.getFormStatus(),IsAggregationReady:!1,TotalResponseCount:t.Model.ResponsesCount},QuestionAggregations:y.map(t.Model.Questions,(function(t){return{IsAggregationReady:!1,QuestionId:t.Id,IsMathQuestion:t.IsMathQuiz}}))}}function qu(t){if("poll"===t.Model.Type){var n=t.Model.Questions;return _.d.convertToArray(n).some((function(t){return t.IsQuiz}))}return t.SettingMaster.Model.IsQuizMode}var Vu=function(t){function n(n){var e=t.call(this,{InitialData:Gu(n)})||this;return e.ix=[],e.ox=function(){return e.sx()},e.ux=function(t){e.bulkEdit((function(){var n,i=[];_.d.convertToArray(t.RemovedModels).forEach((function(t){var n=_.d.Collection.getItemWithKeyFields(e.Model.QuestionAggregations,{QuestionId:t.Id});i.push(n)})),_.d.Collection.deleteItems(e.Model.QuestionAggregations,i);var r=_.d.convertToArray(t.AddedModels).map((function(t){return t.Id}));n=_.d.convertToArray(Gu(e.FormMaster).QuestionAggregations).filter((function(t){return r.some((function(n){return n===t.QuestionId}))})),_.d.Collection.addItems(e.Model.QuestionAggregations,n)})),e.FormMaster.Model.Settings.IsQuizMode&&t.RemovedModels.length?e.sx():(t.RemovedModels.length||t.AddedModels.length)&&e.hx()},e.mx=function(){return e.hx()},e.vx=function(){return e.sx()},e.nn=n,e.yx().then((function(t){(0,K.ZV)(t)||e.wx(t)})),e.ix.length>0&&(e.ix=[]),e.Sx(),e}return(0,p.ZT)(n,t),Object.defineProperty(n.prototype,"FormMaster",{get:function(){return this.nn},enumerable:!1,configurable:!0}),n.prototype.terminateSync=function(){this.ix=[]},n.prototype.release=function(){var t=this;this.FormMaster&&(this.FormMaster.unobserve(this.ox),_.d.getCollectionMasterFromModel(this.FormMaster.Model.Questions).unobserve(this.ux),y.forEach(this.FormMaster.Model.Questions,(function(n){var e=t.FormMaster.getQuestionById(n.Id);e.unobserve(t.vx),e.unobserve(t.mx)})))},n.prototype.yx=function(){var t=this;return(0,q.$U)(this.FormMaster.SyncContext===eu.y.AnalysisTimeForm?"AnalysisPage.Responses.StartGetResponses":"DesignPage.Responses.StartGetResponses"),Fs((0,rn.dg)()),this.FormMaster.existingOnServerSide().then((function(){return t.serverAggregateAPI(t.FormMaster.Model.Id)})).then((function(n){return t.Nx=n,t.Cx(),n})).catch((function(n){return Fs(null),(0,q.zU)("ResposnesAggregateFailure",{Message:"FormAggregationMaster.getAggregateData: get aggregate data failed: ".concat(n)}),(0,K.ZV)(n)?n:((0,Zs.bh)("Aggregate",n,t.FormMaster.Model.Id),t.Ix(),null)}))},Object.defineProperty(n.prototype,"serverAggregateAPI",{get:function(){return this.FormMaster.SyncContext==eu.y.AnalysisTimeForm?qu(this.FormMaster)?mi.Ah:mi.tx:qu(this.FormMaster)?mi.zg:mi.GI},enumerable:!1,configurable:!0}),n.prototype.Ix=function(){uu(this.Model.SummaryAggregation).Model.IsAggregationFailed=!0,y.each(this.Model.QuestionAggregations,(function(t){t.IsAggregationFailed=!0}))},n.prototype.Cx=function(){uu(this.Model.SummaryAggregation).Model.IsAggregationFailed=!1,y.each(this.Model.QuestionAggregations,(function(t){t.IsAggregationFailed=!1}))},n.prototype.wx=function(t){var n=this,e=y.find(t,(function(t){return"quizSummaryData"===t.aggregationDataType||"summaryData"===t.aggregationDataType})),i=uu(this.Model.SummaryAggregation);i.Model.IsAggregationFailed||i.aggregate(e),y.each(this.Model.QuestionAggregations,(function(i){var r=n.FormMaster.getQuestionById(i.QuestionId);if(!i.IsAggregationFailed){if(!r.Model.GroupId){var o=void 0;if(o="Question.MatrixChoiceGroup"===r.Model.Type?n.Tx(r,t):y.find(t,(function(t){return t.columnPropertyName===i.QuestionId})),"Question.TextField"==r.Model.Type&&r.Model.IsMathQuiz){o=n.kx(r,o);var s=e,a=o;a&&(a.quizSummaryData.averageScore/=s.quizSummaryData.count,s.quizSummaryData.averageScore+=a.quizSummaryData.averageScore,n.Model.SummaryAggregation.AverageScore=s.quizSummaryData.averageScore)}_u(i).aggregate(o)}i.IsAggregationReady=!0}}));var r=Ps();if(r){var o=this.FormMaster.SyncContext===eu.y.AnalysisTimeForm?"Share":"Survey";(0,q.in)("Endpoint.".concat(o,"AnalysisPage"),{timeToSpin:window.performance.timing.domInteractive-window.performance.timing.navigationStart,timeToChrome:Ts,timeToContentReady:(0,rn.dg)()-r}),Fs(null)}},n.prototype.Tx=function(t,n){var e=t.SubQuestionMasters.map((function(t){return t.Model.Id})),i=n.filter((function(t){return-1!==e.indexOf(t.columnPropertyName)}));if(i.length)return i[0].likertChoiceData=[],i.reduce((function(t,n){var e={subQuesionId:n.columnPropertyName,subQuestionData:n.choiceData};return t.likertChoiceData.push(e),t}),i[0])},n.prototype.kx=function(t,n){var e=new it.E(t.Model).getAnswers(),i=n;if(i&&i.quizTextData&&e.length>0&&!t.Model.Multiline){var r=[];i.quizTextData.forEach((function(t){if(t.quizData&&t.quizData.id){var n=(0,tt.d)(t.quizData.id),e=null==n.Answer?t.quizData.id:n.Answer;if(r.length>0){var i=y.find(r,(function(t){if(t.quizData&&t.quizData.id){var n=(0,tt.d)(t.quizData.id),i=null==n.Answer?t.quizData.id:n.Answer;if(e.trim().toUpperCase()===i.trim().toUpperCase())return!0}}));null!=i?i.quizData.count+=t.quizData.count:r.push(t)}else r.push(t)}})),i.correctCount=0,i.quizSummaryData.averageScore=0;var o=r.filter((function(n){if(n.quizData&&n.quizData.id){var r=(0,tt.d)(n.quizData.id),o=null==r.Answer?n.quizData.id:r.Answer;return""===o?(i.totalCount-=n.quizData.count,!1):(null!=y.find(e,(function(t){return t.answer.trim().toUpperCase()===o.trim().toUpperCase()}))&&(i.correctCount+=n.quizData.count,i.quizSummaryData.averageScore+=n.quizData.count*t.Model.Point),!0)}}));i.quizTextData=o}return i},n.prototype.hx=function(){var t=this;null!=this.Nx&&(this.bulkEdit((function(){t.Model=Gu(t.nn)})),this.wx(this.Nx))},n.prototype.sx=function(){var t=this;this.FormMaster.SyncContext!=eu.y.AnalysisTimeForm&&(this.ix.length>0||this.ix.push(this.xx().then((function(){return t.ix.pop()}))))},n.prototype.xx=function(){var t=this;return new Promise((function(e){window.setTimeout((function(){t.bulkEdit((function(){t.Model=Gu(t.nn)})),t.yx().then((function(n){return t.wx(n)})),e()}),n.freezingTime)}))},n.prototype.Sx=function(){var t=this;this.FormMaster.observe(this.ox,[this.FormMaster.Schema.ResponsesCount]),_.d.getCollectionMasterFromModel(this.FormMaster.Model.Questions).observe(this.ux);var n=(0,k.zE)();y.forEach(this.FormMaster.Model.Questions,(function(e){var i=t.FormMaster.getQuestionById(e.Id);switch(i.observe(t.mx,[n.Schema.Title]),i.Model.Type){case"Question.Choice":i.observe(t.FormMaster.Model.Settings.IsQuizMode?t.vx:t.mx,[n.Schema.Choices,n.Schema.AllowOtherAnswer,n.Schema.ChoiceType]);break;case"Question.Ranking":i.observe(t.vx,[n.Schema.ChoiceGroup])}}))},n.freezingTime=2e3,n}(_.d.createObjectMasterClass("FormAggregation",Hu)),zu=function(){function t(){}return t.GoBackToReleaseResults="GoBackToReleaseResults",t.GoBackToAnalysis="GoBackToAnalysis",t.ByStudent={View:"Student",Index:0,GoBackToView:t.GoBackToAnalysis},t.ByQuestion={View:"Question",Index:0,GoBackToView:t.GoBackToAnalysis},t}(),Qu=e(71683),Uu=function(){function t(){}return Object.defineProperty(t,"fieldPrefix",{get:function(){return"field_"},enumerable:!1,configurable:!0}),t.createAnalyzeViewData=function(n){return new Promise((function(e,i){y.defer((function(){var i=n.FormElementManager.TopQuestionMasters.map((function(n,e){return{Index:e,Field:t.createIQuestionInfoField(n.Model),Model:n.Model,Master:n}})),r=y.map(n.Model.Responses,(function(e,i){var r=t.getResponseWithIndexableQuestion(e,n);return r.field_created_time=e.StartDate.toString(),r.field_modified_time=e.SubmitDate.toString(),r.field_responder=e.Responder,r.field_responder_name=e.ResponderName?e.ResponderName:e.Responder,r}));e({Questions:i,Answers:r,Analyses:t.analyzeReponse(i,r),Changed:!0})}))}))},t.createIQuestionInfoField=function(n){return t.fieldPrefix+n.Id.replace(/-/g,"")},t.getResponseWithIndexableQuestion=function(t,n){var e={};return y.forEach(t.Answers,(function(t){var i=n.getQuestionById(t.QuestionId);if(i){var r="field_"+t.QuestionId.replace(/-/g,"");e[r]=t.Answer;var o=i.Model.Type;if(o===M.getElementTypeName()&&t.Answer){var s=Date.parseDate(t.Answer,(0,X.gC)(),(0,c.k0)().cultureInfo);e[r]=s.toDateShortString((0,c.k0)().cultureInfo)}else if(i.isNumberType())e[r]=(0,tt.d)(t.Answer);else if((o===st.getElementTypeName()||o===Y.L.getElementTypeName())&&i.Model.IsMathQuiz){e[r+"_math"]=t.IsMathAnswer}}})),e.field_id=t.Id,e},t.analyzeReponse=function(n,e){var i=this,r={};return n.forEach((function(n){switch(n.Model.Type){case"Question.Choice":var o=new Object,s=new Object,a={correct:0,wrong:0};y.forEach(n.Model.Choices,(function(t){o[t.Description]=0,s[t.Description]=t.IsMathOption}));var u=y.filter(n.Model.Choices,(function(t){return t.IsAnswerKey})).map((function(t){return t.Description})).sort();e.map((function(t){return t[n.Field]})).map((function(t){var e=(0,Y.P)(t,n.Model);e.IsLegacyChoiceAnswer&&(0,q.$U)("DesignPage.Responses.MeetLegacyChoiceAnswer"),e.SelectedOptions.forEach((function(t){o[t]=o[t]||0,++o[t]})),y.isEqual(u,e.SelectedOptions.sort())?++a.correct:++a.wrong}));var c=[];for(var l in o)l&&c.push({Title:l,Data:o[l],IsMath:s[l]});r[n.Field]={options:i.calculateOthers(c),gradeResults:a};break;case"Question.Rating":var f,h=0,d=0;e.forEach((function(t){t[n.Field]&&(h++,d+=t[n.Field])})),f=0===h?0:Math.round(d/h*100)/100,r[n.Field]={count:h,averageRating:f};break;case"Question.TextField":if(n.Master.hasCorrectAnswers()){var m=new it.E(n.Model),v=new Object,g={correct:0,wrong:0};y.forEach(m.getAnswers(),(function(t){v[t.answer]=0}));var p=[];e.forEach((function(e){if(t.hasValidAnswer(e,n)){var i=String(e[n.Field]);p.push(i)}})),p.map((function(t){v[t]=v[t]||0,v[t]++,m.isCorrect(t)?++g.correct:++g.wrong}));var b=[];for(var w in v)v.hasOwnProperty(w)&&w&&b.push({Title:w,Data:v[w],IsMath:!1});r[n.Field]={options:i.calculateOthers(b),gradeResults:g};break}var S,N,C,I=[],T=0,k=0;e.forEach((function(e){t.hasValidAnswer(e,n)&&(n.Model.IsNumber&&y.isNumber(e[n.Field])&&(k++,T+=e[n.Field]),I.push(e[n.Field]))})),S=I.length,C=0===k?0:T/k,N=S<=3?I:I.slice(S-3),r[n.Field]={count:S,recentAnswers:N,averageResult:Math.round(100*C)/100};break;case"Question.DateTime":var x,F,P=[];e.forEach((function(t){t[n.Field]&&P.push(t[n.Field])})),F=(x=P.length)<=3?P:P.slice(x-3),r[n.Field]={count:x,recentAnswers:F};break;case"Question.Ranking":var D,M=n.Master.Model.ChoiceGroup,L={},R=M.length,A=[],E={correct:0,wrong:0},O=n.Model.GradingBasis;n.Model.IsQuiz?(D=JSON.parse(O),y.forEach(M,(function(t,n){var i=t.Id;A.push(i),L[i]={description:t.Description,total:e.length,data:y.map(Array.apply(null,Array(R)),Number.prototype.valueOf,0),score:0},D[D.indexOf(t.Key)]=i}))):y.forEach(M,(function(t){var n=t.Id;A.push(n),L[n]={description:t.Description,total:e.length,data:y.map(Array.apply(null,Array(R)),Number.prototype.valueOf,0),score:0}})),e.map((function(t){var e=t[n.Field];if(e&&e.length>0){var i=e.sort((function(t,n){return t.answerOrder-n.answerOrder})).map((function(t){return t.id}));y.isEqual(D,i)?++E.correct:++E.wrong,i.forEach((function(t,n){var e=L[t];e&&n<R&&(e.data[n]++,e.score+=R-n)}))}else++E.wrong}));var _=[];if(n.Model.IsQuiz)for(var B=0;B<D.length;B++)_.push({Title:L[D[B]].description,Data:L[D[B]].data,Score:L[D[B]].score,Total:L[D[B]].total});else for(var H in L)_.push({Title:L[H].description,Data:L[H].data,Score:L[H].score,Total:L[H].total});r[n.Field]={rankResults:_,gradeResults:E};break;default:r[n.Field]=void 0}})),r},t.calculateOthers=function(t){var n=0;if(t=t.sort((function(t,n){return n.Data-t.Data})),t.length>10){var e=t.length-10+1;t.splice(9).forEach((function(t){return n+=t.Data})),t.push({Title:(0,T.pm)().AnalyzeView_Chart_Others.format(e),Data:n,IsMath:!1})}return t},t.hasValidAnswer=function(t,n){var e=function(n){return null!=t[n]&&""!==t[n]&&t[n].toString().length},i=n.Master.SubQuestionMasters;if(i.length>0){var r=y.map(i,(function(t){return"field_"+t.Model.Id}));return y.filter(r,e).length>0}return e(n.Field)},t.getBranchedQuestions=function(n,e){var i=n.FormElementManager.QuestionMasters;if(i&&e&&i[0])return e.map((function(e){var i=t.getBranchedQuestionsV2(n,e);return{field_id:e.field_id,branchedQuestions:i.map((function(t){return t.Model}))}}))},t.getBranchedQuestionsV2=function(t,n){var e=t.FormElementManager.getSectionNodes(),i=[];return Qu.X.getBranchedSections(e,(function(t,e){var i=e.indexOf(t)+1,r=e[i];return t.getBranchedResult(n["field_"+t.Model.Id],r)})).forEach((function(t){t.TopQuestionMasters.forEach((function(t){i.push(t),t.SubQuestionMasters.forEach((function(t){i.push(t)}))}))})),i},t}(),$u=e(22707),ju=e(87941),Wu=e(77494),Ku=e(69856),Ju={InsightCount:He.J4.number(),IsReady:He.J4.boolean()};var Zu=function(t){function n(n){var e=t.call(this,{InitialData:{InsightCount:0,IsReady:!1}})||this;return e.Je=n,e.Fx=[],e}return(0,p.ZT)(n,t),Object.defineProperty(n.prototype,"Insights",{get:function(){return this.Fx},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"FormMaster",{get:function(){return this.Je},enumerable:!1,configurable:!0}),n.prototype.loadInsight=function(){this.Dx()},n.prototype.isValidFormScenario=function(){return y.any(this.Je.Model.Questions,(function(t){var n=t.QuestionTagForIntelligence;return!!n&&n.indexOf("ScenarioTag")>=0}))},n.prototype.hasPinnedInsightOnForm=function(){if(this.Model.IsReady&&this.Je.Model.FormsInsightsInfo){var t=JSON.parse(this.Je.Model.FormsInsightsInfo);if((null==t?void 0:t.PinedInsights)&&t.PinedInsights.length>0&&y.find(this.Insights,(function(n){return y.contains(t.PinedInsights,n.InsightId)})))return!0}return!1},n.prototype.logSeen=function(){var t=y.map(this.Fx,(function(t){return t.CalculationQuestion})),n=_.d.convertToArray(this.Je.Model.Questions);n=y.sortBy(n,(function(t){return t.Order}));var e=y.map(t,(function(t){var e=y.findIndex(n,(function(n){return n.Id===t.Id}));return"Page".concat(Math.floor(e/2)+1)})),i={AssociationRuleInsightCount:this.Fx.filter((function(t){return t.Type===Ku.d.AssociationRuleInsight})).length,RatingDistributionInsightCount:this.Fx.filter((function(t){return t.Type===Ku.d.RatingDistributionAnalysisInsight})).length,SentimentInsightCount:this.Fx.filter((function(t){return t.Type===Ku.d.ResponseSentimentInsight})).length,WordCloudInsightCount:this.Fx.filter((function(t){return t.Type===Ku.d.ResponseWordCloudInsight})).length,Distribution:y.uniq(e)};(0,q.$U)("Intelligence.Insights.Seen",i)},n.prototype.logAddressable=function(){var t=this.Je.Model.ResponsesCount;if(0!==t){var n=y.groupBy(this.Je.Model.Questions,(function(t){return t.Type})),e="";y.each(n,(function(t){t&&t.length>0&&(e+=t[0].Type+","+t.length+";")})),e.length>0&&(0,q.$U)("Intelligence.Insights.Addressable",{QuestionType:e,RspCount:t})}},n.prototype.logEngage=function(t,n,e,i,r,o){void 0===n&&(n=[]),void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=0),void 0===o&&(o=null);var s=n.length>0?n[0]:"",a=y.find(this.Insights,(function(t){return t.InsightId===s}));(0,q.$U)("Intelligence.Insights.Engage",{Duration:i,InsightType:null==a?void 0:a.Type,SubActionType:t,QuestionId:o});var u={AdoptedCandidates:"Explore"!==t&&"LoadMore"!==t?n:[r.toString()],Candidates:n,SuggestionId:e};h.Pv.Resolve("IFormUserContextActionSignal").addUserActionSignal("".concat(Gi.l_[Gi.l_.Insights],".").concat(t),6,u,!1)},n.prototype.logHasReomovedInsight=function(){var t,n=this,e=[];if(this.Je.Model.FormsInsightsInfo){var i=JSON.parse(this.Je.Model.FormsInsightsInfo);(null===(t=null==i?void 0:i.PinedInsights)||void 0===t?void 0:t.length)&&(e=i.PinedInsights)}var r=_.d.convertToArray(this.Je.Model.Questions);y.forEach(r,(function(t){if(t.InsightsInfo&&"None"!==t.InsightsInfo){var n=JSON.parse(t.InsightsInfo);(null==n?void 0:n.PinedInsights)&&n.PinedInsights.length>0&&(e=y.union(e,n.PinedInsights))}})),!e.length||this.Fx.length&&!y.some(e,(function(t){return!y.find(n.Insights,(function(n){return n.InsightId===t}))}))||(0,q.$U)("Intelligence.Insights.Removed")},n.prototype.Mx=function(){var t=this.Je.Model.FormsInsightsInfo;if(t){var n=JSON.parse(t);if(n.PinedInsights&&n.PinedInsights.length>0)return!0}var e=_.d.convertToArray(this.Je.Model.Questions);return y.any(e,(function(t){if(t.InsightsInfo&&"None"!==t.InsightsInfo){var n=JSON.parse(t.InsightsInfo);if(n.PinedInsights&&n.PinedInsights.length>0)return!0}}))},n.prototype.Dx=function(){var t=this;this.Je.ensureReadyToDesign().then((function(){var n=t.Je.Model;t.logAddressable(),((0,I.cr)("GetRealtimeInsights")||t.Mx()?(0,I.cr)("GetInsightNewApi")?t.IntelligenceProvider.getIntelligenceInsights(n.Id,n.ResponsesCount):t.IntelligenceProvider.getOrCalculateInteractiveInsights(n.Id):t.IntelligenceProvider.getCachedInsights(n.Id)).then((function(n){var e=n.filter((function(t){switch(t.Type){case Ku.d.AssociationRuleInsight:case Ku.d.ResponseSentimentInsight:case Ku.d.ResponseWordCloudInsight:case Ku.d.RatingDistributionAnalysisInsight:return!0;default:return!1}})).sort((function(t,n){return n.Type-t.Type}));t.bulkEdit((function(){t.Fx=e,t.Model.InsightCount=e.length,t.Model.IsReady=!0})),t.Fx.length>0&&t.logSeen(),(0,I.cr)("AutoPinWordCloudInsight")&&t.Lx(),t.logHasReomovedInsight()})).catch((function(){t.Model.IsReady=!0}))}))},n.prototype.Lx=function(){var t,n=this,e=this.Fx;if(e&&e.length>0&&(null===(t=this.Je)||void 0===t?void 0:t.Model)){var i=e.filter((function(t){return t.Type===Ku.d.ResponseWordCloudInsight}));if(!i.length)return;var r=[];if(this.Je.Model.FormsInsightsInfo&&"None"!==this.Je.Model.FormsInsightsInfo){var o=JSON.parse(this.Je.Model.FormsInsightsInfo);(null==o?void 0:o.PinedInsights)&&(r=o.PinedInsights)}y.forEach(this.Je.Model.Questions,(function(t,e){var o=y.find(i,(function(n){return n.CalculationQuestion.Id===t.Id})),s=null==o?void 0:o.InsightId;if(s){var a=t.InsightsInfo&&"None"!==t.InsightsInfo?JSON.parse(t.InsightsInfo):null,u=(null==a?void 0:a.AutoPinnedInsights)?a.AutoPinnedInsights:[],c=(null==a?void 0:a.PinedInsights)?a.PinedInsights:[],l=!1;y.contains(u,s)||(y.contains(r,s)&&y.contains(c,s)||(c.push(s),l=!0),u.push(s),a={AutoPinnedInsights:u.length>0?u:null,PinedInsights:c.length>0?c:null},n.Je.Model.Questions[e].InsightsInfo=JSON.stringify(a),(0,q.$U)("Intelligence.Insights.AutoPin",{pinInsightChanged:l}))}}))}},Object.defineProperty(n.prototype,"IntelligenceProvider",{get:function(){if(!this.di){var t=(0,Xn.kc)(this.Je.Model.Id),n=t.IsGroupOwner?3:2;this.di=Ro.A.createIntelligenceProvider(n,t.OrgId,t.OwnerId)}return this.di},enumerable:!1,configurable:!0}),n}(_.d.createObjectMasterClass("FormInsight",Ju)),Xu=e(99374);function Yu(t,n){return{Name:n,Type:t}}function tc(t){return y.filter(t.Model.PermissionTokens,(function(t){return"AnalyzerToken"===t.Type&&t.Name===(0,X.dD)()}))[0]}var nc=e(37944),ec=/('[^']*'|"[^"]*")/g,ic=/('[^']*'|"[^"]*"|d{1,2}|M{1,2}|y{2,4}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|t{2})/g;function rc(t,n){var e=t.toString();if(t<0)return e;if(n&&n>e.length)for(;n>e.length;)e="0"+e;return e}function oc(t){return ec.test(t)?t.substr(1,t.length-2):t}function sc(t,n){return function(t,n,e){return null==t||null==n?null:n.split(ic).map((function(n){switch(n){case"d":case"dd":return rc(t.getDate(),n.length);case"ddd":return null==e?void 0:e.DateTimeFormat.AbbreviatedDayNames[t.getDay()];case"M":case"MM":return rc(t.getMonth()+1,n.length);case"MMM":return null==e?void 0:e.DateTimeFormat.AbbreviatedMonthNames[t.getMonth()];case"yy":var i=t.getFullYear(),r=rc(i,4);return i>(null==e?void 0:e.Calendar.TwoDigitYearMax)-100&&i<=(null==e?void 0:e.Calendar.TwoDigitYearMax)?r.slice(2):r;case"yyy":case"yyyy":case"yyyyy":return rc(t.getFullYear(),n.length);case"H":case"HH":return rc(t.getHours(),n.length);case"h":case"hh":return rc((t.getHours()+11)%12+1,n.length);case"m":case"mm":return rc(t.getMinutes(),n.length);case"s":case"ss":return rc(t.getSeconds(),n.length);case"t":case"tt":var o=t.getHours()<12?null==e?void 0:e.DateTimeFormat.AMDesignator:null==e?void 0:e.DateTimeFormat.PMDesignator;return 1===n.length?o.charAt(0):o;default:return oc(n)}})).join("")}(t,n.DateTimeFormat.ShortDatePattern,n)}var ac,uc={$CsvInfo:{EstimateTimeInMinutes:He.J4.number(),FileExpireUtcTime:He.J4.string(),FileGenerateUtcTime:He.J4.string(),FileName:He.J4.string(),FileSize:He.J4.number(),GenerateStatus:He.J4.number(),TotalResponseCount:He.J4.number()},$CsvLink:He.J4.string()},cc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n}(_.d.createObjectMasterClass("WarmColdMaster",uc));function lc(t){void 0===t&&(t={});var n=Date.now();O365Shell.NFD.OnFeedbackMetadataRequested((function(e,i){var r=Er();return r.createScreenshot(document.body,{backgroundColor:Vi.Ej}).then((function(t){var n=t.toDataURL("image/jpeg");i(n)})),t&&(r.initOptions=(0,p.pi)((0,p.pi)({},r.initOptions),{telemetryGroup:(0,p.pi)((0,p.pi)({},r.initOptions.telemetryGroup),t.telemetryGroup)})),e.options=(0,p.pi)((0,p.pi)((0,p.pi)({},e.options||{}),r.initOptions),{userVoiceEnabled:!1,disableIncludeScreenshot:!1,disableScreenshotPreview:!0}),(0,q.$U)("DesignPage.RenderOCVFeedback",{duration:Date.now()-n}),e})),window.O365Shell.NFD.OpenFeedback(),(0,q.$U)("DesignPage.Feedback.Navigate")}var fc,hc,dc,mc="downloadcsv-icon-container",vc=function(){return g.createElement("span",{className:mc},g.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},g.createElement("path",{d:"M18.2498 20.4999C18.664 20.4998 19 20.8355 19 21.2497C19 21.6639 18.6644 21.9998 18.2502 21.9999L5.25022 22.0037C4.836 22.0038 4.5 21.6681 4.5 21.2539C4.5 20.8397 4.83557 20.5038 5.24978 20.5037L18.2498 20.4999ZM11.6482 2.01173L11.75 2.00488C12.1297 2.00488 12.4435 2.28704 12.4932 2.65311L12.5 2.75488L12.499 16.4399L16.2208 12.7196C16.4871 12.4533 16.9038 12.4291 17.1974 12.647L17.2815 12.7197C17.5477 12.986 17.5719 13.4026 17.354 13.6962L17.2814 13.7803L12.2837 18.7769C12.0176 19.043 11.6012 19.0673 11.3076 18.8498L11.2235 18.7772L6.22003 13.7806C5.92694 13.4879 5.92661 13.0131 6.21931 12.72C6.48539 12.4535 6.90204 12.429 7.1958 12.6467L7.27997 12.7192L10.999 16.4329L11 2.75488C11 2.37519 11.2822 2.06139 11.6482 2.01173L11.75 2.00488L11.6482 2.01173Z"})))},gc=function(){return g.createElement("span",{className:mc},g.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},g.createElement("path",{d:"M20.0256 12.1922C19.8772 12.4296 19.6806 12.6332 19.4486 12.7899L13.3987 16.8736C12.5535 17.4441 11.4465 17.4441 10.6013 16.8736L4.55142 12.7899C3.79043 12.2762 3.49533 11.3306 3.77229 10.5003L10.6132 15.0598C11.4005 15.5847 12.4112 15.6175 13.2264 15.1582L13.3867 15.0598L20.2271 10.4998C20.4088 11.0459 20.3545 11.666 20.0256 12.1922ZM20.2271 13.7498C20.4088 14.2959 20.3545 14.916 20.0256 15.4422C19.8772 15.6796 19.6806 15.8832 19.4486 16.0399L13.3987 20.1236C12.5535 20.6941 11.4465 20.6941 10.6013 20.1236L4.55142 16.0399C3.79043 15.5262 3.49533 14.5806 3.77229 13.7503L10.6132 18.3098C11.4005 18.8347 12.4112 18.8675 13.2264 18.4082L13.3867 18.3098L20.2271 13.7498ZM13.3867 3.42476L19.7519 7.66821C20.2115 7.97456 20.3356 8.59543 20.0293 9.05496C19.956 9.16481 19.8618 9.25907 19.7519 9.33231L13.3867 13.5758C12.547 14.1356 11.453 14.1356 10.6132 13.5758L4.24807 9.33231C3.78854 9.02595 3.66437 8.40509 3.97072 7.94556C4.04396 7.8357 4.13822 7.74144 4.24807 7.66821L10.6132 3.42476C11.453 2.86492 12.547 2.86492 13.3867 3.42476ZM11.5608 4.60648L11.4453 4.67283L5.705 8.50026L11.4453 12.3277C11.7439 12.5267 12.1228 12.5488 12.4392 12.394L12.5547 12.3277L18.294 8.50026L12.5547 4.67283C12.2561 4.47378 11.8772 4.45166 11.5608 4.60648Z"})))},pc=function(){return g.createElement("span",{className:mc},g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},g.createElement("path",{d:"M1115 1024l690 691-90 90-691-690-691 690-90-90 690-691-690-691 90-90 691 690 691-690 90 90-690 691z"})))},bc=function(){return g.createElement("span",{className:mc},g.createElement("svg",{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},g.createElement("path",{d:"M8.75 12C9.9926 12 11 13.0074 11 14.25V15.752L10.9921 15.8604C10.6814 17.9866 8.7715 19.009 5.56679 19.009C2.37361 19.009 0.4333 17.9983 0.0144601 15.8966L0 15.75V14.25C0 13.0074 1.00736 12 2.25 12H8.75ZM8.75 13.5H2.25C1.83579 13.5 1.5 13.8358 1.5 14.25V15.6704C1.77979 16.8708 3.05063 17.509 5.56679 17.509C8.0829 17.509 9.2966 16.8777 9.5 15.6932V14.25C9.5 13.8358 9.1642 13.5 8.75 13.5ZM5.5 4C7.433 4 9 5.567 9 7.5C9 9.433 7.433 11 5.5 11C3.567 11 2 9.433 2 7.5C2 5.567 3.567 4 5.5 4ZM17.75 0C18.9926 0 20 1.00736 20 2.25V5.75C20 6.99264 18.9926 8 17.75 8H16.2951L14.1286 10.1414C13.6375 10.6266 12.846 10.6219 12.3608 10.1308C12.1296 9.8968 12 9.5812 12 9.2526L11.9994 7.9862C10.8747 7.86155 10 6.90792 10 5.75V2.25C10 1.00736 11.0074 0 12.25 0H17.75ZM5.5 5.5C4.39543 5.5 3.5 6.39543 3.5 7.5C3.5 8.6046 4.39543 9.5 5.5 9.5C6.60457 9.5 7.5 8.6046 7.5 7.5C7.5 6.39543 6.60457 5.5 5.5 5.5ZM17.75 1.5H12.25C11.8358 1.5 11.5 1.83579 11.5 2.25V5.75C11.5 6.16421 11.8358 6.5 12.25 6.5H13.4986L13.4997 8.6539L15.6789 6.5H17.75C18.1642 6.5 18.5 6.16421 18.5 5.75V2.25C18.5 1.83579 18.1642 1.5 17.75 1.5Z"})))},yc=function(t){function n(n){return t.call(this,n)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=(0,T.pm)(),n=!(0,vt.tq)(),e={$modal:"downloadcsv-dialog-modal",$overlay:"downloadcsv-dialog-overlay",$root:"downloadcsv-dialog-container",$header:"downloadcsv-dialog-header",$title:"downloadcsv-dialog-title",$dismiss:"downloadcsv-dialog-dismiss",$content:"downloadcsv-dialog-content",$buttonContainer:"downloadcsv-dialog-button-container",$buttonStack:"downloadcsv-dialog-button-stack",$defaultButton:n?"downloadcsv-dialog-default-button":"office-form-theme-primary-foreground",$primaryButton:n?"office-form-theme-button downloadcsv-dialog-primary-button":"office-form-theme-primary-foreground"};return g.createElement("div",{className:e.$modal},g.createElement("div",{className:e.$overlay,"aria-hidden":!0}),g.createElement("div",{className:e.$root},g.createElement("div",{className:e.$header},g.createElement("div",{className:e.$title},this.props.$title),n&&g.createElement("div",{className:e.$dismiss},g.createElement("button",{onClick:this.props.$onDismiss,role:"button",autoFocus:!0,"aria-label":t.Common_DismissButton},g.createElement(pc,null)))),g.createElement("div",{className:e.$content},g.createElement("span",null,this.props.$subText)),g.createElement("div",{className:e.$buttonContainer},g.createElement("div",{className:e.$buttonStack},this.props.$defaultButtonText&&g.createElement("button",{"aria-label":"".concat(this.props.$title," ").concat(this.props.$subText," ").concat(this.props.$defaultButtonText),className:e.$defaultButton,onClick:this.props.$onConfirm},this.props.$defaultButtonText),this.props.$primaryButtonText&&g.createElement("button",{"aria-label":"".concat(this.props.$title," ").concat(this.props.$subText," ").concat(this.props.$primaryButtonText),className:e.$primaryButton,onClick:this.props.$onDismiss},this.props.$primaryButtonText)))))},n.prototype.componentDidMount=function(){(0,kr.mZ)(b.findDOMNode(this))},n}(J.r);!function(t){t[t.Prepare=0]="Prepare",t[t.Generating=1]="Generating",t[t.Completed=2]="Completed"}(fc||(fc={})),function(t){t[t.IsGenerating=0]="IsGenerating",t[t.IsGenerated=1]="IsGenerated"}(hc||(hc={})),function(t){t[t.Hours=0]="Hours",t[t.Minutes=1]="Minutes"}(dc||(dc={}));var wc=function(t){var n,e=(0,T.pm)(),i="downloadcsv-container",r="download-to-local-button",o="downloadcsv-title",s="progress-indicator",a="download-description",u="download-descriptionLine",l="cancel-download-Button",f="latest-response-button",h="downloadcsv-feedback-container",d="feedback-button-content",m=g.useState(e.Start_Download_CSV_New),v=m[0],b=m[1],y=g.useState(void 0),w=y[0],S=y[1],N=g.useState(0),C=N[0],I=N[1],k=g.useState(!1),x=k[0],F=k[1],P=g.useState(!1),D=P[0],M=P[1],L=g.useState(0),R=L[0],A=L[1],E=g.useState(!0),O=E[0],_=E[1],B=(ac||(ac=new cc),ac),H=(n=g.useState(!1)[1],g.useCallback((function(){return n((function(t){return!t}))}),[])),G=t.$form,V=t.$isMovingResponseData,z=G.Model.Id,Q=B.Model.$CsvInfo,U=Q.FileName,$=Q.GenerateStatus,j=Q.TotalResponseCount,W=G.Model.ResponsesCount+G.Model.ArchivedRowCount!==j,K=Math.ceil(Q.EstimateTimeInMinutes),J=new Date(Q.FileGenerateUtcTime),Z=(0,c.k0)().cultureInfo,X=e.RelativeDate_TimeDayOfWeek.format(sc(J,Z),J.toTimeShortString(Z)),Y=new Date(Q.FileExpireUtcTime).getTime(),tt=g.useMemo((function(){var t=36e5,n=Y-Date.now();return n<t?(A(1),parseInt((n/6e4).toString())):(A(0),parseInt((n/t).toString()))}),[Y]),nt=g.useMemo((function(){var t=1024,n=Q.FileSize*t;return n>t?e.Commen_Text_FileSize_MB.format(Math.round(n/t)):e.Commen_Text_FileSize_KB.format(Math.round(n))}),[e,Q.FileSize]),et=g.useMemo((function(){return(0,mi.lK)(G)}),[G]),it=g.useCallback((function(t){et.getCSVInfo(t).then((function(t){B.Model.$CsvInfo=t.length>0?t[0]:{},_(!1)}))}),[B,et]),rt=g.useCallback((function(t){et.deleteCSVFile(t).then((function(){it(t)}))}),[et,it]),ot=g.useCallback((function(t){et.generateCSVFile(t).finally((function(){it(t)}))}),[et,it]),st=g.useCallback((function(t){et.getCSVDownloadLink(t).then((function(t){window.location.href=t}))}),[et]),at=g.useCallback((function(){B.Model.$CsvLink=""}),[B]),ut=g.useCallback((function(t){return(0,p.mG)(void 0,void 0,void 0,(function(){return(0,p.Jh)(this,(function(n){return et.deleteCSVFile(t).then((function(){at(),ot({$formId:t.$formId})})),[2]}))}))}),[et,at,ot]);g.useEffect((function(){return B.observe(H,[B.Schema.$CsvInfo,B.Schema.$CsvLink]),function(){B.unobserve(H)}}),[B,H]),g.useEffect((function(){!V&&it({$formId:z})}),[V,z,it]),g.useEffect((function(){"number"==typeof $?1===$?(I(2),b(e.Button_Get_Latest_Responses),M(!1),x&&!(0,vt.tq)()&&(st({$formId:z,$fileName:U}),(0,q.$U)("WarmToCold.AutoDownloadCSV"))):0===$&&(I(1),b(e.Common_Cancel_Text),F(!0),M(!1)):(I(0),b(e.Start_Download_CSV_New))}),[e,$,U,z,x,st]);var ct=g.useCallback((function(){1===$?ut({$fileName:U,$formId:z}):ot({$formId:z}),M(!0)}),[$,U,z,ut,ot]);g.useEffect((function(){if(1===C){var t=setInterval((function(){(!$&&0!==$||1===$)&&clearInterval(t),it({$formId:z})}),6e4);return function(){return clearInterval(t)}}}),[$,z,C,it]);var lt=g.useCallback((function(){var t={$onConfirm:function(){rt({$fileName:U,$formId:z}),I(0),b(e.Start_Download_CSV_New),S(void 0)},$onDismiss:function(){return S(void 0)},$title:e.Common_Cancel_Text,$subText:1===K?e.Cancel_Download_Subtitle_One_Minute:e.Cancel_Download_Subtitle_New.format(K),$defaultButtonText:e.Button_Cancel_Generation,$primaryButtonText:e.Button_Continue};S(g.createElement(yc,(0,p.pi)({},t)))}),[e,U,z,K,rt]),ft=g.useCallback((function(){if(0===C||2===C)ct();else{if(1!==C)return;lt()}}),[C,ct,lt]),ht=g.useCallback((function(){st({$formId:z,$fileName:U}),(0,q.$U)("WarmToCold.ClickDownloadLink")}),[z,U,st]),dt=g.useCallback((function(){lc({telemetryGroup:{featureArea:"Forms/DownloadCSV"}})}),[]),mt=e.AnalyzeView_NumberOfResponses_AccessibilityLabel.format(j),gt=0===R?e.Generate_Expires_Hours.format(tt):e.Generate_Expires_Mins.format(tt),pt=1===K?e.Preparing_File_One_Minute_New:e.Preparing_File_New.format(K);return O&&!V?null:g.createElement(g.Fragment,null,g.createElement("div",{className:i},g.createElement("div",{"aria-label":e.Download_All_Responses,className:o},g.createElement("span",null,e.Download_All_Responses)),D&&g.createElement("div",{className:s},g.createElement(qa.P,(0,p.pi)({},{ClassName:"designPage-response-downloadcsv-spinner",Ignorable:!1})),g.createElement("span",null,e.Common_Loading_Text)),!D&&1===C&&g.createElement("div",{className:s},g.createElement("div",{"aria-label":pt},g.createElement(nc.H,{$html:pt}),g.createElement("button",{className:l,onClick:ft},v))),!D&&2===C&&g.createElement(g.Fragment,null,g.createElement("button",{"aria-label":e.Download_To_Local_New,className:r,onClick:ht},g.createElement(vc,null),g.createElement("span",null,e.Download_To_Local_New),g.createElement("span",null,nt)),g.createElement("div",{className:a},g.createElement("span",{"aria-label":mt},mt),g.createElement("span",{className:u},"|"),g.createElement("span",{"aria-label":X},X),g.createElement("span",{"aria-label":gt},gt))),!D&&0===C&&g.createElement("button",{className:"".concat(V?"":"office-form-theme-button"," primary-download-button "),disabled:V,onClick:ft},g.createElement("div",null,v)),!D&&2===C&&W&&g.createElement("button",{className:f,onClick:ft},v),w),g.createElement("div",{className:h},g.createElement("button",{onClick:dt},g.createElement(bc,null),g.createElement("span",{className:d},e.GradingView_GiveFeedbackButton_Label))))},Sc=function(){var t=(0,T.pm)(),n="downloadcsv-messagebar-container",e="downloadcsv-messagebar-messageBar",i="downloadcsv-messagebar-icon",r="downloadcsv-messagebar-content",o="downloadcsv-messagebar-dismiss",s=g.useState(!0),a=s[0],u=s[1],c=g.useCallback((function(){u(!1)}),[]);return a&&g.createElement("div",{className:n},g.createElement("div",{className:"".concat(e)},g.createElement("div",{className:i},g.createElement(gc,null)),g.createElement("div",{className:r},t.Form_Response_Quota_Message),g.createElement("div",{className:o},g.createElement("button",{"aria-label":"".concat(t.Form_Response_Quota_Message," ").concat(t.Common_DismissButton),onClick:c,role:"button",title:t.Common_DismissButton},g.createElement(pc,null)))))};var Nc=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Rx=function(){return n.forceUpdate()},n}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){(0,ws.b4)().observe(this.Rx,[ws.TS.Schema.ExportToExcelCalloutVersion])},n.prototype.componentWillUnmount=function(){(0,ws.b4)().unobserve(this.Rx)},n.prototype.render=function(){var t=(0,ws.b4)().Model;if((0,ws.OT)(t.ExportToExcelCalloutVersion)){var n=(0,Bs.Bi)((0,zi.Jn)("/Images/export-to-excel.gif"),null,Bs.Mb),e=(0,Bs.yM)((function(){return t.ExportToExcelCalloutVersion=ws.BT.toString()}));return(0,Bs.dq)(n,e,"teachingCallout-exportToExcel","teachingCallout-exportToExcel-direction",(0,T.pm)().TeachingUI_Export_To_Excel)}return null},n}(J.r);var Cc=function(){function t(t,n){if(this.Ax="DownloadExcel",this.Ex="DownloadFileSize",this.Ox=1500,this._x=5e3,this.form=t,this.Hx=[],this.Gx=!1,this.Vx()){var e=parseInt((0,gt.NW)()[this.Ex]);this._x=e}else if(this.form.isFieldReady(this.form.Schema.Id)){var i=parseInt((0,ne.G)().getItem("".concat(this.Ax,"-").concat(this.form.Model.Id)));i&&(this._x=i)}n&&(this.Ux=n)}return Object.defineProperty(t.prototype,"TotalFileCount",{get:function(){return this.$x},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.jx()?this.Wx({innerCode:10204,failureType:"ExpectedFailure"}):this.Gx||((0,q.$U)("DesignPage.Responses.DownloadExcelFileStart",{totalResponseCountRange:Math.ceil(this.form.Model.ResponsesCount/this._x),isQuiz:this.form.SettingMaster.Model.IsQuizMode,isIos:this.jx()}),this.Gx=!0,this.nt=(new Date).getTime(),this.Kx())},t.prototype.logDownloadStatus=function(t,n){(0,q.$U)(t,{ErrorCode:n,fileCount:Math.ceil(this.form.Model.ResponsesCount/this._x),timeCost:(new Date).getTime()-this.nt,isQuiz:this.form.SettingMaster.Model.IsQuizMode})},t.prototype.stop=function(){this.Gx=!1,this.Hx=[],this.Jx&&this.Jx()},t.prototype.downloadAllResponses=function(){this.Zx(),this.start()},t.prototype.observeEveryDownloadComplete=function(t){this.Xx=t},t.prototype.observeStop=function(t){this.Jx=t},t.prototype.shouldForceToDownloadExcel=function(){return this.Vx()},t.prototype.Zx=function(){var t=this.form.Model.ResponsesCount;this.$x=Math.ceil(t/this._x),this.finishedDownloadFileCount=0,this.Hx=[];for(var n=1;n<=t;n+=this._x)this.Hx.push({minResponseId:n,maxResponseId:Math.min(n+this._x-1,t)})},t.prototype.Vx=function(){var t=parseInt((0,gt.NW)()[this.Ex]);return!isNaN(t)&&t>0},t.prototype.Kx=function(){var t=this;if(this.Gx)if(this.$x>this.Hx.length&&this.Xx&&(this.finishedDownloadFileCount=this.$x-this.Hx.length,this.Xx()),this.Hx.length>0){var n=this.Hx.shift();window.setTimeout((function(){return t.Yx(n.minResponseId,n.maxResponseId)}))}else this.logDownloadStatus("DesignPage.Responses.DownloadExcelFileSuccess",10220),this.stop()},t.prototype.tF=function(t){!this.Vx()&&t>=1e3&&this.form.isFieldReady(this.form.Schema.Id)&&(this._x=100*Math.ceil(t/200),(0,ne.G)().setItem("".concat(this.Ax,"-").concat(this.form.Model.Id),this._x.toString()))},t.prototype.Yx=function(n,e){var i=this;(0,q.$U)("DesignPage.Responses.DownloadOnePagingExcelFile"),(0,Zs.qU)("DownloadExcelFile"),window.clearTimeout(t.hideErrorBarMessageTimeout),t.hideErrorBarMessageTimeout=null,this.form.downloadExcelFile(n,e).then((function(){(0,Zs.qU)("DownloadExcelFile"),i.Kx()})).catch((function(t){switch(i.stop(),i.logDownloadStatus("DesignPage.Responses.DownloadExcelFileFailed",t.innerCode),t.innerCode){case 10206:i._x=i.Ox,i.Wx(t);break;case 10208:i.Ux?i.Ux(2):i.nF("DownloadExcelLimitReached");break;case 10209:if(i.Ux){i.Ux(3),window.setTimeout((function(){i.Ux(0)}),5e3)}else{var r=(0,Ct.vj)("DownloadExcelThrottleMessageBarDelayTime",3e3);window.setTimeout((function(){i.nF("DownloadExcelVMLimitReached")}),r)}break;case 10210:i.tF(e-n+1),t.innerCode=10203,i.Wx(t);break;default:i.Wx(t)}}))},t.prototype.Wx=function(n){(0,Zs.bh)("DownloadExcelFile",n&&{statusCode:n.statusCode,statusText:n.statusText,type:n.failureType,innerCode:n.innerCode,innerMessage:n.innerMessage,correlationId:n.correlationId,isServerError:!0}),t.hideErrorBarMessageTimeout=window.setTimeout((function(){(0,Zs.qU)("DownloadExcelFile"),t.hideErrorBarMessageTimeout=null}),1e4)},t.prototype.nF=function(n){(0,Zs.Yb)(n),t.hideErrorBarMessageTimeout=window.setTimeout((function(){(0,Zs.XA)(),t.hideErrorBarMessageTimeout=null}),5e3)},t.prototype.jx=function(){var t=window.navigator.platform.toLocaleLowerCase(),n=window.navigator.userAgent.toLocaleLowerCase();return t.match(/iphone|ipod|ipad/)||n.match(/iphone|ipod|ipad/)},t}(),Ic=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),Object.defineProperty(n.prototype,"DownloadExcelProcessor",{get:function(){return this.eF=this.eF||(t=this.props.Form,n=this.props.showExcelThrottleDialog,new Cc(t,n));var t,n},enumerable:!1,configurable:!0}),n.prototype.shouldExportExcelToOneDrive=function(){return!(0,S.ro)()&&(!this.props.Form.Model.Settings.IsQuizMode&&(!this.DownloadExcelProcessor.shouldForceToDownloadExcel()&&((0,ri.Fd)()||!!this.props.Form.Model.XlWorkbookId)))},n.prototype.onExportExcel=function(){(0,q.$U)("DesignPage.Responses.OpenInExcel",{xlworkbookid:this.props.Form.Model.XlWorkbookId}),this.shouldExportExcelToOneDrive()?(this.iF(),(0,ws.b4)().Model.ExportToExcelCalloutVersion=Bs.BT.toString()):((0,q.$U)("DesignPage.Responses.DownloadMultipleExcelFiles"),this.DownloadExcelProcessor.downloadAllResponses())},n.prototype.iF=function(){var t=this;(0,q.$U)("DesignPage.Responses.OpenExcelInOneDrive"),this.props.Form.ensureFieldsReady([F.x.Schema.Id]).then((function(){(0,ju.U8)(t.props.Form.Model.Id,!1)}))},n}(J.r),Tc=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.rF=(0,k.f5)(),n.sF=function(){n.state.IsPreparingFile&&n.forceUpdate()},n.aF=function(){n.props.Form.ensureFieldsReady([F.x.Schema.XlExportingLocalTag]).then((function(){var t=!1;n.props.Form.IsExporting()?t=!0:n.props.Form.IsExportingFailed()&&n.state.IsPreparingFile&&(0,Zs.bh)("ReexportToExcelFile",{innerCode:10205}),n.setState({IsPreparingFile:t})}))},n.uF=function(){return n.setState({IsPreparingFile:!1})},n.cF=function(){return n.forceUpdate()},n.lF=function(){return n.fF()},n.hF=function(){return n.dF()},n.vF=function(){return n.pF()},n.yF=function(t){return n.wF(t)},n}return(0,p.ZT)(n,t),n.prototype.showExcelThrottleDialog=function(t){this.props.showExcelThrottleDialog(t)},n.prototype.componentDidMount=function(){var t=this;this.SF=this.SF.bind(this),this.props.Form.ensureFieldsReady([F.x.Schema.Id]).then((function(){t.DownloadExcelProcessor.observeEveryDownloadComplete(t.sF),t.DownloadExcelProcessor.observeStop(t.uF)}));var n=F.x.Schema;this.props.Form.observe(this.aF,[n.XlExportingLocalTag]),this.props.Form.observe(this.cF,[n.XlFileUnsynced]),this.rF.observe(this.SF,[this.rF.Schema.ExecuteDownloadExcel])},n.prototype.componentWillUnmount=function(){this.props.Form.unobserve(this.aF),this.rF.unobserve(this.SF),(0,Zs.qU)("ReexportToExcelFile")},n.prototype.render=function(){return g.createElement("div",null,this.CF(),this.IF(),this.TF(),this.xF())},n.prototype.CF=function(){var n,e,i,r=this;if(this.state.IsPreparingFile)return null;var o=t.prototype.shouldExportExcelToOneDrive.call(this);this.props.Form.Model.XlFileUnsynced&&o?(n=g.createElement("span",{key:"alert",className:"export-to-excel-button-alert"}),e=this.lF,i=(0,T.pm)().AnalyzeView_Export_Excel_File_Unsynced_Alert):(e=function(){return r.FF(r.hF)},i=(0,T.pm)().AnalyzeView_Export_Excel);var s={title:i,className:"analyze-view-export-button-container",onClick:e,disabled:!this.props.Form.isFieldReady(F.x.Schema.Id)||this.props.Form.Model.ResponsesCount<=0&&!o};return(0,z.F)({HTMLAttributes:s,Icon:o?"exportOnedriveIcon":"ExcelLogo",IconClassName:"forms-icon-size24x24",Text:(0,T.pm)().AnalyzeView_Export_Excel,TextClassName:"analyze-view-export-button-label",ButtonStyle:1,GlyphButtonStyle:"Horizontal",children:n})},n.prototype.FF=function(t){var n=(0,Ct.vj)("DownloadExcelThrottleLevel",0);this.shouldExportExcelToOneDrive()||1!==n?t():this.showExcelThrottleDialog(1)},n.prototype.TF=function(){return!this.state.IsPreparingFile&&this.shouldExportExcelToOneDrive()?(t={},g.createElement(Nc,(0,p.pi)({},t))):null;var t},n.prototype.xF=function(){return this.state.IsPreparingFile?(n=t.prototype.shouldExportExcelToOneDrive.call(this)?(0,T.pm)().ReExportToExcel_Loading_Message:this.DownloadExcelProcessor.TotalFileCount>1?(0,T.pm)().DownloadExcel_Preparing_For_Multiple_File.format(this.DownloadExcelProcessor.finishedDownloadFileCount,this.DownloadExcelProcessor.TotalFileCount):(0,T.pm)().DownloadExcel_Preparing_For_Single_File,g.createElement("div",{role:"alert"},this.PF(),g.createElement("span",{className:"download-excel-progress-description"},n))):null;var n},n.prototype.PF=function(){return g.createElement(qa.P,(0,p.pi)({},{ClassName:"download-excel-loading-container"}))},n.prototype.IF=function(){if(this.state.ShowAlertCallout){var t=(0,T.pm)();return g.createElement("div",{className:"export-button-alert-callout",onBlur:this.yF,ref:"alert-callout",tabIndex:-1},g.createElement("div",{className:"unsynced-message"},t.AnalyzeView_Export_Excel_File_Unsynced_Alert),g.createElement("button",{className:"analyze-view-link-button reexport-link",onClick:this.vF,ref:"alert-link"},g.createElement("span",null,t.AnalyzeView_Export_Excel_File_Reexport)))}},n.prototype.fF=function(){(0,k.f5)().Model.ShowXLUnsyncedDialog=!0},n.prototype.SF=function(){this.rF.Model.ExecuteDownloadExcel&&(this.dF(),this.rF.Model.ExecuteDownloadExcel=!1)},n.prototype.dF=function(){this.shouldExportExcelToOneDrive()||this.setState({IsPreparingFile:!0}),t.prototype.onExportExcel.call(this)},n.prototype.wF=function(t){var n=(0,Ir.y3)(t),e=b.findDOMNode(this.refs["alert-callout"]);e&&!e.contains(n)&&this.setState({ShowAlertCallout:!1})},n.prototype.pF=function(){(0,ju.Wr)(this.props.Form.Model.Id,!1),this.setState({ShowAlertCallout:!1,IsPreparingFile:!0})},n}(Ic);var kc=function(t){function n(n){var e=t.call(this,n)||this;return e.DF=(0,k.f5)().Model,e}return(0,p.ZT)(n,t),n.prototype.render=function(){switch(this.props.throttleDialogType){case 1:return this.LF();case 2:return this.AF();case 3:return g.createElement("div",{className:"openinexcel-throttle-reachvmlimitation-message-container"},(t=(0,T.pm)().XLThrottleDialog_VMReachedLimitation_Message,n=(0,V.M)({FluentIcon:"Warning",HTMLAttributes:{className:"openinexcel-throttle-vmlimitation-alart-icon forms-icon-size16x16"}}),g.createElement("div",{className:"openinexcel-throttle-reachvmlimitation-title-container",role:"alert"},n,g.createElement("span",{className:"openinexcel-throttle-reachvmlimitation-title"},t))),g.createElement("div",{className:"openinexcel-throttle-reachvmlimitation-linebreak"}));default:return null}var t,n},n.prototype.LF=function(){return 1===(0,Ct.vj)("DownloadExcelThrottleLevel",0)?g.createElement("div",{className:"openinexcel-throttle-predialog-container"},this.EF()):null},n.prototype.AF=function(){return g.createElement("div",{className:"openinexcel-throttle-predialog-container"},this.OF())},n.prototype.EF=function(){var t=this,n={ButtonsProps:[{ClassName:"openinexcel-throttle-continue-button",GlyphButtonStyle:"Horizontal",Key:"continueItem",onClick:function(){t.props.showExcelThrottleDialog(0),t.DF.ExecuteDownloadExcel=!0},Text:(0,T.pm)().Common_Yes_Text,Title:(0,T.pm)().Common_Yes_Text},{ClassName:"openinexcel-throttle-cancel-button",GlyphButtonStyle:"Horizontal",Key:"cancelItem",onClick:function(){t.props.showExcelThrottleDialog(0)},Text:(0,T.pm)().XLThrottleDialog_StrictMode_CancelButton,Title:(0,T.pm)().Designer_Cancel_Text}],ClassName:"openinexcel-throttle-button-container",Description:(0,T.pm)().XLThrottleDialog_StrictMode_Content,key:"deleteConfirmDialog",ShowDialog:!0};return g.createElement("div",{className:"openinexcel-throttle-dialog-container"},xc(!0),this._F(),(0,je.s)(n))},n.prototype.OF=function(){var t=this,n={ButtonsProps:[{ClassName:"openinexcel-throttle-gotit-button",GlyphButtonStyle:"Horizontal",Key:"gotItItem",onClick:function(){t.props.showExcelThrottleDialog(0)},Text:(0,T.pm)().TeachingUi_GotIt,Title:(0,T.pm)().TeachingUi_GotIt}],ClassName:"openinexcel-throttle-button-container",Description:(0,T.pm)().XLThrottleDialog_OwnerReachedLimitation_Content,key:"deleteConfirmDialog",ShowDialog:!0};return g.createElement("div",{className:"openinexcel-throttle-dialog-container"},xc(!1),this.HF(),(0,je.s)(n))},n.prototype._F=function(){var t=this;return(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"openinexcel-throttle-dialog-close-button",onClick:function(){t.props.showExcelThrottleDialog(0)}},FluentIcon:"Dismiss",IconClassName:"openinexcel-throttle-dialog-close-icon forms-icon-size16x16",Text:(0,T.pm)().Common_Close_Text})},n.prototype.HF=function(){var t=this;return(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"openinexcel-throttle-dialog-close-button",onClick:function(){t.props.showExcelThrottleDialog(0)},title:(0,T.pm)().Common_Close_Text},FluentIcon:"Dismiss",IconClassName:"openinexcel-throttle-dialog-close-icon forms-icon-size16x16"})},n}(J.r);function xc(t){var n=(0,T.pm)().XLThrottleDialog_OwnerReachedLimitation_Title,e="openinexcel-throttle-reachlimitation-title";t&&(n=(0,T.pm)().XLThrottleDialog_StrictMode_Title,e="openinexcel-throttle-strictmodeconfirm-title");var i=(0,V.M)({FluentIcon:"Warning",HTMLAttributes:{className:"office-form-alert-icon forms-icon-size20x20"}});return g.createElement("div",{className:"openinexcel-throttle-reachlimitation-title-container",role:"alert"},t?null:i,g.createElement("span",{className:e},n))}var Fc=["#1F77B4","#EB7005","#2CA02C","#D62728","#9467BD","#8C564B","#D347A9","#7F7F7F","#A2951A","#29A2AE"],Pc=["#BC3B03","#E65722","#EB7005","#FF993E","#C2885B","#939393","#708090","#5C97BF","#2A7AB0","#1460AA","#004980"];function Dc(t){return Mc(t,Pc)}function Mc(t,n){return n[t%n.length]}function Lc(t,n){return y.isEqual(t.labelName,n.labelName)&&y.isEqual(t.lableClass,n.lableClass)&&y.isEqual(t.labelData,n.labelData)}var Rc=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.qF=[],n}return(0,p.ZT)(n,t),n.prototype.render=function(){return this.VF()?g.createElement("div",{"aria-label":(0,T.pm)().ChartControl_GroupContainer,className:"chart-control-container"},this.zF(),this.QF()):null},n.prototype.componentDidMount=function(){this.$F()},n.prototype.shouldComponentUpdate=function(t){return!function(t,n){if(!(y.isEqual(t.Animation,n.Animation)&&y.isEqual(t.Data,n.Data)&&y.isEqual(t.HasLegend,n.HasLegend)&&y.isEqual(t.TagLabels,n.TagLabels)&&y.isEqual(t.Type,n.Type)))return!1;if(!t.Labels&&!n.Labels)return!0;if(t.Labels&&n.Labels&&t.Labels.length===n.Labels.length){for(var e=0;e<t.Labels.length;e++)if(!Lc(t.Labels[e],n.Labels[e]))return!1;return!0}return!1}(this.props,t)||!this.jF},n.prototype.componentDidUpdate=function(){this.$F()},n.prototype.componentWillUnmount=function(){this.WF()},n.prototype.VF=function(){return this.props.Labels&&this.props.Data&&this.props.Labels.length===this.props.Data.data.length&&this.props.Labels.length>0},n.prototype.WF=function(){this.JF&&(this.JF.destroy(),this.JF=null)},n.prototype.$F=function(){if(this.VF()){var t=b.findDOMNode(this.refs.canvas);if(this.jF=$(t).is(":visible"),this.jF){var n=t.getContext("2d");if(n)switch(this.ZF(),this.props.Type){case 0:this.YF(n),this.tP();break;case 1:this.eP(n),this.tP()}}}},n.prototype.iP=function(){if(this.props.Labels)return this.props.Labels.map((function(t,n){return null!=t.labelName?(0,ir.Mw)(t.labelName,!0):(0,T.pm)().Designer_Choices_DefaultDescription.format(n+1)}))},n.prototype.YF=function(t){var n="'Segoe UI','Segoe WP',Tahoma, Arial, sans-serif",e={responsive:!1,layout:{padding:{left:10}},animation:{duration:1e3},scales:{yAxes:[{ticks:{fontSize:10,min:0,fontFamily:n,fontColor:Vi.ft,callback:function(t){if(+t%1==0)return t}}}],xAxes:[{ticks:{fontSize:10,fontFamily:n,fontColor:Vi.ft,callback:function(){return""}}}]},legend:{display:!1}};this.WF(),this.JF=new Chart(t,{type:"bar",data:this.rP(),options:e})},n.prototype.ZF=function(){var t=this;this.oP=this.props.Data.data.map((function(n,e){var i=function(t){return Mc(t,Fc)}(e);return t.qF.push(t.sP(i,10)),i}))},n.prototype.rP=function(){return{labels:this.iP(),datasets:[{backgroundColor:this.oP,data:this.props.Data.data,hoverBackgroundColor:this.qF}]}},n.prototype.eP=function(t){var n={responsive:!1,animation:{duration:1e3},cutoutPercentage:0,tooltips:{callbacks:{label:function(t,n){return n.labels[t.index]+": "+n.datasets[t.datasetIndex].data[t.index]+" ("+Math.round(this._active[0]._view.circumference/6.283*100)+"%)"}}},legend:{display:!1}};this.WF(),this.JF=new Chart(t,{type:"pie",data:this.rP(),options:n})},n.prototype.sP=function(t,n){var e=parseInt(t.slice(1),16),i=Math.round(2.55*n),r=(e>>16)+i,o=(e>>8&255)+i,s=(255&e)+i;return"#"+(16777216+65536*(r<255?r<1?0:r:255)+256*(o<255?o<1?0:o:255)+(s<255?s<1?0:s:255)).toString(16).slice(1)},n.prototype.tP=function(){var t=this;if(this.props.HasLegend){var n=b.findDOMNode(this.refs["legend-table"]),e=b.findDOMNode(this.refs["legend-table-tbody"]).childNodes;e&&e.length>0&&(y.each(e,(function(n,e){Chart.helpers.addEvent(n,"mouseover",(function(){t.aP("mouseover",e)}));var i=n.getElementsByClassName("chart-control-legend-canvas-color");if(i){var r=i[0].getContext("2d");r.fillStyle=t.JF.data.datasets[0].backgroundColor[e],r.beginPath(),r.arc(7.5,7.5,7.5,0,2*Math.PI,!0),r.closePath(),r.fill()}})),Chart.helpers.addEvent(n,"mouseout",(function(){t.aP("mouseout",0)})))}},n.prototype.aP=function(t,n){var e=this.JF.getDatasetMeta&&this.JF.getDatasetMeta(0)&&this.JF.getDatasetMeta(0).data[n];this.JF.active=e&&"mouseout"===t?[]:[e],this.JF.lastActive=this.JF.lastActive||[],this.JF.lastActive.length&&this.JF.updateHoverStyle(this.JF.lastActive,this.JF.options.hover.mode,!1),this.JF.active.length&&this.JF.updateHoverStyle(this.JF.active,this.JF.options.hover.mode,!0);var i=!Chart.helpers.arrayEquals(this.JF.active,this.JF.lastActive);if(i){this.JF.lastActive=this.JF.active;var r=this.JF.tooltip;r._active=this.JF.active,r._lastActive=r._lastActive||[],r.update(!0),r.pivot();var o=this.JF._bufferedRequest;o?this.JF.render(o.duration,o.lazy):i&&!this.JF.animating&&(this.JF.stop(),this.JF.render(this.JF.options.hover.animationDuration,!0)),this.JF._bufferedRender=!1,this.JF._bufferedRequest=null}},n.prototype.zF=function(){var t=this;if(this.props.HasLegend){return g.createElement("div",{"aria-label":(0,T.pm)().ChartControl_LegendGroup,className:"chart-control-legend",tabIndex:-1},g.createElement("table",{className:"chart-control-legend-table",ref:"legend-table"},g.createElement("tbody",{ref:"legend-table-tbody",role:"list"},this.props.Labels.map((function(n,e){var i="".concat(n.labelName,". ").concat((0,T.pm)().AnalyzeView_NumberOfResponses_AccessibilityLabel.format(n.labelData));return t.props.TagLabels[n.labelName]&&(i=(0,T.pm)().Common_Labels_CommaSeparated.format(i,(0,T.pm)().Quiz_CorrectAnswer)),g.createElement("tr",{className:"chart-control-legend-table-row ".concat(n.lableClass),key:e,role:"listitem","aria-label":i},g.createElement("td",{role:"presentation"},g.createElement("canvas",{role:"presentation",className:"chart-control-legend-canvas-color",width:"15px",height:"15px"})),g.createElement("td",{"aria-hidden":!0,role:"presentation",className:"chart-control-legend-label"},null!=n.displayElement?n.displayElement:g.createElement(cr.D,{Text:n.labelName,RenderMode:"RichText",ContainsHtml:!0})),g.createElement("td",{className:"chart-control-legend-value",onClick:n.onClick},n.labelData,n.onClick&&g.createElement("span",{"aria-hidden":!0}," >")),t.uP(n.labelName))})))))}},n.prototype.QF=function(){var t,n=(0,vt.fM)()<400||(0,vt.tq)(),e=n?187:250,i=n?300:400;return t=0===this.props.Type?{className:"chart-control-canvas",width:i,height:e,ref:"canvas","aria-label":(0,T.pm)().ChartControl_AriaLabel}:{className:"",width:300,height:150,ref:"canvas","aria-label":(0,T.pm)().ChartControl_AriaLabel},g.createElement("div",(0,p.pi)({},{className:"chart-control",tabIndex:-1}),g.createElement("canvas",(0,p.pi)({},t)))},n.prototype.uP=function(t){var n;return this.props.TagLabels[t]&&(n=g.createElement(V.F,{FluentIcon:"Checkmark",HTMLAttributes:{className:"forms-icon-size14x14"}})),g.createElement("td",(0,p.pi)({},{role:"presentation",className:"chart-control-legend-table-correct"}),n)},n}(J.r);function Ac(){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(149).then(e.bind(e,91882))];case 1:return[2,{default:t.sent().InsightsPinedView}]}}))}))}function Ec(t){var n=(0,$i.J)(Ec,Ac);return g.createElement(Ui.Z,null,g.createElement(n,(0,p.pi)({},t)))}function Oc(){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(149).then(e.bind(e,94516))];case 1:return[2,{default:t.sent().InsightsExploreView}]}}))}))}function _c(t){var n=(0,$i.J)(_c,Oc);return g.createElement(Ui.Z,null,g.createElement(n,(0,p.pi)({},t)))}function Bc(){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(149).then(e.bind(e,4834))];case 1:return[2,{default:t.sent().SurveyAnalyzeViewSummaryInsightPanel}]}}))}))}function Hc(t){var n=(0,$i.J)(Hc,Bc);return g.createElement(Ui.Z,null,g.createElement(n,(0,p.pi)({},t)))}var Gc=function(t){function n(n){var e=t.call(this,n)||this;return e.cP=g.createRef(),e.fP="",e.focus=e.focus.bind(e),e.If=e.If.bind(e),e}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=!(this.props.FormInsightMaster.FormMaster.SyncContext===eu.y.AnalysisTimeForm),n=this.props.Index+1;if(t&&this.props.FormInsightMaster.Model.IsReady&&this.hP().length>0&&!(0,ca.sv)()){var e=void 0;e=this.props.Clicked?"analyze-view-detail-show-insight-button clicked optional-button":"analyze-view-detail-show-insight-button optional-button";var i={ref:this.cP,"aria-label":(0,T.pm)().AnalyzeView_InteractiveInsight_AriaDescription.format(n),className:e,onClick:this.If};return(0,z.F)({HTMLAttributes:i,FluentIcon:"Lightbulb Filament",IconClassName:"forms-icon-size14x14 analyze-view-insight-button-icon",Text:"Insights",TextClassName:"analyze-view-insight-button-label",ButtonStyle:1,GlyphButtonStyle:"Horizontal"})}return null},n.prototype.focus=function(){this.cP.current&&this.cP.current.focus()},n.prototype.If=function(){var t=this.hP();this.props.FormInsightMaster.logEngage("Explore",t,this.fP,0,0,this.props.QuestionMaster.Model.Id),this.props.openInsightExploreView()},n.prototype.hP=function(){var t=this.props.QuestionMaster,n=this.props.FormInsightMaster.Insights.filter((function(n){return n.CalculationQuestion.Id===t.Model.Id&&n.IsStatisticSignificant}))||[],e=n.map((function(t){return t.InsightId}))||[];return this.fP=n.length>0?n[0].SuggestionId:"",e},n}(J.r),qc=e(88807),Vc=(He.J4.reference(),He.J4.string(),He.J4.string(),He.J4.number(),He.J4.string(),He.J4.string(),He.J4.string(),He.J4.string(),He.J4.string(),{Answers:He.J4.collectionOf(He.J4.reference()),Questions:He.J4.collectionOf(He.J4.reference()),TopLevelQuestions:He.J4.collectionOf(He.J4.reference()),PagingSize:He.J4.number(),IsPagingReady:He.J4.boolean()}),zc=300,Qc=function(t){function n(n,e){var i=t.call(this,e)||this;i.Je=n,i.Model.PagingSize=zc;var r=[];return y.forEach(n.Model.Questions,(function(t){r.push({Id:t.Id,GroupId:t.GroupId,Type:t.Type,Title:t.Title})})),i.Model.Questions=r,i.Model.TopLevelQuestions=y.filter(r,(function(t){return!t.GroupId})),i}return(0,p.ZT)(n,t),n.prototype.getQuestionAnswers=function(t){var n=this;return t?y.filter(this.Model.Answers,(function(e){return n.dP(t,e)})):[]},n.prototype.getQuestionsAnswers=function(t){var n=[];return y.forEach(this.Je.Model.BufferResponses,(function(e){var i=!1,r=t.map((function(t){var n=y.find(e.Answers,(function(n){return n.QuestionId===t}));return n&&n.Answer?(i=!0,n.Answer.displayText):""}));if(i){var o=!!e.SubmitLanguage&&JSON.parse(e.SubmitLanguage).localeName;n.push({Answer:r,ResponderName:e.ResponderName?e.ResponderName:e.Responder,Language:o||""})}})),n},n.prototype.dP=function(t,n){return"Question.Ranking"!==this.getQuestionType(t)?null!=t&&n.QuestionId===t&&null!=n.Answer&&""!==n.Answer:n.QuestionId===t&&n.Answer&&!/^\[(("",)*""|)\]$/.test(n.Answer)},n.prototype.getAnswersCount=function(){return this.Je.Model.ResponsesCount},n.prototype.getPagingRegion=function(t){return{Start:isNaN(t)?0:t*zc+1,End:isNaN(t)?0:Math.min((t+1)*zc,this.Je.Model.ResponsesCount)}},n.prototype.SyncPreviousPageData=function(){isNaN(this.mP)||this.syncData(this.mP-1)},n.prototype.SyncNextPageData=function(){isNaN(this.mP)||this.syncData(this.mP+1)},n.prototype.syncData=function(t){var n=this,e=this.Je.Model.ResponsesCount,i=t*zc;t>=0&&i<e&&(this.mP=t,this.Model.IsPagingReady=!1,this.Je.syncFormResponsesByPaging(Math.min(e-i,zc),i).then((function(){if(t==n.mP){var e=[];y.forEach(n.Je.Model.BufferResponses,(function(t){var i=!!t.SubmitLanguage&&JSON.parse(t.SubmitLanguage).localeName;y.forEach(t.Answers,(function(r){e.push({Answer:n.vP(r.QuestionId,r.Answer),QuestionId:r.QuestionId.replace(/-/g,""),ResponderName:t.ResponderName?t.ResponderName:t.Responder,ResponseId:t.Id,Language:i||""})}))})),n.Model.Answers=e,n.Model.IsPagingReady=!0}})))},n.prototype.getQuestionType=function(t){return this.Je.getQuestionById(t).Model.Type},n.prototype.getAnswerColumnCount=function(t){var n=this.Je.getQuestionById(t);switch(n.Model.Type){case"Question.Ranking":return Math.max(1,n.Model.ChoiceGroup.length);case"Question.MatrixChoiceGroup":return y.filter(this.Model.Questions,(function(n){return n.GroupId===t})).length;case"Question.NPS":return 2;default:return 1}},n.prototype.getFileUploadFolder=function(t){var n=this.Je.getQuestionById(t).Model.FileUploadSPOInfo;return n&&n.folderId?new qc.L(this.Je).getFileFolder(n.folderId):Promise.reject(new Error("Folder id is null"))},n.prototype.vP=function(t,n){var e=this.Je.getQuestionById(t);if(e){if(n&&"Question.DateTime"===e.Model.Type){var i=(0,c.k0)().cultureInfo;return Date.parseDate(n,(0,X.gC)(),i).toDateShortString(i)}if(n&&e.isNumberType())return(0,tt.d)(n);if("Question.Ranking"===e.Model.Type){var r={};y.forEach(e.Model.ChoiceGroup,(function(t){r[t.Id]=t.Description}));var o=n?y.sortBy(y.filter(n,(function(t){return void 0!==r[t.id]})),(function(t){return t.answerOrder})):[],s=y.size(r)?y.size(r)-o.length:1,a=y.map(Array.apply(null,Array(s)),String.prototype.valueOf,"");return JSON.stringify(y.map(o,(function(t){return r[t.id]})).concat(a))}}return n},n}(_.d.createObjectMasterClass("ResponsesDetailMaster",Vc)),Uc=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.gP=y.uniqueId("dd"),n.pP=n.gP+"-rs",n.bP=g.createRef(),n.yP=g.createRef(),n.wP=g.createRef(),n.SP=g.createRef(),n.NP=function(){n.vo&&n.forceUpdate()},n.state={PagingIndex:0,QuestionIndex:-1,ShowErrorMessage:!1,ShowOpenFolderSpinner:!1},n}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){this.props.QuestionDetailMaster&&(this.props.QuestionDetailMaster.observe(this.NP,[Qc.Schema.Answers,Qc.Schema.IsPagingReady]),this.props.QuestionDetailMaster.syncData(0)),this.setState({QuestionIndex:this.props.Index})},n.prototype.componentDidMount=function(){this.vo=!0,this.bP.current&&this.bP.current.focus(),(0,kr.mZ)(b.findDOMNode(this)),this.CP(),this.IP()},n.prototype.componentDidUpdate=function(){this.CP(),this.IP()},n.prototype.componentWillUnmount=function(){this.props.QuestionDetailMaster&&this.props.QuestionDetailMaster.unobserve(this.NP),this.vo=!1},n.prototype.render=function(){var t=this;if(this.props.QuestionDetailMaster&&this.state.QuestionIndex>=0)return g.createElement("div",{className:"response-dialog-container",onKeyDown:function(n){(8===n.keyCode||37===n.keyCode&&n.altKey)&&(n.stopPropagation(),n.preventDefault()),27===n.keyCode&&t.props.onClose&&t.props.onClose()}},this.TP(),this.kP(),this.PP())},n.prototype.TP=function(){var t=this,n=this.props.QuestionDetailMaster.Model.TopLevelQuestions.length;if(this.state.QuestionIndex>0&&this.state.QuestionIndex<n){var e={HTMLAttributes:{className:"response-dialog-previous-button",onClick:function(){(0,q.$U)("DesignPage.Responses.DetailDialogQuestionNavigate",{entry:"PreviouseQuestion"}),t.setState({QuestionIndex:t.state.QuestionIndex-1},(function(){t.bP.current&&t.bP.current.focus()}))}},FluentIcon:"Chevron Left",GlyphButtonStyle:"GlyphOnly",ButtonStyle:2,Text:(0,T.pm)().AnalyzeView_DetailResponses_Previous_Button};return(0,z.F)(e)}},n.prototype.PP=function(){var t=this,n=this.props.QuestionDetailMaster.Model.TopLevelQuestions.length;if(this.state.QuestionIndex>=0&&this.state.QuestionIndex<n-1){var e={HTMLAttributes:{className:"response-dialog-next-button",onClick:function(){(0,q.$U)("DesignPage.Responses.DetailDialogQuestionNavigate",{entry:"NextQuestion"}),t.setState({QuestionIndex:t.state.QuestionIndex+1},(function(){t.bP.current&&t.bP.current.focus()}))}},FluentIcon:"Chevron Right",GlyphButtonStyle:"GlyphOnly",ButtonStyle:2,Text:(0,T.pm)().AnalyzeView_DetailResponses_Next_Button};return(0,z.F)(e)}},n.prototype.kP=function(){var t=(0,T.pm)().AnalyzeView_Detail_DialogTitle.format(this.state.QuestionIndex+1);return g.createElement("div",{"aria-label":t,className:"response-dialog",role:"dialog",ref:this.SP},g.createElement("div",{ref:this.wP},this.qf(),this.MP(),this.RP()),this.PF(),this.AP())},n.prototype.qf=function(){var t={HTMLAttributes:{onClick:this.props.onClose,className:"response-dialog-close-button"},FluentIcon:"Dismiss",IconClassName:"forms-icon-size16x16",ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",Text:(0,T.pm)().Common_Close_Text,ref:this.bP,TooltipClassName:"button-tooltip SurveyResponsesDetailDialog-CloseButton"};return(0,z.F)(t)},n.prototype.MP=function(){var t=this.props.QuestionDetailMaster.Model.TopLevelQuestions[this.state.QuestionIndex].Title;return g.createElement("div",{className:"response-dialog-title"},g.createElement(cr.D,{Text:(0,T.pm)().AnalyzeView_QuestionTitle.format(this.state.QuestionIndex+1,t),RenderMode:"RichText"}))},n.prototype.RP=function(){var t,n,e=this,i=this.props.QuestionDetailMaster.Model.TopLevelQuestions[this.state.QuestionIndex].Id,r="Question.FileUpload"===this.props.QuestionDetailMaster.getQuestionType(i),o=this.EP(),s=(0,T.pm)().Common_Responses_Text;if(r&&o.length>0&&(s=(0,T.pm)().UploadFile_Files_DetailPage_Subtitle,t=(0,Fr.E)({HTMLAttributes:{className:"survey-response-dialog-folder-button office-form-theme-button",disabled:this.state.ShowOpenFolderSpinner,onClick:function(){e.setState({ShowOpenFolderSpinner:!0}),e.props.QuestionDetailMaster.getFileUploadFolder(i).then((function(t){e.vo&&e.setState({ShowOpenFolderSpinner:!1}),(0,q.$U)("DesignPage.Responses.OpenFileFolder"),(0,$s.K)(t)})).catch((function(t){t&&t.response&&404===t.response.statusCode&&e.setState({ShowErrorMessage:!0,ShowOpenFolderSpinner:!1})}))}},ButtonStyle:1,Text:(0,T.pm)().UploadFile_OpenFolder_Button}),n=this.state.ShowErrorMessage&&g.createElement("div",{className:"response-dialog-folder-button-error-message"},(0,T.pm)().UploadFile_FolderNotExist_ErrorMessage)),this.props.QuestionDetailMaster.getAnswersCount()<this.props.QuestionDetailMaster.Model.PagingSize)return o.length>0?g.createElement("div",null,g.createElement("div",{className:"survey-response-dialog-summary"},g.createElement("div",{className:"survey-response-dialog-container",id:this.pP},g.createElement("span",{className:"survey-response-dialog-response-count office-form-theme-primary-foreground"},o.length),s),g.createElement("div",null,t,this.xu())),n):void 0;var a=this.props.QuestionDetailMaster.getPagingRegion(this.state.PagingIndex),u=a.Start.toString(),c=a.End.toString(),l=this.props.QuestionDetailMaster.getAnswersCount().toString();return g.createElement("div",{className:"survey-response-dialog-paging-summary"},g.createElement("div",{className:"survey-response-dialog-paging-info-container",id:this.pP},g.createElement("span",{className:"survey-response-dialog-region-info"},(0,T.pm)().AnalyzeView_DetailResponses_PagingRegion_Message.format(u,c)),g.createElement("span",{className:"survey-response-dialog-region-separator"},"|"),l),this._P(),this.HP())},n.prototype.xu=function(){if(this.state.ShowOpenFolderSpinner){return g.createElement("div",{className:"open-folder-spinner"},g.createElement("div",{className:"common-spinner-circle"},g.createElement(U.L,{HTMLAttributes:{className:"screenReaderVisible"},LazyRendering:!0,Role:"Log"},(0,T.pm)().Design_Page_Open_OneDrive_Folder)))}},n.prototype.AP=function(){if(this.GP()){var t=(0,T.pm)().AnalyzeView_Detail_DialogTitle.format(this.state.QuestionIndex+1);return g.createElement("div",{className:"response-dialog-content",ref:this.yP},g.createElement("div",{className:"response-dialog-table-container"},g.createElement("table",{"aria-label":t,"aria-describedby":this.pP,className:"response-dialog-table hover stripe cell-border"})))}return g.createElement("div",{className:"response-dialog-no-responses-message"},(0,T.pm)().AnalyzeView_DetailResponses_NoResponses_Message)},n.prototype.IP=function(){if(this.GP()){var t=$(this.SP.current).height()-$(this.wP.current).outerHeight(!0);$(this.yP.current).outerHeight(t)}},n.prototype._P=function(){var t=this,n={className:"question-detail-page-previous-button",disabled:0===this.state.PagingIndex,onClick:function(){t.state.PagingIndex>0&&((0,q.$U)("DesignPage.Responses.DetailDialogPaging",{entry:"PreviousPage"}),t.props.QuestionDetailMaster.SyncPreviousPageData(),t.setState({PagingIndex:t.state.PagingIndex-1}))}};return(0,z.F)({ButtonStyle:2,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:n,FluentIcon:"Chevron Left",Text:(0,T.pm)().AnalyzeView_DetailResponses_PreviousPage})},n.prototype.HP=function(){var t=this,n=this.props.QuestionDetailMaster.Model.PagingSize,e=this.props.QuestionDetailMaster.getAnswersCount(),i=(this.state.PagingIndex+1)*n>=e,r={className:"question-detail-page-next-button",disabled:i,onClick:function(){t.state.PagingIndex>=0&&!i&&((0,q.$U)("DesignPage.Responses.DetailDialogPaging",{entry:"NextPage"}),t.props.QuestionDetailMaster.SyncNextPageData(),t.setState({PagingIndex:t.state.PagingIndex+1}))}};return(0,z.F)({ButtonStyle:2,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:r,FluentIcon:"Chevron Right",Text:(0,T.pm)().AnalyzeView_DetailResponses_NextPage})},n.prototype.PF=function(){if(this.GP()&&!this.props.QuestionDetailMaster.Model.IsPagingReady){this.qP();var t={ClassName:"survey-reponse-detail-loading-container survery-response-more-detail-message-container",LoadingDescription:(0,T.pm)().Common_Loading_Text};return g.createElement(qa.P,(0,p.pi)({},t))}},n.prototype.GP=function(){return this.props.QuestionDetailMaster.getAnswersCount()>0},n.prototype.CP=function(){if(this.GP()&&this.props.QuestionDetailMaster.Model.IsPagingReady){this.qP();var t=this.props.QuestionDetailMaster.Model.TopLevelQuestions[this.state.QuestionIndex].Id;this.VP=$(".response-dialog-table").DataTable({data:this.zP(t),columns:this.QP(t),columnDefs:[{targets:2,createdCell:function(t){$(t).attr("aria-disabled","true")}}],searching:!1,paging:!1,info:!1,autoWidth:!0})}},n.prototype.QP=function(t){var n=[(0,T.pm)().AnalyzeView_Sort_First,(0,T.pm)().AnalyzeView_Sort_Second,(0,T.pm)().AnalyzeView_Sort_Third,(0,T.pm)().AnalyzeView_Sort_Fourth,(0,T.pm)().AnalyzeView_Sort_Fifth,(0,T.pm)().AnalyzeView_Sort_Sixth,(0,T.pm)().AnalyzeView_Sort_Seventh,(0,T.pm)().AnalyzeView_Sort_Eighth,(0,T.pm)().AnalyzeView_Sort_Ninth,(0,T.pm)().AnalyzeView_Sort_Tenth],e=[(0,T.pm)().Common_Responses_Text],i=[{title:(0,T.pm)().AnalyzeView_Response_ID},{title:(0,T.pm)().AnalyzeView_ExcelHeader_ResponderName}];this.props.EnableSubmitLanguage&&i.push({title:(0,T.pm)().AnalyzeView_ExcelHeader_Language});var r=[],o=this.props.QuestionDetailMaster.getAnswerColumnCount(t),s=60/o+"%";switch(this.props.QuestionDetailMaster.getQuestionType(t)){case"Question.Ranking":$(".response-dialog-table").addClass("response-dialog-table-ranking"),r=y.first(n,o);break;case"Question.MatrixChoiceGroup":$(".response-dialog-table").removeClass("response-dialog-table-ranking");for(var a=1;a<o;a++)e.push("");r=e;break;case"Question.NPS":$(".response-dialog-table").removeClass("response-dialog-table-ranking"),r=[(0,T.pm)().AnalyzeView_NPS_Score,(0,T.pm)().AnalyzeView_NPS_Category];break;default:r=e}return r=y.map(r,(function(t){return{title:t,width:s}})),i.concat(r)},n.prototype.zP=function(t){var n,e=this,i=this.props.QuestionDetailMaster.getPagingRegion(this.state.PagingIndex).Start,r=this.EP();switch(this.props.QuestionDetailMaster.getQuestionType(t)){case"Question.Ranking":n=y.map(r,(function(t,n){return e.UP(i+n,t).concat(JSON.parse(t.Answer).map((function(t){return e.$P(t)})))}));break;case"Question.MatrixChoiceGroup":n=y.map(r,(function(t,n){return e.UP(i+n,t).concat(t.Answer.map((function(t){return e.$P(t)})))}));var o=y.filter(this.props.QuestionDetailMaster.Model.Questions,(function(n){return n.GroupId===t})),s=y.map(o,(function(t){return e.$P(t.Title)}));this.props.EnableSubmitLanguage?n.length&&n.splice(0,0,["","",""].concat(s)):n.length&&n.splice(0,0,["",""].concat(s));break;case"Question.NPS":n=y.map(r,(function(t,n){var r=t.Answer;return e.UP(i+n,t).concat([r,(0,cs.J)(r)])}));break;case"Question.FileUpload":n=[],y.forEach(r,(function(t,r){if(t.Answer){var o=JSON.parse(t.Answer);if(o.length>0){var s=o,a=e.UP(i+r,t),u="";s.forEach((function(t,n){var i=(0,L.UV)(t.name),r=e.jP(t.name),o=t.link.split('"')[0];n+1!==s.length?u+=i+'<a href="'.concat(o,'" target="_blank" class="response-dialog-fileName">').concat(r,"</a></br>"):u+=i+'<a href="'.concat(o,'" target="_blank" class="response-dialog-fileName">').concat(r,"</a>")})),n.push(a.concat(u))}}}));break;default:n=y.map(r,(function(t,n){return e.UP(i+n,t).concat([e.$P(t.Answer)])}))}return n},n.prototype.jP=function(t){return t&&(0,pt.F1)("".concat(t),!0)},n.prototype.UP=function(t,n){var e=[t,this.jP(n.ResponderName)];return this.props.EnableSubmitLanguage&&(e=e.concat(n.Language)),e},n.prototype.qP=function(){this.VP&&(this.VP.destroy(),this.VP=void 0,$(".response-dialog-table").empty())},n.prototype.$P=function(t){return(0,du.ZP)(t)},n.prototype.EP=function(){var t=this.props.QuestionDetailMaster.Model.TopLevelQuestions[this.state.QuestionIndex],n=t?t.Id:void 0;if("Question.MatrixChoiceGroup"===t.Type){var e=y.pluck(y.filter(this.props.QuestionDetailMaster.Model.Questions,(function(t){return t.GroupId===n})),"Id");return this.props.QuestionDetailMaster.getQuestionsAnswers(e)}return this.props.QuestionDetailMaster.getQuestionAnswers(n)},n}(J.r),$c=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.KP=function(){return n.forceUpdate()},n.JP=g.createRef(),n.YP=g.createRef(),n}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){if(this.tD=this.tD.bind(this),this.props.AggregationMaster.observe(this.KP,[Bu.Schema.IsAggregationReady,Bu.Schema.IsAggregationFailed]),(0,Wa.s$)()){this.As=this.As.bind(this),this.nD=this.nD.bind(this),this.eD=this.eD.bind(this);var t=this.props.AggregationMaster.QuestionMaster;t.observe(this.As,[t.Schema.InsightsInfo]);var n=this.props.QuestionViewInsight.FormInsightMaster,e=n.FormMaster;n.observe(this.As,[n.Schema.InsightCount]),e.observe(this.As,[e.Schema.FormsInsightsInfo])}},n.prototype.render=function(){if(this.props.AggregationMaster){var t=(0,T.pm)(),n=this.props.AggregationMaster.QuestionMaster.Model,e="".concat(this.props.Index+1,".").concat(n.Title,".")+"".concat(n.Required?t.Accessibility_RequiredAnswer+".":"")+"".concat(function(t,n,e){var i="";switch(n){case"Question.Choice":i=e?t.QuestionType_MultiChoice:t.QuestionType_SingleChoice;break;case"Question.DateTime":i=t.QuestionType_DateTime;break;case"Question.Rating":i=t.QuestionType_Rating;break;case"Question.TextField":i=e?t.QuestionType_MultiLineText:t.QuestionType_SingleLineText;break;case"Question.Ranking":i=t.QuestionType_Ranking;break;case"Question.MatrixChoiceGroup":i=t.QuestionType_MatrixChoiceGroup;break;case"Question.FileUpload":i=t.QuestionType_UploadFile;break;case"Question.NPS":i=t.QuestionType_NPS;break;case"Question.ColumnGroup":i=t.DesciptiveElementType_Section}return i}(t,n.Type,n.Multiline),".");return g.createElement("div",{className:"analyze-view-detail","aria-label":e},this.iD(this.props.Index),this.rD(),g.createElement("div",{className:"analyze-view-detail-linebreak"}))}},n.prototype.componentWillUnmount=function(){this.props.AggregationMaster.unobserve(this.KP,[Bu.Schema.IsAggregationReady]),(0,Wa.s$)()&&(this.props.AggregationMaster.QuestionMaster&&this.props.AggregationMaster.QuestionMaster.unobserve(this.As),this.props.QuestionViewInsight.FormInsightMaster&&(this.props.QuestionViewInsight.FormInsightMaster.unobserve(this.As),this.props.QuestionViewInsight.FormInsightMaster.FormMaster.unobserve(this.As)))},n.prototype.As=function(){this.forceUpdate()},n.prototype.iD=function(t){return g.createElement("div",{className:"analzye-view-detail-question"},g.createElement("div",{className:"analzye-view-detail-ordinal"},"".concat(t+1,".")),this.createQuestionTitleContent())},n.prototype.rD=function(){return g.createElement("div",{className:"survey-analyze-view-detail-container"},this.oD(this.props.Index),this.sD(this.props.Index),this.aD(),this.uD(),this.cD(),this.lD(),this.fD())},n.prototype.oD=function(t){var n=t+1;if(this.props.onShowQuestionDetail&&!(0,ca.sv)()){var e={HTMLAttributes:{"aria-label":(0,T.pm)().QuestionView_Detail_Label_Index?(0,T.pm)().QuestionView_Detail_Label_Index.format(n):void 0,className:"analyze-view-link-button",onClick:this.tD},Text:(0,T.pm)().QuestionView_Detail_Label,Tooltip:(0,T.pm)().AnalyzeView_ShowDetailResponses_Button.format(n),ref:this.JP};return g.createElement("div",{className:"question-view-detail-label"},g.createElement(Fr.A,(0,p.pi)({},e)))}},n.prototype.aD=function(){if(this.props.AggregationMaster.Model.IsAggregationReady)return g.createElement("div",{className:"question-view-content-container"},this.createQuestionViewContent())},n.prototype.uD=function(){if(!this.props.AggregationMaster.Model.IsAggregationReady&&!this.props.AggregationMaster.Model.IsAggregationFailed)return g.createElement("div",{className:"question-view-loading-content-container"},this.hD(),this.PF())},n.prototype.cD=function(){if(this.props.AggregationMaster.Model.IsAggregationFailed)return g.createElement("div",{className:"question-view-loading-content-container"},this.hD())},n.prototype.hD=function(){var t=(0,zi.Jn)("/Images/question_backgrounds/"+this.getPreviewImageName());return g.createElement("div",{className:"question-view-background-image"},g.createElement("img",{src:t}))},n.prototype.PF=function(){return g.createElement(qa.P,(0,p.pi)({},{ClassName:"question-view-loading-spinner-container",Ignorable:!1}))},n.prototype.tD=function(){var t=this;(0,kr.cz)(Uc.name,(function(){t.JP.current&&t.JP.current.focus()})),this.props.onShowQuestionDetail&&this.props.onShowQuestionDetail()},n.prototype.shouldShowInsightEntryPoint=function(){return!1},n.prototype.sD=function(t){if((0,Wa.s$)()&&!(0,ca.sv)()){var n=this.props.QuestionViewInsight.InsightExploreViewOpened&&this.props.QuestionViewInsight.InsightExploreViewIndex===this.props.Index,e=this.shouldShowInsightEntryPoint();return g.createElement(Gc,{openInsightExploreView:this.eD,ref:this.YP,Clicked:n,FormInsightMaster:this.props.QuestionViewInsight.FormInsightMaster,Index:t,QuestionMaster:this.props.AggregationMaster.QuestionMaster,ShowEntryPoint:e})}},n.prototype.fD=function(){if((0,Wa.s$)()&&!(0,ca.sv)())return Ec({QuestionIndex:this.props.Index,FormInsightMaster:this.props.QuestionViewInsight.FormInsightMaster,QuestionMaster:this.props.AggregationMaster.QuestionMaster})},n.prototype.lD=function(){if((0,Wa.s$)()&&!(0,ca.sv)()&&this.props.QuestionViewInsight.InsightExploreViewOpened&&this.props.QuestionViewInsight.InsightExploreViewIndex===this.props.Index)return _c({closeInsightExploreView:this.nD,FormInsightMaster:this.props.QuestionViewInsight.FormInsightMaster,QuestionMaster:this.props.AggregationMaster.QuestionMaster})},n.prototype.nD=function(){this.props.QuestionViewInsight.onCloseInsightExploreView(),this.YP.current&&this.YP.current.focus()},n.prototype.eD=function(){this.props.QuestionViewInsight.onClickInsightButton()},n}(J.r),jc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.getPreviewImageName=function(){return this.props.AggregationMaster.QuestionMaster.Model.Choices.length<=5?"pie.png":"bar.png"},n.prototype.createQuestionViewContent=function(){return[this.mD()]},n.prototype.mD=function(){var t=this,n=_.d.convertToArray(this.props.AggregationMaster.Model.ChoiceQuestionAggregation.ChoiceSummary),e=y.map(n,(function(n){return{labelName:"answer_other"===n.Choice?(0,T.pm)().Designer_OtherAnswer:n.Choice,displayElement:t.createDisplayElement(n),labelData:n.Count,lableClass:t.vD(n)?"choice-chart-control-legend-label":void 0,onClick:t.vD(n)?t.props.onShowQuestionDetail:void 0}})),i={Animation:this.props.AggregationMaster.Model.IsAggregationReady,Data:{data:n.map((function(t){return t.Count}))},Labels:e,HasLegend:!0,TagLabels:this.CorrectOptions,Type:n.length<=5?1:0};return g.createElement(Rc,(0,p.pi)({},i,{key:"chartControl"}))},n.prototype.vD=function(t){return(0,ca.sv)()&&"answer_other"===t.Choice&&t.Count>0},n}($c),Wc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){return g.createElement("div",null,this.Sg(),this.Sm(),this.pD())},n.prototype.Sg=function(){var t=this.QuestionMaster.Model;return g.createElement("div",{className:"analzye-view-detail-title"},g.createElement(cr.D,{Text:(0,ir.wg)(t.Title,t.FormsProRTQuestionTitle),RenderMode:"RichText",ContainsHtml:!0}),this.bD())},n.prototype.bD=function(){if(this.IsShowPointsEnabled){var t=this.QuestionMaster.Model.Point,n=t<=1?(0,T.pm)().Quiz_Points_LowerText:(0,T.pm)().Quiz_Points_LowerTextPlural;return g.createElement("span",{className:"analyze-view-quiz-point"},"(".concat(t," ").concat(n,")"))}},n.prototype.Sm=function(){if(this.IsShowSubtitleEnabled)return g.createElement("div",{className:"analyze-view-question-title-formula"},(0,er.Rq)({Formula:this.SubtitleContext}))},n.prototype.pD=function(){if(this.IsStatisticsEnabled){var t=this.props.AggregationMaster.Model.GradeStatistics,n=t.CorrectCount,e=t.WrongCount;return g.createElement("div",{className:"analyze-details-quiz-results"},(0,T.pm)().AnalyzeView_QuizResults.format((n/(n+e)*100).toFixed(0),n,n+e))}},n.prototype.yD=function(t){return null!=t},Object.defineProperty(n.prototype,"QuestionMaster",{get:function(){return this.props.AggregationMaster.QuestionMaster},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"IsShowPointsEnabled",{get:function(){return this.QuestionMaster.Model.IsQuiz&&this.QuestionMaster.Model.Point},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"IsShowSubtitleEnabled",{get:function(){return this.QuestionMaster&&this.QuestionMaster.Model.IsMathQuiz&&!this.QuestionMaster.Model.IsPlainTextInMathField&&this.QuestionMaster.Model.ShowSubtitle&&this.SubtitleContext},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"SubtitleContext",{get:function(){return this.QuestionMaster.Model.Subtitle},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"IsStatisticsEnabled",{get:function(){var t=this.props.AggregationMaster.Model.GradeStatistics;return this.QuestionMaster.Model.IsQuiz&&this.QuestionMaster.hasCorrectAnswers()&&this.yD(t.CorrectCount)&&this.yD(t.WrongCount)&&(t.CorrectCount||t.WrongCount)},enumerable:!1,configurable:!0}),n}(J.r),Kc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return g.createElement(Wc,{AggregationMaster:this.props.AggregationMaster})},Object.defineProperty(n.prototype,"CorrectOptions",{get:function(){var t={},n=y.filter(this.props.AggregationMaster.QuestionMaster.Model.Choices,(function(t){return t.IsAnswerKey}));return y.forEach(n,(function(n){return t[n.Description]=!0})),t},enumerable:!1,configurable:!0}),n.prototype.createDisplayElement=function(t){return t.IsFormula?(0,er.Rq)({Formula:t.Choice,DisableLinebreaks:!0}):(0,cr.q)({Text:"answer_other"===t.Choice?(0,T.pm)().Designer_OtherAnswer:t.Choice,RenderMode:"RichText",ContainsHtml:!0})},n}(jc),Jc=e(35230),Zc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.getPreviewImageName=function(){return"text.png"},n.prototype.createQuestionViewContent=function(){return[this.wD(),this.ND()]},n.prototype.wD=function(){var t={Data:this.props.AggregationMaster.Model.DateQuestionAggregation.ResponseCount,Description:(0,T.pm)().Common_Responses_Text,Ignorable:!1,IsReady:!0,AccessibilityText:(0,T.pm)().AnalyzeView_NumberOfResponses_AccessibilityLabel.format(this.props.AggregationMaster.Model.DateQuestionAggregation.ResponseCount)};return g.createElement(Jc.V,(0,p.pi)({},t,{key:"responseCount"}))},n.prototype.ND=function(){var t=this.props.AggregationMaster.Model.DateQuestionAggregation.ResponseCount,n=(0,ca.sv)()&&t>0&&h.Pv.Resolve("IMobileDesignPageUXFactory").createMobileResponseDetailEntrance(this.props.onShowQuestionDetail);return g.createElement("div",{className:"survey-analyze-view-detail-text-recent",key:"latestResponses"},g.createElement("a",{className:"screenReaderVisible",role:"presentation"},"".concat((0,T.pm)().Analyze_View_Text_Recent_Responses).concat(this.CD)),g.createElement("div",{"aria-hidden":!0,className:"analyze-view-summary-status-label"},(0,T.pm)().Analyze_View_Text_Recent_Responses),this.ID(),n)},n.prototype.ID=function(){var t=this,n=y.pluck(_.d.convertToArray(this.props.AggregationMaster.Model.DateQuestionAggregation.TopDate),"Answer");return this.CD="",y.map(n,(function(n,e){var i=n&&n.toDateShortString((0,c.k0)().cultureInfo);return t.CD="".concat(t.CD,' ."').concat(i,'"'),g.createElement("div",{"aria-hidden":!0,className:"analyze-view-detail-text-lines",key:e},'"'.concat(i,'"'))}))},n}($c),Xc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return g.createElement(Wc,{AggregationMaster:this.props.AggregationMaster})},n}(Zc),Yc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.getPreviewImageName=function(){return"text.png"},n.prototype.createQuestionViewContent=function(){return[this.wD(),this.TD()]},n.prototype.wD=function(){var t={Data:this.props.AggregationMaster.Model.FileUploadQuestionAggregation.ResponseCount,Description:(0,T.pm)().Common_Responses_Text,Ignorable:!1,IsReady:!0,AccessibilityText:(0,T.pm)().AnalyzeView_NumberOfResponses_AccessibilityLabel.format(this.props.AggregationMaster.Model.FileUploadQuestionAggregation.ResponseCount)};return g.createElement(Jc.V,(0,p.pi)({},t,{key:"responseCount"}))},n.prototype.TD=function(){return g.createElement("div",{className:"survey-analyze-view-detail-text-recent",key:"latestResponses"},g.createElement("a",{className:"screenReaderVisible",role:"presentation"},"".concat((0,T.pm)().Analyze_View_Text_Recent_Responses," ").concat(this.xD)),g.createElement("div",{"aria-hidden":!0,className:"analyze-view-summary-status-label"},(0,T.pm)().Analyze_View_Text_Recent_Responses),this.FD())},n.prototype.FD=function(){var t=this,n=y.pluck(_.d.convertToArray(this.props.AggregationMaster.Model.FileUploadQuestionAggregation.RecentFile),"Answer");return this.xD="",y.map(n,(function(n,e){if(n){var i=n.name,r=(0,L.LP)(i);return t.xD="".concat(t.xD," ").concat(i,". "),g.createElement("div",{"aria-hidden":!0,className:"analyze-view-detail-text-lines",key:e},r,g.createElement("span",{className:"analyze-view-detail-fileName"},i))}}))},n}($c),tl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return g.createElement(Wc,{AggregationMaster:this.props.AggregationMaster})},n}(Yc),nl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){if(this.VF()){var t={className:"chart-control-container chart-likert-control-container",tabIndex:-1};return t["aria-label"]=(0,T.pm)().ChartControl_GroupContainer,g.createElement("div",(0,p.pi)({},t),this.PD(),g.createElement("div",{className:"chart-likert-body-control-container"},this.zF(),this.QF()))}return null},n.prototype.componentWillMount=function(){this.DD()},n.prototype.componentDidMount=function(){this.$F()},n.prototype.shouldComponentUpdate=function(t){return!y.isEqual(this.props,t)||!this.jF},n.prototype.componentDidUpdate=function(){this.$F()},n.prototype.componentWillUnmount=function(){this.WF()},n.prototype.VF=function(){return this.props.Labels&&this.props.Labels.length>0&&this.props.Data&&this.props.Data.length>0},n.prototype.WF=function(){this.JF&&(this.JF.destroy(),this.JF=null)},n.prototype.$F=function(){if(this.VF()){var t=b.findDOMNode(this.refs.canvas);if(this.jF=$(t).is(":visible"),this.jF){var n=t.getContext("2d");this.MD(n),this.tP()}}},n.prototype.LD=function(){var t=this,n="'Segoe UI','Segoe WP',Tahoma, Arial, sans-serif",e={responsive:!1,scales:{xAxes:[{gridLines:{display:!0,drawTicks:!1,drawBorder:!0,zeroLineColor:"#ECECEC",zeroLineWidth:1,zeroLineBorderDash:[5]},ticks:{display:!0,beginAtZero:!0,fontFamily:n,fontSize:12,min:-100,max:100,maxTicksLimit:3,callback:function(t){return Math.abs(+t)+"%"}},stacked:!0}],yAxes:[{barPercentage:.67,categoryPercentage:1,gridLines:{display:!1,drawTicks:!1,drawBorder:!1},ticks:{display:!1},stacked:!0}]},tooltips:{enabled:!1,mode:"nearest",intersect:!0,bodyFontSize:12,bodyFontFamily:n,custom:function(n){var e=t.JF.canvas.parentNode,i=e.getElementsByClassName("chart-custom-tooltip")[0];if(i||((i=document.createElement("div")).className="chart-custom-tooltip",i.appendChild(document.createElement("table")),e.appendChild(i)),0!==n.opacity){if(n.body){var r=n.body.map((function(t){return t.lines}));if(r.length>1){var o=r.length/2;t.RD&&(r.splice(o,1),n.labelColors.splice(o,1));var s=r.splice(0,o).reverse();s=s.concat(r);var a=n.labelColors.splice(0,o).reverse();a=a.concat(n.labelColors),r=[];var u=[];s.forEach((function(t,n){/\:\s0%$/g.test(t[0].xLabel)||(r.push(t),u.push(a[+n]))})),n.labelColors=u}var c=document.createElement("table");r.forEach((function(t,e){var i=(0,pt.F1)("".concat(t[0].xLabel),!0),r=(0,pt.F1)("".concat(t[0].yLabel),!0),o=n.labelColors[e],s="background:".concat(o.backgroundColor,";border-color:").concat(o.borderColor,"; border-width: 2px;"),a=document.createElement("span");a.className="chart-custom-tooltip-box",a.setAttribute("style","".concat(s));var u=document.createElement("span");u.className="chart-custom-tooltip-text",u.textContent="".concat(i);var l=document.createElement("span");l.className="chart-custom-tooltip-statement-text",l.textContent="".concat(r);var f=document.createElement("tr"),h=document.createElement("td");h.appendChild(l),f.appendChild(h);var d=document.createElement("tr"),m=document.createElement("td");m.appendChild(a),m.appendChild(u),d.appendChild(m),c.appendChild(f),c.appendChild(d)}));var l=i.querySelector("table");l.childNodes&&l.childNodes[0]?l.replaceChild(c,l.childNodes[0]):l.appendChild(c)}var f=t.JF.canvas.offsetTop,h=t.JF.canvas.offsetLeft;i.style.opacity="1",i.style.left="".concat(h+n.caretX,"px"),i.style.top="".concat(f+n.caretY,"px"),i.style.fontFamily=n._bodyFontFamily,i.style.fontSize=n._bodyFontSize,i.style.fontStyle=n._fontStyle,i.style.padding="".concat(n.yPadding,"px ").concat(n.xPadding,"px")}else i.style.opacity="0"},callbacks:{label:function(n,e){var i=e.datasets[n.datasetIndex].label,r="".concat((0,ir.Mw)(i,!0)||i,": "),o=n.xLabel;return t.RD&&(0!==n.datasetIndex&&e.datasets.length/2!==n.datasetIndex||(o*=2)),{yLabel:n.yLabel,xLabel:"".concat(r+Math.abs(o),"%")}}}},legend:{display:!1}};return e},n.prototype.MD=function(t){var n,e,i=Math.floor(this.AD.length/2);if(this.AD.length%2==0){this.RD=!1,(r=this.AD.splice(0,i)).reverse().forEach((function(t,n){t.data=t.data.map((function(t){return-t}))})),(n=this.AD).splice.apply(n,(0,p.ev)([0,0],r,!1))}else{var r;this.RD=!0,(r=this.AD.splice(0,i+1)).reverse(),r[0].data=r[0].data.map((function(t){return+t/2}));var o=y.clone(r[0]);r.forEach((function(t){t.data=t.data.map((function(t){return-t}))})),r.push(o),(e=this.AD).splice.apply(e,(0,p.ev)([0,0],r,!1))}var s={labels:this.props.Labels.map((function(t){return t&&(0,ir.Mw)(t.toString(),!0)||t})),datasets:this.AD},a=this.LD();this.WF(),this.JF=new Chart(t,{type:"horizontalBar",data:s,options:a})},n.prototype.DD=function(){for(var t=this,n=[],e=function(t){n.push(i.props.Data.reduce((function(n,e){return n+ +e.data[t]}),0))},i=this,r=0;r<this.props.Data[0].data.length;r++)e(r);var o=[[0],[0,10],[0,5,10],[0,2,8,10],[0,2,5,8,10],[0,2,4,6,8,10],[0,2,4,5,6,8,10],[0,2,3,4,6,7,8,10],[0,2,3,4,5,6,7,8,10],[0,1,2,3,4,6,7,8,9,10]];this.oP=o[Math.min(this.props.Data.length,o.length)-1].map(Dc),this.AD=this.props.Data.map((function(e,i){var r=e.backgroundColor?e.backgroundColor:t.oP[i%t.oP.length];return{label:e.label,backgroundColor:r,hoverBackgroundColor:t.sP(""+r,10),data:e.data.map((function(t,e){return n[e]?Math.round(1e3*+t/n[e])/10:0}))}}))},n.prototype.sP=function(t,n){return y.isArray(t)?t.map((function(t){return e(t,n)})):e(t,n);function e(t,n){var e=parseInt(t.slice(1),16),i=Math.round(2.55*n),r=(e>>16)+i,o=(e>>8&255)+i,s=(255&e)+i;return"#"+(16777216+65536*(r<255?r<1?0:r:255)+256*(o<255?o<1?0:o:255)+(s<255?s<1?0:s:255)).toString(16).slice(1)}},n.prototype.tP=function(){var t=this;if(this.props.HasLegend){var n=b.findDOMNode(this.refs["legend-contaner"]),e=n.childNodes;e&&e.length>0&&(y.each(e,(function(n,e){Chart.helpers.addEvent(n,"mouseover",(function(){t.aP("mouseover",e)}))})),Chart.helpers.addEvent(n,"mouseout",(function(){t.aP("mouseout",0)})));var i=b.findDOMNode(this.refs["stacked-detail-container"]).getElementsByClassName("chart-control-detail-canvas");i&&i.length>0&&y.each(i,(function(n,e){var i=n.getContext("2d");i.fillStyle=t.props.Data[e].backgroundColor?t.props.Data[e].backgroundColor:t.oP[e%t.oP.length],i.beginPath(),i.fillRect(0,0,8,8),i.closePath(),i.fill()}))}},n.prototype.aP=function(t,n){var e=this;this.JF.active="mouseout"===t?[]:this.JF.data.datasets.map((function(t,i){return e.JF.getDatasetMeta(i).data[n]})),this.JF.lastActive=this.JF.lastActive||[],this.JF.lastActive.length&&this.JF.updateHoverStyle(this.JF.lastActive,this.JF.options.hover.mode,!1),this.JF.active.length&&this.JF.updateHoverStyle(this.JF.active,this.JF.options.hover.mode,!0);var i=!Chart.helpers.arrayEquals(this.JF.active,this.JF.lastActive);if(i){this.JF.lastActive=this.JF.active;var r=this.JF.tooltip;r._active=this.JF.active,r._lastActive=r._lastActive||[],r.update(!0),r.pivot();var o=this.JF._bufferedRequest;o?this.JF.render(o.duration,o.lazy):i&&!this.JF.animating&&(this.JF.stop(),this.JF.render(this.JF.options.hover.animationDuration,!0)),this.JF._bufferedRender=!1,this.JF._bufferedRequest=null}},n.prototype.zF=function(){if(this.props.HasLegend){var t={className:"chart-likert-control-legend",tabIndex:-1,ref:"legend-contaner"};t["aria-label"]=(0,T.pm)().ChartControl_LegendGroup;var n=this.props.Labels.map((function(t,n){var e=t?t.toString():"";return g.createElement("div",{className:"chart-likert-control-legend-row",key:n},g.createElement("span",{className:"chart-likert-control-legend-label",title:e&&(0,ir.Mw)(e,!0)||e},g.createElement(cr.D,{Text:e,RenderMode:"RichText",ContainsHtml:!0})))}));return g.createElement("div",(0,p.pi)({},t),n)}},n.prototype.QF=function(){var t=(0,vt.fM)()<400||(0,vt.tq)(),n=t?300:432,e=18+48*this.props.Labels.length,i={className:"chart-control-canvas",width:n,height:e=t?300*e/350:e,ref:"canvas","aria-label":(0,T.pm)().ChartControl_AriaLabel};return g.createElement("div",(0,p.pi)({},{className:"chart-likert-control",tabIndex:-1}),g.createElement("canvas",(0,p.pi)({},i)))},n.prototype.PD=function(){return g.createElement("div",{className:"chart-likert-control-detail-container",ref:"stacked-detail-container"},this.props.Data.map((function(t){return g.createElement("div",{className:"chart-likert-control-detail-item","aria-label":t.label,key:t.label},g.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"8",height:"8"}),g.createElement(cr.D,{Text:t.label,RenderMode:"RichText",ContainsHtml:!0}))})))},n}(J.r),el=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.getPreviewImageName=function(){return"bar.png"},n.prototype.createStackedBarControlContainer=function(){var t=this.props.AggregationMaster.Model.LikertQuestionAggregation;if(t.LikertResults.length&&t.Options.length){for(var n=_.d.convertToArray(t.Options),e=[],i=function(i){e[i]={label:n[i],data:y.map(t.LikertResults,(function(t){return t.Statistics[i]}))}},r=0;r<t.Options.length;r++)i(r);var o={Data:e,Type:2,Labels:y.map(t.LikertResults,(function(t){return t.SubQuestionName})),HasLegend:!0};return g.createElement(nl,(0,p.pi)({},o,{key:"likertChartControl"}))}},n.prototype.createQuestionViewContent=function(){return[this.createStackedBarControlContainer()]},n}($c),il=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return g.createElement(Wc,{AggregationMaster:this.props.AggregationMaster})},n}(el),rl={ArrowAngle:60,ArrowHeight:12,BackgroundColor:"#F2F2F2",BorderColors:["#FF9224",Vi.tu],BorderWidth:12,Bottom:0,CircleMargin:3,Color:"#333",FontFamily:"'wf_segoe-ui_normal','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif",FontSize:12,LabelSize:15,ScoreColors:["#B15509","#333",Vi.tu],ScoreFontFamily:"'wf_segoe-ui_semibold','Segoe UI Semibold','Segoe WP Semibold','Segoe UI','Segoe WP',Tahoma, Arial, sans-serif",ScoreFontSizes:[38,45],Top:16},ol=180,sl=10*Math.PI/ol,al=45*Math.PI/ol,ul=function(){function t(t,n,e){this.OD=t,this.ie(n,e),this._D(t)}return t.prototype.destroy=function(){this.OD.clearRect(0,0,this.OD.canvas.width,this.OD.canvas.height)},t.prototype.ie=function(t,n){this.BD=y.extend({},rl,n);var e=this.BD,i=e.Color,r=e.FontSize,o=e.Top,s=e.Bottom,a=e.CircleMargin,u=e.BorderWidth,c=e.FontFamily;this.OD.font="".concat(r,"px ").concat(c),this.OD.fillStyle=i,this.OD.textAlign="center",this.OD.textBaseline="middle";var l=this.OD.canvas.width,f=this.OD.canvas.height;this.GD=Math.min((l-2*(u+a))/2,(f-o-u-2*a-s)/2);var h=this.GD+o+a+u;this.OD.translate(this.OD.canvas.width/2,h),this.qD=this.GD+a+u,this.VD=t},t.prototype._D=function(t){this.zD(t),this.QD(t),this.UD(t)},t.prototype.QD=function(n){n.save();var e=Math.sin(sl)*this.qD,i=this.qD+2,r=i;"rtl"===this.OD.direction&&(r+=26),t.drawText(n,r,e,"+100","start","middle"),t.drawText(n,0,-i,"0","center","bottom"),t.drawText(n,-r,e,"-100","end","middle"),n.restore()},t.prototype.UD=function(n){var e,i,r,o=this.BD,s=o.ScoreColors,a=o.ScoreFontSizes;this.VD>=0?(i=0!==this.VD?s[2]:s[1],e=this.VD-90):(i=s[0],e=this.VD-90),r=100===Math.abs(this.VD)?a[0]:a[1];var u=t.fitScoreText(this.OD,"100",this.GD/Math.cos(al));r=Math.min(r,u);var c=Math.tan(this.BD.ArrowAngle/2*Math.PI/ol)*this.BD.ArrowHeight;this.$D(n,this.VD.toString(),e,this.GD,this.BD.ArrowHeight,c,r,i)},t.prototype.$D=function(n,e,i,r,o,s,a,u){t.drawDial(n,i,r,o,s,this.BD.BackgroundColor),n.save(),t.drawText(n,0,this.GD/2,"NPS®",void 0,void 0,"".concat(this.BD.LabelSize,"px ").concat(this.BD.FontFamily)),n.fillStyle=u,t.drawText(n,0,-.25*a,e,void 0,void 0,"bold ".concat(a,"px ").concat(this.BD.ScoreFontFamily)),n.restore()},t.drawDial=function(t,n,e,i,r,o){var s=e+i;t.save(),t.fillStyle=o,t.rotate(n*Math.PI/ol),t.beginPath(),t.moveTo(s,0);var a=r/e,u=Math.asin(a);t.arc(0,0,e,-u,u,!0),t.fill(),t.restore()},t.prototype.zD=function(n){var e=this.BD,i=e.BorderWidth,r=e.BorderColors;t.drawDoughnut(n,0,0,sl,-90*Math.PI/ol,this.qD,i,r[1],!0),t.drawDoughnut(n,0,0,-90*Math.PI/ol,-190*Math.PI/ol,this.qD,i,r[0],!0),n.clearRect(-1,-this.qD,2,i)},t.fitScoreText=function(t,n,e){t.save();var i=14;for(t.font="bold ".concat(i,"px Arial");t.measureText(n).width<e;)i++,t.font="bold ".concat(i,"px Arial");return t.restore(),i},t.drawDoughnut=function(t,n,e,i,r,o,s,a,u){t.save(),t.beginPath(),t.fillStyle=a,t.arc(n,e,o,i,r,u),t.save(),t.rotate(r),t.lineTo(o-s,0),t.restore(),t.arc(n,e,o-s,r,i,!u),t.fill(),t.restore()},t.drawText=function(t,n,e,i,r,o,s){r&&(t.textAlign=r),o&&(t.textBaseline=o),s&&(t.font=s),t.fillText(i,n,e)},t}(),cl=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.jD=g.createRef(),n}return(0,p.ZT)(n,t),n.prototype.render=function(){if(this.VF()){var t={className:"chart-control-container",tabIndex:-1};return t["aria-label"]=(0,T.pm)().ChartControl_GroupContainer,g.createElement("div",(0,p.pi)({},t),this.zF(),this.QF())}return null},n.prototype.componentDidMount=function(){this.$F()},n.prototype.shouldComponentUpdate=function(t){return!y.isEqual(this.props,t)||!this.jF},n.prototype.componentDidUpdate=function(){this.$F()},n.prototype.componentWillUnmount=function(){this.WF()},n.prototype.VF=function(){return this.props.Labels&&this.props.Data&&this.props.Labels.length===this.props.Data.length&&this.props.Labels.length>0},n.prototype.WF=function(){this.JF&&(this.JF.destroy(),this.JF=null)},n.prototype.$F=function(){if(this.VF()){var t=this.jD.current;if(this.jF=$(t).is(":visible"),this.jF){var n=t.getContext("2d");this.WF(),this.JF=new ul(n,this.props.Score,{BorderColors:["#FF9224",Vi.B7],ScoreColors:["#B15509","#333",Vi.B7]})}}},n.prototype.zF=function(){if(this.props.HasLegend){var t={className:"chart-control-legend",tabIndex:-1};return t["aria-label"]=(0,T.pm)().ChartControl_LegendGroup,g.createElement("div",(0,p.pi)({},t),g.createElement("table",{className:"chart-control-legend-table"},g.createElement("tbody",null,this.WD())))}},n.prototype.WD=function(){var t=this,n="";return this.props.Labels.map((function(e,i){return n="".concat(t.props.Labels[i],". ").concat((0,T.pm)().AnalyzeView_NumberOfResponses_AccessibilityLabel.format(t.props.Data[i])),g.createElement("tr",{className:"nps-chart-control-legend-table-row",key:i},g.createElement("td",{"aria-hidden":!0,role:"presentation",className:"chart-control-legend-label"},t.props.Labels[i]),g.createElement("td",{"aria-label":n,className:"chart-control-legend-value"},t.props.Data[i]))}))},n.prototype.QF=function(){var t={className:"chart-control",tabIndex:-1};t["aria-label"]=(0,T.pm)().ChartControl_ChartValueForNPS.format(this.props.Score);var n={height:150,ref:this.jD,width:300,"aria-label":(0,T.pm)().ChartControl_AriaLabel};return g.createElement("div",(0,p.pi)({},t),g.createElement("canvas",(0,p.pi)({},n)))},n}(J.r),ll=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.getPreviewImageName=function(){return"nps.png"},n.prototype.createQuestionViewContent=function(){var t=this.props.AggregationMaster.Model.NPSQuestionAggregation,n=t.ResponseCount,e=[t.Promoters,t.Passives,t.Detractors],i=e.map((function(t){return t&&Math.round(100*t/n)})),r=[(0,T.pm)().NPS_Promoters,(0,T.pm)().NPS_Passives,(0,T.pm)().NPS_Detractors];return[g.createElement(cl,{key:"chartControl",Data:e,HasLegend:!0,Labels:r,Percentage:i,Score:i[0]-i[2]})]},n}($c),fl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return g.createElement(Wc,{AggregationMaster:this.props.AggregationMaster})},n}(ll),hl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){if(this.VF()){var t={className:"chart-control-container chart-stacked-control-container",tabIndex:-1};return t["aria-label"]=(0,T.pm)().ChartControl_GroupContainer,g.createElement("div",(0,p.pi)({},t),this.zF(),this.QF())}return null},n.prototype.componentWillMount=function(){this.DD()},n.prototype.componentDidMount=function(){this.$F()},n.prototype.shouldComponentUpdate=function(t){return!y.isEqual(this.props,t)||!this.jF},n.prototype.componentDidUpdate=function(){this.$F()},n.prototype.componentWillUnmount=function(){this.WF()},n.prototype.VF=function(){return this.props.Labels&&this.props.Labels.length>0&&this.props.Data&&this.props.Data.length>0},n.prototype.WF=function(){this.JF&&(this.JF.destroy(),this.JF=null)},n.prototype.$F=function(){if(this.VF()){var t=b.findDOMNode(this.refs.canvas);if(this.jF=$(t).is(":visible"),this.jF){var n=t.getContext("2d");this.MD(n),this.tP()}}},n.prototype.LD=function(){return{responsive:!1,scales:{xAxes:[{gridLines:{display:!1,drawTicks:!0,drawBorder:!0},ticks:{display:!1,min:0,max:100},stacked:!0}],yAxes:[{gridLines:{display:!1,drawTicks:!1,drawBorder:!0},ticks:{display:!1},stacked:!0}]},tooltips:{enabled:!0,filter:function(t){return 0!==t.xLabel},callbacks:{title:function(t){return t.length?""+t[0].yLabel:""},label:function(t,n){return n.datasets[t.datasetIndex].label+": "+t.xLabel+"%"}}},legend:{display:!1}}},n.prototype.MD=function(t){var n={labels:this.props.Labels.map((function(t){return t&&(0,ir.Mw)(t.toString(),!0)||t})),datasets:this.AD},e=this.LD();this.WF(),this.JF=new Chart(t,{type:"horizontalBar",data:n,options:e})},n.prototype.DD=function(){for(var t=this,n=[],e=function(t){n.push(i.props.Data.reduce((function(n,e){return n+ +e.data[t]}),0))},i=this,r=0;r<this.props.Data[0].data.length;r++)e(r);var o=[[0],[0,10],[0,5,10],[0,2,8,10],[0,2,5,8,10],[0,2,4,6,8,10],[0,2,4,5,6,8,10],[0,2,3,4,6,7,8,10],[0,2,3,4,5,6,7,8,10],[0,1,2,3,4,6,7,8,9,10]];this.oP=o[Math.min(this.props.Data.length,o.length)-1].map(Dc),this.AD=this.props.Data.map((function(e,i){var r=e.backgroundColor?e.backgroundColor:t.oP[i%t.oP.length];return{label:e.label,borderWidth:1,borderColor:Vi.Ej,backgroundColor:r,hoverBackgroundColor:t.sP(""+r,10),data:e.data.map((function(t,e){return n[e]?Math.round(1e3*+t/n[e])/10:0}))}}))},n.prototype.sP=function(t,n){return y.isArray(t)?t.map((function(t){return e(t,n)})):e(t,n);function e(t,n){var e=parseInt(t.slice(1),16),i=Math.round(2.55*n),r=(e>>16)+i,o=(e>>8&255)+i,s=(255&e)+i;return"#"+(16777216+65536*(r<255?r<1?0:r:255)+256*(o<255?o<1?0:o:255)+(s<255?s<1?0:s:255)).toString(16).slice(1)}},n.prototype.tP=function(){var t=this;if(this.props.HasLegend){var n=b.findDOMNode(this.refs["legend-table"]),e=b.findDOMNode(this.refs["legend-table-tbody"]).childNodes;e&&e.length>0&&(y.each(e,(function(n,e){Chart.helpers.addEvent(n,"mouseover",(function(){t.aP("mouseover",e)}))})),Chart.helpers.addEvent(n,"mouseout",(function(){t.aP("mouseout",0)})));var i=b.findDOMNode(this.refs["stacked-detail-container"]).getElementsByClassName("chart-control-detail-canvas");i&&i.length>0&&y.each(i,(function(n,e){var i=n.getContext("2d");i.fillStyle=t.AD[e].backgroundColor,i.beginPath(),i.fillRect(0,0,10,10),i.closePath(),i.fill()}))}},n.prototype.aP=function(t,n){var e=this;this.JF.active="mouseout"===t?[]:this.JF.data.datasets.map((function(t,i){return e.JF.getDatasetMeta(i).data[n]})),this.JF.lastActive=this.JF.lastActive||[],this.JF.lastActive.length&&this.JF.updateHoverStyle(this.JF.lastActive,this.JF.options.hover.mode,!1),this.JF.active.length&&this.JF.updateHoverStyle(this.JF.active,this.JF.options.hover.mode,!0);var i=!Chart.helpers.arrayEquals(this.JF.active,this.JF.lastActive);if(i){this.JF.lastActive=this.JF.active;var r=this.JF.tooltip;r._active=this.JF.active,r._lastActive=r._lastActive||[],r.update(!0),r.pivot();var o=this.JF._bufferedRequest;o?this.JF.render(o.duration,o.lazy):i&&!this.JF.animating&&(this.JF.stop(),this.JF.render(this.JF.options.hover.animationDuration,!0)),this.JF._bufferedRender=!1,this.JF._bufferedRequest=null}},n.prototype.zF=function(){var t=this;if(this.props.HasLegend){var n={className:"chart-control-legend",tabIndex:-1};n["aria-label"]=(0,T.pm)().ChartControl_LegendGroup;var e=void 0,i=void 0;return 0===this.props.Type?(e=g.createElement("tr",{className:"chart-control-legend-table-title"},g.createElement("th",{className:"chart-control-legend-label"}," "),g.createElement("th",{className:"chart-control-legend-value"}," ")),i=this.props.Labels.map((function(n,e){var i=n?n.toString():"";return g.createElement("tr",{className:"chart-control-legend-table-row",key:e},g.createElement("td",{role:"presentation",className:"chart-control-legend-label",title:i&&(0,ir.Mw)(i,!0)||i},g.createElement(cr.D,{Text:i,RenderMode:"RichText",ContainsHtml:!0})),g.createElement("td",{role:"presentation",className:"chart-control-legend-value"},t.AD[0].data[e]+"%"))}))):(e=g.createElement("tr",{className:"chart-control-legend-table-title"},g.createElement("th",{role:"presentation",className:"chart-control-legend-value"},(0,T.pm)().AnalyzeView_Chart_Rank),g.createElement("th",{role:"presentation",className:"chart-control-legend-label"},(0,T.pm)().AnalyzeView_Chart_Options)),i=this.props.Labels.map((function(n,e){var i=n?n.toString():"";return g.createElement("tr",{className:"chart-control-legend-table-row",key:e},g.createElement("td",{role:"presentation",className:"chart-control-legend-value"},t.props.yLabels[e]),g.createElement("td",{role:"presentation",className:"chart-control-legend-label",title:i&&(0,ir.Mw)(i,!0)||i},g.createElement(cr.D,{Text:(0,du.fq)(i),RenderMode:"RichText",ContainsHtml:!0})))}))),g.createElement("div",(0,p.pi)({},n),g.createElement("table",{className:"chart-control-legend-table",ref:"legend-table"},g.createElement("thead",null,e),g.createElement("tbody",{ref:"legend-table-tbody"},i)))}},n.prototype.QF=function(){var t=(0,vt.fM)()<400||(0,vt.tq)(),n=t?300:350,e=10+31*this.props.Labels.length,i={className:"chart-control-canvas",width:n,height:e=t?300*e/350:e,ref:"canvas","aria-label":(0,T.pm)().ChartControl_AriaLabel};return g.createElement("div",(0,p.pi)({},{className:"chart-control chart-control-stacked",tabIndex:-1}),this.PD(),g.createElement("canvas",(0,p.pi)({},i)))},n.prototype.PD=function(){var t=this;if(1===this.props.Type){var n=(0,T.pm)().AnalyzeView_Chart_Pick;return g.createElement("div",{className:"chart-control-stacked-detail-container",ref:"stacked-detail-container"},this.props.Labels.map((function(e,i){return 0===i?g.createElement("div",{className:"chart-control-stacked-detail-item",key:i.toString()},g.createElement("span",null,n.format((0,T.pm)().Ordinal_Numera_First)),g.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"10",height:"10"})):i===t.props.Labels.length-1?g.createElement("div",{className:"chart-control-stacked-detail-item",key:i.toString()},g.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"10",height:"10"}),g.createElement("span",null,n.format((0,T.pm)().Ordinal_Numera_Last))):g.createElement("div",{className:"chart-control-stacked-detail-item",key:i.toString()},g.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"10",height:"10"}))})))}return g.createElement("div",{className:"chart-control-stacked-detail-container",ref:"stacked-detail-container"},this.props.Data.map((function(t){return g.createElement("div",{className:"chart-control-stacked-detail-item",key:t.label},g.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"10",height:"10"}),g.createElement("span",null,t.label))})))},n}(J.r),dl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.getPreviewImageName=function(){return"bar.png"},n.prototype.createQuestionViewContent=function(){return[this.createStackedBarControlContainer()]},n}($c),ml=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return g.createElement(Wc,{AggregationMaster:this.props.AggregationMaster})},n.prototype.createStackedBarControlContainer=function(){var t=_.d.convertToArray(this.props.AggregationMaster.Model.RankingQuestionAggregation);if(t&&t.length>0){var n=[],e=[];t.forEach((function(t,i){n.push(t.Statistics[0]),e.push(t.Statistics[1])}));var i=[{backgroundColor:"#06B65F",label:(0,T.pm)().AnalyzeView_Correct,data:n},{backgroundColor:"#FF1225",label:(0,T.pm)().AnalyzeView_InCorrect,data:e}];return g.createElement(hl,{Type:0,Labels:t.map((function(t){return t.Name})),Data:i,HasLegend:!0,key:"rankingChartControl"})}},n}(dl),vl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.getPreviewImageName=function(){return"rating.png"},n.prototype.createQuestionViewContent=function(){return[this.wD(),this.KD()]},n.prototype.componentDidMount=function(){this.JD()},n.prototype.componentDidUpdate=function(){this.JD()},n.prototype.JD=function(){$(".rateit").rateit();var t=b.findDOMNode(this.refs.star);t&&$(t).rateit("value",this.XD())},n.prototype.wD=function(){var t={Data:this.props.AggregationMaster.Model.RatingQuestionAggregation.ResponseCount,Description:(0,T.pm)().Common_Responses_Text,Ignorable:!1,IsReady:!0,AccessibilityText:(0,T.pm)().AnalyzeView_NumberOfResponses_AccessibilityLabel.format(this.props.AggregationMaster.Model.RatingQuestionAggregation.ResponseCount)};return g.createElement(Jc.V,(0,p.pi)({},t,{key:"responseCount"}))},n.prototype.KD=function(){switch(this.props.AggregationMaster.QuestionMaster.Model.RatingShape){case D.le.Number:return this.tM();case D.le.Star:default:return this.nM()}},n.prototype.tM=function(){return g.createElement("div",{className:"survey-analyze-view-rating-container",key:"numberAverage"},g.createElement("a",{className:"screenReaderVisible",role:"presentation"},"".concat(this.XD(),". ").concat((0,T.pm)().AnalyzeView_Average_Result)),g.createElement("div",{"aria-hidden":!0,className:"analyze-average-rating simple-data-control-content office-form-theme-primary-foreground"},this.XD()),g.createElement("div",{"aria-hidden":!0,className:"analyze-view-summary-status-label"},(0,T.pm)().AnalyzeView_Average_Result))},n.prototype.nM=function(){var t=(0,hs.w)({Disabled:!0,HTMLAttributes:{className:"analyze-view-details-rating office-form-theme-primary-foreground",title:this.XD().toFixed(2).toString()},Length:this.props.AggregationMaster.QuestionMaster.Model.Length,onValueChange:void 0,ShowRatingLabel:!1,Value:this.XD(),key:"rateit",RatingShape:this.props.AggregationMaster.QuestionMaster.Model.RatingShape});return g.createElement("div",{className:"survey-analyze-view-rating-container",key:"starAverage"},t,g.createElement("div",{className:"analyze-view-summary-status-label"},(0,T.pm)().AnalyzeView_Average_Rating.format(this.XD().toFixed(2))))},n.prototype.XD=function(){var t=this.props.AggregationMaster.Model.RatingQuestionAggregation.AverageRating;return t?Math.round(100*t)/100:0},n}($c),gl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return g.createElement(Wc,{AggregationMaster:this.props.AggregationMaster})},n}(vl),pl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.getPreviewImageName=function(){return"text.png"},n.prototype.createQuestionViewContent=function(){return[this.createResponsesCountLabel(),this.createLatestTextsView()]},n.prototype.createResponsesCountLabel=function(){var t={Data:this.props.AggregationMaster.Model.TextQuestionAggregation.ResponseCount,Description:(0,T.pm)().Common_Responses_Text,Ignorable:!1,IsReady:!0,AccessibilityText:(0,T.pm)().AnalyzeView_NumberOfResponses_AccessibilityLabel.format(this.props.AggregationMaster.Model.TextQuestionAggregation.ResponseCount)};return g.createElement(Jc.V,(0,p.pi)({},t,{key:"responseCount"}))},n.prototype.createLatestTextsView=function(){var t=this.props.AggregationMaster.Model.TextQuestionAggregation.ResponseCount,n=(0,ca.sv)()&&t>0&&h.Pv.Resolve("IMobileDesignPageUXFactory").createMobileResponseDetailEntrance(this.props.onShowQuestionDetail);return g.createElement("div",{className:"survey-analyze-view-detail-text-recent",key:"latestResponses"},g.createElement("a",{className:"screenReaderVisible",role:"presentation"},"".concat((0,T.pm)().Analyze_View_Text_Recent_Responses).concat(this.iM)),g.createElement("div",{"aria-hidden":!0,className:"analyze-view-summary-status-label"},(0,T.pm)().Analyze_View_Text_Recent_Responses),this.FD(),n)},n.prototype.FD=function(){var t=this,n=_.d.convertToArray(this.props.AggregationMaster.Model.TextQuestionAggregation.TopAnswers);return this.iM="",y.map(n,(function(n,e){if(!(t.props.AggregationMaster.Model.IsMathQuestion&&n.Answer.length>120)){if(n.IsMath){var i=(0,er.Rq)({Formula:'"'.concat(n.Answer,'"')});return t.iM="".concat(t.iM," .").concat(i),g.createElement("div",{"aria-hidden":!0,className:"analyze-view-detail-text-lines",key:e},i)}return t.iM="".concat(t.iM,' ."').concat(n.Answer,'"'),g.createElement("div",{"aria-hidden":!0,className:"analyze-view-detail-text-lines",key:e},'"'.concat(n.Answer,'"'))}}))},n}($c),bl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return g.createElement(Wc,{AggregationMaster:this.props.AggregationMaster})},n.prototype.createQuestionViewContent=function(){return this.props.AggregationMaster.QuestionMaster.hasCorrectAnswers()?[this.mD()]:[t.prototype.createResponsesCountLabel.call(this),t.prototype.createLatestTextsView.call(this)]},n.prototype.mD=function(){var t=this.rM(),n=y.map(t,(function(t){var n;return n=t.IsMath?(0,er.Rq)({Formula:t.Text}):(0,cr.q)({Text:t.Text,RenderMode:"RichText"}),{labelData:t.Count,labelName:t.Text,displayElement:n}})),e={Animation:this.props.AggregationMaster.Model.IsAggregationReady,Data:{data:t.map((function(t){return t.Count}))},Labels:n,HasLegend:!0,TagLabels:this.oM(),Type:t.length<=5?1:0};return g.createElement(Rc,(0,p.pi)({},e,{key:"chartControl"}))},n.prototype.rM=function(){var t=_.d.convertToArray(this.props.AggregationMaster.Model.TextQuestionAggregation.TextSummary),n=y.last(t);return n&&"answer_other"===n.Text&&(t[t.length-1].Text=(0,T.pm)().AnalyzeView_Chart_Others.format(n.Count)),t},n.prototype.oM=function(){var t={},n=new it.E(this.props.AggregationMaster.QuestionMaster.Model);return y.forEach(n.getAnswers(),(function(n){return t[n.answer]=!0})),t},n}(pl),yl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=this.QuestionMaster.Model,n=(0,ir.wg)(t.Title,t.FormsProRTQuestionTitle);return g.createElement("div",{className:"analzye-view-detail-title"},g.createElement(cr.D,{Text:n,RenderMode:"RichText",ContainsHtml:!0}))},Object.defineProperty(n.prototype,"QuestionMaster",{get:function(){return this.props.AggregationMaster.QuestionMaster},enumerable:!1,configurable:!0}),n}(J.r),wl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return g.createElement(yl,{AggregationMaster:this.props.AggregationMaster})},Object.defineProperty(n.prototype,"CorrectOptions",{get:function(){return{}},enumerable:!1,configurable:!0}),n.prototype.createDisplayElement=function(t){return null},n.prototype.shouldShowInsightEntryPoint=function(){return!0},n}(jc),Sl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return g.createElement(yl,{AggregationMaster:this.props.AggregationMaster})},n}(Zc),Nl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return g.createElement(yl,{AggregationMaster:this.props.AggregationMaster})},n}(Yc),Cl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return g.createElement(yl,{AggregationMaster:this.props.AggregationMaster})},n}(el),Il=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return g.createElement(yl,{AggregationMaster:this.props.AggregationMaster})},n}(ll),Tl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return g.createElement(yl,{AggregationMaster:this.props.AggregationMaster})},n.prototype.createStackedBarControlContainer=function(){var t=_.d.convertToArray(this.props.AggregationMaster.Model.RankingQuestionAggregation);if(t&&t.length>0){for(var n=t.length,e=[(0,T.pm)().AnalyzeView_Sort_First,(0,T.pm)().AnalyzeView_Sort_Second,(0,T.pm)().AnalyzeView_Sort_Third,(0,T.pm)().AnalyzeView_Sort_Fourth,(0,T.pm)().AnalyzeView_Sort_Fifth,(0,T.pm)().AnalyzeView_Sort_Sixth,(0,T.pm)().AnalyzeView_Sort_Seventh,(0,T.pm)().AnalyzeView_Sort_Eighth,(0,T.pm)().AnalyzeView_Sort_Ninth,(0,T.pm)().AnalyzeView_Sort_Tenth],i=(0,T.pm)().AnalyzeView_Chart_Pick,r=[],o=0;o<n;o++)r[o]={label:i.format(e[o]||o+1),data:[]};var s=[],a=t[0].Weight,u=1;y.forEach(t,(function(t,n){a!==t.Weight&&u++,s.push(u),a=t.Weight,y.forEach(t.Statistics,(function(e,i){r[i].data[n]=t.Statistics[i]}))}));var c={Type:1,Labels:t.map((function(t){return t.Name})),Data:r,HasLegend:!0,yLabels:s};return g.createElement(hl,(0,p.pi)({},c,{key:"rankingChartControl"}))}},n}(dl),kl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return g.createElement(yl,{AggregationMaster:this.props.AggregationMaster})},n.prototype.shouldShowInsightEntryPoint=function(){return!0},n}(vl),xl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createQuestionTitleContent=function(){return g.createElement(yl,{AggregationMaster:this.props.AggregationMaster})},n.prototype.shouldShowInsightEntryPoint=function(){return!0},n}(pl);function Fl(t,n){var e=n+t.AggregationMaster.QuestionType,i=function(t,n){if(t===lu.Survey)switch(n){case"Question.NPS":return Il;case"Question.FileUpload":return Nl;case"Question.TextField":return xl;case"Question.MatrixChoiceGroup":return Cl;case"Question.Rating":return kl;case"Question.Choice":return wl;case"Question.DateTime":return Sl;case"Question.Ranking":return Tl}else if(t===lu.Quiz)switch(n){case"Question.NPS":return fl;case"Question.FileUpload":return tl;case"Question.TextField":return bl;case"Question.MatrixChoiceGroup":return il;case"Question.Rating":return gl;case"Question.Choice":return Kc;case"Question.DateTime":return Xc;case"Question.Ranking":return ml}}(n,t.AggregationMaster.QuestionType);if(i)return t.key=t.key||t.AggregationMaster.Model.QuestionId,g.createElement(i,t);throw Error('Type "'.concat(e,'" has not been registered.'))}var Pl=function(t){function n(n){var e=t.call(this,n)||this;return e.NP=function(){e.isComponentMounted&&e.forceUpdate()},e.sM=function(){(0,$u.Ai)(e.props.FormMaster.Model.Flags)&&(0,Zs.r)((0,T.pm)().Error_Message_Is_Moving_Data_V2,"Warning")},e.aM=function(){e.sM(),e.NP()},e.uM=function(){var t=null,n=e.props.FormMaster.Model.PermissionTokens;if(n.length>0){var i=y.filter(n,(function(t){return"AnalyzerToken"===t.Type&&t.Name===(0,X.dD)()}))[0];if(i)_.d.getObjectMasterFromModel(i).Synchronizer.existingInDataSource().then((function(){t=n[0].PrincipalId,e.setState({ShareResultToken:t})}))}else e.setState({ShareResultToken:t})},e.cM=e.cM.bind(e),e.lM=e.lM.bind(e),e.Ux=e.Ux.bind(e),e.hM=e.hM.bind(e),e.dM=e.dM.bind(e),e.mM=e.mM.bind(e),e.gM=e.gM.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){this.initialize(),this.registerObservers(),this.pM(),this.props.FormMaster.observe(this.cM,[F.x.Schema.ReputationTier]),(0,Wa.s$)()&&this.formInsightMaster&&(this.formInsightMaster.observe(this.dM,[Zu.Schema.IsReady]),(0,I.cr)("GetInsightPerResponseChange")&&this.props.FormMaster.observe(this.gM,[F.x.Schema.ResponsesCount]))},n.prototype.render=function(){var t=(0,ca.sv)()&&this.state.DetailDialogQuestionIndex>=0;return g.createElement("div",{className:"analyze-view-container",id:"analyzeViewPrintContainer",role:"main"},this.Ta(),this.SM(),this.createOpenInExcelThrottleDialog(),this.createQuestionDetailDialog(),t&&this.NM(),this.createInsightViewContainer(),this.CM(),g.createElement(Ka.w,{ThemeMaster:this.props.FormMaster.ThemeMaster}))},n.prototype.componentDidMount=function(){var t,n,e=this;if(this.isComponentMounted=!0,this.TM(),t=(0,rn.dg)()-Ps(),Ts=t,this.props.FormMaster.SyncContext===eu.y.DesignTimeForm)(0,q.$U)("DesignPage.Responses.Navigate"),(n=this.props.FormMaster,n.Synchronizer.existingInDataSource().then((function(){var t=tc(n);if(!t)return null;var e=(0,Xu.R)(t);return e?e.Synchronizer.existingInDataSource().then((function(){return e.Model.PrincipalId})):void 0}))).then((function(t){e.setState({ShareResultToken:t})})).catch((function(){e.setState({ShareResultToken:null})}));else if(this.props.FormMaster.SyncContext!==eu.y.AnalysisTimeForm){var i="Fatal Error: AnalyzeViewBase.componentDidMount SyncContext: ["+this.props.FormMaster.SyncContext+"] shouldn't come to analyize view";throw(0,q.zU)("InvalidServerAggregatePayload",i),Error(i)}(0,Wu.x4)(this.props.FormMaster)},n.prototype.componentDidUpdate=function(){this.TM(),window.setTimeout(Wu.Tl,0)},n.prototype.componentWillUnmount=function(){this.unregisterObservers(),this.formAggregationMaster&&(this.formAggregationMaster.terminateSync(),this.formAggregationMaster.release()),this.props.FormMaster.unobserve(this.cM),(0,Wa.s$)()&&this.formInsightMaster&&(this.formInsightMaster.unobserve(this.dM),(0,I.cr)("GetInsightPerResponseChange")&&this.props.FormMaster.unobserve(this.gM))},n.prototype.initialize=function(){this.formAggregationMaster=new Vu(this.props.FormMaster),(0,Wa.s$)()&&(this.formInsightMaster=new Zu(this.props.FormMaster),this.props.FormMaster.SyncContext!==eu.y.AnalysisTimeForm&&this.formInsightMaster.loadInsight())},n.prototype.registerObservers=function(){if(this.sM(),this.props.FormMaster.observe(this.aM,[F.x.Schema.Flags]),this.formAggregationMaster.observe(this.NP,[Vu.Schema.SummaryAggregation]),this.props.FormMaster.SyncContext!==eu.y.AnalysisTimeForm){var t=_.d.getCollectionMasterFromModel(this.props.FormMaster.Model.PermissionTokens);t.observe(this.uM,[t.Schema[0].PrincipalId])}},n.prototype.unregisterObservers=function(){this.props.FormMaster.unobserve(this.aM),this.formAggregationMaster&&this.formAggregationMaster.unobserve(this.NP),this.props.FormMaster.SyncContext!==eu.y.AnalysisTimeForm&&_.d.getCollectionMasterFromModel(this.props.FormMaster.Model.PermissionTokens).unobserve(this.uM)},n.prototype.pM=function(){var t=this;Promise.all([(0,Pr.y)("DataTables"),(0,Pr.y)("Chart"),(0,Pr.y)("D3")]).then((function(){t.setState({LibraryLoaded:!0})}))},Object.defineProperty(n.prototype,"SummaryPanelProps",{get:function(){var t,n=this;return this.FM()&&(t=function(){return n.PM()}),{AggregationMaster:uu(this.formAggregationMaster.Model.SummaryAggregation),Form:this.props.FormMaster,onDeleteResponses:function(){return n.DM()},onExportExcel:t,onPrint:function(){return n.LM()},onCreatePermissionToken:function(){return n.RM()},onDeletePermissionToken:function(){return n.AM()},PermissionToken:this.state.ShareResultToken}},enumerable:!1,configurable:!0}),n.prototype.createInsightViewContainer=function(){return null},Object.defineProperty(n.prototype,"FocusRef",{set:function(t){this.EM=t},enumerable:!1,configurable:!0}),n.prototype.SM=function(){var t=this,n=(0,$u.yH)(uu(this.formAggregationMaster.Model.SummaryAggregation),this.props.FormMaster.Model.Flags),e=(0,$u.Ai)(this.props.FormMaster.Model.Flags);return(0,et.pd)((function(){return g.createElement("div",{className:"analyze-view-content",id:"analyzeViewPrintChildContainer"},n&&!e&&t._M(),t.HM(),t.createSummaryPanel(),!n&&g.createElement(g.Fragment,null,t.Vo(),t.createOpenInExcelThrottleMessage()),n&&t.GM(e),!n&&t.qM())}),et.t1)},n.prototype.NM=function(){var t=this.props.FormMaster,n=this.state.DetailDialogQuestionIndex,e=t.FormElementManager.TopQuestionMasters[n];return h.Pv.Resolve("IMobileDesignPageUXFactory").createMobileResponseDetailPage({FormId:t.Model.Id,onBack:this.lM,QuestionId:e.Model.Id,QuestionOrder:n+1,QuestionType:e.Model.Type,ResponseCount:t.Model.ResponsesCount,FormAggregationMaster:this.formAggregationMaster})},n.prototype.GM=function(t){var n=this.props.FormMaster;if(n.Synchronizer.isFieldReady(F.x.Schema.ArchivedRowCount)){var e=Math.floor((n.Model.ResponsesCount+n.Model.ArchivedRowCount)/1e3);return(0,q.$U)("WarmToCold.DownloadCSVEnabled",{responseCountRank:e}),g.createElement(wc,{$form:this.props.FormMaster,$isMovingResponseData:t})}},n.prototype._M=function(){return g.createElement(Sc,null)},n.prototype.HM=function(){var t=this.props.FormMaster,n=t.isFieldReady(F.x.Schema.FormsProRTTitle)?(0,ir.wg)(t.Model.Title,t.Model.FormsProRTTitle):t.Model.Title;return!(0,ca.sv)()&&g.createElement("div",{className:"analyze-view-formname",role:"heading","aria-level":1},g.createElement(cr.D,{Text:n,RenderMode:"RichText",ContainsHtml:!0}))},n.prototype.Ta=function(){if(((0,St.gq)()||!(0,ht.yv)())&&!this.props.isDesignTimeView)return g.createElement(Da.d,{FormMaster:this.props.FormMaster,HTMLAttributes:{className:"analyze-view-dataclassification-label"},DesignTimeView:this.props.isDesignTimeView})},n.prototype.Vo=function(){var t;if((0,ca.sv)()||(t=this.VM()),this.formAggregationMaster.FormMaster.SyncContext!==eu.y.AnalysisTimeForm)return g.createElement("div",{className:"analyze-view-nav-bar"},this.createExtensionReviewContent(),t)},n.prototype.Ux=function(t){this.setState({ShowExcelThrottleDialog:t})},n.prototype.createOpenInExcelThrottleDialog=function(){return function(t){switch(t.throttleDialogType){case 2:case 1:return g.createElement(kc,(0,p.pi)({},t));default:return null}}({throttleDialogType:this.state.ShowExcelThrottleDialog,showExcelThrottleDialog:this.Ux})},n.prototype.createOpenInExcelThrottleMessage=function(){var t,n={throttleDialogType:this.state.ShowExcelThrottleDialog,showExcelThrottleDialog:this.Ux};return 3===(t=n).throttleDialogType?g.createElement(kc,(0,p.pi)({},t)):null},n.prototype.VM=function(){return g.createElement("div",{className:"analyze-view-export-to-excel-button"},g.createElement(Tc,{Form:this.formAggregationMaster.FormMaster,showExcelThrottleDialog:this.Ux}))},n.prototype.qM=function(){if(this.state.LibraryLoaded)return g.createElement("div",{className:"analyze-view-detail-content"},this.zM(),this.UM())},n.prototype.zM=function(){return this.props.FormMaster.Model.ResponsesCount>0?this.$M():null},n.prototype.$M=function(){var t=this,n=_.d.convertToArray(this.formAggregationMaster.Model.QuestionAggregations),e=0;return n.map((function(n,i){var r,o,s=_u(n);if(!(s&&s.QuestionMaster&&s.QuestionMaster.Model.GroupId)){if(t.formAggregationMaster.FormMaster.SyncContext!==eu.y.AnalysisTimeForm){var a=e;r=function(){t.onDetailViewLinkClick(a)},o=function(){t.hM(a)}}return Fl({AggregationMaster:s,Index:e++,QuestionViewInsight:{FormInsightMaster:t.formInsightMaster,InsightExploreViewOpened:t.state.InsightExploreViewOpened,InsightExploreViewIndex:t.state.InsightExploreViewIndex,InsightReady:t.state.InsightReady,onClickInsightButton:o,onCloseInsightExploreView:t.mM},onShowQuestionDetail:r},t.QuestionClassType)}}))},n.prototype.UM=function(){if(this.props.FormMaster.Model.ResponsesCount>0)return g.createElement("div",{className:"analyze-view-detail-noresponses-container",key:"empty-questions-view",role:"status"});var t=(0,T.pm)().Analysis_Page_No_Responses_Message;return g.createElement("div",{className:"analyze-view-detail-noresponses-container",key:"empty-questions-view",role:"status"},g.createElement("div",{className:"analyze-view-warning-icon"},g.createElement(V.F,{FluentIcon:"Emoji Sad"})),g.createElement("div",{className:"analyze-view-detail-noresponse-message","aria-label":t},t),g.createElement("div",{className:"analyze-view-detail-noresponse-detail"},(0,T.pm)().Analysis_Page_No_Responses_Details))},n.prototype.CM=function(){if(this.state.ShowPhishingWarningMessage&&(0,St.M5)()&&this.props.FormMaster.SyncContext===eu.y.DesignTimeForm)return(0,ms.vw)({formId:this.props.FormMaster.Model.Id})},n.prototype.DM=function(){var t=this;(0,q.$U)("DesignPage.Responses.DeleteAllResponses"),this.props.FormMaster.deleteAllResponses().then((function(){(0,Zs.qU)("DeleteAllResponses",t.props.FormMaster.Model.Id),t.props.FormMaster.refreshFormResponsesCount(),(0,$u.kR)(t.props.FormMaster.Model.Flags)&&t.props.FormMaster.Synchronizer.query([F.x.Schema.Flags])})).catch((function(n){(0,Zs.bh)("DeleteAllResponses",n,t.props.FormMaster.Model.Id)}))},n.prototype.FM=function(){return!(0,ca.sv)()&&this.props.FormMaster.SyncContext!==eu.y.AnalysisTimeForm&&this.props.FormMaster.isFieldReady(F.x.Schema.XlWorkbookId)&&!!this.props.FormMaster.Model.XlWorkbookId},n.prototype.PM=function(){(0,q.$U)("DesignPage.Responses.OpenInExcel"),(0,ju.Wr)(this.props.FormMaster.Model.Id,!1)},n.prototype.LM=function(){var t=$("#analyzeViewPrintChildContainer").appendTo($("body")),n=$("#content-root"),e=$("#FormCenterHeader");n.hide(),e.hide(),(0,ti.B6)((function(){t.appendTo($("#analyzeViewPrintContainer")),n.show(),e.show()}))},n.prototype.RM=function(){var t,n,e,i,r,o=this;return(t=this.props.FormMaster,n="AnalyzerToken",e=(0,X.dD)(),i=_.d.Collection.addItems(t.Model.PermissionTokens,[Yu(n,e)]),r=(0,Xu.R)(i[0]),r.Synchronizer.existingInDataSource().then((function(){return r.Model.PrincipalId}))).then((function(t){return(0,q.$U)("DesignPage.Share.CreateAnalysisResulttLink"),o.setState({ShareResultToken:t}),t}))},n.prototype.AM=function(){var t=this,n=this.props.FormMaster,e=tc(n);e&&function(t,n){if(n)return _.d.Collection.deleteItems(t.Model.PermissionTokens,[n]),(0,Xu.R)(n).Synchronizer.deletedFromDataSource().then()}(n,e).then((function(){(0,q.$U)("DesignPage.Share.DeleteAnalysisResultLink"),t.setState({ShareResultToken:null})}))},n.prototype.onDetailViewLinkClick=function(t){(0,q.$U)("DesignPage.Responses.ShowResponsesDetail"),this.setState({DetailDialogQuestionIndex:t})},n.prototype.TM=function(){var t=b.findDOMNode(this);if($(t).is(":visible")&&!this.WM){var n=b.findDOMNode(this.refs[this.EM]);this.EM=void 0,n&&n.focus()}this.WM=$(t).is(":visible")},n.prototype.cM=function(){var t=this.props.FormMaster.Model;this.setState({ShowPhishingWarningMessage:(0,K.NT)(t.ReputationTier)})},n.prototype.lM=function(){this.setState({DetailDialogQuestionIndex:-1})},n.prototype.dM=function(){this.formInsightMaster&&this.formInsightMaster.Model.InsightCount>0?this.setState({InsightReady:!0}):this.setState({InsightReady:!1})},n.prototype.hM=function(t){this.setState({InsightExploreViewOpened:!0,InsightExploreViewIndex:t})},n.prototype.mM=function(){this.setState({InsightExploreViewOpened:!1})},n.prototype.gM=function(){this.formInsightMaster.loadInsight()},n}(J.r),Dl=function(){function t(){}return t.isAutogradableQuestion=function(t){var n=y.some(t.Choices,(function(t){return t.IsAnswerKey})),e="Question.TextField"===t.Type&&!t.Multiline&&new it.E(t).areAnyAnswersDefined(),i="Question.Ranking"===t.Type&&0!==JSON.parse(t.GradingBasis).length;return t.IsQuiz&&(n||e||i)},t.isCorrectAnswer=function(t,n){return t.Master.isCorrectAnswer(n[t.Field])},t.onDeleteCurrentResponse=function(t,n){(0,q.$U)("DesignPage.Responses.DeleteSingleResponse"),t.bulkEdit((function(){t.Model.Responses=y.without(t.Model.Responses,y.findWhere(t.Model.Responses,{Id:n}))}))},t}();function Ml(t){return g.createElement(Ll,t)}var Ll=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.bP=g.createRef(),n.wP=g.createRef(),n.SP=g.createRef(),n.yP=g.createRef(),n}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){this.bP.current&&this.bP.current.focus(),(0,kr.mZ)(b.findDOMNode(this)),this.CP(),this.IP()},n.prototype.shouldComponentUpdate=function(t,n){var e=!y.isEqual(t,this.props),i=!y.isEqual(n,this.state);return e||i},n.prototype.componentDidUpdate=function(){var t=this,n=this.props.AnalyzeViewData.Questions.filter((function(n){return n.Field===t.props.QuestionId}))[0];this.KM(n).length>0&&(this.CP(),this.IP())},n.prototype.componentWillUnmount=function(){},n.prototype.render=function(){var t=this;return g.createElement("div",{className:"response-dialog-container",onKeyDown:function(n){(8===n.keyCode||37===n.keyCode&&n.altKey)&&(n.stopPropagation(),n.preventDefault()),27===n.keyCode&&t.props.closeSelf()}},this.TP(),this.JM(),this.PP())},n.prototype.JM=function(){var t=this,n=this.props.AnalyzeViewData,e=n.Questions.filter((function(n){return n.Field===t.props.QuestionId}))[0],i=g.createElement("div",{className:"response-dialog-title"},(0,cr.q)({Text:(0,T.pm)().AnalyzeView_QuestionTitle.format(e.Index+1,e.Model.Title),RenderMode:"RichText"})),r=this.KM(e),o=g.createElement("div",{className:"response-dialog-summary"},g.createElement("div",{className:"response-dialog-response-count office-form-theme-primary-foreground"},r.length),(0,T.pm)().Common_Responses_Text),s=g.createElement("button",{ref:this.bP,className:"response-dialog-close-button",title:(0,T.pm)().Common_Close_Text,onClick:function(){return t.props.closeSelf()}},(0,V.M)({FluentIcon:"Dismiss",HTMLAttributes:{className:"forms-icon-size16x16"}})),a={"aria-label":(0,T.pm)().AnalyzeView_Detail_DialogTitle.format(e.Index+1),className:"response-dialog",ref:this.SP,role:"dialog"};if(0===r.length){var u=g.createElement("div",{className:"response-dialog-no-responses-message"},(0,T.pm)().AnalyzeView_DetailResponses_NoResponses_Message);return g.createElement("div",a,s,i,o,u)}var c=g.createElement("div",{className:"response-dialog-content",ref:this.yP},g.createElement("div",{className:"response-dialog-table-container"},g.createElement("table",{className:"response-dialog-table hover stripe cell-border"})));"Question.FileUpload"===y.findWhere(n.Questions,{Field:this.props.QuestionId}).Model.Type&&(o=this.ZM(r));var l=g.createElement("div",{ref:this.wP},s,i,o);return g.createElement("div",a,l,c)},n.prototype.ZM=function(t){var n=this;if(t[0][this.props.QuestionId]){var e=(0,Fr.E)({HTMLAttributes:{className:"response-dialog-folder-button office-form-theme-button",onClick:function(){var t=n.props,e=y.findWhere(t.AnalyzeViewData.Questions,{Field:t.QuestionId}),i=e.Model.FileUploadSPOInfo;i&&i.folderId&&new qc.L(e.Master.Form).getFileFolder(i.folderId).then((function(t){(0,q.$U)("DesignPage.Responses.OpenFileFolder"),(0,$s.K)(t)})).catch((function(t){t&&t.response&&404===t.response.statusCode&&n.setState({ShowErrorMessage:!0})}))}},ButtonStyle:1,Text:(0,T.pm)().UploadFile_OpenFolder_Button}),i=this.state.ShowErrorMessage?g.createElement("div",{className:"response-dialog-folder-button-error-message"},(0,T.pm)().UploadFile_FolderNotExist_ErrorMessage):void 0;return g.createElement("div",null,g.createElement("div",{className:"response-dialog-summary"},g.createElement("div",{className:"response-detail-dialog-container"},g.createElement("span",{className:"response-dialog-response-count office-form-theme-primary-foreground"},t.length),(0,T.pm)().UploadFile_Files_DetailPage_Subtitle),e),i)}},n.prototype.PP=function(){var t=this,n=this.props.AnalyzeViewData.Questions.filter((function(n){return n.Field===t.props.QuestionId}))[0];if(null!=this.props.goToNextModalCallback&&n.Index!==this.props.AnalyzeViewData.Questions.length-1){var e={className:"response-dialog-next-button",title:(0,T.pm)().AnalyzeView_DetailResponses_Next_Button,onClick:function(){t.props.goToNextModalCallback(),setTimeout((function(){t.bP.current&&t.bP.current.focus()}),0)}};return(0,z.F)({HTMLAttributes:e,FluentIcon:"Chevron Right",GlyphButtonStyle:"GlyphOnly",ButtonStyle:2})}},n.prototype.TP=function(){var t=this,n=this.props.AnalyzeViewData.Questions.filter((function(n){return n.Field===t.props.QuestionId}))[0];if(null!=this.props.goToPreviousModalCallback&&0!==n.Index)return(0,z.F)({HTMLAttributes:{className:"response-dialog-previous-button",onClick:function(){t.props.goToPreviousModalCallback(),setTimeout((function(){t.bP.current&&t.bP.current.focus()}),0)}},FluentIcon:"Chevron Left",GlyphButtonStyle:"GlyphOnly",ButtonStyle:2,Text:(0,T.pm)().AnalyzeView_DetailResponses_Previous_Button})},n.prototype.QP=function(t,n,e){var i=[(0,T.pm)().AnalyzeView_Sort_First,(0,T.pm)().AnalyzeView_Sort_Second,(0,T.pm)().AnalyzeView_Sort_Third,(0,T.pm)().AnalyzeView_Sort_Fourth,(0,T.pm)().AnalyzeView_Sort_Fifth,(0,T.pm)().AnalyzeView_Sort_Sixth,(0,T.pm)().AnalyzeView_Sort_Seventh,(0,T.pm)().AnalyzeView_Sort_Eighth,(0,T.pm)().AnalyzeView_Sort_Ninth,(0,T.pm)().AnalyzeView_Sort_Tenth],r=[(0,T.pm)().Common_Responses_Text],o=[{title:(0,T.pm)().AnalyzeView_Response_ID},{title:(0,T.pm)().AnalyzeView_ExcelHeader_ResponderName}],s=this.XM(n),a=[],u=60/s+"%";switch(t){case"Question.Ranking":$(".response-dialog-table").addClass("response-dialog-table-ranking"),a=y.first(i,s);break;case"Question.MatrixChoiceGroup":a=r;for(var c=1;c<s;c++)a.push("");break;case"Question.NPS":a=[(0,T.pm)().AnalyzeView_NPS_Score,(0,T.pm)().AnalyzeView_NPS_Category];break;default:$(".response-dialog-table").removeClass("response-dialog-table-ranking"),a=r}return a=a.map((function(t){return{title:t,width:u}})),e&&a.push({title:(0,T.pm)().AnalyzeView_Quiz_Validation,width:u}),o.concat(a)},n.prototype.CP=function(){var t,e=this,i=this.props,r=i.AnalyzeViewData,o=y.findWhere(r.Questions,{Field:i.QuestionId}),s=Dl.isAutogradableQuestion(o.Model);this.YM&&($(".dataTables_wrapper").remove(),$(".response-dialog-table").remove(),$(".response-dialog-table-container").append("<table class='response-dialog-table hover stripe cell-border'></table>"),this.YM.destroy(),this.YM=void 0);var a=this.KM(o).map((function(t){return t.field_responder_name=(0,pt.F1)(t.field_responder_name,!0),t}));if("Question.Ranking"===o.Model.Type){var u=this.XM(i.QuestionId),c=o.Model.ChoiceGroup;t=a.map((function(t,n){var i=[];i=[n+1,t.field_responder_name];var r=t[o.Field]||[],a=r.slice(0,Math.min(r.length,u)).sort((function(t,n){return t.answerOrder-n.answerOrder})).map((function(t,n){return s?"<span style='color:"+(c[n].Id===t.id?"#107C10":"#A80000")+"'>"+e.tL(t.displayText)+"</span>":e.tL(t.displayText)}));i=i.concat(a);for(var l=0;l<u-a.length;l++)i.push("");return s&&i.push(o.Master.isCorrectAnswer(t[o.Field])),i}))}else"Question.MatrixChoiceGroup"===o.Model.Type?(t=a.map((function(t,n){var i=[n+1,t.field_responder_name],r=y.map(o.Master.SubQuestionMasters,(function(n){var i="field_"+n.Model.Id;return t[i]?e.tL(t[i].displayText):""}));return i.concat(r)}))).splice(0,0,["",""].concat(y.map(o.Master.SubQuestionMasters,(function(t){return e.tL(t.Model.Title)})))):"Question.FileUpload"===o.Model.Type?(t=[],a.forEach((function(n,r){var a="";if(n[i.QuestionId]){var u=JSON.parse(n[i.QuestionId]);if(u.length>0){var c=u,l=[r+1,n.field_responder_name];c.forEach((function(t,n){var i=(0,L.UV)(t.name),r=e.nL(t.name),o=t.link.split('"')[0];n+1!==c.length?a+=i+'<a href="'.concat(o,"\" target='_blank' class='response-dialog-fileName'>").concat(r,"</a></br>"):a+=i+'<a href="'.concat(o,"\" target='_blank' class='response-dialog-fileName'>").concat(r,"</a>")})),l.push(a),s&&l.push(Dl.isCorrectAnswer(o,n)),t.push(l)}}}))):t="Question.NPS"===o.Model.Type?a.map((function(t,n){var e=t[i.QuestionId];return[n+1,t.field_responder_name,e,(0,cs.J)(e)]})):a.map((function(t,n){var r=[n+1,t.field_responder_name,e.tL(t[i.QuestionId])];return o.Model.IsMathQuiz&&r.push(t[i.QuestionId+"_math"]),s&&r.push(Dl.isCorrectAnswer(o,t)),r}));var l=s?1:0;l+=o.Model.IsMathQuiz?1:0,this.YM=$(".response-dialog-table").DataTable({data:s?t.map((function(t){var n=t.slice(0,t.length-l);return n.push(""),n})):t,columns:this.QP(o.Model.Type,i.QuestionId,s),searching:!1,paging:!1,info:!1,autoWidth:!0,rowCallback:function(e,i,r){if(s){var a=t[i[0]-1][t[0].length-1],u=n.createCorrectnessIcon(a),c=$(e).find("td:eq("+(t[0].length-l)+")").get(0);i[i.length-1]=a,b.render(u,c)}if(o.Model.IsMathQuiz)if("Question.TextField"===o.Model.Type){var f=t[i[0]-1][t[0].length-l];if(f){var h=$(e).find("td:eq("+(t[0].length-l-1)+")").get(0),d=(0,er.Rq)({Formula:i[2]});b.render(d,h)}i[t[0].length-1]=f}else if("Question.Choice"===o.Model.Type){var m=i[2],v=$(e).find("td:eq("+(t[0].length-l-1)+")").get(0);if(o.Model.ChoiceType===D.T6.MultiChoice){var w,S=[];try{S=JSON.parse(m),w=["["]}catch(t){}S&&S.length>0?(y.forEach(S,(function(n){y.forEach(o.Model.Choices,(function(e){if(n===e.Description)return i[t[0].length-1]=e.IsMathOption,w.push('"'),e.IsMathOption?w.push((0,er.Rq)({Formula:n})):w.push(n),w.push('",'),!1}))})),w.pop(),w.push('"]'),b.render(g.createElement.apply(g,(0,p.ev)(["div",{className:"multi-formula-response-row"}],w,!1)),v)):y.forEach(o.Model.Choices,(function(n){if(m===n.Description){if(n.IsMathOption){var e=(0,er.Rq)({Formula:m});b.render(e,v)}return i[t[0].length-1]=n.IsMathOption,!1}}))}else y.forEach(o.Model.Choices,(function(n){if(m===n.Description){if(n.IsMathOption){var e=(0,er.Rq)({Formula:m});b.render(e,v)}return i[t[0].length-1]=n.IsMathOption,!1}}))}}})},n.prototype.IP=function(){var t=$(this.SP.current).height()-$(this.wP.current).outerHeight(!0);$(this.yP.current).outerHeight(t)},n.prototype.nL=function(t){return t&&(0,pt.F1)("".concat(t),!0)},n.prototype.tL=function(t){return(0,du.ZP)(t)},n.prototype.KM=function(t){var n=this.props,e=n.AnalyzeViewData.Answers;n.ShouldIncludeInvalidAnswers||(e=e.filter((function(n){return Uu.hasValidAnswer(n,t)})));var i=n.filterResponses;return null!=i&&(e=e.filter(i)),e},n.createCorrectnessIcon=function(t){return t?g.createElement("div",{title:(0,T.pm)().GradingView_CorrectAnswer_AccessibilityLabel},g.createElement("a",{className:"screenReaderVisible"},(0,T.pm)().GradingView_CorrectAnswer_AccessibilityLabel),(0,V.M)({FluentIcon:"Checkmark",HTMLAttributes:{className:"forms-icon-size16x16 office-form-right-answerkey"}})):g.createElement("div",{title:(0,T.pm)().GradingView_IncorrectAnswer_AccessibilityLabel},g.createElement("a",{className:"screenReaderVisible"},(0,T.pm)().GradingView_IncorrectAnswer_AccessibilityLabel),(0,V.M)({HTMLAttributes:{className:"forms-icon-size16x16 office-form-wrong-answerkey"},IconName:"Cancel"}))},n.prototype.XM=function(t){var n=y.findWhere(this.props.AnalyzeViewData.Questions,{Field:this.props.QuestionId});switch(n.Model.Type){case"Question.Ranking":return n.Model.ChoiceGroup.length||1;case"Question.MatrixChoiceGroup":return n.Master.SubQuestionMasters.length||1;case"Question.NPS":return 2;default:return 1}},n}(J.r),Rl=e(66022),Al=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.statisticsContent=function(){if((0,$u.yH)(this.props.AggregationMaster,this.props.Form.Model.Flags))return null;if(this.props.AggregationMaster.isAverageResultEnabled){var n=this.eL(),e=String(n),i={AccessibilityText:(0,T.pm)().AnalyzeView_Average_Score_Explicit.format(e),Data:e,Description:(0,T.pm)().AnalyzeView_Average_Score,Ignorable:!0,IsReady:0===this.props.AggregationMaster.Model.TotalResponseCount||this.IsAggregationReady||this.IsAggregationFailed};return g.createElement(Jc.V,(0,p.pi)({},i))}return t.prototype.statisticsContent.call(this)},n.prototype.eL=function(){var t=this.props.AggregationMaster;return 0===t.Model.TotalResponseCount?0:this.IsAggregationReady?Number((t.Model.AverageScore||0).toFixed(1)):-1},n}(Rl.y);var El=function(t){function n(n){var e=t.call(this,n)||this;e.iL=function(t){return e.rL(t)},e.createQuestionDetailDialog.bind(e);var i=e.props.FormMaster.Model;return e.state={IsAnalyzeDataReady:!1,LibraryLoaded:!1,DetailDialogQuestionIndex:-1,ShareResultToken:null,InsightDialogOpened:(0,k.f5)().Model.DataIdeas,InsightExploreViewIndex:-1,InsightExploreViewOpened:!1,InsightReady:!1,InsightType:null,ShowPhishingWarningMessage:(0,K.NT)(i.ReputationTier),ShowExcelThrottleDialog:0},e.oL=e.oL.bind(e),e.aL=e.aL.bind(e),e.uL=e.uL.bind(e),e}return(0,p.ZT)(n,t),Object.defineProperty(n.prototype,"QuestionClassType",{get:function(){return lu.Quiz},enumerable:!1,configurable:!0}),n.prototype.createSummaryPanel=function(){return t=this.SummaryPanelProps,g.createElement(Al,(0,p.pi)({},t));var t},n.prototype.registerObservers=function(){t.prototype.registerObservers.call(this),this.props.FormMaster.observe(this.iL,[F.x.Schema.ResponsesCount,F.x.Schema.Questions])},n.prototype.unregisterObservers=function(){t.prototype.unregisterObservers.call(this),this.props.FormMaster.unobserve(this.iL)},n.prototype.createExtensionReviewContent=function(){var t=this;if(!(0,ca.sv)()){var n=this.props.FormMaster.Model.ResponsesCount>0,e=this.props.FormMaster.Model.QuizQuestionsCount>0,i=n&&e,r=(0,Fr.E)({HTMLAttributes:{className:"analyze-view-nav-button office-form-theme-button",onClick:function(){window.ClickReviewAnswersStart=new Date,t.FocusRef="review-answers-button";var n=(0,k.f5)();n.bulkEdit((function(){n.Model.Grading=zu.ByStudent,n.Model.TopView="Grading_ReviewAnswers"}))},disabled:!i},ButtonStyle:1,Text:(0,T.pm)().AnalyzeView_GradingButton_Label,ref:"review-answers-button"}),o=!(0,c.k0)().userInfo.IsMsa&&(0,Fr.E)({HTMLAttributes:{className:"analyze-view-nav-button office-form-theme-button",onClick:function(){(0,q.$U)("DesignPage.Responses.ReleaseResults"),t.FocusRef="post-grades-button",t.cL().then((function(){(0,k.f5)().Model.TopView="Grading_PostGrades"}))},disabled:!i},ButtonStyle:1,Text:(0,T.pm)().AnalyzeView_ReleaseResultsButton_Label,ref:"post-grades-button"});return g.createElement("div",{className:"analyze-view-nav-bar-left-button-container"},r,o)}},n.prototype.createQuestionDetailDialog=function(){var t=this.state.DetailDialogQuestionIndex,n=_.d.convertToArray(y.filter(this.props.FormMaster.Model.Questions,(function(t){return!t.GroupId})));if(!(t<0)){if(!(t>=n.length))return this.state.IsAnalyzeDataReady?this.JM(t,n):void this.cL();(0,q.zU)("UnexpectedDetailQuestionIndex",{index:String(t)})}},n.prototype.JM=function(t,n){return Ml({QuestionId:"field_"+n[t].Id,AnalyzeViewData:this.lL,goToNextModalCallback:this.oL,goToPreviousModalCallback:this.aL,closeSelf:this.uL})},n.prototype.oL=function(){var t=this.state.DetailDialogQuestionIndex,n=_.d.convertToArray(y.filter(this.props.FormMaster.Model.Questions,(function(t){return!t.GroupId})));t>=0&&t<n.length-1&&((0,q.$U)("DesignPage.Responses.DetailDialogQuestionNavigate",{entry:"NextQuestion"}),this.setState({DetailDialogQuestionIndex:t+1}))},n.prototype.aL=function(){var t=this.state.DetailDialogQuestionIndex,n=_.d.convertToArray(y.filter(this.props.FormMaster.Model.Questions,(function(t){return!t.GroupId})));t>0&&t<n.length&&((0,q.$U)("DesignPage.Responses.DetailDialogQuestionNavigate",{entry:"PreviouseQuestion"}),this.setState({DetailDialogQuestionIndex:t-1}))},n.prototype.uL=function(){this.setState({DetailDialogQuestionIndex:-1})},n.prototype.cL=function(){var t=this,n=Promise.resolve();return this.state.IsAnalyzeDataReady||this.props.FormMaster.Model.Responses&&this.props.FormMaster.Model.Responses.length||(n=this.props.FormMaster.syncFormResponses()),n.then((function(){return Uu.createAnalyzeViewData(t.props.FormMaster)})).then((function(n){t.lL=n,t.setState({IsAnalyzeDataReady:!0})}))},n.prototype.rL=function(t){var n=t.NewValues.ResponsesCount!=t.OldValues.ResponsesCount,e=!y.isEqual(t.NewValues.Questions,t.OldValues.Questions);this.setState({IsAnalyzeDataReady:!n&&!e&&!!this.lL})},n}(Pl),Ol=e(34990),_l=function(t){function n(n){var e=t.call(this,n)||this;return e.state={HasTextCompliment:!!e.props.Insight.TextComplimentCluster&&!!e.props.Insight.TextCompliment,HasTextImprovement:!!e.props.Insight.TextImprovementCluster&&!!e.props.Insight.TextImprovement},e}return(0,p.ZT)(n,t),n.prototype.updateContent=function(){},n.prototype.insightViewDescriptionDetail=function(){return g.createElement("div",{className:"all-hands-summary-insight-container"},g.createElement("div",{className:"all-hands-summary-insight-description"},this.fL(),this.hL(),this.mL()))},n.prototype.shouldShowSourceQuestions=function(){return!1},n.prototype.insightViewSourceQuestions=function(){return null},n.prototype.vL=function(t){var n,e,i="",r="";switch(this.props.Insight.MaxRatingScore){case 5:n=2.5,e=3.5;break;case 7:n=3.5,e=5;break;default:n=5,e=7}switch(this.props.Insight.AverageRating>=e?r=(0,T.pm)().All_Hands_Summary_Insight_Title1_High:this.props.Insight.AverageRating<e&&this.props.Insight.AverageRating>n?r=(0,T.pm)().All_Hands_Summary_Insight_Title1_Middle:this.props.Insight.AverageRating<=n&&(r=(0,T.pm)().All_Hands_Summary_Insight_Title1_Low),t){case 0:i=r;break;case 1:i=(0,T.pm)().All_Hands_Summary_Insight_Title2;break;case 2:i=(0,T.pm)().All_Hands_Summary_Insight_Title3}return g.createElement("div",{className:"all-hands-summary-insight-title","aria-label":i,tabIndex:0},i)},n.prototype.fL=function(){return g.createElement("div",null,this.vL(0),g.createElement("div",{className:"all-hands-summary-insight-row-container"},g.createElement("div",{className:"all-hands-summary-insight-row-rating"},g.createElement("div",{className:"all-hands-summary-insight-icon-and-text-rating"},g.createElement(V.F,{FluentIcon:"People Community",HTMLAttributes:{className:"forms-icon-size24x24 all-hands-summary-insight-icon-rating"}}),g.createElement("div",{className:"all-hands-summary-insight-rating-row-number","aria-label":this.props.Insight.TotalResponseCount.toString(),tabIndex:0},this.props.Insight.TotalResponseCount),g.createElement("div",{className:"all-hands-summary-insight-rating-row-text","aria-label":(0,T.pm)().All_Hands_Summary_Insight_Total_Responses_Title1+(0,T.pm)().All_Hands_Summary_Insight_Total_Responses_Title2,tabIndex:0},(0,T.pm)().All_Hands_Summary_Insight_Total_Responses_Title1,g.createElement("br",null),(0,T.pm)().All_Hands_Summary_Insight_Total_Responses_Title2)),g.createElement("div",{className:"all-hands-summary-insight-icon-and-text-rating"},g.createElement(V.F,{FluentIcon:"Star",HTMLAttributes:{className:"forms-icon-size24x24 all-hands-summary-insight-icon-rating"}}),g.createElement("div",{className:"all-hands-summary-insight-rating-row-number","aria-label":this.props.Insight.AverageRating.toString(),tabIndex:0},this.props.Insight.AverageRating.toFixed(1)),g.createElement("div",{className:"all-hands-summary-insight-rating-row-text","aria-label":(0,T.pm)().All_Hands_Summary_Insight_Average_Rating_Title1+(0,T.pm)().All_Hands_Summary_Insight_Average_Rating_Title2,tabIndex:0},(0,T.pm)().All_Hands_Summary_Insight_Average_Rating_Title1,g.createElement("br",null),(0,T.pm)().All_Hands_Summary_Insight_Average_Rating_Title2)))))},n.prototype.hL=function(){var t=this.props.Insight.LikertComplimentCluster===this.props.Insight.TextComplimentCluster,n=this.gL(3,t),e=this.gL(4,t);if(n||e)return g.createElement("div",null,this.vL(1),g.createElement("div",{className:"all-hands-summary-insight-row-container"},n,t?null:e))},n.prototype.mL=function(){var t=this.props.Insight.LikertImprovementCluster===this.props.Insight.TextImprovementCluster,n=this.gL(5,t),e=this.gL(6,t);if(n||e)return g.createElement("div",null,this.vL(2),g.createElement("div",{className:"all-hands-summary-insight-row-container"},n,t?null:e))},n.prototype.gL=function(t,n){var e,i,r,o;switch(t){case 3:e=this.props.Insight.LikertComplimentCluster,i=(0,T.pm)().All_Hands_Summary_Insight_Likert_Compliment_Description.format(this.props.Insight.LikertComplimentCluster),i=(0,Tr.Nw)(i),r="Thumb Like",o=!!this.props.Insight.LikertComplimentCluster;break;case 4:e=this.props.Insight.TextComplimentCluster,i=(0,T.pm)().All_Hands_Summary_Insight_Text_Compliment_Description.format(this.props.Insight.TextComplimentCluster),i=(0,Tr.Nw)(i),r="Gift",o=this.state.HasTextCompliment;break;case 5:e=this.props.Insight.LikertImprovementCluster,i=(0,T.pm)().All_Hands_Summary_Insight_Likert_Improvement_Description.format(this.props.Insight.LikertImprovementCluster),i=(0,Tr.Nw)(i),r="Lightbulb Filament",o=!!this.props.Insight.LikertImprovementCluster;break;case 6:e=this.props.Insight.TextImprovementCluster,i=(0,T.pm)().All_Hands_Summary_Insight_Text_Improvement_Description.format(this.props.Insight.TextImprovementCluster),i=(0,Tr.Nw)(i),r="Checkmark Circle",o=this.state.HasTextImprovement}if(n&&3===t?i=(0,T.pm)().All_Hands_Summary_Insight_Compliment_Same_Description.format(e):n&&5===t&&(i=(0,T.pm)().All_Hands_Summary_Insight_Improvement_Same_Description.format(e)),i=(0,Tr.Nw)(i),o)return g.createElement("div",{className:"all-hands-summary-insight-row"},g.createElement("div",{className:"all-hands-summary-insight-icon-and-text"},g.createElement(V.F,{HTMLAttributes:{className:"forms-icon-size24x24 all-hands-summary-insight-icon"},FluentIcon:r}),g.createElement("div",{className:"all-hands-summary-insight-row-title","aria-label":e,tabIndex:0},e)),g.createElement(nc.H,{className:"all-hands-summary-insight-row-description","aria-label":i,tabIndex:0,$html:i,$as:"div"}))},n}(Ol.N),Bl=e(85977),Hl=function(t){function n(n){var e=t.call(this,n)||this;return e.state={currentQuestion:e.props.Questions[e.props.CurrentInsightIndex],currentQuestionIndex:e.props.CurrentInsightIndex},e}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=this,n=this.state.currentQuestion,e=(0,T.pm)().AnalyzeView_Insight_Response_Sentiment_Dropdown_Option,i=e.format(n.QuestionOrder,n.Title),r=this.props.Questions.map((function(n){return{Disabled:n.Id===t.state.currentQuestion.Id,DisplayName:e.format(n.QuestionOrder,n.Title),Key:n.QuestionOrder,Value:e.format(n.QuestionOrder,n.Title)}})),o=(0,ar.E)({HTMLAttributes:{"aria-label":i,className:"response-sentiment-insight-collection-dropdown"},Label:i,onValueChange:this.pL,Placeholder:i,SelectOptions:r,Value:i});return g.createElement("div",{className:"all-hands-rating-distribution-insight-dropdown-container"},g.createElement("div",{className:"all-hands-rating-distribution-insight-dropdown-title"},(0,T.pm)().All_Hands_Insight_Dropdown_Title),g.createElement("div",{className:"insight-view-dropdown-element"},o))},n.prototype.pL=function(t){var n=this,e=(0,T.pm)().AnalyzeView_Insight_Response_Sentiment_Dropdown_Option;this.props.Questions.forEach((function(i,r){e.format(i.QuestionOrder,i.Title)!==t||n.setState({currentQuestionIndex:r},(function(){n.props.HandleInsightData(n.state.currentQuestionIndex)}))}))},n}(J.r);function Gl(t){return g.createElement(Hl,(0,p.pi)({},t))}var ql,Vl=function(t){function n(n){var e=t.call(this,n)||this;return e.state={CurrentInsight:e.props.Insight.DrivingFactorAnalysisInsights[0],CurrentInsightIndex:0,RatingValue:e.props.Insight.DrivingFactorAnalysisInsights[0].AverageRating,ShowScoreEstimater:!1},e}return(0,p.ZT)(n,t),n.prototype.updateContent=function(){},n.prototype.shouldShowSourceQuestions=function(){return!1},n.prototype.insightViewSourceQuestions=function(){return null},n.prototype.insightViewDescriptionDetail=function(){return this.state.ShowScoreEstimater?g.createElement("div",{className:"driving-factor-insight-container"},this.createDrivingFactorView()):g.createElement("div",{className:"driving-factor-insight-container"},this.createSummaryView(),this.createTopicList(),this.bL())},n.prototype.createSummaryView=function(){var t=this.yL()[0],n=(0,T.pm)().All_Hands_Driving_Factor_Analysis_Insight_Summary_Description.format(t);return n=(0,Tr.Nw)(n),g.createElement("div",{className:"driving-factor-insight-summary-container"},g.createElement("div",{className:"driving-factor-insight-summary-title-container"},g.createElement("div",{className:"driving-factor-insight-summary-title"},(0,T.pm)().All_Hands_Driving_Factor_Analysis_Insight_Summary_Title.format(t))),g.createElement("div",{className:"driving-factor-insight-summary-description-container"},g.createElement(nc.H,{className:"driving-factor-insight-summary-description",$html:n,$as:"div"})))},n.prototype.createTopicList=function(){var t=this,n=this.yL(),e=[];return n.forEach((function(n,i){var r=t.state.CurrentInsight.Importance[n];r>.2?e[i]=(0,T.pm)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_High:r>.1&&r<.2?e[i]=(0,T.pm)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_Middle:r<.1&&(e[i]=(0,T.pm)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_Low)})),g.createElement("div",{className:"driving-factor-insight-topic-list-container"},g.createElement("div",{className:"driving-factor-insight-topic-list-column-title"},g.createElement("div",{className:"driving-factor-insight-topic-list-column-topics"},(0,T.pm)().All_Hands_Driving_Factor_Analysis_Insight_Topics),g.createElement("div",{className:"driving-factor-insight-topic-list-column-impact-level"},(0,T.pm)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level)),g.createElement("div",{className:"driving-factor-insight-topic-list"},n.map((function(t,n){var i="driving-factor-insight-topic-list-item-topic",r="driving-factor-insight-topic-list-item-impact-level";return e[n]===(0,T.pm)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_High&&(i="driving-factor-insight-topic-list-item-topic-highlight",r="driving-factor-insight-topic-list-item-impact-level-highlight"),g.createElement("div",{className:"driving-factor-insight-topic-list-item",key:n},g.createElement("div",{className:i},t),g.createElement("div",{className:r},e[n]))})),g.createElement("div",{className:"driving-factor-insight-score-estimater-button",onClick:function(){t.setState({ShowScoreEstimater:!0})}},(0,T.pm)().All_Hands_Driving_Factor_Analysis_Insight_Score_Estimate)))},n.prototype.createDrivingFactorView=function(){var t=this,n=this.yL(),e=this.state.CurrentInsight.InitialPoints,i=this.state.CurrentInsight.Contributions,r=[];return n.forEach((function(n,e){var i=t.state.CurrentInsight.Importance[n];i>.2?r[e]=(0,T.pm)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_With_Title_High:i>.1&&i<.2?r[e]=(0,T.pm)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_With_Title_Middle:i<.1&&(r[e]=(0,T.pm)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_With_Title_Low)})),g.createElement("div",{className:"driving-factor-insight-score-estimater-container"},g.createElement("div",{className:"driving-factor-insight-score-estimater-title-container"},this.rs(),g.createElement("div",{className:"driving-factor-insight-score-estimater-title"},(0,T.pm)().All_Hands_Driving_Factor_Analysis_Insight_Score_Estimater_Title)),g.createElement("div",{className:"driving-factor-insight-detail-container"},g.createElement("div",{className:"driving-factor-insight-detail-description-container"},g.createElement("div",{className:"driving-factor-insight-detail-description"},(0,T.pm)().All_Hands_Driving_Factor_Analysis_Insight_Detail_Description),g.createElement("div",{className:"driving-factor-insight-detail-rating-container"},g.createElement("div",{className:"driving-factor-insight-detail-rating-title"},(0,T.pm)().All_Hands_Driving_Factor_Analysis_Insight_Detail_Rating_Title),g.createElement("div",{className:"driving-factor-insight-detail-rating-score"},this.state.RatingValue.toFixed(1)))),g.createElement("div",{className:"driving-factor-insight-key-influencer-list"},n.map((function(n,o){return g.createElement("div",{className:"driving-factor-insight-key-influencer-container",key:o},g.createElement("div",{className:"driving-factor-insight-key-influencer-title-dot"}),g.createElement("div",{className:"driving-factor-insight-key-influencer-title"},n),g.createElement("div",{className:"driving-factor-insight-key-influencer-impact-level"},r[o]),g.createElement("div",{className:"driving-factor-insight-key-influencer-slidebar-container"},g.createElement("div",{className:"driving-factor-insight-key-influencer-slidebar"},g.createElement("input",{type:"range",className:"driving-factor-insight-key-influencer-slidebar-slider",min:0,max:i[n].length-1,defaultValue:Math.floor(10*(e[n]-1)).toString(),onChange:function(e){t.wL(o,i[n][parseInt(e.target.value)])}})),g.createElement("div",{className:"driving-factor-insight-key-influencer-endpoint-left"},t.state.CurrentInsight.EndPoints.m_Item1),g.createElement("div",{className:"driving-factor-insight-key-influencer-endpoint-right"},t.state.CurrentInsight.EndPoints.m_Item2)))})))))},n.prototype.rs=function(){var t=this,n={ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"driving-factor-insight-score-estimater-back-button",onClick:function(){t.setState({RatingValue:t.state.CurrentInsight.AverageRating,ShowScoreEstimater:!1})}},FluentIcon:"Arrow Left",IconClassName:"forms-icon-size18x18"};return(0,z.F)(n)},n.prototype.yL=function(){var t=this,n=Object.keys(this.state.CurrentInsight.InitialPoints);return n.sort((function(n,e){return t.state.CurrentInsight.Importance[n]-t.state.CurrentInsight.Importance[e]})),n.reverse(),n},n.prototype.wL=function(t,n){var e=this,i=0,r=this.yL(),o=[];r.forEach((function(t,n){var i=e.state.CurrentInsight.Contributions[t];o[n]=i[Math.floor(10*(e.state.CurrentInsight.InitialPoints[t]-1))]})),o[t]=n,o.forEach((function(t){i+=t})),i+=this.state.CurrentInsight.AverageRating,this.setState({RatingValue:i})},n.prototype.NL=function(t){var n=this;this.setState({CurrentInsight:this.props.Insight.DrivingFactorAnalysisInsights[t],CurrentInsightIndex:t},(function(){n.setState({RatingValue:n.state.CurrentInsight.AverageRating})}))},n.prototype.bL=function(){return Gl({CurrentInsightIndex:this.state.CurrentInsightIndex,HandleInsightData:this.NL,Questions:this.props.Insight.DrivingFactorAnalysisInsights.map((function(t){return t.LikertQuestion}))})},n}(Ol.N),zl=function(t){function n(n){var e=t.call(this,n)||this;return e.state={CurrentInsight:e.props.Insight.LikertImpactAnalysisInsights[0],CurrentInsightIndex:0},e}return(0,p.ZT)(n,t),n.prototype.shouldShowSourceQuestions=function(){return!1},n.prototype.insightViewSourceQuestions=function(){return null},n.prototype.updateContent=function(){},n.prototype.insightViewDescriptionDetail=function(){return g.createElement("div",{className:"likert-impact-insight-container"},this.createSummaryView(),this.CL(),this.bL())},n.prototype.createSummaryView=function(){var t,n;return this.props.Insight.Flag?(t=this.state.CurrentInsight.KeyWords?(0,T.pm)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Title_Positive_Keyword.format(this.state.CurrentInsight.KeyWords[0]):(0,T.pm)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Title_Positive,n=this.state.CurrentInsight.KeyWords?(0,T.pm)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Description_Positive_Keyword.format(this.state.CurrentInsight.KeyWords[0]):(0,T.pm)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Description_Positive,n=(0,Tr.Nw)(n)):(t=this.state.CurrentInsight.KeyWords?(0,T.pm)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Title_Negative_Keyword.format(this.state.CurrentInsight.KeyWords[0]):(0,T.pm)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Title_Negative,n=this.state.CurrentInsight.KeyWords?(0,T.pm)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Description_Negative_Keyword.format(this.state.CurrentInsight.KeyWords[0]):(0,T.pm)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Description_Negative,n=(0,Tr.Nw)(n)),g.createElement("div",{className:"likert-impact-insight-summary-container"},g.createElement("div",{className:"likert-impact-insight-summary-title-container"},g.createElement("div",{className:"likert-impact-insight-summary-title"},t)),g.createElement("div",{className:"likert-impact-insight-summary-description-container"},g.createElement(nc.H,{className:"likert-impact-insight-summary-description",$html:n,$as:"div"})))},n.prototype.CL=function(){return this.IL(),g.createElement("div",{className:"likert-impact-insight-chart-container"},this.state.CurrentInsight.LikertStatement.map((function(t,n){var e=(0,T.pm)().All_Hands_Likert_Impact_Analysis_Insight_Chart_Data.format((100*t.m_Item2).toFixed(0)),i="likert-impact-insight-chart-item-dot-hidden",r="likert-impact-insight-chart-item-sentence",o="likert-impact-insight-chart-item-bar",s="likert-impact-insight-chart-item-data-hidden";return n<2&&(i="likert-impact-insight-chart-item-dot",r="likert-impact-insight-chart-item-sentence-highlight",o="likert-impact-insight-chart-item-bar-highlight",s="likert-impact-insight-chart-item-data"),g.createElement("div",{className:"likert-impact-insight-chart-item",key:n},g.createElement("div",{className:i}),g.createElement("div",{className:"likert-impact-insight-chart-item-sentence-container"},g.createElement("div",{className:r},t.m_Item1)),g.createElement("div",{className:"likert-impact-insight-chart-item-bar-container",id:"bar-"+n},g.createElement("div",{className:o})),g.createElement("div",{className:s},e))})))},n.prototype.IL=function(){var t=this,n=this.state.CurrentInsight.LikertStatement[0].m_Item2;setTimeout((function(){t.state.CurrentInsight.LikertStatement.forEach((function(t,e){document.getElementById("bar-"+e).style.width=t.m_Item2/n*220+"px"}))}),100)},n.prototype.NL=function(t){this.setState({CurrentInsight:this.props.Insight.LikertImpactAnalysisInsights[t],CurrentInsightIndex:t})},n.prototype.bL=function(){return Gl({CurrentInsightIndex:this.state.CurrentInsightIndex,HandleInsightData:this.NL,Questions:this.props.Insight.LikertImpactAnalysisInsights.map((function(t){return t.LikertGroup}))})},n}(Ol.N);!function(t){t[t.Positive=0]="Positive",t[t.Neutral=1]="Neutral",t[t.Negative=2]="Negative"}(ql||(ql={}));var Ql=function(t){function n(n){var e=t.call(this,n)||this;e.TL=e.TL.bind(e);var i=(0,ti.Ei)(y.max(e.props.Insight.ResponseSentimentInsights,(function(t){return t.Score})));return e.props.setCurrentViewInsight(i),e.state={ActiveDetail:ql.Negative,ActiveInsight:i},e}return(0,p.ZT)(n,t),n.prototype.updateContent=function(){this.state.ShowSourceDetail&&this.CP()},n.prototype.getSourceButtonTitle=function(){return this.state.ShowSourceDetail?(0,T.pm)().AnalyzeView_Insight_Response_Sentiment_Hide_Detail:(0,T.pm)().AnalyzeView_Insight_Response_Sentiment_Show_Detail},n.prototype.insightViewSourceQuestions=function(){return g.createElement("div",{className:"response-sentiment-insight-detail-container"},g.createElement("div",{className:"response-sentiment-insight-detail-buttons-container"},this.oD(ql.Negative),this.oD(ql.Neutral),this.oD(ql.Positive)),g.createElement("div",{className:"response-sentiment-insight-detail-grid-container"},g.createElement("div",{className:"response-sentiment-insight-detail-grid-wraper"})))},n.prototype.insightViewDescriptionDetail=function(){return g.createElement("div",{className:"response-sentiment-insight-container"},this.Gm(),this.kL(),this.qm())},n.prototype.Gm=function(){var t=(0,T.pm)().AnalyzeView_Insight_Response_Sentiment_Collection_Description;return g.createElement("div",{className:"insight-description-text-container"},g.createElement("div",{"aria-label":t,className:"insight-description-text",tabIndex:0},t))},n.prototype.kL=function(){var t=this.state.ActiveInsight,n=(0,T.pm)().AnalyzeView_Insight_Response_Sentiment_Dropdown_Option,e=n.format(t.TextQuestion.QuestionOrder,t.TextQuestion.Title),i=this.props.Insight.ResponseSentimentInsights.map((function(e){var i=e.TextQuestion;return{Disabled:e.TextQuestion.Id===t.TextQuestion.Id,DisplayName:n.format(i.QuestionOrder,i.Title),Key:i.QuestionOrder,Value:n.format(i.QuestionOrder,i.Title)}})),r=(0,ar.E)({HTMLAttributes:{"aria-label":e,className:"response-sentiment-insight-collection-dropdown"},Label:e,onValueChange:this.TL,Placeholder:e,SelectOptions:i,Value:e}),o=(0,T.pm)().AnalyzeView_Insight_Response_Sentiment_Dropdown_Title;return g.createElement("div",{className:"response-sentiment-insight-dropdown-container"},g.createElement("div",{className:"response-sentiment-insight-dropdown-title"},o),g.createElement("div",{className:"insight-view-dropdown-element"},r))},n.prototype.qm=function(){if(this.state.ShowSourceDetail)return null;var t=this.state.ActiveInsight,n=(0,T.pm)().AnalyzeView_Insight_Response_Sentiment_Description.format(t.TextQuestion.QuestionOrder,t.TextQuestion.Title);return g.createElement("div",{className:"response-sentiment-insight-chart-container"},g.createElement("div",{"aria-label":n,className:"response-sentiment-insight-chart",tabIndex:0},g.createElement("div",{className:"response-sentiment-insight-emojis-container"},this.xL(ql.Negative),this.xL(ql.Neutral),this.xL(ql.Positive))))},n.prototype.xL=function(t){var e,i,r,o=this.state.ActiveInsight,s=n.getOutstandingSentiments(this.state.ActiveInsight);switch(t){case ql.Positive:i="Emoji",e=(0,T.pm)().AnalyzeView_Insight_Response_Sentiment_Positive,r=o.PositiveResponses.length;break;case ql.Negative:i="Emoji Sad",e=(0,T.pm)().AnalyzeView_Insight_Response_Sentiment_Negative,r=o.NegativeResponses.length;break;case ql.Neutral:i="Emoji Meh",e=(0,T.pm)().AnalyzeView_Insight_Response_Sentiment_Neutral,r=o.NeutralResponses.length;break;default:return null}var a,u=(0,V.M)({FluentIcon:i,HTMLAttributes:{className:"response-sentiment-insight-emoji-icon"}}),c="response-sentiment-insight-element-emoji",l="response-sentiment-insight-element-title",f="response-sentiment-insight-element-number";return s.indexOf(t)>=0&&(c=(0,N.j)(c,ql[t].toLowerCase()),l=(0,N.j)(l,ql[t].toLowerCase()),f=(0,N.j)(f,ql[t].toLowerCase())),a=1===r?(0,T.pm)().AnalyzeView_Insight_Response_Sentiment_Single_Response_Count.format(r):(0,T.pm)().AnalyzeView_Insight_Response_Sentiment_Multi_Response_Count.format(r),g.createElement("div",{className:"response-sentiment-insight-emoji-container"},g.createElement("div",{className:c},u),g.createElement("div",{className:l},e),g.createElement("div",{className:f},a))},n.prototype.CP=function(){var t,n=this.state.ActiveInsight;switch(this.state.ActiveDetail){case ql.Positive:t=n.PositiveResponses;break;case ql.Negative:t=n.NegativeResponses;break;case ql.Neutral:t=n.NeutralResponses;break;default:t=new Array}var e=t.map((function(t){return[t.m_Item1,(0,Tr.Nw)(t.m_Item2.RawValue)]}));$(".response-sentiment-insight-detail-grid").remove(),$(".response-sentiment-insight-detail-grid-wraper").append("<table class='response-sentiment-insight-detail-grid hover stripe cell-border'>"),$(".response-sentiment-insight-detail-grid").DataTable({autoWidth:!0,columns:[{title:(0,T.pm)().AnalyzeView_Insight_Response_Sentiment_Id},{title:(0,T.pm)().Common_Responses_Text}],data:e,info:!1,paging:!1,searching:!1})},n.prototype.oD=function(t){var n,e=this;switch(t){case ql.Positive:n=(0,T.pm)().AnalyzeView_Insight_Response_Sentiment_Positive;break;case ql.Negative:n=(0,T.pm)().AnalyzeView_Insight_Response_Sentiment_Negative;break;case ql.Neutral:n=(0,T.pm)().AnalyzeView_Insight_Response_Sentiment_Neutral;break;default:return null}var i="response-sentiment-insight-detail-button",r="response-sentiment-insight-detail-button-header";t===this.state.ActiveDetail&&(i=(0,N.j)(i,"selected"),r=(0,N.j)(r,"selected"));var o={ButtonStyle:0,HTMLAttributes:{className:i,onClick:function(){(0,q.$U)("DesignPage.Responses.ResponseSentimentInsight.SwitchSentiment",{SentimentType:t}),e.setState({ActiveDetail:t})}},Text:n},s=g.createElement(Fr.A,(0,p.pi)({},o));return g.createElement("div",{className:"response-sentiment-insight-detail-button-container"},g.createElement("div",{className:r}),s)},n.getOutstandingSentiments=function(t){var n=[{SentimentCount:t.NegativeResponses.length,SentimentType:ql.Negative},{SentimentCount:t.NeutralResponses.length,SentimentType:ql.Neutral},{SentimentCount:t.PositiveResponses.length,SentimentType:ql.Positive}],e=(0,ti.Ei)(y.max(n,(function(t){return t.SentimentCount})));return n.filter((function(t){return t.SentimentCount===e.SentimentCount})).map((function(t){return t.SentimentType}))},n.prototype.TL=function(t){var n=this,e=(0,T.pm)().AnalyzeView_Insight_Response_Sentiment_Dropdown_Option;this.props.Insight.ResponseSentimentInsights.forEach((function(i){var r=i.TextQuestion;if(e.format(r.QuestionOrder,r.Title)===t)return(0,q.$U)("DesignPage.Responses.ResponseSentimentInsight.SwitchQuestion",{InsightScore:i.Score,QuestionId:i.TextQuestion.Id,QuestionIndex:i.TextQuestion.QuestionOrder,QuestionSentimentConfidence:i.TextQuestion.SentimentConfidence,QuestionTag:i.TextQuestion.Tag}),n.props.setCurrentViewInsight(i),void n.setState({ActiveInsight:i})}))},n}(Ol.N),Ul=function(t){function n(n){var e=t.call(this,n)||this;return e.state={CurrentInsight:e.props.Insight.AllHandsTextClusterInsights[0],CurrentInsightIndex:0,SelectedTopic:"",ShowDetails:!1},e}return(0,p.ZT)(n,t),n.prototype.shouldShowSourceQuestions=function(){return!1},n.prototype.insightViewSourceQuestions=function(){return null},n.prototype.updateContent=function(){},n.prototype.insightViewDescriptionDetail=function(){return g.createElement("div",{className:"all-hands-text-cluster-insight-container"},this.FL(),this.PL())},n.prototype.initBar=function(){var t=this,n=this.yL(),e=this.state.CurrentInsight.TextClusters[n[0]].length;setTimeout((function(){n.forEach((function(n,i){document.getElementById("topic-"+i).style.width=t.state.CurrentInsight.TextClusters[n].length/e*313+"px"}))}),100)},n.prototype.FL=function(){if(!this.state.ShowDetails)return g.createElement("div",null,g.createElement("div",{className:"all-hands-text-cluster-insight-description"},this.DL()),g.createElement("div",{className:"all-hands-text-cluster-insight-detail"},this.ML()),this.bL())},n.prototype.ML=function(){var t=this,n=this.yL();if(this.initBar(),!this.state.ShowDetails)return g.createElement("div",{className:"all-hands-text-cluster-insight-topic-list-container"},n.map((function(n,e){var i="all-hands-text-cluster-insight-topic-list-item-bar-item";return e<2&&(i="all-hands-text-cluster-insight-topic-list-item-bar-item-highlight"),g.createElement("div",{className:"all-hands-text-cluster-insight-topic-list-item",key:e,onClick:function(){t.setState({SelectedTopic:n,ShowDetails:!0})}},g.createElement("div",{className:"all-hands-text-cluster-insight-topic-list-item-title-container"},g.createElement("div",{className:"all-hands-text-cluster-insight-topic-list-item-title"},n)),g.createElement("div",{className:"all-hands-text-cluster-insight-topic-list-item-bar",id:"topic-"+e},g.createElement("div",{className:i})),g.createElement("div",{className:"all-hands-text-cluster-insight-topic-list-item-times"},(0,T.pm)().All_Hands_Text_Cluster_Insight_Selected_Topic_times.format(t.state.CurrentInsight.TextClusters[n].length)))})))},n.prototype.PL=function(){if(this.state.ShowDetails)return g.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-container"},g.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-title"},this.rs(),g.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-selected-topic-name"},this.state.SelectedTopic),g.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-selected-topic-times"},(0,T.pm)().All_Hands_Text_Cluster_Insight_Selected_Topic_times.format(this.state.CurrentInsight.TextClusters[this.state.SelectedTopic].length))),g.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-selected-topic-comment"},g.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-all-details"},g.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-comment-title"},(0,T.pm)().All_Hands_Text_Cluster_Insight_All_Details_Title),this.state.CurrentInsight.TextClusters[this.state.SelectedTopic].map((function(t,n){return g.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-sentence",key:n},(0,T.pm)().All_Hands_Text_Cluster_Insight_Topic_Detail_Text.format(t))})))))},n.prototype.rs=function(){var t=this,n={ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"all-hands-text-cluster-insight-topic-detail-back-button",onClick:function(){t.setState({ShowDetails:!1})}},FluentIcon:"Arrow Left",IconClassName:"forms-icon-size18x18"};return(0,z.F)(n)},n.prototype.DL=function(){var t,n=this.yL(),e=this.state.CurrentInsight.TargetQuestion.Tag;if(1===n.length){switch(e){case"NegativeOpinion":t=(0,T.pm)().All_Hands_Text_Cluster_Insight_Title_Single_Negative;break;case"PositiveOpinion":t=(0,T.pm)().All_Hands_Text_Cluster_Insight_Title_Single_Positive;break;default:t=(0,T.pm)().All_Hands_Text_Cluster_Insight_Title_Single_General}return t.format(n[0])}switch(e){case"NegativeOpinion":t=(0,T.pm)().All_Hands_Text_Cluster_Insight_Title_Negative;break;case"PositiveOpinion":t=(0,T.pm)().All_Hands_Text_Cluster_Insight_Title_Positive;break;default:t=(0,T.pm)().All_Hands_Text_Cluster_Insight_Title_General}return t.format(n[0],n[1])},n.prototype.yL=function(){var t=this.state.CurrentInsight.TextClusters,n=Object.keys(t).filter((function(n){return t[n].length>0}));return n.sort((function(n,e){return t[n].length-t[e].length})),n=n.reverse()},n.prototype.NL=function(t){var n=this;this.setState({CurrentInsight:this.props.Insight.AllHandsTextClusterInsights[t],CurrentInsightIndex:t},(function(){n.setState({SelectedTopic:n.yL()[0]})}))},n.prototype.bL=function(){return Gl({CurrentInsightIndex:this.state.CurrentInsightIndex,HandleInsightData:this.NL,Questions:this.props.Insight.AllHandsTextClusterInsights.map((function(t){return t.TargetQuestion}))})},n}(Ol.N);function $l(t){var n=t.Insight.Type,e=function(t){switch(t){case Ku.d.AssociationRuleInsight:return Bl.W;case Ku.d.AllHandsSummaryInsight:return _l;case Ku.d.DrivingFactorAnalysisInsightCollection:return Vl;case Ku.d.LikertImpactAnalysisInsightCollection:return zl;case Ku.d.ResponseSentimentInsightCollection:return Ql;case Ku.d.TextClusterInsight:return Ul}}(n);if(e)return g.createElement(e,(0,p.pi)((0,p.pi)({},t),{key:t.Index}));throw Error('Type "'.concat(n,'" has not been registered.'))}var jl=function(t){function n(n){var e=t.call(this,n)||this;return e.state={Feedback:0,FeedbackOptions:[]},e.LL=e.LL.bind(e),e.RL=e.RL.bind(e),e}return(0,p.ZT)(n,t),n.prototype.shouldComponentUpdate=function(t){return this.props.InsightIndex!==t.InsightIndex&&0!==this.state.Feedback&&(this.AL(),this.setState({Feedback:0,FeedbackOptions:[]})),!0},n.prototype.componentWillUnmount=function(){0!==this.state.Feedback&&this.AL()},n.prototype.render=function(){var t=2===this.state.Feedback?"insight-view-feedback-container expended":"insight-view-feedback-container";return g.createElement("div",{className:t},this.OL(),this._L())},n.prototype._L=function(){var t=this;if(2!==this.state.Feedback)return null;var n=[{key:"Visual_Not_Intuitive",value:(0,T.pm)().AnalyzeView_Insight_Feedback_Visual_Not_Intuitive},{key:"Description_Not_Clear",value:(0,T.pm)().AnalyzeView_Insight_Feedback_Description_Not_Clear},{key:"Not_Relevant",value:(0,T.pm)().AnalyzeView_Insight_Feedback_Not_Relevant},{key:"Incorrect",value:(0,T.pm)().AnalyzeView_Insight_Feedback_Incorrect},{key:"Not_Meaningful",value:(0,T.pm)().AnalyzeView_Insight_Feedback_Not_Meaningful},{key:"Too_Similar",value:(0,T.pm)().AnalyzeView_Insight_Feedback_Too_Similar}].map((function(n){var e="insight-view-feedback-option";t.state.FeedbackOptions.indexOf(n.key)>=0&&(e=(0,N.j)(e,"selected"));var i={className:e,tabIndex:0,id:n.key,title:n.value,onClick:t.BL.bind(t),onKeyDown:function(n){13!==n.keyCode&&32!==n.keyCode||t.BL(n)}};return g.createElement("span",(0,p.pi)({},i),n.value)}));return g.createElement("div",{className:"insight-view-feedback-option-container"},n)},n.prototype.OL=function(){var t=(0,N.j)("insight-view-feedback-button-like",1===this.state.Feedback?"selected":"unselected"),n=(0,N.j)("insight-view-feedback-button-dislike",2===this.state.Feedback?"selected":"unselected");return g.createElement("div",{className:"insight-view-feedback-button-container"},g.createElement("div",{"aria-label":(0,T.pm)().AnalyzeView_Insight_Feedback_Description,className:"insight-view-feedback-description",tabIndex:0},(0,T.pm)().AnalyzeView_Insight_Feedback_Description),this.HL(t,(0,T.pm)().Common_Yes_Text),this.HL(n,(0,T.pm)().Common_No_Text))},n.prototype.HL=function(t,n){return(0,Fr.E)({ButtonStyle:0,HTMLAttributes:{className:t,onClick:this.LL,onKeyDown:this.RL,tabIndex:0},Text:n})},n.prototype.LL=function(t){var n=t.currentTarget.className.indexOf("insight-view-feedback-button-like")>=0?1:2;this.GL=this.props.getCurrentViewInsight(),this.setState({Feedback:this.state.Feedback===n?0:n,FeedbackOptions:[]})},n.prototype.RL=function(t){if(13===t.keyCode||32===t.keyCode){t.preventDefault(),t.stopPropagation();var n=t.currentTarget.className.indexOf("like")>=0?1:2;this.GL=this.props.getCurrentViewInsight(),this.setState({Feedback:this.state.Feedback===n?0:n,FeedbackOptions:[]})}},n.prototype.BL=function(t){var n=this.state.FeedbackOptions,e=t.currentTarget.id;if(n.indexOf(e)>=0){var i=n.indexOf(e);n.splice(i,1)}else n.push(e);this.setState({FeedbackOptions:n})},n.prototype.AL=function(){(0,q.$U)("DesignPage.Feedback.Insights",{InsightType:this.GL.Type,InsightScore:this.GL.Score,Feedback:this.state.Feedback,FeedbackOptions:this.state.FeedbackOptions})},n}(J.r);var Wl=function(t){function n(n){var e=t.call(this,n)||this;return e.dM=function(){(0,q.$U)("DesignPage.Responses.ShowInsights",{InsightCount:e.qL.Insights.length,InsightTypes:e.qL.Insights.map((function(t){return Ku.d[t.Type]}))}),e.setState({DialogCount:e.qL.Insights.length,InsightReady:e.qL.Model.IsReady})},e.VL=function(){var t=b.findDOMNode(e.refs.insightDialog);t&&t.focus()},e.state={DialogCount:0,InsightIndex:0,InsightReady:!1,LibraryLoaded:!1,showAlert:!1},e.zL=e.zL.bind(e),e.QL=e.QL.bind(e),e.qL=new Zu(e.props.FormMaster),e.qL.observe(e.dM,[Zu.Schema.IsReady]),e.qL.loadInsight(),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){this.pM(),this.setState({showAlert:!0}),(0,kr.mZ)(b.findDOMNode(this))},n.prototype.componentWillUnmount=function(){this.qL.unobserve(this.dM)},n.prototype.render=function(){return g.createElement("div",{className:"form-insight-container"},g.createElement("div",{className:"form-insight-frost",role:"presentation"}),this.zI(),this.$L(),this.QI())},n.prototype.pM=function(){var t=this;(0,Pr.m)(["D3"]).then((function(){t.setState({LibraryLoaded:!0})}))},n.prototype.$L=function(){var t={"aria-label":(0,T.pm)().AnalyzeView_Insight_Dialog,className:"form-insight-dialog",ref:"insightDialog",tabIndex:0};if(this.state.InsightReady&&this.state.LibraryLoaded){if(0===this.qL.Insights.length)return g.createElement("div",(0,p.pi)({},t),this.KL(),this.qf(),this.JL());var n=null;if(this.state.InsightIndex<this.qL.Insights.length){var e={InsightIndex:this.state.InsightIndex,getCurrentViewInsight:this.QL};n=g.createElement(jl,(0,p.pi)({},e))}return g.createElement("div",(0,p.pi)({},t),this.KL(),this.qf(),this.XL(),n,this.UI())}return g.createElement("div",(0,p.pi)({},t),this.KL(),this.qf(),this.YL())},n.prototype.UI=function(){var t=this;if(1===this.state.DialogCount)return null;for(var n=[],e=function(e){var r="form-insight-dialog-gallery-dot";r=(0,N.j)(r,e===i.state.InsightIndex?"active":"inactive");var o={key:e,className:r,tabIndex:0,onClick:function(){t.setState({InsightIndex:e})},onKeyDown:function(n){13!==n.keyCode&&32!==n.keyCode||t.setState({InsightIndex:e})}};n.push(g.createElement("div",(0,p.pi)({},o)))},i=this,r=0;r<this.state.DialogCount;r++)e(r);return g.createElement("div",{className:"form-insight-dialog-gallery"},g.createElement("div",{className:"form-insight-dialog-gallery-dots-container"},n))},n.prototype.YL=function(){var t="";this.state.showAlert&&(t=(0,T.pm)().AnalyzeView_Insight_Loading_Message);return g.createElement("div",{"aria-live":"polite",className:"form-insight-loading-container"},g.createElement("div",{className:"form-insight-loading-animation"},g.createElement("div",{className:"common-spinner-circle"})),g.createElement("div",{className:"form-insight-loading-message"},t))},n.prototype.JL=function(){var t=(0,Tr.Nw)((0,T.pm)().AnalyzeView_Insight_Default_View_Description),n=(0,T.pm)().AnalyzeView_Insight_Default_View_Title;return g.createElement("div",{className:"form-insight-default-view-container"},g.createElement("div",{className:"form-insight-default-img-container"},g.createElement("div",{className:"form-insight-default-img"},g.createElement("img",{className:"form-insight-default-image",src:(0,zi.Jn)("/Images/insight/insight_default_pic.png")}))),g.createElement("div",{className:"form-insight-default-message-container"},g.createElement("div",{className:"form-insight-default-title",tabIndex:0},n),g.createElement(nc.H,{className:"form-insight-default-description",$html:t,tabIndex:0,$as:"div"})))},n.prototype.zI=function(){var t=this;if(this.state.InsightIndex>0&&this.state.InsightIndex<this.state.DialogCount){var n={HTMLAttributes:{className:"form-insight-dialog-previous-button",onClick:function(){(0,q.$U)("DesignPage.Responses.ClickInsightPreviousButton",{InsightCount:t.qL.Insights.length,InsightIndex:t.state.InsightIndex}),t.setState({InsightIndex:t.state.InsightIndex-1})}},FluentIcon:"Chevron Left",GlyphButtonStyle:"GlyphOnly",ButtonStyle:1,Text:(0,T.pm)().AnalyzeView_Insight_Previous_Insight};return(0,z.F)(n)}},n.prototype.QI=function(){var t=this;if(this.state.InsightIndex>=0&&this.state.InsightIndex<this.state.DialogCount-1){var n={HTMLAttributes:{className:"form-insight-dialog-next-button",onClick:function(){(0,q.$U)("DesignPage.Responses.ClickInsightNextButton",{InsightCount:t.qL.Insights.length,InsightIndex:t.state.InsightIndex}),t.setState({InsightIndex:t.state.InsightIndex+1})}},FluentIcon:"Chevron Right",GlyphButtonStyle:"GlyphOnly",ButtonStyle:1,Text:(0,T.pm)().AnalyzeView_Insight_Next_Insight};return g.createElement("div",{className:"form-insight-head-button"},(0,z.F)(n))}},n.prototype.XL=function(){var t=this.state.InsightIndex,n=this.qL.Insights;if(t>=0&&t<n.length)return $l({Insight:n[t],Index:t,focusOnInsightDialog:this.VL,setCurrentViewInsight:this.zL})},n.prototype.qf=function(){var t={HTMLAttributes:{onClick:this.props.onClose,className:"form-insight-dialog-close-button"},FluentIcon:"Dismiss",IconClassName:"forms-icon-size16x16",ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",Text:(0,T.pm)().AnalyzeView_Insight_Close_Insight};return(0,z.F)(t)},n.prototype.KL=function(){return g.createElement("div",{className:"form-insight-preview-label-container"},g.createElement("div",{className:"form-insight-preview-label"},g.createElement("div",{className:"form-insight-preview-label-text"},(0,T.pm)().Common_Preview_Text)))},n.prototype.zL=function(t){this.tR=t},n.prototype.QL=function(){return this.tR},n}(J.r);var Kl=function(t){function n(n){var e=t.call(this,n)||this;return e.nR=g.createRef(),e.eR=e.eR.bind(e),e.iR=e.iR.bind(e),e.rR=e.rR.bind(e),e.oR=e.oR.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){(0,Wa.s$)()&&this.sR()&&(0,q.$U)("DesignPage.Responses.ShowInsightEntryPoint")},n.prototype.insightContent=function(){if(!(0,Wa.s$)()||(0,ca.sv)())return null;if(this.props.AggregationMaster.FormMaster.SyncContext===eu.y.AnalysisTimeForm)return null;if(!this.sR())return null;var t=(0,T.pm)().AnalyzeView_Ideas_Button,n={HTMLAttributes:{className:"insight-view-summery-button",onClick:this.oR,onKeyDown:this.iR},ButtonStyle:0,GlyphButtonStyle:"Vertical",FluentIcon:"Flash On",IconClassName:"insight-view-summary-button-icon office-form-theme-primary-foreground",ref:this.nR,Text:t,TextClassName:"insight-view-summary-button-text"};return g.createElement("div",{className:"analyze-view-summary-table analyze-view-insight-container"},g.createElement("div",{className:"analyze-view-summary-container"},(0,z.F)(n)))},n.prototype.getAverageTimeProps=function(){return t.prototype.getAverageTimeProps.call(this)},n.prototype.eR=function(t){32!==t.keyCode&&13!==t.keyCode||this.props.onClickInsightEntryPoint("TimeDistribution")},n.prototype.rR=function(t){this.props.onClickInsightEntryPoint("TimeDistribution")},n.prototype.iR=function(t){32!==t.keyCode&&13!==t.keyCode||this.props.onClickInsightEntryPoint("Insights")},n.prototype.oR=function(t){var n=this;this.props.onClickInsightEntryPoint("Insights"),(0,kr.cz)("ideas-entry-button",(function(){n.nR&&n.nR.current&&n.nR.current.focus()}))},n.prototype.sR=function(){var t=this.props,n=t.Form.Model.Questions;if(!(t.AggregationMaster.Model.TotalResponseCount>=10))return!1;var e=!1;if((0,Wa._I)()&&(e=y.any(n,(function(t){var n=t.QuestionTagForIntelligence;return!!n&&n.indexOf("ScenarioTag")>=0}))),(0,Wa.s$)()&&!e)return!1;var i=y.filter(n,(function(t){return"Question.Rating"===t.Type})).length,r=y.filter(n,(function(t){return"Question.Choice"===t.Type})).length;return i+r>=4||1===i&&r>=2||e},n}(Rl.y);var Jl=function(t){function n(n){var e=t.call(this,n)||this;e.aR=e.uR.bind(e);var i=e.props.FormMaster.Model;return e.cR=e.cR.bind(e),e.lR=e.lR.bind(e),e.state={LibraryLoaded:!1,DetailDialogQuestionIndex:-1,ShareResultToken:null,InsightDialogOpened:(0,k.f5)().Model.DataIdeas,InsightExploreViewIndex:-1,InsightExploreViewOpened:!1,InsightReady:!1,InsightType:null,ShowPhishingWarningMessage:(0,K.NT)(i.ReputationTier),ShowExcelThrottleDialog:0},e}return(0,p.ZT)(n,t),n.prototype.initialize=function(){t.prototype.initialize.call(this),this.fR=new Qc(this.props.FormMaster)},n.prototype.registerObservers=function(){t.prototype.registerObservers.call(this),window.addEventListener("message",this.aR,!1)},n.prototype.unregisterObservers=function(){t.prototype.unregisterObservers.call(this),window.removeEventListener("message",this.aR)},Object.defineProperty(n.prototype,"QuestionClassType",{get:function(){return lu.Survey},enumerable:!1,configurable:!0}),n.prototype.createSummaryPanel=function(){var t,n=this.SummaryPanelProps;return(0,Wa.s$)()&&this.formInsightMaster&&!this.formInsightMaster.isValidFormScenario()?Hc({AggregationMaster:n.AggregationMaster,Form:this.props.FormMaster,InsightMaster:this.formInsightMaster,onDeleteResponses:n.onDeleteResponses,onExportExcel:n.onExportExcel,onPrint:n.onPrint,onCreatePermissionToken:n.onCreatePermissionToken,onDeletePermissionToken:n.onDeletePermissionToken,PermissionToken:n.PermissionToken}):(t={onClickInsightEntryPoint:this.cR,AggregationMaster:n.AggregationMaster,Form:this.props.FormMaster,onDeleteResponses:n.onDeleteResponses,onExportExcel:n.onExportExcel,onPrint:n.onPrint,onCreatePermissionToken:n.onCreatePermissionToken,onDeletePermissionToken:n.onDeletePermissionToken,PermissionToken:n.PermissionToken},g.createElement(Kl,(0,p.pi)({},t)))},n.prototype.createQuestionDetailDialog=function(){var t=this;if(!(0,ca.sv)()&&this.state.DetailDialogQuestionIndex>=0){var n={Index:this.state.DetailDialogQuestionIndex,QuestionDetailMaster:this.fR,onClose:function(){t.setState({DetailDialogQuestionIndex:-1},(function(){(0,kr.r8)(Uc.name)}))},EnableSubmitLanguage:this.props.FormMaster.Model.LocaleList.length>0};return g.createElement(Uc,(0,p.pi)({},n))}},n.prototype.createExtensionReviewContent=function(){if(!(0,ca.sv)()){var t=(0,Fr.E)({HTMLAttributes:{className:"analyze-view-nav-button office-form-theme-button",onClick:this.lR,disabled:0===this.props.FormMaster.Model.ResponsesCount},ButtonStyle:1,Text:(0,T.pm)().AnalyzeView_ViewResultsButton_Label,ref:"view-survey-results-button"});return g.createElement("div",{className:"analyze-view-nav-bar-left-button-container"},t)}},n.prototype.onDetailViewLinkClick=function(n){t.prototype.onDetailViewLinkClick.call(this,n),this.fR=new Qc(this.props.FormMaster)},n.prototype.createInsightViewContainer=function(){var t,n=this;if(this.state.InsightDialogOpened){var e={FormMaster:this.props.FormMaster,ShowInsight:this.state.InsightType,onClose:function(){return n.hR()}};return t=e,(0,se.a)().Flighting.isEnabled_Deprecated("FormInsight")?g.createElement(Wl,(0,p.pi)({},t)):null}},n.prototype.mR=function(t){(0,q.$U)("DesignPage.Responses.ClickInsightEntryPoint",{InsightType:t}),this.setState({InsightDialogOpened:!0,InsightType:t})},n.prototype.cR=function(t){this.mR(t)},n.prototype.hR=function(){this.setState({InsightDialogOpened:!1}),(0,kr.r8)("ideas-entry-button"),(0,k.f5)().Model.DataIdeas=!1},n.prototype.uR=function(t){var n=this,e="string"==typeof t.data?t.data.toLowerCase():"";if(e.startsWith("formreexporterror:")){if(e.indexOf(5117..toString())>=0){var i={innerCode:5117,type:e.indexOf("expectedfailure")>=0?"ExpectedFailure":"Failure"};this.props.showErrorPage&&this.props.showErrorPage(i)}}else switch(e){case"formreexportsuccess":Zl("formreexportsuccess");break;case"openinexcelreachvmlimitationthrottle":this.setState({ShowExcelThrottleDialog:3}),window.setTimeout((function(){n.setState({ShowExcelThrottleDialog:0})}),5e3),Zl();break;case"openinexcelreachownerlimitationthrottle":this.setState({ShowExcelThrottleDialog:2}),Zl()}},n.prototype.lR=function(){(0,ca.sv)()?(0,k.uq)().Model.SurveyResults=!0:((0,q.$U)("DesignPage.Responses.ViewResults"),(0,k.f5)().Model.TopView="SurveyResults"),this.FocusRef="view-survey-results-button"},n}(Pl);function Zl(t){void 0===t&&(t="");var n=(0,k.f5)().Model.FormMaster;n&&(n.Model.XlExportingLocalTag="","formreexportsuccess"===t&&n.Synchronizer.onSourceDataReceived({xlFileUnSynced:!1}))}var Xl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=this,n=this.props.Form;return(0,et.pd)((function(){var e,i=t.props.showErrorPage;return qu(n)?function(t){return g.createElement(El,(0,p.pi)({},t))}({FormMaster:n,showErrorPage:i,isDesignTimeView:t.props.isDesignTimeView}):(e={FormMaster:n,showErrorPage:i,isDesignTimeView:t.props.isDesignTimeView},g.createElement(Jl,(0,p.pi)({},e)))}),et.t1)},n}(J.r),Yl=function(t){function n(n){var e=t.call(this,n)||this;return e.Gu=(0,Na.a)().Model,e.$k=e.$k.bind(e),e.Uk=e.Uk.bind(e),e.vR=e.vR.bind(e),e.props.Form.Synchronizer.ensureFieldsReady([F.x.Schema.ArchivedRowCount]),e.props.Form.observe(e.vR,[F.x.Schema.ResponsesCount,F.x.Schema.ArchivedRowCount]),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.props.Form.unobserve(this.vR,[F.x.Schema.ResponsesCount,F.x.Schema.ArchivedRowCount])},n.prototype.render=function(){var t=this.props.Form.Model,n=this.props,e=n.originAssignmentsCreateQuiz,i=n.Form,r=n.FormDesignerRef,o=(0,K.NT)(t.ReputationTier)&&(0,St.M5)(),s=(0,T.pm)().DesignPage_Responses_TextForCount.format(i.Model.ResponsesCount);return g.createElement(nu,{DefaultSelectIndex:this.gR(),onSelectTabChange:this.$k,originAssignmentsCreateQuiz:e},g.createElement(tu,{key:"question-tab-content",TabName:(0,T.pm)().DesignPage_NavBar_ContentLink},this.pR(g.createElement(Ja,{Form:i,ref:r}))),!e&&this.wR(o,s))},n.prototype.wR=function(t,n){var e,i=this;return g.createElement(tu,{ButtonTitle:n,Disabled:t,key:"response-tab-content",NotificationShowedOnTab:this.SR(),TabName:(0,T.pm)().Common_Responses_Text},this.pR((e={Form:this.props.Form,isDesignTimeView:!0,showErrorPage:function(t){i.Gu.CriticalError=t}},g.createElement(Xl,(0,p.pi)({},e)))))},n.prototype.pR=function(t){var n=this.props,e=n.originAssignmentsCreateQuiz,i=n.Form,r="design-page-scrollable-content office-form-page-padding";return n.MalformedBranchingNotification&&(r=(0,N.j)(r,"body-scrollable-content-with-warning")),g.createElement("div",{className:r,id:"body-scrollable-content"},g.createElement("div",{className:"design-content office-form-theme-shadow new-analyze-view-look"},t,!wa()&&!e&&!(0,dt.AO)()&&Xs({Form:i})))},n.prototype.SR=function(){var t=this;return(0,et.hl)((function(){var n=t.props.Form;if(n.isFieldReady(F.x.Schema.ResponsesCount)&&n.isFieldReady(F.x.Schema.ArchivedRowCount)){var e=n.Model.ResponsesCount+n.Model.ArchivedRowCount;return e>0?g.createElement("div",{className:"navbar-responses-notification office-form-theme-primary-background"},e):null}}))},n.prototype.vR=function(){this.forceUpdate()},n.prototype.$k=function(t){this.Gu.Analysis=0!==t},n.prototype.Uk=function(t){return 0===t?!this.Gu.Analysis:this.Gu.Analysis},n.prototype.gR=function(){return this.Gu.Analysis?1:0},n}(J.r),tf=function(t){function n(n){var e=t.call(this,n)||this;return e.NR=e.NR.bind(e),e.Gu=(0,k.f5)().Model,e.state={EstiamtionTimeVariation:"undefined"},e}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=(0,I.cr)("EstimationTimeUIFix")?"intelligence-notification-container-moveup":"intelligence-notification-container";return g.createElement("div",{className:t},this.CR(),this.Ek())},n.prototype.Ek=function(){if(!(0,I.cr)("EstimationTimeUIFix")&&(0,Wa.N4)()&&!this.Gu.Analysis)return(0,wo.Ws)({Form:this.props.FormMaster})},n.prototype.CR=function(){return(0,Wa.N4)()&&!this.Gu.Analysis?(0,wo.Im)({applyTheme:this.NR,FormMaster:this.props.FormMaster}):null},n.prototype.NR=function(t){this.props.FormMaster.ThemeMaster.Model.Name=t,this.forceUpdate()},n}(J.r),nf=function(t){function n(n){var e=t.call(this,n)||this;return e.IR=e.IR.bind(e),e.state={display:!0},e}return(0,p.ZT)(n,t),n.prototype.render=function(){if(!this.state.display)return null;var t=(0,Fr.E)({ButtonStyle:1,HTMLAttributes:{className:"phishing-message-button office-form-theme-button",onClick:this.IR},key:"gotItButton",ref:"gotItButton",Text:(0,T.pm)().TeachingUi_GotIt});return g.createElement("div",{className:"phishing-message-container"},g.createElement("div",{className:"phishing-message-content"},g.createElement("div",{className:"phishing-text-container"},g.createElement("span",{className:"phishing-warning-message"},(0,T.pm)().Phishing_Form_First_Time_Warning)),t))},n.prototype.IR=function(){this.props.showPhishingTipbarCallback(!0),this.setState({display:!1})},n}(J.r),ef=e(58268),rf=function(t){function n(n){var e=t.call(this,n)||this;return e.la=e.la.bind(e),e.state={UserReputationTier:1,ShowPhishingWarningBar:!0},e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this;this.As=function(){return t.forceUpdate()},this.props.FormMaster.observe(this.As,[F.x.Schema.NotifiedAdminForApproval])},n.prototype.componentDidMount=function(){this.TR()},n.prototype.conponentWillUnmount=function(){this.props.FormMaster.unobserve(this.As)},n.prototype.render=function(){var t=this.props.FormMaster,n=t.isFieldReady(F.x.Schema.ReputationTier)&&t.Model.ReputationTier,e=this.xR();if(this.state.ShowPhishingWarningBar&&((0,K.bM)(t.Model.ReputationTier)||null!=e)){if(2===this.state.UserReputationTier&&(Date.now()-Date.parse(t.Model.CreatedDate))/1e3<300)return null;var i=e;null==i&&(i=(0,K.nW)(n,"Design"));var r=(0,K.NT)(t.Model.ReputationTier);return(0,ms.vV)({HrefInfo:(0,T.pm)().TermsLink,Info:i,onClickHref:of,onClose:this.la,ShouldClose:!r,TipBarLocation:"Up",TipBarStyle:r?"RedBackground":"YellowBackground"})}return null},n.prototype.xR=function(){var t=this.props.FormMaster,n=t.isFieldReady(F.x.Schema.ReputationTier)&&t.Model.ReputationTier,e=null;if(this.FR()&&t.Model.Questions.length>0){var i=_.d.convertToArray(t.Model.Questions);switch(n){case 3:if(t.Model.NotifiedAdminForApproval)e=(0,T.pm)().Phishing_Admin_Approval_Request_Sent;else{var r=(0,mi.lK)(this.props.FormMaster);this.props.FormMaster.isFieldReady(F.x.Schema.Id)&&r.getSuspiciousEvidence(this.props.FormMaster.Model.Id).then((function(t){if(t&&t.id){var n=y.find(i,(function(n){return n.Id===t.id}));n&&(n.SuspiciousEvidence=1)}}))}break;case 0:t.Model.NotifiedAdminForApproval&&(e=(0,T.pm)().Phishing_Admin_Approval_Request_Approved),i.forEach((function(t){0!==t.SuspiciousEvidence&&(t.SuspiciousEvidence=0)}));break;case 4:i.forEach((function(t){0!==t.SuspiciousEvidence&&(t.SuspiciousEvidence=0)}));break;default:t.Model.NotifiedAdminForApproval&&(t.Model.NotifiedAdminForApproval=!1),i.forEach((function(t){switch(t.SuspiciousEvidence){case 1:case 3:t.SuspiciousEvidence=2}}))}}return e},n.prototype.la=function(){this.setState({ShowPhishingWarningBar:!1})},n.prototype.FR=function(){return 0===this.state.UserReputationTier},n.prototype.TR=function(){var t=this;(0,$r.W6)().then((function(n){t.setState({UserReputationTier:n})}))},n}(J.r);function of(){var t=(0,ef.bR)();(0,$s.K)(t,"_blank")}var sf=e(73909);function af(t,n){var e=null!=n?n:(0,T.pm)();switch(t){case"AdditionalLanguage_Button_Text":return e.MultiLingualPane_AdditionalLanguage_Button_Text;case"AdditionalLanguage_Default_Name":return e.MultiLingualPane_AdditionalLanguage_Default_Name;case"AdditionalLanguage_Title":return e.MultiLingualPane_AdditionalLanguage_Title;case"Additional_Language":return e.MultiLingualPane_Additional_Language;case"Cancel_Button":return e.MultiLingualPane_Cancel_Button;case"Cancel_Text":return e.MultiLingualPane_Cancel_Text;case"Continue_Button":return e.MultiLingualPane_Continue_Button;case"Continue_Text":return e.MultiLingualPane_Continue_Text;case"DefalutLanguage_Title":return e.MultiLingualPane_DefalutLanguage_Title;case"Default_Language":return e.MultiLingualPane_Default_Language;case"DeleteLanguage_Warning_Text":return e.MultiLingualPane_DeleteLanguage_Warning_Text;case"DropDown_Language_List":return e.MultiLingualPane_DropDown_Language_List;case"DropDown_Suggestion_Text":return e.MultiLingualPane_DropDown_Suggestion_Text;case"additional_language_delete":return e.MultiLingualPane_additional_language_delete;case"additional_language_download":return e.MultiLingualPane_additional_language_download;case"additional_language_download_error2":return e.MultiLingualPane_additional_language_download_error2;case"additional_language_download_text":return e.MultiLingualPane_additional_language_download_text;case"additional_language_edit":return e.MultiLingualPane_additional_language_edit;case"additional_language_upload":return e.MultiLingualPane_additional_language_upload;case"additional_language_upload_error1":return e.MultiLingualPane_additional_language_upload_error1;case"additional_language_upload_error2":return e.MultiLingualPane_additional_language_upload_error2;case"additional_language_upload_text":return e.MultiLingualPane_additional_language_upload_text;case"af":return e.MultiLingualPane_af;case"am_et":return e.MultiLingualPane_am_et;case"ar":return e.MultiLingualPane_ar;case"as_in":return e.MultiLingualPane_as_in;case"az_latn_az":return e.MultiLingualPane_az_latn_az;case"be":return e.MultiLingualPane_be;case"bg":return e.MultiLingualPane_bg;case"bn_in":return e.MultiLingualPane_bn_in;case"bs_latn_ba":return e.MultiLingualPane_bs_latn_ba;case"ca":return e.MultiLingualPane_ca;case"ca_es_valencia":return e.MultiLingualPane_ca_es_valencia;case"cs":return e.MultiLingualPane_cs;case"cy_gb":return e.MultiLingualPane_cy_gb;case"da":return e.MultiLingualPane_da;case"de":return e.MultiLingualPane_de;case"editall_download_generic_error_text":return e.MultiLingualPane_editall_download_generic_error_text;case"editall_download_overwrite_error_text":return e.MultiLingualPane_editall_download_overwrite_error_text;case"editall_download_success_text":return e.MultiLingualPane_editall_download_success_text;case"editall_download_text":return e.MultiLingualPane_editall_download_text;case"editall_upload_cancelbutton_tooltip":return e.MultiLingualPane_editall_upload_cancelbutton_tooltip;case"editall_upload_differentstrings_error":return e.MultiLingualPane_editall_upload_differentstrings_error;case"editall_upload_emptycells_error":return e.MultiLingualPane_editall_upload_emptycells_error;case"editall_upload_generic_error1_text":return e.MultiLingualPane_editall_upload_generic_error1_text;case"editall_upload_generic_error2_text":return e.MultiLingualPane_editall_upload_generic_error2_text;case"editall_upload_insufficientlanguages_error":return e.MultiLingualPane_editall_upload_insufficientlanguages_error;case"editall_upload_retrybutton_tooltip":return e.MultiLingualPane_editall_upload_retrybutton_tooltip;case"editall_upload_success_text":return e.MultiLingualPane_editall_upload_success_text;case"editall_upload_unsupportedfile_error":return e.MultiLingualPane_editall_upload_unsupportedfile_error;case"el":return e.MultiLingualPane_el;case"en_gb":return e.MultiLingualPane_en_gb;case"en_us":return e.MultiLingualPane_en_us;case"es":return e.MultiLingualPane_es;case"es_ES":return e.MultiLingualPane_es_ES;case"es_mx":return e.MultiLingualPane_es_mx;case"et":return e.MultiLingualPane_et;case"eu":return e.MultiLingualPane_eu;case"fa":return e.MultiLingualPane_fa;case"fi":return e.MultiLingualPane_fi;case"fil_ph":return e.MultiLingualPane_fil_ph;case"fr":return e.MultiLingualPane_fr;case"fr_FR":return e.MultiLingualPane_fr_FR;case"fr_ca":return e.MultiLingualPane_fr_ca;case"ga_ie":return e.MultiLingualPane_ga_ie;case"gd":return e.MultiLingualPane_gd;case"gl":return e.MultiLingualPane_gl;case"gu":return e.MultiLingualPane_gu;case"he":return e.MultiLingualPane_he;case"hi":return e.MultiLingualPane_hi;case"hr":return e.MultiLingualPane_hr;case"hu":return e.MultiLingualPane_hu;case"hy":return e.MultiLingualPane_hy;case"id":return e.MultiLingualPane_id;case"is":return e.MultiLingualPane_is;case"it":return e.MultiLingualPane_it;case"ja":return e.MultiLingualPane_ja;case"ka":return e.MultiLingualPane_ka;case"kk":return e.MultiLingualPane_kk;case"km_kh":return e.MultiLingualPane_km_kh;case"kn":return e.MultiLingualPane_kn;case"ko":return e.MultiLingualPane_ko;case"kok":return e.MultiLingualPane_kok;case"lb_lu":return e.MultiLingualPane_lb_lu;case"lo":return e.MultiLingualPane_lo;case"lt":return e.MultiLingualPane_lt;case"lv":return e.MultiLingualPane_lv;case"mi_nz":return e.MultiLingualPane_mi_nz;case"mk":return e.MultiLingualPane_mk;case"ml":return e.MultiLingualPane_ml;case"mr":return e.MultiLingualPane_mr;case"ms":return e.MultiLingualPane_ms;case"mt_mt":return e.MultiLingualPane_mt_mt;case"nb_no":return e.MultiLingualPane_nb_no;case"ne_np":return e.MultiLingualPane_ne_np;case"nl":return e.MultiLingualPane_nl;case"nn_no":return e.MultiLingualPane_nn_no;case"or_in":return e.MultiLingualPane_or_in;case"pa":return e.MultiLingualPane_pa;case"pl":return e.MultiLingualPane_pl;case"pt_br":return e.MultiLingualPane_pt_br;case"pt_pt":return e.MultiLingualPane_pt_pt;case"quz_pe":return e.MultiLingualPane_quz_pe;case"ro":return e.MultiLingualPane_ro;case"ru":return e.MultiLingualPane_ru;case"select_placeholder":return e.MultiLingualPane_select_placeholder;case"sk":return e.MultiLingualPane_sk;case"sl":return e.MultiLingualPane_sl;case"sq":return e.MultiLingualPane_sq;case"sr_cyrl_ba":return e.MultiLingualPane_sr_cyrl_ba;case"sr_cyrl_rs":return e.MultiLingualPane_sr_cyrl_rs;case"sr_latn_rs":return e.MultiLingualPane_sr_latn_rs;case"sv":return e.MultiLingualPane_sv;case"ta":return e.MultiLingualPane_ta;case"te":return e.MultiLingualPane_te;case"th":return e.MultiLingualPane_th;case"tr":return e.MultiLingualPane_tr;case"tt":return e.MultiLingualPane_tt;case"ug":return e.MultiLingualPane_ug;case"uk":return e.MultiLingualPane_uk;case"ur":return e.MultiLingualPane_ur;case"uz_latn_uz":return e.MultiLingualPane_uz_latn_uz;case"vi":return e.MultiLingualPane_vi;case"zh_Hans":return e.MultiLingualPane_zh_Hans;case"zh_Hant":return e.MultiLingualPane_zh_Hant;case"zh_cn":return e.MultiLingualPane_zh_cn;case"zh_hk":return e.MultiLingualPane_zh_hk;case"zh_tw":return e.MultiLingualPane_zh_tw;default:return""}}var uf,cf=function(t){function n(e){var i=t.call(this,e)||this;i.DR=g.createRef(),i.MR=g.createRef(),i.df=g.createRef(),i.LR=g.createRef(),i.al=y.uniqueId(n.name);var r,o=e.Value;return o&&(r=y.find(i.props.SelectOptions,(function(t){return t.Value===o}))),i.state={Expanded:!1,InputValue:r&&r.DisplayName||"",SelectedIndex:-1},i.Dc=i.Dc.bind(i),i.gf=i.gf.bind(i),i.RR=i.RR.bind(i),i.YN=i.YN.bind(i),i.mf=i.mf.bind(i),i}return(0,p.ZT)(n,t),n.prototype.componentDidUpdate=function(){if(this.state.Expanded){this.Cf();var t=this.state.SelectedIndex;if(t>-1){var n=this.LR.current;n&&n.children[t].focus()}}if(this.AR){var e=this.DR.current;e&&e.select(),this.AR=!1}},n.prototype.render=function(){var t=y.extend({},this.props.HTMLAttributes),n=this.wf().length,e=(0,Tr.p2)(t,{className:"suggestion-select-control",id:this.al,onBlur:this.mf,onKeyUp:this.gf,ref:this.df,tabIndex:-1});return g.createElement("div",(0,p.pi)({},e),this.Tf(),g.createElement("div",{className:"suggestion-select-suggest-option-container",ref:this.MR},this.ER(),this.kf()),g.createElement("div",{className:"suggestion-search-hint","aria-live":"polite"},g.createElement("div",null,(0,T.pm)().Suggestion_Select_Search_Result_Count.format(n))))},n.prototype.Tf=function(){var t=this.state.InputValue||"";return g.createElement("div",{className:"suggestion-select-placeholder"},g.createElement("input",{"aria-expanded":this.state.Expanded,"aria-label":this.props.SearchBoxLabel,autoComplete:"off",autoFocus:!this.props.IsDefaultLanguage,className:"suggestion-select-placeholder-text default",onChange:this.Dc,onFocus:this.YN,placeholder:this.props.Placeholder,value:t,ref:this.DR,role:"combobox"}))},n.prototype.kf=function(){var t=this,n=this.wf();if(this.state.Expanded&&n)return g.createElement("ul",{className:"suggestion-select-option-menu-options",ref:this.LR,role:"listbox"},n.map((function(n){return t.Ef(n)})))},n.prototype.ER=function(){var t=this.props,n=this.state.InputValue?t.SuggestionText:t.optionListName;if(this.state.Expanded&&n)return g.createElement("div",{className:"suggestion-select-suggest-content"},n)},n.prototype.Ef=function(t){var n={"aria-disabled":t.Disabled,"aria-selected":!1,className:"suggestion-select-option","data-option-name":t.DisplayName,"data-option-value":t.Value,key:t.Key,role:"option",tabIndex:-1};t.Disabled?n.className=(0,N.j)(n.className,"disabled"):n.onClick=this.RR;var e=t.SecondText,i=e&&g.createElement("div",{className:"suggestion-select-option-second-content"},e);return g.createElement("li",(0,p.pi)({},n),g.createElement("div",{className:"suggestion-select-option-content"},t.DisplayName),i)},n.prototype.wf=function(){var t=this.state.InputValue||"",n=this.props.SelectOptions,e=t.toLocaleLowerCase();return y.filter(n,(function(t){var n=t.SecondText;return t.DisplayName.toLowerCase().indexOf(e)>-1||!!n&&n.toLocaleLowerCase().indexOf(e)>-1}))},n.prototype.gf=function(t){var n=this;switch(t.keyCode){case 38:case 40:38===t.keyCode?this.Of():this._f(),t.preventDefault();break;case 13:this.RR(t),t.stopPropagation(),t.preventDefault();break;case 27:this.state.Expanded&&(this.setState({Expanded:!1},(function(){n.df.current&&n.df.current.focus()})),t.stopPropagation(),t.preventDefault())}},n.prototype.Of=function(){for(var t=this.state.SelectedIndex,n=this.wf();t>0;){if(!n[--t].Disabled){this.setState({SelectedIndex:t});break}}},n.prototype._f=function(){for(var t=this.state.SelectedIndex,n=this.wf();t<n.length-1;){if(!n[++t].Disabled){this.setState({SelectedIndex:t});break}}},n.prototype.YN=function(t){this.AR=!0,this.setState({Expanded:!this.state.Expanded,SelectedIndex:-1})},n.prototype.mf=function(t){var n=this.df.current,e=(0,Ir.y3)(t),i=this.props.Value,r=y.find(this.props.SelectOptions,(function(t){return t.Value===i})),o=r&&r.DisplayName;if(!n||!n.contains(e)){var s=this.props.onBlur;s&&s(t),this.AR=!1,this.setState({Expanded:!1,InputValue:o,SelectedIndex:-1})}},n.prototype.RR=function(t){var n=t.target,e=t.currentTarget,i=n.dataset.optionValue||e.dataset.optionValue,r=n.dataset.optionName||e.dataset.optionName;i&&this.props.Value!==i&&this.props.onValueChange(i),this.AR=!0,this.setState({Expanded:!0,InputValue:r,SelectedIndex:-1})},n.prototype.Dc=function(t){var n=t.target.value;this.setState({InputValue:n,Expanded:!0})},n.prototype.Cf=function(){var t=document.getElementById(this.al);if(t){var n=t.offsetWidth,e=this.MR.current;if(!e)return;e.offsetWidth<n&&(e.style.width="".concat(n,"px"))}},n}(J.r),lf=function(t){function n(n){var e=t.call(this,n)||this;return e.OR=g.createRef(),e._R=!0,e.FT=new Ma(e,e.props.DesignFocus,e.props.LocaleId,e.props.AutoFocus),e.state={InDesignMode:e.FT.Grabber.currentlyOwning(),ShowConfirmDialog:!1},e.YN=e.YN.bind(e),e.mf=e.mf.bind(e),e.gf=e.gf.bind(e),e.BR=e.BR.bind(e),e.GR=e.GR.bind(e),e.qR=e.qR.bind(e),e.VR=e.VR.bind(e),e.zR=e.zR.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this.OR.current;t&&t.focus()},n.prototype.componentWillUnmount=function(){this.FT.release()},n.prototype.componentDidUpdate=function(){if(this.state.InDesignMode){var t=this.OR.current;t&&this._R&&t.focus()}},n.prototype.render=function(){if(this.state.ShowConfirmDialog)return this.UR();var t=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"multi-lingual-edition-button edition-delete-button",onClick:this.BR},FluentIcon:"Edit",IconClassName:"forms-icon-size16x16",Text:(0,T.pm)().MultiLingualPane_additional_language_edit}),n=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"multi-lingual-delete-button edition-delete-button",onClick:this.GR},FluentIcon:"Delete",IconClassName:"forms-icon-size16x16",Text:(0,T.pm)().MultiLingualPane_additional_language_delete}),e={ButtonStyle:1,HTMLAttributes:{"aria-label":this.props.LocaleName,className:"multi-lingual-additional-language-button",onBlur:this.mf,onClick:this.BR,onFocus:this.YN,onKeyDown:this.gf},Text:this.props.LocaleName,ref:this.OR},i=this.state.InDesignMode&&"multi-lingual-additional-language-selected";return g.createElement("div",{className:"multi-lingual-additional-language-edition ".concat(i)},g.createElement(Fr.A,(0,p.pi)({},e)),t,n)},n.prototype.mf=function(t){var n=t.currentTarget.parentElement,e=(0,Ir.y3)(t);n&&e&&n.contains(e)||this.FT.Grabber.handsOff()},n.prototype.YN=function(t){var n=t.currentTarget,e=(0,Ir.y3)(t);n&&e&&n.contains(e)?this._R=!1:this._R=!0,this.FT.Grabber.grab()},n.prototype.gf=function(t){var n,e=this.props.Length,i=this.props.Index+e,r=this.props.Form.Model.LocaleList;switch(t.keyCode){case 38:this.FT.Grabber.handsOff(),n=r[--i%e].localeId;break;case 40:this.FT.Grabber.handsOff(),n=r[++i%e].localeId;break;case 13:return t.preventDefault(),void this.BR()}n&&this.props.setFocusOnLanguageItem(n),this._R=!0},n.prototype.BR=function(){(0,q.$U)("DesignPage.Flex.MultiLingual.EditLanguage");var t=this.props.LocaleId;this.props.enterLanguageEditionView(t)},n.prototype.GR=function(t){t.stopPropagation(),this.setState({ShowConfirmDialog:!0})},n.prototype.UR=function(){var t={ClassName:"multi-lingual-delete-close-button",GlyphButtonStyle:"GlyphOnly",Key:"closeItem",onClick:this.VR,Text:(0,T.pm)().Common_Close_Text,FluentIcon:"Dismiss",IconClassName:"forms-icon-size16x16"},n={ButtonsProps:[{ClassName:"multi-lingual-delete-continue-button",GlyphButtonStyle:"Horizontal",Key:"cancelItem",onClick:this.VR,Text:(0,T.pm)().Common_Cancel_Text,Title:(0,T.pm)().MultiLingualPane_Cancel_Text},{ClassName:"multi-lingual-delete-continue-button",ConveyDescription:!0,GlyphButtonStyle:"Horizontal",Key:"deleteItem",onClick:this.qR,Text:(0,T.pm)().Common_Yes_Text,Title:(0,T.pm)().MultiLingualPane_Continue_Text}],ClassName:"multi-lingaul-confirm-dialog",CloseButtonProps:t,Description:(0,T.pm)().MultiLingualPane_DeleteLanguage_Warning_Text,key:"deleteConfirmDialog",onBlur:this.zR,ShowDialog:!0};return(0,je.s)(n)},n.prototype.qR=function(t){(0,q.$U)("DesignPage.Flex.MultiLingual.DeleteLanguage");var n=this.props,e=n.Form,i=e.Model.LocaleList,r=this.props.LocaleId;if(r){if(n.Index<n.Length-1){var o=i[n.Index+1].localeId;o&&n.setFocusOnLanguageItem(o)}else(0,kr.su)(t.currentTarget);e.deleteLocale(r)}},n.prototype.VR=function(){this._R=!0,this.setState({ShowConfirmDialog:!1})},n.prototype.zR=function(){var t=this;window.setTimeout((function(){t.setState({ShowConfirmDialog:!1}),t.FT.Grabber.handsOff()}),0)},n}(J.r),ff=function(t){function n(n){var e=t.call(this,n)||this;e.$R=(0,sf.lc)(),e.fk=new Ca,e.As=function(){return e.forceUpdate()};var i=e.props.Form;if(!i.Model.DefaultLanguage){var r=(0,sf.W$)((0,c.k0)().cultureInfo.Name.toLowerCase()),o=e.$R[r];i.Model.DefaultLanguage=o?r:(0,sf.Mb)()}return i.observe(e.As,[F.x.Schema.DefaultLanguage,F.x.Schema.LocaleList,F.x.Schema.LocaleList[0].localeName]),e.jR=e.jR.bind(e),e.WR=e.WR.bind(e),e.oC=e.oC.bind(e),e.JR=e.JR.bind(e),e.mf=e.mf.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.props.Form.unobserve(this.As)},n.prototype.render=function(){var t=this.props.Form.Model,n=t.DefaultLanguage,e=t.LocaleList,i={};n&&(i[n]=!0),y.forEach(e,(function(t){var n=t.localeId;n&&(i[n]=!0)}));var r,o,s=this.XR(i);if(e&&e.length<(0,et.pd)(X.g6,et.t1)){var a=this.state.AddingAdditionalLanguage&&"dn";r=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"Horizontal",HTMLAttributes:{className:"multi-lingual-additional-language-add-button ".concat(a),onClick:this.JR},FluentIcon:"Add",IconClassName:"forms-icon-size20x20",Text:(0,T.pm)().MultiLingualPane_AdditionalLanguage_Button_Text,TextClassName:"multi-lingual-add-text"})}if(this.state.AddingAdditionalLanguage){var u={HTMLAttributes:{"aria-expanded":!1,"aria-label":(0,T.pm)().Multilingual_Select_Language,className:"multi-lingual-additional-language-dropdown"},onBlur:this.mf,onValueChange:this.jR,optionListName:(0,T.pm)().MultiLingualPane_DropDown_Language_List,Placeholder:(0,T.pm)().MultiLingualPane_select_placeholder,SearchBoxLabel:(0,T.pm)().MultiLingualPane_AdditionalLanguage_Button_Text,SelectOptions:s,SuggestionText:(0,T.pm)().MultiLingualPane_DropDown_Suggestion_Text,Value:""};o=g.createElement(cf,(0,p.pi)({},u))}return g.createElement("div",{className:"flex-pane-multi-lingual-pane"},g.createElement("div",{className:"multi-lingual-page-title",role:"heading","aria-level":1},(0,T.pm)().DesignPage_MultiLingualPane_Label),g.createElement("div",{className:"multi-lingual-defaule-language"},g.createElement("div",{className:"multi-lingual-defaule-language-title"},(0,T.pm)().MultiLingualPane_DefalutLanguage_Title),this.YR()),g.createElement("div",{className:"multi-lingual-additional-language"},g.createElement("div",{className:"multi-lingual-additional-language-title"},(0,T.pm)().MultiLingualPane_AdditionalLanguage_Title,undefined),this.tA(),r,o))},n.prototype.YR=function(){var t=this.props.Form.Model,n={};y.forEach(t.LocaleList,(function(t){var e=t.localeId;e&&(n[e]=!0)}));var e=this.XR(n),i={HTMLAttributes:{"aria-label":(0,T.pm)().Multilingual_Select_Language,className:"multi-lingual-default-language-dropdown"},onValueChange:this.oC,optionListName:(0,T.pm)().MultiLingualPane_DropDown_Language_List,Placeholder:(0,T.pm)().MultiLingualPane_select_placeholder,SearchBoxLabel:(0,T.pm)().MultiLingualPane_DefalutLanguage_Title,SelectOptions:e,SuggestionText:(0,T.pm)().MultiLingualPane_DropDown_Suggestion_Text,Value:this.props.Form.Model.DefaultLanguage,IsDefaultLanguage:!0};return g.createElement(cf,(0,p.pi)({},i))},n.prototype.oC=function(t){this.props.Form.Model.DefaultLanguage=t},n.prototype.WR=function(t){var n=this.fk.getGrabberByName(t);n&&n.grab()},n.prototype.nA=function(){if(!0===this.state.EditViewSelected){var t=(0,k.f5)();t.bulkEdit((function(){t.Model.FlexPane="MultiLingualEditAll"}))}},n.prototype.tA=function(){var t=this,n=this.props.Form,e=n.Model.LocaleList;if(e&&e.length)return y.map(e,(function(i,r){var o=y.find(n.Model.LocalizedResources,(function(t){return t.localeId===i.localeId})),s=i.localeId,a=i.localeName||(0,T.pm)().MultiLingualPane_AdditionalLanguage_Default_Name;if(o&&s)return g.createElement(lf,{DesignFocus:t.fk,Form:n,Index:r,key:s,Length:e.length,LocaleId:s,LocaleName:a,enterLanguageEditionView:t.props.enterLanguageEditionView,setFocusOnLanguageItem:t.WR})}))},n.prototype.XR=function(t){var n=[],e=this.$R,i=Object.keys(e);return i.sort((function(t,n){var i=e[t],r=e[n];return i<r?-1:i>r?1:0})),i.map((function(i){var r={Disabled:t[i],DisplayName:e[i],Key:i,SecondText:af("".concat(i.replace(/-/g,"_"))),Value:i};n.push(r)})),n},n.prototype.JR=function(){this.setState({AddingAdditionalLanguage:!0})},n.prototype.mf=function(t){this.setState({AddingAdditionalLanguage:!1})},n.prototype.jR=function(t){(0,q.$U)("DesignPage.Flex.MultiLingual.AddAdditionalLanguage",{localeId:t});var n=this.$R[t];n&&this.props.Form.createLocale(t,n),this.setState({AddingAdditionalLanguage:!1})},n}(J.r),hf=e(22884),df=e(53738),mf=function(t){function n(n){var e=t.call(this,n)||this;if(e.vo=!0,e.eA=e.eA.bind(e),e.oA=e.oA.bind(e),e.sA=e.sA.bind(e),e.state={Suggestions:[]},(0,Wa.N4)())e.aA=(0,G.z)(e.props.FormMaster),e.aA.observe(e.sA,[e.aA.Schema.SuggestionId]);else{var i=e.props.FormMaster.getInstanceId(),r=(0,hf.F)(i);r&&r.observe(e.sA,[r.Schema.suggestions])}return e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){if(this.vo=!1,(0,Wa.N4)())this.aA.unobserve(this.sA);else{var t=this.props.FormMaster.getInstanceId(),n=(0,hf.F)(t);n&&n.unobserve(this.sA)}},n.prototype.componentDidMount=function(){this.sA()},n.prototype.componentWillUpdate=function(t,n){y.isEqual(n.Suggestions,this.state.Suggestions)||((0,q.$U)("DesignPage.Theme.Suggestion.Update",{Expanded:t.ExpandView,HasSuggestion:!y.isEmpty(n.Suggestions),IsQuiz:this.props.FormMaster.SettingMaster.Model.IsQuizMode}),(0,q.f)("IntelligenceStatistic.ThemeSuggestion.Update",{Expanded:t.ExpandView,IsQuiz:this.props.FormMaster.SettingMaster.Model.IsQuizMode,MsftUser:(0,c.k0)().userInfo.TenantId===(0,ht.rq)(),Suggestions:n.Suggestions?n.Suggestions.map((function(t){return t.Name})):[]}))},n.prototype.render=function(){return!this.state.Suggestions||this.state.Suggestions.length<=0?null:g.createElement("div",{className:"theme-suggestion-view-container"},g.createElement("div",{className:"theme-suggestion-view-content"},this.uA(),this.cA()))},n.prototype.uA=function(){var t=(0,T.pm)().Designer_Intelligence_Button_Show;this.props.ExpandView&&(t=(0,T.pm)().Designer_Intelligence_Button_Hide);var n={ButtonStyle:1,HTMLAttributes:{"aria-label":(0,T.pm)().Designer_Intelligence_SuggestThemes_Title+t,className:"theme-suggestion-view-head-show-button",onClick:this.oA},Text:t},e=g.createElement(Fr.A,(0,p.pi)({},n));return g.createElement("div",{className:"theme-suggestion-view-head-button",key:"theme-suggestion-view-head-button"},g.createElement("div",{className:"theme-suggestion-view-head-button-title"},g.createElement("i",{className:"ms-Icon forms-icon-size16x16 ms-Icon--LightningBolt"}),g.createElement("span",{className:"theme-suggestion-view-head-button-text"},(0,T.pm)().Designer_Intelligence_SuggestThemes_Title)),e)},n.prototype.cA=function(){var t=this;if(this.props.ExpandView&&this.state.Suggestions&&this.state.Suggestions.length>0){var n=this.state.Suggestions.map((function(n,e){var i;return g.createElement(df.n,{applyTheme:t.eA,DesignIntelligenceVariation:null===(i=t.aA)||void 0===i?void 0:i.DesignIntelligenceVariation,IsActive:t.props.FormMaster.ThemeMaster.Model.Name===n.Name,IsFromSuggestionCard:!1,IsQuiz:t.props.FormMaster.SettingMaster.Model.IsQuizMode,key:n.Name,Theme:n})}));return g.createElement("div",{className:"theme-suggestion-list-container",key:"theme-suggestion-list-container",role:"group"},n)}return null},n.prototype.sA=function(){var t=this;if(this.vo)if((0,Wa.N4)()){var n=this.aA.getSuggestion("TitleSuggestsTheme");n?this.setState({Suggestions:n.Suggestion||[]}):this.setState({Suggestions:[]})}else{var e=this.props.FormMaster.getInstanceId();(0,Pa.qX)(e).then((function(n){t.setState({Suggestions:n||[]})}))}},n.prototype.oA=function(){(0,q.$U)("DesignPage.Theme.ExpandShuggestion",{Expanded:!this.props.ExpandView}),this.props.expandOrCollapseSuggest()},n.prototype.eA=function(t){var n,e;if(!(0,ht.x8)()){var i={AdoptedCandidates:[t],Candidates:this.state.Suggestions.map((function(t){return t.Name})),SuggestionId:null===(e=null===(n=this.aA)||void 0===n?void 0:n.Model)||void 0===e?void 0:e.SuggestionId};h.Pv.Resolve("IFormUserContextActionSignal").addUserActionSignal(Gi.l_[Gi.l_.ThemeSuggestion],4,i,!1)}this.props.applyTheme(t)},n}(J.r),vf=e(69065),gf=e(64520),pf=e(44286),bf=function(t){function n(n){var e=t.call(this,n)||this;return e.eA=e.eA.bind(e),e.lA=e.lA.bind(e),e.GR=e.GR.bind(e),e.fA=e.fA.bind(e),e.state={ShowSpinner:!1},e}return(0,p.ZT)(n,t),n.prototype.render=function(){var t,n=null!==(t=this.props.ThemeContainerClassName)&&void 0!==t?t:"theme-icon-container";return g.createElement("span",{className:n},this.hA(),this.cv(),this.dA(),this.mA(),this.xu())},n.prototype.hA=function(){var t,n=this.props.Theme,e=(0,pf.U)(n.Name)||(0,T.pm)().Customized_Theme_Name,i=null!==(t=this.props.ButtonClassName)&&void 0!==t?t:"theme-icon-button";this.props.IsActive&&(i=(0,N.j)(i,"active"));var r={"aria-label":e,"aria-posinset":this.props.ThemeLength?this.props.ThemeIndex+1:void 0,"aria-selected":this.props.IsActive,"aria-setsize":this.props.ThemeLength?this.props.ThemeLength:void 0,className:i,onClick:this.eA,title:(0,et.hl)((function(){return e})),role:"option",autoFocus:this.props.IsActive},o={ButtonStyle:1,children:this.vA(),HTMLAttributes:r};return(0,et.pd)((function(){return g.createElement(Dr.zx,(0,p.pi)({},o))}),et.t1)},n.prototype.vA=function(){if(this.props.Theme){var t=void 0,n=this.props.Theme;if(n.Thumbnail)t={backgroundImage:"url(".concat(n.Thumbnail,")")};else{if(n.BackgroundImage)return g.createElement("img",{alt:(0,T.pm)().Customized_Theme_Name,className:"theme-icon",key:"background-image",src:"".concat(n.BackgroundImage,"_mo"),onLoad:this.fA});if(!n.PrimaryColor)return null;t={backgroundColor:n.PrimaryColor}}return g.createElement("span",{className:"theme-icon",style:t})}return null},n.prototype.cv=function(){if(this.props.ShowColorSnapshot){var t=this.props.Theme,n={};return t.PrimaryColor&&(n.backgroundColor=t.PrimaryColor),g.createElement("div",{className:"customized-theme-color-snapshot",onClick:this.eA},g.createElement("div",{className:"snapshot-title",style:n},g.createElement("div",{className:"snapshot-title-content"})),g.createElement("div",{className:"snapshot-content"},g.createElement("div",{className:"snapshot-submit-button",style:n})))}return null},n.prototype.dA=function(){return this.props.editTheme?(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"customized-theme-edit-button",onClick:this.lA},FluentIcon:"Edit",IconClassName:"paneThemeEdit forms-icon-size18x18",key:"editButton",Text:(0,T.pm)().Common_Edit_Text}):null},n.prototype.mA=function(){return this.props.deleteTheme?(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"customized-theme-delete-button",onClick:this.GR},FluentIcon:"Delete",IconClassName:"paneThemeTrash forms-icon-size18x18",key:"deleteButton",Text:(0,T.pm)().Common_Delete_Text}):null},n.prototype.GR=function(){(0,q.$U)("DesignPage.Theme.DeleteImage"),this.props.deleteTheme&&this.props.deleteTheme(),this.setState({ShowSpinner:!0})},n.prototype.eA=function(){(0,q.f)("DesignPage.Theme.SwitchTheme",{theme:this.props.Theme.Name}),this.props.applyTheme(this.props.Theme.Name)},n.prototype.lA=function(){(0,q.$U)("DesignPage.Theme.EditCustomizedTheme"),this.props.editTheme&&this.props.editTheme()},n.prototype.fA=function(){this.setState({ShowSpinner:!1})},n.prototype.xu=function(){return this.state.ShowSpinner?g.createElement("div",{className:"customized-theme-spinner-container"},g.createElement("div",{className:"delete-theme-image-spinner common-spinner-circle"})):null},n}(J.r),yf=function(t){function n(n){var e=t.call(this,n)||this;e.vo=!0,e.pA=!1,e.bA=!1,e.yA=g.createRef(),e.wA=g.createRef(),e.SA=g.createRef(),e.NA=g.createRef(),e.al=y.uniqueId("CustomizeTheme"),e.CA=e.al+"-nagivation-button",e.IA=e.al+"-title",e.TA=e.TA.bind(e),e.xA=e.xA.bind(e),e.FA=e.FA.bind(e),e.DA=e.DA.bind(e),e.MA=e.MA.bind(e),e.As=function(){return e.forceUpdate()};var i=e.props.FormMaster;e.LA=i.getImageMaster(F.x.Schema.Background);var r=i.Model.PrimaryCustomizedThemeColor||(0,nr.getIoCDefaultTheme)().PrimaryColor;e.state={ColorScriptLoaded:!1,CustomizedColor:r,FocusOnColorInput:!1,HexCodeStatus:(0,vf.Ym)((0,vf.$W)(r))?0:2,IsUploadingImage:!1,ShowColorPicker:!!i.Model.PrimaryCustomizedThemeColor};var o=(0,k.Cu)();return e.LA.observe(e.As,[o.Schema.ResourceUrl,o.Schema.ImageProcessingStatus,o.Schema.ErrorType]),(0,Pr.y)("ColorThief").then((function(){e.vo&&e.setState({ColorScriptLoaded:!0})})),e}return(0,p.ZT)(n,t),n.prototype.componentDidUpdate=function(){if(this.bA){var t=this.yA.current;t&&t.focus(),this.bA=!1}if(this.pA){var n=this.wA.current;n&&n.focus(),this.pA=!1}},n.prototype.componentWillUnmount=function(){this.LA.unobserve(this.As),this.vo=!1},n.prototype.render=function(){var t=this,n=(0,z.F)({ButtonStyle:1,HTMLAttributes:{"aria-labelledby":(0,N.j)(this.IA,this.CA),autoFocus:!0,className:"customize-theme-view-navigation",id:this.CA,onClick:this.props.onViewNavigation},FluentIcon:"Arrow Left",IconClassName:"paneThemeBack forms-icon-size16x16",Text:(0,T.pm)().Common_Back_Text,TextClassName:"customize-theme-view-navigation-text"}),e=g.createElement("div",{className:"customize-theme-view-container"},g.createElement("div",{className:"customize-theme-view-navigation-container"},n),g.createElement("div",{className:"customize-theme-view-title",id:this.IA},g.createElement("span",null,(0,T.pm)().Flex_Pane_ThemeView_Customize_Title)),g.createElement("div",{className:"customize-theme-view-content"},g.createElement("div",{className:"add-image"},this.RA(),this.AA()),g.createElement("div",{className:"add-color"},this.OA(),this._A(),this.BA(),this.VA(),this.UA(),this.jA()),this.WA()),this.KA());return(0,et.pd)((function(){return e}),(function(){return g.createElement("div",null,e,g.createElement(et.Xw.CustomizeThemeView_Pro,{FormMaster:t.props.FormMaster}))}))},n.prototype.RA=function(){if(this.props.FormMaster.Model.Background.ResourceId)return null;var t={disabled:this.LA.Model.ImageProcessingStatus!==ze.nv.Idle,onClick:this.TA},n=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:t,FluentIcon:"Image",IconClassName:"customized-theme-pictureAdd-icon forms-icon-size28x28",ref:this.wA,Text:(0,T.pm)().Add_Customized_Theme_Image});return g.createElement("span",{className:"theme-icon-container",key:"addImage"},n,this.xu())},n.prototype.AA=function(){var t=this,n=this.props.FormMaster.Model;if(n.Background.ResourceUrl){return g.createElement(bf,{applyTheme:this.TA,deleteTheme:function(){t.LA.clear().then((function(){t.props.FormMaster.ThemeMaster.isCustomized()&&!n.PrimaryCustomizedThemeColor&&t.props.applyTheme((0,nr.getIoCDefaultTheme)().Name),t.pA=!0,t.forceUpdate()}))},IsActive:n.Theme.Name===Qi.FP,ShowColorSnapshot:!1,Theme:this.props.FormMaster.ThemeMaster.getCustomizedTheme()})}return null},n.prototype.OA=function(){if(this.state.ShowColorPicker&&(1===this.state.HexCodeStatus||this.props.FormMaster.Model.PrimaryCustomizedThemeColor))return null;var t={onClick:this.FA},n=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:t,FluentIcon:"Paint Bucket",IconClassName:"customized-theme-pictureAdd-icon forms-icon-size28x28",ref:this.yA,Text:(0,T.pm)().Add_Customized_Theme_Color});return g.createElement("span",{key:"addColor"},n)},n.prototype._A=function(){var t=this.props.FormMaster.Model.PrimaryCustomizedThemeColor;if(this.state.ShowColorPicker&&1!==this.state.HexCodeStatus&&t){var n={};return n.backgroundColor=t,g.createElement("div",{className:"color-picker-use-color",style:n})}return null},n.prototype.BA=function(){return this.state.ShowColorPicker&&1===this.state.HexCodeStatus?(0,z.F)({ButtonStyle:1,HTMLAttributes:{className:"office-form-theme-button",onClick:this.DA},FluentIcon:"Dismiss",IconClassName:"color-picker-remove-color forms-icon-size24x24"}):null},n.prototype.VA=function(){if(!this.state.ShowColorPicker)return null;var t=(0,ur.ZA)({AutoFocus:this.state.FocusOnColorInput,AutoSelection:!0,HTMLAttributes:{className:"color-picker-input"},MaxLength:120,MinimalHeight:60,onValueChange:this.xA,Options:{HTMLPropsForInnerElement:{"aria-label":(0,T.pm)().Customized_Theme_Color_Input}},TextFieldType:0,Value:this.state.CustomizedColor});return g.createElement("span",{className:"color-picker-container"},t)},n.prototype.UA=function(){var t="";return this.state.ShowColorPicker&&1===this.state.HexCodeStatus&&(t=(0,T.pm)().Customized_Theme_Color_Error_InvalidCode),g.createElement("div",{className:"customize-theme-view-message error",role:"alert",ref:this.NA},t)},n.prototype.jA=function(){var t="";return this.state.ShowColorPicker&&2===this.state.HexCodeStatus&&(t=(0,T.pm)().Customized_Theme_Color_Suggestion_TooLight),g.createElement("div",{className:"customize-theme-view-message suggestion","aria-live":"polite",role:"alert",ref:this.SA},t)},n.prototype.JA=function(t){var n=this;/^#[0-9A-F]{6}$/i.test(t)?(this.props.FormMaster.bulkEdit((function(e){e.PrimaryCustomizedThemeColor=t,e.SecondaryCustomizedThemeColor=(0,vf.Mk)(t),e.TertiaryCustomizedThemeColor=(0,vf.zn)(t),n.props.applyTheme(Qi.FP)})),(0,vf.Ym)((0,vf.$W)(t))?this.setState({HexCodeStatus:0}):this.setState({HexCodeStatus:2},(function(){(0,q.$U)("DesignPage.Theme.ColorTooLight")}))):this.setState({HexCodeStatus:1})},n.prototype.WA=function(){var t=this.props.FormMaster.Model;if(this.state.ShowColorPicker&&t.PrimaryCustomizedThemeColor){var n={};n.backgroundColor=t.PrimaryCustomizedThemeColor;var e=g.createElement("div",null,g.createElement("div",{className:"snapshot-title",style:n},g.createElement("div",{className:"snapshot-title-content"})),g.createElement("div",{className:"snapshot-content"},g.createElement("div",{className:"snapshot-submit-button",style:n}))),i={};return t.Background.ResourceUrl?i.backgroundImage="url(".concat(t.Background.ResourceUrl,"_mo)"):t.TertiaryCustomizedThemeColor&&(i.backgroundColor=t.TertiaryCustomizedThemeColor),g.createElement("div",{className:"color-snapshot-container",style:i},e)}return null},n.prototype.FA=function(){(0,q.$U)("DesignPage.Theme.AddColor"),this.setState({CustomizedColor:"Hex #",FocusOnColorInput:!0,ShowColorPicker:!0})},n.prototype.DA=function(){var t=this;(0,q.$U)("DesignPage.Theme.DeleteColor"),this.props.FormMaster.bulkEdit((function(n){n.PrimaryCustomizedThemeColor&&(n.PrimaryCustomizedThemeColor=null,n.SecondaryCustomizedThemeColor=null,n.TertiaryCustomizedThemeColor=null,t.props.applyTheme(Qi.FP))})),this.bA=!0,this.setState({HexCodeStatus:0,ShowColorPicker:!1})},n.prototype.TA=function(){var t=this,n=!1;(0,q.$U)("DesignPage.Theme.AddImage"),(0,gf.L)().then((function(e){var i=t.props.FormMaster.Model;if(t.props.onFlexPaneIndexChange(),t.LA.addImage(e).finally((function(){t.props.applyTheme(Qi.FP),n&&t.setState({CustomizedColor:i.Theme.PrimaryColor,ShowColorPicker:!0})})),t.state.ColorScriptLoaded&&e.File&&e.File.size<=(0,X.yi)()){var r=new FileReader;r.onload=function(){var t=new Image;t.src="string"==typeof r.result?r.result:"",t.onload=function(){var e,r=new ColorThief;try{var o=r.getColor(t);e={R:o[0],G:o[1],B:o[2]}}catch(t){e=(0,vf.$W)(Vi.tu)}e=(0,vf.ZR)(e),i.PrimaryCustomizedThemeColor=i.PrimaryCustomizedThemeColor||(0,vf.hq)(e),i.SecondaryCustomizedThemeColor=i.SecondaryCustomizedThemeColor||(0,vf.Mk)(i.PrimaryCustomizedThemeColor),i.TertiaryCustomizedThemeColor=i.TertiaryCustomizedThemeColor||(0,vf.zn)(i.PrimaryCustomizedThemeColor),n=!0}},r.readAsDataURL(e.File)}}))},n.prototype.KA=function(){var t=this.props.FormMaster,n=this.LA,e=n.Model;if(!t)return null;if(e.ImageProcessingStatus!==ze.nv.Idle||e.ErrorType===ze.dL.NoError)return null;var i=(0,sr._)({HTMLAttributes:{className:"error-message"},key:"error-message",Label:n.getImageErrorMessage()}),r=(0,V.M)({FluentIcon:"Emoji Sad",HTMLAttributes:{className:"customized-theme-error-frowny-icon"},key:"customized-theme-error-frowny-icon"});return g.createElement("div",{className:"customized-theme-error",key:"customized-them-error"},r,i)},n.prototype.MA=function(){if(this.NA.current){var t=this.NA.current;t.innerText=t.innerText}if(this.SA.current){var n=this.SA.current;n.innerText=n.innerText}},n.prototype.xA=function(t){this.setState({CustomizedColor:t},this.MA),(t=t.replace(/\s/g,"").toLowerCase()).startsWith("hex")&&(t=t.substr(3)),"#"!==t[0]&&(t="#"+t),this.JA(t)},n.prototype.xu=function(){var t=this.LA.Model,n=g.createElement(qa.P,(0,p.pi)({},{ClassName:"deignPage-customized-theme-spinner",Ignorable:!1},{key:"group-forms-count-spinner"}));return t.ImageProcessingStatus!==ze.nv.Idle?g.createElement("div",{className:"customized-theme-spinner-container"},g.createElement("div",{className:"customized-theme-spinner"},n)):null},n}(J.r),wf=[{BackgroundColor:Vi.lP,BackgroundImage:null,Name:"Teal",PrimaryColor:Vi.tu,SecondaryColor:Vi.oc,Thumbnail:"/Images/Theme/new-teal-thumbnail.png"},{BackgroundColor:"#ECF8FE",BackgroundImage:null,Name:"Bright_Blue",PrimaryColor:"#0270C5",SecondaryColor:"#0A57BE",Thumbnail:"/Images/Theme/brightblue-thumbnail.png"},{BackgroundColor:"#E6EDF2",BackgroundImage:null,Name:"Medium_Dark_Blue",PrimaryColor:"#004B8B",SecondaryColor:"#003D72",Thumbnail:"/Images/Theme/darkblue-thumbnail.png"},{BackgroundColor:"#FCF2F0",BackgroundImage:null,Name:"Dark_Orange",PrimaryColor:"#C23D1A",SecondaryColor:"#B12714",Thumbnail:"/Images/Theme/darkorange-thumbnail.png"},{BackgroundColor:"#EEF8E7",BackgroundImage:null,Name:"Bright_Green",PrimaryColor:"#0C7E04",SecondaryColor:"#086802",Thumbnail:"/Images/Theme/brightgreen-thumbnail.png"},{BackgroundColor:"#F2E6EB",BackgroundImage:null,Name:"Pomegranate",PrimaryColor:"#911844",SecondaryColor:"#781438",Thumbnail:"/Images/Theme/pomegranate-thumbnail.png"},{BackgroundColor:"#F2E6EE",BackgroundImage:null,Name:"Pink",PrimaryColor:"#BF3088",SecondaryColor:"#A62A76",Thumbnail:"/Images/Theme/pink-thumbnail.png"},{BackgroundColor:"#F2E6F2",BackgroundImage:null,Name:"Raspberry",PrimaryColor:"#8D398F",SecondaryColor:"#742F76",Thumbnail:"/Images/Theme/raspberry-thumbnail.png"}],Sf=[{BackgroundColor:"#E6EDF2",BackgroundImage:null,Name:"Royal_Blue",PrimaryColor:"#286EA8",SecondaryColor:"#3B7DB3",Thumbnail:"/Images/Theme/royal-blue-thumbnail.png"},{BackgroundColor:"#E6E6F2",BackgroundImage:null,Name:"Very_Peri",PrimaryColor:"#6667AB",SecondaryColor:"#7576B5",Thumbnail:"/Images/Theme/very-peri-thumbnail.png"}],Nf=[{BackgroundColor:"#F2EAE6",BackgroundImage:"/Images/Theme/office.png",Name:"Office",PrimaryColor:"#B84F22",SecondaryColor:"#9F441D",Thumbnail:"/Images/Theme/office-thumbnail2.png"},{BackgroundColor:"#E6EDF2",BackgroundImage:"/Images/Theme/ocean.png",Name:"Ocean",PrimaryColor:"#1D5482",SecondaryColor:"#174469",Thumbnail:"/Images/Theme/ocean-thumbnail2.png"},{BackgroundColor:"#E6EEF2",BackgroundImage:"/Images/Theme/sky.png",Name:"Sky",PrimaryColor:"#006DB2",SecondaryColor:"#005D99",Thumbnail:"/Images/Theme/sky-thumbnail2.png"},{BackgroundColor:"#E6EEF2",BackgroundImage:"/Images/Theme/ski.png",Name:"Ski",PrimaryColor:"#006DB2",SecondaryColor:"#005D99",Thumbnail:"/Images/Theme/ski-thumbnail2.png"},{BackgroundColor:"#EDF2E6",BackgroundImage:"/Images/Theme/city01.png",Name:"City01",PrimaryColor:"#3A501D",SecondaryColor:"#283714",Thumbnail:"/Images/Theme/city01-thumbnail2.png"},{BackgroundColor:"#E6ECF2",BackgroundImage:"/Images/Theme/city02.png",Name:"City02",PrimaryColor:"#024582",SecondaryColor:"#023769",Thumbnail:"/Images/Theme/city02-thumbnail2.png"},{BackgroundColor:"#EAF4DC",BackgroundImage:"/Images/Theme/chemistry.png",Name:"Chemistry",PrimaryColor:"#025700",SecondaryColor:"#013E00",Thumbnail:"/Images/Theme/chemistry-thumbnail2.png"},{BackgroundColor:"#E6E9F2",BackgroundImage:"/Images/Theme/astronomy.png",Name:"Astronomy",PrimaryColor:"#0A1431",SecondaryColor:"#050A18",Thumbnail:"/Images/Theme/astronomy-thumbnail2.png"},{BackgroundColor:"#ECE6F2",BackgroundImage:"/Images/Theme/office2.png",Name:"Office2",PrimaryColor:"#562685",SecondaryColor:"#461F6C",Thumbnail:"/Images/Theme/office2-thumbnail2.png"},{BackgroundColor:"#E6ECF2",BackgroundImage:"/Images/Theme/meeting.png",Name:"Meeting",PrimaryColor:"#053870",SecondaryColor:"#042B57",Thumbnail:"/Images/Theme/meeting-thumbnail2.png"}],Cf=[{BackgroundColor:"#E6ECF2",BackgroundImage:"/Images/Theme/office-stationery2.png",Name:"Office_Stationery_2",PrimaryColor:"#28767B",SecondaryColor:"#39858A",Thumbnail:"/Images/Theme/office-stationery2-thumbnail2.png"},{BackgroundColor:"#F2EBE6",BackgroundImage:"/Images/Theme/camera.png",Name:"Camera",PrimaryColor:"#9C6039",SecondaryColor:"#835030",Thumbnail:"/Images/Theme/camera-thumbnail2.png"},{BackgroundColor:"#F2E6E7",BackgroundImage:"/Images/Theme/colorful-pencils.png",Name:"Colorful_Pencils",PrimaryColor:"#5C292E",SecondaryColor:"#6F393F",Thumbnail:"/Images/Theme/colorful-pencils-thumbnail2.png"},{BackgroundColor:"#F2EBE6",BackgroundImage:"/Images/Theme/office-stationery.png",Name:"Office_Stationery",PrimaryColor:"#897052",SecondaryColor:"#705B43",Thumbnail:"/Images/Theme/office-stationery-thumbnail2.png"},{BackgroundColor:"#F2E6E7",BackgroundImage:"/Images/Theme/abstract-shapes.png",Name:"Abstract_Shapes",PrimaryColor:"#AF5458",SecondaryColor:"#96484B",Thumbnail:"/Images/Theme/abstract-shapes-thumbnail2.png"},{BackgroundColor:"#E6EDF2",BackgroundImage:"/Images/Theme/linellae.png",Name:"Linellae",PrimaryColor:"#056EC1",SecondaryColor:"#1D7FC9",Thumbnail:"/Images/Theme/linellae-thumbnail2.png"},{BackgroundColor:"#E6F0F2",BackgroundImage:"/Images/Theme/abstract-streamers.png",Name:"Abstract_Streamers",PrimaryColor:"#327A88",SecondaryColor:"#29636F",Thumbnail:"/Images/Theme/abstract-streamers-thumbnail2.png"},{BackgroundColor:"#E6EDF2",BackgroundImage:"/Images/Theme/abstract-streamers2.png",Name:"Abstract_Streamers_2",PrimaryColor:"#056EC1",SecondaryColor:"#1D7FC9",Thumbnail:"/Images/Theme/abstract-streamers2-thumbnail2.png"},{BackgroundColor:"#EAE6F2",BackgroundImage:"/Images/Theme/radiating-lines.png",Name:"Radiating_Lines",PrimaryColor:"#442E72",SecondaryColor:"#543E84",Thumbnail:"/Images/Theme/radiating-lines-thumbnail2.png"}];function If(){return uf||(uf=wf.concat(Sf,Nf,Cf)).forEach((function(t,n){t.BackgroundImage=(0,zi.Jn)(t.BackgroundImage),t.Thumbnail=(0,zi.Jn)(t.Thumbnail),uf[n]=Object.freeze(t)})),uf}var Tf=function(t){function n(n){var e=t.call(this,n)||this;return e.YA=g.createRef(),e.Ag=g.createRef(),e.state={ShowSpinner:!1},e.nE=e.nE.bind(e),e.eE=e.eE.bind(e),e.iE=e.iE.bind(e),e.rE=e.rE.bind(e),e.aE=(0,T.pm)(),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){1===n.lastButton&&this.Ag.current&&(n.lastButton=null,this.Ag.current.focus())},n.prototype.render=function(){return g.createElement("div",{className:"theme-designer-container",key:"theme-designer-container",role:"listbox","aria-label":(0,T.pm)().DesignPage_NavBar_Theme,onKeyUp:this.iE,ref:this.YA},this.uE(),this.cE(),this.lE())},n.prototype.rE=function(t){var n,e=null===(n=this.YA.current)||void 0===n?void 0:n.children;$(e[t].firstChild).focus(),t===e.length-1?this.props.applyTheme(Qi.FP):this.props.applyTheme(If()[t].Name)},n.prototype.iE=function(t){var n,e=null===(n=this.YA.current)||void 0===n?void 0:n.childNodes,i=$(e).find(".active"),r=y.findIndex(e,(function(t){return i[0]===t.firstChild}));switch(t.keyCode){case 37:case 38:t.stopPropagation(),t.preventDefault(),r>0?this.rE(r-1):r<0&&this.rE(e.length-2);break;case 39:case 40:if(t.stopPropagation(),t.preventDefault(),r!==e.length-1)this.rE(r+1);else{var o=this.props.FormMaster.Model;o.Background.ResourceUrl||o.PrimaryCustomizedThemeColor?this.eE():this.nE()}}},n.prototype.uE=function(){var t=this,n=If().length,e=this.props.FormMaster.Model;return(e.Background.ResourceUrl||e.PrimaryCustomizedThemeColor)&&(n+=1),If().map((function(e,i){var r=t.props.FormMaster.ThemeMaster.Model;return g.createElement(bf,{applyTheme:t.props.applyTheme,IsActive:r.Name===e.Name,ShowColorSnapshot:!1,Theme:e,key:e.Name,ThemeIndex:i,ThemeLength:n})}))},n.prototype.lE=function(){var t=this.props.FormMaster.Model;if(t.Background.ResourceUrl||t.PrimaryCustomizedThemeColor)return null;var n={className:"theme-icon-button",onClick:this.nE},e=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:n,FluentIcon:"Add",IconClassName:"customized-theme-pictureAdd-icon forms-icon-size28x28",Text:this.aE.Add_Customized_Theme,ref:this.Ag});return g.createElement("span",{className:"theme-icon-container",key:"add"},e,this.xu())},n.prototype.cE=function(){var t=this.props.FormMaster.Model;return t.Background.ResourceUrl||t.PrimaryCustomizedThemeColor?g.createElement(bf,{applyTheme:this.props.applyTheme,editTheme:this.eE,IsActive:t.Theme.Name===(0,T.pm)().Customized_Theme_Name,ShowColorSnapshot:!!t.PrimaryCustomizedThemeColor&&!!t.Background.ResourceUrl,Theme:this.props.FormMaster.ThemeMaster.getCustomizedTheme()}):null},n.prototype.eE=function(){(0,q.$U)("DesignPage.Theme.EditCustomizedTheme"),this.props.applyTheme(Qi.FP),this.props.onViewNavigation(),n.lastButton=2},n.prototype.nE=function(){(0,q.$U)("DesignPage.Theme.AddCustomizedTheme"),this.props.onViewNavigation(),n.lastButton=1},n.prototype.xu=function(){var t=this.props.FormMaster.getImageMaster(F.x.Schema.Background);return!this.state.ShowSpinner&&t.Model.ImageProcessingStatus===ze.nv.Idle||t.Model.ErrorType!==ze.dL.NoError?null:g.createElement("div",{className:"customized-theme-spinner-container"},g.createElement("div",{className:"customized-theme-spinner"},g.createElement("div",{className:"spinner-tile-animation"})))},n}(J.r),kf=function(t){function n(n){var e=t.call(this,n)||this;return e.NR=e.NR.bind(e),e.fE=e.fE.bind(e),e.hE=e.hE.bind(e),e.state={ShowCustomizeThemeView:!1,ShowSuggestThemeView:!0},e}return(0,p.ZT)(n,t),n.prototype.render=function(){return g.createElement("div",{className:"theme-container"},this.dE(),this.mE(),this.gE())},n.prototype.dE=function(){return this.state.ShowCustomizeThemeView?null:g.createElement(mf,{applyTheme:this.NR,expandOrCollapseSuggest:this.fE,ExpandView:this.state.ShowSuggestThemeView,FormMaster:this.props.FormMaster})},n.prototype.mE=function(){return this.state.ShowCustomizeThemeView?null:g.createElement(Tf,{FormMaster:this.props.FormMaster,applyTheme:this.NR,onViewNavigation:this.hE})},n.prototype.gE=function(){return this.state.ShowCustomizeThemeView?g.createElement(yf,{applyTheme:this.NR,FormMaster:this.props.FormMaster,onFlexPaneIndexChange:this.props.onFlexPaneIndexChange,onViewNavigation:this.hE}):null},n.prototype.NR=function(t){this.props.FormMaster.ThemeMaster.Model.Name=t,this.forceUpdate()},n.prototype.fE=function(){this.setState({ShowSuggestThemeView:!this.state.ShowSuggestThemeView})},n.prototype.hE=function(){this.setState({ShowCustomizeThemeView:!this.state.ShowCustomizeThemeView})},n}(J.r);var xf=e(31437),Ff=e(72839),Pf=function(t){function n(n){var e=t.call(this,n)||this;return e.ys=g.createRef(),e.If=e.If.bind(e),e}return(0,p.ZT)(n,t),n.prototype.render=function(){var t={ButtonStyle:1,children:[g.createElement(Ff.H,{DisplayName:this.props.GroupMaster.Model.displayName,Photo:this.props.GroupMaster.Photo,PhotoType:1,key:this.props.GroupMaster.Model.id})],HTMLAttributes:{className:"flex-pane-moveform-destbutton",onClick:this.If.bind(this),title:this.props.GroupMaster.Model.displayName},ref:this.ys,ToggleActive:this.props.IsSelected},n=g.createElement(Dr.zx,(0,p.pi)({},t));return g.createElement("li",{key:this.props.GroupMaster.Model.id,"aria-selected":this.props.IsSelected,role:"option"},n)},n.prototype.focus=function(){this.ys.current&&this.ys.current.focus()},n.prototype.If=function(){this.props.onGroupSelected(this.props.GroupMaster)},n}(J.r),Df=function(t){function n(n){var e=t.call(this,n)||this;return e.pE=-1,e.bE=g.createRef(),e.vo=!0,e.yE=e.yE.bind(e),e.wE=e.wE.bind(e),e.SE=e.SE.bind(e),e.NE=e.NE.bind(e),(0,q.$U)("PortalPage.MoveFormPane.Start",{FormId:n.SelectedForm.Model.Id,IsDelegateMode:n.IsDelegateMode}),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this;if((0,kr.mZ)(b.findDOMNode(this)),!(0,c.k0)().userInfo.IsMsa){var n=(0,aa.F)();n.ensureFieldsReady([n.Schema.groups]).then((function(){t.vo&&((0,q.$U)("PortalPage.MoveFormPane.GroupsCount",{groupsCount:n.Groups.length}),t.setState({AreGroupsReady:!0}))}))}},n.prototype.componentWillUnmount=function(){(0,kr.b6)(b.findDOMNode(this)),this.vo=!1},n.prototype.render=function(){var t=this,n=null,e=null,i=null,r=(0,T.pm)().MovePaneView_Label_MyGroups,o=null;if(this.state.AreGroupsReady){var s=(0,aa.F)(),a=s.Groups.length,u=this.IE(a);if(u<a){var l=(0,T.pm)().MovePaneView_Link_MoreGroupCards;i=g.createElement(Dr.zx,{ButtonStyle:1,HTMLAttributes:{"aria-expanded":!1,"aria-label":l,className:"flex-pane-moveform-moreaction",label:l,onClick:this.wE,title:(0,T.pm)().MovePaneView_Link_MoreGroupCards_Tooltip}},g.createElement("span",null,l))}u>0&&(n=s.Groups.slice(0,u).map((function(n,e){var i=t.pE===e?t.bE:void 0;return g.createElement(Pf,{onGroupSelected:t.SE,GroupMaster:n,IsSelected:t.state.SelectedGroup===n,key:n.Model.id,ref:i})}))),this.pE>-1&&(r+=", "+(0,T.pm)().MovePaneView_Link_MoreGroupCards_Alert,this.pE=-1)}if(this.props.IsDelegateMode){var f=(0,c.k0)().userInfo.DisplayName,h=(0,T.pm)().MovePaneView_Label_MyFormsWithName.format(f),d=(0,T.pm)().MovePaneView_Label_MyGroupsWithName.format(f);e=g.createElement("div",{className:"flex-pane-moveform-me-container"},g.createElement(Dr.zx,{ButtonStyle:1,HTMLAttributes:{className:"flex-pane-moveform-destbutton",onClick:this.NE,title:(0,c.k0)().userInfo.DisplayName},ToggleActive:this.state.IsTransferToMe},g.createElement(Ff.H,{DisplayName:(0,c.k0)().userInfo.DisplayName,DisplayText:h,Photo:(0,xf.my)(),PhotoType:0}))),o=g.createElement("div",{className:"flex-pane-moveform-group-title"},d)}return g.createElement("div",{className:"flex-pane-moveform-content"},g.createElement("div",{className:"flex-pane-content-container-title",role:"heading","aria-level":1},(0,T.pm)().MovePaneView_Label_MoveSingleForm),g.createElement("div",{className:"flex-pane-moveform-formtitle",role:"heading","aria-level":2},this.props.SelectedForm.Model.Title),g.createElement("div",{className:"flex-pane-moveform-destArea"},g.createElement("div",{className:"flex-pane-moveform-label-prompt"},(0,T.pm)().MovePaneView_Label_ChooseContainer),e,g.createElement("div",{className:"flex-pane-moveform-group-container"},o,g.createElement("ul",{"aria-label":r,className:"flex-pane-moveform-grouplist",role:"listbox"},n),g.createElement("div",null,i))),g.createElement(Dr.zx,{ButtonStyle:1,HTMLAttributes:{className:"flex-pane-moveform-button",disabled:!this.TE(),onClick:this.yE}},g.createElement("span",null,(0,T.pm)().MovePaneView_Button_MoveAction)))},n.prototype.IE=function(t){if(this.state.ShowAllGroups)return t;if(t<=0)return 0;var n=window.innerHeight-330;if(this.props.IsDelegateMode){n-=90}var e=Math.floor(n/40);return e<1?1:e>t?t:e},n.prototype.TE=function(){return this.state.IsTransferToMe||!!this.state.SelectedGroup},n.prototype.wE=function(){var t=this,n=(0,aa.F)().Groups.length;this.pE=this.IE(n),this.setState({ShowAllGroups:!0},(function(){t.bE.current&&t.bE.current.focus()}))},n.prototype.SE=function(t){this.setState({SelectedGroup:t,IsTransferToMe:!1})},n.prototype.NE=function(){this.setState({SelectedGroup:null,IsTransferToMe:!0})},n.prototype.yE=function(){if(this.state.IsTransferToMe)this.props.changeFormOwnerHandler({IsGroupForm:!1,OwnerId:(0,c.k0)().userInfo.UserId,OwnerTenantId:(0,c.k0)().userInfo.TenantId});else if(this.state.SelectedGroup){var t=this.state.SelectedGroup;this.props.changeFormOwnerHandler({IsGroupForm:!0,OwnerId:t.Model.id,OwnerTenantId:(0,c.k0)().userInfo.TenantId}).then((function(n){n&&t.isFieldReady(t.Schema.formReferences)&&t.addFormReference(n)}))}},n}(J.r);var Mf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){},n.prototype.render=function(){var t={className:"flex-pane-feedback-post-community",onClick:function(){(0,q.$U)("DesignPage.Feedback.Suggestion"),(0,$s.K)("https://microsoftforms.uservoice.com")}},n=g.createElement("div",{className:"flex-pane-content flex-pane-feedback-box"},g.createElement("div",{className:"flex-pane-feedback-title"},(0,T.pm)().FlexPane_FeedbackView_SuggestionTitle),g.createElement("div",{className:"flex-pane-feedback-desription"},(0,T.pm)().FlexPane_FeedbackView_SuggestionDescription),g.createElement("button",t,(0,T.pm)().FlexPane_FeedbackView_SuggestionButton),g.createElement("div",{className:"flex-pane-feedback-suggestionterm"},(0,T.pm)().FlexPane_FeedbackView_SuggestionTerms));return g.createElement("div",{className:"flex-pane-feedback-container"},g.createElement("div",{className:"flex-pane-feedback-content"},n))},n}(J.r),Lf=function(t){function n(n){var e=t.call(this,n)||this;e.qh=!1,e.As=function(){return e.forceUpdate()},e.kE=e.kE.bind(e),e.fE=e.fE.bind(e),e.Je=(0,k.f5)().Model.FormMaster;var i=e.Je.ThemeMaster;e.state={Theme:i,CustomizedImage:e.Je.Model.Background,ShowSpinner:!1,ShowErrorMessage:!1,ColorScriptLoaded:!1,ShowSuggestThemeView:!0};var r=e.Je.getImageMaster(e.Je.Schema.Background);return r.observe(e.As,[r.Schema.ImageProcessingStatus]),e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this;(0,Pr.y)("ColorThief").then((function(){t.setState({ColorScriptLoaded:!0})}))},n.prototype.componentWillUnmount=function(){this.Je.getImageMaster(this.Je.Schema.Background).unobserve(this.As)},n.prototype.componentDidUpdate=function(){var t=b.findDOMNode(this.refs.AddImageButton);t&&this.qh&&(t.focus(),this.qh=!1)},n.prototype.render=function(){return g.createElement("div",null,this.dE(),g.createElement("div",{className:"theme-designer-container",key:"theme-designer-container"},this.uE(),this.state.CustomizedImage.ResourceId?this.cE():this.xE()),this.FE())},n.prototype.dE=function(){return g.createElement(mf,{applyTheme:this.kE,expandOrCollapseSuggest:this.fE,ExpandView:this.state.ShowSuggestThemeView,FormMaster:this.Je})},n.prototype.uE=function(){var t=this,n=this.Je.ThemeMaster;return If().map((function(e){var i,r=(0,pf.U)(e.Name),o={className:"theme-icon-button",title:r,"aria-label":r,onClick:function(){return t.PE(e.Name,t.Je)}};return i=e.Thumbnail?{backgroundImage:"url(".concat(e.Thumbnail,")")}:{backgroundColor:e.PrimaryColor},g.createElement("span",{className:"theme-icon-container",key:e.Name},(0,Dr.ax)({HTMLAttributes:o,key:e.Name,ButtonStyle:1,ToggleActive:n.Model.Name===e.Name,children:g.createElement("span",{className:"theme-icon",style:i})}))}))},n.prototype.cE=function(){var t=this,n=this.Je.ThemeMaster,e=this.Je.Model.Background,i={className:"theme-icon-button",title:(0,T.pm)().Customized_Theme_Name,onClick:function(){return t.DE()}},r=(0,z.F)({HTMLAttributes:{className:"customized-theme-delete-button",onClick:function(){(0,q.$U)("DesignPage.Theme.DeleteImage"),t.setState({ShowSpinner:!0});var n=(0,k.f5)().Model.FormMaster,e=n.getImageMaster(F.x.Schema.Background),i=t.state.Theme.Model.Name===Qi.FP;e.clear().then((function(){t.setState({ShowSpinner:!1}),t.qh=!0,i?t.PE((0,nr.getIoCDefaultTheme)().Name,n):t.forceUpdate()}))}},FluentIcon:"Delete",IconClassName:"paneThemeTrash forms-icon-size18x18",ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",Text:(0,T.pm)().Common_Delete_Text,key:"deleteButton"});return g.createElement("span",{className:"theme-icon-container",key:"added"},(0,Dr.ax)({HTMLAttributes:i,ButtonStyle:1,ToggleActive:n.Model.Name===Qi.FP,children:g.createElement("img",{className:"theme-icon",key:Qi.FP,src:e.IsPredefined?e.ResourceUrl:e.ResourceUrl+"_mo",onLoad:function(){t.setState({ShowSpinner:!1})}})}),r,this.ME())},n.prototype.xE=function(){var t=this,n={className:"theme-icon-button",disabled:this.Je.getImageMaster(F.x.Schema.Background).Model.ImageProcessingStatus!==ze.nv.Idle,onClick:function(){return t.LE()}};return g.createElement("span",{className:"theme-icon-container",key:"add"},(0,z.F)({HTMLAttributes:n,FluentIcon:"Image",IconClassName:"customized-theme-pictureAdd-icon forms-icon-size28x28",ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",Text:(0,T.pm)().Add_Customized_Theme_Image,ref:"AddImageButton"}),this.ME())},n.prototype.LE=function(){var t=this;(0,q.$U)("DesignPage.Theme.AddImage"),(0,gf.L)().then((function(n){(0,k.f5)().Model.FlexPane="Theme";var e=t.Je.Model;if(t.setState({ShowSpinner:!0}),t.Je.getImageMaster(F.x.Schema.Background).addImage(n).finally((function(){t.DE()})),t.state.ColorScriptLoaded)if(n.File&&n.File.size<=(0,X.yi)()){var i=new FileReader;i.onload=function(n){var r=new Image;r.src=i.result.toString(),r.onload=function(n){var i,o=new ColorThief;try{var s=o.getColor(r);i={R:s[0],G:s[1],B:s[2]}}catch(t){i=(0,vf.$W)(Vi.tu)}var a=(0,vf.je)(i);(0,vf.Ym)(i)||(a.V=.45,i=(0,vf.f0)(a)),t.Je.bulkEdit((function(){e.PrimaryCustomizedThemeColor=(0,vf.hq)(i);var t=(0,vf.f0)({H:a.H,S:a.S,V:a.V-.1});e.SecondaryCustomizedThemeColor=(0,vf.hq)(t);var n=(0,vf.f0)({H:a.H,S:.1,V:1});e.TertiaryCustomizedThemeColor=(0,vf.hq)(n)}))}},i.readAsDataURL(n.File)}else n.FromUrl&&t.Je.bulkEdit((function(){var t=(0,nr.getIoCDefaultTheme)();e.PrimaryCustomizedThemeColor=t.PrimaryColor,e.SecondaryCustomizedThemeColor=t.SecondaryColor,e.TertiaryCustomizedThemeColor=t.BackgroundColor}))}))},n.prototype.PE=function(t,n){var e=n.ThemeMaster;(0,q.f)("DesignPage.Theme.SwitchTheme",{theme:t}),e.Model.Name=t,this.setState({Theme:e,ShowErrorMessage:!1})},n.prototype.DE=function(){var t=this.Je.Model;t.Background.ResourceUrl?this.PE(Qi.FP,this.Je):(t.PrimaryCustomizedThemeColor=void 0,t.SecondaryCustomizedThemeColor=void 0,t.TertiaryCustomizedThemeColor=void 0,this.setState({ShowErrorMessage:!0}))},n.prototype.kE=function(t){this.Je.ThemeMaster.Model.Name=t,this.setState({ShowErrorMessage:!1})},n.prototype.fE=function(){this.setState({ShowSuggestThemeView:!this.state.ShowSuggestThemeView})},n.prototype.ME=function(){var t=this.Je.getImageMaster(F.x.Schema.Background);return!this.state.ShowSpinner&&t.Model.ImageProcessingStatus===ze.nv.Idle||t.Model.ErrorType!==ze.dL.NoError?void 0:g.createElement("div",{className:"customized-theme-spinner-container"},g.createElement("div",{className:"customized-theme-spinner customized-theme-spinner-inner-container"},g.createElement("div",{className:"common-spinner-circle"})))},n.prototype.FE=function(){var t=(0,k.f5)().Model.FormMaster;if(!t)return null;var n=t.getImageMaster(F.x.Schema.Background),e=n.Model;if(!this.state.ShowErrorMessage||e.ErrorType===ze.dL.NoError)return null;var i=(0,sr._)({HTMLAttributes:{className:"error-message"},Label:n.getImageErrorMessage(),key:"error-message"}),r=(0,V.M)({FluentIcon:"Emoji Sad",HTMLAttributes:{className:"customized-theme-error-frowny-icon"},key:"customized-theme-error-frowny-icon"});return g.createElement("div",{className:"customized-theme-error",key:"customized-them-error"},r,i)},n}(J.r);var Rf=e(38537);function Af(t,n){var e=null!=n?n:(0,T.pm)();switch(t){case"Email":return e.Share_Options_Email;case"Embed":return e.Share_Options_Embed;case"Facebook":return e.Share_Options_Facebook;case"Invitation":return e.Share_Options_Invitation;case"Link":return e.Share_Options_Link;case"QRCode":return e.Share_Options_QRCode;case"Teams":return e.Share_Options_Teams;case"Twitter":return e.Share_Options_Twitter;default:return""}}var Ef=e(2926),Of=e.n(Ef),_f=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.vo=!0,n}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this;this.RE().then((function(n){t.vo&&t.setState({Base64URL:n})})).catch((function(t){}))},n.prototype.componentWillUnmount=function(){this.vo=!1},n.prototype.render=function(){return g.createElement("img",{alt:this.props.Title,title:this.props.Title,src:this.state.Base64URL||"iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8z8BQDwAEhQGAhKmMIQAAAABJRU5ErkJggg=="})},n.prototype.download=function(){var t=this;this.AE().then((function(n){return Of().saveAs(n,t.props.Title+".png")}))},n.prototype.AE=function(){return this.RE().then((function(t){var n=t&&t.split("base64,")[1];if(!n)throw Error("Invalid URL: "+t);for(var e=window.atob(n),i=new Uint8Array(e.length),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return new Blob([i])}))},n.prototype.RE=function(){var t=this;return this._E||(this._E=(0,Pr.y)("JQuery_QRCode").then((function(){var n=$("<div/>").qrcode({correctLevel:1,height:800,text:t.props.URL,width:800}).children("canvas")[0];if(n)return n.toDataURL();throw Error("QRCode doesn't work with URL: "+t.props.URL)}))),this._E},n}(J.r),Bf="DesignPage.Send.Facebook",Hf=!1;function Gf(){Hf||(window.fbAsyncInit=function(){FB.init({appId:(0,ht.yv)()?"324475574804737":"521753901675351",autoLogAppEvents:!0,version:"v3.1",xfbml:!0})},function(){var t=document.getElementsByTagName("script")[0],n=document.getElementsByTagName("script")[0];if(document.getElementById("facebook-jssdk"))return;(t=document.createElement("script")).id="facebook-jssdk",(0,zs.M5)(t,"https://connect.facebook.net/en_US/sdk.js"),n.parentNode&&n.parentNode.insertBefore(t,n)}(),Hf=!0)}var qf=function(t){function n(n){var e=t.call(this,n)||this;return e.BE=e.BE.bind(e),e.HE=e.HE.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){Gf()},n.prototype.render=function(){var t=(0,T.pm)().Share_Options_Facebook,n=(0,T.pm)().Share_Options_Twitter;return g.createElement("div",{className:"flex-pane-social-channel-title-container"},Vf(this.BE,"facebookIcon",t),Vf(this.HE,"twitterIcon",n))},n.prototype.BE=function(){try{FB.ui({href:this.GE("Facebook"),method:"share"},(function(){})),(0,q.$U)(Bf)}catch(t){(0,q.zU)(Bf,{error:t.message})}},n.prototype.HE=function(){(0,q.$U)("DesignPage.Send.Twitter");var t=encodeURIComponent((0,T.pm)().SharePane_Twitter_FillFormMessage+" #MicrosoftForms"),n=encodeURIComponent(this.GE("Twitter")),e=screen.width/2-300,i=screen.height/2-200;window.open("".concat("https://twitter.com/intent/tweet","?text=").concat(t,"&url=").concat(n),"_blank","width=".concat(600,",height=").concat(400,",left=").concat(e,",top=").concat(i))},n.prototype.GE=function(t){var n={id:this.props.FormMaster.Model.Id},e="../Pages/ResponsePage.aspx?"+jQuery.param(n),i={origin:t,time:Date.now()};return"".concat((0,_t.WN)(e),"&").concat(jQuery.param(i))},n}(J.r);function Vf(t,n,e){return(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"flex-pane-more-channel-option-social",onClick:t},Icon:n,Text:e})}var zf=function(t){function n(n){return t.call(this,n)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=this,n=!(0,vt.tq)(),e=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"flex-pane-confirm-dialog-close-button",onClick:function(){return t.props.cancelCallBack()}},FluentIcon:"Dismiss",IconClassName:"forms-icon-size16x16",Text:(0,T.pm)().Common_Close_Text}),i=(0,Fr.E)({HTMLAttributes:{autoFocus:!0,className:"flex-pane-confirm-dialog-option",onClick:function(){return t.props.cancelCallBack()}},ButtonStyle:1,Text:this.props.CancelDisplayName,key:this.props.CancelDisplayName}),r=(0,Fr.E)({HTMLAttributes:{className:"flex-pane-confirm-dialog-option",onClick:function(){return t.props.confirmCallBack()}},ButtonStyle:1,Text:this.props.ConfirmDisplayName,key:this.props.ConfirmDisplayName}),o=this.props.LearnMoreLink&&g.createElement("a",{onClick:function(){return(0,$s.K)(t.props.LearnMoreLink,"_blank")},tabIndex:0},(0,T.pm)().LearnMore_General),s=n?"flex-pane-confirm-dialog-title-new":"flex-pane-confirm-dialog-title";return g.createElement("div",{className:"flex-pane-confirm-dialog-container",role:"dialog","aria-label":this.props.ConfirmDialogWarningMessage},n&&e,g.createElement("div",{className:s},this.props.ConfirmDialogWarningMessage,o),g.createElement("div",{className:"flex-pane-confirm-dialog-button-container"},i,r))},n.prototype.componentDidMount=function(){(0,kr.mZ)(b.findDOMNode(this))},n}(J.r);function Qf(){return e.e(207).then(e.bind(e,5844))}var Uf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=(0,$i.J)(n,Qf);return g.createElement(Ui.Z,{fallback:g.createElement("div",{className:"flex-pane-collaborate-specific-share-loading"},g.createElement("div",{className:"common-spinner-circle"}))},g.createElement(t,(0,p.pi)({},this.props)))},n}(J.r);function $f(t,n,e,i,r){return r(),{cancelCallBack:i,CancelDisplayName:(0,T.pm)().Common_Cancel_Text,confirmCallBack:e,ConfirmDialogWarningMessage:t,ConfirmDisplayName:(0,T.pm)().Common_Yes_Text,LearnMoreLink:n}}var jf=e(96689);function Wf(t){return"#"+t}var Kf,Jf=e(17111);function Zf(t,n,e,i,r){return(0,Jf.w)(Wf(n),(function(){t.triggerShareAction(),(0,q.$U)("DesignPage.Send.ActionSuccess",{action:n});var r=$(Wf(e));r.removeClass("flex-pane-status-error"),r.addClass("flex-pane-status-success"),r.text(i),r.show(),r.attr("aria-label",i),setTimeout((function(){r.fadeOut("slow",(function(){r.hide()}))}),3e3)}),(function(){(0,q.$U)("DesignPage.Send.ActionFailed",{action:n});var t=$(Wf(e));t.removeClass("flex-pane-status-success"),t.text(r),t.addClass("flex-pane-status-error"),t.attr("aria-label",r)}),!0)}!function(t){t[t.None=0]="None",t[t.Link=1]="Link",t[t.Email=2]="Email",t[t.QRCode=3]="QRCode",t[t.Embed=4]="Embed"}(Kf||(Kf={}));var Xf=function(t){function n(e){var i,r=this;(r=t.call(this,e)||this).vo=!0,r.qE=[],r.Gu=(0,k.f5)().Model,r.Eg=g.createRef(),r.QE=[],r.$E=!1,r.jE=!1,r.WE=g.createRef(),r.KE=[],r.As=function(){r.vo&&r.forceUpdate()},r.rp=r.rp.bind(r),r.ip=r.ip.bind(r),r.If=r.If.bind(r),r.JE=r.JE.bind(r),r.ZE=r.ZE.bind(r),r.XE=r.XE.bind(r),r.YE=r.YE.bind(r),r.Ot=(0,mi.o7)(r.props.Form.Model.Id);var o=r.props.Form,s=o.isFieldReady(o.Schema.Id)?n.shortUrlCache[o.Model.Id]:null;o&&o.isFieldReady(o.Schema.Questions)&&(r.KE=null!==(i=_.d.convertToArray(o.Model.Questions).filter((function(t){return t.QuestionTagForIntelligence&&"Unknown"!==t.QuestionTagForIntelligence})).map((function(t){return t.QuestionTagForIntelligence})))&&void 0!==i?i:[]);var a=r.tO();return r.state={CollectResponseOptionValue:a,LinkButtonChecked:!1,ShareButtonChanged:!1,ShareOption:Kf.Link,ShortUrlChecked:!1,ShortUrl:s,ShortUrlFailed:!1},r}return(0,p.ZT)(n,t),n.prototype.tO=function(){return this.props.Form.getResponseCollectionType()},n.prototype.componentWillUnmount=function(){this.vo=!1,this.qE.forEach((function(t){t&&t.destroy()})),this.qE=[]},n.prototype.componentDidMount=function(){(0,k.f5)().Model.FormMaster.observe(this.As,[F.x.Schema.Questions]),this.Wu("flex-pane-button-link","flex-pane-status-link",(0,T.pm)().SharePane_Link_SuccessMessage,(0,T.pm)().SharePane_Link_FailedMessage),this.Wu("flex-pane-button-embedCode","flex-pane-status-embedCode",(0,T.pm)().SharePane_Others_Embed_SuccessMessage,(0,T.pm)().SharePane_Others_Embed_FailedMessage)},n.prototype.componentDidUpdate=function(){this.jE&&(this.jE=!1,this.state.ShareOption===Kf.Link&&this.state.LinkButtonChecked?(0,Co.x)($(b.findDOMNode(this.refs.link_button))):this.state.ShareOption===Kf.QRCode?(0,Co.x)($(b.findDOMNode(this.refs.qr_button))):(0,Co.x)($(b.findDOMNode(this.refs.embed_button))))},n.prototype.render=function(){var t=g.createElement("div",{className:"flex-pane-content-container-title",role:"heading","aria-level":1},g.createElement("div",null,(0,T.pm)().SharePane_CollectResponse_MoreChannels)),n=g.createElement("div",{className:"flex-pane-collect-response-more-channel-element"},this.nO(),this.eO(),this.iO(),this.rO()),e=this.state.ShowConfirmDialog?g.createElement(zf,(0,p.pi)({},this.oO)):g.createElement("div",null,this.sO(),this.aO(),this.uO(),2===this.state.CollectResponseOptionValue&&this.lO(),n);return g.createElement("div",{"aria-label":(0,T.pm)().SharePane_CollectResponse_MoreChannels,className:"flex-pane-collect-response-container"},t,e)},n.prototype.sO=function(){var t=this.props.Form.SettingMaster.Model.IsAnonymous;if((0,c.k0)().userInfo.IsMsa&&t)return g.createElement("div",{className:"flex-pane-share-content-title"},(0,T.pm)().SharePane_CollectResponse_DropDownOption1_Title)},n.prototype.rO=function(){return this.QE.length=0,g.createElement("div",{className:"flex-pane-channel-title-container",role:"tablist"},this.fO(Kf.Link,"Link","sharepane-response-link-icon"),this.fO(Kf.Email,"Mail",""),this.fO(Kf.QRCode,"QR Code","qrcode-icon"),this.fO(Kf.Embed,"Code",""),(0,c.k0)().userInfo.IsMsa&&g.createElement(qf,{FormMaster:this.props.Form}))},n.prototype.nO=function(){if(this.state.ShareOption===Kf.Link)return g.createElement("div",{className:"flex-pane-channel-content",role:"tabpanel"},g.createElement("div",{className:"flex-pane-content-body-container"},this.hO(),this.state.ShortUrlFailed&&this.dO(),this.mO(),this.$E&&this.vO()))},n.prototype.eO=function(){var t,n;if(this.state.ShareOption!==Kf.QRCode)return null;var e=this.props.Form;return n=g.createElement("div",{id:"flex-pane-qrcode-img",ref:"qrcodeCanvas",className:"flex-pane-content-body-container"},g.createElement("div",{className:"flex-pane-qrcode-container"},g.createElement("span",{id:"qrcode-hint"},(0,T.pm)().SharePane_QRCode_Hint),g.createElement("button",{"aria-describedby":"qrcode-hint",className:"flex-pane-button",ref:"qr_button",title:(0,T.pm)().SharePane_QRCode_DownloadButton,onClick:this.gO.bind(this)},(0,T.pm)().SharePane_QRCode_DownloadButton),undefined),g.createElement(_f,{URL:this.pO()+"&qrcode=true",Title:null===(t=(0,T.pm)().QRCode_ALt_Title)||void 0===t?void 0:t.format(e.Model.Title),ref:"qrcode"})),g.createElement("div",{className:"flex-pane-channel-content",role:"tabpanel"},n)},n.prototype.iO=function(){if(this.state.ShareOption===Kf.Embed){var t=g.createElement("div",{className:"flex-pane-subtitle"},(0,T.pm)().SharePane_Others_Embed_Label),n=g.createElement("input",{"aria-label":(0,T.pm)().Embedded_Code_Text,readOnly:!0,value:this.bO(),className:"flex-pane-textbox",id:"flex-pane-textbox-embedCode"}),e={className:"flex-pane-button",id:"flex-pane-button-embedCode",ref:"embed_button","data-clipboard-target":"#flex-pane-textbox-embedCode"},i=g.createElement("button",e,(0,T.pm)().Common_Copy_Text);return g.createElement("div",{className:"flex-pane-channel-content",role:"tabpanel"},g.createElement("div",{className:"flex-pane-content-body-container"},t,n,i,g.createElement("div",{className:"flex-pane-status",id:"flex-pane-status-embedCode",role:"alert"})))}},n.prototype.yO=function(t,n){var e=(this.QE.indexOf(t)+(37===n?-1:1)+this.QE.length)%this.QE.length;this.QE[e].current.focus()},n.prototype.fO=function(t,n,e){var i,r=this,o=this.state.ShareOption===t;o&&this.state.ShareOption!==Kf.Email&&(i=g.createElement("div",{className:"flex-pane-more-channel-div"}));var s=(0,N.j)("flex-pane-more-channel-icon",o&&"active");s=(0,N.j)(s,e,"forms-icon-size22x22");var a=g.createRef();return this.QE.push(a),g.createElement("div",{className:"flex-pane-more-channel-box"},(0,z.F)({HTMLAttributes:{"aria-selected":o,className:(0,N.j)("flex-pane-more-channel-option",o&&"active"),role:"tab",tabIndex:o?0:-1,onClick:function(){return r.wO(t)},onKeyDown:function(t){switch(t.keyCode){case 37:case 39:r.yO(a,t.keyCode)}}},FluentIcon:n,IconClassName:s,ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",Text:Af(Kf[t]),key:Kf[t],ref:a}),i)},n.prototype.wO=function(t){if(this.jE=!0,this.SO(Kf[t]),t===Kf.Email)this.setState({ShareOption:Kf.Email},this.ZE);else{if(this.state.ShareOption!==t){(0,q.$U)({Link:"DesignPage.Send.Link",Email:"DesignPage.Send.Email",Embed:"DesignPage.Send.MoreOptions",QRCode:"DesignPage.Send.QRCode"}[Kf[t]])}t===Kf.Link&&this.setState({LinkButtonChecked:!0});var n=this.state.ShareButtonChanged;this.setState({ShareOption:t,ShareButtonChanged:!n})}},n.prototype.ZE=function(){this.props.Form.getResponderEmailList().then(this.XE)},n.prototype.XE=function(t){var n=this;(0,q.$U)("DesignPage.Send.Email");var e=(0,et.pd)((function(){return n.props.Form.Model.Title}),et.t1),i=this.state.ShortUrlChecked&&!!this.state.ShortUrl,r=(0,T.pm)().SharePane_Email_Content.format(e,this.pO(i));e=encodeURIComponent((0,T.pm)().SharePane_Email_Subject.format(e)),r=encodeURIComponent(r);var o=t?"mailto:?bcc={2}&subject={0}&body={1}".format(e,r,t):"mailto:?subject={0}&body={1}".format(e,r);o.length>2046&&(o="mailto:?subject={0}&body={1}".format(e,r));var s=navigator.userAgent.toLowerCase(),a=/chrome|firefox/.test(s)||(0,vt.gn)()||(0,vt.Dt)();if((0,dt.Kw)()&&!/electron/.test(s)&&a){var u=window.open(o);u&&setTimeout((function(){return u.close()}),200)}else location.href=o;this.props.Form.triggerShareAction()},n.prototype.NO=function(){var t=this.props.Form.SettingMaster.Model;t.IsAnonymous=!0,t.NotRecordIdentity=!0,t.RequiresUniqueResponse=!1,(0,q.$U)("DesignPage.Share.ChangeResponseCollectionType",{Value:"IsAnonymous"}),this.setState({CollectResponseOptionValue:0})},n.prototype.CO=function(){var t=this.props.Form.SettingMaster.Model;0===this.state.CollectResponseOptionValue&&(t.IsAnonymous=!1,t.NotRecordIdentity=!1),(0,q.$U)("DesignPage.Share.ChangeResponseCollectionType",{Value:"InOrg"}),this.setState({CollectResponseOptionValue:1})},n.prototype.IO=function(){var t=this.props.Form.SettingMaster.Model;0===this.state.CollectResponseOptionValue&&(t.IsAnonymous=!1,t.NotRecordIdentity=!1),(0,q.$U)("DesignPage.Share.ChangeResponseCollectionType",{Value:"SpecificRespond"}),this.setState({CollectResponseOptionValue:2})},n.prototype.uO=function(){var t=this;if((0,c.k0)().userInfo.IsMsa)return null;var n,e=this.props.Form,i=e.Model.OwnerTenantId===(0,c.k0)().userInfo.TenantId,r=[{DisplayName:(0,T.pm)().SharePane_CollectResponse_DropDownOption1_Title,Value:0,Key:"AnonymousButton",DisplayContent:this.TO(),Disabled:!this.Gu.FormsTenantSettings.externalSendForm||e.fileUploadAnonymousDisabled()||!(0,I.cr)("EnableExternalSharing"),showToolTip:this.rp,hideToolTip:this.ip,ArialLabelId:"AnonymousButton flex-pane-anonymous-tooltip"}],o=i?(0,T.pm)().SharePane_CollectResponse_DropDownOption2_Title:(0,T.pm)().SharePane_CollectResponse_DropDownOption3_Title,s=!1;switch(e.isFieldReady(F.x.Schema.Category)&&(0,C.w)(e,"DisableEditForm")&&(s=!0),r.push({DisplayName:o,Value:1,Key:"Non-AnonymousButton",DisplayContent:g.createElement("span",{id:"Non-AnonymousButton","aria-hidden":"true"},o)}),r.push({DisplayName:(0,T.pm)().SharePane_CollectResponse_DropDownSharing_Title,Value:2,Key:"SpecificRespond",DisplayContent:g.createElement("span",{id:"SpecificRespond","aria-hidden":"true"},(0,T.pm)().SharePane_CollectResponse_DropDownSharing_Title)}),this.state.CollectResponseOptionValue){case 0:n=(0,T.pm)().SharePane_CollectResponse_DropDownOption1_Title;break;case 1:n=i?(0,T.pm)().SharePane_CollectResponse_DropDownOption2_Title:(0,T.pm)().SharePane_CollectResponse_DropDownOption3_Title;break;case 2:n=(0,T.pm)().SharePane_CollectResponse_DropDownSharing_Title}return g.createElement("div",{className:"flex-pane-option-dropdown-element"},(0,ar.E)({SelectOptions:r,Value:this.state.CollectResponseOptionValue,onValueChange:function(n){if(n!==t.state.CollectResponseOptionValue){switch(n){case 0:2===t.state.CollectResponseOptionValue?t.props.Form.getResponderPersonas().length>0?t.oO=$f((0,T.pm)().ShiftCoauthOptionFromSpecificShareWarning,null,(function(){t.props.Form.removeResponderPermissionLink(),t.NO(),t.setState({ShowConfirmDialog:!1})}),(function(){t.setState({ShowConfirmDialog:!1})}),(function(){t.setState({ShowConfirmDialog:!0})})):(t.props.Form.removeResponderPermissionLink(),t.NO()):t.NO();break;case 1:2===t.state.CollectResponseOptionValue?t.props.Form.getResponderPersonas().length>0?t.oO=$f((0,T.pm)().ShiftCoauthOptionFromSpecificShareWarning,null,(function(){t.props.Form.removeResponderPermissionLink(),t.CO(),t.setState({ShowConfirmDialog:!1})}),(function(){t.setState({ShowConfirmDialog:!1})}),(function(){t.setState({ShowConfirmDialog:!0})})):(t.props.Form.removeResponderPermissionLink(),t.CO()):t.CO();break;case 2:t.IO(),t.props.Form.appendResponderPermissionLink()}}},HTMLAttributes:{"aria-label":n,disabled:s},Label:(0,T.pm)().PeopleToShareWith_SharePane}))},n.prototype.TO=function(){var t=this.props.Form;return g.createElement(g.Fragment,null,g.createElement("span",{id:"AnonymousButton","aria-hidden":!0},(0,T.pm)().SharePane_CollectResponse_DropDownOption1_Title),t.fileUploadAnonymousDisabled()&&(0,V.M)({FluentIcon:"Error Circle",HTMLAttributes:{className:"forms-icon-size16x16 flex-pane-anonymous-warning-icon",onMouseLeave:this.ip,onMouseOver:this.rp,onClick:this.If},key:"warningIcon"}))},n.prototype.aO=function(){if(this.props.Form.fileUploadAnonymousDisabled()){var t=(0,T.pm)().SharePane_CollectResponse_DropDownOption2_Title;return g.createElement("div",{className:"flex-pane-anonymous-tip",ref:this.Eg,id:"flex-pane-anonymous-tooltip"},g.createElement("div",{className:"flex-pane-anonymous-container"},g.createElement("div",{className:"flex-pane-anonymous-tip-text"},(0,T.pm)().UploadFile_Setting_Pane_Sign_In_Tip.format(t)),g.createElement("div",{className:"flex-pane-anonymous-tip-beak"}),g.createElement("div",{className:"flex-pane-anonymous-tip-beak-shadow"})))}},n.prototype.If=function(){$(this.Eg.current).css("display","none")},n.prototype.rp=function(){$(this.Eg.current).css("display","inline-block")},n.prototype.ip=function(){$(this.Eg.current).css("display","none")},n.prototype.hO=function(){var t=this,n=this.state.ShortUrlChecked&&!!this.state.ShortUrl,e={readOnly:!0,"aria-label":n?(0,T.pm)().Short_Link_Collect_Responses:(0,T.pm)().Link_Collect_Responses,value:this.pO(n),className:"flex-pane-textbox",id:"flex-pane-textbox-link",onClick:this.YE,ref:this.WE},i=g.createElement("input",e),r={type:"button",className:"flex-pane-button",id:"flex-pane-button-link",ref:"link_button",onClick:function(){var n=t.state.ShortUrlChecked?{short:!0}:null;(0,q.$U)("DesignPage.Send.CopyLink",n),t.SO("Link")},"data-clipboard-target":"#flex-pane-textbox-link"},o=g.createElement("button",r,(0,T.pm)().Common_Copy_Text);return g.createElement("div",null,i,o,g.createElement(U.L,{HTMLAttributes:{className:"flex-pane-status",id:"flex-pane-status-link"},LazyRendering:!0,Role:"Status"}))},n.prototype.dO=function(){var t=(0,T.pm)().SharePane_Link_ShortUrl_Error;return g.createElement(U.L,{HTMLAttributes:{className:"flex-pane-status flex-pane-status-error"},LazyRendering:!0,Role:"Status"},t)},n.prototype.mO=function(){var t=this,e=this.state.ShortUrlChecked&&!this.state.ShortUrl;return(0,jf.e)({HTMLAttributes:{className:"flex-pane-shorturl-checkbox"},Value:this.state.ShortUrlChecked,Description:(0,T.pm)().SharePane_Link_ShortUrl_Description,Disabled:e,SpanClassName:"flex-pane-shorturl-description",onValueChange:function(e){if(!e)return t.$E=!0,void t.setState({ShortUrlChecked:!1});if((0,q.$U)("DesignPage.Send.ShortLink"),t.state.ShortUrl)t.$E=!0;else{var i=t.props.Form.Model.Id;t.Ot.getOrCreateShortUrl(i,"Response").then((function(e){t.$E=!0,n.shortUrlCache[i]=e,t.setState({ShortUrl:e})})).catch((function(n){(0,q.zU)("DesignPage.GetShortLink.Failure",n),t.setState({ShortUrlChecked:!1,ShortUrlFailed:!0},(function(){return setTimeout((function(){return t.setState({ShortUrlFailed:!1})}),3e3)}))}))}t.setState({ShortUrlChecked:!0})}})},n.prototype.vO=function(){var t,n=this;this.$E=!1;var e=this.state.ShortUrlChecked&&!!this.state.ShortUrl?(0,T.pm)().Short_Link_Collect_Responses:(0,T.pm)().Link_Collect_Responses;return setTimeout((function(){n.YE(),setTimeout((function(){document.getSelection().removeAllRanges()}),1e3)})),g.createElement(U.L,{HTMLAttributes:{className:"screenReaderVisible"},LazyRendering:!0,Role:"Status"},null===(t=(0,T.pm)().Link_Collect_Responses_Type_Short_Switch)||void 0===t?void 0:t.format(e))},n.prototype.YE=function(){var t=this.WE.current;t&&(t.focus(),t.select())},n.prototype.Wu=function(t,n,e,i){var r=Zf(this.props.Form,t,n,e,i);this.qE.push(r)},n.prototype.gO=function(){var t=this.refs.qrcode;t&&(t.download(),this.props.Form.triggerShareAction(),(0,q.$U)("DesignPage.Send.DownloadQRCode"))},n.prototype.bO=function(){var t={id:this.props.Form.Model.Id,embed:!0},n="../Pages/ResponsePage.aspx?"+jQuery.param(t);return'<iframe width="640px" height= "480px" src= "'+(0,_t.WN)(n)+'" frameborder= "0" marginwidth= "0" marginheight= "0" style= "border: none; max-width:100%; max-height:100vh" allowfullscreen webkitallowfullscreen mozallowfullscreen msallowfullscreen> </iframe>'},n.prototype.pO=function(t){if(t&&/^\/(g|r|e)\//.test(this.state.ShortUrl))return(0,_t.WN)(".."+this.state.ShortUrl);var n=t?("USGovGccProd"===(0,ht.kD)()?"../g/":"../r/")+this.state.ShortUrl:"../Pages/ResponsePage.aspx?"+jQuery.param({id:this.props.Form.Model.Id});return(0,_t.WN)(n)},n.prototype.lO=function(){return(0,q.$U)("LazylazyShareToPeople.Start"),g.createElement("div",{className:"share-to-people-container"},g.createElement(Uf,{Disable:!1,onSelectPersonas:this.JE,onClickManagePermission:this.props.OnClickManageAccess,SpecificPeoplePermissions:this.props.Form.getResponderPersonas(),ShareToPeopleType:"WhoCanRespond"}))},n.prototype.JE=function(t){var n=this,e=t.map((function(t){(0,Ci.zv)(new Ci.G4(t.id,t.primaryText,t.secondaryText,t.secondaryText));var e={FormId:n.props.Form.Model.Id,IsOwner:!1,PermissionSet:"DataCreator",PrincipalEmailAddress:t.secondaryText,PrincipalName:t.primaryText,PrincipalId:t.id,SavingState:"Saving",Type:t.optionalText};return(0,q.$U)("DesignPage.Share.AddSpecificResponderPeople",{linkType:t.optionalText}),e}));return new Promise((function(t,i){return n.props.Form.appendSpecificResponderPermissions(e).then(t,i)}))},n.prototype.SO=function(t){if(this.KE.length>0){var n={action:"Share",actionTarget:"Response",contextType:"Form",id:this.props.Form.Model.Id,loggingContent:{type:t},suggestionContent:{suggestions:this.KE}};(0,Rf.H)([n])}},n.shortUrlCache={},n}(J.r),Yf=function(t){function n(n){var e=t.call(this,n)||this;return e.al=y.uniqueId(e.currentViewName()),e.CA="".concat(e.al,"-nagivation-button"),e.IA="".concat(e.al,"-title"),e}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=(0,z.F)({ButtonStyle:1,HTMLAttributes:{"aria-labelledby":(0,N.j)(this.IA,this.CA),autoFocus:!0,className:"flex-pane-second-layer-view-navigation",id:this.CA,onClick:this.onClickBack},FluentIcon:"Arrow Left",IconClassName:"flex-pane-second-layer-back forms-icon-size16x16",Text:(0,T.pm)().Common_Back_Text,TextClassName:"flex-pane-second-layer-view-navigation-text"});return g.createElement("div",{className:"flex-pane-second-layer-view-container","aria-label":this.createViewTitle(),tabIndex:-1},g.createElement("div",{className:"flex-pane-second-layer-view-navigation-container"},t),g.createElement("div",{"aria-level":1,className:"flex-pane-second-layer-view-title",role:"heading"},g.createElement("span",null,this.createViewTitle())),g.createElement("div",{className:"flex-pane-second-layer-view-content"},this.createViewContent()),this.errorHandler())},n.prototype.onClickBack=function(){return this.props.OnViewNavigation()},n.prototype.errorHandler=function(){},n}(J.r),th=e(85179),nh=e(92447),eh=function(t){function n(n){var e=t.call(this,n)||this;return e.aE=(0,T.pm)(),e.state={Loaded:!1,People:e.props.People},e}return(0,p.ZT)(n,t),n.prototype.render=function(){var t,n=this,e=this.state.People,i=e.primaryText||this.aE.Searching,r=e.secondaryText?"".concat(i," (").concat(e.secondaryText,")"):i;t=this.props.IsSpecificRespond?this.props.IsMobile?null:this.aE.CanRespond:this.props.IsOwner?this.aE.Owner:this.state.Loaded&&this.aE.ViewAndEdit;var o="User"===e.optionalText?(0,nh.t)(e.id):(0,th.R)(e.id),s=g.createElement(Ff.H,{DisplayName:r,HideName:!0,Photo:o,PhotoType:0,key:e.id}),a=(this.props.ReadOnly,!this.props.ReadOnly&&this.state.Loaded),u=this.props.ReadOnly&&!this.props.IsMobile?"manage-access-view-content-people-level-readonly":"manage-access-view-content-people-level",c=(a=a||this.props.IsMobile)&&(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"manage-access-view-content-edit",onClick:function(){n.props.onClickRemovePermission(e)}},FluentIcon:"Delete",IconClassName:"forms-icon-size14x20",Text:this.aE.UploadFile_Delete_Uploaded_File_Label.format(i)});return g.createElement("div",{className:"manage-access-view-content-people",key:this.props.People.id,role:"listitem"},g.createElement("span",{"aria-hidden":"true"},s),g.createElement("span",{className:"manage-access-view-content-people-name",title:r},i),g.createElement("span",{className:u},g.createElement("span",{className:"manage-access-view-content-people-permission"},t),c))},n.prototype.componentDidMount=function(){var t=this,n=this.state.People;if(!this.state.People.primaryText){var e=n.optionalText;(0,Ci.Kw)(e,n.id).then((function(e){n.primaryText=e.DisplayName,n.secondaryText=e.UserPrincipalName||e.Mail,t.setState({Loaded:!0,People:n})})).catch((function(i){var r;404===(null===(r=null==i?void 0:i.response)||void 0===r?void 0:r.statusCode)?("User"===e?(n.primaryText=t.aE.Common_UnknownUser_Text,n.secondaryText=t.aE.UserNotExist):(n.primaryText=t.aE.Common_UnknownGroup_Text,n.secondaryText=t.aE.GroupNotExist),t.setState({Loaded:!0,People:n})):t.setState({Loaded:!0})}))}},n}(J.r),ih=function(t){function n(n){var e=t.call(this,n)||this;if(e.kO=g.createRef(),e.aE=(0,T.pm)(),e.FO=!e.props.Form.isCurrentUserFormOwnerOrGroupMember(),e.onClickBack=e.onClickBack.bind(e),e.PO=e.PO.bind(e),e.createViewTitle=e.createViewTitle.bind(e),"WhoCanRespond"===e.props.ManageRespondSharing)e.state={SelectedPeopleList:e.props.Form.getResponderPersonas(),RemovedUserName:"",IsClick:!0};else{var i=e.props.Form.getUserOrGroupPermissions(),r=y.map(i,(function(t){return{id:t.PrincipalId,optionalText:t.Type,primaryText:t.PrincipalName,secondaryText:t.PrincipalEmailAddress}}));e.state={SelectedPeopleList:r,RemovedUserName:"",IsClick:!0}}return e}return(0,p.ZT)(n,t),n.prototype.createViewTitle=function(){return"WhoCanRespond"===this.props.ManageRespondSharing?this.aE.ManageWhoCanRespond:this.aE.ManageTheAccess},n.prototype.createViewContent=function(){var t=this,n=this.state.SelectedPeopleList,e=y.find(n,(function(n){return n.id===t.props.Form.Model.OwnerId})),i=[e?this.DO(!0,e):null];n.forEach((function(n){n.id!==t.props.Form.Model.OwnerId&&i.push(t.DO(!1,n))}));var r=this.state.RemovedUserName,o=r?g.createElement(U.L,{HTMLAttributes:{className:"manage-access-delete-live-region",tabIndex:-1},LazyRendering:!0,Role:"Status"},r):null;return g.createElement("div",{className:"manage-access-view-content-peopleList",role:"list",ref:this.kO},o,i)},n.prototype.currentViewName=function(){return"WhoCanRespond"===this.props.ManageRespondSharing?"ManageResponderView":"ManageAccessView"},n.prototype.onClickBack=function(){this.props.OnViewNavigation()},n.prototype.DO=function(t,n){return g.createElement(eh,{IsOwner:t,key:n.id,onClickRemovePermission:this.PO,People:n,ReadOnly:t&&"WhoCanRespond"!==this.props.ManageRespondSharing||this.FO,IsSpecificRespond:"WhoCanRespond"===this.props.ManageRespondSharing})},n.prototype.PO=function(t){var n=this;if(this.state.IsClick){this.setState({IsClick:!1});var e=void 0,i=void 0,r=void 0,o=this.state.SelectedPeopleList.indexOf(t);"WhoCanRespond"===this.props.ManageRespondSharing?(i=y.find(this.props.Form.Model.ResponderPermissions,(function(n){return n.PrincipalId===t.id})),r=t.primaryText?this.aE.User_Removed_From_ManageWhoCanRespond_CanReadName.format(t.primaryText):this.aE.User_Removed_From_ManageWhoCanRespond):(e=y.find(this.props.Form.Model.Permissions,(function(n){return n.PrincipalId===t.id})),r=t.primaryText?this.aE.User_Removed_From_ManageAccess_CanReadName.format(t.primaryText):this.aE.User_Removed_From_ManageAccess);var s=y.without(this.state.SelectedPeopleList,t),a=y.find(s,(function(n){return n.id===t.id}))?"":r;"WhoCanRespond"===this.props.ManageRespondSharing?this.props.Form.removeResponderPermissions([i]).then((function(){n.setState({SelectedPeopleList:s,RemovedUserName:a,IsClick:!0}),n.MO(o)})).then((function(){setTimeout((function(){n.setState({RemovedUserName:""})}),2e3)})):this.props.Form.removePermissions([e]).then((function(){n.setState({SelectedPeopleList:s,RemovedUserName:a,IsClick:!0}),n.MO(o-1)})).then((function(){setTimeout((function(){n.setState({RemovedUserName:""})}),2e3)}))}},n.prototype.MO=function(t){var n=$(this.kO.current).find(".manage-access-view-content-edit:eq(".concat(t,")"));0!==n.length?n.focus():(0,kr.Vh)(b.findDOMNode(this))},n}(Yf);var rh=function(t){function n(n){var e=t.call(this,n)||this;return e.LO=function(){return e.ts(0)},e.RO=function(){return e.ts(2)},e.state={CurrentView:0},e}return(0,p.ZT)(n,t),n.prototype.render=function(){return g.createElement("div",{className:"flex-pane-share-pane"},this.EO(),this.OO(),this._O())},n.prototype.EO=function(){return 0!==this.state.CurrentView?null:g.createElement("div",null,g.createElement(Xf,{Form:this.props.Form,OnClickManageAccess:this.RO}))},n.prototype.OO=function(){return 1!==this.state.CurrentView?null:g.createElement(ih,{Form:this.props.Form,OnViewNavigation:this.LO,ManageRespondSharing:"WhoCanAccess"})},n.prototype._O=function(){return 2!==this.state.CurrentView?null:g.createElement(ih,{Form:this.props.Form,OnViewNavigation:this.LO,ManageRespondSharing:"WhoCanRespond"})},n.prototype.ts=function(t){this.setState({CurrentView:t})},n}(J.r),oh=e(355);var sh=function(t){function n(n){var e=t.call(this,n)||this;return e.Ic=g.createRef(),e.BO=e.BO.bind(e),e.Pc=e.Pc.bind(e),e.HO=e.HO.bind(e),e.qO=e.qO.bind(e),e.state={ShowTooltip:!1},e}return(0,p.ZT)(n,t),n.prototype.componentDidUpdate=function(){var t=this.Ic.current;if(this.state.ShowTooltip&&t){var n=t.getBoundingClientRect(),e=this.getHtmlElement(),i=e.getBoundingClientRect();n.right>window.innerWidth&&(t.style.left="auto",t.style.right="".concat(i.right-window.innerWidth,"px")),n.bottom>window.innerHeight&&(t.style.bottom="".concat(e.clientHeight,"px"))}},n.prototype.render=function(){var t,n=this;t=this.state.ShowTooltip?"button-tooltip":"screenReaderReference";var e=(0,V.M)({HTMLAttributes:{className:"forms-icon-size16x16"},FluentIcon:this.props.FluentIcon||"Info"}),i=(0,T.pm)(),r="".concat(this.props.DisableMoreInfo?"":i.Message_More_Info).concat(this.props.ButtonLabel);return g.createElement("button",{className:"info-button","aria-expanded":this.state.ShowTooltip,"aria-label":r,onKeyUp:this.BO,onClick:function(){return n.Pc(n.state.ShowTooltip)},onKeyDown:this.HO,onBlur:this.qO},g.createElement("div",{className:"button-content"},e),g.createElement("div",{className:t,ref:this.Ic,"aria-label":this.state.ShowTooltip?this.props.ToolTipLabel:null,"aria-live":"polite",role:"status"},g.createElement("span",null,this.props.ToolTipLabel)))},n.prototype.qO=function(t){t.stopPropagation(),this.setState({ShowTooltip:!1})},n.prototype.BO=function(t){switch(t.keyCode){case 27:this.state.ShowTooltip&&(t.stopPropagation(),this.setState({ShowTooltip:!1}));break;case 32:case 13:t.stopPropagation(),this.setState({ShowTooltip:!this.state.ShowTooltip})}},n.prototype.HO=function(t){switch(t.keyCode){case 32:case 13:t.preventDefault(),t.stopPropagation()}},n.prototype.Pc=function(t){this.setState({ShowTooltip:!t})},n}(J.r),ah=function(t){function n(n){var e=t.call(this,n)||this;return e.state={DataClassificationValue:"General",LabelsLoaded:!1},e.oC=e.oC.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this;(0,xa.I)().then((function(n){t.Om=(0,tt.d)(n),t.setState({LabelsLoaded:!0})}))},n.prototype.render=function(){var t=(0,T.pm)().DesignPage_SettingsPane_DataClassification_Description,n=g.createElement(sh,{ButtonLabel:(0,T.pm)().DesignPage_SettingsPane_DataClassification_Title,ToolTipLabel:t});if(!this.props.EnterDataClassificationSettingPane){var e=(0,T.pm)().DesignPage_SettingsPane_DataClassification_External_Title.format(null===this.props.FormMaster.Model.DataClassificationLabel?this.VO():this.props.FormMaster.Model.DataClassificationLabel);return g.createElement("div",{className:"setting-pane-data-classification"},g.createElement("span",{id:"data-classification-label"},e),g.createElement(Fr.A,{HTMLAttributes:{"aria-label":(0,T.pm)().DesignPage_SettingsPane_DataClassification_Edit,"aria-describedby":"data-classification-label",className:"__data-classification-edit__ setting-pane-data-classification-link",onClick:this.props.EditDataClassificationSettingCallBack.bind(this,!0)},Text:(0,T.pm)().Common_Edit_Text}),g.createElement("div",{className:"setting-select-tooltip"},n))}var i=(0,z.F)({ButtonStyle:1,HTMLAttributes:{autoFocus:!0,className:"setting-pane-navigation",onClick:this.props.EditDataClassificationSettingCallBack.bind(this,!1)},FluentIcon:"Arrow Left",IconClassName:"paneBack forms-icon-size16x16",Text:(0,T.pm)().Common_Back_Text,TextClassName:"setting-pane-navigation-text"});return g.createElement("div",{className:"setting-pane-data-classification-container"},g.createElement("div",{className:"setting-pane-navigation-container"},i),g.createElement("div",{className:"flex-pane-content"},g.createElement("div",{className:"setting-pane-group setting-pane-group-label"},g.createElement("div",{className:"setting-select-title"},(0,T.pm)().DesignPage_SettingsPane_DataClassification_Title,g.createElement("div",{className:"setting-select-tooltip"},n)),g.createElement("div",{className:"setting-pane-select"},this.zO()))))},n.prototype.zO=function(){if(!this.state.LabelsLoaded)return g.createElement("div",{className:"setting-pane-placerholder"},g.createElement("div",{className:"simple-data-control-loading-spinner-animation"}));var t=this.Om.map((function(t){return{DisplayContent:g.createElement("span",{title:t.description,"aria-label":"".concat(t.level," ").concat(t.description)},t.level),DisplayName:t.level,Key:t.level,Value:t.level}})),n=this.props.FormMaster.Model.DataClassificationLabel,e=(0,ar.E)({Label:null,HTMLAttributes:{"aria-label":(0,T.pm)().DesignPage_SettingsPane_DataClassification_Selector},onValueChange:this.oC,SelectOptions:t,Value:null===n?this.VO():n});return g.createElement("div",{"aria-label":n,className:"__data-classification-select__ setting-pane-option-dropdown-element"},e)},n.prototype.oC=function(t){var n=this.props.FormMaster;this.setState({DataClassificationValue:t}),n.Model.DataClassificationLabel=t,(0,q.$U)("DesignPage.Setting.DataClassificationLabel")},n.prototype.VO=function(){if(this.Om)for(var t=0,n=this.Om;t<n.length;t++){var e=n[t];if(e.isDefaultLabel)return e.level}return""},n}(J.r);var uh=function(t){function n(n){var e=t.call(this,n)||this;e.Gu=(0,k.f5)().Model;var i=e.tO();return e.state={ShowRespondDetailSettings:i},e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this,n=this.props.Form;this.As=function(){return t.forceUpdate()},n.SettingMaster.observe(this.As)},n.prototype.componentWillUnmount=function(){var t=this.props.Form;t.unobserve(this.As),t.SettingMaster.unobserve(this.As)},n.prototype.render=function(){var t=y.uniqueId("rstitle_"),n=g.createElement("div",{className:"setting-group-title",id:t},(0,T.pm)().DesignPage_SettingsPane_Share_Title),e=this.state.ShowConfirmDialog?g.createElement(zf,(0,p.pi)({},this.oO)):g.createElement("div",null,n,this.QO("ResponseSetting",1,3),this.jO("ResponseSetting",2,3),this.WO("ResponseSetting",3,3));return g.createElement("div",{className:"flex-pane-content"},g.createElement("div",{className:"setting-pane-group",role:"radiogroup","aria-labelledby":t},e))},n.prototype.KO=function(){},n.prototype.JO=function(){},n.prototype.ZO=function(){var t=this.props.Form.SettingMaster,n=t.Model;(0,q.$U)("DesignPage.Setting.ChangeResponseCollectionType",{Value:"IsAnonymous"}),t.bulkEdit((function(){n.IsAnonymous=!0,n.NotRecordIdentity=!0,n.RequiresUniqueResponse=!1})),this.setState({ShowRespondDetailSettings:0})},n.prototype.QO=function(t,n,e){var i=this,r=this.props.Form,o=r.SettingMaster.Model;return this.XO({Description:(0,T.pm)().SharePane_CollectResponse_DropDownOption1_Title,InnerHelpText:(0,T.pm)().DesignPage_SettingsPane_Share_Public_Help,Options:{HTMLPropsForInnerElement:{name:t,"aria-posinset":n,"aria-setsize":e}},RadioCheckbox:!0,Value:(0,et.pd)((function(){return o.IsAnonymous}),et.t1),onValueChange:function(){0!==i.state.ShowRespondDetailSettings&&(2===i.state.ShowRespondDetailSettings?i.props.Form.getResponderPersonas().length>0?i.oO=$f((0,T.pm)().ShiftCoauthOptionFromSpecificShareWarning,null,(function(){i.ZO(),i.props.Form.removeResponderPermissionLink(),i.setState({ShowConfirmDialog:!1})}),(function(){i.setState({ShowConfirmDialog:!1})}),(function(){i.setState({ShowConfirmDialog:!0})})):(i.ZO(),i.props.Form.removeResponderPermissionLink()):i.ZO())},Id:"AnonymousButton",Disabled:!this.Gu.FormsTenantSettings.externalSendForm||this.props.Form.IsAssignmentForm||r.fileUploadAnonymousDisabled(),children:r.fileUploadAnonymousDisabled()&&this.YO()})},n.prototype.YO=function(){var t=(0,T.pm)().SharePane_CollectResponse_DropDownOption2_Title;return g.createElement("div",{className:"flex-pane-info-container"},g.createElement(sh,{ButtonLabel:(0,T.pm)().SharePane_CollectResponse_DropDownOption1_Title,ToolTipLabel:(0,T.pm)().UploadFile_Setting_Pane_Sign_In_Tip.format(t)}))},n.prototype.t_=function(){var t,n=this.props.Form.SettingMaster.Model;null!=n.NotRecordIdentity||n.IsAnonymous||(n.NotRecordIdentity=!1);var e=!1===(null===(t=this.Gu.FormsTenantSettings)||void 0===t?void 0:t.allowRecordIdentity);return e&&(n.NotRecordIdentity=!0),this.XO({Disabled:this.props.Form.IsAssignmentForm||n.IsAnonymous||e,Description:(0,T.pm)().DesignPage_SettingsPane_Share_RecordIdentityOfQuizVNext,Id:"RecordNamesOfResponders",Value:!n.NotRecordIdentity,onValueChange:function(t){(0,q.$U)("DesignPage.Setting.RecrodIdentity"),n.NotRecordIdentity=!t}})},n.prototype.n_=function(){var t=this.props.Form.SettingMaster.Model,n=this.props.Form.IsAssignmentForm||t.IsAnonymous;return this.props.Form.IsAssignmentForm&&!t.IsAnonymous&&(t.RequiresUniqueResponse=!0),this.XO({Disabled:n,Description:(0,T.pm)().DesignPage_SettingsPane_Share_OneResponse,Id:"SingleReponsePerPerson",Value:t.RequiresUniqueResponse,onValueChange:function(n){(0,q.$U)("DesignPage.Setting.RequireUniqueResponse"),t.RequiresUniqueResponse=n}})},n.prototype.CO=function(){var t=this.props.Form.SettingMaster,n=t.Model;(0,q.$U)("DesignPage.Setting.ChangeResponseCollectionType",{Value:"InOrg"}),0===this.state.ShowRespondDetailSettings&&t.bulkEdit((function(){n.IsAnonymous=!1,n.NotRecordIdentity=!1})),this.setState({ShowRespondDetailSettings:1})},n.prototype.jO=function(t,n,e){var i=this,r=(0,T.pm)().SharePane_CollectResponse_DropDownOption2_Title;return this.XO({Disabled:this.props.Form.IsAssignmentForm,Description:r,Id:"Non-AnonymousButton-Setting",Options:{HTMLPropsForInnerElement:{name:t,"aria-posinset":n,"aria-setsize":e}},RadioCheckbox:!0,Value:1===this.state.ShowRespondDetailSettings,onValueChange:function(){1!==i.state.ShowRespondDetailSettings&&(2===i.state.ShowRespondDetailSettings?i.props.Form.getResponderPersonas().length>0?i.oO=$f((0,T.pm)().ShiftCoauthOptionFromSpecificShareWarning,null,(function(){i.CO(),i.props.Form.removeResponderPermissionLink(),i.setState({ShowConfirmDialog:!1})}),(function(){i.setState({ShowConfirmDialog:!1})}),(function(){i.setState({ShowConfirmDialog:!0})})):(i.CO(),i.props.Form.removeResponderPermissionLink()):i.CO())},children:1===this.state.ShowRespondDetailSettings?g.createElement("div",{"aria-label":r},this.t_(),this.n_()):null})},n.prototype.e_=function(){var t=this.props.Form.SettingMaster,n=t.Model;(0,q.$U)("DesignPage.Setting.ChangeResponseCollectionType",{Value:"SpecificRespond"}),0===this.state.ShowRespondDetailSettings&&t.bulkEdit((function(){n.IsAnonymous=!1,n.NotRecordIdentity=!1})),this.setState({ShowRespondDetailSettings:2})},n.prototype.WO=function(t,n,e){var i=this,r=(0,T.pm)().SharePane_CollectResponse_DropDownSharing_Title;return this.XO({Disabled:this.props.Form.IsAssignmentForm,Description:r,Id:"SpecificRespond-Setting",Options:{HTMLPropsForInnerElement:{name:t,"aria-posinset":n,"aria-setsize":e}},RadioCheckbox:!0,Value:2===this.state.ShowRespondDetailSettings,onValueChange:function(){2!==i.state.ShowRespondDetailSettings&&(i.e_(),i.props.Form.appendResponderPermissionLink())},children:2===this.state.ShowRespondDetailSettings?g.createElement("div",{"aria-label":r},this.t_(),this.n_()):null})},n.prototype.XO=function(t){t.HTMLAttributes=t.HTMLAttributes||{},t.HTMLAttributes.className=t.HTMLAttributes.className||"setting-pane-checkbox",t.Options=t.Options||{classNameForInnerDiv:"flex-pane-checkbox-info",classNameForInnerLabel:"flex-pane-checkbox-label settings-display-inline"};var n=this.props.Form;return(0,C.w)(n,"DisableEditForm")&&(t.Disabled=!0),(0,jf.e)(t)},n.prototype.i_=function(t){},n.prototype.r_=function(t){0},n.prototype.tO=function(){return this.props.Form.getResponseCollectionType()},n}(J.r),ch=e(9097);var lh=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){var t={Label:this.props.Title,HTMLAttributes:{className:"setting-pane-toggle-item-title"},Options:{classNameForInnerDiv:"setting-pane-toggle-button"},Value:this.props.Value,onValueChange:this.props.onChange};return g.createElement("div",{className:"setting-pane-toggle-group"},(0,ch.i)(t),this.o_())},n.prototype.o_=function(){if(null!=this.props.Description)return g.createElement("div",{className:"setting-pane-toggle-item-notification","aria-live":"polite",role:"status"},this.props.Description)},n}(J.r);var fh,hh=function(t){function n(n){var e=t.call(this,n)||this;e.Gu=(0,k.f5)().Model;var i,r,o=e.props.Form.SettingMaster.Model,s=(0,X.bU)();if(o.LockGivenQuestionsStartDisplayOrder&&o.LockGivenQuestionsEndDisplayOrder)i=o.LockGivenQuestionsStartDisplayOrder.toString(),r=o.LockGivenQuestionsEndDisplayOrder.toString();else{var a=e.props.Form;i=s.toString(),o.LockGivenQuestionsStartDisplayOrder=s;var u=a.FormElementManager.TopQuestionMasters.length;r=u.toString(),o.LockGivenQuestionsEndDisplayOrder=u}return e.state={EndRange:r,ShowShuffleQuestionRangeError:!1,ShowThresholdResponseRangeError:!1,ShowThresholdExpiryDaysRangeError:!1,StartRange:i,ShowDataClassificationSettingPane:!1},e.s_=function(t){return e.a_(t)},e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this,n=this.props.Form;this.As=function(){return t.forceUpdate()},n.SettingMaster.observe(this.As),n.observe(this.As,[F.x.Schema.HasValidBranching,F.x.Schema.QuizQuestionsCount,F.x.Schema.ThankYouMessage,F.x.Schema.EmailReceiptEnabled,F.x.Schema.ProgressBarEnabled])},n.prototype.componentWillUnmount=function(){var t=this.props.Form;t.unobserve(this.As),t.SettingMaster.unobserve(this.As)},n.prototype.componentDidUpdate=function(t,n){if(n.ShowDataClassificationSettingPane&&!this.state.ShowDataClassificationSettingPane){var e=$(".setting-pane-data-classification-link");e&&(0,Co.x)(e)}},n.prototype.render=function(){var t=this,n=this.props,e=n.Form.Model.OwnerTenantId===(0,c.k0)().userInfo.TenantId;if(((0,S.Wh)()||!(0,ht.yv)())&&this.state.ShowDataClassificationSettingPane&&!(0,c.k0)().userInfo.IsMsa&&e)return g.createElement("div",{id:"flex-pane-settings-pane-data-classification"},g.createElement(ah,{FormMaster:n.Form,EnterDataClassificationSettingPane:!0,EditDataClassificationSettingCallBack:this.s_}));var i=!(0,c.k0)().userInfo.IsMsa?function(t){return g.createElement(uh,t)}({Form:n.Form}):void 0,r=((0,et.pd)((function(){return null}),et.t1),(0,T.pm)().DesignPage_SettingsPane_NotificationV2),o=this.u_()&&g.createElement("div",{"aria-labelledby":r,className:"setting-pane-group",role:"group"},g.createElement("div",{className:"setting-group-title",id:"SettingsPane-Notification"},r),this.c_(),this.f_()),s=(0,et.pd)((function(){return g.createElement("div",{className:"flex-pane-content"},g.createElement("div",{"aria-labelledby":"SettingsPane-Options",className:"setting-pane-group",role:"group"},g.createElement("div",{className:"setting-group-title",id:"SettingsPane-Options"},(0,T.pm)().DesignPage_SettingsPane_Response_Title),t.d_(),t.m_(),t.v_(),t.g_(),t.p_(),!t.u_()&&t.f_(),t.y_(),t.S_(),n.Form.SettingMaster.Model.IsQuizMode?t.N_():void 0),o)}),et.t1),a=n.Form.SettingMaster.Model.IsQuizMode?g.createElement("div",{className:"flex-pane-content"},g.createElement("div",{className:"setting-pane-group"},g.createElement("div",{className:"setting-group-title"},(0,T.pm)().DesignPage_SettingsPane_GradingSetting),this.I_())):void 0,u=!(0,S.Wh)()&&(0,ht.yv)()||(0,c.k0)().userInfo.IsMsa||!e?void 0:g.createElement(ah,{FormMaster:n.Form,EnterDataClassificationSettingPane:!1,EditDataClassificationSettingCallBack:this.s_});return g.createElement("div",{id:"flex-pane-settings-pane"},g.createElement("div",{className:"setting-page-title",role:"heading","aria-level":"1"},(0,T.pm)().DesignPage_SettingsPane_SettingLabel),a,i,s,!1,u)},n.prototype.u_=function(){return!(0,ht.x8)()&&!(0,c.k0)().userInfo.IsMsa},n.prototype.I_=function(){var t,n=this.props.Form;if(n.SettingMaster.Model.IsQuizMode){var e=(0,T.pm)().DesignPage_SettingsPane_AutoGradingControlTitle,i=n.SettingMaster.Model.ManualGradingEnabled?(0,T.pm)().DesignPage_SettingsPane_OpenManualGrading:(0,T.pm)().DesignPage_SettingsPane_OpenAutoGrading;return t={Title:e,Description:i,Value:!n.SettingMaster.Model.ManualGradingEnabled,onChange:function(t){(0,q.$U)("DesignPage.Setting.AutoReleaseGrade"),n.SettingMaster.Model.ManualGradingEnabled=!t,n.SettingMaster.Model.ShowGradedResults=t}.bind(this)},g.createElement(lh,(0,p.pi)({},t))}return null},n.prototype.d_=function(){var t=this.props.Form.SettingMaster,n=t.Model;return this.XO({Description:(0,T.pm)().DesignPage_SettingsPane_AcceptResponse,Value:!n.FormClosed,onValueChange:function(t){(0,q.$U)("DesignPage.Setting.AcceptResponse"),n.FormClosed=!t},children:[n.FormClosed?g.createElement("div",{className:"flex-pane-inner-text"},(0,V.M)({FluentIcon:"Warning Filled",HTMLAttributes:{className:"flex-pane-alert-icon"}}),g.createElement("span",{className:"flex-pane-alert-text",role:"alert","aria-label":(0,T.pm)().DesignPage_SettingsPane_FormClosed_Warning},(0,T.pm)().DesignPage_SettingsPane_FormClosed_Warning)):void 0,n.FormClosed?(0,ur.ZA)({Label:(0,T.pm)().DesignPage_SettingsPane_FormClosed_Label,Options:{HTMLPropsForInnerElement:{className:"flex-pane-inner-text"}},TextFieldType:2,MinimalHeight:100,HTMLAttributes:{className:"form-setting-inner-board","aria-label":(0,T.pm)().DesignPage_SettingsPane_FormClosed_Label,onBlur:function(){n.FormClosedMessageChanged&&((0,q.$U)("DesignPage.Setting.EditCloseMessage"),n.FormClosedMessageChanged=!1)}},Value:t.getFormClosedMessage(),onValueChange:function(t){n.FormClosedMessage=t,n.FormClosedMessageChanged=!0}}):void 0]})},n.prototype.m_=function(){var t=this.props.Form.SettingMaster,n=t.Model;return this.XO({Description:(0,T.pm)().DesignPage_SettingsPane_StartTime,Disabled:n.FormClosed||this.props.Form.IsAssignmentForm,Value:n.TimerEnabledStart,onValueChange:function(e){(0,q.$U)("DesignPage.Setting.ApplyStartTime"),t.bulkEdit((function(){if(e){var t=new Date(Date.now());t.setHours(t.getHours()+1,0,0,0),n.StartTime=t.toJSON()}else n.StartTime=void 0;n.TimerEnabledStart=e,n.TimerEnabled=!(!n.TimerEnabledStart&&!n.TimerEnabledEnd)}))},children:[!n.FormClosed&&n.TimerEnabledStart?g.createElement("div",{},(0,oh.xU)({Disabled:n.FormClosed||this.props.Form.IsAssignmentForm,InSettingPane:!0,Options:{classNameForInnerDiv:"form-setting-inner-board"},Value:n.StartTime,onValueChange:function(t){if((0,q.$U)("DesignPage.Setting.SetStartTime"),n.TimerEnabledEnd&&t>=n.EndTime){var e=new Date(t);e.setMinutes(e.getMinutes()+15,0,0),n.EndTime=e.toJSON()}n.StartTime=t,$("#flex-pane-status-start-date").hide(),$("#flex-pane-status-start-time").hide()},onValueValidation:function(t,n){switch(n){case 1:$(t?"#flex-pane-status-start-date":"#flex-pane-status-start-time").show();break;case 2:$("#flex-pane-status-start-invalidrange").show();break;default:$("#flex-pane-status-start-date").hide(),$("#flex-pane-status-start-time").hide(),$("#flex-pane-status-start-invalidrange").hide()}},children:[g.createElement("div",{className:"flex-pane-status flex-pane-status-error",id:"flex-pane-status-start-date",style:{display:"none"}},(0,T.pm)().DateValidation_ErrorMessage.format((0,c.k0)().cultureInfo.DateTimeFormat.ShortDatePattern)),g.createElement("div",{className:"flex-pane-status flex-pane-status-error",id:"flex-pane-status-start-time",style:{display:"none"}},(0,T.pm)().TimeValidation_ErrorMessage.format((0,c.k0)().cultureInfo.DateTimeFormat.ShortTimePattern)),g.createElement("div",{className:"flex-pane-status flex-pane-status-error",id:"flex-pane-status-start-invalidrange",style:{display:"none"}},(0,T.pm)().DateRangeValidation_ErrorMessage)],DateTitle:(0,T.pm)().DesignPage_SettingsPane_DatePicker_StartDateTitle,TimeTitle:(0,T.pm)().DesignPage_SettingsPane_DatePicker_StartTimeTitle})):void 0]})},n.prototype.v_=function(){var t=this.props.Form.SettingMaster,n=t.Model;return null==n.TimerEnabledStart&&null==n.TimerEnabledEnd&&(n.TimerEnabledEnd=n.TimerEnabled),this.XO({Description:(0,T.pm)().DesignPage_SettingsPane_Deadline,Disabled:n.FormClosed||this.props.Form.IsAssignmentForm,Value:n.TimerEnabledEnd,onValueChange:function(e){(0,q.$U)("DesignPage.Setting.ApplyDeadline"),t.bulkEdit((function(){if(e){var t=void 0;if(n.TimerEnabledStart)(t=new Date(n.StartTime)).setMinutes(new Date(n.StartTime).getMinutes()+15,0,0),n.EndTime=t.toJSON();else{var i=new Date(Date.now());i.setHours(i.getHours(),0,0,0),n.StartTime=i.toJSON(),(t=new Date(Date.now())).setDate(t.getDate()),t.setHours(t.getHours()+1,0,0,0),n.EndTime=t.toJSON()}}else n.EndTime=void 0;n.TimerEnabledEnd=e,n.TimerEnabled=n.TimerEnabledStart||n.TimerEnabledEnd}))},children:[!n.FormClosed&&n.TimerEnabledEnd?g.createElement("div",{},(0,oh.xU)({AllowedDateTime:{Start:n.StartTime?new Date(n.StartTime):new Date(Date.now())},Disabled:n.FormClosed||this.props.Form.IsAssignmentForm,InSettingPane:!0,Options:{classNameForInnerDiv:"form-setting-inner-board"},Value:n.EndTime,onValueChange:function(t){if((0,q.$U)("DesignPage.Setting.SetDeadline"),!n.StartTime||t>n.StartTime)n.EndTime=t;else if(n.StartTime&&t<=n.StartTime){var e=new Date(n.StartTime);e.setMinutes(e.getMinutes()+15,0,0),n.EndTime=e.toJSON()}$("#flex-pane-status-end-date").hide(),$("#flex-pane-status-end-time").hide()},onValueValidation:function(t,n){switch(n){case 1:$(t?"#flex-pane-status-end-date":"#flex-pane-status-end-time").show();break;case 2:$("#flex-pane-status-end-invalidrange").show();break;default:$("#flex-pane-status-end-date").hide(),$("#flex-pane-status-end-time").hide(),$("#flex-pane-status-end-invalidrange").hide()}},children:[g.createElement("div",{className:"flex-pane-status flex-pane-status-error",id:"flex-pane-status-end-date",style:{display:"none"}},(0,T.pm)().DateValidation_ErrorMessage.format((0,c.k0)().cultureInfo.DateTimeFormat.ShortDatePattern)),g.createElement("div",{className:"flex-pane-status flex-pane-status-error",id:"flex-pane-status-end-time",style:{display:"none"}},(0,T.pm)().TimeValidation_ErrorMessage.format((0,c.k0)().cultureInfo.DateTimeFormat.ShortTimePattern)),g.createElement("div",{className:"flex-pane-status flex-pane-status-error",id:"flex-pane-status-end-invalidrange",style:{display:"none"}},(0,T.pm)().DateRangeValidation_ErrorMessage)],DateTitle:(0,T.pm)().DesignPage_SettingsPane_DatePicker_EndDateTitle,TimeTitle:(0,T.pm)().DesignPage_SettingsPane_DatePicker_EndTimeTitle})):void 0]})},n.prototype.p_=function(){var t=this.props.Form,n=t.SettingMaster.Model,e=(0,T.pm)().DesignPage_SettingsPane_ShuffleQuestion;return this.XO({Description:e,Value:this.T_(),Disabled:t.Model.HasValidBranching||t.hasSection(),onValueChange:function(e){(0,q.$U)("DesignPage.Setting.ShuffleQuestion"),t.SettingMaster.bulkEdit((function(){n.ShuffleQuestionOrder=e,e&&null==n.ShuffleAllQuestions&&(n.ShuffleAllQuestions=!0)}))},children:g.createElement("div",{"aria-label":this.T_()?e:void 0},this.k_("SettingsPane-ShuffleQuestion",1,2),this.F_("SettingsPane-ShuffleQuestion",2,2),this.D_())})},n.prototype.M_=function(){var t=this.props.Form,n=t.SettingMaster.Model,e=(0,T.pm)().DesignPage_SettingsPane_ShowQuestionNumbers;return this.XO({Description:e,Value:null==n.ShowQuestionNumbers||n.ShowQuestionNumbers,onValueChange:function(e){(0,q.$U)("DesignPage.Setting.ShowQuestionNumbers"),t.SettingMaster.bulkEdit((function(){n.ShowQuestionNumbers=e,e&&null==n.ShowQuestionNumbers&&(n.ShowQuestionNumbers=!0)}))}})},n.prototype.g_=function(){var t=this.props.Form;if((0,C.w)(t,"Settings.AllowResponderGetAllResponses")){var n=t.SettingMaster.Model;return this.XO({Description:"Allow responder get all responses",Value:n.AllowResponderGetAllResponses,onValueChange:function(t){n.AllowResponderGetAllResponses=t}})}},n.prototype.k_=function(t,n,e){var i=this.props.Form,r=i.SettingMaster.Model;if(this.T_())return this.XO({Description:(0,T.pm)().DesignPage_SettingsPane_ShuffleAllQuestions,Options:{HTMLPropsForInnerElement:{name:t,"aria-posinset":n,"aria-setsize":e}},RadioCheckbox:!0,Value:r.ShuffleAllQuestions,Disabled:i.Model.HasValidBranching,onValueChange:function(t){(0,q.$U)("DesignPage.Setting.ShuffleAllQuestions"),r.ShuffleAllQuestions=t}})},n.prototype.f_=function(){if(!(0,ht.x8)()){var t=this.props.Form.SettingMaster.Model,n=this.u_()?(0,T.pm)().DesignPage_SettingsPane_Notification_EmailNotification:(0,T.pm)().DesignPage_SettingsPane_EmailNotification;return this.XO({Description:n,Value:t.EmailNotification,onValueChange:function(n){(0,q.$U)("DesignPage.Setting.EmailNotification"),t.EmailNotification=n}})}},n.prototype.L_=function(){},n.prototype.R_=function(t,n){},n.prototype.c_=function(){if(this.u_()){var t=this.props.Form.Model;return this.XO({HelpText:(0,T.pm)().DesignPage_SettingsPane_EmailReceiptV2_Tooltip,Disabled:!1,Description:(0,T.pm)().DesignPage_SettingsPane_AllowPrint,Value:t.EmailReceiptEnabled,onValueChange:function(n){(0,q.$U)("DesignPage.Setting.EmailReceipt"),t.EmailReceiptEnabled=n}})}},n.prototype.S_=function(){var t=this.props.Form.Model;return this.XO({Description:(0,T.pm)().DesignPage_SettingsPane_CustomizeThankYou,Options:{classNameForInnerDiv:"flex-pane-checkbox-info flex-pane-checkbox-thank-you-message",classNameForInnerLabel:"flex-pane-checkbox-label"},Value:null!=t.ThankYouMessage,onValueChange:function(n){t.ThankYouMessage=n?(0,T.pm)().Renderer_SubmissionSucceeded:null},children:[null!=t.ThankYouMessage&&(0,ur.aQ)({AllowRichText:!0,AutoSelection:!0,Options:{HTMLPropsForInnerElement:{className:"flex-pane-inner-text","aria-label":(0,T.pm)().DesignPage_SettingsPane_CustomizeThankYou}},Placeholder:(0,T.pm)().DesignPage_SettingsPane_ThankYouMessage_Placeholder,TextFieldType:2,TextFieldLocation:{Location:13},MinimalHeight:80,MaxLength:(0,X.hN)(),HTMLAttributes:{className:"form-setting-inner-board",onBlur:function(){null!=t.ThankYouMessage&&(0,q.$U)("DesignPage.Setting.ThankYouMessage",{length:t.ThankYouMessage.length})}},Value:t.ThankYouMessage,onValueChange:function(n){t.ThankYouMessage=(0,ir.gA)(n)||n||""}},!0)]})},n.prototype.A_=function(t){},n.prototype.F_=function(t,n,e){var i=this.props.Form,r=i.SettingMaster.Model;if(this.T_())return this.XO({Description:(0,T.pm)().DesignPage_SettingsPane_LockGivenQuestions,Options:{HTMLPropsForInnerElement:{name:t,"aria-posinset":n,"aria-setsize":e}},RadioCheckbox:!0,Value:!r.ShuffleAllQuestions,Disabled:i.Model.HasValidBranching,onValueChange:function(t){(0,q.$U)("DesignPage.Setting.LockGivenQuestions"),r.ShuffleAllQuestions=!t}})},n.prototype.D_=function(){var t=this,n=this.state,e=this.props.Form,i=e.SettingMaster.Model;if(this.T_()&&!i.ShuffleAllQuestions){var r=Number(n.StartRange),o=Number(n.EndRange),s=(0,ur.ZA)({HTMLAttributes:{className:"flex-pane-setting-shuffle-input",onBlur:function(){(0,nt.U)(r)&&r>=1&&r<=e.FormElementManager.QuestionMasters.length&&r<=o?(i.LockGivenQuestionsStartDisplayOrder=r,t.setState({ShowShuffleQuestionRangeError:!1})):t.setState({ShowShuffleQuestionRangeError:!0})}},TextFieldType:0,AutoSelection:!0,Value:n.StartRange,onValueChange:function(n){t.setState({StartRange:n})}}),a=(0,V.M)({FluentIcon:"Line Horizontal 1",HTMLAttributes:{className:"flex-pane-setting-shuffle-seperator"}}),u=(0,ur.ZA)({HTMLAttributes:{className:"flex-pane-setting-shuffle-input",onBlur:function(){(0,nt.U)(o)&&o>=1&&o<=e.FormElementManager.TopQuestionMasters.length&&o>=r?(i.LockGivenQuestionsEndDisplayOrder=o,t.setState({ShowShuffleQuestionRangeError:!1})):t.setState({ShowShuffleQuestionRangeError:!0})}},TextFieldType:0,AutoSelection:!0,Value:n.EndRange,onValueChange:function(n){t.setState({EndRange:n})}}),c=void 0;return n.ShowShuffleQuestionRangeError&&(c=g.createElement("span",{className:"flex-pane-shuffle-status flex-pane-status-error"},(0,T.pm)().ShuffleQuestionValidation_ErrorMessage)),g.createElement("div",{className:"flex-pane-setting-shuffle-div office-form-theme-focus-border"},s,a,u,c)}},n.prototype.N_=function(){if((0,I.cr)("ResponseInApp")){var t=this.props.Form.SettingMaster.Model;return this.XO({Description:(0,T.pm)().DesignPage_SettingsPane_ResponseInTakeATest,Value:t.RespondInAppOnly,onValueChange:function(n){(0,q.$U)("DesignPage.Setting.RespondInAppOnly"),t.RespondInAppOnly=n}})}},n.prototype.y_=function(){var t,n=this.props.Form,e=n.Model,i=(0,T.pm)().FormsType_Form,r=n.totalSectionCount()>=2;return"survey"===e.Type?i=(0,T.pm)().FormsType_Survey:n.SettingMaster.Model.IsQuizMode&&(i=(0,T.pm)().FormsType_Quiz),(0,q.$U)("DesignPage.Setting.ShowProgressBarOption"),this.XO({key:"SettingsPane-responseOptions-ProgressBarNew",Disabled:!r,Description:(0,T.pm)().DesignPage_SettingsPane_ProgressBar,Value:"true"===e.ProgressBarEnabled&&r,onValueChange:function(t){t?(0,q.$U)("DesignPage.Setting.ProgressBarEnabled"):(0,q.$U)("DesignPage.Setting.ProgressBarDisabled"),e.ProgressBarEnabled=String(t)},Options:r?null:{classNameForInnerDiv:"flex-pane-checkbox-info",classNameForInnerLabel:"flex-pane-checkbox-label-disabled settings-display-inline"},children:[r?null:g.createElement("div",{className:"progress-bar-setting-tooltip"},(t={ButtonLabel:(0,T.pm)().DesignPage_SettingsPane_ProgressBar,ToolTipLabel:(0,T.pm)().DesignPage_SettingsPane_ProgressBar_Tooltip.format(i)},g.createElement(sh,(0,p.pi)({},t))))]})},n.prototype.XO=function(t){t.HTMLAttributes=t.HTMLAttributes||{},t.HTMLAttributes.className=t.HTMLAttributes.className||"setting-pane-checkbox",t.Options=t.Options||{classNameForInnerDiv:"flex-pane-checkbox-info",classNameForInnerLabel:"flex-pane-checkbox-label settings-display-inline"};var n=this.props.Form;return(0,C.w)(n,"DisableEditForm")&&(t.Disabled=!0),(0,jf.e)(t)},n.prototype.i_=function(t){},n.prototype.T_=function(){var t=this.props.Form;return t.SettingMaster.Model.ShuffleQuestionOrder&&!t.hasSection()},n.prototype.E_=function(){},n.prototype.a_=function(t){this.setState({ShowDataClassificationSettingPane:t})},n.prototype.r_=function(t){0},n}(J.r),dh=e(26143);function mh(t,n){var e=null!=n?n:(0,T.pm)();switch(t){case"AnalysisResult":return e.SharePane_AnalysisResult_GetLink;case"Collaboration":return e.SharePane_Collaboration_GetLink;case"ShareAsTemplate":return e.SharePane_ShareAsTemplate_GetLink;default:return""}}function vh(t,n){var e=null!=n?n:(0,T.pm)();switch(t){case"AnalysisResult":return e.SharePane_AnalysisResult_Link_Title;case"Collaboration":return e.SharePane_Collaboration_Link_Title;case"ShareAsTemplate":return e.SharePane_ShareAsTemplate_Link_Title;default:return""}}!function(t){t[t.ShareAsTemplate=0]="ShareAsTemplate",t[t.Collaboration=1]="Collaboration",t[t.AnalysisResult=2]="AnalysisResult"}(fh||(fh={}));var gh=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.needUpdateFocus=!1,n.O_="",n.__=!0,n.gP=y.uniqueId("share"),n.B_=n.gP+"-dm",n.H_=n.gP+"-ls",n.q_=n.gP+"-lt",n.V_=g.createRef(),n.U_=function(){document.addEventListener("click",(function(t){var e;n.state.ShowConfirmDelete&&((null===(e=n.V_.current)||void 0===e?void 0:e.contains(t.target))?n.U_():n.setState({ShowConfirmDelete:!1}))}),{once:!0})},n}return(0,p.ZT)(n,t),Object.defineProperty(n.prototype,"linkButtonId",{get:function(){return"flex-pane-share-".concat(this.j_,"-link")},enumerable:!1,configurable:!0}),n.prototype.componentDidMount=function(){this.ju=Zf(this.props.Form,this.linkButtonId,this.H_,(0,T.pm)().SharePane_Link_SuccessMessage,(0,T.pm)().SharePane_Link_FailedMessage)},n.prototype.componentDidUpdate=function(){if(this.needUpdateFocus){var t=b.findDOMNode(this.refs[this.O_]);t&&(t.focus(),"textbox-link"==this.O_&&t.select(),this.O_=void 0),this.needUpdateFocus=!1}this.state.ShowConfirmDelete&&((0,kr.mZ)(b.findDOMNode(this.V_.current)),this.U_())},n.prototype.componentWillUnmount=function(){this.__=!1,this.ju&&this.ju.destroy(),this.ju=void 0},n.prototype.render=function(){if((0,C.w)(this.props.Form,"DisableEditForm"))return null;this.j_=fh[this.props.ShareOption];var t=this.state.AllowCopy&&this.state.Token;return g.createElement("div",{"aria-label":vh(this.j_),className:"flex-pane-option-container-share"},g.createElement("div",{"aria-level":2,className:"flex-pane-content-container-title",role:"heading"},vh(this.j_)),t&&this.W_(),!t&&this.K_())},Object.defineProperty(n.prototype,"Mounted",{get:function(){return this.__},enumerable:!1,configurable:!0}),n.prototype.setStateSafely=function(t){this.Mounted&&this.setState(t)},n.prototype.createTitle=function(){return g.createElement("div",{className:"flex-pane-share-content-title"},function(t,n){var e=null!=n?n:(0,T.pm)();switch(t){case"AnalysisResult":return e.SharePane_AnalysisResult_Title;case"ShareAsTemplate":return e.SharePane_ShareAsTemplate_Title;default:return""}}(fh[this.props.ShareOption]))},n.prototype.showErrorStatus=function(t){b.findDOMNode(this.refs.status).textContent=t},n.prototype.isEditingDisabled=function(){return!1},n.prototype.disableControls=function(){return!1},n.prototype.getDeleteWarningMessage=function(){return(0,T.pm)().SharePane_ShareOption_DeleteDialog_Message},n.prototype.createShareContent=function(){var t=this,n=g.createElement("div",{className:"flex-pane-share-form-spinner-container",key:"share"},this.xu(!0));return g.createElement("div",{className:"flex-pane-share-form-content-container"},(0,et.hl)((function(){return t.createTitle()})),g.createElement("div",{className:"flex-pane-share-form-content-body"},g.createElement("div",(0,p.pi)({},{className:"flex-pane-share-content-copy"}),this.J_(),this.Z_(),this.X_()),this.Y_()),this.state.ShowSpinner&&n)},n.prototype.W_=function(){var t=this.state.ShowConfirmDelete;return g.createElement("div",{className:"flex-pane-dark-container",key:"shareContainer"},t&&this.tB(),!t&&this.createShareContent(),this.nB())},n.prototype.K_=function(){var t=this,n=this.state.ShowSpinner,e=function(t,n){var e=null!=n?n:(0,T.pm)();switch(t){case"Collaboration":return e.SharePane_Collaboration_Tooltip2;case"ShareAsTemplate":return e.SharePane_ShareAsTemplate_Tooltip2;default:return""}}(this.j_)||function(t,n){var e=null!=n?n:(0,T.pm)();switch(t){case"Collaboration":return e.SharePane_Collaboration_Tooltip;case"ShareAsTemplate":return e.SharePane_ShareAsTemplate_Tooltip;default:return""}}(this.j_),i=(0,z.F)({HTMLAttributes:{className:"flex-pane-sharelink-button",disabled:this.isEditingDisabled(),onClick:function(){t.setState({ShowSpinner:!0}),t.createLink(),t.O_="textbox-link"}},FluentIcon:"Add",IconClassName:"share-link-plus-icon forms-icon-size16x16",ButtonStyle:1,GlyphButtonStyle:"Horizontal",Text:mh(this.j_),TextClassName:"flex-pane-share-link-text",Tooltip:e,ref:"link-button"});return g.createElement("div",{className:"flex-pane-sharelink-container"},i,n&&this.xu(!1),this.nB())},n.prototype.J_=function(){var t=this,n={disabled:this.disableControls(),readOnly:!0,value:this.getShareContentUrl(),className:"flex-pane-textbox",id:this.q_,ref:"textbox-link",onClick:function(){var n=b.findDOMNode(t.refs["textbox-link"]);n.focus(),n.select()}};return this.j_===fh[fh.Collaboration]?n["aria-label"]=(0,T.pm)().Link_Sharing_Collaborate:n["aria-label"]=(0,T.pm)().Link_Sharing_Template,g.createElement("input",(0,p.pi)({},n))},n.prototype.Z_=function(){var t=this,n={className:"flex-pane-button",disabled:this.disableControls(),id:this.linkButtonId,type:"button",onClick:function(n){(0,q.$U)("DesignPage.Share.Copy".concat(t.j_,"Link"))}};return n["data-clipboard-target"]=Wf(this.q_),g.createElement("button",(0,p.pi)({},n),(0,T.pm)().Common_Copy_Text)},n.prototype.X_=function(){var t={className:"flex-pane-status",id:this.H_,role:"alert"};return g.createElement("div",(0,p.pi)({},t))},n.prototype.Y_=function(){var t=this;return(0,z.F)({HTMLAttributes:{className:"flex-pane-share-content-delete-button",disabled:this.disableControls()||this.isEditingDisabled(),onClick:function(){t.setState({ShowConfirmDelete:!0}),t.O_="cancel-button",t.needUpdateFocus=!0}},FluentIcon:"Delete",IconClassName:"flex-pane-delete-icon forms-icon-size18x18",ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",Text:(0,T.pm)().Common_Delete_Text,ref:"delete-button"})},n.prototype.tB=function(){var t=this,n=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"flex-pane-confirm-dialog-close-button",onClick:function(){t.setState({ShowConfirmDelete:!1}),t.O_="delete-button",t.needUpdateFocus=!0}},FluentIcon:"Dismiss",IconClassName:"forms-icon-size16x16",Text:(0,T.pm)().Common_Close_Text}),e=(0,Fr.E)({HTMLAttributes:{className:"flex-pane-confirm-dialog-option",onClick:function(){t.setState({ShowConfirmDelete:!1}),t.O_="delete-button",t.needUpdateFocus=!0}},ButtonStyle:1,Text:(0,T.pm)().Common_Cancel_Text,ref:"cancel-button"}),i=(0,Fr.E)({HTMLAttributes:{className:"flex-pane-confirm-dialog-option",onClick:function(){t.setState({ShowSpinner:!0,ShowConfirmDelete:!1}),t.deleteLink(),t.O_="link-button"},"aria-describedby":this.B_},ButtonStyle:1,Text:(0,T.pm)().SharePane_ShareOption_DeleteDialog_Delete}),r={className:"flex-pane-confirm-delete-container",ref:this.V_,tabIndex:-1,key:"confirm"},o=this.getDeleteWarningMessage();return g.createElement("div",(0,p.pi)({},r),n,g.createElement("div",{className:"flex-pane-confirm-dialog-title",id:this.B_,"aria-label":o,tabIndex:0},o),g.createElement("div",{className:"flex-pane-confirm-dialog-button-container"},e,i))},n.prototype.xu=function(t){var n=t?"flex-pane-delete-share-link-spinner":"flex-pane-share-form-spinner";return g.createElement("div",{className:n},g.createElement("div",{className:"common-spinner-circle"}))},n.prototype.nB=function(){if(this.state.ShowError)return g.createElement("div",{className:"flex-pane-share-error-box",ref:"status"})},n}(J.r);var ph=function(t){function n(n){var e=t.call(this,n)||this;e.eB=g.createRef(),e.iB=e.iB.bind(e),e.JE=e.JE.bind(e),e.rB=e.rB.bind(e),e.oB=e.oB.bind(e),e.sB=e.sB.bind(e),e.aE=(0,T.pm)(),e.aB=e.aE.SharePane_Collaboration_TitleCrossTenant,e.uB=e.aE.SharePane_Collaboration_TitleSameTenant,e.cB=e.aE.SharePane_Collaboration_ShareToPeople;var i=(0,k.f5)();i.observe(e.iB,[i.Schema.FormsTenantSettings]);var r=e.lB(),o=e.fB(),s=y.find(e.props.Form.Model.Permissions,(function(t){return t.Type===o})),a=null==s?void 0:s.PrincipalId,u=!1;return r||"Link"!==o||(o="OrgLink",u=!0),e.state={AllowCopy:e.props.Form.Model.Permissions.length>0,CollaborateOptionValue:o,ShowError:u,Token:a},e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this.state.ShowError&&this.showErrorStatus(this.aE.DesignPage_SharePane_CollabDisabled_AdminSettings)},n.prototype.componentWillUnmount=function(){(0,k.f5)().unobserve(this.iB),t.prototype.componentWillUnmount.call(this)},n.prototype.createLink=function(){this.props.Form.refreshPermissions().then(this.rB)},n.prototype.deleteLink=function(){this.props.Form.refreshPermissions().then(this.oB)},n.prototype.createShareContent=function(){return this.state.ShowConfirmDialog?g.createElement(zf,(0,p.pi)({},this.oO)):t.prototype.createShareContent.call(this)},n.prototype.createTitle=function(){return this.hB()},n.prototype.getShareContentUrl=function(){var t=this.props.Form.Model.Id,n="FormId=".concat(t);this.SpecificShareMode||(n+="&Token=".concat(this.state.Token));var e={fragment:n},i="../Pages/DesignPage.aspx?"+jQuery.param(e);return(0,_t.WN)(i)},n.prototype.isEditingDisabled=function(){return!this.props.Form.isCurrentUserFormOwnerOrGroupMember()},n.prototype.disableControls=function(){return this.state.IsChangingCollaborateOption},n.prototype.setStateSafely=function(t,n){this.Mounted&&this.setState(t,n)},n.prototype.getDeleteWarningMessage=function(){return this.SpecificShareMode?(0,T.pm)().DeleteCoauthLinkWarning:(0,T.pm)().SharePane_ShareOption_DeleteDialog_Message},Object.defineProperty(n.prototype,"SpecificShareMode",{get:function(){return"ShareToPeople"===this.state.CollaborateOptionValue},enumerable:!1,configurable:!0}),n.prototype.iB=function(){this.lB()||"Link"!==this.state.CollaborateOptionValue||(this.setState({CollaborateOptionValue:"OrgLink",ShowError:!0}),this.showErrorStatus(this.aE.DesignPage_SharePane_CollabDisabled_AdminSettings))},n.prototype.lB=function(){var t=(0,k.f5)().Model.FormsTenantSettings;return null==t||t.externalShareCollaboration},n.prototype.hB=function(){var t=this.aE.OnlyOwnerCanChangeCollaborate,n=[];if((0,I.cr)("EnableExternalSharing")){var e=this.isEditingDisabled()?t:this.aB,i=g.createElement("span",{className:"share-to-collaborate-content",title:e},this.aB);n.push({Disabled:this.dB()||this.isEditingDisabled(),DisplayContent:i,DisplayName:this.aB,Key:"CrossTenant",Value:"Link"})}var r=this.isEditingDisabled()?t:this.uB,o=g.createElement("span",{className:"share-to-collaborate-content",title:r},this.uB);n.push({Disabled:this.isEditingDisabled(),DisplayContent:o,DisplayName:this.uB,Key:"SameTenant",Value:"OrgLink"});var s=this.isEditingDisabled()?t:this.cB,a=g.createElement("span",{className:"share-to-collaborate-content",title:s},this.cB);n.push({Disabled:this.isEditingDisabled(),DisplayContent:a,DisplayName:this.cB,Key:"ShareToPeople",Value:"ShareToPeople"});var u=g.createElement(ar.P,{SelectOptions:n,Value:this.state.CollaborateOptionValue,onValueChange:this.sB,ref:this.eB,Label:(0,T.pm)().PeopleToShareWith_SharePane}),c=g.createElement("div",{className:"flex-pane-collaborate-dropdown-spinner-container"},g.createElement("div",{className:"flex-pane-collaborate-dropdown-spinner-content flex-pane-collaborate-spinnerContainer"},g.createElement("div",{className:"common-spinner-circle"}))),l=!this.state.ShowCollaborationDropDownSpinner&&this.SpecificShareMode;return g.createElement("div",null,g.createElement("div",{className:"flex-pane-option-dropdown-element"},u,g.createElement("div",{className:"flex-pane-status",id:"flex-pane-change-collaborate-tenant-status",role:"alert"}),this.state.ShowCollaborationDropDownSpinner&&c),l&&this.lO())},n.prototype.mB=function(){var t=this.props.Form.Model.Permissions,n=y.find(t,(function(t){var n=t.Type;return"Link"===n||"OrgLink"===n||"ShareToPeople"===n}));return null==n?void 0:n.Type},n.prototype.fB=function(){var t=this.mB();return"Link"===t&&this.dB()?"OrgLink":t},n.prototype.dB=function(){return!this.lB()},n.prototype.rB=function(){var t=this;dh.Z.getFormsTenantSettings().then((function(){var n=t.dB()?"OrgLink":"Link";(0,q.$U)("DesignPage.Share.CreateCollaborationLink",{linkType:n}),t.props.Form.appendPermission(n).then((function(e){t.needUpdateFocus=!1,t.setStateSafely({AllowCopy:!0,CollaborateOptionValue:n,ShowError:!1,ShowSpinner:!1,Token:e},(function(){var n=t.eB.current;n&&n.focus()}))})).catch((function(n){t.setStateSafely({AllowCopy:!1,ShowError:!0,ShowSpinner:!1,Token:null}),t.showErrorStatus(t.vB(n.innerCode))}))}))},n.prototype.oB=function(){var t=this;this.props.Form.removeLinkPermission().then((function(){(0,q.$U)("DesignPage.Share.DeleteCollaborationLink",{linkType:t.state.CollaborateOptionValue}),t.needUpdateFocus=!0,t.setStateSafely({CollaborateOptionValue:null,ShowSpinner:!1,Token:null})})).catch((function(n){5506===n.innerCode?t.setStateSafely({ShowError:!1,ShowSpinner:!1,Token:null}):(t.setStateSafely({ShowError:!0,ShowSpinner:!1}),t.showErrorStatus(t.vB(n.innerCode)))}))},n.prototype.pB=function(t){var n=this;this.setState({IsChangingCollaborateOption:!0,ShowCollaborationDropDownSpinner:!0}),(0,q.$U)("DesignPage.Share.SwitchCollaborationLink",{linkType:t}),t&&this.props.Form.appendPermission(t).then((function(e){n.setStateSafely({CollaborateOptionValue:t,IsChangingCollaborateOption:!1,ShowCollaborationDropDownSpinner:!1,Token:e}),n.props.Form.refreshPermissions()})).catch((function(t){n.setStateSafely({IsChangingCollaborateOption:!1,ShowCollaborationDropDownSpinner:!1,ShowError:!0}),n.showErrorStatus(n.vB(t.innerCode))}))},n.prototype.lO=function(){return(0,q.$U)("LazylazyShareToPeople.Start"),g.createElement("div",{className:"share-to-people-container"},g.createElement(Uf,{Disable:this.isEditingDisabled(),onSelectPersonas:this.JE,onClickManagePermission:this.props.OnClickManageAccess,SpecificPeoplePermissions:this.bB(),ShareToPeopleType:"WhoCanAccess"}))},n.prototype.JE=function(t){var n=this,e=t.map((function(t){(0,Ci.zv)(new Ci.G4(t.id,t.primaryText,t.secondaryText,t.secondaryText));var e={FormId:n.props.Form.Model.Id,IsOwner:!1,PermissionSet:"Read, Write, Share",PrincipalEmailAddress:t.secondaryText,PrincipalName:t.primaryText,PrincipalId:t.id,SavingState:"Saving",Type:t.optionalText};return(0,q.$U)("DesignPage.Share.AddSpecificPeople",{linkType:t.optionalText}),e}));return new Promise((function(t,i){return n.props.Form.appendSpecificPeoplePermissions(e).then(t,i)}))},n.prototype.bB=function(){var t=this.props.Form.getUserOrGroupPermissions();return y.map(t,(function(t){return{id:t.PrincipalId,optionalText:t.Type,primaryText:t.PrincipalName,secondaryText:t.PrincipalEmailAddress}}))},n.prototype.vB=function(t){var n=this.aE.Error_Page_DefaultErrorTitle;switch(t){case 5501:n=this.aE.Error_Message_5501;break;case 5503:n=this.aE.Error_Message_5503;break;case 5504:n=this.aE.Error_Message_5504;break;case 5554:n=this.aE.Error_Message_5554;break;case 5558:n=this.aE.Error_Message_5558;break;case 5510:n=this.aE.PermissionLimitReached}return n},n.prototype.sB=function(t){var n,e=this;if(t!==this.state.CollaborateOptionValue)if(this.SpecificShareMode&&this.props.Form.getUserOrGroupPermissions().length>1)this.yB(this.aE.ShiftCoauthOptionFromSpecificShareWarning,null,(function(){e.pB(t)}));else if("ShareToPeople"===t&&(null===(n=this.props.Form.Model.PermissionTokens)||void 0===n?void 0:n.length)>0){this.yB(this.aE.ShiftSpecificShareFromSummaryLinkCoauthOptionWarning,"https://go.microsoft.com/fwlink/?linkid=2122902",(function(){e.pB(t)}))}else this.pB(t)},n.prototype.yB=function(t,n,e){var i=this;this.oO={cancelCallBack:function(){i.setState({ShowConfirmDialog:!1})},CancelDisplayName:this.aE.Common_Cancel_Text,confirmCallBack:function(){e(),i.setState({ShowConfirmDialog:!1})},ConfirmDialogWarningMessage:t,ConfirmDisplayName:this.aE.Common_Yes_Text,LearnMoreLink:n},this.setState({ShowConfirmDialog:!0})},n}(gh);var bh=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this.props.Form.SettingMaster.Model;this.setState({AllowCopy:t.AllowCopy&&!!t.ShareToken,Token:t.ShareToken})},n.prototype.createLink=function(){this.wB(!0)},n.prototype.deleteLink=function(){this.wB(!1)},n.prototype.disableControls=function(){var t=(0,c.k0)().userInfo.IsMsa,n=this.props.Form.Model.OwnerTenantId,e=(0,ht.Fc)();return t!==((null==n?void 0:n.toLowerCase())===e)},n.prototype.getShareContentUrl=function(){var t={id:this.props.Form.Model.Id,sharetoken:this.state.Token},n="../Pages/ShareFormPage.aspx?"+jQuery.param(t);return(0,_t.WN)(n)},n.prototype.createTitle=function(){var t,n=(0,k.f5)().Model;return t=(0,I.cr)("EnableExternalSharing")&&n.FormsTenantSettings.externalShareTemplate?(0,T.pm)().SharePane_ShareAsTemplate_Title:(0,T.pm)().SharePane_ShareAsTemplateNotAllowed_Title,g.createElement("div",{className:"flex-pane-share-content-title"},t)},n.prototype.wB=function(t){var n=this,e=this.props.Form;e.SettingMaster.setSharingStatus(e.Model.Id,t).then((function(){(0,q.$U)(t?"DesignPage.Share.CreateShareAsTemplateLink":"DesignPage.Share.DeleteShareAsTemplateLink"),n.needUpdateFocus=!0,n.setStateSafely({ShowSpinner:!1,AllowCopy:t,Token:e.SettingMaster.Model.ShareToken,ShowError:!1})})).catch((function(t){n.setStateSafely({AllowCopy:e.SettingMaster.Model.AllowCopy,ShowSpinner:!1,ShowError:!0});var i=(0,Fi.D)("".concat(t.innerCode));n.showErrorStatus(i)}))},n}(gh);var yh=function(t){function n(n){var e=t.call(this,n)||this;return e.LO=function(){return e.ts(0)},e.SB=function(){return e.ts(1)},e.state={CurrentView:0},e}return(0,p.ZT)(n,t),n.prototype.render=function(){return g.createElement("div",{className:"flex-pane-share-pane"},this.EO(),this.OO())},n.prototype.EO=function(){var t,n=this;return 0!==this.state.CurrentView?null:g.createElement("div",{className:"flex-pane-share-options-container"},(0,c.k0)().userInfo.IsMsa?void 0:(t={Form:this.props.Form,OnClickManageAccess:this.SB,ShareOption:fh.Collaboration},g.createElement(ph,(0,p.pi)({},t))),(0,et.hl)((function(){return function(t){return g.createElement(bh,(0,p.pi)({},t))}({Form:n.props.Form,ShareOption:fh.ShareAsTemplate})})))},n.prototype.OO=function(){return 1!==this.state.CurrentView?null:g.createElement(ih,{Form:this.props.Form,OnViewNavigation:this.LO,ManageRespondSharing:"WhoCanAccess"})},n.prototype.ts=function(t){this.setState({CurrentView:t})},n}(J.r),wh=e(25303);function Sh(t){return g.createElement(Nh,t)}var Nh=function(t){function n(n){var e=t.call(this,n)||this;e.Gu=(0,k.f5)().Model,e.NB=e.NB.bind(e),e.CB=e.CB.bind(e);var i=(0,k.f5)();return e.TB()?i.bulkEdit((function(){i.Model.FlexPane="None",i.observe(e.CB,[i.Schema.FlexPane]),i.Model.FlexPane=e.props.FlexPaneType})):i.observe(e.CB,[i.Schema.FlexPane]),e.state={AnimationDone:!e.TB(),Expanded:e.TB(),PaneWidth:e.kB()},e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this;this.xB=function(){t.state.PaneWidth!==t.kB()&&t.setState({PaneWidth:t.kB()})},window.addEventListener("resize",this.xB)},n.prototype.componentDidUpdate=function(){var t=this,n=b.findDOMNode(this),e=$(n);e.width(this.state.PaneWidth),this.state.AnimationDone||(e.off("animationend"),this.state.Expanded?(e.removeClass(["NotVisible","slideRightOut"]),e.on("animationend",(function(){e.off("animationend"),e.find(":focusable").first().trigger("focus"),t.setState({AnimationDone:!0})})),e.addClass("slideLeftIn")):(e.removeClass("slideLeftIn"),e.on("animationend",(function(){e.off("animationend"),e.addClass("NotVisible"),t.setState({AnimationDone:!0})})),e.addClass("slideRightOut")))},n.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.xB),(0,k.f5)().unobserve(this.CB)},n.prototype.render=function(){var t,n,e=this,i=this.props,r={id:"flex-pane-container-"+i.FlexPaneType,className:"flex-pane-board NotVisible",role:"tabpanel",style:{width:this.state.PaneWidth+"px"}};this.TB()&&(r.className="flex-pane-board"),(0,et.pd)((function(){r.onKeyDown=(0,Tr.IB)((function(t){27===t.keyCode&&(e.Gu.FlexPane="None",t.stopPropagation(),(0,kr.r8)("Flexpane-"+i.FlexPaneType))}))}),et.t1);var o,s,a,u,l,f=i.Form;if(this.state.Expanded||!this.state.AnimationDone||"ImagePicker"===i.FlexPaneType||"Theme"===i.FlexPaneType)switch(i.FlexPaneType){case"SendForm":f.isFieldReady(F.x.Schema.Id)&&(t=function(t){return g.createElement(rh,t)}({Form:f})),n=(0,T.pm)().DesignPage_NavBar_Sendform;break;case"ShareForm":f.isFieldReady(F.x.Schema.Id)&&(t=function(t){return g.createElement(yh,t)}({Form:f})),n=(0,T.pm)().DesignPage_NavBar_Shareform;break;case"Settings":t=function(t){return g.createElement(hh,t)}({Form:f}),n=(0,T.pm)().DesignPage_SettingsPane_SettingLabel;break;case"MultiLingual":t=g.createElement(ff,{Form:i.Form,enterLanguageEditionView:this.NB}),n=(0,T.pm)().MoreOptionsMenu_Multilingual;break;case"Theme":f.isFieldReady(F.x.Schema.Theme)&&((0,c.k0)().userInfo.IsMsa?t=function(t){return g.createElement(Lf,t)}():(u=this.props.Form,l=function(){e.Gu.FlexPane="Theme"},t=g.createElement(kf,{FormMaster:u,onFlexPaneIndexChange:l}))),n=(0,T.pm)().DesignPage_NavBar_Theme;break;case"Feedback":t=function(t){return g.createElement(Mf,t)}(),n=(0,T.pm)().DesignPage_NavBar_Feedback;break;case"MultiLingualEditAll":null!=f&&(t=FormsPro.createMultiLingualEditAllView(i.Form,this.NB)),n=(0,T.pm)().MoreOptionsMenu_Multilingual;break;case"MoveFormPane":null!=f&&(o=function(t){return e.FB(t)},s=f,a=(0,dt.lS)(),t=g.createElement(Df,{changeFormOwnerHandler:o,SelectedForm:s,IsDelegateMode:a})),n=(0,T.pm)().MovePaneView_Button_MoveAction;break;case"ImagePicker":t=(0,gf.n)({ContainerWidth:this.kB()}),n=(0,T.pm)().ImagePicker_Type_Image;break;case"VideoPicker":t=(0,wh.H)({ContainerWidth:this.kB()}),n=(0,T.pm)().ImagePicker_Type_Video;break;case"MediaSelect":t=(0,Ha.V)(),n=(0,T.pm)().ImagePicker_Insert_Mdeia_button}return n&&(r["aria-label"]=n),g.createElement("div",r,t,!1)},n.prototype.FB=function(t){return this.props.changeFormOwnerHandler(this.props.Form,t)},n.prototype.PB=function(t,n){return this.props.copyToFormHandler(this.props.Form,t,n)},n.prototype.TB=function(){return this.props.FlexPaneType===this.Gu.FlexPane},n.prototype.CB=function(){this.state.Expanded!==this.TB()&&this.setState({AnimationDone:!1,Expanded:!this.state.Expanded})},n.prototype.kB=function(){var t=this.props.FlexPaneType;if("ImagePicker"===t||"VideoPicker"===t){var n=(0,nr.getIoCFlexPaneWidth)();return $(document).width()<n?$(document).width():n}return $(document).width()<=768?300:400},n.prototype.NB=function(t){var n=(0,k.f5)();n.bulkEdit((function(){n.showTopView("MultiLingualEditionView",(function(){})),n.Model.Locale=t,n.Model.FlexPane="None"}))},n}(J.r),Ch=e(50541),Ih=(0,Ct.vj)("RtcMaxIdleMinutes",5);var Th=function(t){function n(n){var e=t.call(this,n)||this;return e.formDesignerRef=g.createRef(),e.vo=!0,e.showPhishingFormTipBar=!0,e.As=function(){return e.forceUpdate()},e.DB=0,e.uxStateModel=(0,k.f5)().Model,e.state={FormReadyToDesign:!1,DisableReadonlyTipBar:!1},e.MB=e.MB.bind(e),e.onMouseDown=e.onMouseDown.bind(e),e.LB=e.LB.bind(e),e.RB=e.RB.bind(e),e.AB=e.AB.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this.props.FormMaster;this.EB(t);var n,e=(0,k.f5)();(e.observe(this.As,[e.Schema.Analysis,e.Schema.Grading]),(0,Wa.N4)())&&(0,G.z)(t).registerObservers();if(t.Model.RtcStatus=0,this.OB(!0),this.RB(),e.observe(this.RB,[e.Schema.LastActiveTime]),t.observe(this.As,[F.x.Schema.ReputationTier]),t.ensureFieldsReady([F.x.Schema.ResponsesCount]).then((function(){(null==t.Model.ResponsesCount||t.Model.ResponsesCount<0)&&t.getFormResponsesCountByAPICall()})),(0,gt.$p)().Token?n="Hash":(0,gt.NW)().Token&&(n="QueryString"),n){var i=(0,Xn.kc)(t.Model.Id).OwnerId==(0,c.k0)().userInfo.UserId;(0,q.$U)("DesignPage.OpenWithCoauthToken",{location:n,isOwner:i})}this.BB()},n.prototype.componentWillReceiveProps=function(t){t.FormMaster!==this.props.FormMaster&&this.EB(t.FormMaster)},n.prototype.componentDidMount=function(){this.HB()},n.prototype.componentDidUpdate=function(){this.HB()},n.prototype.componentWillUnmount=function(){this.vo=!1;var t=(0,k.f5)(),n=this.props.FormMaster;(this.OB(!1),t.unobserve(this.RB),t.unobserve(this.As),n.unobserve(this.As),(0,Wa.N4)())&&(0,G.z)(n).unregisterObservers()},n.prototype.render=function(){var t=this;if(!this.state.FormReadyToDesign)return(0,Ch.t)({Message:(0,T.pm)().Common_Loading_Text,TimeoutMessage:(0,T.pm)().RetryRecoverableErrorMessage_OpeningForm});var n=this.props.FormMaster,e={className:"body-content office-form-theme-page-background"},i=this.uxStateModel.FlexPane;return"None"!=i&&(e.className=(0,N.j)(e.className,"flex-pane",i)),this.uxStateModel.Analysis||(e.onMouseDown=this.onMouseDown),g.createElement("div",e,Sh({Form:this.props.FormMaster,FlexPaneType:"Theme"}),Sh({Form:this.props.FormMaster,FlexPaneType:"SendForm"}),Sh({Form:this.props.FormMaster,FlexPaneType:"ShareForm"}),Sh({Form:this.props.FormMaster,FlexPaneType:"Settings"}),Sh({Form:this.props.FormMaster,FlexPaneType:"MultiLingual"}),Sh({Form:this.props.FormMaster,FlexPaneType:"ImagePicker"}),Sh({Form:this.props.FormMaster,FlexPaneType:"VideoPicker"}),Sh({Form:this.props.FormMaster,FlexPaneType:"MediaSelect"}),!1,this.GB(),this.showFirstTimePhishingDetectionWarning(),this.showPhishingFormTipBar&&g.createElement(rf,{FormMaster:n}),!1,!1,this.qB(),this.VB(),(0,et.hl)((function(){return t.zB()})))},n.prototype.$a=function(){return(0,et.pd)((function(){return null}),et.t1)},n.prototype.QB=function(){return null},n.prototype.UB=function(t){t.preventDefault(),t.stopPropagation(),(0,k.f5)().showTopView("MFPBranching",(function(){}))},n.prototype.qB=function(){return this.props.TopView?g.createElement(Ka.w,{ThemeMaster:this.props.FormMaster.ThemeMaster}):g.createElement(Yl,{Form:this.props.FormMaster,FormDesignerRef:this.formDesignerRef,MalformedBranchingNotification:this.props.MalformedBranchingNotification||this.props.CorruptedBranchingNotification,originAssignmentsCreateQuiz:(0,dt.Rw)()})},n.prototype.HB=function(){Rs&&this.state.FormReadyToDesign&&window.performance&&(0,q.in)("Endpoint.DesignPage",Os())},n.prototype.VB=function(){return(0,Bs.OT)((0,ws.b4)().Model.ExcelSurveyIntroduction)&&this.uxStateModel.ShowExcelSurveyIntroductionDialog&&(0,c.k0)().userInfo.IsMsa?g.createElement(Hs,{}):null},n.prototype.BB=function(){(0,bs.c)().log(Fn.Ng,"AppResume"),(0,bs.c)().logStartTime(Fn.Ng,"AppUsageTime")},n.prototype.GB=function(){var t=this.props.FormMaster;if(t.isFieldReady(F.x.Schema.Category)&&(0,C.w)(t,"DisableEditForm")&&!this.state.DisableReadonlyTipBar)return(0,ms.vV)({Info:(0,T.pm)().DesignPage_ReadonlyFormTip,TipBarLocation:"Up",TipBarStyle:"YellowBackground",ShouldClose:!0,onClose:this.MB})},n.prototype.zB=function(){return g.createElement(tf,{FormMaster:this.props.FormMaster})},n.prototype.showFirstTimePhishingDetectionWarning=function(){(0,K.$C)((0,K.NT)(this.props.FormMaster.Model.ReputationTier));var t=(0,ws.b4)().Model;if((0,c.k0)().userInfo.IsMsa&&(0,K.wW)(this.props.FormMaster.Model.ReputationTier)&&!t.IsNotFirstTimePhishingDetected&&!this.uxStateModel.Analysis)return t.IsNotFirstTimePhishingDetected=!0,this.showPhishingFormTipBar=!1,(0,q.$U)("DesignPage.ShowFirstTimePhishingDetectedWarning"),g.createElement(nf,{showPhishingTipbarCallback:this.AB})},n.prototype.AB=function(t){t&&(this.showPhishingFormTipBar=!0,this.forceUpdate())},n.prototype.MB=function(){this.setState({DisableReadonlyTipBar:!0})},n.prototype.EB=function(t){var n=this;t.ensureReadyToDesign().catch((function(e){var i=e;if(i)switch(i.innerCode){case 639:var r=(0,pt.Es)("formId",i.innerMessage);r!==window.location.href&&(0,Dn.gB)(r);break;case 625:n.jB(t);break;default:n.uxStateModel.CriticalError=e}throw e})).then((function(){return(0,ys.cb)("survey"===t.Model.Type)})).then((function(){return t.Model.LastSyncTime=Date.now()})).then((function(){null==t.SettingMaster.Model.IsQuizMode&&(t.SettingMaster.Model.IsQuizMode=t.Model.QuizQuestionsCount>0),n.vo&&n.props.FormMaster===t&&n.setState({FormReadyToDesign:!0})}))},n.prototype.OB=function(t){var n=this.props.FormMaster;t&&2!==n.Model.RtcStatus?n.startReceivingNotifications():t||2!==n.Model.RtcStatus||n.stopReceivingNotifications()},n.prototype.onMouseDown=function(t){var n=this.formDesignerRef.current;if(n){var e=$(t.target);b.findDOMNode(n).contains(e[0])||e.hasClass("flex-pane-board")||e.parents(".flex-pane-board").length||n.endCurrentDesignMode()}},n.prototype.jB=function(t){var n=this;t.IsGroupForm&&((0,c.k0)().userInfo.TenantId===t.Model.OwnerTenantId?(0,di.nT)(t.Model.OwnerId).then((function(){n.uxStateModel.CriticalError={innerCode:6706,type:"ExpectedFailure"}})).catch((function(){n.uxStateModel.CriticalError={innerCode:6707,type:"ExpectedFailure"}})):this.uxStateModel.CriticalError={innerCode:6708,type:"ExpectedFailure"})},n.prototype.LB=function(){this.OB(!1)},n.prototype.RB=function(){0!==this.DB&&window.clearTimeout(this.DB),this.DB=window.setTimeout(this.LB,60*Ih*1e3),3===this.props.FormMaster.Model.RtcStatus&&this.OB(!0)},n}(J.r),kh=e(36630),xh=e(30521);function Fh(){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(862).then(e.bind(e,48594))];case 1:return[2,{default:t.sent().createRecycleBinView}]}}))}))}function Ph(t){var n=(0,$i.J)(Ph,Fh);return g.createElement(Ui.Z,null,g.createElement(n,(0,p.pi)({},t)))}var Dh=e(51185),Mh=function(t){function n(n){var e=t.call(this,n)||this;return e.WB=e.WB.bind(e),e}return(0,p.ZT)(n,t),n.prototype.getContainerProps=function(){var t=this.props,n=y.extend({},t.HTMLAttributes);return n.className=(0,N.j)(n.className,"top-view-container"),this.props.TopViewTitle&&(n["aria-label"]=this.props.TopViewTitle),n},n.prototype.onBackButtonClick=function(t){},n.prototype.createHeader=function(t){var n,e=this;(0,dt.GF)()&&!(0,dt.Rw)()||(n=(0,z.F)({HTMLAttributes:{className:"top-view-back-button office-form-theme-button-color",onClick:function(t){return e.WB(t)},autoFocus:!0},ButtonStyle:1,FluentIcon:"Arrow Left",IconClassName:"top-view-back-icon "+((0,dt.QR)()?"forms-icon-size16x16":"forms-icon-size18x18"),Text:(0,T.pm)().Common_Back_Text,TextClassName:"top-view-back-text",ref:"back-button"}));return g.createElement("div",[{className:"top-view-header",role:"navigation"}],n,t)},n.prototype.WB=function(t){(0,k.f5)().bulkEdit((function(t){t.TopView="None",t.Locale=void 0,t.BranchingElementId=null,t.SectionElementId=null})),this.onBackButtonClick(t)},n}(J.r),Lh=e(94605),Rh=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.KB=function(){return n.JB()},n.aT=function(){return n.forceUpdate()},n}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){this.props.Master.observe(this.KB,[Lh.G.Schema.TargetQuestionId,Lh.G.Schema.ToTheEnd]),this.JB()},n.prototype.componentWillUnmount=function(){this.props.Master.unobserve(this.KB);var t=this.ZB;t&&t.unobserve(this.aT)},n.prototype.render=function(){var t=this,e=this.props,i=e.Master.Model,r=i.ToTheEnd?n.SpecialIdForGoingToTheEnd:i.TargetQuestionId;r=r||n.SpecialIdForGoingToTheNext;var o=[e.AriaLabel,(0,T.pm)().Branch_Menu_Description_Prefix].join((0,T.pm)().Common_ItemSeperator),s=this.props.ReadOnly?g.createElement("div",{className:"office-form-question-title","aria-level":2,role:"heading"},this.XB(r)):(0,ar.E)({AllowWrap:!0,Label:o,onValueChange:function(n){return t.oC(n.toString())},SelectOptionGroups:this.Ff(),Value:r}),a=y.extend({},e.HTMLAttributes);return a.className=(0,N.j)("branch-selector office-form-theme-primary-color",a.className),g.createElement("div",(0,p.pi)({},a),n.createGuide(),s)},n.createGuide=function(){return g.createElement("div",{className:"branch-selector-guide office-form-theme-primary-foreground"},(0,T.pm)().Branch_Menu_Description_Prefix)},n.prototype.Ff=function(){var t=this.props.Master.getElementMaster(),e=t.Form.FormElementManager,i=Ve.H.isSection(this.props.Master.getElementMaster().Model.Type),r=[{SelectOptions:[n.getSelectOptionToTheNext(),n.getDropdownOptionToTheEnd()]}],o=e.findContainerSection(t),s=t.Form.hasSection();if(!i){var a=e.findQuestionsInSection(o);if(a.length>=0){var u=e.TopQuestionMasters.indexOf(a[0]);r.push(n.getSelectOptionGroup(a,t,s?(0,T.pm)().Branch_OptionGroup_CurrentSection:void 0,u))}}return r.push(n.getSelectOptionGroup(e.SectionMasters,o,(0,T.pm)().Branch_OptionGroup_OtherSections)),r},n.getNextLabel=function(){return(0,T.pm)().Common_Next_Text},n.getSelectOptionGroup=function(t,e,i,r){void 0===r&&(r=0);var o=t.map((function(t,o){if(t!==e)return n.getSelectOptionToTarget(t,r+o+1,i)})).filter((function(t){return!!t}));return{DisplayName:i,SelectOptions:o}},n.prototype.XB=function(t){switch(t){case n.SpecialIdForGoingToTheEnd:return n.getDropdownOptionToTheEnd().DisplayName;case n.SpecialIdForGoingToTheNext:return n.getSelectOptionToTheNext().DisplayName;default:if(!t)return"";var e=this.props.Master.getElementMaster().Form.FormElementManager,i=e.TopQuestionMasters,r=y.findIndex(i,(function(n){return n.Model.Id===t}));if(r>=0)return n.getSelectOptionToTarget(i[r],r+1).DisplayName;var o=e.SectionMasters;return(r=y.findIndex(o,(function(n){return n.Model.Id===t})))>=0?n.getSelectOptionToTarget(o[r],r+1).DisplayName:""}},n.getSelectOptionToTheNext=function(){return{DisplayName:n.getNextLabel(),Key:n.SpecialIdForGoingToTheNext,Value:n.SpecialIdForGoingToTheNext}},n.getSelectOptionToTarget=function(t,n,e){var i=t.Model,r=(0,du.dZ)(i.Title),o=(0,T.pm)().Branch_QuestionTitle.format(n,r),s=Ve.H.isSection(t.Model.Type),a=n.toString();return s&&(a=(0,T.pm)().Designer_Sections_DefaultDescription.format(a)),{AriaLabel:e?(0,T.pm)().Common_Fullstop.format(e,o):o,DisplayContent:g.createElement("div",{className:"branch-selector-option-item"},g.createElement("span",{className:"branch-selector-option-ordinal",key:"ordinal"},(0,T.pm)().Designer_QuestionOrdinal.format(a)),g.createElement("span",{className:"branch-selector-option-title",key:"title"},g.createElement("span",null,r))),DisplayName:o,Key:i.Id,Value:i.Id}},n.getDropdownOptionToTheEnd=function(){return{DisplayName:(0,T.pm)().Branch_Menu_End,Key:n.SpecialIdForGoingToTheEnd,Value:n.SpecialIdForGoingToTheEnd}},n.prototype.oC=function(t){var e=this.props.Master,i=e.Model;t===n.SpecialIdForGoingToTheEnd?i.ToTheEnd=!0:(t===n.SpecialIdForGoingToTheNext&&(t=null),e.bulkEdit((function(){i.ToTheEnd=!1,i.TargetQuestionId=t})));var r=e.getElementMaster().Model;(0,q.$U)("DesignPage.Branch.BranchChanged",{isQuestionBranching:r.BranchInfo===i,questionType:r.Type,targetQuestionType:e.getTargetElementMaster()&&e.getTargetElementMaster().Model.Type,toTheEnd:i.ToTheEnd,value:t,withSection:e.getElementMaster().Form.hasSection()})},n.prototype.JB=function(){this.forceUpdate();var t=this.ZB;t&&t.unobserve(this.aT),this.ZB=this.props.Master.getTargetElementMaster(),(t=this.ZB)&&t.observe(this.aT)},Object.defineProperty(n,"SpecialIdForGoingToTheNext",{get:function(){return"% To The Next %"},enumerable:!1,configurable:!0}),Object.defineProperty(n,"SpecialIdForGoingToTheEnd",{get:function(){return"% To The End %"},enumerable:!1,configurable:!0}),n}(J.r),Ah=function(t){function n(n){var e=t.call(this,n)||this;e.YB=g.createRef(),e.nH=g.createRef(),e.eH=g.createRef(),e.rH=!1,e.sH=y.uniqueId("branching-question-title"),e.As=function(){return e.forceUpdate()},e.aH=e.aH.bind(e),e.uH=e.uH.bind(e),e.cH=e.cH.bind(e);var i=e.props.Question;return e.lH=new or.r(i,null),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){this.aH(),this.rH=!0,$(window).resize(this.aH),this.props.Question.observe(this.As)},n.prototype.componentWillUnmount=function(){$(window).unbind("resize",this.aH),this.props.Question.unobserve(this.As)},n.prototype.componentDidUpdate=function(){this.aH()},n.prototype.render=function(){var t=this.props.Question,n="branch-design-question-card";t.supportsChoiceLevelBranching()||(n=(0,N.j)(n,"branch-design-question-nonflex"));var e=0,i=!1;this.props.Active&&(n=(0,N.j)(n,"active","office-form-theme-border-top"),e=-1,i=!0);var r,o={Disabled:!0,DisableFormulaLinebreak:!0,DisableShuffle:!0,ExpandAll:!0,HiddenPoint:!0,HideMedia:!0,LocalizedStrings:(0,T.pm)(),Master:this.lH,onHeightChange:this.aH,Ordinal:this.props.Ordinal,ref:this.YB,ShowDesignInfo:!0},s=this.fH(t).filter((function(t){return!!t}));return s&&s.length&&(r=s.length>1?g.createElement("div",{"aria-labelledby":this.sH,className:"branch-design-card",ref:this.nH,role:"group"},g.createElement("div",{className:"screenReaderReference",id:this.sH},t.Model.Title),s):g.createElement("div",{className:"branch-design-card",ref:this.nH},s)),g.createElement("div",{className:n,onClick:this.uH,key:t.Model.Id,ref:this.eH,tabIndex:e,onKeyUp:this.cH,role:"button","aria-expanded":i,"aria-label":t.Model.Title},(0,ps.n)(o),r)},n.prototype.uH=function(){this.props.Active||this.props.setAsActive(this.props.Question)},n.prototype.fH=function(t){var n=this,e=[],i=t.Model;return t.supportsQuestionLevelBranching()&&e.push(this.hH(i.BranchInfo,i.Title)),t.supportsChoiceLevelBranching()&&(e=e.concat(y.map(t.Model.Choices,(function(t){return n.hH(t.BranchInfo,t.Description)}))),i.AllowOtherAnswer&&e.push(this.hH(t.Model.BranchInfoForOtherChoice,(0,T.pm)().Designer_OtherAnswer))),e},n.prototype.hH=function(t,n){var e=_.d.getObjectMasterFromModel(t),i=e.getInstanceId();if(this.props.Active||!e.isDefault())return g.createElement(Rh,{AriaLabel:n,Master:e,key:i,ref:i,ReadOnly:this.props.ReadOnly})},n.prototype.aH=function(){var t=this,n=$(b.findDOMNode(this.YB.current)),e=$(b.findDOMNode(this.nH.current));if(n.length&&e.length){var i=n.offset().top,r=this.props.Question;if(r.supportsQuestionLevelBranching()){var o=n.find(".office-form-question-title");this.dH(r.Model.BranchInfo,o,i)}if(r.supportsChoiceLevelBranching()){var s=n.find(".office-form-question-choice"),a=r.Model.Choices;if(s.each((function(n,e){t.dH(a[n].BranchInfo,$(e),i)})),r.Model.AllowOtherAnswer){var u=n.find(".office-form-other-answer");this.dH(r.Model.BranchInfoForOtherChoice,u,i)}}if(!this.rH&&this.props.NeedScroll){var c=this.eH.current;if(c&&c.offsetParent.lastElementChild){var l=c.offsetParent.lastElementChild.firstElementChild;if(l){var f=(0,k.f5)().Model.RelativeScrollHeight;l.scrollTop=c.getBoundingClientRect().top-f}}}}},n.prototype.dH=function(t,n,e){var i=n.offset().top-e+n.outerHeight()/2,r=_.d.getObjectMasterFromModel(t),o=$(b.findDOMNode(this.refs[r.getInstanceId()]));o.length&&o.css("top",i-o.outerHeight()/2)},n.prototype.cH=function(t){switch(t.keyCode){case 13:case 32:t.stopPropagation(),this.uH();break;case 27:if(t.stopPropagation(),this.props.Active){this.props.setAsNotActive();var n=this.eH.current;n&&n.focus()}}},n}(J.r),Eh=function(t){function n(n){var e=t.call(this,n)||this;return e.YT=g.createRef(),e.mH=e.mH.bind(e),e.aH=e.aH.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){this.aH()},n.prototype.render=function(){var t=this,n=this.props.SectionNode,e=this.props.SectionIndex,i=this.props.QuestionStartIndex,r="branch-design-section-container";0===this.props.QuestionStartIndex&&0===e&&(r=(0,N.j)(r,"branch-design-section-container-merge")),this.props.Active&&(r=(0,N.j)(r,"office-form-theme-border-top"));var o=n.TopQuestionMasters.map((function(n){return g.createElement(Ah,{Question:n,Active:n===t.props.getActive(),Ordinal:1+i++,key:n.Model.Id,ReadOnly:t.props.ReadOnly,setAsActive:t.props.setActive,setAsNotActive:t.props.setNotActive,NeedScroll:n===t.props.getScroll()})})),s=n.Section.Model.Title?{"aria-level":2,role:"heading"}:null;return g.createElement("div",{className:r,ref:this.YT},g.createElement("div",{className:"branch-design-section-header"},g.createElement("h2",{className:"branch-design-section-sequence"},(0,T.pm)().Designer_Sections_DefaultDescription.format(e+1))),g.createElement("div",(0,p.pi)({className:"branch-design-section-title office-form-title heading-2 office-form-theme-primary-color"},s),n.Section.Model.Title),g.createElement("div",{className:"branch-design-section-view"},o),g.createElement("div",{className:"branch-design-section-footer",onClick:this.mH,onFocus:this.mH},this.hH(n.Section.Model.BranchInfo,n.Section.Model.Title)))},n.prototype.mH=function(){this.props.Active||this.props.setActive(this.props.SectionNode.Section)},n.prototype.hH=function(t,n){var e=_.d.getObjectMasterFromModel(t),i=e.getInstanceId();return g.createElement(Rh,{AriaLabel:n,Master:e,key:i,ref:i,ReadOnly:this.props.ReadOnly})},n.prototype.aH=function(){if(this.props.NeedSectionScroll){var t=this.YT.current;if(t&&t.offsetParent.lastElementChild){var n=t.offsetParent.lastElementChild.firstElementChild;if(n){var e=(0,k.f5)().Model.RelativeScrollHeight;n.scrollTop=t.getBoundingClientRect().top-e}}}},n}(J.r);var Oh=function(t){function n(n){var e=t.call(this,n)||this;return e.vo=!0,e.vH=g.createRef(),e.gH=g.createRef(),e.As=function(){return e.forceUpdate()},e.pH=e.pH.bind(e),e.bH=e.bH.bind(e),e.wH=e.wH.bind(e),e.SH=e.SH.bind(e),e.NH=e.NH.bind(e),e.CH=e.CH.bind(e),e.IH=e.IH.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this,n=this.props.Form,e=(0,gt.$p)().BranchingElementId,i=(0,gt.$p)().SectionElementId;n.ensureReadyToDesign().then((function(){if(t.vo){n.observe(t.As,[F.x.Schema.Questions]),n.observe(t.As,[F.x.Schema.DescriptiveElements]);var r=n.FormElementManager.QuestionMasters[0],o=y.find(n.FormElementManager.QuestionMasters,(function(t){return t.Model.Id===e}))||null;o&&(r=o);var s=y.find(n.FormElementManager.SectionMasters,(function(t){return t.Model.Id===i}))||null;i&&(r=s),t.setState({ElementInDesignMode:r,ElementInDesignScrollMode:o,FormReadyForDesign:!0,SectionInDesignScrollMode:s})}})),(0,q.$U)("DesignPage.Branch.BranchDesignViewNavigate")},n.prototype.componentWillUnmount=function(){this.vo=!1,this.props.Form.unobserve(this.As)},n.prototype.render=function(){var t;return t=this.state.FormReadyForDesign?g.createElement.apply(g,(0,p.ev)(["div",{className:"office-form-page-padding branch-design-view-container"},this.TH()],this.kH(),!1)):(0,Ch.t)({Message:(0,T.pm)().Common_Loading_Text}),g.createElement("div",(0,p.pi)({},this.getContainerProps()),this.createHeader(),g.createElement("div",{className:"top-view-content office-form-theme-page-background"},t))},n.prototype.pH=function(t){null===this.state.SectionInDesignScrollMode?this.setState({ElementInDesignMode:t,ElementInDesignScrollMode:null}):this.setState({ElementInDesignMode:t,SectionInDesignScrollMode:null})},n.prototype.bH=function(){this.setState({ElementInDesignMode:null,ElementInDesignScrollMode:null,SectionInDesignScrollMode:null})},n.prototype.wm=function(){return g.createElement("div",{className:"branch-design-view-title-bar"},g.createElement("div",{className:"branch-design-view-title office-form-theme-primary-foreground","aria-level":1,role:"heading"},(0,T.pm)().DesignPage_BranchingDesignViewTitle),this.xH())},n.prototype.xH=function(){var t,n=this;if(this.state.MoreOptionsExpanded){var e={ButtonStyle:1,HTMLAttributes:{autoFocus:!0,className:"branch-design-view-options-menu-item",onClick:function(){n.setState({MoreOptionsExpanded:!1}),n.props.Form.resetBranchInfo(),n.vH.current.focus()}},Text:(0,T.pm)().Branch_ResetToDefault},i=g.createElement(Fr.A,(0,p.pi)({},e));t=g.createElement("div",{className:"branch-design-view-options-menu-container"},g.createElement("div",{className:"branch-design-view-options-menu",onBlur:this.NH,onKeyDown:this.CH,ref:this.gH},i))}var r=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{"aria-expanded":this.state.MoreOptionsExpanded,className:"branch-design-view-options-button",onBlur:this.NH,onClick:this.IH,onKeyDown:this.CH},FluentIcon:"More Horizontal",IconClassName:"forms-icon-size18x18",ref:this.vH,Text:(0,T.pm)().DesignPage_BranchingDesignView_MoreOptions});return g.createElement("div",{className:"branch-design-view-options"},r,t)},n.prototype.NH=function(t){var n=this;t.persist(),window.setTimeout((function(){var e,i=n.gH.current,r=null===(e=n.vH.current)||void 0===e?void 0:e.getHtmlElement(),o=(0,Ir.y3)(t);r&&r!==o&&i&&!i.contains(o)&&n.setState({MoreOptionsExpanded:!1},(function(){r.focus()}))}),0)},n.prototype.IH=function(){this.setState({MoreOptionsExpanded:!this.state.MoreOptionsExpanded})},n.prototype.CH=function(t){var n=this;27===t.keyCode&&27===t.keyCode&&this.state.MoreOptionsExpanded&&this.setState({MoreOptionsExpanded:!1},(function(){n.vH.current.focus()}))},n.prototype.TH=function(){var t=this,n=this.props.Form,e=n.FormElementManager.HeaderTopQuestionMasters.map((function(n,e){return g.createElement(Ah,{Question:n,Active:n===t.state.ElementInDesignMode,Ordinal:e+1,key:n.Model.Id,ReadOnly:!1,setAsActive:t.pH,setAsNotActive:t.bH,NeedScroll:n===t.state.ElementInDesignScrollMode})})),i="branch-design-view office-form-theme-border-top";return n.hasSection()&&(i=(0,N.j)(i,"branch-design-view-trimmed")),g.createElement("div",{className:i,key:"headerDesigner"},this.wm(),e,g.createElement(Ka.w,{ThemeMaster:this.props.Form.ThemeMaster}))},n.prototype.kH=function(){var t=this,n=this.props.Form,e=n.FormElementManager.HeaderTopQuestionMasters.length;return n.FormElementManager.getSectionNodes().filter((function(t){return t.Section})).map((function(n,i){var r=g.createElement(Eh,{key:i,QuestionStartIndex:e,ReadOnly:!1,Active:n.Section===t.state.ElementInDesignMode,SectionIndex:i,SectionNode:n,setActive:t.pH,setNotActive:t.bH,getActive:t.wH,getScroll:t.SH,NeedSectionScroll:n.Section===t.state.SectionInDesignScrollMode});return e+=n.TopQuestionMasters.length,r}))},n.prototype.wH=function(){return this.state.ElementInDesignMode},n.prototype.SH=function(){return this.state.ElementInDesignScrollMode},n}(Mh);var _h=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.FH=function(){return n.sM()},n}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){this.sM();var t=(0,k.f5)();t.observe(this.FH,[t.Schema.ErrorBarMessage,t.Schema.ErrorLevel])},n.prototype.componentWillUnmount=function(){(0,k.f5)().unobserve(this.FH)},n.prototype.render=function(){var t=this.state.Message,n="Warning"===this.state.Level,e=(0,T.pm)();if(!t)return null;var i=(0,V.M)({FluentIcon:"Error Circle",HTMLAttributes:{className:"forms-icon-size14x14 error-message-bar-warning-icon"},key:"warningIcon"});return g.createElement("div",{id:"error-message-bar",className:"error-message-bar ".concat(n&&"error-message-bar-warning")},g.createElement("div",{className:"error-message-bar-message-alert","aria-live":"polite"},t),g.createElement("div",{className:"error-message-bar-message ".concat(n&&"error-message-bar-warning-message")},!n&&i,t,n&&g.createElement("div",{className:"error-message-bar-dismiss"},g.createElement("button",{onClick:this.PH,role:"button","aria-label":"".concat(t," ").concat(e.Common_DismissButton)},g.createElement(pc,null)))))},n.prototype.PH=function(){(0,Zs.r)(null)},n.prototype.sM=function(){var t=this,n=(0,k.f5)().Model,e=n.ErrorBarMessage,i=n.ErrorLevel;e?this.setState({Message:e,Level:i},(function(){return $("#error-message-bar").stop().fadeIn("fast")})):$("#error-message-bar").stop().fadeOut("slow",(function(){t.setState({Message:void 0})}))},n}(J.r);var Bh=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.DH=function(){return n.MH()},n.Gu=(0,k.f5)().Model,n}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){this.setState({MessageType:this.Gu.InfoBarMessageType})},n.prototype.componentDidMount=function(){this.MH();var t=(0,k.f5)();t.observe(this.DH,[t.Schema.InfoBarMessageType])},n.prototype.componentWillUnmount=function(){(0,k.f5)().unobserve(this.DH)},n.prototype.render=function(){var t=this.LH(this.state.MessageType);return t?g.createElement("div",{id:"info-message-bar",className:"info-message-bar"},g.createElement("div",{className:"info-message-bar-message"},g.createElement(V.F,{FluentIcon:"Info"}),t)):null},n.prototype.MH=function(){var t=this,n=this.Gu.InfoBarMessageType;this.LH(n)?(this.setState({MessageType:n}),$("#info-message-bar").stop().fadeIn("fast")):$("#info-message-bar").stop().fadeOut("slow",(function(){t.setState({MessageType:void 0})}))},n.prototype.LH=function(t){switch(t){case"DownloadExcelLimitReached":return(0,T.pm)().InfoBarMessage_DownloadExcel_LimitReached;case"DownloadExcelVMLimitReached":return(0,T.pm)().Error_Message_10203;default:return}},n}(J.r);var Hh=function(t){function n(n){var e=t.call(this,n)||this;e.RH="",e.DF=(0,k.f5)().Model,e.AH=!0;var i=e.DF.FormMaster;i&&i.Model.XlFileUnsynced&&(e.RH=i.Model.XlUnsyncedReason);var r=parseInt(e.RH);return e.AH=isNaN(r)?e.AH:r<=2e3,e.EH=e.EH.bind(e),e.OH=e.OH.bind(e),e._H=e._H.bind(e),e.BH=e.BH.bind(e),e}return(0,p.ZT)(n,t),n.prototype.render=function(){return(0,q.$U)("DesignPage.XLUnsyncedDialog.Render",{errorCode:this.RH}),g.createElement("div",{className:"form-introduction-dialog-div"},g.createElement("div",{className:"xl-unsynced-dialog-container"},this.GH(),this.zf(),this.qf()))},n.prototype.GH=function(){return g.createElement("div",{className:"xl-unsynced-dialog-text-container"},g.createElement("div",{className:"xl-unsynced-dialog-title"},this.VH()),g.createElement("div",{className:"xl-unsynced-dialog-content-text"},this.zH()))},n.prototype.zf=function(){return g.createElement("div",{className:"xl-unsynced-dialog-button-container"},this.QH(),this.AH?this.UH():this.$H())},n.prototype.UH=function(){return(0,Fr.E)({ButtonStyle:1,HTMLAttributes:{autoFocus:!0,className:"xl-unsynced-dialog-light-button",onClick:this.EH},Text:(0,T.pm)().XLUnsyncedDialog_OpenExcel_Button})},n.prototype.QH=function(){return(0,Fr.E)({ButtonStyle:1,HTMLAttributes:{autoFocus:!1,className:"xl-unsynced-dialog-button",onClick:this.OH},Text:(0,T.pm)().XLUnsyncedDialog_Reexport_Button})},n.prototype.$H=function(){return(0,Fr.E)({ButtonStyle:1,HTMLAttributes:{autoFocus:!0,className:"xl-unsynced-dialog-light-button",onClick:this.BH},Text:(0,T.pm)().XLUnsyncedDialog_SetSync_Button})},n.prototype.qf=function(){return(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"xl-unsynced-dialog-close-button",onClick:this._H},FluentIcon:"Dismiss",IconClassName:"xl-unsynced-dialog-close-icon forms-icon-size16x16",Text:(0,T.pm)().Common_Close_Text})},n.prototype.zH=function(){var t=function(t,n){var e=null!=n?n:(0,T.pm)();switch(t){case"1001":return e.XLUnsyncedDialog_Content_1001;case"1002":return e.XLUnsyncedDialog_Content_1002;case"1003":return e.XLUnsyncedDialog_Content_1003;case"1004":return e.XLUnsyncedDialog_Content_1004;case"1005":return e.XLUnsyncedDialog_Content_1005;case"2001":return e.XLUnsyncedDialog_Content_2001;default:return""}}("".concat(this.RH));if(t||(t=(0,T.pm)().XLUnsyncedDialog_Content),!this.AH){var n=t.split("{0}");if(2===n.length){var e=(0,T.pm)().XLUnsyncedDialog_OpenExcel_Button;return g.createElement("span",null,n[0],g.createElement("a",{style:{cursor:"pointer"},onClick:this.EH},e),n[1])}}return g.createElement("span",null,t)},n.prototype.VH=function(){var t,n,e,i=(t="".concat(this.RH),e=null!=n?n:(0,T.pm)(),"2001"===t?e.XLUnsyncedDialog_Title_2001:"");return i||(i=(0,T.pm)().XLUnsyncedDialog_Title),i},n.prototype._H=function(){(0,q.$U)("DesignPage.XLUnsyncedDialog.Close"),this.DF.ShowXLUnsyncedDialog=!1},n.prototype.EH=function(){(0,q.$U)("DesignPage.XLUnsyncedDialog.OpenExcel");var t=this.DF.FormMaster;t&&(0,ju.U8)(t.Model.Id,!1),this.AH&&this._H()},n.prototype.OH=function(){(0,q.$U)("DesignPage.XLUnsyncedDialog.ReexportExcel");var t=this.DF.FormMaster;t&&(t.SetToExporting(),(0,ju.Wr)(t.Model.Id,!1)),this._H()},n.prototype.BH=function(){(0,q.$U)("DesignPage.XLUnsyncedDialog.SetSync");var t=this.DF.FormMaster;t&&(t.Model.XlFileUnsynced=!1),this._H()},n}(J.r),Gh=function(t){function n(n){var e=t.call(this,n)||this;e.As=function(){return e.forceUpdate()};var i=(0,k.f5)().Model.FormMaster;return i&&i.observe(e.As,[F.x.Schema.YouTubeMessageBarState]),e}return(0,p.ZT)(n,t),n.prototype.componentDidUpdate=function(){var t=(0,k.f5)().Model.FormMaster;t&&t.observe(this.As,[F.x.Schema.YouTubeMessageBarState])},n.prototype.componentWillUnmount=function(){var t=(0,k.f5)().Model.FormMaster;t&&t.unobserve(this.As)},n.prototype.render=function(){var t=(0,V.M)({FluentIcon:"Dismiss",HTMLAttributes:{className:"forms-icon-size14x14 youtube-disable-message-bar-close-icon",onClick:n.closeYouTubeMessageBar},IconName:"ChromeClose",key:"closeIcon"}),e=(0,T.pm)().DesignPage_Youtube_Disabled_Message_Bar,i=g.createElement("span",{className:"youtube-disable-message-bar-message"},e),r=(0,k.f5)().Model.FormMaster;if(r&&r.Model.YouTubeMessageBarState===Fa.E.Shown){var o="youtube-disable-message-bar";return(0,vt.tq)()&&(o=(0,N.j)(o,"mobile-message-bar")),g.createElement("div",{className:o},i,t)}return null},n.closeYouTubeMessageBar=function(){var t=(0,k.f5)().Model.FormMaster.Model.Id,n=function(){var t=[],n=(0,ne.$o)().getItem(ka.N3);n&&(t=JSON.parse(n));return t}();n&&!n.indexOf(t)&&n.push(t),(0,ne.$o)().setItem(ka.N3,JSON.stringify(n)),(0,k.f5)().Model.FormMaster.Model.YouTubeMessageBarState=Fa.E.Closed},n}(J.r);var qh=function(t){function n(n){var e=t.call(this,n)||this;return e.state={ClosePopUp:!1,DisableDialogButton:!1,ShowTour:!1},e.jH=e.jH.bind(e),e.WH=e.WH.bind(e),e.KH=e.KH.bind(e),e.JH=e.JH.bind(e),e.KI=e.KI.bind(e),e.ZH=[(0,zi.Jn)("/Images/PortalMyForms/freDesign.gif"),(0,zi.Jn)("/Images/PortalMyForms/freEmail.gif"),(0,zi.Jn)("/Images/PortalMyForms/freFlow.gif"),(0,zi.Jn)("/Images/PortalMyForms/freAnalysis.gif")],e}return(0,p.ZT)(n,t),n.prototype.componentDidUpdate=function(){this.state.ShowTour&&this.YH(0)},n.prototype.render=function(){return this.state.ClosePopUp||this.props.isProUser&&!(0,ws.OT)((0,ws.b4)().Model.PortalFormsProIntroduction)?null:(this.nt=(new Date).getTime()/1e3,g.createElement("div",{className:"portal-page"},this.tG()))},n.prototype.tG=function(){return g.createElement("div",{className:"form-introduction-dialog-div"},g.createElement("div",{className:"pro-introduction-dialog-start-container"},this.state.ShowTour?this.nG():this.eG(),this.state.ShowTour&&this.rs(),this.qf()))},n.prototype.nG=function(){var t="pro-introduction-dialog-image-lower-text form-introduction-dialog-image-first-line-padding",n="pro-introduction-dialog-image-lower-text form-introduction-dialog-image-second-line-padding",e={firstLine:(0,T.pm)().FormPro_Available_Design_FREFirstLineText,heading:(0,T.pm)().FormPro_Available_Design_FRE_HeadingText,secLine:(0,T.pm)().FormPro_Available_Design_FRESecondLineText},i={firstLine:(0,T.pm)().FormPro_Available_Email_FREFirstLineText,heading:(0,T.pm)().FormPro_Available_Email_FRE_HeadingText,secLine:(0,T.pm)().FormPro_Available_Email_FRESecondLineText},r={firstLine:(0,T.pm)().FormPro_Available_Flow_FREFirstLineText,heading:(0,T.pm)().FormPro_Available_Flow_FRE_HeadingText,secLine:(0,T.pm)().FormPro_Available_Flow_FRESecondLineText},o={firstLine:(0,T.pm)().FormPro_Available_Analysis_FREFirstLineText,heading:(0,T.pm)().FormPro_Available_Analysis_FRE_HeadingText,secLine:(0,T.pm)().FormPro_Available_Analysis_FRESecondLineText};return g.createElement("div",{className:"pro-introduction-dialog-container"},g.createElement("div",{className:"pro-introduction-dialog-image-container carousel slide",id:"myCarousel","data-ride":"carousel","data-interval":"20000"},g.createElement("ol",{className:"carousel-indicators pro-carousel-indicators"},g.createElement("li",{"data-target":"#myCarousel","data-slide-to":"0",className:"active",onClick:this.WH,title:(0,T.pm)().FormPro_Available_Design_FRE_HeadingText}),g.createElement("li",{"data-target":"#myCarousel","data-slide-to":"1",onClick:this.WH,title:(0,T.pm)().FormPro_Available_Email_FRE_HeadingText}),g.createElement("li",{"data-target":"#myCarousel","data-slide-to":"2",onClick:this.WH,title:(0,T.pm)().FormPro_Available_Flow_FRE_HeadingText}),g.createElement("li",{"data-target":"#myCarousel","data-slide-to":"3",onClick:this.WH,title:(0,T.pm)().FormPro_Available_Analysis_FRE_HeadingText})),g.createElement("div",{className:"carousel-inner pro-carousel-inner"},g.createElement("div",{className:"form-introduction-dialog-title-container item active"},g.createElement("img",{className:"pro-introduction-fre-img",src:this.ZH[0],alt:"".concat(e.heading," ").concat(e.firstLine," ").concat(e.secLine),width:"100%"}),g.createElement("div",{className:"pro-introduction-dialog-image-text"},(0,T.pm)().FormPro_Available_Design_FRE_HeadingText),g.createElement("div",{className:t},(0,T.pm)().FormPro_Available_Design_FREFirstLineText),g.createElement("div",{className:n},(0,T.pm)().FormPro_Available_Design_FRESecondLineText)),g.createElement("div",{className:"form-introduction-dialog-title-container item"},g.createElement("img",{className:"pro-introduction-fre-img",src:this.ZH[1],alt:"".concat(i.heading," ").concat(i.firstLine," ").concat(i.secLine),width:"100%"}),g.createElement("div",{className:"pro-introduction-dialog-image-text"},(0,T.pm)().FormPro_Available_Email_FRE_HeadingText),g.createElement("div",{className:t},(0,T.pm)().FormPro_Available_Email_FREFirstLineText),g.createElement("div",{className:n},(0,T.pm)().FormPro_Available_Email_FRESecondLineText)),g.createElement("div",{className:"form-introduction-dialog-title-container item"},g.createElement("img",{className:"pro-introduction-fre-img",src:this.ZH[2],alt:"".concat(r.heading," ").concat(r.firstLine," ").concat(r.secLine),width:"100%"}),g.createElement("div",{className:"pro-introduction-dialog-image-text"},(0,T.pm)().FormPro_Available_Flow_FRE_HeadingText),g.createElement("div",{className:t},(0,T.pm)().FormPro_Available_Flow_FREFirstLineText),g.createElement("div",{className:n},(0,T.pm)().FormPro_Available_Flow_FRESecondLineText)),g.createElement("div",{className:"form-introduction-dialog-title-container item"},g.createElement("img",{className:"pro-introduction-fre-img",src:this.ZH[3],alt:"".concat(o.heading," ").concat(o.firstLine," ").concat(o.secLine),width:"100%"}),g.createElement("div",{className:"pro-introduction-dialog-image-text"},(0,T.pm)().FormPro_Available_Analysis_FRE_HeadingText),g.createElement("div",{className:t},(0,T.pm)().FormPro_Available_Analysis_FREFirstLineText),g.createElement("div",{className:n},(0,T.pm)().FormPro_Available_Analysis_FRESecondLineText))),g.createElement("a",{className:"left carousel-control pro-carousel-control",href:"#myCarousel","data-slide":"prev",role:"button",onClick:this.KH},g.createElement("span",{className:" ms-Icon ms-Icon--ChevronLeftMed"}),g.createElement("span",{className:"sr-only"},(0,T.pm)().FormPro_Available_Previous)),g.createElement("a",{className:"right carousel-control pro-carousel-control",href:"#myCarousel","data-slide":"next",role:"button",onClick:this.KH},g.createElement("span",{className:"ms-Icon ms-Icon--ChevronRightMed"}),g.createElement("span",{className:"sr-only"},(0,T.pm)().Common_Next_Text))),this.iG())},n.prototype.eG=function(){return g.createElement("div",null,g.createElement("div",{className:"pro-introduction-dialog-title-container"},g.createElement("div",{className:"pro-introduction-dialog-image"},g.createElement("img",{role:"presentation","aria-hidden":"true",src:(0,zi.Jn)("/Images/PortalMyForms/FormsPro_info_1.png")})),g.createElement("div",{className:"pro-introduction-dialog-title"},(0,T.pm)().Form_Introduction_Dialog_Title1.format(function(){var t=(0,c.k0)().userInfo.GivenName||(0,c.k0)().userInfo.DisplayName;t||(0,q.zU)("MissingUserName",{displayName:!!(0,c.k0)().userInfo.DisplayName,givenName:!!(0,c.k0)().userInfo.GivenName,userId:!!(0,c.k0)().userInfo.UserId});return t}())),g.createElement("div",{className:"pro-introduction-dialog-subtitle1"},this.props.isProUser?(0,T.pm)().FormPro_GetStarted_Dialog_Title1:(0,T.pm)().FormPro_Available_Dialog_Title1),g.createElement("div",{className:"pro-introduction-dialog-subtitle2"},(0,T.pm)().FormPro_Available_Dialog_Title2),g.createElement("div",{className:"pro-introduction-dialog-subtitle3",onClick:this.jH},(0,T.pm)().FormPro_Available_Dialog_Title3)),g.createElement("div",{className:"pro-introduction-dialog-container"},g.createElement("div",{className:"pro-introduction-dialog-text-container"},Vh((0,T.pm)().FormPro_Available_Dialog_Body_Text1,(0,T.pm)().FormPro_Available_Dialog_Body_Text4),Vh((0,T.pm)().FormPro_Available_Dialog_Body_Text2,(0,T.pm)().FormPro_Available_Dialog_Body_Text5),Vh((0,T.pm)().FormPro_Available_Dialog_Body_Text3,(0,T.pm)().FormPro_Available_Dialog_Body_Text6)),this.iG()))},n.prototype.qf=function(){var t=this;return(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:this.props.isProUser?"formspro-introduction-dialog-close-button":"form-introduction-dialog-close-button",onClick:function(){if(t.props.isProUser)t.KI("MFPUI_FRECloseClick");else{t.KI("PortalPage.FormIntroductionDialog.Close");var n=(0,k.f5)();n.bulkEdit((function(){n.Model.TopView="None"}))}t.setState({ClosePopUp:!0})}},FluentIcon:"Dismiss",IconClassName:"pro-introduction-dialog-close-icon forms-icon-size14x14",Text:(0,T.pm)().Common_Close_Text})},n.prototype.rs=function(){var t=this;return(0,z.F)({ButtonStyle:1,HTMLAttributes:{autoFocus:!0,className:"pro-introduction-dialog-back-button",onClick:function(){t.state.ShowTour&&t.setState({ShowTour:!1})},title:(0,T.pm)().FormPro_Available_GoBack_Button},FluentIcon:"Arrow Left",IconClassName:"top-view-back-icon forms-icon-size14x14",ref:"back-button"})},n.prototype.iG=function(){var t=this;return(0,Fr.E)({ButtonStyle:1,HTMLAttributes:{autoFocus:!0,className:this.state.DisableDialogButton?"pro-introduction-dialog-button disable":"pro-introduction-dialog-button",onClick:function(){t.props.isProUser?(t.KI("MFPUI_FREGetStartedClick"),t.setState({ClosePopUp:!0})):t.state.DisableDialogButton||(t.KI("PortalPage.ProIntroductionDialog.SwitchToFormsPro"),FormsPro.onConfirmSwitchToFormsPro(),t.setState({DisableDialogButton:!0}))}},ref:"dialogButton",Text:this.props.isProUser?(0,T.pm)().FormPro_Available_GetStarted_Button:(0,T.pm)().FormPro_Available_SwitchToPro_Button})},n.prototype.jH=function(){this.props.isProUser?(0,q.JG)({eventInfo:{Component:"ProIntroductionDialog",Geo:null!==document.getElementById("Geo")?document.getElementById("Geo").value:"",tenantId:(0,c.k0)().userInfo.TenantId,userId:(0,c.k0)().userInfo.UserId},type:"MFPUI_FRETakeTourClick"}):(0,q.$U)("PortalPage.ProIntroductionDialog.TakeTour"),this.setState({ShowTour:!0})},n.prototype.JH=function(t){var n=$(".carousel-indicators li.active").attr("data-slide-to");this.YH(n)},n.prototype.WH=function(t){var n=t.currentTarget.dataset.slideTo;this.YH(n)},n.prototype.KH=function(t){var n,e=$("#myCarousel div.active").index();t.currentTarget.classList.contains("right")?(n=(e+1)%this.ZH.length,this.YH(n)):t.currentTarget.classList.contains("left")&&(n=e-1<0?this.ZH.length-1:e-1,this.YH(n))},n.prototype.YH=function(t){var n=document.getElementsByClassName("form-introduction-fre-img")[t];null!=n&&(n.src=this.ZH[t])},n.prototype.KI=function(t){var n=(new Date).getTime()/1e3-this.nt;this.props.isProUser?((0,q.JG)({eventInfo:{Component:"ProIntroductionDialog",duration:n,Geo:null!==document.getElementById("Geo")?document.getElementById("Geo").value:"",tenantId:(0,c.k0)().userInfo.TenantId,userId:(0,c.k0)().userInfo.UserId},type:t}),(0,ws.b4)().Model.PortalFormsProIntroduction=ws.BT.toString()):(0,q.$U)(t,{duration:n})},n}(J.r);function Vh(t,n){var e=(0,V.M)({FluentIcon:"Checkmark",HTMLAttributes:{className:"forms-icon-size16x16"}});return g.createElement("div",{className:"pro-introduction-dialog-text-row"},g.createElement("div",{className:"pro-introduction-dialog-text-column"},g.createElement("div",{className:"pro-introduction-dialog-check"},e),g.createElement("div",{className:"pro-introduction-dialog-subtext"},t)),g.createElement("div",{className:"pro-introduction-dialog-text-column"},g.createElement("div",{className:"pro-introduction-dialog-check"},e),g.createElement("div",{className:"pro-introduction-dialog-subtext"},n)))}var zh=e(502),Qh=e(29482),Uh=function(t){function n(n){var e=t.call(this,n)||this;e.As=function(){return e.forceUpdate()};var i=e.props.FormLocalizedItemMaster;return i.observe(e.As,[i.Schema.formCloseMessage]),e.oG=e.oG.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.props.FormLocalizedItemMaster.unobserve(this.As)},n.prototype.render=function(){var t=this,n=this.props,e=n.FormLocalizedItemMaster.Model,i=this.props.FormLocalizedItemMaster.Model.formCloseMessage||n.Form.SettingMaster.Model.FormClosedMessage,r=!n.InEditionMode&&g.createElement("div",{className:"multi-lingual-message"},i),o=n.InEditionMode&&g.createElement("div",{className:"multi-lingual-message"},n.Form.SettingMaster.Model.FormClosedMessage);return g.createElement(_a.U.Consumer,null,(function(i){var s=i.LocalizedStrings;return g.createElement("div",{className:"multi-lingual-message-box"},g.createElement("div",{className:"multi-lingual-message-title office-form-theme-primary-color"},s.DesignPage_SettingsPane_FormClosed_Label),g.createElement("div",{className:"multi-lingual-message-edition"},o,r,n.InEditionMode&&(0,ur.ZA)({AutoFocus:!0,AutoSelection:!0,HTMLAttributes:{className:"multi-lingual-message-edition-box"},onValueChange:t.oG,Options:{HTMLPropsForInnerElement:{"aria-label":s.DesignPage_SettingsPane_FormClosed_Label}},TextFieldType:2,Value:e.formCloseMessage||""})))}))},n.prototype.oG=function(t){this.props.FormLocalizedItemMaster.Model.formCloseMessage=t},n}(J.r),$h=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){return g.createElement("div",{className:"multi-lingual-title-edition office-form-theme-focus-border"},this.sG(),this.aG())},n.prototype.sG=function(){var t,n=this,e=this.props.Ordinal;e&&(t=g.createElement("span",{className:"multi-lingual-question-ordinal"},e));var i=(0,ur.ZN)({AllowRichText:!0,AutoFocus:(0,et.pd)((function(){return!0}),et.t1),AutoSelection:!0,HTMLAttributes:{className:"multi-lingual-title-editon-text"},MaxLength:this.props.TitleLengthLimitation,MinimalHeight:(0,X.gj)(),onValueChange:this.props.onTitleValueChange,Options:{HTMLPropsForInnerElement:{"aria-label":this.props.TitleLabel}},TextFieldType:2,TextFieldLocation:{Location:(0,jo.bF)(this.props.TextFieldLocation),Scenario:1,Suffix:1},Value:(0,et.pd)((function(){return(0,ir.wg)(n.props.LingualTitle,n.props.LingualRTTitle)}),et.t1)},this.props.Form,!this.props.IsForm);return g.createElement("div",null,g.createElement("div",{className:"multi-lingual-title"},g.createElement(cr.D,{Text:(0,ir.wg)(this.props.Title,this.props.RTTitle),RenderMode:"RichText",ContainsHtml:!0})),g.createElement("div",{className:"multi-lingual-title-editon-container"},t,i))},n.prototype.aG=function(){var t=this,n=this.props.SubTitle,e=this.props.LingualSubTitle;if(n){var i=(0,ur.ZN)({AllowRichText:!0,AutoSelection:!0,HTMLAttributes:{className:"multi-lingual-subtitle-edition-box"},MaxLength:this.props.SubtitleLengthLimitation,MinimalHeight:(0,X.gj)(),onValueChange:this.props.onSubTitleValueChange,Options:{HTMLPropsForInnerElement:{"aria-label":this.props.SubTitleLabel}},TextFieldType:2,TextFieldLocation:{Location:(0,jo.bF)(this.props.TextFieldLocation),Scenario:1,Suffix:2},Value:(0,et.pd)((function(){return(0,ir.wg)(e,t.props.LingualRTSubTitle)}),et.t1)},this.props.Form,!0);return g.createElement("div",{className:"multi_lingual_subtitle_edition"},g.createElement("div",{className:"multi-lingual-title"},g.createElement(cr.D,{Text:(0,ir.wg)(n,this.props.RTSubTitle),RenderMode:"RichText",ContainsHtml:!0})),i)}},n}(J.r),jh=function(t){function n(n){var e=t.call(this,n)||this;return e.As=function(){return e.forceUpdate()},e.ig(e.props),e.uG=e.uG.bind(e),e.cG=e.cG.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillReceiveProps=function(t){this.ig(t)},n.prototype.render=function(){var t=this,n=this.ag.Model,e=this.props,i=e.Master.Model,r=e.Master.Form;return g.createElement(_a.U.Consumer,null,(function(o){var s=o.LocalizedStrings;return g.createElement("div",{"aria-label":s.Designer_Sections_DefaultDescription.format(e.Ordinal),className:"multi-lingual-section"},g.createElement("div",{className:"multi-lingual-section-header"},g.createElement("h5",{className:"multi-lingual-section-title"},s.Designer_Sections_DefaultDescription.format(e.Ordinal))),g.createElement("div",{className:"multi-lingual-section-content"},g.createElement(Aa,{DesignFocus:e.DesignFocus,Label:i.Title,Name:e.Master.Model.Id},g.createElement(Aa.Designer,null,g.createElement($h,{Title:i.Title,RTTitle:i.FormsProRTQuestionTitle,TitleLabel:s.Designer_SectionTitle,SubTitle:i.Subtitle,RTSubTitle:i.FormsProRTSubtitle,SubTitleLabel:s.Designer_SectionSubtitle,LingualTitle:n.title,LingualSubTitle:n.subtitle,LingualRTTitle:n.formsprortlocaletitle,LingualRTSubTitle:n.formsprortlocalesubtitle,onTitleValueChange:t.uG,onSubTitleValueChange:t.cG,Form:r,TextFieldLocation:"Section",TitleLengthLimitation:ki(),SubtitleLengthLimitation:(0,X.hT)(),IsForm:!1})),g.createElement(Aa.Renderer,null,g.createElement(Ba.$,{LocalizedStrings:s,HideMedia:!0,LocaleId:e.LocaleId,Master:e.Master,Ordinal:e.Ordinal}))),e.children))}))},n.prototype.ig=function(t){var n=t.Master,e=t.LocaleId;e&&(this.ag=zh.k.getQuestionResourceMaster(e,n.Model.Id,n.Form),this.ag.observe(this.As,[rr.A.Schema.title,rr.A.Schema.subtitle]))},n.prototype.uG=function(t){var n=this.ag;(0,et.pd)((function(){n.bulkEdit((function(n){(0,ir.v1)(n,t,"title","formsprortlocaletitle")}))}),et.t1)},n.prototype.cG=function(t){var n=this.ag;(0,et.pd)((function(){n.bulkEdit((function(n){(0,ir.v1)(n,t,"subtitle","formsprortlocalesubtitle")}))}),et.t1)},n}(J.r),Wh=function(t){function n(n){var e=t.call(this,n)||this;e.As=function(){return e.forceUpdate()};var i=e.props.FormLocalizedItemMaster;return i.observe(e.As,[i.Schema.thankYouMessage]),e.fG=e.fG.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.props.FormLocalizedItemMaster.unobserve(this.As)},n.prototype.render=function(){var t,n,e=this,i=this.props,r=i.FormLocalizedItemMaster.Model;t=(0,cr.q)({ContainsHtml:!0,RenderMode:"RichText",Text:r.thankYouMessage||i.Form.Model.ThankYouMessage}),n=(0,cr.q)({ContainsHtml:!0,RenderMode:"RichText",Text:i.Form.Model.ThankYouMessage});var o=!i.InEditionMode&&g.createElement("div",{className:"multi-lingual-message"},t),s=i.InEditionMode&&g.createElement("div",{className:"multi-lingual-message"},n);return g.createElement(_a.U.Consumer,null,(function(t){var n=t.LocalizedStrings;return g.createElement("div",{className:"multi-lingual-message-box"},g.createElement("div",{className:"multi-lingual-message-title office-form-theme-primary-color"},n.DesignPage_SettingsPane_CustomizeThankYou),g.createElement("div",{className:"multi-lingual-message-edition"},s,o,i.InEditionMode&&(0,ur.aQ)({AllowRichText:!0,AutoFocus:!0,AutoSelection:!0,HTMLAttributes:{className:"multi-lingual-message-edition-box"},onValueChange:e.fG,Options:{HTMLPropsForInnerElement:{"aria-label":n.DesignPage_SettingsPane_CustomizeThankYou}},TextFieldType:2,TextFieldLocation:{Location:13,Scenario:1},Value:r.thankYouMessage||""},!0)))}))},n.prototype.fG=function(t){this.props.FormLocalizedItemMaster.Model.thankYouMessage=(0,ir.gA)(t)||t},n}(J.r),Kh=function(t){function n(n){var e=t.call(this,n)||this;return e.As=function(){return e.forceUpdate()},e.hG=e.hG.bind(e),e.fm=e.fm.bind(e),e.dG=zh.k.getQuestionResourceMaster(n.LocaleId,n.Master.Model.Id,n.Master.Form),e.dG.observe(e.As,[rr.A.Schema.title,rr.A.Schema.subtitle]),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){var t=this.dG.Model.title;t&&(this.dG.Model.title=t.replace(/\s*$/,"")),this.dG.unobserve(this.As)},n.prototype.render=function(){var t=this.dG.Model,n=this.props.Master.Model;return g.createElement($h,{onSubTitleValueChange:this.fm,onTitleValueChange:this.hG,Ordinal:this.props.Ordinal,SubTitle:n.Subtitle,RTSubTitle:n.FormsProRTSubtitle,SubTitleLabel:(0,T.pm)().Designer_QuestionSubtitle,Title:n.Title,RTTitle:n.FormsProRTQuestionTitle,TitleLabel:(0,T.pm)().Designer_QuestionTitle,LingualTitle:t.title,LingualRTTitle:t.formsprortlocaletitle,LingualSubTitle:t.subtitle,LingualRTSubTitle:t.formsprortlocalesubtitle,TextFieldLocation:"".concat(this.props.Master.Model.Type),TitleLengthLimitation:(0,X.zn)(),SubtitleLengthLimitation:(0,X.ED)(),Form:this.props.Master.Form,IsForm:!1,IsCascadingLevel:!1})},n.prototype.hG=function(t){var n=this.dG;(0,et.pd)((function(){n.bulkEdit((function(n){(0,ir.v1)(n,t,"title","formsprortlocaletitle")}))}),et.t1)},n.prototype.fm=function(t){var n=this.dG;(0,et.pd)((function(){n.bulkEdit((function(n){(0,ir.v1)(n,t,"subtitle","formsprortlocalesubtitle")}))}),et.t1)},n}(J.r),Jh=function(t){function n(n){var e=t.call(this,n)||this;return e.As=function(){return e.forceUpdate()},e.props.QuestionResourceMaster.observe(e.As,[e.props.QuestionResourceMaster.Schema.choicesV1]),e.oC=e.oC.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.props.QuestionResourceMaster&&this.props.QuestionResourceMaster.unobserve(this.As)},n.prototype.render=function(){var t,n=this.props,e=n.Index,i=n.ShowAsDropdown,r=null===(t=n.QuestionResourceMaster.getChoiceV1LocalizedMaster(e))||void 0===t?void 0:t.Model,o=!i&&g.createElement("input",{"aria-label":(0,T.pm)().DesignPage_ChoiceOptionRadioBox_AriaLabel.format(e+1),disabled:!0,className:"multi-lingual-choice-icon",type:this.props.IsMultipleAnswer?"checkbox":"radio"}),s=(this.props.QuestionMaster.Model.Choices[e],(0,et.pd)((function(){return(0,ir.wg)(null==r?void 0:r.description,null==r?void 0:r.formsProDisplayRTText)}),et.t1)),a={AllowRichText:!0,AutoSelection:!0,HTMLAttributes:{className:"multi-lingual-option-textbox"},MaxLength:(0,X.Mh)(),onValueChange:this.oC,Options:{HTMLPropsForInnerElement:{"aria-label":(0,T.pm)().DesignPage_ChoiceOptionInputBox_AriaLabel}},Value:s,TextFieldLocation:{Location:3,Scenario:1,Suffix:4}},u=(0,ur.ZN)(a),c=i?"multi-answer":"multi-lingual-choice-description";return g.createElement("div",null,g.createElement("div",{className:c},g.createElement(cr.D,{Text:n.OriginalDescription,RenderMode:"RichText",ContainsHtml:!0})),g.createElement("div",null,o,u))},n.prototype.oC=function(t){var n,e=this,i=null===(n=this.props.QuestionResourceMaster.getChoiceV1LocalizedMaster(this.props.Index))||void 0===n?void 0:n.Model;i&&(0,et.pd)((function(){e.props.QuestionResourceMaster.bulkEdit((function(){(0,ir.v1)(i,t,"description","formsProDisplayRTText")}))}),et.t1)},n}(J.r),Zh=function(t){function n(n){var e=t.call(this,n)||this,i=e.props.Master,r=i.Form;return e.gG=zh.k.getQuestionResourceMaster(e.props.LocaleId,i.Model.Id,r),e}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=this;return g.createElement("div",{className:"multi-lingual-question-edition office-form-theme-focus-border"},g.createElement(Kh,{Master:this.props.Master,LocaleId:this.props.LocaleId,Ordinal:this.props.Ordinal}),g.createElement("div",{className:"multi-lingual-all-choices"},y.map(this.props.Master.Model.Choices,(function(n,e){return t.Ef(n,e)}))))},n.prototype.Ef=function(t,n){var e=this.props.Master;return g.createElement(Jh,{Index:n,IsMultipleAnswer:e.Model.ChoiceType===D.T6.MultiChoice,key:n,OriginalDescription:(0,ir.wg)(t.Description,t.FormsProDisplayRTText),QuestionMaster:e,QuestionResourceMaster:this.gG,ShowAsDropdown:e.showAsDropdown()})},n}(J.r),Xh=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=(0,V.M)({FluentIcon:"Calendar LTR",HTMLAttributes:{className:"date-snapshot-event-icon forms-icon-size22x22"}}),n=(0,T.pm)().QuestionType_DateTime_PlaceHolder.format((0,c.k0)().cultureInfo.DateTimeFormat.ShortDatePattern);return g.createElement("div",{className:"multi-lingual-question-edition"},g.createElement(Kh,{Master:this.props.Master,LocaleId:this.props.LocaleId,Ordinal:this.props.Ordinal}),g.createElement("div",{className:"multi-lingual-date-placeholder"},t,g.createElement("input",{className:"form-control",disabled:!0,placeholder:n})))},n}(J.r),Yh=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){return g.createElement("div",{className:"multi-lingual-question-edition"},g.createElement(Kh,{Master:this.props.Master,LocaleId:this.props.LocaleId,Ordinal:this.props.Ordinal}))},n}(J.r),td=function(t){function n(n){var e=t.call(this,n)||this;return e.As=function(){return e.forceUpdate()},e.props.QuestionResourceMaster.observe(e.As,[e.props.QuestionResourceMaster.Schema.choices]),e.pG=e.pG.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.props.QuestionResourceMaster&&this.props.QuestionResourceMaster.unobserve(this.As)},n.prototype.render=function(){var t=this.props.QuestionResourceMaster.getChoiceLocalizedMaster(this.props.ChoiceId).Model,n=(0,ur.ZA)({AllowRichText:!0,AutoSelection:!0,MinimalHeight:(0,X.gj)(),onValueChange:this.pG,Options:{HTMLPropsForInnerElement:{"aria-label":(0,T.pm)().DesignPage_LikertOptionInputBox_AriaLabel}},TextFieldType:2,TextFieldLocation:{Location:8,Scenario:1,Suffix:4},Value:null==t?void 0:t.description});return g.createElement("td",null,n)},n.prototype.pG=function(t){var n=this.props.QuestionResourceMaster.getChoiceLocalizedMaster(this.props.ChoiceId),e=n&&n.Model;e&&(e.description=(0,ir.gA)(t)||t)},n}(J.r),nd=function(t){function n(n){var e=t.call(this,n)||this;return e.As=function(){return e.forceUpdate()},e.gG=zh.k.getQuestionResourceMaster(n.LocaleId,n.QuestionId,n.Form),e.gG.observe(e.As,[e.gG.Schema.title]),e.yG=e.yG.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.gG&&this.gG.unobserve(this.As)},n.prototype.render=function(){var t,e,i=this.gG.Model,r=null===(e=null===(t=this.props.Form.getQuestionById(this.props.QuestionId).ParentQuestionMaster)||void 0===t?void 0:t.Model)||void 0===e?void 0:e.ChoiceGroup,o=(0,et.pd)((function(){return(0,ir.wg)(i.title,i.formsprortlocaletitle)}),et.t1),s=(0,ur.ZN)({AllowRichText:!0,AutoSelection:!0,HTMLAttributes:{},MinimalHeight:(0,X.gj)(),onValueChange:this.yG,Options:{HTMLPropsForInnerElement:{"aria-label":(0,T.pm)().Designer_LabelForLikertRowTitle,className:"muliti-lingual-statement-edition"}},TextFieldType:2,TextFieldLocation:{Location:9,Scenario:1,Suffix:1},Value:o}),a=(null==r?void 0:r.length)&&y.map(r,(function(t,e){return n.createMatrixRadio(e,t.Description)}));return g.createElement("tr",{className:"multi-lingual-statement-line"},g.createElement("td",{className:"multi-lingual-statement-edition"},s),a)},n.createMatrixRadio=function(t,n){return g.createElement("td",{key:t},g.createElement("input",{"aria-disabled":!0,"aria-label":n,className:"multi-lingual-choice-icon",disabled:!0,type:"radio"}))},n.prototype.yG=function(t){var n=this.gG;(0,et.pd)((function(){n.bulkEdit((function(n){(0,ir.v1)(n,t,"title","formsprortlocaletitle")}))}),et.t1)},n}(J.r),ed=function(t){function n(n){var e=t.call(this,n)||this,i=e.props.Master,r=i.Form;return e.gG=zh.k.getQuestionResourceMaster(e.props.LocaleId,i.Model.Id,r),e}return(0,p.ZT)(n,t),n.prototype.render=function(){return g.createElement("div",{className:"multi-lingual-question-edition office-form-theme-focus-border"},g.createElement(Kh,{Master:this.props.Master,LocaleId:this.props.LocaleId,Ordinal:this.props.Ordinal}),g.createElement("div",{className:"muliti-lingual-div-table"},g.createElement("table",{className:"multi-lingual-likert-table"},g.createElement("thead",null,this.wG(),this.SG()),g.createElement("tbody",{className:"multi-lingual-edition-content"},this.NG()))))},n.prototype.wG=function(){var t=this.props.Master.Model.ChoiceGroup;return g.createElement("tr",{className:"multi-lingual-choice-line"},g.createElement("td",null),y.map(t,(function(t){return n.createChoice(t)})))},n.createChoice=function(t){return g.createElement("td",{key:t.Id},g.createElement(cr.D,{Text:(0,ir.wg)(t.Description,t.FormsProDisplayRTText),RenderMode:"RichText",ContainsHtml:!0}))},n.prototype.SG=function(){var t=this,n=this.props.Master.Model.ChoiceGroup,e=y.map(n,(function(n){return t.CG(n)}));return g.createElement("tr",{className:"multi-lingual-choice-edition-line"},g.createElement("td",null),e)},n.prototype.CG=function(t){var n=t.Id.toString();return g.createElement(td,{ChoiceId:n,key:n,QuestionResourceMaster:this.gG})},n.prototype.NG=function(){var t=this;return this.props.Master.SubQuestionMasters.map((function(n){return t.IG(n)}))},n.prototype.IG=function(t){var n=t.Model;return[this.TG(n),this.kG(t)]},n.prototype.kG=function(t){var n=this.props.LocaleId;return g.createElement(nd,{Form:t.Form,QuestionId:t.Model.Id,LocaleId:n,key:"edition".concat(t.Model.Id)})},n.prototype.TG=function(t){var e=this.props.Master.Model.ChoiceGroup,i=g.createElement("td",null,g.createElement(cr.D,{Text:(0,ir.wg)(t.Title,t.FormsProRTQuestionTitle),RenderMode:"RichText",ContainsHtml:!0})),r=y.map(e,(function(t,e){return n.createBlankTds(e)}));return g.createElement("tr",{className:"multi-lingual-statement-line",key:"statement".concat(t.Id)},i,r)},n.createBlankTds=function(t){return g.createElement("td",{key:t})},n}(J.r),id=function(t){function n(n){var e=t.call(this,n)||this;e.As=function(){return e.forceUpdate()};var i=e.props.Master,r=i.Form;return e.gG=zh.k.getQuestionResourceMaster(e.props.LocaleId,i.Model.Id,r),e.gG.observe(e.As,[e.gG.Schema.leftDescription,e.gG.Schema.rightDescription,e.gG.Schema.formsprortlocaleldescription,e.gG.Schema.formsprortlocalerdescription]),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.gG&&this.gG.unobserve(this.As)},n.prototype.render=function(){var t=g.createElement(cs.P,{Disabled:!0,Value:void 0});return g.createElement("div",{className:"multi-lingual-question-edition office-form-theme-focus-border"},g.createElement(Kh,{Master:this.props.Master,LocaleId:this.props.LocaleId,Ordinal:this.props.Ordinal}),g.createElement("div",{className:"multi-lingual-nps-question-content"},t,this.xh()))},n.prototype.xh=function(){var t=this.props.Master.Model,n=this.gG.Model,e=(0,et.pd)((function(){return(0,ir.wg)(n.leftDescription,n.formsprortlocaleldescription)}),et.t1),i=(0,et.pd)((function(){return(0,ir.wg)(n.rightDescription,n.formsprortlocalerdescription)}),et.t1);e=(0,ir.gA)(e),i=(0,ir.gA)(i);var r=(0,et.pd)((function(){return g.createElement("div",{className:"multi-lingual-label-description"},g.createElement(cr.D,{Text:(0,ir.wg)(t.LeftDescription,t.FormsProRTLeftDescription),RenderMode:"RichText",ContainsHtml:!0}))}),et.t1),o=(0,et.pd)((function(){return g.createElement("div",{className:"multi-lingual-label-description"},g.createElement(cr.D,{Text:(0,ir.wg)(t.RightDescription,t.FormsProRTRightDescription),RenderMode:"RichText",ContainsHtml:!0}))}),et.t1),s={AllowHeightAdjustment:!0,AllowRichText:!0,MinimalHeight:(0,X.gj)(),onValueChange:this.xG.bind(this,!0),Options:{HTMLPropsForInnerElement:{"aria-label":(0,T.pm)().Designer_NPSDescription_Label.format(0)}},Placeholder:(0,T.pm)().Designer_PlaceholderForRatingDescription,Value:"",TextFieldLocation:{Location:11,Scenario:1,Suffix:3}};(0,et.pd)((function(){s.TextFieldType=0,s.Value=e}),et.t1);var a=(0,ur.ZN)(s),u={AllowRichText:!0,MinimalHeight:(0,X.gj)(),onValueChange:this.xG.bind(this,!1),Options:{HTMLPropsForInnerElement:{"aria-label":(0,T.pm)().Designer_NPSDescription_Label.format(10)}},Placeholder:(0,T.pm)().Designer_PlaceholderForRatingDescription,Value:"",TextFieldLocation:{Location:11,Scenario:1,Suffix:3}};(0,et.pd)((function(){u.TextFieldType=0,u.Value=i}),et.t1);var c=(0,ur.ZN)(u);return g.createElement("div",{className:"multi-lingual-nsp-label"},g.createElement("div",{className:"multi-lingual-left-label"},r,a),g.createElement("div",{className:"multi-lingual-right-label"},o,c))},n.prototype.xG=function(t,n){var e=this.gG;(0,et.pd)((function(){e.bulkEdit((function(e){(0,ir.v1)(e,n,t?"leftDescription":"rightDescription",t?"formsprortlocaleldescription":"formsprortlocalerdescription")}))}),et.t1)},n}(J.r),rd=function(t){function n(n){var e=t.call(this,n)||this;e.As=function(){return e.forceUpdate()};var i=e.props.Master,r=i.Form;return e.gG=zh.k.getQuestionResourceMaster(e.props.LocaleId,i.Model.Id,r),e.gG.observe(e.As,[e.gG.Schema.choices]),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.gG&&this.gG.unobserve(this.As)},n.prototype.render=function(){var t=this,n=_.d.convertToArray(this.props.Master.Model.ChoiceGroup).sort((function(t,n){return t.Order-n.Order}));return g.createElement("div",{className:"multi-lingual-question-edition office-form-theme-focus-border"},g.createElement(Kh,{Master:this.props.Master,LocaleId:this.props.LocaleId,Ordinal:this.props.Ordinal}),g.createElement("div",{className:"multi-lingual-ranking-edition"},y.map(n,(function(n){return t.FG(n)}))))},n.prototype.FG=function(t){var e=this.gG.getChoiceLocalizedMaster(t.Id.toString()).Model;return[g.createElement("div",{className:"multi-lingual-item-text",key:"description".concat(t.Id)},g.createElement(cr.D,{Text:(0,ir.wg)(t.Description,t.FormsProDisplayRTText),RenderMode:"RichText",ContainsHtml:!0})),(0,ur.ZA)({AllowRichText:!0,AutoSelection:!0,HTMLAttributes:{className:"multi-lingual-option-textbox"},key:"edition".concat(t.Id),MaxLength:(0,X.Mh)(),onValueChange:n.choiceChanged.bind(this,e),Options:{HTMLPropsForInnerElement:{"aria-label":(0,T.pm)().DesignPage_RankingOptionInputBox_AriaLabel}},Value:e&&e.description,TextFieldLocation:{Location:7,Scenario:1,Suffix:5}})]},n.choiceChanged=function(t,n){t.description=(0,ir.gA)(n)||n},n}(J.r),od=function(t){function n(n){var e=t.call(this,n)||this;e.As=function(){return e.forceUpdate()};var i=e.props.Master,r=i.Form;return e.gG=zh.k.getQuestionResourceMaster(e.props.LocaleId,i.Model.Id,r),e.gG.observe(e.As,[e.gG.Schema.leftDescription,e.gG.Schema.rightDescription,e.gG.Schema.formsprortlocaleldescription,e.gG.Schema.formsprortlocalerdescription]),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.gG&&this.gG.unobserve(this.As)},n.prototype.render=function(){return g.createElement("div",{className:"multi-lingual-question-edition office-form-theme-focus-border"},g.createElement(Kh,{Master:this.props.Master,LocaleId:this.props.LocaleId,Ordinal:this.props.Ordinal}),g.createElement("div",null,this.PG(),this.DG()))},n.prototype.DG=function(){if(this.props.Master.Model.ShowRatingLabel)return g.createElement("div",{className:"multi-lingual-label-edition"},this.AG(!0),this.AG(!1))},n.prototype.AG=function(t){var n,e,i=this.props.Master.Model,r=this.gG.Model,o=i.MinRating||1;i.RatingShape===D.le.Number?(n=t?o.toString():i.Length.toString(),e="multi-linmgual-rating-description-label-number"):(n=t?(0,T.pm)().RatingDescriptionTitle.format(o):(0,T.pm)().RatingDescriptionTitlePlural.format(i.Length),e="multi-linmgual-rating-description-label-star");var s=(0,et.pd)((function(){return(0,ir.wg)(r.leftDescription,r.formsprortlocaleldescription)}),et.t1),a=(0,et.pd)((function(){return(0,ir.wg)(r.rightDescription,r.formsprortlocalerdescription)}),et.t1),u=(0,ur.ZN)({AllowRichText:!0,HTMLAttributes:{className:"multi-lingual-range-edition-box"},MinimalHeight:25,onValueChange:this.OG.bind(this,t),Options:{HTMLPropsForInnerElement:{"aria-label":(0,T.pm)().Designer_RatingDescription_Label.format(n)}},TextFieldType:(0,et.pd)((function(){return 0}),et.t1),TextFieldLocation:{Location:5,Scenario:1,Suffix:3},Value:t?s:a}),c=(0,et.pd)((function(){return t?(0,ir.wg)(i.LeftDescription,i.FormsProRTLeftDescription):(0,ir.wg)(i.RightDescription,i.FormsProRTRightDescription)}),et.t1);return g.createElement("div",null,g.createElement("span",{className:e},n),g.createElement("div",{className:"multi-lingual-rating-range"},(0,et.pd)((function(){return g.createElement("div",{className:"multi-lingual-range-description"},g.createElement(cr.D,{Text:c,RenderMode:"RichText",ContainsHtml:!0}))}),et.t1),u))},n.prototype.PG=function(){var t=this.props.Master.Model,e=t.MinRating;switch(e||(e=1),t.RatingShape){case D.le.Number:var i=y.range(e,t.Length+1),r=i.map((function(t,n){return g.createElement("td",{className:"office-form-question-rating-title-td",key:n},t)})),o=i.map((function(t,n){return g.createElement("td",{className:"office-form-question-rating-td",key:n},g.createElement("input",{disabled:!0,type:"radio"}))}));return g.createElement("table",{className:"design-question-element"},g.createElement("tr",{className:"office-form-question-rating-tr"},r),g.createElement("tr",{className:"office-form-question-rating-tr"},o));case D.le.Smiley:return FormsPro.createSmileyRating({ContainerClass:"design-question-element",Disabled:!0,Model:this.props.Master.Model});case D.le.Star:default:return(0,hs.w)({Disabled:!0,HTMLAttributes:{className:"design-question-element"},Length:this.props.Master.Model.Length,NoTabFocus:!0,onValueChange:n.onClickStarsLine,ShowRatingLabel:!1,Value:0})}},n.prototype.OG=function(t,n){var e=this.gG;(0,et.pd)((function(){e.bulkEdit((function(e){(0,ir.v1)(e,n,t?"leftDescription":"rightDescription",t?"formsprortlocaleldescription":"formsprortlocalerdescription")}))}),et.t1)},n.onClickStarsLine=function(){},n}(J.r),sd=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){return g.createElement("div",{className:"multi-lingual-question-edition"},g.createElement(Kh,{Master:this.props.Master,LocaleId:this.props.LocaleId,Ordinal:this.props.Ordinal}))},n}(J.r);function ad(t){var n=function(t){switch(t){case"Question.Choice":return Zh;case"Question.DateTime":return Xh;case"Question.FileUpload":return Yh;case"Question.MatrixChoiceGroup":return ed;case"Question.NPS":return id;case"Question.Ranking":return rd;case"Question.Rating":return od;case"Question.TextField":return sd;default:throw Error('Type "'.concat(t,'" has not been found.'))}}(t.Master.Model.Type);if(n)return g.createElement(n,t)}var ud=e(46956),cd=e(20966),ld=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.om=g.createRef(),n._G=g.createRef(),n}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this;this.As=function(){return t.forceUpdate()};var n=F.x.Schema,e=[n.Title,n.Description,n.HasValidBranching];e=(0,nr.addIoCHeaderFontToSchemas)(e),this.props.Form.observe(this.As,e),this.props.Form.SettingMaster.Model.IsQuizMode&&this.props.Form.observe(this.As,[n.Questions]);var i=this.props.Form.getImageSettingsMaster(F.x.Schema.LogoInfo),r=(0,k.BF)().Schema;i.observe(this.As,[r.NaturalWidth,r.NaturalHeight]);var o=this.props.Form.getImageMaster(F.x.Schema.Logo),s=(0,k.Cu)().Schema;o.observe(this.As,[s.ImageProcessingStatus,s.UploadParameters])},n.prototype.componentDidMount=function(){},n.prototype.componentWillUnmount=function(){this.props.Form.unobserve(this.As),this.props.Form.getImageSettingsMaster(F.x.Schema.LogoInfo).unobserve(this.As),this.props.Form.getImageMaster(F.x.Schema.Logo).unobserve(this.As)},n.prototype.render=function(){var t,e,i=this.props.Form,r=i.Model,o=this.props.FormLocalizedItemMaster,s=(null==o?void 0:o.Model.title)||r.Title,a=(null==o?void 0:o.Model.subtitle)||r.Description,u="".concat(r.Title," ").concat((0,T.pm)().Designer_FormTitle_Label);if(a&&(u="".concat(u," ").concat(a)),r.HasValidBranching){var c=(0,T.pm)().DesignPage_HasBranching_Description;c&&(u=(0,T.pm)().Common_Fullstop.format(u,c))}document.title="".concat(r.Title," (").concat((0,T.pm)().Common_Edit_Text,") ").concat((0,T.pm)().Page_Title);var l,f=(0,Tr.p2)(this.props.HTMLAttributes,{"aria-label":u,className:(0,et.pd)((function(){return"__title-designer__ form-designer-title-view"}),et.t1)}),h="Left";if(!this.props.HideMedia){var d=i.getImageMaster(F.x.Schema.Logo),m=i.getImageSettingsMaster(F.x.Schema.LogoInfo),v=d.Model;if(!v.ErrorType&&(v.ImageProcessingStatus!==ze.nv.Idle||(0,ze.UO)(v))){var p=n.calcImageLayout(m);h=p.ImageLayout,l=g.createElement(ud.z,{ImageWidth:p.Width,ImageHeight:p.Height,ImageInfoMaster:d,ImageSettingMaster:m,ImageType:"Logo"})}}var b=[bo(this.props.Form.Model),this.BG()];return t=(0,ir.gA)((null==o?void 0:o.Model.formsprortlocaletitle)||r.FormsProRTTitle||""),e=(0,ir.gA)((null==o?void 0:o.Model.formsprortlocalesubtitle)||r.FormsProRTDescription||""),s=(0,nr.getIoCModifiedTextField)(s,!0),a=(0,nr.getIoCModifiedTextField)(a,!0),t=(0,nr.getIoCModifiedTextField)(t,!0),e=(0,nr.getIoCModifiedTextField)(e,!0),g.createElement(cd.F,{HTMLAttributes:f,HTMLPropsForInnerElement:{children:b},MediaLayout:h,Title:s,SubTitle:a,RichTitle:t,RichSubtitle:e},l)},n.prototype.BG=function(){if(this.props.Form.Model.HasValidBranching){return g.createElement("div",{className:(0,et.pd)((function(){return"office-form-branching-icon office-form-theme-primary-foreground"}),et.t1),ref:this._G},(0,V.M)({FluentIcon:"Branch",HTMLAttributes:{className:"forms-icon-size24x24"},key:"branch-icon"}))}},n.calcImageLayout=function(t){if(t.Model.NaturalWidth){var n=t.calcLogoLayout();return{Height:n.ActualHeight,ImageLayout:n.Layout===Qe.RZ.Vertical?"Top":"Left",Width:n.ActualWidth}}return{Height:(0,X.Rr)(),ImageLayout:"Left",Width:(0,X.w_)()}},n}(J.r),fd=function(t){function n(e){var i=t.call(this,e)||this;i.vk={},i.fk=new Ca,i.As=function(){return i.forceUpdate()},i.HG=i.HG.bind(i);var r=(0,k.f5)();return r.observe(i.HG,[r.Schema.Locale]),i.state={InEditionMode:3,IsLanguageNameInEditionMode:!0,LocaleId:n.getLocale()||"",LocalizedResourcesLoaded:!1,LocalizedStrings:(0,T.pm)()},i.GG=i.GG.bind(i),i.hG=i.hG.bind(i),i.qG=i.qG.bind(i),i.VG=i.VG.bind(i),i.props.Form.observe(i.As,[F.x.Schema.Title,F.x.Schema.Description,F.x.Schema.Questions,F.x.Schema.LocaleList,F.x.Schema.LocaleList[0].localeName]),i}return(0,p.ZT)(n,t),n.prototype.componentWillUpdate=function(t,n){n.LocaleId!==this.state.LocaleId&&this.zG(t.Form,n.LocaleId)},n.prototype.componentWillUnmount=function(){this.QG&&(this.QG.unobserve(this.As),this.QG=void 0),this.props.Form.unobserve(this.As),(0,k.f5)().unobserve(this.HG)},n.prototype.componentDidMount=function(){var t=this;(0,I.E)()?(this.UG(),(0,T.D1)(this.state.LocaleId).then((function(n){return t.setState({LocalizedStrings:n})}))):(0,k.f5)().showTopView("None",null)},n.prototype.render=function(){if(this.QG){this.Lr=new Qh.l(this.props.Form);var t=this.QG.Model.localeName||"";return g.createElement(_a.U.Provider,{value:this.state},g.createElement("div",(0,p.pi)({},this.getContainerProps()),this.createHeader(),g.createElement("div",{className:"top-view-content"},g.createElement("div",{className:"muliti-lingual-page-padding",onMouseDown:this.GG},g.createElement("div",{className:"multi-lingul-edition-body office-form-theme-border-top"},g.createElement("div",{className:"multi-lingual-section",key:"firstSection"},g.createElement("div",{className:"multi-lingual-language-name-container"},g.createElement("span",null,(0,T.pm)().MultiLingualEditionView_language_Name_label),g.createElement("div",{className:"multi-lingual-language-name-edition"},t)),this.$G(),this.jG()),this.WG()),this.KG(),!1,this.ZG()))))}return(0,Ch.t)({Message:(0,T.pm)().Common_Loading_Text})},n.prototype.onBackButtonClick=function(t){(0,k.f5)().Model.FlexPane="MultiLingual",t.stopPropagation(),t.preventDefault()},n.getLocale=function(){return(0,k.f5)().Model.Locale},n.prototype.HG=function(){this.setState({LocaleId:n.getLocale()||""})},n.prototype.UG=function(){var t=this,n=this.props.Form,e=this.state.LocaleId;n.ensureFieldsReady([F.x.Schema.LocalizedResources]).then((function(){t.zG(n,e),t.setState({LocalizedResourcesLoaded:!0})}))},n.prototype.zG=function(t,n){this.QG&&(this.QG.unobserve(this.As),this.QG=void 0);var e=t.Model.LocalizedResources;if(e&&e.length>0){var i=_.d.Collection.getItemWithKeyFields(e,{localeId:n});i&&(this.QG=_.d.getObjectMasterFromModel(i),this.QG&&this.QG.observe(this.As,[zh.k.Schema.localeName,zh.k.Schema.title,zh.k.Schema.subtitle]))}},n.prototype.VG=function(t){var n=this.QG;n.Model.localeName=t;var e=this.props.Form.Model.LocaleList,i=y.find(e,(function(t){return t.localeId===n.Model.localeId}));i&&(i.localeName=t)},n.prototype.jG=function(){var t=this;return this.props.Form.FormElementManager.HeaderTopQuestionMasters.map((function(n,e){return t.XG(n,e+1)}))},n.prototype.XG=function(t,n){var e=this,i=this.state.LocaleId;if(i){var r=g.createElement(_a.U.Consumer,null,(function(r){return(0,ps.n)({Disabled:!0,DisableShuffle:!0,HideMedia:!0,LocaleId:i,LocalizedStrings:r.LocalizedStrings,Master:e.qk(t),Ordinal:n})})),o=ad({LocaleId:i,Master:t,Ordinal:n});return g.createElement(Aa,{DesignFocus:this.fk,Label:t.Model.Title,Name:t.Model.Id,key:t.Model.Id},g.createElement(Aa.Designer,null,o),g.createElement(Aa.Renderer,null,r))}},n.prototype.WG=function(){var t=this,n=this.props.Form,e=n.FormElementManager.TopQuestionMasters,i=n.FormElementManager.SectionMasters,r=this.state.LocaleId;if(r&&0!==i.length)return y.map(i,(function(n,i){var o=t.props.Form.FormElementManager.findQuestionsInSection(n);return g.createElement(jh,{DesignFocus:t.fk,LocaleId:r,Master:n,Ordinal:i+1,key:i},g.createElement("div",null,o.map((function(n,i){return t.XG(n,y.indexOf(e,n)+1)}))))}))},n.prototype.qk=function(t){var n=this.vk[t.Model.Id];return n||(n=new or.r(t,this.Lr),this.vk[t.Model.Id]=n),n},n.prototype.GG=function(t){var n=t.target;n&&"muliti-lingual-page-padding"===n.className&&(this.state.InEditionMode&&3!==this.state.InEditionMode?this.setState({InEditionMode:3}):this.fk.getDefaultGrabber().grab())},n.prototype.$G=function(){var t=this,e=this.props.Form,i=e.Model,r=this.QG.Model;return g.createElement(_a.U.Consumer,null,(function(o){var s=o.LocalizedStrings;return g.createElement(Aa,{AutoFocus:!0,DesignFocus:t.fk,Label:i.Title,Name:"form-title-edition",Title:s.Designer_FormTitle_Label,key:"form-title-edition"},g.createElement(Aa.Designer,null,g.createElement($h,{Title:i.Title,RTTitle:i.FormsProRTTitle,TitleLabel:s.Designer_FormTitle,SubTitle:i.Description,RTSubTitle:i.FormsProRTDescription,SubTitleLabel:s.Designer_FormSubtitle,LingualTitle:r.title,LingualSubTitle:r.subtitle,LingualRTTitle:r.formsprortlocaletitle,LingualRTSubTitle:r.formsprortlocalesubtitle,onTitleValueChange:t.hG,onSubTitleValueChange:t.qG,TextFieldLocation:"Form",TitleLengthLimitation:ki(),SubtitleLengthLimitation:(0,X.hT)(),Form:e,IsForm:!0})),g.createElement(Aa.Renderer,null,g.createElement(ld,{Form:e,FormLocalizedItemMaster:t.QG,HideMedia:!0,onHeightChange:n.onHeightChange})))}))},n.onHeightChange=function(){},n.prototype.hG=function(t){this.QG.bulkEdit((function(n){(0,ir.v1)(n,t,"title","formsprortlocaletitle")}))},n.prototype.qG=function(t){this.QG.bulkEdit((function(n){(0,ir.v1)(n,t,"subtitle","formsprortlocalesubtitle")}))},n.prototype.KG=function(){var t=(0,nr.getIocConditionalThankyouControl)({designFocus:this.fk,formMaster:this.props.Form,formLocalizedItemMaster:this.QG,multilingual:!0});return t||(this.props.Form.Model.ThankYouMessage&&this.QG?g.createElement("div",{className:"multi-lingual-message-container office-form-theme-focus-border"},g.createElement(Aa,{DesignFocus:this.fk,Label:(0,T.pm)().DesignPage_SettingsPane_CustomizeThankYou,Name:"form-thankyouMessage-edition",key:"form-thankyouMessage-edition"},g.createElement(Aa.Designer,null,g.createElement(Wh,{Form:this.props.Form,InEditionMode:!0,FormLocalizedItemMaster:this.QG})),g.createElement(Aa.Renderer,null,g.createElement(Wh,{Form:this.props.Form,InEditionMode:!1,FormLocalizedItemMaster:this.QG})))):void 0)},n.prototype.ZG=function(){var t=this.props.Form.SettingMaster.Model;if(t.FormClosed&&t.FormClosedMessage&&this.QG)return g.createElement("div",{className:"multi-lingual-message-container office-form-theme-focus-border"},g.createElement(Aa,{DesignFocus:this.fk,Label:(0,T.pm)().DesignPage_SettingsPane_FormClosed_Label,Name:"form-closeMessage-edition",key:"form-closeMessage-edition"},g.createElement(Aa.Designer,null,g.createElement(Uh,{Form:this.props.Form,InEditionMode:!0,FormLocalizedItemMaster:this.QG})),g.createElement(Aa.Renderer,null,g.createElement(Uh,{Form:this.props.Form,InEditionMode:!1,FormLocalizedItemMaster:this.QG}))))},n.prototype.YG=function(){return null},n}(Mh),hd=e(17758),dd=function(t){function n(n){var e=t.call(this,n)||this;return e.state={CreatingCardMouseOver:!1},e.mouseOverCallback=e.mouseOverCallback.bind(e),e.mouseOutCallback=e.mouseOutCallback.bind(e),e.onClick=e.onClick.bind(e),e}return(0,p.ZT)(n,t),n.prototype.createFormCreatingCardByMode=function(){var t,n,e,i=this.props.IsQuizMode;e=this.props.IsGroupForm?i?(0,T.pm)().PortalView_NewGroupQuizTitle:(0,T.pm)().PortalView_NewGroupFormTitle:i?(0,T.pm)().PortalView_NewQuizTitle:(0,T.pm)().PortalView_NewFormTitle,t={className:"fl-new-tile fl-form-tile fl-tile"};var r={className:"fl-content",onClick:this.onClick};return this.props.IsHorizontal?t.className=(0,N.j)(t.className,"fl-form-tile-horizontal"):r.className=(0,N.j)(r.className,"glyph-button-control-vertical"),n=g.createElement(Dr.zx,{ButtonStyle:1,HTMLAttributes:r},g.createElement(V.F,{FluentIcon:i?"Quiz New":"Form New"}),g.createElement("div",{className:"fl-text"},e)),g.createElement("div",(0,p.pi)({},t),n,this.props.Menu)},n.prototype.onClick=function(){var t=this.props.IsQuizMode;this.props.IsGroupForm&&(0,q.$U)("PortalPage.GroupFormsPortal.GroupFormCreate",{isQuizMode:t}),this.props.onClick()},n.prototype.getCardDescription=function(){return null},n.prototype.getCardThemeName=function(){return null},n.prototype.getCardThemeBackgroupUrl=function(){return null},n.prototype.getCardThemePrimaryColor=function(){return null},n.prototype.getCardTitle=function(){return""},n.prototype.getCardType=function(){return""},n.prototype.createCardOwnerContent=function(){return null},n.prototype.createCardWarning=function(){return null},n.prototype.createCardTypeContent=function(){return null},n.prototype.getCardResponseCount=function(){return 0},n.prototype.mouseOverCallback=function(){this.setState({CreatingCardMouseOver:!0})},n.prototype.mouseOutCallback=function(){this.setState({CreatingCardMouseOver:!1})},n}(hd.$);function md(){}var vd=function(t){function n(n){var e=t.call(this,n)||this;return e.eq=e.eq.bind(e),e.iq=e.iq.bind(e),e}return(0,p.ZT)(n,t),n.prototype.render=function(){return g.createElement("div",{className:"portal-creating-card portal-creating-card-horizontal"},g.createElement(dd,{CreateNew:!0,focusOut:md,IsGroupForm:!1,IsHorizontal:!0,IsQuizMode:!1,onClick:this.eq}),g.createElement("div",{className:"creating-card-middle-line"}),g.createElement(dd,{CreateNew:!0,focusOut:md,IsGroupForm:!1,IsHorizontal:!0,IsQuizMode:!0,onClick:this.iq}))},n.prototype.eq=function(){this.props.createCallback("Form"),(0,q.$U)("MyTemplate.createForm",{Origin:this.props.Origin})},n.prototype.iq=function(){this.props.createCallback("Quiz"),(0,q.$U)("MyTemplate.createQuiz",{Origin:this.props.Origin})},n}(J.r),gd=function(t){function n(n){var e=t.call(this,n)||this;return e.oq=e.oq.bind(e),e.gf=e.gf.bind(e),e}return(0,p.ZT)(n,t),n.prototype.render=function(){var t={className:"template-form-card __template-form-card__",onClick:this.oq,onKeyDown:this.gf,role:"button",tabIndex:0,title:this.props.TemplateForm.Title},n={backgroundImage:"url('".concat(this.props.TemplateForm.Theme.BackgroundImage,"')")};return g.createElement("div",{className:"fl-history-tile fl-tile fl-template-tile"},g.createElement("div",(0,p.pi)({},t),g.createElement("div",{className:"image-container"},g.createElement("div",{className:"background-container",style:n})),g.createElement("div",{className:"title-container __template-form-card-title__"},this.props.TemplateForm.Title)))},n.prototype.gf=function(t){switch(t.keyCode){case 13:case 32:this.oq()}},n.prototype.oq=function(){return(0,p.mG)(this,void 0,void 0,(function(){var t,n,e=this;return(0,p.Jh)(this,(function(i){switch(i.label){case 0:return[4,wr(this.props.TemplateForm)];case 1:return t=i.sent(),(0,dh.u)(t),this.props.viewTemplate(t),t.fieldsReady([F.x.Schema.Id]).then((function(){(0,q.$U)("MyTemplate.Create",{FormId:t.Model.Id,Origin:e.props.Origin})})),(n=JSON.parse(t.Model.OtherInfo)).TemplateId=this.props.TemplateForm.TemplateId,t.Model.OtherInfo=JSON.stringify(n),(0,bs.c)().log(Fn.Ng,"MSATemplateClick"),[2]}}))}))},n}(J.r),pd=function(t){function n(n){var e=t.call(this,n)||this;return e.aq=gr,e.state={Templates:[]},e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this;yr().then((function(n){t.setState({Templates:n}),"PortalView"===t.props.Origin&&t.props.updateTemplateList&&t.props.updateTemplateList()}))},n.prototype.render=function(){return this.state.Templates.length?g.createElement("div",{style:{display:"inline"}},this.createTemplateCard()):g.createElement(Z.z,{className:"template-loading",key:"template-loading",src:"/Images/LoadingBlackSpinner.gif"})},n.prototype.createTemplateCard=function(){var t,n=this;return t=!this.props.Quota&&this.aq&&"PortalView"===this.props.Origin?this.aq:this.props.Quota||this.state.Templates.length,this.state.Templates.slice(0,t).map((function(t){return g.createElement(gd,{key:t.Title,Origin:n.props.Origin,TemplateForm:t,viewTemplate:n.props.viewTemplateHandler})}))},n}(J.r),bd=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){return g.createElement("div",{className:"template-gallery-container __portal-template-gallery-container__"},g.createElement("div",{className:"portal-tiles template-gallery"},this.rs(),g.createElement(vd,{createCallback:this.props.createFormCallback,Origin:"TemplateGallery"}),g.createElement(pd,{key:"TemplateGallery",Origin:"TemplateGallery",Quota:0,viewTemplateHandler:this.props.viewTemplateHandler})))},n.prototype.rs=function(){var t=(0,z.F)({ButtonStyle:1,HTMLAttributes:{"aria-label":(0,T.pm)().Common_Back_Text,autoFocus:!0,className:"template-gallery-back-button office-form-theme-button-color __template-gallery-back-button__",onClick:this.props.backToPortalViewPageHandler,title:(0,T.pm)().Common_Back_Text},FluentIcon:"Arrow Left",IconClassName:"top-view-back-icon forms-icon-size27x27",ref:"back-button"});return g.createElement("div",{"aria-label":(0,T.pm)().MSATemplate_SelectTemplate,className:"template-top-view-header",role:"navigation"},t,g.createElement("span",{className:"top-view-title-text"},(0,T.pm)().MSATemplate_SelectTemplate))},n}(J.r);function yd(){return g.createElement("div",{className:"analyze-view-placerholder"},(0,Ch.t)({Message:(0,T.pm)().Common_Loading_Text}))}function wd(t){var n=(0,k.f5)();n.bulkEdit((function(){return t(n)}))}var Sd=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=(0,N.j)((0,vt.un)()?"edge":void 0,(0,vt.w1)()?"ie":void 0,(0,vt.tH)()?"firefox":void 0);return g.createElement("div",{className:t},g.createElement("div",(0,p.pi)({},this.getContainerProps()),this.createHeader(this.createAdditionalTopViewHeaderElements()),(0,dt.GF)()&&window.parent&&Xs({Form:this.props.FormMaster}),g.createElement("div",{className:"top-view-content"},g.createElement("div",{className:"form-content-container"},g.createElement("div",{className:"office-form-content office-form-page-padding"},g.createElement("div",{className:"office-form office-form-theme-shadow office-form-theme-border-top grading-design-view",id:"scrollAnchor",role:"main"},this.renderView()))))))},n.prototype.createAdditionalTopViewHeaderElements=function(){return null},n.prototype.includeTheme=function(){return g.createElement(Ka.w,{ThemeMaster:this.props.FormMaster.ThemeMaster})},n.prototype.onBackButtonClick=function(){wd((function(t){t.Model.Grading?t.Model.Grading.GoBackToView===zu.GoBackToAnalysis?(t.Model.Grading=void 0,t.Model.Analysis=!0):t.Model.Grading.GoBackToView===zu.GoBackToReleaseResults&&(t.Model.Grading=void 0,t.Model.TopView="Grading_PostGrades"):t.Model.Analysis=!0}))},n}(Mh),Nd=void 0,Cd=e(84154),Id=function(){function t(t){this.lq=[],this.mq=[],this.vq=[],this.pq=t}return t.prototype.calculateBranchedResponses=function(){var n=t.getBranchedQuestionsForAllResponses(this.pq,this.vq);n&&n.length>0&&(this.mq=this.mq.concat(n),this.lq=t.getBranchedResponses(this.pq,this.mq)),this.vq=this.mq.map((function(t){return t&&t.field_id}))},t.getBranchedResponses=function(n,e){return y.map(n.Model.Responses,(function(n){return t.getBranchedResponse(e,n)}))},t.getBranchedQuestionsForAllResponses=function(t,n){var e=y.map(t.Model.Responses,(function(n){return Uu.getResponseWithIndexableQuestion(n,t)})),i=e;return n.length>0&&(i=e.filter((function(t){return!(t.field_id in n)}))),Uu.getBranchedQuestions(t,i)},t.getBranchedResponse=function(n,e){var i=y.extend(e);return i.Answers=t.getAnswersInBranch(n,i),i},t.getAnswersInBranch=function(t,n){var e=y.findWhere(t,{field_id:n.Id}),i=null==e?void 0:e.branchedQuestions;return void 0===e&&(0,q.$U)("DesignPage.QuizReview.ResponseNotFound",{lengthOfAllResponses:t.length}),y.filter(n.Answers,(function(t){return null!=y.findWhere(i,{Id:t.QuestionId})}))},t.prototype.addGeneralFeedback=function(t,n){if(n!==Nd){var e=(0,Cd.ck)(this,t);if(e)e.Feedback!==n&&(this.pq.setResponseComment(t,n),e.Feedback=n)}},t.prototype.addAnswerFeedbacks=function(t,n,e,i,r){var o=this;if(e!==Nd||i!==Nd){var s=!1;this.pq.bulkEdit((function(){t.forEach((function(t){var r=(0,Cd.Es)(o,t,n);if(r){var a,u,c=!1;e!==Nd&&(a=e)!==r.Score&&(c=!0,r.Score=a),i!==Nd&&(u=i)!==r.Feedback&&(c=!0,r.Feedback=u),c&&(o.pq.setAnswerGrading(t,n,a,u),s=!0)}}))})),s&&r&&r()}},t.prototype.markAsReleased=function(t){this.pq.setReleaseDate(t,new Date)},t.prototype.onDeleteResponse=function(t){this.lq=y.without(this.lq,y.findWhere(this.lq,{Id:t})),this.mq=y.without(this.mq,y.findWhere(this.mq,{field_id:t})),this.vq=this.vq.filter((function(n){return n!==t}))},t.prototype.ensureReadyToGrade=function(){var t=this,n=F.x.Schema;return this.pq.ensureFieldsReady([n.Responses,n.Title,n.Questions,n.DescriptiveElements,n.Theme,n.ResponsesCount,n.ModifiedDate]).then((function(){if(t.pq.Model.QuizPreviousResponsesCount!==t.pq.Model.ResponsesCount)return t.pq.bulkEdit((function(){t.pq.Model.QuizPreviousResponsesCount=t.pq.Model.ResponsesCount})),t.pq.syncFormResponses()}))},t.prototype.getResponses=function(){return this.lq},t.prototype.getQuestions=function(){return _.d.convertToArray(this.pq.Model.Questions)},t.prototype.getTitle=function(){var t=this.pq;return t.isFieldReady(F.x.Schema.FormsProRTTitle)?(0,ir.wg)(t.Model.Title,t.Model.FormsProRTTitle):t.Model.Title},t.prototype.getWrappedForm=function(){return this.pq},t.prototype.getBranchedQuestions=function(){return this.mq},t}();function Td(t){return null==t.Score}function kd(t){if(y.isString(t))return(0,ii.bC)(t)}var xd=e(19843);function Fd(t,n){var e=n.Model,i={},r={};return t.forEach((function(t){var o=n.SubQuestionMasters.length?void 0:(0,xd.Es)(t,e.Id),s={Response:t,Answer:o};if(o){var a=function(t){if(null==t.Answer)return"";var n=kd(t.Answer.Answer),e=null!=n?n.trim():void 0,i=null!=t.Answer.Score?t.Answer.Score:void 0,r=null!=t.Answer.Feedback?t.Answer.Feedback:void 0;return"".concat(e,"-").concat(i,"-").concat(r)}(s);i[a]||(i[a]=[]),i[a].push(s),n.isCorrectAnswer(o.Answer)&&(r[a]=!0)}})),y.object(y.sortBy(y.pairs(i),(function(t){var n=t[0],e=t[1],i=r[n],o=function(t,n){if(null==t.Answer)return"";var e,i=kd(t.Answer.Answer),r=null!=i?i.trim():void 0;e=n?"1":null!=r&&""!==r?"5":"9";return e+r}(e[0],i);return o})))}function Pd(t){return"Question.Choice"===t.Type||"Question.DateTime"===t.Type||"Question.Rating"===t.Type||"Question.TextField"===t.Type&&!t.Multiline||"Question.Ranking"===t.Type||"Question.MatrixChoiceGroup"===t.Type||"Question.FileUpload"===t.Type}var Dd=function(){return function(){}}();var Md=function(t){function n(n,e){var i=t.call(this)||this;return i.yq=0,i.wq=y.pairs(n),i.Sq=e||function(t){return!0},i}return(0,p.ZT)(n,t),n.prototype.hasNext=function(){for(var t=!1;this.yq<this.wq.length;){var n=this.wq[this.yq][1][0].Answer,e=n?kd(n.Answer):void 0;if(this.Sq(e)){t=!0;break}this.yq++}return t},n.prototype.next=function(){var t=this.wq[this.yq][1],n=t[0].Answer,e=this.yq;return this.yq++,{answerAndResponses:t,answer:n,answerRenderOrderIndex:e}},n}(Dd),Ld=function(t){function n(n,e){return t.call(this,n,(function(t){return e.isCorrectAnswer(t)}))||this}return(0,p.ZT)(n,t),n}(Md),Rd=function(t){function n(n,e){return t.call(this,n,(function(t){return!e.isCorrectAnswer(t)}))||this}return(0,p.ZT)(n,t),n}(Md),Ad=function(t){function n(n,e){var i=t.call(this)||this;return i.Nq=0,i.nn=n,i.Cq=e,i}return(0,p.ZT)(n,t),n.prototype.hasNext=function(){for(var t=null;this.Nq<this.nn.getResponses().length;){var n=this.nn.getResponses()[this.Nq],e=this.nn.getWrappedForm().getQuestionById(this.Cq).Model;if(t=(0,xd.Es)(n,this.Cq),"Question.MatrixChoiceGroup"===e.Type&&(t=""),null!=t)break;this.Nq++}return null!=t},n.prototype.next=function(){var t=this.nn.getResponses()[this.Nq],n=(0,xd.Es)(t,this.Cq),e=this.Nq;return this.Nq++,{response:t,answer:n,answerRenderOrderIndex:e}},n}(Dd),Ed=function(t){function n(n,e){var i=t.call(this)||this;i.Iq=0,i.nn=n,i.Oi=e,i.Tq=[];var r=y.findWhere(n.getBranchedQuestions(),{field_id:e.Id});return r&&(i.Tq=r.branchedQuestions.filter((function(t){return!t.GroupId}))),i}return(0,p.ZT)(n,t),n.prototype.hasNext=function(){return this.Iq<this.Tq.length},n.prototype.next=function(){var t,n=this,e=this.Tq[this.Iq],i=this.Iq;if("Question.MatrixChoiceGroup"===e.Type){var r=this.nn.getWrappedForm().getQuestionById(e.Id),o=y.map(r.SubQuestionMasters,(function(t){return t.Model.Id})),s=y.filter(y.map(o,(function(t){return y.find(n.Oi.Answers,(function(n){return n.QuestionId===t}))})),(function(t){return!!t}));s.length&&((t=y.clone(s[s.length-1])).QuestionId=e.Id,t.Answer=s)}else t=(0,xd.Es)(this.Oi,e.Id);this.Iq++,t=t||{Answer:null,Feedback:null,IsAutoGraded:!1,IsMathAnswer:!1,Score:0,QuestionId:e.Id};var a=y.filter(this.nn.getQuestions(),(function(t){return!t.GroupId})),u=y.findIndex(a,(function(t){return t.Id===e.Id}));return{question:e,answerRenderOrderIndex:i,unbranchedQuestionIndex:u,answer:t}},n}(Dd),Od=e(85962),_d=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=this.props.formula;if(""===t)return g.createElement("div",{className:"gradingQuestionNoAnswerGiven"},(0,T.pm)().GradingView_NoAnswerGiven_Label);if(void 0!==this.props.specialCorrectnessStyle){var n=void 0,e=void 0,i="",r=" gradingOptionCorrectnessIcon forms-icon-size16x16";"correct"===this.props.specialCorrectnessStyle?(n="gradingOptionIsCorrect",e={HTMLAttributes:{"aria-hidden":!0,className:"office-form-right-answerkey office-form-answerkey"+r,role:"presentation"},IconName:"CheckMark"},i=(0,T.pm)().GradingView_CorrectAnswer_AccessibilityLabel):(n="gradingOptionIsNotCorrect",e={FluentIcon:"Dismiss",HTMLAttributes:{"aria-hidden":!0,className:"office-form-wrong-answerkey office-form-answerkey"+r,role:"presentation"}},i=(0,T.pm)().GradingView_IncorrectAnswer_AccessibilityLabel);var o=(0,V.M)(e);return g.createElement("div",{className:"gradingPlainTextAnswer gradingShortTextAnswerCorrectnessBox "+n},(0,er.Rq)({Formula:t}),g.createElement("a",{className:"screenReaderVisible"},i),o)}return g.createElement("span",{className:"gradingPlainTextAnswer"},(0,er.Rq)({Formula:t}))},n}(J.r);var Bd=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=this.props.Answer.Answer;if(!t&&0!==t)return g.createElement("div",{className:"gradingQuestionNoAnswerGiven"},(0,T.pm)().GradingView_NoAnswerGiven_Label);var n=Number("".concat(t)),e=(0,ir.wg)(this.props.LeftDescription,this.props.FormsProRTLeftDescription),i=(0,ir.wg)(this.props.RightDescription,this.props.FormsProRTRightDescription);return g.createElement("div",null,g.createElement(cs.P,{ClassNameForInnerLabel:"office-form-theme-button-foreground",Disabled:!0,LeftLabel:e,RightLabel:i,Value:n}),g.createElement("a",{className:"screenReaderVisible"},(0,T.pm)().GradingView_NPSAnswerFormat.format(1)))},n}(J.r);function Hd(t,n,e,i,r,o,s){var a=(0,O.GW)(),u=Gd(t),c=(0,Y.P)(n,t);c.IsLegacyChoiceAnswer&&i&&(0,q.$U)(i);var l=c.IsLegacyChoiceAnswer||c.IsSingleChoiceAnswer?"radio":"checkbox",f=y.map(t.Choices,(function(t,n){var i,r,f=c.SelectedOptions.some((function(n){return n===t.Description})),h=g.createElement("input",{disabled:!0,type:l,name:c.IsSingleChoiceAnswer?a:void 0,checked:f}),d="",m="";if(u){var v=void 0,b=void 0;m=(0,T.pm)().GradingView_IncorrectAnswer_AccessibilityLabel,t.IsAnswerKey?(v="office-form-right-answerkey office-form-answerkey gradingOptionCorrectnessIcon forms-icon-size16x16",b="Checkmark",d=f?o:"",m=(0,T.pm)().GradingView_CorrectAnswer_AccessibilityLabel):f&&(v="office-form-wrong-answerkey office-form-answerkey gradingOptionCorrectnessIcon forms-icon-size16x16",b="Dismiss",d=s),r={FluentIcon:b,HTMLAttributes:{className:v,"aria-hidden":!0,role:"presentation"}},i=(0,V.M)(r)}var y={className:(0,N.j)(l,e,d),key:n},w=Do(t),S="".concat(w," . ").concat(m);return g.createElement("div",(0,p.pi)({},y),g.createElement("label",null,h,g.createElement("span",{role:"presentation","aria-hidden":"true"},w)),g.createElement("a",{className:"screenReaderVisible"},S),i)}));return f.push.apply(f,function(t,n,e,i,r){var o=Gd(t),s=(0,N.j)(n.IsSingleChoiceAnswer?"radio":"checkbox",e,o?r:""),a=g.createElement("input",{disabled:!0,type:n.IsSingleChoiceAnswer?"radio":"checkbox",checked:!0}),u=(0,V.M)({FluentIcon:"Dismiss",HTMLAttributes:{className:"office-form-wrong-answerkey office-form-answerkey forms-icon-size14x14".concat(i)}}),c=o?u:void 0,l=y.map(t.Choices,(function(t){return t.Description}));return y.difference(n.SelectedOptions,l).map((function(t,n){var e=(0,cr.q)({Text:t,RenderMode:"RichText"});return g.createElement("div",{className:s,key:n+l.length},g.createElement("label",{},a,e,c))}))}(t,c,e,r,s)),f}function Gd(t){return t.IsQuiz&&y.some(t.Choices,(function(t){return t.IsAnswerKey}))}var qd=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=this.props.answer,n=this.props.question;return n.Choices&&n.Choices.length>0||null!=t?g.createElement("div",null,Hd(n,t.Answer,"gradingChoiceAnswerOption",void 0,"gradingOptionCorrectnessIcon","gradingOptionIsCorrect","gradingOptionIsNotCorrect")):g.createElement("div",null,g.createElement("span",{className:"noChoices"},(0,T.pm)().GradingView_NoChoices_Message))},n}(J.r);var Vd=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.kq=y.uniqueId("likert_"),n}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=this.PC(),n=this.Fq();return g.createElement("table",{className:"office-form-matrix-table",key:"Likert"},t,n)},n.prototype.PC=function(){var t=this,n=this.props.question.Model.ChoiceGroup,e=g.createElement("td",{className:"office-form-matrix-ptd",key:"emptyTd"}),i=[];i.push(e);var r={width:80/n.length+"%",className:"office-form-matrix-ptd"},o=y.map(n,(function(n,e){r.id=t.Dq(e);var i=g.createElement(cr.D,{Text:(0,ir.wg)(n.Description,n.FormsProDisplayRTText),RenderMode:"RichText",ContainsHtml:!0});return g.createElement("td",(0,p.pi)({},r,{key:e}),i)}));i=i.concat(o);var s=g.createElement("tr",{className:"office-form-matrix-ptr"},i);return g.createElement("thead",{className:"office-form-matrix-pthead"},s)},n.prototype.Fq=function(){var t=this,n=this.props.question,e=n.Model.ChoiceGroup,i=n.SubQuestionMasters,r=y.map(i,(function(n,i){var r=n.Model,o=[],s=g.createElement("span",{className:"office-form-matrix-subquestion"},g.createElement(cr.D,{Text:(0,ir.wg)(r.Title,r.FormsProRTQuestionTitle),RenderMode:"RichText",ContainsHtml:!0})),a=g.createElement("td",{className:"office-form-matrix-std",key:"subQuestionTitle"},s);o.push(a);var u=y.map(e,(function(n,e){return t.Mq(i,e,n.Description)}));o=o.concat(u);var c={className:"office-form-matrix-str",key:i};return g.createElement("tr",(0,p.pi)({},c),o)}));return g.createElement("tbody",{className:"office-form-matrix-stbody"},r)},n.prototype.Mq=function(t,n,e){var i,r,o=this.props.question,s=o.Model.ChoiceGroup,a=o.SubQuestionMasters[t].Model.Id,u=this.props.answer.Answer,c=y.filter(u,(function(t){return t.QuestionId===a}));return r=s[n].Id,i=c.length>0&&y.isEqual(c[0].Answer.id,r),g.createElement("td",{className:"office-form-matrix-radio",key:n},g.createElement("label",{className:"office-form-matrix-label"},g.createElement("input",{"aria-labelledby":this.Dq(n),"aria-posinset":n+1,"aria-setsize":s.length,type:"radio","aria-checked":i,checked:i})))},n.prototype.Dq=function(t){return"".concat(this.kq,"-col-").concat(t)},n}(J.r),zd=e(99202);function Qd(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]}var Ud=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=this.props;if(!!!t.answer.Answer)return g.createElement("div",{className:"gradingQuestionNoAnswerGiven"},(0,T.pm)().GradingView_NoAnswerGiven_Label);var n=Number("".concat(t.answer.Answer)),e=y.uniqueId("numberAnswerDesciption."),i=(0,zd.w)({HTMLAttributes:{className:"gradingNumberRatingAnswer rating-".concat(t.maxRating)},Disabled:!0,Value:n,onValueChange:Qd,Length:t.maxRating,ShowRatingLabel:t.showRatingLabel,LeftDescription:t.leftDescription,RightDescription:t.rightDescription,FormsProRTLeftDescription:t.formsProRTLeftDescription,FormsProRTRightDescription:t.formsProRTRightDescription});return g.createElement("div",{"aria-labelledby":e},g.createElement("div",{id:e,className:"screenReaderVisible"},(0,T.pm)().GradingView_RatingAnswer_LabelFormat.format(n,t.maxRating)),g.createElement("div",{"aria-hidden":"true",role:"presentation"},i))},n}(J.r);var $d=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=this.props.text;if(null==t||""===t)return g.createElement("div",{className:"gradingQuestionNoAnswerGiven"},(0,T.pm)().GradingView_NoAnswerGiven_Label);var n=(0,cr.q)({Text:t,RenderMode:"RichText"});if(null!=this.props.specialCorrectnessStyle){var e=void 0,i=void 0,r="";"correct"===this.props.specialCorrectnessStyle?(e="gradingOptionIsCorrect",i={HTMLAttributes:{className:"office-form-right-answerkey office-form-answerkey gradingOptionCorrectnessIcon forms-icon-size16x16","aria-hidden":!0,role:"presentation"},IconName:"CheckMark"},r=(0,T.pm)().GradingView_CorrectAnswer_AccessibilityLabel):(e="gradingOptionIsNotCorrect",i={FluentIcon:"Dismiss",HTMLAttributes:{className:"office-form-wrong-answerkey office-form-answerkey gradingOptionCorrectnessIcon forms-icon-size16x16","aria-hidden":!0,role:"presentation"}},r=(0,T.pm)().GradingView_IncorrectAnswer_AccessibilityLabel);var o=(0,V.M)(i);return g.createElement("div",{className:"gradingPlainTextAnswer gradingShortTextAnswerCorrectnessBox "+e},n,g.createElement("a",{className:"screenReaderVisible"},r),o)}return g.createElement("span",{className:"gradingPlainTextAnswer"},n)},n}(J.r);var jd=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=this,n=this.props.question.ChoiceGroup,e=_.d.convertToArray(n),i=this.props.answer.Answer.sort((function(t,n){return t.answerOrder-n.answerOrder})),r=(JSON.parse(this.props.question.GradingBasis)||[]).map((function(t){return y.findWhere(n,{Key:t})})),o=r.map((function(t){return t.Id})),s=y.map(i,(function(n,i){var r,s=o[i]&&o[i]===n.id,a=null===(r=y.find(e,(function(t){return t.Id===n.id})))||void 0===r?void 0:r.FormsProDisplayRTText,u=(0,ir.wg)(n.displayText,a);return t.Lq(u,s)})),a=r.map((function(t){return(0,ir.wg)(t.Description,t.FormsProDisplayRTText)})),u=!1,c=i.map((function(t){return t.id}));y.isEqual(c,o)&&(u=!0);var l=a.join((0,T.pm)().VariousLocations_ItemList_Separator),f=!u&&g.createElement("div",{className:"gradingByStudentShortTextCorrectAnswerList various-short-text-correct-answer-list"},g.createElement("b",null,(0,T.pm)().GradingView_CorrectAnswer_AccessibilityLabel,": "),g.createElement(cr.D,{Text:l,RenderMode:"RichText",ContainsHtml:!0}));return g.createElement("div",null,g.createElement("div",{className:"gradingByStudentAnswerContainer gradingAnswerContainer"},s),f)},n.prototype.Lq=function(t,n){var e="office-form-answerkey gradingOptionCorrectnessIcon forms-icon-size16x16",i={FluentIcon:n?"Checkmark":"Dismiss",HTMLAttributes:{className:e=(0,N.j)(e,n?"office-form-right-answerkey":"office-form-wrong-answerkey")}},r=(0,V.M)(i),o="checkbox gradingChoiceAnswerOption",s=n?"gradingOptionIsCorrect":"gradingOptionIsNotCorrect";o=(0,N.j)(o,s);var a=g.createElement("span",{className:"inline-display"},g.createElement(cr.D,{Text:t,RenderMode:"RichText",ContainsHtml:!0}));return g.createElement("div",{className:o,key:t},a,r)},n}(J.r);var Wd=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.Aq=function(t){var n=t.Answer;return n>20?20:n<0?0:n},n.prototype.render=function(){var t=this.props;if(!t.answer.Answer)return g.createElement("div",{className:"gradingQuestionNoAnswerGiven"},(0,T.pm)().GradingView_NoAnswerGiven_Label);var n=this.Aq(t.answer),e=y.uniqueId("starAnswerDesciption."),i={Disabled:!0,HTMLAttributes:{className:"stars-container"},Length:t.maxRating,onValueChange:void 0,Value:n,LeftDescription:t.leftDescription,RightDescription:t.rightDescription,FormsProRTLeftDescription:t.formsProRTLeftDescription,FormsProRTRightDescription:t.formsProRTRightDescription,LeftDescriptionTitle:"1",RightDescriptionTitle:t.maxRating+"",ShowRatingLabel:t.showRatingLabel,NoTabFocus:!0},r=(0,hs.w)(i);return g.createElement("div",{"aria-labelledby":e},g.createElement("div",{id:e,className:"screenReaderVisible"},(0,T.pm)().GradingView_StarAnswerFormat.format(n,t.maxRating)),r)},n}(J.r);function Kd(t,n,e,i){var r=t.Model;e=e||[];var o,s=r.Type,a=y.contains(e,s);if("Question.Rating"===s&&!a){if(r.RatingShape===D.le.Number){var u={answer:n.Answer,maxRating:r.Length,showRatingLabel:r.ShowRatingLabel,leftDescription:r.LeftDescription,rightDescription:r.RightDescription,formsProRTLeftDescription:r.FormsProRTLeftDescription,formsProRTRightDescription:r.FormsProRTRightDescription};return o=u,g.createElement(Ud,(0,p.pi)({},o))}return function(t){return g.createElement(Wd,(0,p.pi)({},t))}({answer:n.Answer,maxRating:r.Length,showRatingLabel:r.ShowRatingLabel,leftDescription:r.LeftDescription,rightDescription:r.RightDescription,formsProRTLeftDescription:r.FormsProRTLeftDescription,formsProRTRightDescription:r.FormsProRTRightDescription})}if("Question.Choice"===s&&!a)return function(t){return g.createElement(qd,(0,p.pi)({},t))}({question:r,answer:n.Answer});if("Question.Ranking"===s&&!a)return function(t){return g.createElement(jd,(0,p.pi)({},t))}({question:r,answer:n.Answer});if("Question.MatrixChoiceGroup"===s&&!a)return function(t){return g.createElement(Vd,(0,p.pi)({},t))}({question:t,answer:n.Answer});if("Question.FileUpload"===s){var c=n.Answer.Answer;return null===c||""===c?g.createElement("div",{className:"gradingQuestionNoAnswerGiven"},(0,T.pm)().GradingView_NoAnswerGiven_Label):JSON.parse(c).map((function(t){var n=(0,L.LP)(t.name);return g.createElement("div",{className:"gradingQuestionFileName",key:t.id},n,g.createElement("a",{className:"gradingQuestionFileLink",href:t.link,rel:"noreferrer",target:"_blank"},t.name))}))}if("Question.NPS"===s)return function(t){return g.createElement(Bd,(0,p.pi)({},t))}({Answer:n.Answer,LeftDescription:r.LeftDescription,RightDescription:r.RightDescription,FormsProRTLeftDescription:r.FormsProRTLeftDescription,FormsProRTRightDescription:r.FormsProRTRightDescription});var l,f=n.CorrectAnswer;if("Question.TextField"===s&&!r.Multiline){var h=new it.E(r).getAnswers();f=1===h.length?h[0].answer:void 0}"Question.TextField"===s&&i&&!r.Multiline&&r.IsQuiz&&(new it.E(r).areAnyAnswersDefined()&&(l=t.isCorrectAnswer(kd(n.Answer.Answer))?"correct":"incorrect"));return r.IsMathQuiz&&n.Answer.IsMathAnswer?g.createElement(_d,{formula:n.Answer.Answer,specialCorrectnessStyle:l}):function(t){return g.createElement($d,(0,p.pi)({},t))}({text:Jd(kd(n.Answer.Answer),r),correctText:Jd(f,r),isChoiceQuestion:"Question.Choice"===s,specialCorrectnessStyle:l})}function Jd(t,n){if(null==t)return t;var e=(0,Y.P)(String(t),n).SelectedOptions;if("Question.Ranking"===n.Type){var i=n.ChoiceGroup;if(t&&""!==t)return JSON.parse(t).map((function(t,n){var e=_.d.Collection.getItemWithKeyFields(i,{Id:t});if(e)return e.Description})).filter((function(t){return!!t})).join(", ")}else{if("Question.DateTime"!==n.Type)return e.join(", ");if(t&&""!==t)return Date.parseDate(t,(0,X.gC)(),(0,c.k0)().cultureInfo).toDateShortString((0,c.k0)().cultureInfo)}}function Zd(t){return g.createElement(Yd,(0,p.pi)({},t))}function Xd(t){return(0,Od.u)(t).toString()}var Yd=function(t){function n(n){var e=t.call(this,n)||this;e.Eq=new Ye.u((function(){var t=e.state.FeedbackValue;e.props.FeedbackUpdate(""===t?null:t)}),1e3),e.Uf=g.createRef(),e.state={FeedbackValue:(0,ir.gA)(n.StoredFeedback)||n.StoredFeedback,IsExpanded:!!n.StoredFeedback,IsInternetExplorerPageLoaded:!1,CurrentFeedbackId:n.Id},e.Oq=(0,T.pm)().GradingView_FeedbackInputPlaceholder_LabelFormat.format((0,X.LY)());var i=y.clone(e.props.HTMLAttributes)||{};i.className=i.className||"feedbackInput";var r=Qd;if(!e.props.Readonly){var o=i.onBlur;i.onBlur=function(t){null!=o&&o(t);var n=e.state.FeedbackValue;null!=n&&n.length>0&&(0,q.$U)(e.props.FeedbackChangeEvent),e.Eq.callImmediately()},r=function(t){if(e.state.IsInternetExplorerPageLoaded||!(0,vt.w1)()){var n=e.state.IsExpanded;t&&t!==e.state.FeedbackValue&&(n=!0),e.setState({FeedbackValue:(0,ir.gA)(t)||t,IsExpanded:n}),e.Eq.callOnceLater()}else e.setState({IsInternetExplorerPageLoaded:!0})}}return e.oC=r,e._q=i,e}return(0,p.ZT)(n,t),n.prototype.componentWillReceiveProps=function(t){var n=this;t.Id!==this.state.CurrentFeedbackId&&this.setState({FeedbackValue:(0,ir.gA)(t.StoredFeedback)||t.StoredFeedback,IsInternetExplorerPageLoaded:!1,CurrentFeedbackId:t.Id}),this.setState((function(e){var i=!!t.StoredFeedback||e.IsExpanded;return i&&!n.Uf.current.className.includes("in")&&$(n.Uf.current).collapse("show"),{IsExpanded:i}}))},n.prototype.componentDidMount=function(){var t=this;$(this.Uf.current).on("hidden.bs.collapse",(function(){t.setState({IsExpanded:!(!t.state.FeedbackValue||""===t.state.FeedbackValue)})})),this.state.IsExpanded&&!this.Uf.current.className.includes("in")&&$(this.Uf.current).collapse("show")},n.prototype.Bq=function(){var t,n="collapse";return this.state.IsExpanded&&(n+=" in"),null!=this.props.Id?t=Xd(this.props.Id):null!=this.props.ClassName&&(n+=" "+Xd(this.props.ClassName)),{id:t,className:n}},n.prototype.render=function(){var t=this.state.FeedbackValue,n=this.props.Readonly,e=this.Bq(),i=e.id,r=e.className;return g.createElement("div",{className:r,id:i,ref:this.Uf},(0,ur.ZA)({AllowRichText:!0,HTMLAttributes:this._q,TextFieldType:2,Placeholder:t?null:this.Oq,Value:t,Options:{HTMLPropsForInnerElement:{"aria-label":this.Oq}},onValueChange:this.oC,Disabled:n,TextFieldLocation:{Location:12}}),g.createElement("div",{className:"textbox-printview none-display"},g.createElement(cr.D,{Text:t,RenderMode:"RichText",ContainsHtml:!0})))},n}(J.r);function tm(t){return g.createElement(nm,(0,p.pi)({},t))}var nm=function(t){function n(n){var e=t.call(this,n)||this;return e.state={IsExpanded:n.IsExpanded,ResponseId:n.CurrentResponseId},e}return(0,p.ZT)(n,t),n.prototype.componentWillReceiveProps=function(t){this.state.ResponseId!==t.CurrentResponseId&&this.setState({IsExpanded:t.IsExpanded,ResponseId:t.CurrentResponseId})},n.prototype.componentDidMount=function(){var t=this,n=this.Hq(),e=".gradingViewContainer";$(e).on("shown.bs.collapse",n,(function(){(0,Co.x)($(n+" textarea")),t.Gq(!0)})),$(e).on("hidden.bs.collapse",n,(function(){t.Gq(!1)}))},n.prototype.Hq=function(){return null!=this.props.AssociatedFeedbackId?"#"+Xd(this.props.AssociatedFeedbackId):"."+Xd(this.props.AssociatedFeedbackClassName)},n.prototype.qq=function(){return!this.state.IsExpanded},n.prototype.render=function(){var t=this.Hq(),n=null!=this.props.AssociatedFeedbackId?Xd(this.props.AssociatedFeedbackId):null,e=this.props.Label||(0,T.pm)().GradingView_GiveFeedbackButton_Label,i=(0,N.j)("feedbackToggle",this.qq()?void 0:"disabled"),r=(0,V.M)({FluentIcon:"Chat Bubbles Question",HTMLAttributes:{className:"feedback-icon forms-icon-size16x16","aria-hidden":!0}});return g.createElement("div",(0,p.pi)({},this.props.HTMLAttributes),g.createElement("a",{href:this.qq()?t:"javascript:;","data-toggle":this.qq()?"collapse":void 0,"aria-expanded":this.state.IsExpanded,"aria-controls":n,"aria-disabled":!this.qq()||void 0,title:this.props.Title,onClick:this.If.bind(this),className:i,role:"button"},r,!0===this.props.NoLabel?null:e))},n.prototype.zq=function(){var t="".concat(this.Hq()," .form-control"),n=$(t);n.addClass("focus"),setTimeout((function(){return n.removeClass("focus")}),1e3)},n.prototype.If=function(){this.qq()||this.zq(),(0,q.$U)(this.props.OnClickEventName,{isClickable:this.qq()})},n.prototype.Gq=function(t){this.setState({IsExpanded:t})},n}(J.r),em=e(85451);function im(t){return g.createElement(rm,(0,p.pi)({},t))}var rm=function(t){function n(n){var e=t.call(this,n)||this;e.Uq=1e9,e.jq=null;var i=null!=n.CurrentScore;return e.state={Score:i?n.CurrentScore:void 0,ScoreString:i?n.CurrentScore.toString():void 0,ScoreUpdated:!1},e}return(0,p.ZT)(n,t),n.prototype.Jq=function(){return this.props.TotalPoints||0},n.prototype.Zq=function(){var t=this.state.Score,n=this.Jq(),e=null;if(this.jq=null,null==t&&(this.jq=(0,T.pm)().GradingView_GradeInputNeedsReview_Label,e="gradingNeedsReviewNotification"),t>n&&(this.jq=(0,T.pm)().GradingView_GradeInputExtraCredit_Label,e="gradingExtraCreditNotification"),this.props.autoGraded&&!this.state.ScoreUpdated&&(this.jq=(0,T.pm)().GradingView_AutoGraded,e="gradingAutogradedNotification"),this.jq)return g.createElement("div",{className:e,"aria-live":"polite"},this.jq)},n.prototype.render=function(){var t,n=this,e=(0,T.pm)().Common_Points_Text,i=this.state.ScoreString?this.state.ScoreString:"";t=1===this.Jq()?(0,T.pm)().GradingView_GradeInputPoint_Label:(0,T.pm)().GradingView_GradeInputPoints_LabelFormat.format(this.Jq());var r=y.extend({},this.props.HTMLAttributes);return r.className=(0,N.j)("gradeInputContainer",r.className),g.createElement("div",(0,p.pi)({},r),g.createElement("div",{className:"gradingGradeInputWrapper"},(0,ur.ZA)({HTMLAttributes:{className:"gradingGradeInput","aria-label":this.jq?(0,T.pm)().Common_Fullstop.format(this.props.title,this.jq):this.props.title,role:"group"},Placeholder:e,Value:i,Options:{HTMLPropsForInnerElement:{type:"number","aria-label":e,className:"remove-up-down",max:this.Jq()}},onValueChange:function(t){var e=(0,em.validateQuizPoint)(t,n.Uq);null!=e&&e.pointString!==n.state.ScoreString&&n.setState({Score:e.point,ScoreString:e.pointString,ScoreUpdated:!0},(function(){n.Xq(e.point)}))}}),g.createElement("div",{className:"gradingGradeTotalScore"},"/ ".concat(t))),g.createElement("div",{"aria-live":"polite"},this.Zq()))},n.prototype.Xq=function(t){var n=this.props.UpdateParentScore;n&&n(t)},n}(J.r),om=e(62396);function sm(t){return g.createElement(am,(0,p.pi)({},t))}var am=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.tV=function(){var t=this,n=(0,Dr.ax)({HTMLAttributes:{onClick:function(n){t.props.nextItemCallback(),(0,Co.x)($(n.target))},disabled:this.props.indexOfCurrentItem>=this.props.numberOfItems-1,className:"gradingNavBarArrow nextQuestion","aria-label":this.nV()},ButtonStyle:0,children:(0,V.M)({FluentIcon:"Chevron Right",HTMLAttributes:{className:"forms-icon-size16x16"}})});return g.createElement("div",{className:"gradingNavBarArrowContainer"},n)},n.prototype.eV=function(){var t=this,n=(0,Dr.ax)({HTMLAttributes:{onClick:function(n){t.props.previousItemCallback(),(0,Co.x)($(n.target))},disabled:this.props.indexOfCurrentItem<1,className:"gradingNavBarArrow previousQuestion","aria-label":this.iV()},ButtonStyle:0,children:(0,V.M)({FluentIcon:"Chevron Left",HTMLAttributes:{className:"forms-icon-size16x16"}})});return g.createElement("div",{className:"gradingNavBarArrowContainer"},n)},n.prototype.nV=function(){switch(this.props.gradingMode){case zu.ByQuestion:return(0,T.pm)().GradingView_NextQuestion_ButtonLabel;case zu.ByStudent:return(0,T.pm)().GradingView_NextStudent_ButtonLabel;default:throw new Error("Unknown grading mode: ".concat(this.props.gradingMode))}},n.prototype.iV=function(){switch(this.props.gradingMode){case zu.ByQuestion:return(0,T.pm)().GradingView_PreviousQuestion_ButtonLabel;case zu.ByStudent:return(0,T.pm)().GradingView_PreviousStudent_ButtonLabel;default:throw new Error("Unknown grading mode: ".concat(this.props.gradingMode))}},n.prototype.rV=function(){var t=this.props.dropdownOptions.map((function(t,n){return{DisplayName:t=(0,du.dZ)(t),Value:n,Key:n,DisplayContent:g.createElement("span",{title:t},t)}}));return(0,ar.E)({Label:(0,T.pm)().GradingView_StudentMode_ButtonLabel,HTMLAttributes:{className:"analyze-view-dropdown-div gradingNavBarDropDown"},SelectOptions:t,Value:this.props.indexOfCurrentItem,onValueChange:this.props.dropdownCallback,AllowWrap:!0})},n.prototype.oV=function(){if(!0===this.props.showProgressIndicator)return g.createElement("span",{className:"progressIndicator"},"(",this.props.progressIndicatorTemplate.format(this.props.indexOfCurrentItem+1,this.props.numberOfItems),")")},n.prototype.sV=function(){if(null!=this.props.fillTime){var t=(0,T.pm)().Forms_TimeInMinutesAndSeconds_Format.format(this.props.fillTime.minutes<10?"0"+this.props.fillTime.minutes:this.props.fillTime.minutes,this.props.fillTime.seconds<10?"0"+this.props.fillTime.seconds:this.props.fillTime.seconds),n=(0,T.pm)().GradingView_ResponseFillTimeInMinutesAndSeconds_AccessibilityLabel.format(this.props.fillTime.minutes,this.props.fillTime.seconds);return g.createElement("div",{className:"gradingNavBarItem gradingNavBarStudentFillTime"},g.createElement("div",{className:"gradingNavBarItemLabel",role:"listitem","aria-label":n},(0,T.pm)().GradingView_ResponseFillTime_Format.format(t)))}},n.prototype.aV=function(){var t,n;if(null!=this.props.studentScore&&(null!=this.props.studentScore.pointsEarned||null!=this.props.studentScore.scoreOverride))return null==this.props.studentScore.scoreOverride?(t=e(this.props.studentScore.pointsEarned,this.props.studentScore.pointsPossible),t=(0,T.pm)().GradingView_NavBar_StudentScore_Format.format(t),n=e(this.props.studentScore.pointsEarned,this.props.studentScore.pointsPossible,!0)):n=t=(0,T.pm)().GradingView_NavBar_ScorePercent_Label.format(this.props.studentScore.scoreOverride),g.createElement("div",{className:"gradingNavBarItem"},g.createElement("div",{className:"gradingNavBarItemLabel",role:"listitem","aria-label":n},t));function e(t,n,e){return void 0===e&&(e=!1),e?(0,T.pm)().GradingView_NavBar_StudentScore_AccessibilityLabel.format(t,n):(0,T.pm)().GradingView_NavBar_Score_Format.format(t,n)}},n.prototype.HL=function(){if(this.props.generalFeedbackProps){var t=!!this.props.generalFeedbackProps?this.props.generalFeedbackProps.ClassName:void 0;return g.createElement("div",{key:"".concat(t,"-button"),className:"gradingNavBarItem"},tm(this.props.generalFeedbackButtonProps))}},n.prototype.Xv=function(){if(this.props.generalFeedbackProps){var t=!!this.props.generalFeedbackProps?this.props.generalFeedbackProps.ClassName:void 0;return g.createElement("div",{key:"".concat(t,"-input"),className:"gradingNavBarFeedbackInput"},Zd(this.props.generalFeedbackProps))}},n.prototype.fV=function(){var t=this;if(this.props.MenuProps){var n=y.clone(this.props.MenuProps);return n.onBeforeDeletedDialogShown=function(){t.hV(),t.props.MenuProps.onBeforeDeletedDialogShown&&t.props.MenuProps.onBeforeDeletedDialogShown()},n.onDeleteDialogDismissed=function(){t.dV(),t.props.MenuProps.onDeleteDialogDismissed&&t.props.MenuProps.onDeleteDialogDismissed()},(0,om.F)(n)}},n.prototype.hV=function(){this.setState({disabled:!0})},n.prototype.dV=function(){this.setState({disabled:void 0})},n.prototype.mV=function(){if(null!=this.props.questionScore){var t=e(this.props.questionScore.pointsEarned,this.props.questionScore.pointsPossible,this.props.questionScore.numQuestions);t=(0,T.pm)().GradingView_NavBar_QuestionScore_Format.format(t);var n=e(this.props.questionScore.pointsEarned,this.props.questionScore.pointsPossible,this.props.questionScore.numQuestions,!0);return g.createElement("div",{className:"gradingNavBarItem"},g.createElement("div",{className:"gradingNavBarItemLabel",role:"listitem","aria-label":n},t))}function e(t,n,e,i){function r(t){var n=Math.round(t);return t===n?n:t.toFixed(1)}void 0===i&&(i=!1);var o=0!==e?r(t/e):0,s=0!==e?r(n/e):0;return i?(0,T.pm)().GradingView_NavBar_QuestionScore_AccessibilityLabel.format(o,s):(0,T.pm)().GradingView_NavBar_Score_Format.format(o,s)}},n.prototype.render=function(){return g.createElement("div",null,g.createElement("div",{className:"gradingNavBar"},g.createElement("div",{className:"gradingNavBarItemsContainer","aria-disabled":this.state.disabled,role:"list"},g.createElement("div",{className:"gradingNavBarItem gradingNavBarNavigationContainer"},g.createElement("div",{className:"gradingNavBarNavigationComponent"},this.eV()),g.createElement("div",{className:"gradingNavBarNavigationComponent gradingNavBarDropdownContainer"},this.oV(),this.rV()),g.createElement("div",{className:"gradingNavBarNavigationComponent"},this.tV())),this.sV(),this.aV(),this.mV(),this.HL()),this.fV()),this.Xv())},n}(J.r);function um(t){var n=(0,xd.Ai)(t.response);return(0,Qa.Y)({email:n.email,name:n.name,tooltip:n.email&&-1!==n.email.indexOf("@")?"".concat(n.name," <").concat(n.email,">"):n.name,displayText:(0,Ua.Q)(n.name)})}function cm(){var t=document.getElementById("scrollAnchor");t&&t.scrollIntoView()}function lm(){if((0,vt.tq)()){var t=$(window).width();return 0===t&&(t=document.body.scrollWidth),t/(16/9)}return(0,X.HR)()}var fm=function(t){function n(n){var e=t.call(this,n)||this;return e.setState({dummyToForceUpdate:{},ResponseIdsForDetailsModal:[],AnalyzeViewData:null,DataTablesLibraryLoaded:!1}),e.uL=e.uL.bind(e),e.pV=e.pV.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this,n=this.props.Form.getQuestions(),e=this.props.Form.getResponses(),i=(0,xd.gF)(n,e);(0,q.$U)("Grading.PowertoolView.Initial",i),(0,Pr.y)("DataTables").then((function(){return t.setState({DataTablesLibraryLoaded:!0})}))},n.prototype.render=function(){var t=this.props.Form,n=this.props.CurrentQuestionMaster,e=n.Model,i=function(t,n){return[new Ld(t,n),new Rd(t,n)]}(Fd(t.getResponses(),n),n),r=i[0],o=i[1],s=Dl.isAutogradableQuestion(e);return g.createElement("div",{className:"gradingPowertoolContainer"},this.bV(r,s,!0),this.bV(o,s,!1),this.yV(e.Id))},n.prototype.bV=function(t,e,i){for(var r=this,o=this.props.CurrentQuestionIndex,s=this.props.CurrentQuestionMaster,a=s.Model,u=this.props.CurrentQuestionIndex+1,c=[],l=function(){var l=t.next(),h=l.answerAndResponses,d=(0,xd.Ov)(h.map((function(t){return t.Response}))),m=h[0].Answer,v=null!=m?kd(m.Answer):void 0,p=a.IsMathQuiz&&"Question.TextField"!==a.Type?function(t,n){if(!t)return g.createElement("div",{className:"gradingQuestionNoAnswerGiven"},(0,T.pm)().GradingView_NoAnswerGiven_Label);for(var e=(0,Y.P)(t,n).SelectedOptions.map((function(t){return y.find(n.Choices,(function(n){return n.Description===t+""}))})).filter((function(t){return null!=t})),i=[],r=0;r<e.length;r++)i.push(Do(e[r])),r!==e.length-1&&i.push((0,T.pm)().GradingView_ItemSeparator);return i.every(y.isString)?i.join(""):g.createElement("span",null,i)}(v,a):Kd(s,{Answer:m},["Question.Choice","Question.Ranking","Question.MatrixChoiceGroup"]),b="".concat(o,"_").concat(l.answerRenderOrderIndex),w="answerFeedback-"+b,S=(0,T.pm)().GradingView_Feedback_ButtonTextFormat.format(d,u),N=(0,T.pm)().GradingView_Grade_ButtonTextFormat.format(d,(0,T.pm)().Designer_LabelForQuestionTitle.format(u,a.Title)),C=n.getResponsesCountText(h.length),I=h.map((function(t){return t.Response.Id})),k=n.getCorrectnessIcon(e,i),x=i?"gradingPowertoolCorrectAnswer":"gradingPowertoolIncorrectAnswer",F=Lo(a,m.Feedback);c.push(g.createElement("div",{className:"gradingPowertoolAnswerAndFeedbackBoxContainer",key:b},g.createElement("div",{className:"gradingPowertoolAnswerContainer"},k,g.createElement("div",{className:"gradingPowertoolAnswer gradingAnswerContainer "+x},p),g.createElement("div",{className:"gradingPowertoolAnswerSecondRow"},g.createElement("div",{className:"gradingPowertoolResponseCountContainer"},g.createElement("a",{href:"javascript:;",onClick:function(){return r.wV(I)},className:"office-form-theme-primary-foreground"},C)),g.createElement("div",{className:"gradingPowertoolGradeInputContainer",key:a.Id+b},im({TotalPoints:a.Point,CurrentScore:m.Score,UpdateParentScore:f.SV(h,a),HTMLAttributes:{hidden:!a.IsQuiz,onBlur:f.NV.bind(f),onFocus:function(){return r.props.UpdateGradeBoxIndexAfterWhichToSearchNextUngraded(l.answerRenderOrderIndex)}},title:N,autoGraded:(0,Cd.CW)(m)})),0===F&&g.createElement("div",{className:"gradingPowertoolFeedbackButtonContainer"},tm({IsExpanded:!!m.Feedback,AssociatedFeedbackId:w,Title:S,NoLabel:!0,OnClickEventName:"Grading.PowertoolView.FeedbackButtonClick"})))),1!==F&&g.createElement("div",{className:"gradingPowertoolFeedbackInputContainer"},Zd({HTMLAttributes:{onBlur:f.CV.bind(f)},Id:w,FeedbackUpdate:f.IV(h,a),StoredFeedback:m.Feedback,FeedbackChangeEvent:"Grading.PowertoolView.FeedbackChanged",Readonly:2===F}))))},f=this;t.hasNext();)l();return c},n.getCorrectnessIcon=function(t,n){var e,i;if(t)return n?(e="forms-icon-size16x16 office-form-right-answerkey",i=(0,T.pm)().GradingView_CorrectAnswer_AccessibilityLabel):(e="forms-icon-size16x16 office-form-wrong-answerkey",i=(0,T.pm)().GradingView_IncorrectAnswer_AccessibilityLabel),g.createElement("span",{className:"gradingPowertoolCorrectnessIcon"},g.createElement(V.F,{FluentIcon:n?"Checkmark":"Dismiss",HTMLAttributes:{className:e}}),g.createElement("a",{className:"screenReaderVisible"},i),g.createElement("span",{"aria-hidden":"true",role:"presentation"}))},n.getResponsesCountText=function(t){return 1===t?(0,T.pm)().GradingView_PowertoolAnswerResponseCount_Label_Singular:(0,T.pm)().GradingView_PowertoolAnswerResponseCount_Label.format(t)},n.prototype.wV=function(t){var n=this;(0,q.$U)("Grading.PowertoolView.RowDetailsModalOpen"),this.setState({ResponseIdsForDetailsModal:t}),Uu.createAnalyzeViewData(this.props.Form.getWrappedForm()).then((function(t){n.setState({AnalyzeViewData:t})})).catch((function(t){wd((function(n){return n.Model.CriticalError=t}))}))},n.prototype.yV=function(t){var n=this,e=this.state;if(null!=e.ResponseIdsForDetailsModal&&null!=e.AnalyzeViewData&&e.DataTablesLibraryLoaded)return Ml({QuestionId:"field_"+t,AnalyzeViewData:e.AnalyzeViewData,closeSelf:function(){n.setState({ResponseIdsForDetailsModal:null})},goToNextModalCallback:null,goToPreviousModalCallback:null,ShouldIncludeInvalidAnswers:!0,filterResponses:this.pV})},n.prototype.uL=function(){this.setState({ResponseIdsForDetailsModal:null})},n.prototype.pV=function(t){return y.contains(this.state.ResponseIdsForDetailsModal,t.field_id)},n.prototype.IV=function(t,n){var e=this;return function(i){var r=e.props.Form,o=t.map((function(t){return t.Response.Id}));r.addAnswerFeedbacks(o,n.Id,undefined,i,(function(){return(0,q.$U)("Grading.PowertoolView.FeedbackChanged",{responsesCount:o.length})}))}},n.prototype.SV=function(t,n){var e=this;return function(i){var r=e.props.Form,o=t.map((function(t){return t.Response.Id}));r.addAnswerFeedbacks(o,n.Id,i,undefined,(function(){return(0,q.$U)("Grading.PowertoolView.GradeChanged",{isFormFullyGraded:(0,Cd.t9)(r),isGradedAnswer:t[0].Answer.IsAutoGraded,isMathQuestion:n.IsMathQuiz,responsesChanged:t.length,questionType:n.Type,questionId:n.Id})}))}},n.prototype.NV=function(){this.TV(),this.props.OnGradeChange()},n.prototype.CV=function(){this.TV()},n.prototype.TV=function(){this.props.Form.calculateBranchedResponses(),this.setState({dummyToForceUpdate:{}})},n}(J.r);function hm(){var t=$("body");t.addClass("gradingViewContainer");var n=$("#gradingViewPrintChild").appendTo(t),e=$("#content-root");e.hide(),$(".feedbackInput").hide(),$(".textbox-printview.none-display").show(),(0,ti.B6)((function(){t.removeClass("gradingViewContainer"),n.appendTo($(".gradingViewContainer")),e.show(),$(".textbox-printview.none-display").hide(),$(".feedbackInput").show()}))}var dm=function(t){function n(e){var i=t.call(this,e)||this,r=i.props.CurrentQuestionMaster.Model.Id;return i.state={score:n.createNavBarAverageScore(e.Form,r)},i}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){(0,q.$U)("Grading.QuestionView.Initial")},n.prototype.componentDidMount=function(){cm()},n.prototype.render=function(){var t=this.props.CurrentQuestionMaster;return g.createElement("div",(0,p.pi)({},{className:"gradingByQuestion",id:"grading-by-question-panel",role:"tabpanel","aria-labelledby":"grading-by-question-tab","aria-expanded":!0}),this.kV(),this.xV(t),this.FV(t))},n.prototype.FV=function(t){var e,i=this,r=t.Model,o=this.PV(r.Id);if(!o.length)return g.createElement("div",{className:"gradingQuestionNoAnswerGiven"},(0,T.pm)().GradingView_NoOneAnswered_Label);if("Question.MatrixChoiceGroup"===r.Type||"Question.Ranking"===r.Type)return g.createElement("div",{className:"gradingByQuestionContainer"},g.createElement("span",null,(0,T.pm)().QuestionView_Tip_LikertAndRanking));if(Pd(r)){(0,q.$U)("Grading.QuestionView.RenderedInPowertool");var s=this.props.Form;return e={Form:s,CurrentQuestionIndex:this.props.CurrentQuestionIndex,CurrentQuestionMaster:this.props.CurrentQuestionMaster,OnGradeChange:function(){i.setState({score:n.createNavBarAverageScore(i.props.Form,r.Id)}),i.props.UpdateNextUngradedButtonState()},UpdateGradeBoxIndexAfterWhichToSearchNextUngraded:this.props.UpdateGradeBoxIndexAfterWhichToSearchNextUngraded},g.createElement(fm,(0,p.pi)({},e))}(0,q.$U)("Grading.QuestionView.RenderedInNonPowertool");var a=o.map((function(n,e){return i.MV(n,t,e)}));return g.createElement("div",{className:"gradingByQuestionContainer"},g.createElement("div",{className:"gradingByQuestionAnswerContainer gradingAnswerContainer"},a))},n.prototype.PV=function(t){for(var n=[],e=new Ad(this.props.Form,t),i=function(){var t=e.next(),i=y.filter(n,(function(n){return n.Response.Responder===t.response.Responder})).length;n.push({Response:t.response,Answer:t.answer,Attempt:i})};e.hasNext();)i();return n},n.prototype.LV=function(t){var n=y.filter(this.props.Form.getQuestions(),(function(t){return!t.GroupId}));return"".concat(t+1,". ").concat(n[t].Title)},n.prototype.kV=function(){var t=this,e=y.filter(this.props.Form.getQuestions(),(function(t){return!t.GroupId})),i=y.range(e.length).map((function(n,e){return t.LV(e)})),r={HasAnswers:null!=this.props.Form.getResponses()&&this.props.Form.getResponses().length>0,DeleteAllResponses:!1,onDelete:void 0,onPrint:function(){hm(),(0,q.$U)("Grading.StudentView.PrintResponse")}},o=e[this.props.CurrentQuestionIndex].Id,s=this.props.Form.getQuestions().filter((function(t){return!t.GroupId})).length;return sm({dropdownCallback:this.RV(),dropdownOptions:i,previousItemCallback:this.AV(),nextItemCallback:this.EV(),indexOfCurrentItem:this.props.CurrentQuestionIndex,numberOfItems:s,generalFeedbackProps:null,generalFeedbackButtonProps:null,gradingMode:zu.ByQuestion,progressIndicatorTemplate:(0,T.pm)().GradingView_Of_Format,MenuProps:r,questionScore:n.createNavBarAverageScore(this.props.Form,o)})},n.prototype.RV=function(){var t=this;return function(e){var i=t.props.Form.getQuestions()[e].Id;t.props.UpdateParentCurrentQuestionIndex(e),(0,q.$U)("Grading.QuestionView.GotoPage"),t.setState({score:n.createNavBarAverageScore(t.props.Form,i)}),cm()}},n.prototype.AV=function(){var t=this,e=this.props.CurrentQuestionIndex;return function(){if(e>=1){var i=e-1,r=t.props.Form.getQuestions()[i].Id;t.props.UpdateParentCurrentQuestionIndex(i),(0,q.$U)("Grading.QuestionView.PreviousPage"),t.setState({score:n.createNavBarAverageScore(t.props.Form,r)}),cm()}}},n.prototype.EV=function(){var t=this,e=this.props.CurrentQuestionIndex;return function(){if(e<t.props.Form.getQuestions().length-1){var i=e+1,r=t.props.Form.getQuestions()[i].Id;t.props.UpdateParentCurrentQuestionIndex(i),(0,q.$U)("Grading.QuestionView.NextPage"),t.setState({score:n.createNavBarAverageScore(t.props.Form,r)}),cm()}}},n.createNavBarAverageScore=function(t,n){var e=(0,Cd.iT)(t,n);return{pointsPossible:(0,Cd.BS)(t,n),pointsEarned:e,numQuestions:(0,Cd.L0)(t,n).length}},n.prototype.xV=function(t){var n=t.Model,e=Fo(n),i=g.createElement(cr.D,{Text:(0,ir.wg)(n.Title,n.FormsProRTQuestionTitle),RenderMode:"RichText",ContainsHtml:!0}),r=n.ShowSubtitle&&n.Subtitle&&null==e&&g.createElement("div",{className:"gradingByQuestionQuestionSubtitle"},g.createElement(cr.D,{Text:(0,ir.wg)(n.Subtitle,n.FormsProRTSubtitle),RenderMode:"RichText",ContainsHtml:!0})),o=Po(n)&&g.createElement(go.zg,{Image:t.ImageInfoMaster,ImageSettings:t.ImageSettingsMaster,ImageType:"Question"}),s=t.hasValidVideoUrl()&&g.createElement("iframe",{src:n.VideoInfo.Url,height:lm(),width:"100%",frameBorder:"0",allowFullScreen:!0,sandbox:"allow-scripts allow-same-origin allow-popups allow-forms"});return g.createElement("div",{className:"gradingByQuestionQuestionContainer"},g.createElement("div",{className:"gradingByQuestionQuestionNumberAndTitleContainer"},g.createElement("div",{className:"gradingByQuestionQuestionNumberContainer"},this.props.CurrentQuestionIndex+1,"."),g.createElement("div",{className:"gradingQuestionText gradingByQuestionQuestionTextContainer",key:n.Id},i,r)),g.createElement("div",{className:"gradingQuestionFormulaAndImageContainer"},g.createElement("div",{className:"gradingQuestionImage",key:n.Id+"Image"},o),s,g.createElement("div",{className:"gradingQuestionFormula",key:n.Id+"Formula"},e)))},n.prototype.MV=function(t,n,e){var i=this,r=n.Model,o=this.props.CurrentQuestionIndex,s=(0,xd.Ai)(t.Response).name,a="".concat(r.Id).concat(s).concat(t.Attempt).concat(o),u=t.Answer?t.Answer.Score:void 0,c=(0,T.pm)().GradingView_Grade_ButtonTextFormat.format(s,(0,T.pm)().Designer_LabelForQuestionTitle.format(o+1,r.Title)),l=this.OV(t,r);return g.createElement("div",{className:"gradingByQuestionOneResponseContainer",key:a},g.createElement("div",{className:"gradingByQuestionResponseHeader"},g.createElement("div",{className:"gradingByQuestionStudentAvatar gradingByQuestionAvatarContainer"},um({response:t.Response})),g.createElement("div",{className:"gradingByQuestionStudentNameContainer"},s,t.Attempt>0?" (".concat(t.Attempt,")"):void 0),g.createElement("div",{className:"gradingByQuestionGradeAndFeedbackContainer"},g.createElement("div",{className:"gradingByQuestionGradeContainer"},im({TotalPoints:r.Point,CurrentScore:u,UpdateParentScore:this._V(t.Response.Id,r),HTMLAttributes:{hidden:!r.IsQuiz,onBlur:this.BV(r.Id),onFocus:function(){return i.props.UpdateGradeBoxIndexAfterWhichToSearchNextUngraded(e)}},title:c,autoGraded:(0,Cd.CW)(t.Answer)})),g.createElement("div",{className:"gradingByQuestionFeedbackContainer"},null==l?void 0:l.button))),g.createElement("div",null,g.createElement("div",{className:"gradingByQuestionResponseTitle"},(0,T.pm)().GradingView_Response_Label),g.createElement("div",{className:"gradingByQuestionResponseBody"},this.HV(t,n)),g.createElement("div",{className:"grading-feedback"},null==l?void 0:l.input)))},n.prototype.OV=function(t,n){var e=Lo(n,t.Answer.Feedback);if(1===e)return null;var i=(0,Od.u)(t.Response.Responder||t.Response.ResponderName),r="feedback-".concat(i,"-").concat(t.Attempt),o=this.props.CurrentQuestionIndex,s=(0,xd.Ai)(t.Response).name,a=(0,T.pm)().GradingView_Feedback_ButtonTextFormat.format(s,o+1),u=null;return 0===e&&(u=tm({IsExpanded:!!t.Answer.Feedback,AssociatedFeedbackId:r,Title:a,NoLabel:!0,OnClickEventName:"Grading.QuestionView.FeedbackButtonClick"})),{button:u,input:g.createElement("div",{className:"gradingByQuestionFeedback"},Zd({Id:r,StoredFeedback:t.Answer.Feedback,FeedbackUpdate:this.IV(t.Response.Id,n),FeedbackChangeEvent:"Grading.QuestionView.FeedbackChanged",Readonly:2===e}))}},n.prototype.HV=function(t,n){return!!kd(t.Answer.Answer)?Kd(n,{Answer:t.Answer}):g.createElement("div",{className:"gradingQuestionNoAnswerGiven"},(0,T.pm)().GradingView_NoAnswerGiven_Label)},n.prototype.BV=function(t){var e=this;return function(){e.setState({score:n.createNavBarAverageScore(e.props.Form,t)}),e.props.UpdateNextUngradedButtonState()}},n.prototype._V=function(t,n){var e=this;return function(i){var r=e.props.Form;r.addAnswerFeedbacks([t],n.Id,i,undefined,(function(){return(0,q.$U)("Grading.QuestionView.GradeChanged",{isFormFullyGraded:(0,Cd.t9)(r)})}))}},n.prototype.IV=function(t,n){var e=this;return function(i){e.props.Form.addAnswerFeedbacks([t],n.Id,undefined,i)}},n}(J.r),mm=e(89099),vm=e(56550);var gm=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=this.props.questionMaster,e=t.Model,i=this.props.answer.Answer,r=("Question.Ranking"===e.Type?!!i:"Question.MatrixChoiceGroup"===e.Type?y.some(i,(function(t){return!!t.Answer})):!!kd(i))?Kd(t,{Answer:this.props.answer},null,!0):g.createElement("div",{className:"gradingQuestionNoAnswerGiven"},(0,T.pm)().GradingView_NoAnswerGiven_Label),o=Fo(e),s=g.createElement(cr.D,{Text:(0,ir.wg)(e.Title,e.FormsProRTQuestionTitle),RenderMode:"RichText",ContainsHtml:!0}),a=e.ShowSubtitle&&e.Subtitle&&null==o&&g.createElement("div",null,g.createElement(cr.D,{Text:(0,ir.wg)(e.Subtitle,e.FormsProRTSubtitle),RenderMode:"RichText",ContainsHtml:!0})),u=Po(e)&&g.createElement(go.zg,{Image:t.ImageInfoMaster,ImageSettings:t.ImageSettingsMaster,ImageType:"Question"}),c=t.hasValidVideoUrl()&&g.createElement("iframe",{src:e.VideoInfo.Url,height:lm(),width:"100%",frameBorder:"0",allowFullScreen:!0,sandbox:"allow-scripts allow-same-origin allow-popups allow-forms"});return g.createElement("div",{key:e.Id},g.createElement("div",{className:"gradingQuestionText"},s),a,g.createElement("div",{className:"gradingQuestionImage"},u),c,g.createElement("div",{className:"gradingQuestionFormula"},o),g.createElement("div",{className:"gradingByStudentAnswerContainer gradingAnswerContainer"},r),g.createElement("div",null,n.getShortTextQuestionCorrectAnswerList(this.props)),g.createElement("div",{className:"gradingByStudentIndividualQuestionFeedbackContainer gradingGiveFeedbackLink"},this.props.feedbackButton,this.props.feedbackInput))},n.getShortTextQuestionCorrectAnswerList=function(t){var n=t.questionMaster.Model;if("Question.TextField"===n.Type&&!n.Multiline&&n.IsQuiz&&!t.questionMaster.isCorrectAnswer(kd(t.answer.Answer))){var e=new it.E(t.questionMaster.Model);if(e.areAnyAnswersDefined()){var i,r=e.getAnswers();if(r.some((function(t){return t.isMath}))){for(var o=[],s=0,a=r;s<a.length;s++){var u=a[s];if(u.isMath){var c=(0,er.Rq)({Formula:u.answer});o.push(g.createElement("div",{className:"correct-answer-list-formula-element"},c))}else o.push(u.answer);o.push((0,T.pm)().VariousLocations_ItemList_Separator)}o.pop(),i=g.createElement("div",{className:"correct-answer-list-formula-container"},o)}else i=y.map(r,(function(t){return kd(t.answer)})).join((0,T.pm)().VariousLocations_ItemList_Separator);return g.createElement("div",{className:"gradingByStudentShortTextCorrectAnswerList various-short-text-correct-answer-list"},g.createElement("b",null,(0,T.pm)().VariousLocations_CorrectAnswerList_Label," "),i)}}},n}(J.r),pm=function(t){function n(e){var i=t.call(this,e)||this;i.RV=function(t){var e=i.props.Form.getResponses()[t],r=e.Id;i.props.UpdateParentCurrentStudentIndex(t),(0,q.$U)("Grading.StudentView.GotoPage"),i.setState({score:n.createNavBarStudentScore(i.props.Form,r),currentGeneralFeedback:(0,Cd.w$)(e),responseIsReleased:(0,Cd.lu)(e)}),cm()},i.GV=function(){return i.props.Form.getResponses()[i.props.CurrentResponderIndex]},i.qV=function(t){var n=i.props.Form,e=i.GV().Id;n.addGeneralFeedback(e,t),i.setState({currentGeneralFeedback:t})};var r=e.Form.getResponses()[e.CurrentResponderIndex],o=r.Id;return i.state={score:n.createNavBarStudentScore(e.Form,o),currentGeneralFeedback:(0,Cd.w$)(r),responseIsReleased:(0,Cd.lu)(r)},i}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this.props.Form.getQuestions(),n=this.props.Form.getResponses(),e=(0,xd.gF)(t,n);(0,q.$U)("Grading.StudentView.Initial",e)},n.prototype.componentDidMount=function(){cm()},n.prototype.render=function(){var t,n=this,e=this.VV();t=0===this.props.Form.getWrappedForm().FormElementManager.SectionMasters.length?e.map((function(t,e){return n.zV(t,e)})):this.QV(e);return g.createElement("div",(0,p.pi)({},{id:"grading-by-people-panel",role:"tabpanel","aria-labelledby":"grading-by-people-tab","aria-expanded":!0}),this.$V(),g.createElement("div",null,t))},n.prototype.jV=function(){return"feedback-general-".concat(this.props.CurrentResponderIndex,"-").concat(this.props.Form.getResponses()[this.props.CurrentResponderIndex].Id)},n.prototype.$V=function(){var t=this,e=this.props.Form.getResponses(),i=this.props.CurrentResponderIndex,r=e.length,o=e.map((function(t){return(0,xd.Ai)(t).name})),s=this.props.Form.getResponses()[this.props.CurrentResponderIndex],a=(0,xd.Ai)(s).name,u=(0,Cd.w$)(s),c={Id:this.jV(),FeedbackUpdate:this.qV.bind(this),StoredFeedback:u,FeedbackChangeEvent:"Grading.StudentView.GeneralFeedbackChanged",Readonly:!1},l={HTMLAttributes:{className:"gradingNavBarFeedbackButtonContainer"},IsExpanded:!!c.StoredFeedback,AssociatedFeedbackId:c.Id,Title:(0,T.pm)().GradingView_GeneralFeedback_Label.format(a),OnClickEventName:"Grading.StudentView.GeneralFeedbackButtonClick",NoLabel:!0,CurrentResponseId:s.Id},f={HasAnswers:null!=e&&e.length>0,DeleteAllResponses:!1,IsScoreReleased:this.state.responseIsReleased,onDelete:i>=0?function(){t.WV(i,r),(0,q.$U)("Grading.StudentView.DeleteResponse")}:Qd,onPrint:function(){hm(),(0,q.$U)("Grading.StudentView.PrintResponse")},onPostScore:function(){t.props.Form.markAsReleased(s.Id),(0,q.$U)("Grading.StudentView.ReleaseResult"),t.setState({responseIsReleased:!0})},ConfirmDialogTextClassName:"menu-action-confirmation-smaller-font"};return g.createElement("span",null,g.createElement("span",{id:"general-feedback-toggle-wrapper",style:{display:"none"}},tm(l)),sm({dropdownCallback:this.RV,dropdownOptions:n.handleDuplicatedResponderNames(o),previousItemCallback:this.KV(i),nextItemCallback:this.XV(i,r),indexOfCurrentItem:i,numberOfItems:r,generalFeedbackProps:c,generalFeedbackButtonProps:l,gradingMode:zu.ByStudent,progressIndicatorTemplate:(0,T.pm)().GradingView_Of_Format,MenuProps:f,fillTime:n.calculateIndividualFillTime(s),studentScore:n.createNavBarStudentScore(this.props.Form,s.Id)}))},n.prototype.KV=function(t){var e=this;return function(){if(t>=1){var i=t-1,r=e.props.Form.getResponses()[i],o=r.Id;e.props.UpdateParentCurrentStudentIndex(i),(0,q.$U)("Grading.StudentView.PreviousPage"),e.setState({score:n.createNavBarStudentScore(e.props.Form,o),currentGeneralFeedback:(0,Cd.w$)(r),responseIsReleased:(0,Cd.lu)(r)}),cm()}}},n.prototype.XV=function(t,e){var i=this;return function(){if(t<=e){var r=t+1,o=i.props.Form.getResponses()[r],s=o.Id;i.props.UpdateParentCurrentStudentIndex(r),(0,q.$U)("Grading.StudentView.NextPage"),i.setState({score:n.createNavBarStudentScore(i.props.Form,s),currentGeneralFeedback:(0,Cd.w$)(o),responseIsReleased:(0,Cd.lu)(o)}),cm()}}},n.prototype.VV=function(){for(var t=this.props.Form.getWrappedForm().FormElementManager.TopQuestionMasters,n=this.GV(),e=[],i=new Ed(this.props.Form,n);i.hasNext();){var r=i.next(),o=this.YV(r.question,r.answer,r.answerRenderOrderIndex);e.push({questionMaster:t[r.unbranchedQuestionIndex],answer:r.answer,feedbackButton:null==o?void 0:o.button,feedbackInput:null==o?void 0:o.input})}return e},n.prototype.zV=function(t,n){var e=this,i=y.filter(this.props.Form.getQuestions(),(function(t){return!t.GroupId}))[n].IsQuiz?"":"InvisibleBlock",r=(0,xd.Ai)(this.GV()).name,o=t.feedbackButton;t.feedbackButton=void 0;var s="".concat(n+1,"."),a=g.createElement("div",{className:"gradingByStudentQuestionNumber"},s),u=g.createElement("div",{className:"gradingByStudentResponseContainer"},function(t){return g.createElement(gm,(0,p.pi)({},t))}(t)),c=t.questionMaster.Model,l=t.answer,f=(0,T.pm)().GradingView_Grade_ButtonTextFormat.format(r,(0,T.pm)().Designer_LabelForQuestionTitle.format(n+1,c.Title)),h=c.Id+this.props.CurrentResponderIndex,d=g.createElement("div",{className:"gradingByStudentGradeAndFeedbackContainer"},g.createElement("div",{className:"gradingByStudentGradeContainer",key:"".concat(h,"-gradeAndFeedback")},im({TotalPoints:c.Point,CurrentScore:l.Score,UpdateParentScore:this._V(c,l),HTMLAttributes:{className:i,onBlur:function(){return e.BV()},onFocus:function(){return e.props.UpdateGradeBoxIndexAfterWhichToSearchNextUngraded(n)}},title:f,autoGraded:(0,Cd.CW)(l)})),g.createElement("div",{className:"gradingByStudentFeedbackContainer"},o));return g.createElement("div",{key:"".concat(h,"-container"),className:"gradingByStudentFullQuestionContainer"},d,a,u)},n.prototype.QV=function(t){return this.tz(t)},n.prototype.nz=function(t,n){return t?[g.createElement(mm.b,{HasTheme:!1,key:"form-section-breaker-"+t.Model.Id}),g.createElement(vm.p,{Disabled:!0,DisableShuffle:!0,Expaned:!0,IsMobile:(0,vt.tq)(),key:"form-section-container-"+t.Model.Id,SectionMaster:t},n)]:n},n.prototype.tz=function(t){var n=this,e=0,i=this.iz(t).map((function(t){var i=y.map(t.TopQuestionMasters,(function(t){return n.zV(t,e++)}));return n.nz(t.Section,i)}));return g.createElement("div",null,i)},n.prototype.iz=function(t){var n=[],e=this.props.Form.getWrappedForm().FormElementManager.getSectionNodes(),i=null;return t.forEach((function(t){var r=y.find(e,(function(n){return n.TopQuestionMasters.indexOf(t.questionMaster)>=0}))||{Section:null,TopQuestionMasters:[]};i&&i.Section===r.Section||(i={Section:r.Section,TopQuestionMasters:[]},n.push(i)),i.TopQuestionMasters.push(t)})),n},n.prototype.YV=function(t,n,e){var i=Lo(t,n.Feedback);if(1===i)return null;var r=this.props.Form.getResponses()[this.props.CurrentResponderIndex],o=(0,xd.Ai)(r).name,s="feedback-".concat(t.Id,"-").concat(r.Id),a=(0,T.pm)().GradingView_Feedback_ButtonTextFormat.format(o,e+1),u=null;return 0===i&&(u=g.createElement("div",{key:"button-".concat(s)},tm({IsExpanded:!!n.Feedback,AssociatedFeedbackId:s,Title:a,NoLabel:!0,OnClickEventName:"Grading.StudentView.FeedbackButtonClick",CurrentResponseId:r.Id}))),{button:u,input:g.createElement("div",{key:"input-".concat(s)},Zd({Id:s,FeedbackUpdate:this.IV(t),StoredFeedback:n.Feedback,FeedbackChangeEvent:"Grading.StudentView.FeedbackChanged",Readonly:2===i}))}},n.handleDuplicatedResponderNames=function(t){var n={};return t.map((function(t){return n[t]?n[t]++:n[t]=1,void 0===t?(0,T.pm)().DisplayFormat_AnonymousUserName.format((0,T.pm)().ResponderNameForAnonymousUser,n[t]):1===n[t]?t:(0,T.pm)().DisplayFormat_DuplicateUserName.format(t,n[t])}))},n.prototype.BV=function(){this.setState({score:n.createNavBarStudentScore(this.props.Form,this.GV().Id)}),this.props.UpdateNextUngradedButtonState()},n.prototype._V=function(t,n){var e=this;return function(i){var r=e.props.Form,o=e.GV().Id;r.addAnswerFeedbacks([o],t.Id,i,undefined,(function(){return(0,q.$U)("Grading.StudentView.GradeChanged",{isFormFullyGraded:(0,Cd.t9)(r),isGradedAnswer:n.IsAutoGraded,isMathQuestion:t.IsMathQuiz,questionType:t.Type,questionId:t.Id})}))}},n.prototype.IV=function(t){var n=this;return function(e){var i=n.GV().Id;n.props.Form.addAnswerFeedbacks([i],t.Id,undefined,e)}},n.prototype.WV=function(t,e){var i=this.props.Form,r=i.getResponses()[t].Id;Dl.onDeleteCurrentResponse(i.getWrappedForm(),r),i.onDeleteResponse(r),i.calculateBranchedResponses();var o=t;if(t===e-1&&(o=e-2),o<0)this.props.onDeleteLastResponse();else{var s=this.props.Form.getResponses()[o];this.props.UpdateParentCurrentStudentIndex(o),this.setState({score:n.createNavBarStudentScore(this.props.Form,s.Id),currentGeneralFeedback:(0,Cd.w$)(s)})}},n.calculateIndividualFillTime=function(t){var n=t.StartDate.getTime(),e=(t.SubmitDate.getTime()-n)/1e3;return{minutes:Math.floor(e/60),seconds:Math.round(e%60)}},n.createNavBarStudentScore=function(t,n){var e=(0,Cd.Uo)(t,n),i=(0,Cd.p3)(t,n);return e>0?{pointsPossible:e,pointsEarned:i}:this.getScoreBasedOnNumberOfCorrectAnswers(t,n)},n.getScoreBasedOnNumberOfCorrectAnswers=function(t,n){var e=(0,Cd.Vq)(t,n),i=e.map((function(t){return t.QuestionId})),r=t.getQuestions().filter((function(t){return y.contains(i,t.Id)})),o=0,s=0,a={};e.forEach((function(t){a[t.QuestionId]=t})),r.forEach((function(n){var e=Mo(t,n.Id);a[n.Id]&&e.isCorrectAnswer(a[n.Id].Answer)&&o++,y.some(n.Choices,(function(t){return t.IsAnswerKey}))&&s++}));var u=Math.round(100*o/s);return{pointsPossible:void 0,pointsEarned:void 0,scoreOverride:isFinite(u)&&!isNaN(u)?u+"":void 0}},n}(J.r),bm=function(t){function n(n){var e=t.call(this,n)||this;return e.rz=null,e.oz=!1,e.sz=!1,e.az=!1,e.uz=!1,e.fz=g.createRef(),e.hz=g.createRef(),e.uz=!0,e.As=e.As.bind(e),e.state={GradingMode:(n.UxState||zu.ByStudent).View,isReadyToRender:!1,CurrentIndexForQuestionView:(n.UxState||zu.ByStudent).Index,CurrentIndexForStudentView:(n.UxState||zu.ByStudent).Index,IndexOfGradeBoxToFocusOnLoad:null,hasUngradedQuestions:!0,lastResponseDeleted:!1,Form:new Id(n.FormMaster),isMounted:!0},e.dz(),e.mz=y.debounce(e.forceUpdate,1e3),e}return(0,p.ZT)(n,t),n.prototype.dz=function(){this.vz=-1},n.prototype.componentWillMount=function(){var t=this,n=this.state.Form,e=this.props.FormMaster.Schema;this.props.FormMaster.observe(this.As,[e.Responses]),n.ensureReadyToGrade().then((function(){n.calculateBranchedResponses(),t.setState({isReadyToRender:!0,hasUngradedQuestions:null!==t.gz(n)}),(0,q.$U)("Grading.OnLoad.Success")})).catch((function(t){(0,K.ZV)(t)||wd((function(n){return n.Model.CriticalError=t}))}))},n.prototype.componentDidMount=function(){this.setState({isMounted:!0})},n.prototype.componentDidUpdate=function(){this.pz(),this.bz(this.rz)},n.prototype.componentWillUnmount=function(){this.props.FormMaster.unobserve(this.As),this.setState({isMounted:!1})},n.prototype.bz=function(t){null!==t&&(this.yz(t),this.rz=null)},n.prototype.pz=function(){this.oz&&($("#body-scrollable-content").scrollTop(0),this.oz=!1)},n.prototype.yz=function(t){var n=$(".gradingGradeInput input")[t];n&&n.focus()},n.prototype.renderView=function(){var t=this;if(!this.state.isReadyToRender)return g.createElement("div",{className:"gradingViewContainer"},yd());var n=this.state.Form;n.calculateBranchedResponses();var e,i=n.getQuestions().length,r=n.getResponses().length;if(!i||!r||this.state.lastResponseDeleted){var o=i?(0,T.pm)().GradingView_NothingToBeGraded_GetAnswers_Message:(0,T.pm)().GradingView_NothingToBeGraded_AddQuestions_Message,s=(0,V.M)({FluentIcon:"Emoji Sad",HTMLAttributes:{className:"analyze-view-warning-icon forms-icon-size40x40",role:"presentation"}});return g.createElement("div",{className:"analyze-view-detail-noresponses-container gradingViewContainer"},this.includeTheme(),s,g.createElement("div",{className:"analyze-view-detail-noresponse-message"},(0,T.pm)().GradingView_NothingToBeGraded_Message),g.createElement("div",{className:"analyze-view-detail-noresponse-detail"},o))}switch(this.state.GradingMode){case zu.ByQuestion.View:var a=this.state.CurrentIndexForQuestionView,u=n.getWrappedForm().FormElementManager.TopQuestionMasters[a],c={Form:this.state.Form,CurrentQuestionIndex:a,CurrentQuestionMaster:u,UpdateParentCurrentQuestionIndex:this.wz(),UpdateGradeBoxIndexAfterWhichToSearchNextUngraded:function(n){t.vz=n},UpdateNextUngradedButtonState:function(){return t.setState({hasUngradedQuestions:null!==t.gz()})}};e=g.createElement(dm,(0,p.pi)({},c));break;case zu.ByStudent.View:var l={Form:this.state.Form,CurrentResponderIndex:this.state.CurrentIndexForStudentView,UpdateParentCurrentStudentIndex:this.Sz(),UpdateGradeBoxIndexAfterWhichToSearchNextUngraded:function(n){t.vz=n},UpdateNextUngradedButtonState:function(){return t.setState({hasUngradedQuestions:null!==t.gz()})},onDeleteLastResponse:function(){return t.setState({lastResponseDeleted:!0})}};e=g.createElement(pm,(0,p.pi)({},l))}var f=this.Nz();if(window.ClickReviewAnswersStart&&this.uz){var h=Date.now()-window.ClickReviewAnswersStart.getTime();(0,q.$U)("DesignPage.Responses.GradeResults",{Grading_ReviewAnswers_time:h}),this.uz=!1}return g.createElement("div",{className:"gradingViewContainer"},this.includeTheme(),f,g.createElement("div",{id:"gradingViewPrintChild"},e))},n.prototype.createAdditionalTopViewHeaderElements=function(){return[this.Cz()]},n.prototype.Nz=function(){var t=this,n="gradingGradingModeSwitcherNavBarButton office-form-theme-page-foreground-active",e=this.state.GradingMode===zu.ByStudent.View,i={className:(0,N.j)(n,this.sz&&"mouseDown-active",e&&"active"),role:"tab","aria-selected":e,"aria-controls":e?"grading-by-people-panel":null,id:"grading-by-people-tab",tabIndex:e?0:-1,onClick:function(){wd((function(t){var n=t.Model.Grading;t.Model.Grading={View:zu.ByStudent.View,Index:0,GoBackToView:n.GoBackToView}})),t.setState({GradingMode:zu.ByStudent.View,CurrentIndexForQuestionView:0,CurrentIndexForStudentView:0}),(0,q.$U)("Grading.PeopleTab.Click")},onKeyDown:function(n){39===n.keyCode&&t.Iz(n,t.fz,t.hz)}},r=this.state.GradingMode===zu.ByQuestion.View,o={className:(0,N.j)(n,this.az&&"mouseDown-active",r&&"active"),role:"tab","aria-selected":r,"aria-controls":r?"grading-by-question-panel":null,id:"grading-by-question-tab",tabIndex:r?0:-1,onClick:function(){wd((function(t){var n=t.Model.Grading;t.Model.Grading={View:zu.ByQuestion.View,Index:0,GoBackToView:n.GoBackToView}})),t.setState({GradingMode:zu.ByQuestion.View,CurrentIndexForQuestionView:0,CurrentIndexForStudentView:0}),(0,q.$U)("Grading.QuestionTab.Click")},onKeyDown:function(n){37===n.keyCode&&t.Iz(n,t.hz,t.fz)}},s=this.Tz({HTMLAttributes:i,Text:(0,T.pm)().GradingView_StudentMode_ButtonLabel,ref:this.fz},(function(n){t.sz=n})),a=this.Tz({HTMLAttributes:o,Text:(0,T.pm)().GradingView_QuestionMode_ButtonLabel,ref:this.hz},(function(n){t.az=n}));return g.createElement("div",null,g.createElement("div",{className:"gradingTitle office-form-theme-primary-foreground",role:"heading","aria-level":1},g.createElement(cr.D,{Text:(0,T.pm)().GradingView_Title.format(this.state.Form.getTitle()),RenderMode:"RichText",ContainsHtml:!0})),g.createElement("div",{className:"gradingGradingModeSwitcherNavBar"},g.createElement("div",{className:"gradingGradingModeSwitcherNavBarModeContainer",role:"tablist"},s,a)))},n.prototype.Iz=function(t,n,e){t.stopPropagation(),t.preventDefault();var i=n.current,r=e.current;r&&(r.focus(),r.getHtmlElement().setAttribute("tabindex","0"),i.getHtmlElement().setAttribute("tabindex","-1"))},n.prototype.gz=function(t){return(t=y.isUndefined(t)?this.state.Form:t)?this.state.GradingMode===zu.ByStudent.View?n.findNextUngradedAnswerForStudentView(t,this.state.CurrentIndexForStudentView,this.vz):n.findNextUngradedAnswerForQuestionView(t,this.state.CurrentIndexForQuestionView,this.vz):null},n.prototype.xz=function(t){this.state.GradingMode===zu.ByStudent.View?this.Fz(t):this.Pz(t)},n.prototype.Cz=function(){var t=this;return this.state.hasUngradedQuestions?this.Tz({HTMLAttributes:{className:"gradingTextButton gradingNextUngradedButton office-form-theme-button",onClick:function(){var n=t.gz();t.xz(n),(0,q.$U)("Grading.NextUngraded.Click")}},ButtonStyle:1,Text:(0,T.pm)().GradingView_NextUngraded_ButtonLabel}):this.Tz({HTMLAttributes:{className:"gradingTextButton gradingNextUngradedButton office-form-theme-button",disabled:!0},ButtonStyle:2,Text:(0,T.pm)().GradingView_NextUngraded_ButtonLabel})},n.prototype.Fz=function(t){null!=t&&(t.ViewElementIndex!==this.state.CurrentIndexForStudentView?(this.rz=t.GradeBoxIndex,this.Sz(!1)(t.ViewElementIndex)):this.yz(t.GradeBoxIndex))},n.findNextUngradedAnswerForStudentView=function(t,e,i){var r=t.getResponses().length-1,o=i+1,s=n.findNextUngradedAnswerForStudentViewInInterval(t,e,r,o);return null!==s?s:n.findNextUngradedAnswerForStudentViewInInterval(t,0,e,0)},n.findNextUngradedAnswerForStudentViewInInterval=function(t,e,i,r){for(var o=t.getResponses(),s=e;s<=i;s++){var a=o[s];if(a){var u=s===e?r:0,c=new Ed(t,a),l=n.findNextUngradedAnswerForStudent(c,u);if(null!==l)return{ViewElementIndex:s,GradeBoxIndex:l}}}return null},n.findNextUngradedAnswerForStudent=function(t,n){for(;t.hasNext();){var e=t.next();if(e)if(e.answerRenderOrderIndex>=n&&e.question.IsQuiz&&Td(e.answer))return e.answerRenderOrderIndex}return null},n.prototype.Pz=function(t){null!=t&&(t.ViewElementIndex!==this.state.CurrentIndexForQuestionView?(this.rz=t.GradeBoxIndex,this.wz(!1)(t.ViewElementIndex)):this.yz(t.GradeBoxIndex))},n.findNextUngradedAnswerForQuestionView=function(t,e,i){var r=t.getQuestions().filter((function(t){return!t.GroupId})).length-1,o=i+1,s=n.findNextUngradedAnswerForQuestionViewInInterval(t,e,r,o);return null!==s?s:n.findNextUngradedAnswerForQuestionViewInInterval(t,0,e,0)},n.findNextUngradedAnswerForQuestionViewInInterval=function(t,e,i,r){for(var o=y.filter(t.getQuestions(),(function(t){return!t.GroupId})),s=e;s<=i;s++){var a=o[s],u=Mo(t,a.Id);if(a&&a.IsQuiz){var c=s===e?r:0,l=void 0;if(Pd(a)){var f=Fd(t.getResponses(),u);l=new Md(f)}else l=new Ad(t,a.Id);var h=n.findNextUngradedAnswerForQuestion(l,c);if(null!==h)return{GradeBoxIndex:h,ViewElementIndex:s}}}return null},n.findNextUngradedAnswerForQuestion=function(t,n){for(;t.hasNext();){var e=t.next();if(e.answerRenderOrderIndex>=n&&Td(e.answer))return e.answerRenderOrderIndex}return null},n.prototype.Sz=function(t){var n=this;return void 0===t&&(t=!0),function(e){t&&(n.dz(),n.oz=!0),n.setState({CurrentIndexForStudentView:e}),wd((function(t){var i=t.Model.Grading;t.Model.Grading={View:n.state.GradingMode,Index:e,GoBackToView:i.GoBackToView}}))}},n.prototype.wz=function(t){var n=this;return void 0===t&&(t=!0),function(e){t&&(n.dz(),n.oz=!0),n.setState({CurrentIndexForQuestionView:e}),wd((function(t){var i=t.Model.Grading;t.Model.Grading={View:n.state.GradingMode,Index:e,GoBackToView:i.GoBackToView}}))}},n.prototype.As=function(t){this.mz()},n.prototype.Tz=function(t,n){return void 0===n&&(n=y.noop),t.HTMLAttributes=y.extend({onMouseDown:function(t){t.target.classList.add("mouseDown-active"),n(!0)},onBlur:function(t){t.target.classList.remove("mouseDown-active"),n(!1)}},t.HTMLAttributes),(0,Fr.E)(t)},n}(Sd),ym=function(t){function n(n){var e=t.call(this,n)||this;return e.Dz=g.createRef(),e.Mz=g.createRef(),e.Lz=g.createRef(),e.state={isReadyToRender:!1,releasedResponseSortBy:"Status",releasedResponseIsSortAscending:!1,unreleasedResponseSortBy:"Status",unreleasedResponseIsSortAscending:!1,checkedReponseIds:{},checkedAll:!1,releasedResponseIds:[],shouldShowInfoBar:!1,Form:new Id(n.FormMaster),isMounted:!0,scoresPosted:!1},e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this,n=this.state.Form;this.setState({isMounted:!0}),n.ensureReadyToGrade().then((function(){n.calculateBranchedResponses(),t.setState({isReadyToRender:!0,releasedResponseIds:(0,Cd.Lo)(n).map((function(t){return t.Id}))}),(0,q.$U)("Grading.ResultsView.Initial")})).catch((function(t){wd((function(n){return n.Model.CriticalError=t}))}))},n.prototype.componentDidMount=function(){cm(),this.setState({isMounted:!0})},n.prototype.componentWillUnmount=function(){this.setState({isMounted:!1})},n.prototype.renderView=function(){if(!this.state.isReadyToRender)return g.createElement("div",{className:"gradingReleaseResultsView gradingViewContainer"},yd());this.state.Form.calculateBranchedResponses();var t=this.wm(),n=this.Rz(),e=this.Az(),i=this.Ez();return g.createElement("div",{className:"gradingReleaseResultsView gradingViewContainer"},this.includeTheme(),t,n,e,i)},n.prototype.Oz=function(){var t=this,n=this.state.Form,e=this.state.releasedResponseIds.slice(),i=this.state.checkedReponseIds;for(var r in i)if(i.hasOwnProperty(r)&&i[r]){var o=Number(r);y.isNumber(o)&&(e.push(o),n.markAsReleased(o),(0,q.$U)("Grading.ResultsView.ReleaseIndividualResult",{responseId:r}))}this.setState({checkedAll:!1,checkedReponseIds:{},releasedResponseIds:e,scoresPosted:!0},(function(){t._z.focus()})),(0,q.$U)("Grading.ResultsView.ReleaseResults",{anyManuallyGradedResults:(0,Cd.uY)(n),isFormFullyReleased:(0,Cd.gt)(n)})},n.prototype.Bz=function(){var t=this,n=!1,e=this.state.checkedReponseIds;if(!y.isEmpty(e))for(var i in this.state.checkedReponseIds)e.hasOwnProperty(i)&&e[i]&&(n=!0);var r=function(){return t.Oz()},o=!1;return n||(r=Qd,o=!0),(0,Fr.E)({HTMLAttributes:{className:"office-form-theme-button gradingTextButton",onClick:r,disabled:o},ButtonStyle:1,Text:(0,T.pm)().GradingView_ReleaseResultButton_Label})},n.prototype.wm=function(){var t=this.state.Form,n=(0,T.pm)().GradingView_ReleaseResultViewTitle_LabelFormat.format(t.getTitle());return g.createElement("div",{className:"gradingReleaseResultTitleBarContainer"},g.createElement("div",{className:"gradingReleaseResultTitle gradingTitle office-form-theme-primary-foreground",role:"heading","aria-level":1},g.createElement(cr.D,{Text:n,RenderMode:"RichText",ContainsHtml:!0})),g.createElement("div",{className:"gradingReleaseResultButtonGroup"},this.Gz(),this.Bz(),this.state.scoresPosted?g.createElement("span",{className:"screenReaderVisible","aria-live":"polite"},(0,T.pm)().Scores_Posted):null))},n.prototype.Gz=function(){var t=this;return(0,z.F)({HTMLAttributes:{className:"gradingReleaseResultInfoButton office-form-theme-primary-foreground",onClick:function(){var n=t.state.shouldShowInfoBar;t.setState({shouldShowInfoBar:!n}),(0,q.$U)("Grading.ReleaseView.PostScoresInfoBar",{showInfoBar:!n})}},GlyphButtonStyle:"GlyphOnly",FluentIcon:"Question",IconClassName:"forms-icon-size16x16",Text:(0,T.pm)().GradingView_ReleaseResultInfoButton_Label,ref:function(n){return t._z=b.findDOMNode(n)}})},n.prototype.Rz=function(){var t=this;if(this.state.shouldShowInfoBar){var n=(0,T.pm)().GradingView_ReleaseResultFunctionalityDescription_Text,e=(0,z.F)({HTMLAttributes:{className:"gradingReleaseResultInfoBarCloseButton",onClick:function(){t.setState({shouldShowInfoBar:!1}),(0,q.$U)("Grading.ReleaseView.PostScoresInfoBar",{showInfoBar:!1}),t._z.focus()}},GlyphButtonStyle:"GlyphOnly",FluentIcon:"Dismiss",IconClassName:"forms-icon-size14x14",Text:(0,T.pm)().Common_Close_Text,ref:function(t){t&&t.focus()}}),i=g.createElement("div",{className:"gradingReleaseResultInfoBarTriangle"});return g.createElement("div",{className:"gradingReleaseResultInfoBar",tabIndex:0},n,e,i)}},n.prototype.Ez=function(){var t=this.state.Form.getResponses().map((function(t,n){return{response:t,index:n}})),n=this.state.releasedResponseIds,e=this.qz(!0,t.filter((function(t){return-1!==n.indexOf(t.response.Id)})));if(!e||0===e.length)return g.createElement("div",null);var i=this.Vz(!0),r=this.zz(!0),o=this.Qz(e);return g.createElement("div",null,i,g.createElement("div",{className:"gradingReleaseResultTableContainer",role:"grid"},r,o))},n.prototype.Az=function(){var t=this.state.Form.getResponses().map((function(t,n){return{response:t,index:n}})),n=this.state.releasedResponseIds,e=this.qz(!1,t.filter((function(t){return-1===n.indexOf(t.response.Id)})));if(!e||0===e.length)return g.createElement("div",null);var i=this.Vz(!1),r=this.zz(!1),o=this.Qz(e);return g.createElement("div",null,i,g.createElement("div",{className:"gradingReleaseResultTableContainer",role:"grid"},r,o))},n.prototype.Vz=function(t){var n=t?(0,T.pm)().GradingView_ReleasedResponseTableTitle_Label:(0,T.pm)().GradingView_UnreleasedResponseTableTitle_Label;return g.createElement("div",{className:"gradingReleaseResultTableTitle","aria-level":2,role:"heading"},n)},n.prototype.Uz=function(t){var n,e;switch(t){case 1:n=(0,T.pm)().Accessibility_SortColumnAscending,e="descending";break;case 2:n=(0,T.pm)().Accessibility_SortColumnDescending,e="ascending";break;default:n=(0,T.pm)().Accessibility_SortColumnToggleButton_Label+" "+(0,T.pm)().Accessibility_SortColumnAscending,e=void 0}return{label:"".concat((0,T.pm)().Common_Points_Text,": ").concat(n),sort:e}},n.prototype.$z=function(t){if(t){if("Points"===this.state.releasedResponseSortBy)return this.state.releasedResponseIsSortAscending?1:2}else if("Points"===this.state.unreleasedResponseSortBy)return this.state.unreleasedResponseIsSortAscending?1:2;return 0},n.prototype.Kz=function(t){switch(t){case 1:return"Arrow Down";case 2:return"Arrow Up";default:return"Arrow Sort"}},n.prototype.zz=function(t){var n=this,e=g.createElement("div",{title:(0,T.pm)().GradingView_PostGrades_NameColumnDescription},g.createElement("span",{"aria-label":(0,T.pm)().GradingView_PostGrades_NameColumnDescription},(0,T.pm)().GradingView_NameColumn_Label)),i=g.createElement("a",{className:"screenReaderVisible"},(0,T.pm)().GradingView_PostGrades_PreviewColumnDescription),r=g.createElement("div",{title:(0,T.pm)().GradingView_PostGrades_StatusColumnDescription},g.createElement("span",{"aria-label":(0,T.pm)().GradingView_PostGrades_StatusColumnDescription},(0,T.pm)().GradingView_ReleaseResultsStatus_Label)),o=this.$z(t),s=(0,V.M)({FluentIcon:this.Kz(o),HTMLAttributes:{className:"forms-icon-size16x16",role:"presentation"}}),a=this.Uz(o),u=(0,Dr.ax)({HTMLAttributes:{"aria-label":a.label,"aria-sort":a.sort,className:"gradingReleaseResultHeaderButton",onClick:function(){n.Jz(t,"Points")}},ButtonStyle:0,children:g.createElement("div",null,g.createElement("span",null,(0,T.pm)().Common_Points_Text),s)}),c=g.createElement("div",{className:"gradingReleaseResultTableCell gradingReleaseResultTableHeaderCell",role:"columnheader"},i);if(t)return g.createElement("div",{className:"gradingReleaseResultTableRow",role:"row"},g.createElement("div",{className:"gradingReleaseResultTableCell gradingReleaseResultTableHeaderCell",role:"columnheader"}),g.createElement("div",{className:"gradingReleaseResultTableCell gradingReleaseResultTableHeaderCell","aria-label":"This column contains the name of students",role:"columnheader"},e),c,g.createElement("div",{className:"gradingReleaseResultTableCell gradingReleaseResultTableHeaderCell gradingResultViewStatusColumn",role:"columnheader"},r),g.createElement("div",{className:"gradingReleaseResultTableCell gradingReleaseResultTableHeaderCell gradingResultViewPointsColumn",role:"columnheader"},u));var l=this.state.checkedAll,f=(0,jf.e)({Description:void 0,HelpText:(0,T.pm)().GradingView_PostGrades_SelectAllCheckbox_Description,Options:{HTMLPropsForInnerElement:{"aria-label":(0,T.pm)().GradingView_PostGrades_SelectAllCheckbox_Description}},Value:l,onValueChange:function(){var t=y.clone(n.state.checkedReponseIds);n.state.Form.getResponses().filter((function(t){return-1===n.state.releasedResponseIds.indexOf(t.Id)})).forEach((function(n){return t[n.Id]=!l})),n.setState({checkedReponseIds:t,checkedAll:!l})}});return g.createElement("div",{className:"gradingReleaseResultTableRow",role:"row"},g.createElement("div",{className:"gradingReleaseResultTableCell gradingReleaseResultTableHeaderCell gradingResultViewCheckBoxColumn",role:"columnheader"},f),g.createElement("div",{className:"gradingReleaseResultTableCell gradingReleaseResultTableHeaderCell",role:"columnheader"},e),c,g.createElement("div",{className:"gradingReleaseResultTableCell gradingReleaseResultTableHeaderCell gradingResultViewStatusColumn",role:"columnheader"},r),g.createElement("div",{className:"gradingReleaseResultTableCell gradingReleaseResultTableHeaderCell gradingResultViewPointsColumn",role:"columnheader"},u))},n.prototype.Jz=function(t,n){t?this.state.releasedResponseSortBy===n?this.setState({releasedResponseIsSortAscending:!this.state.releasedResponseIsSortAscending}):this.setState({releasedResponseSortBy:n,releasedResponseIsSortAscending:!1}):this.state.unreleasedResponseSortBy===n?this.setState({unreleasedResponseIsSortAscending:!this.state.unreleasedResponseIsSortAscending}):this.setState({unreleasedResponseSortBy:n,unreleasedResponseIsSortAscending:!1})},n.prototype.Qz=function(t){var n=this,e=this.state.Form;return t.map((function(t){var i,r=(0,Cd.Uo)(e,t.response.Id),o=(0,Cd.p3)(e,t.response.Id);if(-1!==n.state.releasedResponseIds.indexOf(t.response.Id))return n.Xz(3,t,o,r);var s=e.getQuestions().filter((function(t){return t.IsQuiz})),a=0,u=0;return y.forEach(t.response.Answers,(function(t){null!=y.find(s,(function(n){return t.QuestionId===n.Id}))&&(a++,null!=t.Score&&u++)})),i=a===u?2:0===u?0:1,n.Xz(i,t,o,r)}))},n.prototype.qz=function(t,n){return t&&"Points"===this.state.releasedResponseSortBy?this.Yz(n,this.state.releasedResponseIsSortAscending):t||"Points"!==this.state.unreleasedResponseSortBy?n:this.Yz(n,this.state.unreleasedResponseIsSortAscending)},n.prototype.tQ=function(t){var n=(0,Cd.p3)(this.state.Form,t.Id),e=(0,Cd.Uo)(this.state.Form,t.Id);return 0!==e?n/e:0},n.prototype.Yz=function(t,n){var e=this,i=t.slice();return n?i.sort((function(t,n){return e.tQ(n.response)-e.tQ(t.response)})):i.sort((function(t,n){return e.tQ(t.response)-e.tQ(n.response)})),i},n.prototype.Xz=function(t,n,e,i){var r,o,s,a,u=this,c=this.state.checkedReponseIds[n.response.Id];if(3===t)r=null;else{var l=(0,T.pm)().GradingView_PostGrades_SelectStudentCheckbox_AccessibilityTextFormat.format(n.response.ResponderName),f={Value:!0===c,Description:void 0,HelpText:l,Options:{HTMLPropsForInnerElement:{"aria-label":l}},onValueChange:function(){var t=y.clone(u.state.checkedReponseIds);t[n.response.Id]=!c,u.setState({checkedReponseIds:t,checkedAll:!1,scoresPosted:!1})}};r=(0,jf.e)(f)}switch(t){case 0:case 1:o="redText";break;case 3:case 2:o="greenText";break;default:o="blackText"}switch(t){case 3:s=(0,T.pm)().GradingView_ReleaseResultStatusReleased_Label;break;case 0:case 1:s=(0,T.pm)().GradingView_ReleaseResultStatusNeedsReview_Label;break;case 2:s=(0,T.pm)().GradingView_ReleaseResultStatusGraded_Label;break;default:s="unknown"}if(0===t)a=g.createElement("span",{"aria-label":(0,T.pm)().GradingView_NoScore},void 0,["— —"]);else{var h=e&&i?Math.round(e/i*100):0;a="{0} ({1}%)".format(e,h)}var d=function(t){return function(){wd((function(e){e.Model.Grading={View:zu.ByStudent.View,Index:n.index,GoBackToView:zu.GoBackToReleaseResults},e.showTopView("Grading_ReviewAnswers",(function(){t.current&&t.current.focus()}))})),(0,q.$U)("Grading.ResultsView.DeepLinkToStudent")}},m=(0,xd.Ai)(n.response).name,v=g.createElement("a",{href:"javascript:;",title:(0,T.pm)().GradingView_GoToStudentLink_LabelFormat.format(m),ref:this.Dz,"aria-label":(0,T.pm)().GradingView_GoToStudentLink_LabelFormat.format(m),onClick:d(this.Dz),className:"goToStudentLink"},g.createElement("span",null,m)),p=g.createElement("a",{href:"javascript:;",title:(0,T.pm)().GradingView_GoToStudentLink_LabelFormat.format(m),ref:this.Mz,"aria-label":(0,T.pm)().GradingView_PostGrades_ResponseStatus_AccessibilityLabelFormat.format(m,s),onClick:d(this.Mz),className:"goToStudentLink"},g.createElement("span",{className:o},s)),b=g.createElement("a",{href:"javascript:;",ref:this.Lz,title:(0,T.pm)().Common_Preview_Text,"aria-label":(0,T.pm)().GradingView_PostGrades_PreviewLink_AccessibilityLabelFormat.format(m),onClick:function(){wd((function(t){t.Model.Preview={PreviousTopView:"Grading_PostGrades",ResponseIndex:n.index},t.showTopView("Preview",(function(){u.Lz.current&&u.Lz.current.focus()}))})),(0,q.$U)("Grading.ResultsView.LinkToStudentPreview")},className:"goToStudentLink"},(0,T.pm)().Common_Preview_Text),w=g.createElement("div",{className:"gradingReleaseResultTableCell gradingResultViewPreviewColumn",role:"gridcell"},b);return g.createElement("div",{className:"gradingReleaseResultTableRow",key:n.response.Id,role:"row"},g.createElement("div",{className:"gradingReleaseResultTableCell gradingResultViewCheckBoxColumn",role:"gridcell"},r),g.createElement("div",{className:"gradingReleaseResultTableCell gradingResultViewResponderColumn",role:"gridcell"},um({response:n.response}),g.createElement("span",{className:"gradingReleaseResultResponderName"},v)),w,g.createElement("div",{className:"gradingReleaseResultTableCell gradingResultViewStatusColumn",role:"gridcell"},p),g.createElement("div",{className:"gradingReleaseResultTableCell gradingResultViewPointsColumn",role:"gridcell"},g.createElement("span",null,a)))},n}(Sd);function wm(){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(16).then(e.bind(e,31154))];case 1:return[2,{default:t.sent().SurveyIndividualViewContainer}]}}))}))}function Sm(t){var n=(0,$i.J)(Sm,wm);return g.createElement(Ui.Z,null,g.createElement(n,(0,p.pi)({},t)))}var Nm=function(t){function n(n){var e=t.call(this,n)||this;return e.vo=!0,e.cM=e.cM.bind(e),e.props.FormMaster.observe(e.cM,[F.x.Schema.ReputationTier]),e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this;this.props.FormMaster.ensureFieldsReady([F.x.Schema.Settings,F.x.Schema.ReputationTier]).then((function(){t.vo&&t.setState({IsFormSettingsReady:!0,ReputationTier:t.props.FormMaster.Model.ReputationTier})}))},n.prototype.componentWillUnmount=function(){this.props.FormMaster.unobserve(this.cM),this.vo=!1},n.prototype.renderView=function(){return this.state.IsFormSettingsReady?g.createElement("div",{className:"surveyResultsView"},g.createElement("div",{className:"surveyResultsTitle office-form-theme-primary-foreground",role:"heading","aria-level":1},(0,T.pm)().AnalyzeView_ViewResultsButton_Label),g.createElement("div",{id:"analyzeViewPrintParent",ref:"analyzeContainer"},g.createElement("div",{id:"analyzeViewPrintChild",className:"analyze-view-container results-view-container"},Sm({FormMaster:this.props.FormMaster}))),this.nQ()):g.createElement("div",null)},n.prototype.nQ=function(){if((0,K.NT)(this.state.ReputationTier)&&(0,St.M5)()&&this.props.FormMaster.SyncContext===eu.y.DesignTimeForm)return(0,ms.vw)({formId:this.props.FormMaster.Model.Id})},n.prototype.cM=function(){this.setState({ReputationTier:this.props.FormMaster.Model.ReputationTier})},n}(Sd);function Cm(t){var n,e,i,r=t.FormMaster;switch(t.TopView){case"Grading_ReviewAnswers":return n=r,e=t.Grading,i={FormMaster:n,UxState:e,key:"grading-".concat(n.getInstanceId())},g.createElement(bm,(0,p.pi)({},i));case"Grading_PostGrades":return function(t){var n={FormMaster:t,key:"grading-release-result-".concat(t.getInstanceId())};return g.createElement(ym,(0,p.pi)({},n))}(r);case"SurveyResults":return function(t){var n={Form:new Id(t),FormMaster:t,key:"suvey-result-".concat(t.getInstanceId()),TopViewTitle:(0,T.pm)().AnalyzeView_ViewResultsButton_Label};return g.createElement(Nm,(0,p.pi)({},n))}(r)}}var Im=function(t){function n(n){var e=t.call(this,n)||this;return e.eQ=e.eQ.bind(e),e.state={IsToggleEnable:!1,SuggestionEmailState:!0,UserFeatureSettingsData:null},e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this;(0,$r.yW)().then((function(n){t.setState({IsToggleEnable:!0,SuggestionEmailState:"true"===n.Items.FormsEmailNotifications.toString(),UserFeatureSettingsData:n})})).catch((function(){}))},n.prototype.render=function(){var t=this.state.SuggestionEmailState?(0,T.pm)().Intelligence_EmailAssistant_Toggle_State_False:(0,T.pm)().Intelligence_EmailAssistant_Toggle_State_True,n=(0,ch.i)({Disabled:!this.state.IsToggleEnable,HTMLAttributes:{className:"intelligence-email-assistant-setting-pane-toggle-item-title"},Label:t,onValueChange:this.eQ,Options:{classNameForInnerDiv:"setting-pane-toggle-button"},Value:!this.state.SuggestionEmailState});return g.createElement("div",{className:"intelligence-email-assistant-preference"},g.createElement("div",{className:"intelligence-email-assistant-Introduction"},g.createElement("div",{className:"intelligence-email-assistant-title"},(0,T.pm)().Intelligence_EmailAssistant_Title),g.createElement("div",{className:"intelligence-email-assistant-description"},(0,T.pm)().Intelligence_EmailAssistant_Description)),g.createElement("hr",{className:"intelligence-email-assistant-hr"}),g.createElement("div",{className:"intelligence-email-assistant-setting"},g.createElement("div",{className:"intelligence-email-assistant-setting-item"},g.createElement("div",{className:"intelligence-email-assistant-setting-item-title"},(0,T.pm)().Intelligence_EmailAssistant_Suggestion_Setting_Title),n,g.createElement("div",{className:"intelligence-email-assistant-setting-item-tip"},(0,T.pm)().Intelligence_EmailAssistant_Suggestion_Setting_Tip))))},n.prototype.eQ=function(){var t=this,n=this.state.UserFeatureSettingsData;n.Items.FormsEmailNotifications=!this.state.SuggestionEmailState,(0,$r.j0)(n).then((function(){t.setState({SuggestionEmailState:!t.state.SuggestionEmailState,UserFeatureSettingsData:n})}))},n}(J.r),Tm=e(13729),km=function(t){function n(n){var e=t.call(this,n)||this;return e.state={PrivacyUrl:"https://go.microsoft.com/fwlink/?LinkId=521839",ProTermUrl:"https://go.microsoft.com/fwlink/p/?linkid=2064713"},e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this;(0,sa.pw)().then((function(n){return t.setState({PrivacyUrl:n||""})}))},n.prototype.render=function(){var t=this,n=(0,et.pd)((function(){return t.state.PrivacyUrl}),et.t1),e={className:"portal-footer-link",onClick:function(){return(0,$s.K)(n)}},i=(0,et.pd)((function(){return(0,ef.bR)()}),et.t1),r={className:"portal-footer-link",onClick:function(){return(0,$s.K)(i)}},o=(0,et.pd)((function(){return"/Third_Party_Notices.txt"}),et.t1),s={className:"portal-footer-link",onClick:function(){return(0,$s.K)(o)}},a={className:"portal-footer-link",onClick:function(){return(0,$s.K)((0,Tm.nP)())}};return g.createElement("div",{className:"portal-footer",role:"contentinfo"},g.createElement("div",null,g.createElement("button",(0,p.pi)({},s),(0,T.pm)().Legal_Third_Party),g.createElement("button",(0,p.pi)({},r),(0,T.pm)().Legal_TermsOfService),g.createElement("button",(0,p.pi)({},e),(0,T.pm)().Form_Footer_PrivacyStatement),(0,Tm.XJ)()&&g.createElement("button",(0,p.pi)({},a),(0,Tm.ls)()),g.createElement("div",(0,p.pi)({},{className:"portal-footer-link"}),(0,T.pm)().Legal_Copyright.format((0,c.k0)().copyRightYear))))},n}(J.r),xm=function(t){function n(n){return t.call(this,n)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=g.createRef();return g.createElement("div",{className:"user-feature-settings-container"},g.createElement(Im,null),g.createElement(km,{ref:t}))},n}(J.r);var Fm=function(t){function n(n){var e=t.call(this,n)||this;e.vs=void 0,e.oQ=g.createRef(),e.uQ=function(){return e.cQ()};var i=(0,k.f5)();return i.observe(e.uQ,[i.Schema.FormMaster]),e.cQ(),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.rT&&this.rT.unobserve(this.uQ),(0,k.f5)().unobserve(this.uQ),window.clearTimeout(this.vs)},n.prototype.render=function(){return this.state.ShowMessageBar?g.createElement("div",{ref:this.oQ,className:"error-message-bar auto-saving-message-bar"},g.createElement("div",{className:"error-message-bar-message"},g.createElement(V.F,{FluentIcon:"Cloud Backup",HTMLAttributes:{className:"forms-icon-size14x14 error-message-bar-warning-icon auto-saving-message-bar-warning-icon"},key:"warningIcon"}),this.props.Message)):null},n.prototype.cQ=function(){var t=this,n=(0,k.f5)().Model.FormMaster;if(n!==this.rT&&(n&&n.observe(this.uQ,[n.Schema.IntegratedSavingState]),this.rT&&this.rT.unobserve(this.uQ),this.rT=n),this.rT)if("Saving"===this.rT.Model.IntegratedSavingState){window.clearTimeout(this.vs),this.vs=window.setTimeout((function(){(0,se.a)().RetryingRecoverableError&&t.lQ()}),1e4)}else this.fQ();else this.fQ()},n.prototype.lQ=function(){var t=this;this.setState({ShowMessageBar:!0},(function(){return $(t.oQ.current).stop().fadeIn("fast")}))},n.prototype.fQ=function(){var t=this;(0,se.a)().RetryingRecoverableError=!1,window.clearTimeout(this.vs),$(this.oQ.current).stop().fadeOut("slow",(function(){t.setState({ShowMessageBar:!1})}))},n}(J.r);function Pm(){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(48).then(e.bind(e,18604))];case 1:return[2,{default:t.sent().createCustomerVoiceIntroductionDialog}]}}))}))}function Dm(t){var n=(0,$i.J)(Dm,Pm);return g.createElement(Ui.Z,null,g.createElement(n,(0,p.pi)({},t)))}function Mm(){return(0,p.mG)(this,void 0,void 0,(function(){return(0,p.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.e(48).then(e.bind(e,66134))];case 1:return[2,{default:t.sent().createCustomerVoiceInfoBar}]}}))}))}function Lm(t){var n=(0,$i.J)(Lm,Mm);return g.createElement(Ui.Z,null,g.createElement(n,(0,p.pi)({},t)))}var Rm=e(70284),Am=function(t){function n(n){var e=t.call(this,n)||this;return e.np=e.np.bind(e),e.ep=e.ep.bind(e),e.state={ExpandMoreOptions:!1},e}return(0,p.ZT)(n,t),n.prototype.render=function(){var t="mobile-portal-more-container";this.state.ExpandMoreOptions&&(t=(0,N.j)(t,"active"));var n={children:g.createElement(V.F,{FluentIcon:"More Horizontal",HTMLAttributes:{className:"forms-icon-size20x20"}}),className:"mobile-portal-more-button",title:(0,T.pm)().Common_More_Options_Text};return g.createElement(Q.Th,{ButtonStyle:1,MenuItemType:0,ClassName:"mobile-portal-more-menu",ClassNameForContainer:t,HTMLAttributes:n,onMenuCollapse:this.np,onMenuExpand:this.ep},this.pp())},n.prototype.pp=function(){var t=(0,N.j)("mobile-portal-switch-icon"),n=(0,T.pm)().Mobile_PortalView_SwitchToPC;return[g.createElement(j.s,{Active:!0,key:"switch-pc-mobile",onClick:this.props.onClickSwitch},g.createElement("div",{className:"mobile-portal-switch-option"},g.createElement(V.F,{FluentIcon:"Phone Arrow Right",HTMLAttributes:{className:t}}),g.createElement("span",{className:"mobile-design-question-dropdown-text"},n)))]},n.prototype.np=function(){this.setState({ExpandMoreOptions:!1})},n.prototype.ep=function(){(0,q.$U)("PortalPage.MyForms.MoreMenu"),this.setState({ExpandMoreOptions:!0})},n}(J.r),Em=function(t){function n(n){var e=t.call(this,n)||this;return e.hQ=!1,e.vo=!0,e.state={FormSearchIsActive:!1},e.dQ=e.dQ.bind(e),e.mQ=e.mQ.bind(e),e.mQ(),e.vQ=function(t){return e.gQ(t)},e.hQ=(0,dt.lS)(),e}return(0,p.ZT)(n,t),n.prototype.componentDidUpdate=function(){this.props.Value&&n.markSearchContent(this.props.Value)},n.prototype.componentWillUnmount=function(){this.vo=!1},n.prototype.render=function(){var t,n=this,e=(0,V.M)({FluentIcon:"Search",HTMLAttributes:{className:"search-icon forms-icon-size20x20"}});t=this.hQ?(0,T.pm)().Portal_FormSearch_Search_Icon_Text_For_DelegatePage:(0,c.k0)().userInfo.IsMsa?(0,T.pm)().Portal_FormSearch_Search_Icon_Text_For_MSA:(0,T.pm)().Portal_FormSearch_Search_Icon_Text;var i={HTMLAttributes:{className:this.state.FormSearchIsActive?"portal-search-element is-active":"portal-search-element",onBlur:function(){return n.setState({FormSearchIsActive:!1})},onFocus:function(){return n.setState({FormSearchIsActive:!0})}},Label:"",MinimalHeight:(0,X.gj)(),onValueChange:this.vQ,Options:{HTMLPropsForInnerElement:{"aria-label":(0,T.pm)().Portal_FormSearch_AriaLabel}},Placeholder:t,TextFiledType:0,Value:this.props.Value},r=(0,ur.ZA)(i),o=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"portal-search-clear-button",onClick:this.dQ},FluentIcon:"Dismiss",IconClassName:"forms-icon-size16x16",Text:(0,T.pm)().Common_Close_Text}),s=this.props.ShowIconWhileSearch||!this.state.FormSearchIsActive,a=this.props.ShowIconWhileSearch||this.props.Value;return g.createElement("div",{className:"portal-search-container",role:"search"},s&&e,r,a&&o)},n.markSearchContent=function(t){if(n.markJSLoaded){var e=n.ensureMarkInstance();t&&e.mark(t,{className:"highlight-marked-strings",element:"span"})}},n.ensureMarkInstance=function(){var t=document.querySelectorAll(".searchable"),n=new Mark(t);return n.unmark(n),n},n.prototype.mQ=function(){var t=this;(0,Pr.y)("Mark").then((function(){n.markJSLoaded=!0,t.vo&&t.props.Value&&n.markSearchContent(t.props.Value)}))},n.prototype.gQ=function(t){this.props.onValueChange(t),t&&!n.useFormSearch&&(n.useFormSearch=!0,(0,q.$U)("PortalPage.SearchForms.UseFormSearch"))},n.prototype.pQ=function(){this.props.Value&&(n.ensureMarkInstance(),this.props.onValueChange(""),this.forceUpdate())},n.prototype.dQ=function(){this.pQ(),this.props.onClickClear&&this.props.onClickClear()},n.useFormSearch=!1,n}(J.r),Om=function(t){function n(n){var e=t.call(this,n)||this;return e.state={ExpandSearchBar:!1},e.yQ=e.yQ.bind(e),e.wQ=e.wQ.bind(e),e}return(0,p.ZT)(n,t),n.prototype.render=function(){return g.createElement("div",{className:"mobile-portal-search-container"},this.state.ExpandSearchBar?this.Mo():this.SQ())},n.prototype.Mo=function(){return g.createElement(Em,{onClickClear:this.yQ,onValueChange:this.props.onValueChange,ShowIconWhileSearch:!0,Value:this.props.Value})},n.prototype.SQ=function(){return g.createElement("button",{onClick:this.wQ,className:"button-control light-background-button"},(0,V.M)({FluentIcon:"Search",HTMLAttributes:{className:"search-big-icon forms-icon-size20x20"}}))},n.prototype.wQ=function(){_m(),this.setState({ExpandSearchBar:!0},this.props.expandOrCollapseSearch)},n.prototype.yQ=function(){_m(),this.setState({ExpandSearchBar:!1},this.props.expandOrCollapseSearch)},n}(J.r);function _m(){(0,q.$U)("PortalPage.SearchIcon.Click")}var Bm=e(6293),Hm=function(t){function n(n){var e=t.call(this,n)||this;return e.TT=g.createRef(),e.hQ=!1,e.state={BranchRuleDependency:!1,CopyToEnvDialogPrompted:!1,DataFetchPending:!1,DeleteConfirmDialogPrompted:!1,DuplicateRemoveDialogPrompted:!1,IsFormNotFound:!1,IsResponseCountReady:!1,IsThemeReady:!1,IsTitleReady:!0,ShowCardResponseCount:!0,ShowCardTheme:!0,ShowCardTitle:!0},e.vo=!0,e.hQ=(0,dt.lS)(),e.NQ=e.NQ.bind(e),e.CQ=e.CQ.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this,n=this.props.FormMaster;if(n){this.IQ=function(){return t.forceUpdate()};var e=F.x.Schema;n.observe(this.IQ,[e.ResponsesCount,e.SavingState,e.Title,e.Theme,e.Type]);var i=n.Synchronizer.Schema;n.Synchronizer.observe(this.IQ,[i.CreationFailed,i.CreationInProcess,i.CreationScheduled]);var r=[e.ResponsesCount,e.Theme,e.Settings];this.props.FormMaster.IsSharedForm&&r.push(e.SoftDeleted),n.ensureFieldsReady(r).then((function(){t.vo&&t.setState({IsResponseCountReady:!0,IsThemeReady:!0})})).catch((function(n){if(t.vo)switch(n&&n.innerCode&&parseInt(n.innerCode)){case 674:t.setState({IsFormNotFound:!0});break;case 639:t.setState({IsFormMoved:!0});break;case 707:t.setState({IsFormNoPermission:!0})}}))}},n.prototype.componentWillUnmount=function(){this.props.FormMaster&&(this.props.FormMaster.unobserve(this.IQ),this.props.FormMaster.Synchronizer.unobserve(this.IQ)),this.vo=!1},n.prototype.componentDidUpdate=function(){(0,Zs.CI)(this.props.FormMaster)},n.prototype.createThemeContent=function(){return this.state.IsFormNotFound?g.createElement("div",{className:"new-form-card-image",key:"theme",style:{backgroundColor:Vi.tu,backgroundImage:t.prototype.getBackgroundImageURL.call(this,this.getCardTitle())}}):t.prototype.createThemeContent.call(this)},n.prototype.createFooterContent=function(){if(!this.state.ShowCardResponseCount)return null;var n=this.props.FormMaster.Model;if(this.isFormOwnedByMe())return t.prototype.createFooterContent.call(this);var e=n.SharedFormOwnerName,i=(0,Qa.Y)({displayText:e?(0,Ua.c)(e):"",name:e,tooltip:e||n.OwnerId}),r=g.createElement("div",{className:"fl-displayname"},g.createElement("span",{className:"searchable"},e||""));return g.createElement("div",{className:"fl-owner-container",key:"owner"},g.createElement("div",{className:"fl-facepile"},i),r)},n.prototype.getErrorMessage=function(){return this.props.FormMaster.getQuestionError()},n.prototype.isFormOwnedByMe=function(){return this.props.FormMaster.Model.OwnerId===(0,c.k0)().userInfo.UserId||this.hQ},n.prototype.showFormStatus=function(){var t=this.props.FormMaster.SettingMaster.Model;return t.FormClosed?(0,T.pm)().PortalView_FormClosed_Text:t.TimerEnabledEnd&&Date.now()>Date.parse(t.EndTime)?(0,T.pm)().PortalView_FormExpired_Text:null},n.prototype.onClick=function(){this.props.FormMaster&&(0,q.$U)("PortalPage.MyForms.Load"),this.props.onClick(this.props.FormMaster)},n.prototype.getCardDescription=function(){if(this.isFormOwnedByMe())return t.prototype.getCardDescription.call(this);var n=this.props.FormMaster.Model;try{return(0,T.pm)().PortalView_FormCard_Shared.format(n.SharedFormOwnerName)}catch(t){throw(0,q.zU)("PortalPage.MyForms.GetCardDescription.Failure",{ownerId:this.props.FormMaster.Model.OwnerId,userId:(0,c.k0)().userInfo.UserId}),t}},n.prototype.getCardThemeName=function(){var t=this.props.FormMaster;return t.isFieldReady(t.Schema.Theme)?t.ThemeMaster.Model.Name:null},n.prototype.getCardThemeBackgroupUrl=function(){var t=this.props.FormMaster;return t.isFieldReady(t.Schema.Theme)?t.ThemeMaster.Model.BackgroundImage:null},n.prototype.getCardThemePrimaryColor=function(){var t=this.props.FormMaster;return t.isFieldReady(t.Schema.Theme)?t.ThemeMaster.Model.PrimaryColor:null},n.prototype.getCardTitle=function(){var t=this;return(0,et.pd)((function(){return t.props.FormMaster.Model.Title}),et.t1)},n.prototype.getCardType=function(){var t=this.props.FormMaster;return t.isFieldReady(F.x.Schema.Type)&&null!=t.Model.Type?t.Model.Type:""},n.prototype.getCardResponseCount=function(){var t=this.props.FormMaster;return t.isFieldReady(F.x.Schema.ResponsesCount)&&t.Model.ResponsesCount>0?t.Model.ResponsesCount:0},n.prototype.createCardOwnerContent=function(){if(this.isFormOwnedByMe())switch(this.props.FormMaster.Model.Category){case"Loop Poll":return g.createElement("div",{className:"fl-category-label fl-category-poll",key:"category-label",title:(0,T.pm)().Loop_FormCard_CategoryLabel});case"Poll":return g.createElement("div",{className:"fl-category-label fl-category-poll",key:"category-label",title:(0,T.pm)().OutlookAddin_FormCard_CategoryLabel});case"Teams Poll":return g.createElement("div",{className:"fl-category-label fl-category-poll",key:"category-label",title:(0,T.pm)().Teams_FormCard_CategoryLabel});case"assignments":return g.createElement("div",{className:"fl-category-label fl-category-assignments",key:"category-label",title:(0,T.pm)().Teams_Assignments_FormCard_CategoryLabel});default:return null}return null},n.prototype.createCardWarning=function(){return(0,Bm.w)(this.props.FormMaster)},n.prototype.createCardTypeContent=function(){return(0,Bm.h)(this.props.FormMaster)},n.prototype.createOtherContent=function(){var t=this,n=this.props.FormMaster;return this.state.IsThemeReady&&this.state.IsResponseCountReady&&(!n.Deleted||"Idle"!==n.Model.SavingState)&&!n.Synchronizer.Model.CreationFailed||this.hQ||this.state.IsFormNotFound||this.props.FormMaster.IsSharedForm&&(this.state.IsFormNoPermission||this.state.IsFormMoved)?[(0,et.pd)((function(){return t.TQ()}),et.t1),this.kQ(),this.UR(),!1]:null},n.prototype.createSpinner=function(){var n=this;return(0,et.pd)((function(){return t.prototype.createSpinner.call(n)}),et.t1)},n.prototype.shouldShowSpinner=function(){var t=this.props.FormMaster;if(!t)return!1;if(t.Model.TransferInProgress||t.Model.DeleteCollaborationPermission)return!0;return t.Deleted||t.Synchronizer.Model.CreationInProcess||t.Synchronizer.Model.CreationScheduled||!1},n.prototype.getStatusMessage=function(){var t=this.props.FormMaster;return t&&t.Model.TransferInProgress?(0,T.pm)().PortalView_FormCard_MoveInProgress:null},n.prototype.TQ=function(){var t=this;if(!this.shouldShowSpinner()&&!this.shouldHideDialogTriggerButton()){var n={"aria-disabled":this.state.ContentCovered,className:"fl-menu-button",onClick:function(){return t.setState({DuplicateRemoveDialogPrompted:!0,ContentCovered:!0})}};return(this.state.DuplicateRemoveDialogPrompted||this.state.DeleteConfirmDialogPrompted||this.state.CopyToEnvDialogPrompted)&&(n.className=(0,N.j)(n.className,"dn")),(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:n,FluentIcon:"More Horizontal",IconClassName:"forms-icon-size20x20",key:"triggerButton",ref:this.TT,Text:(0,T.pm)().Common_More_Options_Text,Tooltip:(0,T.pm)().PortalView_Menu_Tooltip})}},n.prototype.kQ=function(){var t=this,n=this.props.FormMaster,e=!this.isFormOwnedByMe();if(this.state.DuplicateRemoveDialogPrompted&&!this.shouldShowSpinner()){var i=[],r={ButtonStyle:2,GlyphButtonStyle:"Vertical",FluentIcon:e?"Pin Off":"Delete",IconClassName:e?"unpinIconClass":"",Key:"removeItem",onClick:function(){if(e){(0,q.$U)("PortalPage.OtherForms.Unpin");var i=t.props.onDeleteClick;i&&i(n),t.setState({DuplicateRemoveDialogPrompted:!1,ContentCovered:!1})}else(0,q.$U)("PortalPage.MyForms.MoveToRecycleBin"),(0,et.pd)((function(){t.setState({DeleteConfirmDialogPrompted:!0,DuplicateRemoveDialogPrompted:!1})}),et.t1)},Text:e?(0,T.pm)().PortalView_Unpin_Button:(0,T.pm)().Common_Delete_Text,TextClassName:"fl-menu-text"};if((0,C.w)(n,"DisableEditForm"))i.push(r);else{if(!this.hQ){if((0,et.pd)((function(){return t.props.FormMaster.IsSharedForm||"survey"!==t.props.FormMaster.Model.Type}),et.t1)){var o=this.xQ();i.push(o)}i.push(r)}if(!this.props.FormMaster.IsAssignmentForm&&!(0,c.k0)().userInfo.IsMsa&&!e)(0,et.pd)((function(){return"survey"!==t.props.FormMaster.Model.Type}),et.t1)&&i.push({ButtonStyle:2,GlyphButtonStyle:"Vertical",FluentIcon:"Folder Arrow Right",Key:"transferItem",onClick:function(n){t.props.onMoveClicked&&(t.FQ(),t.props.onMoveClicked(t.props.FormMaster))},Text:(0,T.pm)().PortalView_Move_Button,TextClassName:"fl-menu-text"})}var s={ButtonsProps:i,ClassName:"portal-view-form-card-copy-remove-container",key:"duplicateRemoveDialog",onBlur:function(){return t.setState({DuplicateRemoveDialogPrompted:!1,ContentCovered:!1})},onDismiss:function(){return t.FQ()},ShowDialog:this.state.DuplicateRemoveDialogPrompted};return(0,je.s)(s)}},n.prototype.xQ=function(){return{ButtonStyle:2,GlyphButtonStyle:"Vertical",FluentIcon:"Copy",Key:"duplicateItem",onClick:this.NQ,Text:(0,T.pm)().Common_Copy_Text,TextClassName:"fl-menu-text"}},n.prototype.NQ=function(){var t=this;(0,et.pd)((function(){var n=t.props.FormMaster;t.FQ();var e=t.props.onDuplicateClick;e&&e(n,{IsGroupForm:!1,OwnerId:(0,c.k0)().userInfo.UserId,OwnerTenantId:(0,c.k0)().userInfo.TenantId}),t.setState({DuplicateRemoveDialogPrompted:!1,ContentCovered:!1}),t.isFormOwnedByMe()?(0,q.$U)("PortalPage.MyForms.Duplicate"):(0,q.$U)("PortalPage.OtherForms.Duplicate")}),et.t1)},n.prototype.UR=function(){var t=this,n=!this.isFormOwnedByMe();if(this.state.DeleteConfirmDialogPrompted){var e=n?(0,T.pm)().PortalView_ConfirmUnpin_Button:(0,T.pm)().PortalView_Continue_Text,i={ButtonsProps:[{ButtonStyle:2,ClassName:"fl-menu-confirm-delete",GlyphButtonStyle:"Horizontal",Key:"deleteItem",onClick:function(){if(t.props.focusOut(b.findDOMNode(t)),(0,q.$U)("PortalPage.MyForms.ConfirmMoveToRecycleBin"),n){var e=t.props.onDeleteClick;e&&e(t.props.FormMaster)}else{var i=t.props.onSoftDeleteClick;i&&i(t.props.FormMaster)}t.setState({DeleteConfirmDialogPrompted:!1,ContentCovered:!1})},Text:n?(0,T.pm)().PortalView_ConfirmUnpin_Button:(0,T.pm)().PortalView_Continue_Button,Title:e},{ButtonStyle:2,ClassName:"fl-menu-confirm-delete",GlyphButtonStyle:"Horizontal",Key:"cancelItem",onClick:function(){(0,q.$U)("PortalPage.MyForms.CancelMoveToRecycleBin"),t.FQ(),t.setState({ContentCovered:!1})},Text:(0,T.pm)().Common_Cancel_Text,Title:(0,T.pm)().PortalView_Cancel_Text}],ClassName:"portal-view-form-card-delete-cancel-container",Description:(0,T.pm)().PortalView_MoveFormToRecycleBin_Warning_Text,key:"deleteConfirmDialog",onBlur:function(){return t.setState({DeleteConfirmDialogPrompted:!1,ContentCovered:!1})},onDismiss:function(){return t.FQ()},ShowDialog:this.state.DeleteConfirmDialogPrompted};return(0,je.s)(i)}},n.prototype.FQ=function(){if(this.TT.current){var t=this.TT.current.getHtmlElement();t&&(t.classList.remove("dn"),t.focus())}},n.prototype.MQ=function(){},n.prototype.RQ=function(){},n.prototype.CQ=function(t){},n}(hd.$),Gm=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.getCardThemeName=function(){return null},n.prototype.getCardThemeBackgroupUrl=function(){return null},n.prototype.getCardThemePrimaryColor=function(){return null},n.prototype.getCardTitle=function(){return""},n.prototype.getCardType=function(){return""},n.prototype.createCardOwnerContent=function(){return null},n.prototype.createCardWarning=function(){return null},n.prototype.createCardTypeContent=function(){return null},n.prototype.getCardResponseCount=function(){return 0},n}(hd.$),qm=function(t){function n(n){var e=t.call(this,n)||this;return e.AQ=g.createRef(),e.EQ=g.createRef(),e.OQ=g.createRef(),e._Q=g.createRef(),e.BQ=g.createRef(),e.GQ=g.createRef(),e.qQ=280,e.VQ=e.VQ.bind(e),e.eq=e.eq.bind(e),e.iq=e.iq.bind(e),e.zQ=e.zQ.bind(e),e.QQ=e.QQ.bind(e),e.UQ=e.UQ.bind(e),e.$Q=e.$Q.bind(e),e.jQ=e.jQ.bind(e),e.WQ=e.WQ.bind(e),e.state={MoreCreateOptionsExpanded:!1,ShowToggleTemplateButton:!0,TemplateDisplayState:"NotLoad",TemplateListQuota:0},e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){this.setState({TemplateDisplayState:"Show"}),this.KQ()},n.prototype.componentDidMount=function(){window.addEventListener("resize",this.WQ),window.addEventListener("UpdateMSATemplatePortalView",this.WQ),va(this.WQ),this.WQ()},n.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.WQ),ga(this.WQ)},n.prototype.render=function(){if("Hide"===this.state.TemplateDisplayState){var t=(0,z.F)({ButtonStyle:1,HTMLAttributes:{className:"template-new-form-button office-form-theme-button __template-new-form-button__",onClick:this.eq},FluentIcon:"Add",IconClassName:"forms-icon-size16x16 button-img",Text:(0,T.pm)().PortalView_NewFormTitle,TextClassName:"button-text"}),n=(0,z.F)({ButtonStyle:1,GlyphLocation:"Right",HTMLAttributes:{className:"template-icon-button office-form-theme-button-color __toggle-template-button__",onClick:this.jQ},FluentIcon:"Chevron Down",IconClassName:"forms-icon-size12x12",ref:this.OQ,Text:(0,T.pm)().MSATemplate_ShowTemplate_Button,TextClassName:"template-icon-button-text"});return g.createElement("div",{className:"portal-tiles"},g.createElement("div",{ref:this._Q},t,this.VQ(),this.state.ShowToggleTemplateButton&&n))}var e=(0,z.F)({ButtonStyle:1,GlyphLocation:"Right",HTMLAttributes:{className:"template-icon-button office-form-theme-button-color __toggle-template-button__",onClick:this.zQ},FluentIcon:"Chevron Up",IconClassName:"forms-icon-size12x12",ref:this.EQ,Text:(0,T.pm)().MSATemplate_HideTemplate_Button,TextClassName:"template-icon-button-text"}),i=(0,z.F)({ButtonStyle:1,GlyphLocation:"Right",HTMLAttributes:{className:"template-icon-button office-form-theme-button-color __more-templates-button__",onClick:this.JQ.bind(this,"PortalView")},FluentIcon:"Arrow Right",IconClassName:"forms-icon-size12x12",ref:this.BQ,Text:(0,T.pm)().MSATemplate_MoreTemplate_Button,TextClassName:"template-icon-button-text"});return g.createElement("div",{className:"portal-tiles"},g.createElement("div",{ref:this._Q},g.createElement("div",{className:"template-new-header"},g.createElement("h1",{className:"template-new"},(0,T.pm)().MSATemplate_New_Text),e),g.createElement(vd,{createCallback:this.props.createFormCallback,Origin:"PortalView",ref:this.AQ}),g.createElement(pd,{Origin:"PortalView",Quota:this.state.TemplateListQuota,updateTemplateList:this.WQ,viewTemplateHandler:this.props.viewTemplateHandler}),g.createElement("hr",{className:"template-hr"}),i))},n.prototype.eq=function(){this.props.createFormCallback("Form"),(0,q.$U)("MyTemplate.createForm",{Origin:"PortalViewTemplateHide"})},n.prototype.iq=function(){this.props.createFormCallback("Quiz"),(0,q.$U)("MyTemplate.createQuiz",{Origin:"PortalViewTemplateHide"})},n.prototype.VQ=function(){var t=[];t.push(g.createElement(j.s,{Active:!0,key:"newQuiz",onClick:this.iq},g.createElement("div",{className:"template-new-dropdown-option __template-new-quiz-dropdown-option__"},g.createElement(Z.z,{src:"/Images/icon-new-quiz-hover.png","aria-hidden":"true"}),g.createElement("span",{className:"tempate-new-dropdown-text"},(0,T.pm)().PortalView_NewQuizTitle)))),t.push(g.createElement(j.s,{Active:!0,key:"newFromTemplate",onClick:this.JQ.bind(this,"PortalView.MoreCreateOptions")},g.createElement("div",{className:"template-new-dropdown-option __more-templates-dropdown-option__"},g.createElement(V.F,{FluentIcon:"Document"}),g.createElement("span",{className:"tempate-new-dropdown-text"},(0,T.pm)().MSATemplate_MoreTemplate_Button))));var n={"aria-label":(0,T.pm)().MSATemplate_MoreCreateOptions,children:(0,V.M)({FluentIcon:this.state.MoreCreateOptionsExpanded?"Chevron Up":"Chevron Down",HTMLAttributes:{className:"forms-icon-size16x16"}}),className:(0,N.j)("template-new-more-button __template-more-create-options-button__",this.state.MoreCreateOptionsExpanded?"active":void 0),title:(0,T.pm)().MSATemplate_MoreCreateOptions},e=(0,N.j)("template-new-more-container office-form-theme-button",this.state.MoreCreateOptionsExpanded?"active":void 0);return g.createElement(Q.Th,{ButtonStyle:1,ClassName:"template-new-more-menu",ClassNameForContainer:e,DisableAdjustPopupPosition:!0,HTMLAttributes:n,MenuItemType:0,onMenuCollapse:this.QQ,onMenuExpand:this.UQ,ref:this.GQ},t)},n.prototype.QQ=function(){this.setState({MoreCreateOptionsExpanded:!1}),(0,q.$U)("PortalPage.TemplateGallery.MoreCreateOptions.Hide")},n.prototype.UQ=function(){this.setState({MoreCreateOptionsExpanded:!0}),(0,q.$U)("PortalPage.TemplateGallery.MoreCreateOptions.Show")},n.prototype.$Q=function(){"Show"===this.state.TemplateDisplayState&&this.BQ.current?this.BQ.current.focus():"Hide"===this.state.TemplateDisplayState&&this.GQ.current&&this.GQ.current.focus()},n.prototype.jQ=function(){var t=this;this.WQ(),this.setState({MoreCreateOptionsExpanded:!1,TemplateDisplayState:"Show"},(function(){t.EQ.current&&t.EQ.current.focus()})),Vm(!0),(0,q.$U)("PortalPage.TemplateGallery.Show")},n.prototype.zQ=function(){var t=this;this.setState({MoreCreateOptionsExpanded:!1,TemplateDisplayState:"Hide"},(function(){t.OQ.current&&t.OQ.current.focus()})),Vm(!1),(0,q.$U)("PortalPage.TemplateGallery.Hide")},n.prototype.JQ=function(t){(0,k.f5)().showTopView("MSATemplateGallery",this.$Q),(0,q.$U)("PortalPage.TemplateGallery.ViewMore",{Origin:t})},n.prototype.WQ=function(){var t=0;if(this._Q.current){var n=b.findDOMNode(this._Q.current),e=n&&n.parentElement?n.parentElement.parentElement:null;if(e){if(e.clientWidth<n.clientWidth)return void this.setState({ShowToggleTemplateButton:!1,TemplateDisplayState:"Hide"});if(0!==n.clientWidth){if(this.AQ.current){var i=b.findDOMNode(this.AQ.current);0!==i.clientWidth&&(this.qQ=i.clientWidth+30)}t=n.clientWidth/this.qQ-1}}}this.setState({ShowToggleTemplateButton:!0,TemplateListQuota:t}),gr=t},n.prototype.KQ=function(){var t=this,n=Rm.V.getInstance();n.fieldsReady([n.Schema.TemplateGalleryToggleState]).then((function(){n.Model.TemplateGalleryToggleState||t.setState({TemplateDisplayState:"Hide"})}))},n}(J.r);function Vm(t){var n=Rm.V.getInstance();n.fieldsReady([n.Schema.TemplateGalleryToggleState]).then((function(){n.Model.TemplateGalleryToggleState=t}))}var zm=function(t){function n(n){var e=t.call(this,n)||this;return e.vo=!0,e.ys=g.createRef(),e.state={AnimationLoaded:!1,RightPosition:0,ShowAnimation:!1,ShowEmptyImage:!1},e.ZQ=(new Date).getTime(),e.XQ=e.XQ.bind(e),e.YQ=e.YQ.bind(e),e.tU=e.tU.bind(e),e.nU=e.nU.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){this.tU(),va(this.nU)},n.prototype.componentDidUpdate=function(t){var n=this;if(this.props.RecycleBinFormCount!==t.RecycleBinFormCount&&this.props.GroupMaster===t.GroupMaster){this.setState({AnimationLoaded:!1,ShowAnimation:!0,ShowEmptyImage:0===t.RecycleBinFormCount});setTimeout((function(){n.vo&&n.setState({AnimationLoaded:!1,ShowAnimation:!1})}),1e3),this.ZQ=(new Date).getTime()}this.tU(),window.addEventListener("resize",this.tU)},n.prototype.componentWillUnmount=function(){this.vo=!1,window.removeEventListener("resize",this.tU),va(this.nU)},n.prototype.render=function(){var t;if(0===this.props.RecycleBinFormCount)return null;var n={ButtonStyle:1,HTMLAttributes:{"aria-label":(0,T.pm)().RecycleBin_EnterButtonText,className:"fl-content glyph-button-control-vertical",id:"fl-content-recycleBin",onClick:this.props.onClick,title:(0,T.pm)().RecycleBin_EnterButtonText},ref:this.ys},e=g.createElement(Dr.zx,(0,p.pi)({},n)),i=this.state.ShowEmptyImage?"/Images/emptyRecycleBinAnimation.gif?time="+this.ZQ:"/Images/recycleBinAnimation.gif?time="+this.ZQ,r=(0,et.pd)((function(){return"right"}),et.t1);return g.createElement("div",{className:"recycle-bin-button",style:(t={},t[r]=this.state.RightPosition+"px",t),title:!1},e,g.createElement(Z.z,{alt:(0,T.pm)().RecycleBin_EnterButtonText,className:"recycle-bin-button-animation-img",key:"recycleBinAnimation",onClick:this.YQ,onLoad:this.XQ,src:i,hidden:!this.state.ShowAnimation}),g.createElement(Z.z,{alt:(0,T.pm)().RecycleBin_EnterButtonText,className:"recycle-bin-button-img",key:"recycleBinImage",onClick:this.YQ,src:"/Images/fullRecycleBin_icon.png",hidden:this.state.ShowAnimation&&this.state.AnimationLoaded}))},n.prototype.focus=function(){this.ys.current&&this.ys.current.focus()},n.prototype.YQ=function(t){t.stopPropagation(),this.props.onClick()},n.prototype.XQ=function(){this.setState({AnimationLoaded:!0})},n.prototype.tU=function(){var t=document.getElementById("portalContentContainer");if(t){var e=t.offsetWidth-t.clientWidth+n.reservedWidthToRight;this.state.RightPosition!==e&&this.setState({RightPosition:e})}},n.prototype.nU=function(t,e){n.reservedWidthToRight=t?e.width:0,this.tU()},n.reservedWidthToRight=0,n}(J.r),Qm=function(){function t(){}return t.createFormsProAvailCallout=function(t,n,e,i,r,o,s,a){return g.createElement("div",{className:"firstrun-callout-container","aria-live":"polite"},g.createElement("div",{className:i},g.createElement("div",{className:r}),g.createElement("div",{className:o},n),g.createElement("div",{className:s},t),g.createElement("div",{className:a},e)))},t.createText=function(t,n){return n?g.createElement("div",{className:n},t):g.createElement("div",{className:"teaching-callout-text"},t)},t}(),Um=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Rx=function(){return n.forceUpdate()},n}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){var t=(0,ws.b4)();t.observe(this.Rx,[ws.TS.Schema.PortalFormIntroduction]),t.observe(this.Rx,[ws.TS.Schema.FormsProAvailableTeachingCallout])},n.prototype.componentWillUnmount=function(){(0,ws.b4)().unobserve(this.Rx)},n.prototype.render=function(){var t=(0,ws.b4)().Model,n=ws.BT.toString();if(!(0,ws.OT)(t.PortalFormIntroduction)&&(0,ws.OT)(t.FormsProAvailableTeachingCallout)){var e=Qm.createText((0,T.pm)().FormsProAvailableTeachingCallout_Body,"teachingCallout-formsproavailable-text"),i=this.createButton(this.onClickFooterButton,"formsproavailable-callout-footerbutton",(0,T.pm)().FormsProAvailableTeachingCallout_ButtonText,(0,T.pm)().FormsProAvailableTeachingCallout_ButtonText),r=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"formsproavailable-callout-closebutton",onClick:function(){return t.FormsProAvailableTeachingCallout=n}},FluentIcon:"Dismiss",IconClassName:"forms-icon-size14x14",Text:(0,T.pm)().Common_Close_Text});return Qm.createFormsProAvailCallout(e,r,i,"teachingCallout-formsproavailable","teachingCallout-formsproavailable-direction","formsproavailable-callout-closetextwrap","formsproavailable-callout-textwrap","formsproavailable-callout-footertextwrap")}return null},n.prototype.onClickFooterButton=function(){(0,q.$U)("DesignPage.FormsProAvailableTeachingCallout.ShowMe"),(0,ws.b4)().Model.FormsProAvailableTeachingCallout=ws.BT.toString();var t=(0,k.f5)();t.bulkEdit((function(){t.Model.TopView="ShowProFRE"}))},n.prototype.createButton=function(t,n,e,i){return(0,Fr.E)({ButtonStyle:1,HTMLAttributes:{className:n,onClick:t,title:i},Text:e})},n}(J.r);function $m(){return(0,ws.OT)((0,ws.b4)().Model.PortalFormIntroduction)}var jm=function(t){function n(n){var e=t.call(this,n)||this;return e.state={ClosePopUp:!1},e.eU=e.eU.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){this.iU()&&(0,q.$U)("PortalPage.FormIntroductionDialog.Navigate")},n.prototype.componentDidMount=function(){(0,kr.mZ)(b.findDOMNode(this)),this.nt=(new Date).getTime()/1e3},n.prototype.render=function(){return this.iU()?this.rU():null},n.prototype.iU=function(){return $m()&&!this.state.ClosePopUp},n.prototype.eU=function(t){27===t.keyCode&&(this.KI("PortalPage.FormIntroductionDialog.Close"),this.setState({ClosePopUp:!0}))},n.prototype.qf=function(){var t=this;return(0,z.F)({HTMLAttributes:{className:"form-introduction-dialog-close-button",onClick:function(){t.KI("PortalPage.FormIntroductionDialog.Close"),t.setState({ClosePopUp:!0})}},ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",FluentIcon:"Dismiss",IconClassName:"form-introduction-dialog-close-icon forms-icon-size14x14",Text:(0,T.pm)().Common_Close_Text})},n.prototype.Hd=function(t,n){return g.createElement("div",{className:"form-introduction-dialog-image"},g.createElement("img",{role:"presentation","aria-hidden":"true",src:t,alt:n}),g.createElement("div",{className:"form-introduction-dialog-image-text"},n))},n.prototype.oU=function(){var t=this;return(0,Fr.E)({HTMLAttributes:{autoFocus:!0,className:"form-introduction-dialog-button",onClick:function(){t.KI("PortalPage.FormIntroductionDialog.CreatNewForm"),t.props.createFormHandler()}},ButtonStyle:1,Text:(0,T.pm)().Form_Introduction_Dialog_Create_Form_Button,ref:"createFormButton"})},n.prototype.sU=function(){var t=g.createElement("div",{className:"form-introduction-dialog-image-container"},this.Hd((0,zi.Jn)("/Images/PortalMyForms/Forms_info_1.png"),(0,T.pm)().Form_Introduction_Dialog_Introduction_1),this.Hd((0,zi.Jn)("/Images/PortalMyForms/Forms_info_2.png"),(0,T.pm)().Form_Introduction_Dialog_Introduction_2),this.Hd((0,zi.Jn)("/Images/PortalMyForms/Forms_info_3.png"),(0,T.pm)().Form_Introduction_Dialog_Introduction_3));return g.createElement("div",{className:"form-introduction-dialog-container"},t,this.oU())},n.prototype.rU=function(){var t=g.createElement("div",{className:"form-introduction-dialog-title-container"},g.createElement("div",{className:"form-introduction-dialog-title"},(0,T.pm)().Form_Introduction_Dialog_Title1.format(this.aU())),g.createElement("div",{className:"form-introduction-dialog-title"},(0,T.pm)().Form_Introduction_Dialog_Title2),g.createElement("div",{className:"form-introduction-dialog-subtitle"},(0,T.pm)().LandingPage_Form_Introduction));return g.createElement("div",{className:"form-introduction-dialog-div"},g.createElement("div",{className:"form-introduction-dialog-get-start-container",onKeyUp:this.eU},t,this.sU(),this.qf()))},n.prototype.aU=function(){var t=(0,c.k0)().userInfo.GivenName||(0,c.k0)().userInfo.DisplayName;return t||(0,q.zU)("MissingUserName",{displayName:!!(0,c.k0)().userInfo.DisplayName,givenName:!!(0,c.k0)().userInfo.GivenName,userId:!!(0,c.k0)().userInfo.UserId}),t},n.prototype.KI=function(t){var n=(new Date).getTime()/1e3-this.nt;(0,q.$U)(t,{duration:n}),(0,ws.b4)().Model.PortalFormIntroduction=ws.BT.toString(),this.props.onDialogClose&&this.props.onDialogClose()},n}(J.r);function Wm(t){(0,Dn.gB)("/Pages/DesignPage.aspx?origin=PortalPage#FormId=".concat(t))}function Km(t,n){var e="/Pages/DesignPage.aspx?origin=PortalPage#Action=Create";"Quiz"===t&&(e="/Pages/DesignPage.aspx?origin=PortalPage#Action=CreateQuiz"),n&&(e="".concat(e,"&GroupId=").concat(n)),(0,Dn.gB)(e)}var Jm=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.state={AreMembersReady:!1,IsGroupInfoReady:!1},n.vo=!0,n.al=y.uniqueId("PortalViewGroupBar"),n}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this,n=this.props.GroupMaster;n&&(n.ensureFieldsReady([n.Schema.members]).then((function(){t.vo&&t.setState({AreMembersReady:!0})})),n.ensureFieldsReady([n.Schema.classification,n.Schema.emailAddress,n.Schema.visibility]).then((function(){t.vo&&t.setState({IsGroupInfoReady:!0})})))},n.prototype.componentWillUnmount=function(){this.vo=!1},n.prototype.render=function(){return this.props.GroupMaster?g.createElement("div",{className:"portal-view group-bar"},this.dc(),this.uU(),this.cU(),this.lU(),this.fU()):null},n.prototype.uU=function(){if(!this.state.IsGroupInfoReady||!this.state.AreMembersReady)return null;var t=this.props.GroupMaster.Model,n=t.classification,e=t.visibility;"public"===e.toLocaleLowerCase()?e=(0,T.pm)().PortalView_GroupForms_PublicGroup:"private"===e.toLocaleLowerCase()&&(e=(0,T.pm)().PortalView_GroupForms_PrivateGroup);var i=e||"";return n&&(i+=" ( ".concat(n," )")),g.createElement("div",{className:"group-info"},g.createElement("span",null,i))},n.prototype.cU=function(){return this.state.AreMembersReady&&this.state.IsGroupInfoReady?g.createElement("div",{className:"group-info-cutting-line"}):null},n.prototype.lU=function(){if(!this.state.AreMembersReady||!this.state.IsGroupInfoReady)return null;var t=this.props.GroupMaster,n=this.hU().map((function(n){var e=n.displayName,i=g.createElement(Ff.H,{DisplayName:n.displayName,Photo:t.getMemberPhoto(n.id),PhotoType:0,HideName:!0,key:n.id});return g.createElement("div",{className:"group-member-photo",key:e},i)}));return g.createElement("div",{className:"group-members"},n)},n.prototype.fU=function(){if(!this.state.AreMembersReady||!this.state.IsGroupInfoReady)return null;var t,n=this.props.GroupMaster.Model.members.length;if(n<1)throw Error("Group members count can not be smaller than 1.");t=1===n?"1 ".concat((0,T.pm)().GroupView_GroupInfoBar_Member_Text):n>=100?"99+ ".concat((0,T.pm)().GroupView_GroupInfoBar_Members_Text):"".concat(n.toString()," ").concat((0,T.pm)().GroupView_GroupInfoBar_Members_Text);var e=(0,ht.yv)()?"https://outlook.office.com/owa/?path=/group/".concat(this.props.GroupMaster.Model.emailAddress,"/people"):"javascript:void(0)",i=this.al+"-link-description",r=this.hU().map((function(t){return t.displayName})).join((0,T.pm)().Common_ItemSeperator),o=(0,T.pm)().PortalView_GroupForms_MemberLinkDescription.format(t,r),s=g.createElement("a",{href:e,rel:"noreferrer",target:"_blank","aria-describedby":i},t);return g.createElement("div",{className:"group-members-count"},s,g.createElement("span",{id:i,style:{display:"none"}},o))},n.prototype.hU=function(){var t=this.props.GroupMaster,n=t.Model.members.length,e=_.d.convertToArray(t.Model.members);return n>3&&(e=e.slice(0,3)),e},n.prototype.dc=function(){return this.state.AreMembersReady&&this.state.IsGroupInfoReady?null:g.createElement("div",{className:"spinner-tile-animation",key:"groupInfo"})},n}(J.r),Zm=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.state={IsFormsCountReady:!1,IsGroupPhotoReady:!1,ShowFormsCount:!0,ShowGroupPhoto:!0},n.vo=!0,n}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this,n=this.props.GroupMaster;n.ensureFieldsReady([n.Schema.formReferences]).then((function(){t.vo&&((0,q.$U)("PortalPage.GroupFormsPortal.Group.FormsCount",{formsCount:n.Model.formReferences.length,groupId:n.Model.id}),t.setState({IsFormsCountReady:!0}))})),n.Photo.then((function(){t.vo&&t.setState({IsGroupPhotoReady:!0})}))},n.prototype.componentWillUnmount=function(){this.vo=!1},n.prototype.render=function(){var t={className:"fl-group-content",onClick:this.onClick.bind(this)},n={ButtonStyle:1,children:[this.dU(),this.mU()],HTMLAttributes:t,key:"card-content"},e=g.createElement(Dr.zx,(0,p.pi)({},n));return g.createElement("div",{className:"fl-history-tile fl-tile fl-group-tile",tabIndex:0},e)},n.prototype.onClick=function(){this.state.IsFormsCountReady&&(0,q.$U)("PortalPage.GroupFormsPortal.GroupCard.Click"),this.props.createGroupFormsPortal(this.props.GroupMaster)},n.prototype.dU=function(){var t=this.props.GroupMaster;return g.createElement(Ff.H,{DisplayName:t.Model.displayName,Photo:t.Photo,PhotoType:1,key:t.Model.id})},n.prototype.mU=function(){if(!this.state.IsFormsCountReady)return g.createElement("div",{className:"common-spinner-circle portal-recent-visit-groupForm-spinner"});var t,n=this.props.GroupMaster,e=y.filter(n.Model.formReferences,(function(t){return y.isEqual(t.softDeleted,Si.d.Normal)})).length;switch(e){case 0:t=(0,T.pm)().PortalView_GroupForms_FormsCount_0_Text.format(e.toString());break;case 1:t=(0,T.pm)().PortalView_GroupForms_FormsCount_1_Text.format(e.toString());break;default:t=(0,T.pm)().PortalView_GroupForms_FormsCount_Multiple_Text.format(e.toString())}return g.createElement("span",{className:"fl-formscount",key:"group-forms-count"},t)},n}(J.r),Xm=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.vU="",n.pU=-1,n}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this,n=wi.Z.getInstance();n.ensureFieldsReady([n.Schema.MruDocuments]).then((function(){if(t.pU!==n.Model.MruDocuments.length){switch(t.pU=n.Model.MruDocuments.length,t.pU){case 0:t.vU=(0,T.pm)().PortalView_GroupForms_FormsCount_0_Text.format(t.pU.toString());break;case 1:t.vU=(0,T.pm)().PortalView_GroupForms_FormsCount_1_Text.format(t.pU.toString());break;default:t.vU=(0,T.pm)().PortalView_GroupForms_FormsCount_Multiple_Text.format(t.pU.toString())}t.setState({IsFormsCountChanged:!0})}}))},n.prototype.render=function(){var t=g.createElement(Ff.H,{DisplayName:(0,T.pm)().PortalView_GroupForms_MruCard_Title_Text,Photo:(0,Ft.eX)(),PhotoType:2,key:"recent-group-forms"}),n=g.createElement("span",{className:"fl-formscount",key:"recent-group-forms-count"},this.vU);if(""===this.vU){n=g.createElement(qa.P,(0,p.pi)({},{ClassName:"recent-visit-groupForm-spinner",Ignorable:!1},{key:"group-forms-count-spinner"}))}var e={ButtonStyle:1,children:[t,n],HTMLAttributes:{className:"fl-group-content",onClick:this.props.createGroupMruFormsPortal}},i=g.createElement(Dr.zx,(0,p.pi)({},e));return g.createElement("div",{className:"fl-history-tile fl-tile fl-group-tile",key:"mru-card",tabIndex:0},i)},n}(J.r),Ym="PortalPage.GroupFormsPortal.GroupBar.Click",tv=function(t){function n(n){var e=t.call(this,n)||this;return e.yU=g.createRef(),e.vo=!0,e.al=y.uniqueId("PortalViewDropdownGroupList"),e.SU=e.al+"-group-description",e.NU=e.NU.bind(e),e.IU=e.IU.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this,n=this.props.GroupManager;n.ensureFieldsReady([n.Schema.groups]).then((function(){t.vo&&((0,q.$U)("PortalPage.GroupFormsPortal.GroupsCount",{groupsCount:n.Groups.length}),t.setState({AreGroupsReady:!0}))})),(0,k.f5)().observe((function(){return t.forceUpdate}),[(0,k.f5)().Schema.ShowGroupListInPortal])},n.prototype.render=function(){var t="portal-view group-view";return this.props.ShouldShowGroups&&(t=(0,N.j)(t,"expand")),g.createElement("div",{className:t},this.TU(),this.kU(),this.FU())},n.prototype.componentDidUpdate=function(){this.props.ShouldShowGroups?(0,kr.mZ)(b.findDOMNode(this)):(0,kr.b6)(b.findDOMNode(this))},n.prototype.componentWillUnmount=function(){this.vo=!1},n.prototype.TU=function(){var t,n,e=this;this.props.SelectedGroup?(n=this.props.SelectedGroup.Model.displayName,t=g.createElement(Ff.H,{DisplayName:n,Photo:this.props.SelectedGroup.Photo,PhotoType:1,key:this.props.SelectedGroup.Model.id})):(n=(0,T.pm)().PortalView_GroupForms_MruCard_Title_Text,t=g.createElement(Ff.H,{DisplayName:n,Photo:(0,Ft.eX)(),PhotoType:2,key:"recent-group-forms"}));var i={"aria-expanded":this.props.ShouldShowGroups,"aria-haspopup":!0,"aria-label":n,className:"group-select-group",onClick:function(){(0,q.$U)(Ym),e.props.showGroupsCallback(!e.props.ShouldShowGroups)},onKeyDown:function(t){switch((0,q.$U)(Ym),t.keyCode){case 13:e.props.showGroupsCallback(!e.props.ShouldShowGroups);break;case 27:e.props.showGroupsCallback(!1)}},ref:this.yU,role:"button",tabIndex:0};return this.props.SelectedGroup&&(i["aria-describedby"]=this.SU),g.createElement("div",{className:"group-select-placeholder"},g.createElement("div",(0,p.pi)({},i),t,this.Mf()),this.PU())},n.prototype.kU=function(){return this.props.ShouldShowGroups?g.createElement("div",{className:"group-list-scroll-content"},g.createElement("div",{className:"group-list-view"},this.DU(),this.MU())):null},n.prototype.FU=function(){var t=(0,k.f5)().Model;return this.props.ShouldShowGroups?t.ShowGroupListInPortal=!0:t.ShowGroupListInPortal=!1,g.createElement("div",{className:"group-view-mask",onClick:this.props.showGroupsCallback.bind(this,!1)})},n.prototype.NU=function(t){this.RU(t),this.props.showGroupsCallback(!1)},n.prototype.MU=function(){var t=this;return this.state.AreGroupsReady?this.props.GroupManager.Groups.map((function(n){var e={createGroupFormsPortal:t.NU,GroupMaster:n};return g.createElement(Zm,(0,p.pi)({key:"group-card-".concat(n.Model.id)},e))})):null},n.prototype.IU=function(){this.RU(),this.props.showGroupsCallback(!this.props.ShouldShowGroups)},n.prototype.DU=function(){var t={createGroupMruFormsPortal:this.IU};return g.createElement(Xm,(0,p.pi)({key:"mru-card"},t))},n.prototype.Mf=function(){return(0,V.M)({FluentIcon:this.props.ShouldShowGroups?"Chevron Up":"Chevron Down",HTMLAttributes:{className:"select-placeholder-arrow forms-icon-size16x16"}})},n.prototype.PU=function(){return this.props.ShouldShowGroups?null:g.createElement(Jm,{GroupDescriptionId:this.SU,GroupMaster:this.props.SelectedGroup})},n.prototype.RU=function(t){this.yU.current&&this.yU.current.focus(),this.props.onGroupCardClick(t)},n}(J.r);var nv=e(16240),ev=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.state={DeleteConfirmDialogPrompted:!1,DuplicateRemoveDialogPrompted:!1,IsCorruptedForm:!1,IsResponseCountReady:!1,IsThemeReady:!1,IsTitleReady:!0,ShowCardResponseCount:!0,ShowCardTheme:!0,ShowCardTitle:!0},n.vo=!0,n.TT=g.createRef(),n}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this,n=this.props.FormMaster;if(n){this.IQ=function(){return t.forceUpdate()};var e=F.x.Schema;n.observe(this.IQ,[e.ResponsesCount,e.SavingState,e.Title,e.Theme]);var i=n.Synchronizer.Schema;n.Synchronizer.observe(this.IQ,[i.CreationFailed,i.CreationInProcess,i.CreationScheduled]),n.ensureFieldsReady([F.x.Schema.ResponsesCount,F.x.Schema.Theme]).then((function(){t.vo&&t.setState({IsResponseCountReady:!0,IsThemeReady:!0})}),(function(n){649===n.innerCode&&t.setState({IsCorruptedForm:!0})}))}},n.prototype.componentWillUnmount=function(){var t=this.props.FormMaster;t&&(t.unobserve(this.IQ),t.Synchronizer.unobserve(this.IQ)),this.vo=!1},n.prototype.onClick=function(){this.props.onClick(this.props.FormMaster)},n.prototype.getCardDescription=function(){return this.state.ShowCardResponseCount&&this.state.IsResponseCountReady?(0,T.pm)().PortalView_FormCard_Responses.format(this.getCardResponseCount()):null},n.prototype.getCardThemeName=function(){var t=this.props.FormMaster;return t.isFieldReady(t.Schema.Theme)?t.ThemeMaster.Model.Name:null},n.prototype.getCardThemeBackgroupUrl=function(){var t=this.props.FormMaster;return t.isFieldReady(t.Schema.Theme)?t.ThemeMaster.Model.BackgroundImage:null},n.prototype.getCardThemePrimaryColor=function(){var t=this.props.FormMaster;return t.isFieldReady(t.Schema.Theme)?t.ThemeMaster.Model.PrimaryColor:null},n.prototype.getCardTitle=function(){var t=this;return(0,et.pd)((function(){return t.props.FormMaster.Model.Title}),et.t1)},n.prototype.getCardType=function(){var t=this.props.FormMaster;return t.isFieldReady(F.x.Schema.Type)&&null!=t.Model.Type?t.Model.Type.toLowerCase():""},n.prototype.getCardResponseCount=function(){var t=this.props.FormMaster;return t.isFieldReady(F.x.Schema.ResponsesCount)&&t.Model.ResponsesCount>0?t.Model.ResponsesCount:0},n.prototype.createCardOwnerContent=function(){var t=this.props.FormMaster;if(t.isFieldReady(t.Schema.Category))switch(t.Model.Category){case"Loop Poll":return g.createElement("div",{className:"fl-category-label fl-category-poll",key:"category-label",title:(0,T.pm)().Loop_FormCard_CategoryLabel});case"Poll":return g.createElement("div",{className:"fl-category-label fl-category-poll",key:"category-label",title:(0,T.pm)().OutlookAddin_FormCard_CategoryLabel});case"Teams Poll":return g.createElement("div",{className:"fl-category-label fl-category-poll",key:"category-label",title:(0,T.pm)().Teams_FormCard_CategoryLabel});case"assignments":return g.createElement("div",{className:"fl-category-label fl-category-assignments",key:"category-label",title:(0,T.pm)().Teams_Assignments_FormCard_CategoryLabel});default:return null}return null},n.prototype.createCardWarning=function(){return(0,Bm.w)(this.props.FormMaster)},n.prototype.createCardTypeContent=function(){return(0,Bm.h)(this.props.FormMaster)},n.prototype.createOtherContent=function(){var t=this.props.FormMaster;return this.state.IsThemeReady&&this.state.IsResponseCountReady&&(!t.Deleted||"Idle"!==t.Model.SavingState)&&!t.Synchronizer.Model.CreationFailed||this.state.IsCorruptedForm?[this.TQ(),this.kQ(),this.UR()]:null},n.prototype.shouldShowSpinner=function(){var t=this.props.FormMaster;if(!t)return!1;if(t.Model.DeleteCollaborationPermission)return!0;var n=!1;return t.isFieldReady(t.Schema.MovingToRecycleBin)&&(n=t.Model.MovingToRecycleBin),t.Deleted||n||t.Synchronizer.Model.CreationInProcess||t.Synchronizer.Model.CreationScheduled||!t.isFieldReady(F.x.Schema.Id)},n.prototype.getErrorMessage=function(){return this.props.FormMaster.getQuestionError()},n.prototype.AU=function(){(0,q.$U)("PortalPage.GroupFormsPortal.GroupForm.MoveToRecycleBin"),this.props.FormMaster.moveToRecycleBin()},n.prototype.EU=function(){(0,q.$U)("PortalPage.GroupFormsPortal.GroupForm.Duplicate"),(0,nv.sv)(this.props.FormMaster,this.props.GroupMaster)},n.prototype.TQ=function(){var t=this;if(!this.shouldHideDialogTriggerButton()){var n={"aria-disabled":this.state.ContentCovered,className:"fl-menu-button",onClick:function(){t.setState({DuplicateRemoveDialogPrompted:!0,ContentCovered:!0})}};return(this.state.DuplicateRemoveDialogPrompted||this.state.DeleteConfirmDialogPrompted)&&(n.className=(0,N.j)(n.className,"dn")),(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:n,FluentIcon:"More Horizontal",IconClassName:"forms-icon-size20x20",key:"triggerButton",ref:this.TT,Text:(0,T.pm)().Common_More_Options_Text})}},n.prototype.kQ=function(){var t=this;if(this.state.DuplicateRemoveDialogPrompted&&!this.shouldShowSpinner()){var n={ButtonsProps:[!this.state.IsCorruptedForm&&{ButtonStyle:2,GlyphButtonStyle:"Vertical",FluentIcon:"Copy",Key:"duplicateItem",onClick:function(){t.FQ(),t.EU(),t.setState({DuplicateRemoveDialogPrompted:!1,ContentCovered:!1})},Text:(0,T.pm)().Common_Copy_Text,TextClassName:"fl-menu-text"},{ButtonStyle:2,GlyphButtonStyle:"Vertical",FluentIcon:"Delete",Key:"removeItem",onClick:function(){t.state.IsCorruptedForm?(0,nv.zh)(t.props.FormMaster,t.props.GroupMaster):t.setState({DeleteConfirmDialogPrompted:!0,DuplicateRemoveDialogPrompted:!1})},Text:(0,T.pm)().Common_Delete_Text,TextClassName:"fl-menu-text"}],ClassName:"portal-view-form-card-copy-remove-container",key:"duplicateRemoveDialog",onBlur:function(){return t.setState({DuplicateRemoveDialogPrompted:!1,ContentCovered:!1})},onDismiss:function(){return t.FQ()},ShowDialog:this.state.DuplicateRemoveDialogPrompted};return(0,je.s)(n)}},n.prototype.UR=function(){var t=this;if(this.state.DeleteConfirmDialogPrompted){var n={ButtonsProps:[{ButtonStyle:2,ClassName:"fl-menu-confirm-delete",GlyphButtonStyle:"Horizontal",Key:"deleteItem",onClick:function(){t.props.focusOut(b.findDOMNode(t)),t.AU(),t.setState({ContentCovered:!1,DeleteConfirmDialogPrompted:!1})},Text:(0,T.pm)().PortalView_Continue_Button,Title:(0,T.pm)().PortalView_Continue_Text},{ButtonStyle:2,ClassName:"fl-menu-confirm-delete",GlyphButtonStyle:"Horizontal",Key:"cancelItem",onClick:function(){t.FQ(),t.setState({ContentCovered:!1,DeleteConfirmDialogPrompted:!1})},Text:(0,T.pm)().Common_Cancel_Text,Title:(0,T.pm)().PortalView_Cancel_Text}],ClassName:"portal-view-form-card-delete-cancel-container",Description:(0,T.pm)().PortalView_MoveFormToRecycleBin_Warning_Text,key:"deleteConfirmDialog",onBlur:function(){return t.setState({DeleteConfirmDialogPrompted:!1,ContentCovered:!1})},onDismiss:function(){return t.FQ()},ShowDialog:this.state.DeleteConfirmDialogPrompted};return(0,je.s)(n)}},n.prototype.FQ=function(){if(this.TT.current){var t=b.findDOMNode(this.TT.current);t&&(t.classList.remove("dn"),t.focus())}},n}(hd.$);var iv=function(t){function n(n){var e=t.call(this,n)||this;e.IQ=e.IQ.bind(e);var i=e.props.GroupMaster;return i&&i.observe(e.IQ,[i.Schema.formReferences]),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){var t=this.props.GroupMaster;t&&t.unobserve(this.IQ,[t.Schema.formReferences])},n.prototype.render=function(){return g.createElement("div",{className:"group-forms-view"},this.OU(),this._U())},n.prototype.IQ=function(){this.forceUpdate()},n.prototype.OU=function(){var t=g.createElement(dd,{CreateNew:!0,focusOut:this.props.focusOut,IsGroupForm:!0,IsQuizMode:!1,onClick:this.BU.bind(this,!1)}),n=g.createElement(dd,{CreateNew:!0,focusOut:this.props.focusOut,IsGroupForm:!0,IsQuizMode:!0,onClick:this.BU.bind(this,!0)}),e=g.createElement("div",{className:"creating-card-middle-line"});return g.createElement("div",{className:"portal-creating-card"},t,e,n)},n.prototype._U=function(){var t=this,n=this.props.GroupMaster,e=n.FormMasterExceptSoftDeleted;if(0===e.filter((function(t){return!t.isFieldReady(t.Schema.Modified)})).length)return e.sort((function(t,n){return Date.parse(n.Model.Modified)-Date.parse(t.Model.Modified)})).map((function(e){return g.createElement(ev,{focusOut:t.props.focusOut,FormMaster:e,GroupMaster:n,onClick:t.props.designExistingForm,key:e.getInstanceId()})}))},n.prototype.BU=function(t){if("PortalPage"===(0,Lt.C2)()){Km(t?"Quiz":"Form",this.props.GroupMaster.Model.id)}else{var n=(0,nv.Np)(t,this.props.GroupMaster);this.props.designExistingForm(n)}},n}(J.r);var rv=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.state={DuplicateRemoveDialogPrompted:!1,FocusOnTriggerButton:!1,IsOwnerNameReady:!0,IsResponseCountReady:!1,IsThemeReady:!1,IsTitleReady:!0,ShowCardOwnerName:!0,ShowCardResponseCount:!0,ShowCardSpinner:!1,ShowCardTheme:!0,ShowCardTitle:!0},n.TT=g.createRef(),n}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this,n=this.props.MruDocumentMaster,e=n.FormMaster;if(e){this.HU=function(){return t.forceUpdate()};var i=F.x.Schema;e.observe(this.HU,[i.Title,i.ResponsesCount,i.Theme]),n.Model.NotExist?this.setState({IsResponseCountReady:!0,IsThemeReady:!0}):e.ensureReadyForMruCard().then((function(){t.setState({IsResponseCountReady:!0,IsThemeReady:!0})}),(function(e){e&&674===e.innerCode&&(n.Model.NotExist=!0),t.setState({IsResponseCountReady:!0,IsThemeReady:!0})}))}},n.prototype.componentWillUnmount=function(){var t=this.props.MruDocumentMaster.FormMaster;t&&(t.unobserve(this.HU),t.Synchronizer.unobserve(this.HU))},n.prototype.onClick=function(){var t=this.props.MruDocumentMaster.FormMaster;if(t&&this.GU("PortalPage.GroupFormsPortal.MruGroupFormLoad"),this.props.Actions.openForm){var n=this.props.MruDocumentMaster.Model;n.NotExist||(n.Timestamp=(new Date).toISOString()),this.props.Actions.openForm(t)}},n.prototype.getCardDescription=function(){if(this.state.ShowCardOwnerName&&this.state.IsOwnerNameReady){var n=this.props.MruDocumentMaster.Model.OwnerName;return(0,T.pm)().PortalView_FormCard_Mru.format(n,this.getCardResponseCount())}return t.prototype.getCardDescription.call(this)},n.prototype.getCardThemeName=function(){var t=this.props.MruDocumentMaster.FormMaster;return t.isFieldReady(t.Schema.Theme)?t.ThemeMaster.Model.Name:null},n.prototype.getCardThemeBackgroupUrl=function(){var t=this.props.MruDocumentMaster.FormMaster;return t.isFieldReady(t.Schema.Theme)?t.ThemeMaster.Model.BackgroundImage:null},n.prototype.getCardThemePrimaryColor=function(){var t=this.props.MruDocumentMaster.FormMaster;return t.isFieldReady(t.Schema.Theme)?t.ThemeMaster.Model.PrimaryColor:null},n.prototype.getCardTitle=function(){return this.props.MruDocumentMaster.Model.Title},n.prototype.getCardType=function(){return null!=this.props.MruDocumentMaster.Model.Type?this.props.MruDocumentMaster.Model.Type.toLowerCase():""},n.prototype.getCardResponseCount=function(){var t=this.props.MruDocumentMaster.FormMaster;return t.isFieldReady(t.Schema.ResponsesCount)?t.Model.ResponsesCount:0},n.prototype.createCardOwnerContent=function(){if(!this.state.ShowCardOwnerName)return null;if(!this.state.IsOwnerNameReady)return null;var t=this.props.MruDocumentMaster;return g.createElement(Ff.H,{DisplayName:t.Model.OwnerName,Photo:this.VU(),PhotoType:1,key:"face-pile"})},n.prototype.createCardWarning=function(){return(0,Bm.w)(this.props.MruDocumentMaster.FormMaster)},n.prototype.createCardTypeContent=function(){return(0,Bm.h)(this.props.MruDocumentMaster.FormMaster)},n.prototype.shouldShowSpinner=function(){return this.state.ShowCardSpinner},n.prototype.createOtherContent=function(){var t=this;return!this.state.ShowCardSpinner&&this.state.IsThemeReady&&this.state.IsResponseCountReady?[(0,et.pd)((function(){return t.TQ()}),et.t1),this.QU()]:null},n.prototype.VU=function(){var t=this.props.MruDocumentMaster;return this.UU||("Group"===t.Model.OwnerType?this.UU=(0,xf.Rd)(t.Model.OwnerId):this.UU=(0,xf.uw)(t.FormMaster)),this.UU},n.prototype.TQ=function(){var t=this;if(!this.shouldHideDialogTriggerButton()){var n=this.state,e={"aria-disabled":this.state.ContentCovered,className:"fl-menu-button",onClick:function(){return t.setState({DuplicateRemoveDialogPrompted:!0,ContentCovered:!0})}};return(n.DuplicateRemoveDialogPrompted||n.DeleteConfirmDialogPrompted)&&(e.className=(0,N.j)(e.className,"dn")),(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:e,FluentIcon:"More Horizontal",IconClassName:"forms-icon-size20x20",key:"triggerButton",ref:this.TT,Text:(0,T.pm)().Common_More_Options_Text})}},n.prototype.QU=function(){var t=this,n=this.props,e=this.state;if(e.DuplicateRemoveDialogPrompted)return(0,je.s)({ButtonsProps:[{ButtonStyle:2,GlyphButtonStyle:"Vertical",FluentIcon:"Block",Key:"removeItem",onClick:function(e){t.GU("PortalPage.GroupFormsPortal.MruGroupFormRemove"),n.Actions.removeFromMRU&&(t.props.focusOut(b.findDOMNode(t)),n.Actions.removeFromMRU(n.MruDocumentMaster.FormMaster),t.setState({ShowCardSpinner:!0}))},Text:(0,T.pm)().PortalView_Remove_Button,TextClassName:"fl-menu-text",Title:(0,T.pm)().PortalView_Remove_Text}],ClassName:"portal-view-form-card-copy-remove-container",key:"duplicateRemoveDialog",onBlur:function(){return t.setState({DuplicateRemoveDialogPrompted:!1,ContentCovered:!1})},onDismiss:function(){return t.FQ()},ShowDialog:e.DuplicateRemoveDialogPrompted})},n.prototype.FQ=function(){if(this.TT.current){var t=b.findDOMNode(this.TT.current);t&&(t.classList.remove("dn"),t.focus())}},n.prototype.GU=function(t){var n,e=this.props.MruDocumentMaster.FormMaster;e.isFieldReady(F.x.Schema.Id)&&(n=e.Model.Id),(0,q.$U)(t,{FormId:n,FormOwnerType:"MruForm",IsGroupForms:this.props.MruDocumentMaster.Model.Extension===wi.I[wi.I.GroupForm]})},n}(hd.$);function ov(t,n,e,i){var r=t.Documents;return i&&(r=r.filter((function(t){return t.matchSearchStrings(i)}))),r.map((function(t){return g.createElement(rv,{Actions:n,focusOut:e,MruDocumentMaster:t,key:t.Model.ServerDocId})}))}var sv=function(t){function n(n){var e=t.call(this,n)||this;e.jU=g.createRef(),e.Gu=(0,k.f5)().Model,e.state={SelectedGroup:e.Gu.GroupMaster,ShouldShowGroupCards:!1},e.KU=function(t){e.setState({ShouldShowGroupCards:t})},e.JU=e.JU.bind(e),e.ZU=e.ZU.bind(e),e.XU=e.XU.bind(e),e.t$=e.t$.bind(e),e.IQ=function(){return e.forceUpdate()},e.e$=e.e$.bind(e),e.i$=e.i$.bind(e),e.state.SelectedGroup&&e.state.SelectedGroup.observe(e.IQ,[e.state.SelectedGroup.Schema.formReferences]);var i=(0,k.f5)();return i.observe(e.e$,[i.Schema.GroupMaster]),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.state.SelectedGroup&&this.state.SelectedGroup.unobserve(this.IQ,[this.state.SelectedGroup.Schema.formReferences]),(0,k.f5)().unobserve(this.e$)},n.prototype.render=function(){return g.createElement("div",(0,p.pi)({},this.props.HTMLAttributes),this.r$(),this._U())},n.prototype.r$=function(){return function(t,n,e,i,r){return g.createElement(tv,{GroupManager:t,SelectedGroup:n,ShouldShowGroups:e,onGroupCardClick:i,showGroupsCallback:r,key:"group-list"})}((0,aa.F)(),this.state.SelectedGroup,this.state.ShouldShowGroupCards,this.RU.bind(this),this.KU)},n.prototype._U=function(){return this.state.SelectedGroup?this.o$(this.state.SelectedGroup):this.a$()},n.prototype.o$=function(t){var n=function(t,n,e){return g.createElement(iv,{focusOut:t,GroupMaster:n,designExistingForm:e,key:n.Model.id})}(this.props.focusOut,t,this.t$);return(0,q.$U)("PortalPage.GroupForms.FormCount",{groupsFormCount:t.FormMasters.length,groupSoftdeletedFormCount:t.getFormMasterSoftDeteledForms().length}),g.createElement("div",{className:"portal-group-forms"},n,this.u$())},n.prototype.a$=function(){if("Loaded"!==this.Gu.GroupMruFormListLoadState)return null;var t=this.c$();if(t.length)return t;var n={className:"discover-group-button",title:(0,T.pm)().PortalView_RecentGroupForms_Warning_Button_Text,onClick:this.ZU},e=(0,Fr.E)({ButtonStyle:1,HTMLAttributes:n,Text:(0,T.pm)().PortalView_RecentGroupForms_Warning_Button_Text});return g.createElement("div",{className:"portal-other-form-warning-container"},this.l$((0,zi.Jn)("/Images/fish-bowl.png")),g.createElement(U.L,{HTMLAttributes:{className:"portal-other-form-warning-title"},LazyRendering:!0,Role:"Status"},(0,T.pm)().PortalView_RecentGroupForms_Warning_Title),e)},n.prototype.c$=function(t){var n=this;return ov(this.props.GroupMruDocumentManager,{deleteForm:function(t){return n.props.deleteFormHandler(t)},duplicateForm:function(){throw Error("Not supported.")},openForm:function(t){return n.XU(t)},removeFromMRU:function(t){return n.props.removeFromMRUHandler(t)}},this.props.focusOut,t)},n.prototype.u$=function(){if("Loaded"!==this.Gu.FormListLoadState)return null;var t=this.state.SelectedGroup.getFormMasterSoftDeteledForms().length;return g.createElement(zm,{GroupMaster:this.state.SelectedGroup,onClick:this.JU,RecycleBinFormCount:t,ref:this.jU})},n.prototype.RU=function(t){this.Gu.GroupMaster=t},n.prototype.l$=function(t){return g.createElement("div",{className:"portal-other-form-warning-img-container"},g.createElement("img",{className:"portal-other-form-warning-img",role:"presentation",src:t,alt:!1}))},n.prototype.XU=function(t){if(t)if(this.Gu.SearchContent)(0,q.$U)("PortalPage.SearchForms.Click",{FormId:t.Model.Id});else switch(this.Gu.FormCollectionType){case"OwnedForms":(0,q.$U)("PortalPage.MyForms.Click",{FormId:t.Model.Id});break;case"GroupForms":(0,q.$U)("PortalPage.MyForms.Click",{FormId:t.Model.Id,IsGroupForms:!0});break;case"SharedWithMe":(0,q.$U)("PortalPage.OtherForms.Click",{FormId:t.Model.Id})}this.t$(t)},n.prototype.t$=function(t){"PortalPage"===(0,Lt.C2)()&&t.Model.Id?Wm(t.Model.Id):this.props.designExistingFormHandler(t)},n.prototype.JU=function(){var t=this.state.SelectedGroup.getFormMasterSoftDeteledForms().length;(0,q.$U)("DesignPage.RecycleBin.Navigate",{recycleBinformCount:t}),(0,k.f5)().showTopView("RecycleBin",this.i$)},n.prototype.ZU=function(){this.setState({ShouldShowGroupCards:!0})},n.prototype.e$=function(){var t=this.Gu.GroupMaster;this.state.SelectedGroup!==t&&(this.state.SelectedGroup&&this.state.SelectedGroup.unobserve(this.IQ,[this.state.SelectedGroup.Schema.formReferences]),t&&t.observe(this.IQ,[t.Schema.formReferences]),this.setState({SelectedGroup:t}))},n.prototype.i$=function(){this.jU.current&&(this.state.SelectedGroup.getFormMasterSoftDeteledForms().length?this.jU.current.focus():(0,kr.nP)(b.findDOMNode(this)))},n}(J.r);var av=function(t){function n(n){var e=t.call(this,n)||this;return e.f$=[],e.Gu=(0,k.f5)().Model,e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this;this.h$=function(){return t.forceUpdate()};var n=this.Gu.GroupMaster;n&&n.observe(this.h$,[n.Schema.formReferences])},n.prototype.componentWillUnmount=function(){var t=this.Gu.GroupMaster;t&&t.unobserve(this.h$,[t.Schema.formReferences])},n.prototype.render=function(){this.f$=this.Gu.SearchContent.toLowerCase().split(" ").filter((function(t){return!!t}));var t=this.d$();return g.createElement("div",{className:"sub-tiles",role:"main"},this.v$(t.length),t,this.p$(t.length))},n.prototype.v$=function(t){return g.createElement(U.L,{HTMLAttributes:{className:"portal-search-live-region"},LazyRendering:!0,Role:"Status"},(0,T.pm)().Portal_FormSearch_Result_Screen_Reader_Message.format(t,this.Gu.SearchContent.toLowerCase()))},n.prototype.d$=function(){if(this.f$.length<1)return[];var t=[],n=this.b$(),e=this.props.SearchGroupForm?this.S$():[],i=this.props.SearchSharedForm?this.N$():[];switch(this.Gu.FormCollectionType){case"OwnedForms":t=t.concat(n,e,i);break;case"GroupForms":t=t.concat(e,n,i);break;case"SharedWithMe":t=t.concat(i,n,e);break;default:throw Error("The form type is invalid.")}return t},n.prototype.b$=function(){var t=this,n=[],e=_.d.convertToArray((0,k.f5)().Model.FormList);return this.f$.forEach((function(t){e=e.filter((function(n){return n.Model.Title.toLowerCase().indexOf(t)>=0}))})),e.forEach((function(t){-1===n.indexOf(t)&&n.push(t)})),n.sort((function(t,n){return Date.parse(n.Model.Modified)-Date.parse(t.Model.Modified)})).map((function(n){return g.createElement(Hm,{CreateNew:!1,IsSampleForm:!1,focusOut:t.props.focusOut,FormMaster:n,onClick:t.props.designExistingForm,onDeleteClick:t.props.deleteForm,onSoftDeleteClick:t.props.softDeleteForm,onDuplicateClick:t.props.duplicateForm,onMoveClicked:t.props.changeFormOwner,onCopyToEnvClick:!1,key:n.getInstanceId()})}))},n.prototype.N$=function(){var t=this,n=[],e=_.d.convertToArray((0,k.f5)().Model.SharedWithMeFormList);return this.f$.forEach((function(t){e=e.filter((function(n){return n.Model.Title.toLowerCase().indexOf(t)>=0||n.Model.SharedFormOwnerName&&n.Model.SharedFormOwnerName.toLowerCase().indexOf(t)>=0}))})),e.forEach((function(t){-1===n.indexOf(t)&&n.push(t)})),n.sort((function(t,n){return Date.parse(n.Model.SharedDate)-Date.parse(t.Model.SharedDate)})),n.map((function(n){return g.createElement(Hm,{CreateNew:!1,IsSampleForm:!1,focusOut:t.props.focusOut,FormMaster:n,onClick:t.props.designExistingForm,onDeleteClick:t.props.deleteForm,onSoftDeleteClick:t.props.softDeleteForm,onDuplicateClick:t.props.duplicateForm,onMoveClicked:t.props.changeFormOwner,onCopyToEnvClick:!1,key:n.getInstanceId()})}))},n.prototype.S$=function(){var t=this,n=this.props,e=this.Gu.GroupMaster;return e?function(t,n,e,i){var r=t.FormMasterExceptSoftDeleted;return i.forEach((function(t){r=r.filter((function(n){return n.Model.Title.toLowerCase().indexOf(t)>=0}))})),r.sort((function(t,n){return Date.parse(n.Model.Modified)-Date.parse(t.Model.Modified)})).map((function(i){return g.createElement(ev,{focusOut:e,FormMaster:i,GroupMaster:t,key:i.getInstanceId(),onClick:n})}))}(e,this.props.designExistingForm,this.props.focusOut,this.f$):ov(n.GroupMruDocumentManager,{deleteForm:function(t){return n.deleteForm(t)},duplicateForm:function(e){var i=e;t.Gu.FormCollectionType="OwnedForms",n.duplicateForm(i,{OwnerId:e.Model.OwnerId,OwnerTenantId:e.Model.OwnerTenantId,IsGroupForm:e.IsGroupForm})},openForm:function(t){return n.designExistingForm(t)},removeFromMRU:function(t){return n.removeFromMRU(t)}},this.props.focusOut,this.f$)},n.prototype.p$=function(t){return t>0?null:g.createElement("div",{className:"portal-search-warning-container"},g.createElement("div",{className:"portal-search-warning-title"},(0,T.pm)().Portal_FormSearch_Warning_Message_1),g.createElement("div",{className:"portal-search-warning-message"},(0,T.pm)().Portal_FormSearch_Warning_Message_2))},n}(J.r);var uv=function(t){function n(n){var e=t.call(this,n)||this;return e.C$=g.createRef(),e.vo=!0,e.I$="",e.jU=g.createRef(),e.Gu=(0,k.f5)().Model,e.al=y.uniqueId("portal"),e.T$=e.al+"-myForms",e.k$=e.al+"-sharedWithMe",e.x$=e.al+"-groupForms",e.F$=(0,Ct.Gw)("CustomerVoiceTransitionCompletionDate"),e.P$=640,e.D$=880,e.state={ExpandSearchBar:!1,MenuExpanded:!1,ShowFormsProAvailableTeachingCallout:!1,ShowCustomerVoiceIntroductionDialog:!1,ExpandableSearchBarOnDesktop:!1,DropdownTabListOnDesktop:!1,TemplateGalleryToggleState:!0},e.M$=function(){return e.L$("Form")},e.R$=function(){return e.L$("Quiz")},e.A$=function(){return(0,ca.WT)()&&!e.E$()&&"1"===(0,c.k0)().switcherExperience},e.E$=function(){var t=new Date,n=new Date(e.F$);return!(!t||!n)&&t>n},e.O$=function(){e.setState({ShowCustomerVoiceIntroductionDialog:e.A$()})},e._$=function(t){var n="".concat((0,Ct.Gw)("CustomerVoiceUrl"),"/Pages/ProjectPage.aspx#FormId=").concat(t);window.open(n,"_blank")},e.B$=e.B$.bind(e),e.H$=e.H$.bind(e),e.t$=e.t$.bind(e),e.G$=e.G$.bind(e),e.q$=e.q$.bind(e),e.V$=e.V$.bind(e),e.z$=e.z$.bind(e),e.L$=e.L$.bind(e),e.Q$=e.Q$.bind(e),e.i$=e.i$.bind(e),e.U$=e.U$.bind(e),e.$$=function(t){return e.j$(t)},e.Z$=e.Z$.bind(e),e.X$(),e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this;(0,Fn.GO)().then((function(){return t.setState({FormsProLicenseChecked:!0})})),(0,q.$U)("PortalPage.MyForms.Navigate",{IsGroupForms:"GroupForms"===this.Gu.FormCollectionType||null,IsMobileView:!!this.Y$()||null}),this.tj=function(){t.vo&&t.forceUpdate()};var n=(0,k.f5)();if(n.observe(this.tj,[n.Schema.ForceDesktopView,n.Schema.FormList,n.Schema.FormCollectionType,n.Schema.SharedWithMeFormList,n.Schema.GroupMruFormListLoadState,n.Schema.SearchContent,n.Schema.ShowGroupListInPortal]),this.props.GroupMruDocumentManager.observeListChange(this.tj),(0,c.k0)().userInfo.IsMsa){var e=Rm.V.getInstance();this.setState({TemplateGalleryToggleState:void 0}),e.fieldsReady([e.Schema.TemplateGalleryToggleState]).then((function(){t.vo&&t.setState({TemplateGalleryToggleState:Rm.V.getInstance().Model.TemplateGalleryToggleState})}))}this.BB(),oa().then((function(n){t.setState({ShowFormsProAvailableTeachingCallout:n})})),this.setState({ShowCustomerVoiceIntroductionDialog:!$m()&&this.A$()}),this.U$()},n.prototype.componentWillUnmount=function(){this.vo=!1,this.props.GroupMruDocumentManager.unobserveListChange(this.tj),(0,k.f5)().unobserve(this.tj),window.removeEventListener("resize",this.U$)},n.prototype.componentDidMount=function(){this.HB();var t=(0,c.k0)().userInfo;t&&t.TenantId&&t.UserId&&(0,mi.W2)(t.TenantId,t.UserId),cv(),this.nj(),window.addEventListener("resize",this.U$)},n.prototype.componentDidUpdate=function(){this.HB(),cv()},n.prototype.render=function(){return this.state.FormsProLicenseChecked&&void 0!==this.state.TemplateGalleryToggleState?this.Y$()?this.ij():this.rj():null},n.prototype.U$=function(){this.setState({ExpandableSearchBarOnDesktop:(0,vt.fM)()<this.D$,DropdownTabListOnDesktop:(0,vt.fM)()<this.P$})},n.prototype.rj=function(){var t,n=(0,k.f5)().Model.ShowGroupListInPortal?"expand":null;return n=(0,N.j)("portal-content-container",n),g.createElement("div",{className:"portal-page"},!(0,c.k0)().userInfo.IsMsa&&(t={createFormHandler:this.M$,onDialogClose:this.O$},g.createElement(jm,(0,p.pi)({},t))),this.state.ShowCustomerVoiceIntroductionDialog&&Dm(null),g.createElement("div",{className:n,id:"portalContentContainer"},this.oj(),this.sj(),this.Z$(),g.createElement("div",{className:"portal-tiles",id:"portalTiles"},this.uj(),this.cj()),this.lj(),g.createElement(km,{ref:this.C$})))},n.prototype.ij=function(){var t=(0,k.f5)().Model.ShowGroupListInPortal?"expand":null;t=(0,N.j)("portal-content-container",t);var n=g.createElement("iframe",{src:"/Pages/PrefetchPage.aspx?target=mobiledesignpage",style:{display:"none"}});return g.createElement("div",{className:"mobile-portal-page"},g.createElement("div",{className:t,id:"portalContentContainer"},g.createElement("div",{className:"portal-tiles",id:"portalTiles"},this.fj(),this.cj()),this.lj(),g.createElement(km,{ref:this.C$})),n)},n.prototype.fj=function(){return g.createElement("div",{className:"mobile-portal-titlebar-container",role:"navigation"},this.dj(),g.createElement("div",{className:"mobile-portal-search-more-container"},g.createElement(Om,{expandOrCollapseSearch:this.q$,onValueChange:this.$$,Value:this.Gu.SearchContent}),this.pj()))},n.prototype.uj=function(){var t,n;return n=this.state.ExpandableSearchBarOnDesktop?g.createElement(Om,{expandOrCollapseSearch:this.q$,onValueChange:this.$$,Value:this.Gu.SearchContent}):g.createElement(Em,{onValueChange:this.$$,Value:this.Gu.SearchContent}),t=this.state.DropdownTabListOnDesktop?this.dj():this.bj(),g.createElement("div",{className:"portal-titlebar-container",role:"navigation"},t,n)},n.prototype.HB=function(){Rs&&"Loaded"===this.Gu.FormListLoadState&&window.performance&&(0,q.in)("Endpoint.DesignPortalPage",Os())},n.prototype.sj=function(){return(0,c.k0)().userInfo.IsMsa&&g.createElement("div",{className:"portal-template-gallery-container __portal-template-gallery-container__"},g.createElement(qm,{createFormCallback:this.L$,viewTemplateHandler:this.props.designExistingFormHandler}))},n.prototype.Z$=function(){return!(0,ca.WT)()&&(0,I.cr)("FormsProAvailableTeachingCallout")&&this.state.ShowFormsProAvailableTeachingCallout&&g.createElement("div",{className:"portal-teachingbubble"},g.createElement(Um,{}))},n.prototype.oj=function(){return!!this.A$()&&Lm(null)},n.prototype.BB=function(){var t=this.Y$()?"Mobile":"Desktop";(0,bs.c)().log(Fn.Ng,"AppResume",void 0,t),(0,bs.c)().logStartTime(Fn.Ng,"AppUsageTime",void 0,t)},n.prototype.j$=function(t){this.Gu.SearchContent=t},n.prototype.V$=function(t){if(this.C$.current){var n=b.findDOMNode(this.C$.current);(0,kr.su)(t,n)}},n.prototype.nj=function(){if(!$m()){var t="";switch(this.Gu.FormCollectionType){case"OwnedForms":t="MyForms";break;case"SharedWithMe":t="SharedForms";break;case"GroupForms":t="GroupForms"}var n=b.findDOMNode(this.refs[t]);n&&n.focus()}},n.prototype.G$=function(t){var n=t.Model.OwnerId,e=t.Model.OwnerTenantId,i=t.IsGroupForm;t.IsSharedForm&&(this.Gu.FormCollectionType="OwnedForms",n=(0,c.k0)().userInfo.UserId,e=(0,c.k0)().userInfo.TenantId,i=!1),this.props.duplicateFormHandler(t,{OwnerId:n,OwnerTenantId:e,IsGroupForm:i})},n.prototype.cj=function(){var t,n;if(this.Gu.SearchContent)return n={deleteForm:this.props.deleteFormHandler,focusOut:this.V$,softDeleteForm:this.props.softDeleteFormHandler,designExistingForm:this.t$.bind(this),duplicateForm:this.props.duplicateFormHandler,removeFromMRU:this.props.removeFromMRUHandler,changeFormOwner:this.props.changeFormOwnerHandler,GroupMruDocumentManager:this.props.GroupMruDocumentManager,SearchGroupForm:!0,SearchSharedForm:!0},g.createElement(av,n);switch(this.I$="",this.Gu.FormCollectionType){case"OwnedForms":t=this.yj();break;case"SharedWithMe":t=this.wj();break;case"GroupForms":t=function(t){return g.createElement(sv,t)}({HTMLAttributes:{id:this.x$+"-tab","aria-labelledby":this.x$,className:"portal-group-tab"},designExistingFormHandler:this.props.designExistingFormHandler,deleteFormHandler:this.props.deleteFormHandler,focusOut:this.V$,GroupMruDocumentManager:this.props.GroupMruDocumentManager,removeFromMRUHandler:this.props.removeFromMRUHandler});break;default:throw Error("The type is not valid.")}return g.createElement("div",{className:"sub-tiles",role:"main"},g.createElement("div",{className:"portal-search-live-region","aria-live":"polite"},this.I$),t)},n.prototype.bj=function(){return this.Gu.SearchContent?g.createElement("div",{className:"portal-title-button-container"},g.createElement("div",{className:"portal-title selected"},(0,T.pm)().Portal_FormSearch_Title)):g.createElement("div",{className:"portal-title-button-container",role:"tablist"},this.Sj(),!(0,c.k0)().userInfo.IsMsa&&this.Cj(),!(0,c.k0)().userInfo.IsMsa&&this.Ij())},n.prototype.dj=function(){var t,n,e=[];switch(e.push({Key:"my-form-dropdown-option",Value:0,DisplayName:(0,T.pm)().PortalView_Title_Text}),(0,c.k0)().userInfo.IsMsa||(e.push({Key:"share-with-me-form-dropdown-option",Value:1,DisplayName:(0,T.pm)().PortalView_SharedWithMe_Title_Text}),e.push({Key:"group-form-dropdown-option",Value:2,DisplayName:(0,T.pm)().PortalView_GroupForms_Title_Text})),this.Gu.FormCollectionType){case"OwnedForms":t=0,n=(0,T.pm)().PortalView_Title_Text;break;case"SharedWithMe":t=1,n=(0,T.pm)().PortalView_SharedWithMe_Title_Text;break;case"GroupForms":t=2,n=(0,T.pm)().PortalView_GroupForms_Title_Text}var i=(0,N.j)("mobile-portal-select-container",this.state.ExpandSearchBar&&"hidden");return(0,ar.E)({Label:n,HTMLAttributes:{className:i},Placeholder:n,SelectOptions:e,Value:t,onValueChange:this.B$})},n.prototype.B$=function(t){switch(t){case 0:this.Gu.FormCollectionType="OwnedForms";break;case 1:this.Gu.FormCollectionType="SharedWithMe",this.kj();break;case 2:this.Gu.FormCollectionType="GroupForms"}},n.prototype.Sj=function(){var t=this,n="OwnedForms"===this.Gu.FormCollectionType;return(0,Fr.E)({HTMLAttributes:{id:this.T$,"aria-controls":n?this.T$+"-tab":void 0,className:n?"portal-title selected":"portal-title",role:"tab",tabIndex:n?0:-1,"aria-selected":n,onClick:function(){(0,q.$U)("DesignPage.Form.MyFormsButton"),t.Gu.FormCollectionType="OwnedForms",t.Gu.SearchContent="",t.Gu.ShowGroupListInPortal=!1},onKeyDown:function(n){39===n.keyCode&&t.Iz(n,"MyForms","SharedForms")}},ButtonStyle:1,Text:(0,T.pm)().PortalView_Title_Text,ref:"MyForms"})},n.prototype.Cj=function(){var t=this,n="SharedWithMe"===this.Gu.FormCollectionType;return(0,Fr.E)({HTMLAttributes:{id:this.k$,"aria-controls":n?this.k$+"-tab":void 0,className:n?"portal-title selected":"portal-title",role:"tab",tabIndex:n?0:-1,"aria-selected":n,onClick:function(){(0,q.$U)("DesignPage.Form.OtherFormsButton"),t.Gu.FormCollectionType="SharedWithMe",t.Gu.SearchContent="",t.Gu.ShowGroupListInPortal=!1,t.kj()},onKeyDown:function(n){39===n.keyCode?t.Iz(n,"SharedForms","GroupForms"):37===n.keyCode&&t.Iz(n,"SharedForms","MyForms")}},ButtonStyle:1,Text:(0,T.pm)().PortalView_SharedWithMe_Title_Text,ref:"SharedForms"})},n.prototype.Ij=function(){var t=this,n="GroupForms"===this.Gu.FormCollectionType;return(0,Fr.E)({HTMLAttributes:{id:this.x$,"aria-controls":n?this.x$+"-tab":void 0,className:n?"portal-title selected":"portal-title",role:"tab",tabIndex:n?0:-1,"aria-selected":n,onClick:function(){(0,q.$U)("DesignPage.Form.GroupFormsButton"),t.Gu.FormCollectionType="GroupForms",t.Gu.SearchContent="",t.Gu.ShowGroupListInPortal=!1},onKeyDown:function(n){(0,q.$U)("DesignPage.Form.GroupFormsButton"),37===n.keyCode&&t.Iz(n,"GroupForms","SharedForms")}},ButtonStyle:1,Text:(0,T.pm)().PortalView_GroupForms_Title_Text,ref:"GroupForms"})},n.prototype.kj=function(){var t=this;"NotStarted"===this.Gu.SharedWithMeFormListLoadState&&dh.Z.getFormSharedWithMe().catch((function(){t.Gu.SharedWithMeFormListLoadState="NotStarted",(0,Zs.r)((0,T.pm)().Share_With_Me_Forms_Warning_Message)}))},n.prototype.Iz=function(t,n,e){t.stopPropagation(),t.preventDefault();var i=b.findDOMNode(this.refs[n]),r=b.findDOMNode(this.refs[e]);r&&(r.focus(),$(r).attr("tabindex",0),$(i).attr("tabindex",-1))},n.prototype.yj=function(){var t;if(this.xj()){var n=g.createElement(dd,{CreateNew:!0,focusOut:this.V$,IsGroupForm:!1,IsQuizMode:!1,onClick:this.Fj()?this.z$:this.M$});t=g.createElement("div",{className:"portal-creating-card"},n,g.createElement("div",{className:"creating-card-middle-line"}),g.createElement(dd,{CreateNew:!0,focusOut:this.V$,IsGroupForm:!1,IsQuizMode:!0,onClick:this.R$}))}return g.createElement("div",{id:this.T$+"-tab","aria-labelledby":this.T$},t,this.Pj(),this.Dj(),!this.Mj()&&this.u$())},n.prototype.lj=function(){return"Loaded"===this.Gu.FormListLoadState&&"OwnedForms"===this.Gu.FormCollectionType||"Loaded"===this.Gu.SharedWithMeFormListLoadState&&"SharedWithMe"===this.Gu.FormCollectionType||"GroupForms"===this.Gu.FormCollectionType&&"Loaded"===this.Gu.GroupMruFormListLoadState?void 0:(0,Ch.t)({Message:(0,T.pm)().Common_Loading_Text,TimeoutMessage:(0,T.pm)().RetryRecoverableErrorMessage_DisplayingForms})},n.prototype.Pj=function(){var t=this;return _.d.convertToArray((0,k.f5)().Model.PlaceholderList).sort((function(t,n){return Date.parse(n.Modified)-Date.parse(t.Modified)})).map((function(n,e){return g.createElement(Gm,{CreateNew:!1,focusOut:t.V$,Form:n,key:e})}))},n.prototype.Dj=function(){var t=this;if("GroupForms"===this.Gu.FormCollectionType)return null;if("Loaded"!==this.Gu.FormListLoadState)return null;var n=_.d.convertToArray((0,k.f5)().Model.FormList).sort((function(t,n){return Date.parse(n.Model.Modified)-Date.parse(t.Model.Modified)})).map((function(n){return g.createElement(Hm,{CreateNew:!1,focusOut:t.V$,FormMaster:n,onClick:t.t$,onDeleteClick:t.props.deleteFormHandler,onSoftDeleteClick:t.props.softDeleteFormHandler,onDuplicateClick:t.G$,onMoveClicked:t.props.changeFormOwnerHandler,key:n.getInstanceId()})}));return n.length?n:void 0},n.prototype.wj=function(){var t=this;if("Loaded"===this.Gu.SharedWithMeFormListLoadState){if(0===this.Gu.SharedWithMeFormList.length)return g.createElement("div",{id:this.k$+"-tab","aria-labelledby":this.k$,className:"portal-other-form-warning-container"},(n=(0,zi.Jn)("/Images/fish-bowl.png"),g.createElement("div",{className:"portal-other-form-warning-img-container"},g.createElement("img",{className:"portal-other-form-warning-img",role:"presentation",src:n}))),g.createElement(U.L,{HTMLAttributes:{className:"portal-other-form-warning-title"},LazyRendering:!0,Role:"Status"},(0,T.pm)().PortalView_SharedWithMe_Warning_Title));var n,e=_.d.convertToArray((0,k.f5)().Model.SharedWithMeFormList).map((function(n){var e=n.getInstanceId();return g.createElement(Hm,{CreateNew:!1,focusOut:t.V$,FormMaster:n,onClick:t.t$,onDeleteClick:t.props.deleteFormHandler,onSoftDeleteClick:t.props.softDeleteFormHandler,onDuplicateClick:t.G$,onMoveClicked:t.props.changeFormOwnerHandler,key:e})}));return g.createElement("div",{id:this.k$+"-tab","aria-labelledby":this.k$},e)}},n.prototype.u$=function(){return"Loaded"!==this.Gu.FormListLoadState?null:g.createElement("div",null,g.createElement(zm,{GroupMaster:null,onClick:this.Q$,ref:this.jU,RecycleBinFormCount:this.Gu.RecycleBin.length}))},n.prototype.t$=function(t){var n=this;t&&t.ensureFieldsReady([t.Schema.Type]).then((function(){if((0,ca.WT)()&&"survey"===t.Model.Type){var e=t.isFieldReady(t.Schema.Id)?t.Model.Id:void 0;n._$(e)}else n.Y$()?function(t){return t&&t.ensureFieldsReady([t.Schema.Settings]).then((function(){return t.Model.Settings.IsQuizMode}))}(t).then((function(e){var i,r;e?n.Lj(t):(i=t.Model.Id,r="/Pages/MobileDesignPage.aspx?id="+i,(0,Dn.gB)(r))})):n.Lj(t)}))},n.prototype.Lj=function(t){var n=t.isFieldReady(t.Schema.Id)?t.Model.Id:void 0;if(this.Gu.SearchContent)(0,q.$U)("PortalPage.SearchForms.Click",{FormId:n});else switch(this.Gu.FormCollectionType){case"OwnedForms":(0,q.$U)("PortalPage.MyForms.Click",{FormId:n});break;case"GroupForms":(0,q.$U)("PortalPage.MyForms.Click",{FormId:n,IsGroupForms:!0});break;case"SharedWithMe":(0,q.$U)("PortalPage.OtherForms.Click",{FormId:n})}Es(t&&t.isFieldReady(F.x.Schema.Questions)),"PortalPage"===(0,Lt.C2)()&&n?Wm(n):this.props.designExistingFormHandler(t)},n.prototype.L$=function(t){"PortalPage"===(0,Lt.C2)()?Km(t):this.props.createAndDesignFormHandler(lv(t))},n.prototype.Q$=function(){(0,q.$U)("DesignPage.RecycleBin.Navigate",{recycleBinformCount:this.Gu.RecycleBin.length}),(0,k.f5)().showTopView("RecycleBin",this.i$)},n.prototype.i$=function(){if(this.jU.current&&this.Gu.RecycleBin.length)this.jU.current.focus();else if(this.C$.current){var t=b.findDOMNode(this.C$.current);(0,kr.nP)(b.findDOMNode(this),t)}},n.prototype.q$=function(){var t=this.state.ExpandSearchBar;this.setState({ExpandSearchBar:!t})},n.prototype.z$=function(){if(!this.Gu.ShouldDisableAllClick){(0,Dn.gB)("/Pages/MobileDesignPage.aspx#Action=Create")}},n.prototype.xj=function(){return!(0,c.k0)().userInfo.IsMsa||this.Y$()},n.prototype.Fj=function(){return this.Y$()},n.prototype.Y$=function(){return(0,vt.lZ)()&&!this.Gu.ForceDesktopView},n.prototype.Mj=function(){return this.Y$()},n.prototype.pj=function(){if(!this.state.ExpandSearchBar)return g.createElement(Am,{onClickSwitch:this.H$})},n.prototype.H$=function(){(0,q.$U)("PortalPage.MyForms.SwitchToDesktop"),this.Gu.ForceDesktopView=!0,this.Rj()},n.prototype.X$=function(){this.Y$()&&(this.Aj||(this.Aj=$('meta[name="viewport"]')[0].content),$('meta[name="viewport"]')[0].content="width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1, maximum-scale=1",$("#content-root").addClass("disable-over-scroll"),(0,ti.LQ)())},n.prototype.Rj=function(){this.Aj&&($('meta[name="viewport"]')[0].content=this.Aj),$("#content-root").removeClass("disable-over-scroll")},n}(J.r);function cv(){var t=(0,k.f5)().Model;if("Loaded"===t.FormListLoadState){var n=t.FormList,e=y.find(n,(function(t){return!!t.getQuestionError()}));e?(0,Zs.r)((0,T.pm)().UploadFile_ErrorMessage_PortalPage_Bar.format(e.Model.Title)):(0,Zs.r)(null)}}function lv(t){(0,q.$U)("PortalPage.MyForms.New",{Locale:(0,c.k0)().cultureInfo.Name});var n="Quiz"===t;n?(0,q.$U)("PortalPage.MyForms.NewQuiz",{Locale:(0,c.k0)().cultureInfo.Name}):(0,q.$U)("PortalPage.MyForms.NewForm",{Locale:(0,c.k0)().cultureInfo.Name});var e=(0,k.f5)(),i=null;(0,T.pm)()&&(i=(0,Je.o)(n?(0,T.pm)().Designer_DefaultQuizTitle:(0,T.pm)().Designer_DefaultFormTitle,(0,T.pm)().Designer_Title_autoRenameFormat,_.d.convertToArray(e.Model.FormList).map((function(t){return t.Model.Title}))));var r=!!e.Model.FormsTenantSettings&&!e.Model.FormsTenantSettings.recordIdentityByDefault,o=(0,ht.x8)(),s={IsQuizMode:n,RequiresUniqueResponse:n&&!(0,c.k0)().userInfo.IsMsa,IsAnonymous:(0,c.k0)().userInfo.IsMsa,NotRecordIdentity:r,PermissionForResponder:o?0:1};return n&&(s.ShowGradedResults=!0,s.ManualGradingEnabled=!1),{Title:i,Settings:s}}var fv=e(46571),hv=e(21707),dv=e(51531);var mv=function(t){function n(n){var e=t.call(this,n)||this;return e.Oj=Vi.tu,e.state={IsRefreshing:!1},e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){(0,q.$U)("ResponsePage.PollResultView.Navigate")},n.prototype.componentDidUpdate=function(){var t=b.findDOMNode(this.refs["vote-detail"]);t&&t.focus()},n.prototype.render=function(){var t=this,n=(0,z.F)({HTMLAttributes:{className:"poll-top-view-back-button light-background-button",onClick:function(){return t.props.submitAnother()}},FluentIcon:"Arrow Left",IconClassName:"poll-top-view-back-icon forms-icon-size16x16",Text:(0,T.pm)().Common_Back_Text,TextClassName:"poll-top-view-back-text"});return g.createElement("div",{className:"office-poll-result-container"},g.createElement("div",{className:"office-poll office-form office-form-theme-shadow office-poll-info-container",role:"main"},g.createElement("div",{className:"office-poll-title-container office-form-theme-primary-background"},n),g.createElement("div",{className:"poll-result-container office-form-padding-align"},this._j(),this.Bj(),g.createElement("div",{className:"office-form-info-other"},this.Hj()))),g.createElement(hv.r,{TopExtraContent:this.Gj()}))},n.prototype._j=function(){var t,n=this.props.Form;return g.createElement("div",((t={className:"office-form-question-title"})["aria-level"]=2,t.role="heading",t),n.Model.Questions[0]&&n.Model.Questions[0].Title)},n.prototype.Bj=function(){var t=this,n=this.props.Form,e=n.Model.Questions[0].ChoiceType===D.T6.MultiChoice,i=n.Model.Questions[0].AllowOtherAnswer,r=y.map(n.Model.Questions[0].Choices,(function(t){return{option:t.Description,voteCount:0,names:[],voted:!1}}));i&&r.push({option:"Other",voteCount:0,names:[],otherOptions:[],voted:!1}),y.each(n.Model.Responses,(function(t){var n=t.Answers,o=[];e?y.each((0,tt.d)(n[0].Answer),(function(t){return o.push(t)})):o.push(n[0].Answer);var s=t.ResponderName||t.Responder||(0,T.pm)().Response_Poll_Result_Anonymous;s&&y.each(o,(function(t){var n=y.findIndex(r,(function(n){return n.option===t}));i&&-1===n&&(n=r.length-1),-1!==n&&(r[n].voteCount+=1,r[n].names.push(s),"otherOptions"in r[n]&&r[n].otherOptions.push(t),s===(0,c.k0)().userInfo.Email&&(r[n].voted=!0))}))})),r.sort((function(t,n){return n.voteCount-t.voteCount}));var o=y.first(r).voteCount,s=r.map((function(n,e){var i=n.voteCount||0,r=0===o?0:80*i/o,s=String(r)+"%",a=String(100-r)+"%",u=g.createElement("span",{className:"office-poll-vote-count-container"},g.createElement("span",{className:"poll-result-vote-count"},(0,T.pm)().Response_Poll_Result_VoteCount.format(i))),c=g.createElement("div",{className:"poll-result-progressbar-container"},g.createElement("div",{className:"poll-result-progressbar-cell",style:{width:s}},g.createElement("a",{className:"poll-result-progressbar",style:{backgroundColor:t.Oj}})),g.createElement("div",{className:"poll-result-progressbar-cell",style:{width:a}},g.createElement("a",{className:"poll-result-progressbar"})));return g.createElement("div",{className:"poll-result-option-container",key:n.option},g.createElement("div",null,n.option,n.voted?g.createElement("span",{className:"poll-result-voted"},(0,T.pm)().Response_Poll_Voted):void 0,u),c)}));return g.createElement("div",{className:"poll-result-options-container"},s)},n.prototype.Hj=function(){var t=this;return g.createElement("div",{className:"poll-result-refresh-link"},g.createElement("a",{className:"office-form-info-reload office-form-info-children",href:"javascript:void(0)",onClick:function(){var n=t.props.Form;t.setState({IsRefreshing:!0}),Promise.all([n.ensureFieldsReady([F.x.Schema.Questions,F.x.Schema.DescriptiveElements,F.x.Schema.Responses]),n.syncRuntimeResponses()]).then((function(){t.setState({IsRefreshing:!1})}))}},(0,T.pm)().Response_Poll_Result_Refresh),this.xu())},n.prototype.Gj=function(){var t=this;if(!(0,ri.ft)()){var n={className:"office-form-info-premotion office-form-info-children",href:"DesignPage.aspx",onClick:function(){return t.props.beforePromotion&&t.props.beforePromotion(),!0}};return((0,ti.wM)()||(0,dv.o)()||(0,dt.QR)())&&(n.href="javascript:void(0)",n.onClick=function(){t.props.beforePromotion&&t.props.beforePromotion();var n=(0,ti.X9)(),e=(0,dt.QR)()?"../Pages/DesignPage.aspx":"../Pages/DesignPage.aspx?"+jQuery.param(n);return(0,$s.K)((0,_t.WN)(e)),!0}),g.createElement("div",null,g.createElement("a",n,(0,T.pm)().Renderer_PromotionMessage))}},n.prototype.xu=function(){if(this.state.IsRefreshing)return g.createElement("div",{className:"poll-submit-spinner"},g.createElement("div",{className:"spinner-tile-animation"}))},n}(J.r);var vv=function(t){function n(n){var e=t.call(this,n)||this;return e.qj=function(){return e.Rs()},e.state={IsSmallScreen:$(window).width()<768,SubmitState:"DetailResult"===(0,gt.NW)().view?3:0,ShowErrorPage:!1,ResponderEmail:(0,c.k0)().userInfo.Email},e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){this.Lr=new Qh.l(this.props.Master),this.Wa(),window.addEventListener("resize",this.qj)},n.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.qj)},n.prototype.render=function(){var t,n=this;if(this.state.ShowErrorPage)return(0,xh.a)({Error:this.zj,FormId:this.props.Master.Model.Id,ShowCreateFormLink:!1});var e,i={className:"office-poll office-form-content office-form-page-padding"};if((this.props.ViewMode===Ji.w.Mobile||this.state.IsSmallScreen)&&(i.className=(0,N.j)(i.className,"small-screen")),this.lf()&&(i.className=(0,N.j)(i.className,"mobile-view")),3===this.state.SubmitState){var r=void 0;this.props.Master.Model.Settings.RequiresUniqueResponse||this.props.Master.Model.Settings.DisableSubmitAnother||(r=function(){return n.Ia()}),e={ShowPromotionMessage:!0,submitAnother:r,beforePromotion:function(){(0,q.$U)("ResponsePage.PollResultView.NavigateToPortal")},Form:this.props.Master},t=g.createElement(mv,e)}else t=g.createElement("div",null,g.createElement("div",{"aria-label":this.props.Master.Model.Title,className:"office-form office-form-theme-shadow",role:"form"},this.Fa(),g.createElement("div",{className:"office-form-body"},this.Pa(),g.createElement("div",null,this.Xa()),this.Qj(),this.ku(),this.Uj(),this.Aa(),this.Ea())),g.createElement(hv.r,{FormMaster:this.props.Master,FooterType:"ShowStatementWithNotice",FooterText:!1}));return g.createElement("div",{className:"form-content-container"},g.createElement("div",i,g.createElement(Ka.w,{ThemeMaster:this.props.Master.ThemeMaster}),t))},n.prototype.Pa=function(){return g.createElement("div",{className:"office-form-notice-container"},this.Ya(),this.iu())},n.prototype.Ya=function(){var t=this.props.Master.Model.Settings;if(!t.IsAnonymous&&!t.NotRecordIdentity){var n=(0,c.k0)().userInfo.GivenName;return g.createElement("div",{},g.createElement("span",{className:"office-form-notice-long-text"},(0,T.pm)().Response_NonAnonymous_Notice.format(n)))}},n.prototype.iu=function(){return y.some(this.props.Master.Model.Questions,(function(t){return t.Required}))?g.createElement("div",null,g.createElement("span",{className:"office-form-required-notice-star"}),g.createElement("span",null,(0,T.pm)().Answer_Required_Notice)):void 0},n.prototype.Aa=function(){var t=this.Lr.getQuestionsWithWrongAnswer(this.Lr.TopQuestionRuntimeMasters()),n=t.map((function(t){return(0,T.pm)().Form_QuestionWithOrdinal.format(t)})).join((0,T.pm)().Common_ItemSeperator),e=(0,T.pm)().Form_Question_Error_Message.format(t.length,n),i=(0,V.M)({FluentIcon:"Warning Filled",HTMLAttributes:{className:"office-form-alert-icon forms-icon-size24x24"}}),r=!!this.state.ShowValidationStyle&&!!t.length;return g.createElement("div",{className:(0,N.j)("office-form-submit-error",r?"":"NotVisible"),role:"alert"},i,g.createElement("span",{className:"error-message"},r?e:""))},n.prototype.Fa=function(){return g.createElement("div",{className:"office-poll-title-container office-form-theme-primary-background"})},n.prototype.Xa=function(){var t=this,n=this.state.ShowValidationStyle;return _.d.convertToArray(this.Lr.Model.QuestionRuntimeMasters).map((function(e,i){var r=e.Question.Model.Id,o={Master:e,LocalizedStrings:(0,T.pm)(),Ordinal:i+1,Disabled:!1,ExpandAll:!0,key:r,IsMobile:t.lf(),ShowValidationStyle:n,ShowQuizResult:!1,ShowPrintResult:!1,HideMedia:!1,IsStudentViewMode:!1};return(0,ps.n)(o)}))},n.prototype.Ea=function(){var t=(0,V.M)({FluentIcon:"Warning Filled",HTMLAttributes:{className:"office-form-alert-icon forms-icon-size24x24"}}),n=2===this.state.SubmitState;return g.createElement("div",{className:(0,N.j)("office-form-submit-error",n?"":"NotVisible"),role:"alert"},t,g.createElement("span",{className:"error-message"},n?this.state.ErrorMessage:""))},n.prototype.Qj=function(){var t=this;return g.createElement("div",{className:"design-question-choice-label"},g.createElement("div",{className:"poll-email-label"},(0,T.pm)().Response_Poll_Email_Label,g.createElement("span",{className:"required-star"})),(0,ur.ZA)({Value:this.state.ResponderEmail,AutoSelection:!0,Placeholder:(0,T.pm)().Response_Poll_Email_Placeholder,HTMLAttributes:{className:"inline-display poll-email-textbox"},onValueChange:function(n){var e=!n||!n.trim();t.setState({ResponderEmail:n,ShowValidationStyle:e})}}),this.state.ShowValidationStyle?g.createElement("div",{className:"poll-email-validation-error"},(0,sr._)({HTMLAttributes:{className:"validation-error-message-label",role:"alert"},Label:(0,T.pm)().Response_Poll_Email_ValidationError,Alert:!0})):void 0)},n.prototype.Uj=function(){var t=this;return g.createElement("span",{className:"poll-view-result-link"},g.createElement("a",{className:"office-form-info-premotion office-form-info-children",href:"javascript:void(0)",onClick:function(){t.setState({SubmitState:1});var n=t.props.Master;Promise.all([n.ensureFieldsReady([F.x.Schema.Questions,F.x.Schema.DescriptiveElements,F.x.Schema.Responses]),n.syncRuntimeResponses()]).then((function(){t.setState({SubmitState:3})}))}},(0,T.pm)().Response_Poll_ViewResult),this.xu())},n.prototype.ku=function(){var t=this,n=1===this.state.SubmitState;return g.createElement("div",{className:"office-form-bottom-button-div"},(0,Fr.E)({HTMLAttributes:{className:"office-poll-submit-button office-form-theme-primary-background",disabled:n,onClick:function(){t.$j(),(0,q.$U)("ResponsePage.Form.Submit",{isPoll:!0})}},ButtonStyle:1,Text:(0,T.pm)().Response_Poll_VoteButtonText}))},n.prototype.xu=function(){if(1===this.state.SubmitState)return g.createElement("div",{className:"poll-submit-spinner"},g.createElement("div",{className:"spinner-tile-animation"}))},n.prototype.jj=function(t){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)},n.prototype.$j=function(){var t=this;if(this.Lr.getQuestionsWithWrongAnswer(this.Lr.TopQuestionRuntimeMasters()).length>0)this.setState({ShowValidationStyle:!0},n.scrollToShowSubmitError);else if(this.state.ResponderEmail&&this.state.ResponderEmail.trim()&&this.jj(this.state.ResponderEmail.trim())){this.setState({SubmitState:1});var e={StartDate:this.nt,SubmitDate:new Date,Answers:this.Lr.Answers,Responder:this.state.ResponderEmail,ResponderName:this.state.ResponderEmail},i=this.props.Master;i.submitResponse(e).then((function(n){Promise.all([i.ensureFieldsReady([F.x.Schema.Questions,F.x.Schema.DescriptiveElements,F.x.Schema.Responses]),i.syncRuntimeResponses()]).then((function(){t.setState({SubmitState:3,ErrorMessage:void 0})}))})).catch((function(n){var e=(0,T.pm)(),i="";if(n.innerCode){if(i=(0,Fi.D)("".concat(n.innerCode))||e.Error_Inline_DefaultMessage,5e3===n.innerCode){var r;r=n.customizedMessage,i=e.Error_Message_5000_title.format(r)}10001===n.innerCode&&(i=e.Error_Inline_RefreshMessage),631!==n.innerCode&&6503!==n.innerCode||(i=e.Error_Inline_DelayTryMessage)}t.setState({SubmitState:2,ErrorMessage:i}),5e3===n.innerCode&&(i=(0,T.pm)().Error_Message_FormClosed),(0,q.$U)((0,en.xP)(n)?"Error.InlineError.ShowAtSubmitResponse.Expected":"Error.InlineError.ShowAtSubmitResponse.Unexpected",{Error:(0,en.Y8)(n)||void 0},n&&n.correlationId)}))}else this.setState({ShowValidationStyle:!0},n.scrollToShowSubmitError)},n.prototype.Ia=function(){(0,q.$U)("ResponsePage.PollResultView.SubmitAnother"),this.Wa(),this.Lr.updateWithResponse(null),this.setState({ErrorMessage:void 0,ShowValidationStyle:!1,SubmitState:0},n.scrollToTop)},n.prototype.Wa=function(t){this.nt=new Date,this.Lr.Answers=t||[]},n.prototype.lf=function(){switch(this.props.ViewMode){case Ji.w.Desktop:return!1;case Ji.w.Mobile:return!0;case Ji.w.Auto:return(0,vt.tq)();default:throw Error("unknown view mode")}},n.prototype.Rs=function(){$(window).width()<=768!==this.state.IsSmallScreen&&this.setState({IsSmallScreen:!this.state.IsSmallScreen})},n.scrollToTop=function(){(0,Tr.n1)($(".office-form-form-title"),$(".office-form-content"),void 0,void 0,!0)},n.scrollToShowSubmitError=function(){(0,Tr.n1)($(".office-form-submit-error"),$(".office-form-content"),void 0,20,!0)},n}(J.r);var gv=function(t){function n(n){var e=t.call(this,n)||this,i=(0,k.f5)().Model.Preview,r=i&&i.ViewModeIndex,o=(0,vt.tq)()?Ji.w.Mobile:Ji.w.Desktop;return e.state={FormLoaded:!1,ViewMode:null!=r?r:o},e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this,n=this.props.Form;n&&n.ensureReadyToResponse().then((function(){if(!(void 0===t.props.ResponseIndex||n.Model.Responses&&n.Model.Responses.length))return n.syncFormResponses()})).then((function(){t.setState({FormLoaded:!0})})),h.Pv.Resolve("IBootEvent").raiseBootComplete()},n.prototype.componentWillUnmount=function(){},n.prototype.render=function(){var t,n=this,e=(0,vt.tq)();return e||(t=(0,nr.getIoCPreviewSettingsPane)({onValueChange:function(t){n.setState({ViewMode:t});var e=(0,k.f5)(),i=e.Model.Preview;e.Model.Preview={PreviousTopView:i&&i.PreviousTopView||"None",ResponseIndex:i&&i.ResponseIndex,ViewModeIndex:t}},Value:this.state.ViewMode})),g.createElement("div",this.getContainerProps(),this.createHeader(t),this.Wj(e))},n.prototype.onBackButtonClick=function(){var t=(0,k.f5)(),n=t.Model.Preview;t.bulkEdit((function(){t.Model.TopView=n&&n.PreviousTopView||"None",t.Model.Preview=void 0}));var e=$("body").attr("dir");e=e&&e.toLowerCase();var i=$(".form-content").attr("dir");i=i&&i.toLowerCase(),"ltr"===e&&"rtl"===i?(0,fv.g)(fv.Y.DesignPage):"rtl"===e&&"ltr"===i&&(0,fv.g)(fv.Y.DesignPageRtl)},n.prototype.Wj=function(t){if(!this.state.FormLoaded)return(0,Ch.t)({Message:(0,T.pm)().Common_Loading_Text});var n=this.props.Form;n||(0,q.$U)("formMaster.isnull.previewcontainer");var e,i,r=n.Model.Responses[this.props.ResponseIndex],o=void 0!==this.props.ResponseIndex,s={DisableSubmitButton:(0,K.NT)(this.props.Form.Model.ReputationTier),HeaderMessage:o&&(0,T.pm)().PreviewStudentFeedbackView_StudentName_Label.format((0,xd.Ai)(r).name),HideSubmitAnotherResponseLink:o,HTMLAttributes:{className:"preview-form"},Master:n,Response:o?r:void 0,ViewMode:this.state.ViewMode,PhishingReviewUXFactory:null};(0,C.w)(this.props.Form,"ResponsePage.PollView")?(i=s,e=g.createElement(vv,i)):e=(0,Dh.RS)(s);var a={className:"top-view-content"},u={className:"form-content"};return this.state.ViewMode!==Ji.w.Mobile||t?a.className=(0,N.j)(a.className,"office-form-theme-page-background"):u.className=(0,N.j)(u.className,"preview-mobile-container","office-form-theme-page-background"),g.createElement("div",(0,p.pi)({},a),g.createElement("div",(0,p.pi)({},u),e))},n.prototype.Kj=function(t){0},n.prototype.Jj=function(){this.setState({FormLoaded:!0,ShowErrorPage:!0})},n}(Mh);function pv(){return tg().createDesignPageContainer()}var bv=function(t){function n(n){var e=t.call(this,n)||this;return e.Zj=new Ye.Y,e.uxStateModel=(0,k.f5)().Model,e.Ot=new dh.Z,e.state=e.getDefaultState(),e.Xj=function(t){return e.Yj(t)},e.tW=e.tW.bind(e),e.eW=e.eW.bind(e),e.iW=e.iW.bind(e),window.FormPrefetchCache&&(0,$r.W6)().then((function(t){3===t&&((0,q.$U)("ShowBlockingPageForCompromisedUser"),e.setState({ShowBlockingPageForCompromisedUser:!0}))})),e.rW(),e}return(0,p.ZT)(n,t),n.onShellFlexPaneVisibilityChanged=function(t,n){t&&window.innerWidth>800?($("#content-root").addClass("shell-flexpane-on"),Q.Th.setReservedWidthToRight(n.width)):($("#content-root").removeClass("shell-flexpane-on"),Q.Th.setReservedWidthToRight(0))},n.prototype.getDefaultState=function(){var t=(0,k.f5)();return{ShowBlockingPageForCompromisedUser:!1,ShowPortalPage:!t.shouldShowDesignView(),CopySharedTemplate:"CopySharedTemplate"===t.Model.Action}},n.prototype.componentWillMount=function(){var t=(0,k.f5)();t.observe(this.Xj,[t.Schema.CriticalError,t.Schema.FlexPane,t.Schema.FormId,t.Schema.FormMaster,t.Schema.FormList,t.Schema.FormListLoadState,t.Schema.SharedWithMeFormListLoadState,t.Schema.Store,t.Schema.TopView,t.Schema.SelectedPortalForm,t.Schema.ShowXLUnsyncedDialog])},n.prototype.componentWillUnmount=function(){(0,k.f5)().unobserve(this.Xj),ga(n.onShellFlexPaneVisibilityChanged)},n.prototype.render=function(){var t,n,e,i,r=this,o=(0,k.f5)();if(this.state.ShowBlockingPageForCompromisedUser)t=(0,ms.HH)();else if(this.uxStateModel.CriticalError)t=(0,xh.a)({Error:this.uxStateModel.CriticalError,FormId:this.uxStateModel.FormId});else if(this.state.DuplicatingForm||this.state.CopySharedTemplate)t=(0,Ch.t)({Message:(0,T.pm)().Common_Loading_Text});else if(this.state.ShowPortalPage)switch(t=this.sW(),this.uxStateModel.TopView){case"RecycleBin":n=this.aW();break;case"MSATemplateGallery":n=this.uW();break;case"UserFeatureSettings":n=g.createElement(xm)}else if(this.uxStateModel.FormMaster){switch((e=o.Model.FormMaster)&&e.ensureReadyToDesign().then((function(){var t=e.FormElementManager.SectionMasters,n=e.FormElementManager.AllElementMasters;(null==t?void 0:t.length)&&(null==n?void 0:n.length)&&"Question.ColumnGroup"!==n[0].Model.Type&&Tg(e,!0,"NotASection")})),this.uxStateModel.TopView){case"Preview":i={Form:e,key:"preview-".concat(e.getInstanceId()),ResponseIndex:this.uxStateModel.Preview?this.uxStateModel.Preview.ResponseIndex:void 0},n=g.createElement(gv,(0,p.pi)({},i));break;case"Branch":n=g.createElement(Oh,{Form:e,key:"branch-".concat(e.getInstanceId())});break;case"MultiLingualEditionView":n=g.createElement(fd,{Form:e});break;default:n=Cm(o.Model)}t=function(t){return tg().createDesignContent(t)}({FormMaster:e,key:"content-".concat(e.getInstanceId()),TopView:!!n})}else o.shouldShowDesignView()?t=(0,Ch.t)({Message:(0,T.pm)().Common_Loading_Text}):"Loaded"===this.uxStateModel.FormListLoadState&&(t=this.sW());var s=this.uxStateModel.FlexPane,a="page-container",u=wa();(u||(0,dt.Rw)())&&($("#content-root").addClass("suiteheader"),this.state.ShowPortalPage&&(a=(0,N.j)(a,"portal")));var c,l={className:a,role:"main",onClick:function(t){s===r.uxStateModel.FlexPane&&(0,k.f5)().collapseFlexPaneIfNeeded(t.target),r.Zj.trigger(t)},onKeyDown:function(t){r.Zj.trigger(t)},onScroll:function(t){r.Zj.trigger(t)}};u&&this.state.ShowPortalPage||(c=tg().createPageHeader({AppLauncherCollapseTrigger:this.Zj,ShouldDisabled:"None"!==this.uxStateModel.TopView&&"RecycleBin"!==this.uxStateModel.TopView&&"MSATemplateGallery"!==this.uxStateModel.TopView&&"UserFeatureSettings"!==this.uxStateModel.TopView,SetPrintViewState:this.eW})),e=(0,k.f5)().Model.FormMaster;var f,h=(0,k.f5)().Model.SelectedPortalForm,d={className:(0,N.j)("design-body-container",(0,vt.un)()?"edge":void 0,(0,vt.w1)()?"ie":void 0,(0,vt.tH)()?"firefox":void 0,(0,vt.gn)()?"ios-avoid-scroll":void 0,(0,dt.Rw)()?"container-override-iframe":void 0),style:n?{display:"none"}:void 0},m=g.createElement("div",(0,p.pi)({},d),Sh({Form:e,FlexPaneType:"Feedback"}),Sh({changeFormOwnerHandler:function(t,n){return r.FB(t,n)},FlexPaneType:"MoveFormPane",Form:h}),t);if((0,I.cr)("BaseProFRE")&&"ShowProFRE"===this.uxStateModel.TopView.toString()&&(pa(),f=g.createElement(qh,{isProUser:!1})),this.state.ShowPrintView){var v=(0,k.f5)().Model.FormMaster;if(v){var b=(0,Dh.RS)({Master:v,PrintView:!0,PhishingReviewUXFactory:null});return g.createElement("div",{id:"print-time-content"},b)}(0,q.$U)("formMaster.isnull.designpagecontainer"),this.eW(!1,null)}return g.createElement("div",(0,p.pi)({},l),c,n,f,function(t){return g.createElement(_h,t)}(),g.createElement(Gh,null),function(t){return g.createElement(Fm,(0,p.pi)({},t))}({Message:(0,T.pm)().RetryRecoverableErrorMessage_Saving}),function(t){return g.createElement(Bh,(0,p.pi)({},t))}(),m,(0,k.f5)().Model.ShowXLUnsyncedDialog?g.createElement(Hh,{}):null)},n.prototype.eW=function(t,n){(0,k.f5)().Model.FormMaster&&this.setState({ShowPrintView:t},n)},n.prototype.FB=function(t,n){var e=(0,k.f5)();return e.bulkEdit((function(){e.Model.FlexPane="None",e.Model.SelectedPortalForm=null})),this.Ot.changeFormOwner(t,n)},n.prototype.rW=function(){var t;return(0,p.mG)(this,void 0,void 0,(function(){var n,e,i,r,o,s,a,u=this;return(0,p.Jh)(this,(function(c){switch(c.label){case 0:if(n=(0,ne.G)(),e=n.getItem("FormCopy.FormModelToJSON"),n.removeItem("FormCopy.GUID"),n.removeItem("FormCopy.LoginToAutoCopy"),!e)return[3,6];n.removeItem("FormCopy.FormModelToJSON"),n.removeItem("FormCopy.ServerFormToJSON"),c.label=1;case 1:return c.trys.push([1,5,,6]),delete(i=JSON.parse(e)).Id,delete i.ReputationTier,i.Settings&&(delete i.Settings.AllowCopy,delete i.Settings.ShareToken,delete i.Settings.FormClosed,delete i.Settings.StartTime,delete i.Settings.EndTime,delete i.Settings.TimerEnabledStart,delete i.Settings.TimerEnabledEnd,delete i.Settings.TimerEnabled),r=function(){var t=(0,kh.L)(i.Questions).filter((function(t){return"Question.FileUpload"!==t.Type}));i.Questions=t},(0,S.ro)()?(delete i.XlWorkbookId,r(),[3,4]):[3,2];case 2:return[4,dh.Z.getFormsTenantSettings()];case 3:c.sent(),!1===(null===(t=this.uxStateModel.FormsTenantSettings)||void 0===t?void 0:t.allowFileUpload)&&r(),c.label=4;case 4:return i.Title+=(0,T.pm)().Tile_For_Duplicate_Form,i.FormsProRTTitle&&(i.FormsProRTTitle+=(0,T.pm)().Tile_For_Duplicate_Form),o="GroupForms"===this.uxStateModel.FormCollectionType,s=this.Ot.createForm(i,o),this.Ot.designForm(s),s.ensureCreationDone().then((function(){u.setState({CopySharedTemplate:!1}),u.uxStateModel.Action="NoAction"})),[3,6];case 5:return a=c.sent(),(0,q.$U)("PortalPage.MyForms.NewFromCopy.Failure",{Reason:"".concat(a)}),[3,6];case 6:return[2]}}))}))},n.prototype.sW=function(){return(0,et.pd)((0,ht.yv)()&&!(0,ht.A2)()?(0,I.Be)()?sa.tC:sa.lG:this.iW,et.t1)},n.prototype.iW=function(){var t,n=this;return t={changeFormOwnerHandler:function(t){var n=(0,k.f5)();n.bulkEdit((function(){n.Model.SelectedPortalForm=t,n.Model.FlexPane="MoveFormPane"}))},createAndDesignFormHandler:function(t,e){return n.eq(t,e)},deleteFormHandler:this.Ot.deleteForm,designExistingFormHandler:this.Ot.designForm,duplicateAndDesignFormHandler:this.cW.bind(this),duplicateFormHandler:function(t,n){return dh.Z.duplicateForm(t,n)},focusOut:function(){},GroupMruDocumentManager:this.Ot.GroupMruDocumentManager,removeFromMRUHandler:this.Ot.removeFromMRU,softDeleteFormHandler:this.Ot.moveToRecycleBin},g.createElement(uv,t)},n.prototype.aW=function(){return Ph({deleteFormHandler:this.Ot.deleteForm,restoreFormHandler:this.Ot.restoreFromRecycleBin})},n.prototype.uW=function(){return(0,c.k0)().userInfo.IsMsa&&g.createElement(bd,{backToPortalViewPageHandler:n.closeTopView,createFormCallback:this.tW,viewTemplateHandler:this.Ot.designForm})},n.prototype.tW=function(t){this.eq(lv(t))},n.closeTopView=function(){(0,k.f5)().hideTopView(),(0,ti.Nu)("UpdateMSATemplatePortalView")},n.prototype.eq=function(t,n){var e="GroupForms"===this.uxStateModel.FormCollectionType,i=this.Ot.createForm(t,e);this.Ot.designForm(i),n&&i.ensureCreationDone().then((function(){(0,q.$U)("PortalPage.MyForms.NewFromCopy",{CopyCorrelationID:n,Time:(new Date).toUTCString()})}))},n.prototype.cW=function(t,n){var e=this;this.setState({DuplicatingForm:!0}),dh.Z.duplicateForm(t,n).then(this.Ot.designForm).then((function(){return e.setState({DuplicatingForm:!1})}),(function(){return e.setState({DuplicatingForm:!1})}))},n.prototype.Yj=function(t){var n=t.Master.Model,e=(0,k.f5)();if(y.contains(t.FieldSchemas,e.Schema.FormId)&&!y.contains(t.FieldSchemas,e.Schema.FormMaster)){var i=void 0;if(n.FormMaster&&!n.FormId||(i=(0,Ni.ZP)({Id:n.FormId},!1)),i!==n.FormMaster)return void(n.FormMaster=i)}if(y.contains(t.FieldSchemas,e.Schema.ShowXLUnsyncedDialog))this.setState({ShowXLUnsyncedDialog:t.Master.Model.ShowXLUnsyncedDialog});else{var r,o={};o.ShowPortalPage=!e.shouldShowDesignView(),o.ShowPortalPage&&!this.state.ShowPortalPage&&(o=this.getDefaultState()),y.contains(t.FieldSchemas,e.Schema.TopView)&&"None"===t.Master.Model.TopView&&(r=t.Master.resetTopViewCloseCallback()),this.setState(o,r)}},n}(J.r);var yv="formLauncher",wv="appLauncherButton";var Sv,Nv=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.state={LoadingStatus:0,ShowMenu:!1},n}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){this.collapseAppLauncher=this.collapseAppLauncher.bind(this)},n.prototype.render=function(){var t=this,n={HTMLAttributes:{className:"headbar-waffle","aria-haspopup":"true","aria-expanded":(0,et.pd)((function(){}),et.t1),onClick:function(){return t.fW()}},ButtonStyle:2,GlyphButtonStyle:"GlyphOnly",FluentIcon:"Office Apps",IconClassName:"headbar-waffle-icon",Text:(0,T.pm)().HeaderBar_AppSwitcher,ref:wv};return g.createElement("div",{className:"headbar-waffle-container"},(0,z.F)(n),this.hW())},n.prototype.collapseAppLauncher=function(t){if(this.state.ShowMenu){var n=t.target,e=t,i=b.findDOMNode(this.refs.formLauncher),r=b.findDOMNode(this.refs.appLauncherButton);(e&&27===e.keyCode||i&&!i.contains(n)&&r&&!r.contains(n))&&this.dW()}},n.prototype.dW=function(){var t=b.findDOMNode(this.refs.formLauncher);$(t).addClass("hide"),this.state.ShowMenu=!1,this.props.AppLauncherCollapseTrigger&&this.props.AppLauncherCollapseTrigger.unregister(this.collapseAppLauncher),1===this.state.LoadingStatus&&this.setState({ShowMenu:this.state.ShowMenu})},n.prototype.fW=function(){var t,n=b.findDOMNode(this.refs.formLauncher);this.state.ShowMenu?($(n).addClass("hide"),this.props.AppLauncherCollapseTrigger&&this.props.AppLauncherCollapseTrigger.unregister(this.collapseAppLauncher)):($(n).removeClass("hide"),(t=$(".o365cs-nav-appTile")[0]||$(".swBar"))&&t.focus(),this.props.AppLauncherCollapseTrigger&&this.props.AppLauncherCollapseTrigger.register(this.collapseAppLauncher)),this.state.ShowMenu=!this.state.ShowMenu,1===this.state.LoadingStatus&&this.setState({ShowMenu:this.state.ShowMenu})},n.prototype.hW=function(){var t={className:"swBar SwitcherLoading UnifiedHeader O365Switcher hide",id:yv,ref:yv,tabIndex:-1};return 0===this.state.LoadingStatus?g.createElement("div",(0,p.pi)({},t),g.createElement("span",{className:"swLoadingText"},(0,T.pm)().Common_Loading_Text),g.createElement("span",{className:"border-arrow arrow"}),g.createElement("span",{className:"arrow"})):(this.state.ShowMenu&&(t.className="swBar SwitcherError UnifiedHeader O365Switcher"),g.createElement("div",(0,p.pi)({},t),g.createElement("span",{className:"swLoadingErrorText"},g.createElement("span",{className:"swErrorTitle"},(0,T.pm)().Error_Page_DefaultErrorTitle),g.createElement("br",null),g.createElement("span",{className:"swErrorBody"},(0,T.pm)().Common_Try_again_Text)),g.createElement("span",{className:"border-arrow arrow"}),g.createElement("span",{className:"arrow"})))},n}(J.r),Cv=function(t){function n(n){var e=t.call(this,n)||this;e.vo=!0,e.updateReputationTier=e.updateReputationTier.bind(e);var i=e.props.Form;return i&&i.observe(e.updateReputationTier,[i.Schema.ReputationTier]),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){this.updateReputationTier(),this.updateIsRestrictedUser()},n.prototype.componentWillUnmount=function(){var t=this.props.Form;t&&t.unobserve(this.updateReputationTier),this.vo=!1},n.prototype.render=function(){return g.createElement("div",{className:"headbar-button-container"},this.createButton(),this.createFirstRunCallout())},n.prototype.createFirstRunCallout=function(){return this.props.FirstRunCallout},n.prototype.onClickHeadBarButton=function(){this.props.onClick(),(0,ws.b4)().Model.SendTeachingCalloutVersion=Bs.BT.toString(),(0,ws.b4)().Model.ThemeSuggestCalloutVersion=Bs.BT.toString()},n.prototype.updateReputationTier=function(){var t=this,n=this.props.Form;n&&n.fieldsReady([n.Schema.ReputationTier]).then((function(){var e=n&&n.Model&&n.Model.ReputationTier||1;t.vo&&t.setState({ReputationTier:e})}))},n.prototype.updateIsRestrictedUser=function(){var t=this;(0,$r.W6)().then((function(n){t.setState({IsRestrictedUser:4===n})}))},n}(J.r),Iv=function(t){function n(n){var e=t.call(this,n)||this;return e.ys=g.createRef(),e.state={ReputationTier:1},e}return(0,p.ZT)(n,t),n.prototype.focus=function(){this.ys.current&&this.ys.current.focus()},n.prototype.createButton=function(){return(0,z.F)({ButtonStyle:2,GlyphButtonStyle:"Horizontal",HTMLAttributes:{className:"headbar-button",disabled:(0,K.kl)(this.state.ReputationTier),onClick:this.onClickHeadBarButton.bind(this)},FluentIcon:"Eye Show",IconClassName:(0,dt.QR)()?"forms-icon-size16x16":"forms-icon-size18x18",ref:this.ys,Text:(0,T.pm)().Common_Preview_Text,TextClassName:"headbar-button-text"})},n}(Cv),Tv=function(t){function n(n){var e=t.call(this,n)||this;return e.mW=g.createRef(),e.vW=g.createRef(),e.state={ReputationTier:1},e}return(0,p.ZT)(n,t),n.prototype.focus=function(){(0,dt.QR)()&&this.mW.current?this.mW.current.focus():this.vW.current&&this.vW.current.focus()},n.prototype.createButton=function(){var t={"aria-expanded":this.props.Active,className:"headbar-button send-button",disabled:(0,K.NT)(this.state.ReputationTier),onClick:this.onClickHeadBarButton.bind(this)},n=(0,c.k0)().userInfo.IsMsa?(0,T.pm)().DesignPage_NavBar_Sendform:(0,T.pm)().DesignPage_NavBar_Collect,e=(0,T.pm)().DesignPage_NavBar_SendForm_Tooltip;if((0,dt.QR)())return(0,z.F)({ButtonStyle:2,GlyphButtonStyle:"Horizontal",HTMLAttributes:t,FluentIcon:"Send",IconClassName:"forms-icon-size16x16",ref:this.mW,Text:n,TextClassName:"headbar-button-text",Tooltip:e});t.className=(0,N.j)(t.className,"highlighted");var i={HTMLAttributes:t,ref:this.vW,Text:n,Tooltip:e};return g.createElement(Fr.A,(0,p.pi)({},i))},n}(Cv),kv=function(t){function n(n){var e=t.call(this,n)||this;return e.vo=!0,e.state={HasSuggestion:!1},e.gW=e.gW.bind(e),e.bW=e.bW.bind(e),e.SW=e.SW.bind(e),(0,ws.b4)().observe(e.gW,[ws.TS.Schema.ThemeSuggestCalloutVersion]),e.props.ThemeSuggestion.observe(e.bW,[hf.n.Schema.suggestions]),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.vo=!1,(0,ws.b4)().unobserve(this.gW),this.props.ThemeSuggestion.unobserve(this.bW)},n.prototype.componentWillUpdate=function(t,e){if(e.HasSuggestion){var i=(0,ws.b4)().Model;(0,ws.OT)(i.SendTeachingCalloutVersion)&&(0,ws.OT)(i.ThemeSuggestCalloutVersion)&&(i.SendTeachingCalloutVersion=Bs.$q.toString())}else this.state.HasSuggestion&&n.resetSendIfWaitRun()},n.prototype.render=function(){var t=(0,ws.b4)().Model;return this.state.HasSuggestion&&(0,ws.OT)(t.ThemeSuggestCalloutVersion)?(n.logData("Intelligence.Theme.ShowCallout"),this.IW("teachingCallout-theme","teachingCallout-theme-direction")):null},n.prototype.gW=function(){this.forceUpdate()},n.prototype.bW=function(){if(this.vo){var t=this.props.ThemeSuggestion.Model.suggestions;t&&t.length>0?this.setState({HasSuggestion:!0}):this.setState({HasSuggestion:!1})}},n.prototype.IW=function(t,n){var e=(0,T.pm)().Designer_Intelligence_Theme_Callout_Title,i=(0,T.pm)().Designer_Intelligence_Theme_Callout_Subtitle,r=(0,V.M)({FluentIcon:"Flash On",HTMLAttributes:{className:"theme-icon"}}),o=g.createElement("div",{className:"theme-teaching-callout-header"},g.createElement("div",{className:"theme-teaching-calllout-title-wrapper"},g.createElement("div",{className:"theme-teaching-callout-icon"},r),g.createElement("div",{className:"theme-teaching-callout-text"},e)),g.createElement("div",{className:"theme-teaching-callout-subtitle"},i)),s=(0,Bs.yM)(this.SW),a=(0,Bs.Bi)((0,zi.Jn)("/Images/theme-suggest.gif"),null,Bs.Mb);return(0,Bs.dq)(a,s,t,n,i,o)},n.prototype.SW=function(){(0,ws.b4)().Model.ThemeSuggestCalloutVersion=ws.BT.toString(),n.resetSendIfWaitRun(),this.props.closeCallback&&this.props.closeCallback(),n.logData("Intelligence.Theme.CloseCallout")},n.resetSendIfWaitRun=function(){var t=(0,ws.b4)().Model;(0,Bs.oH)(t.SendTeachingCalloutVersion)&&(t.SendTeachingCalloutVersion=Bs.OJ.toString())},n.logData=function(t,n){(0,q.$U)(t)},n}(J.r),xv=function(t){function n(n){var e=t.call(this,n)||this;if(e.ys=g.createRef(),e.TW=500,e.state={HasSuggestion:!1,ReputationTier:1},e.kW=e.kW.bind(e),e.focus=e.focus.bind(e),e.FW=e.FW.bind(e),e.DW=e.DW.bind(e),e.sA=e.sA.bind(e),(0,Wa.N4)())e.aA=(0,G.z)(e.props.Form),e.aA.observe(e.sA,[e.aA.Schema.SuggestionId]);else{var i=e.props.Form;i&&i.observe(e.DW,[i.Schema.Title])}return e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){if((0,Wa.N4)())this.aA.unobserve(this.sA);else{var t=this.props.Form;t&&t.unobserve(this.DW)}},n.prototype.componentDidMount=function(){(0,Wa.N4)()||this.FW(),this.updateReputationTier()},n.prototype.focus=function(){this.ys.current&&this.ys.current.focus()},n.prototype.createButton=function(){var t,n=(0,T.pm)().DesignPage_NavBar_Theme,e=0;if(this.props.Form.isFieldReady(F.x.Schema.ResponsesCount)&&(e=this.props.Form.Model.ResponsesCount),this.state.HasSuggestion&&!e){var i=(0,V.M)({FluentIcon:"Flash On",HTMLAttributes:{className:"themeLightIcon forms-icon-size12x12"}});n=(0,T.pm)().Designer_Intelligence_SuggestThemes_Tip,t=[g.createElement("div",{className:"theme-headbar-button-icon-children",key:"theme-headbar-button-icon-children"},i)]}return(0,z.F)({ButtonStyle:2,children:t,GlyphButtonStyle:"Horizontal",HTMLAttributes:{"aria-expanded":this.props.Active,"aria-label":n,"aria-live":"polite",className:"headbar-button headbar-theme-button",disabled:(0,K.kl)(this.state.ReputationTier),onClick:this.kW},FluentIcon:"Color",IconClassName:(0,dt.QR)()?"forms-icon-size16x16":"forms-icon-size15x15",ref:this.ys,Text:(0,T.pm)().DesignPage_NavBar_Theme,TextClassName:"headbar-button-text"})},n.prototype.createFirstRunCallout=function(){var t=0;if(this.props.Form.isFieldReady(F.x.Schema.ResponsesCount)&&(t=this.props.Form.Model.ResponsesCount),this.props.Form&&!t){var n=(0,hf.F)(this.props.Form.getInstanceId());if(n)return g.createElement(kv,{closeCallback:this.focus,ThemeSuggestion:n})}return null},n.prototype.kW=function(){var t,n;if(this.state.HasSuggestion){if(this.MW("Intelligence.Theme.Navigate"),!(0,ht.x8)()){var e={Candidates:this.LW(),SuggestionId:null===(n=null===(t=this.aA)||void 0===t?void 0:t.Model)||void 0===n?void 0:n.SuggestionId};h.Pv.Resolve("IFormUserContextActionSignal").addUserActionSignal(Gi.l_[Gi.l_.ThemeSuggestion],3,e,!1)}}else this.MW("Intelligence.Theme.NoSuggestion.Navigate");this.onClickHeadBarButton()},n.prototype.DW=function(){this.RW&&window.clearTimeout(this.RW),this.RW=window.setTimeout(this.FW,this.TW)},n.prototype.FW=function(){var t=this,n=this.props.Form;n&&n.fieldsReady([n.Schema.Title]).then((function(){Uo.getThemeSuggestion(n&&n.Model.Title).then((function(e){if(e&&e.MatchQuery){var i=n,r=(0,hf.F)(i.getInstanceId());r&&(r.Model.suggestions=e.ThemeCategories),e.ThemeCategories&&e.ThemeCategories.length>0?(t.state.HasSuggestion||t.MW("Intelligence.Theme.Idea.Track"),t.setState({HasSuggestion:!0})):t.setState({HasSuggestion:!1})}else t.setState({HasSuggestion:!1})}))}))},n.prototype.MW=function(t){var n,e,i=null;this.props.Form&&this.props.Form.isFieldReady(F.x.Schema.Settings)&&(i=this.props.Form.SettingMaster.Model.IsQuizMode),(0,q.$U)(t,{HasSuggestion:this.state.HasSuggestion,IsQuiz:i,Variations:null!==(e=null===(n=this.aA)||void 0===n?void 0:n.DesignIntelligenceVariation)&&void 0!==e?e:[]})},n.prototype.sA=function(){var t=this.aA.getSuggestion("TitleSuggestsTheme"),n=!!t&&!!t.Suggestion&&t.Suggestion.length>0;this.setState({HasSuggestion:n})},n.prototype.LW=function(){var t=this.aA.Suggestions,n=[];if(t&&t.length>0){var e=w().filter(t,(function(t){return"TitleSuggestsTheme"===t.Feature}));if(e&&e.length>0&&e[0].Suggestion){var i=e[0].Suggestion;i&&i.forEach((function(t){return n.push(t.Name)}))}}return n},n}(Cv),Fv=function(t){var n=t.$width,e=t.$height,i=t.$svg,r=t.$fillColor,o=t.className,s=(0,p.pi)({fill:r,display:"inline-block",verticalAlign:"middle"},t.style),a={width:n,height:e,fill:r};return g.createElement("span",{className:o,"aria-hidden":!0,style:s},g.createElement(i.type,(0,p.pi)({},i.props,{style:a})))},Pv=g.createElement("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},g.createElement("path",{d:"M15.7525 3C16.9951 3 18.0025 4.00736 18.0025 5.25L18.002 6.003L18.7525 6.00358C20.5469 6.00533 22.0011 7.45877 22.0038 9.25244L22.0071 15.2497C22.009 16.4918 21.0021 17.5002 19.7591 17.5009L18 17.5V18.75C18 19.9926 16.9926 21 15.75 21H8.25C7.00736 21 6 19.9926 6 18.75L6.00091 17.5L4.25 17.5001C3.00736 17.5001 2 16.4927 2 15.2501V9.25358C2 7.45865 3.45507 6.00358 5.25 6.00358L5.999 6.003L6 5.25C6 4.00736 7.00736 3 8.25 3H15.7525ZM15.75 13.5H8.25C7.83579 13.5 7.5 13.8358 7.5 14.25V18.75C7.5 19.1642 7.83579 19.5 8.25 19.5H15.75C16.1642 19.5 16.5 19.1642 16.5 18.75V14.25C16.5 13.8358 16.1642 13.5 15.75 13.5ZM18.7518 7.50358H5.25C4.2835 7.50358 3.5 8.28708 3.5 9.25358V15.2501C3.5 15.6643 3.83579 16.0001 4.25 16.0001L6 16V14.25C6 13.0074 7.00736 12 8.25 12H15.75C16.9926 12 18 13.0074 18 14.25L18.0009 16.0001L19.7827 16.0005C20.1855 15.9874 20.5077 15.6567 20.5071 15.2512L20.5038 9.25398C20.5024 8.28801 19.7185 7.50452 18.7518 7.50358ZM15.7525 4.5H8.25C7.83579 4.5 7.5 4.83579 7.5 5.25L7.499 6.003H16.502L16.5025 5.25C16.5025 4.83579 16.1667 4.5 15.7525 4.5Z"})),Dv=function(t){return g.createElement(Fv,(0,p.pi)({},t,{$svg:Pv}))},Mv=g.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},g.createElement("path",{d:"M12.0127 2.25C12.7466 2.25846 13.4777 2.34326 14.1942 2.50304C14.5069 2.57279 14.7408 2.83351 14.7763 3.15196L14.9465 4.67881C15.0235 5.37986 15.6155 5.91084 16.3211 5.91158C16.5108 5.91188 16.6984 5.87238 16.8737 5.79483L18.2743 5.17956C18.5656 5.05159 18.906 5.12136 19.1234 5.35362C20.1356 6.43464 20.8894 7.73115 21.3282 9.14558C21.4228 9.45058 21.3139 9.78203 21.0568 9.9715L19.8154 10.8866C19.4612 11.1468 19.2521 11.56 19.2521 11.9995C19.2521 12.4389 19.4612 12.8521 19.8161 13.1129L21.0587 14.0283C21.3158 14.2177 21.4248 14.5492 21.3302 14.8543C20.8916 16.2685 20.1382 17.5649 19.1266 18.6461C18.9093 18.8783 18.5693 18.9483 18.278 18.8206L16.8716 18.2045C16.4693 18.0284 16.0072 18.0542 15.627 18.274C15.2468 18.4937 14.9938 18.8812 14.9454 19.3177L14.7764 20.8444C14.7415 21.1592 14.5126 21.4182 14.2045 21.4915C12.7561 21.8361 11.247 21.8361 9.79852 21.4915C9.49039 21.4182 9.26153 21.1592 9.22667 20.8444L9.05785 19.32C9.00826 18.8843 8.75483 18.498 8.37491 18.279C7.995 18.06 7.53369 18.0343 7.13269 18.2094L5.72606 18.8256C5.43471 18.9533 5.09452 18.8833 4.87727 18.6509C3.86511 17.5685 3.11168 16.2705 2.67369 14.8548C2.57935 14.5499 2.68835 14.2186 2.94533 14.0293L4.18867 13.1133C4.54281 12.8531 4.75196 12.4399 4.75196 12.0005C4.75196 11.561 4.54281 11.1478 4.1882 10.8873L2.94565 9.97285C2.68828 9.78345 2.57918 9.45178 2.67386 9.14658C3.11261 7.73215 3.86643 6.43564 4.87861 5.35462C5.09608 5.12236 5.43643 5.05259 5.72773 5.18056L7.12811 5.79572C7.53105 5.97256 7.99429 5.94585 8.37626 5.72269C8.75658 5.50209 9.00977 5.11422 9.05866 4.67764L9.22873 3.15196C9.26425 2.83335 9.49835 2.57254 9.81129 2.50294C10.5286 2.34342 11.2604 2.25865 12.0127 2.25ZM12.0128 3.7499C11.5588 3.75524 11.106 3.79443 10.6583 3.86702L10.5494 4.84418C10.4476 5.75368 9.92052 6.56102 9.13091 7.01903C8.33646 7.48317 7.36785 7.53903 6.52507 7.16917L5.62678 6.77456C5.05485 7.46873 4.59963 8.25135 4.27901 9.09168L5.07681 9.67879C5.81562 10.2216 6.25196 11.0837 6.25196 12.0005C6.25196 12.9172 5.81562 13.7793 5.07759 14.3215L4.27853 14.9102C4.59887 15.752 5.05417 16.5361 5.62649 17.2316L6.53162 16.8351C7.36971 16.4692 8.33173 16.5227 9.12402 16.9794C9.9163 17.4361 10.4448 18.2417 10.5485 19.1526L10.6574 20.1365C11.5471 20.2878 12.4559 20.2878 13.3456 20.1365L13.4545 19.1527C13.5553 18.2421 14.0832 17.4337 14.8765 16.9753C15.6697 16.5168 16.6337 16.463 17.4733 16.8305L18.3777 17.2267C18.9495 16.5323 19.4046 15.7495 19.7252 14.909L18.9272 14.3211C18.1884 13.7783 17.7521 12.9162 17.7521 11.9995C17.7521 11.0827 18.1884 10.2206 18.9263 9.67847L19.7232 9.09109C19.4026 8.25061 18.9473 7.46784 18.3753 6.77356L17.4788 7.16737C17.1134 7.32901 16.7183 7.4122 16.3192 7.41158C14.8495 7.41004 13.616 6.30355 13.4556 4.84383L13.3467 3.8667C12.9012 3.7942 12.4531 3.75512 12.0128 3.7499ZM12.0002 8.24995C14.0713 8.24995 15.7502 9.92888 15.7502 12C15.7502 14.071 14.0713 15.75 12.0002 15.75C9.92912 15.75 8.25018 14.071 8.25018 12C8.25018 9.92888 9.92912 8.24995 12.0002 8.24995ZM12.0002 9.74995C10.7575 9.74995 9.75018 10.7573 9.75018 12C9.75018 13.2426 10.7575 14.25 12.0002 14.25C13.2428 14.25 14.2502 13.2426 14.2502 12C14.2502 10.7573 13.2428 9.74995 12.0002 9.74995Z"})),Lv=function(t){return g.createElement(Fv,(0,p.pi)({},t,{$svg:Mv}))},Rv=g.createElement("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},g.createElement("path",{d:"M12.0001 1.99805C17.5238 1.99805 22.0016 6.47589 22.0016 11.9996C22.0016 17.5233 17.5238 22.0011 12.0001 22.0011C6.47638 22.0011 1.99854 17.5233 1.99854 11.9996C1.99854 6.47589 6.47638 1.99805 12.0001 1.99805ZM14.939 16.4993H9.06118C9.71322 18.9135 10.8466 20.5011 12.0001 20.5011C13.1536 20.5011 14.2869 18.9135 14.939 16.4993ZM7.5084 16.4999L4.78591 16.4998C5.74425 18.0328 7.1777 19.2384 8.88008 19.9104C8.3578 19.0906 7.92681 18.0643 7.60981 16.8949L7.5084 16.4999ZM19.2143 16.4998L16.4918 16.4999C16.168 17.8337 15.7004 18.9995 15.119 19.9104C16.716 19.2804 18.0757 18.1814 19.0291 16.7833L19.2143 16.4998ZM7.09351 9.99895H3.7359L3.73115 10.0162C3.57906 10.6525 3.49854 11.3166 3.49854 11.9996C3.49854 13.0558 3.69112 14.0669 4.0431 14.9999L7.21626 14.9995C7.07396 14.0504 6.99854 13.0422 6.99854 11.9996C6.99854 11.3156 7.031 10.6464 7.09351 9.99895ZM15.397 9.99901H8.60316C8.53514 10.6393 8.49853 11.309 8.49853 11.9996C8.49853 13.0591 8.58468 14.0694 8.73827 14.9997H15.2619C15.4155 14.0694 15.5016 13.0591 15.5016 11.9996C15.5016 11.309 15.465 10.6393 15.397 9.99901ZM20.2647 9.99811L16.9067 9.99897C16.9692 10.6464 17.0016 11.3156 17.0016 11.9996C17.0016 13.0422 16.9262 14.0504 16.7839 14.9995L19.9571 14.9999C20.309 14.0669 20.5016 13.0558 20.5016 11.9996C20.5016 11.3102 20.4196 10.64 20.2647 9.99811ZM8.88114 4.08875L8.85823 4.09747C6.81092 4.91218 5.1549 6.49949 4.25023 8.49935L7.29835 8.49972C7.61171 6.74693 8.15855 5.221 8.88114 4.08875ZM12.0001 3.49805L11.8844 3.50335C10.619 3.6191 9.39651 5.62107 8.8288 8.4993H15.1714C14.6052 5.62914 13.388 3.63033 12.1264 3.50436L12.0001 3.49805ZM15.1201 4.08881L15.2269 4.2629C15.8961 5.37537 16.4043 6.83525 16.7018 8.49972L19.7499 8.49935C18.8853 6.58795 17.3343 5.05341 15.4113 4.21008L15.1201 4.08881Z"})),Av=function(t){return g.createElement(Fv,(0,p.pi)({},t,{$svg:Rv}))},Ev=g.createElement("svg",{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},g.createElement("path",{d:"M8.75 12C9.9926 12 11 13.0074 11 14.25V15.752L10.9921 15.8604C10.6814 17.9866 8.7715 19.009 5.56679 19.009C2.37361 19.009 0.4333 17.9983 0.0144601 15.8966L0 15.75V14.25C0 13.0074 1.00736 12 2.25 12H8.75ZM8.75 13.5H2.25C1.83579 13.5 1.5 13.8358 1.5 14.25V15.6704C1.77979 16.8708 3.05063 17.509 5.56679 17.509C8.0829 17.509 9.2966 16.8777 9.5 15.6932V14.25C9.5 13.8358 9.1642 13.5 8.75 13.5ZM5.5 4C7.433 4 9 5.567 9 7.5C9 9.433 7.433 11 5.5 11C3.567 11 2 9.433 2 7.5C2 5.567 3.567 4 5.5 4ZM17.75 0C18.9926 0 20 1.00736 20 2.25V5.75C20 6.99264 18.9926 8 17.75 8H16.2951L14.1286 10.1414C13.6375 10.6266 12.846 10.6219 12.3608 10.1308C12.1296 9.8968 12 9.5812 12 9.2526L11.9994 7.9862C10.8747 7.86155 10 6.90792 10 5.75V2.25C10 1.00736 11.0074 0 12.25 0H17.75ZM5.5 5.5C4.39543 5.5 3.5 6.39543 3.5 7.5C3.5 8.6046 4.39543 9.5 5.5 9.5C6.60457 9.5 7.5 8.6046 7.5 7.5C7.5 6.39543 6.60457 5.5 5.5 5.5ZM17.75 1.5H12.25C11.8358 1.5 11.5 1.83579 11.5 2.25V5.75C11.5 6.16421 11.8358 6.5 12.25 6.5H13.4986L13.4997 8.6539L15.6789 6.5H17.75C18.1642 6.5 18.5 6.16421 18.5 5.75V2.25C18.5 1.83579 18.1642 1.5 17.75 1.5Z"})),Ov=function(t){return g.createElement(Fv,(0,p.pi)({},t,{$svg:Ev}))},_v=g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},g.createElement("path",{d:"M12 4C9.236 4 7 6.236 7 9a.75.75 0 0 0 1.5 0c0-1.936 1.564-3.5 3.5-3.5s3.5 1.564 3.5 3.5c0 .852-.222 1.42-.529 1.86-.324.463-.767.823-1.302 1.232l-.138.105c-1.01.768-2.281 1.734-2.281 3.803v.25a.75.75 0 0 0 1.5 0V16c0-1.317.714-1.863 1.785-2.682l.046-.035c.527-.403 1.147-.887 1.62-1.564.49-.701.799-1.57.799-2.719 0-2.764-2.236-5-5-5Zm0 17a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"})),Bv=(g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},g.createElement("path",{fill:"#212121",d:"M12 4a5 5 0 0 0-5 5 1 1 0 0 0 2 0c0-1.658 1.342-3 3-3s3 1.342 3 3c0 .816-.199 1.294-.438 1.629-.262.365-.625.638-1.128.985l-.116.078c-.447.306-1.023.699-1.469 1.247-.527.648-.849 1.467-.849 2.561v.5a1 1 0 1 0 2 0v-.5c0-.656.178-1.024.4-1.299.257-.314.603-.552 1.114-.903l.053-.037c.496-.34 1.133-.786 1.62-1.468C16.7 11.081 17 10.183 17 9a5 5 0 0 0-5-5Zm0 17.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5Z"})),function(t){return g.createElement(Fv,(0,p.pi)({},t,{$svg:_v}))}),Hv=g.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},g.createElement("path",{d:"M17.75 2.001a2.25 2.25 0 0 1 2.245 2.096L20 4.25v15.498a2.25 2.25 0 0 1-2.096 2.245l-.154.005H6.25a2.25 2.25 0 0 1-2.245-2.096L4 19.75V4.251a2.25 2.25 0 0 1 2.096-2.245l.154-.005h11.5Zm0 1.5H6.25a.75.75 0 0 0-.743.648l-.007.102v15.498c0 .38.282.694.648.743l.102.007h11.5a.75.75 0 0 0 .743-.648l.007-.102V4.251a.75.75 0 0 0-.648-.743L17.75 3.5Z"}),g.createElement("path",{d:"M7 15.75a.75.75 0 0 1 .75-.75h8.5a.75.75 0 1 1 0 1.5h-8.5a.75.75 0 0 1-.75-.75Zm0-8A.75.75 0 0 1 7.75 7h8.5a.75.75 0 1 1 0 1.5h-8.5A.75.75 0 0 1 7 7.75Zm0 4a.75.75 0 0 1 .75-.75h8.5a.75.75 0 1 1 0 1.5h-8.5a.75.75 0 0 1-.75-.75Z"})),Gv=function(t){return g.createElement(Fv,(0,p.pi)({},t,{$svg:Hv}))},qv=g.createElement("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},g.createElement("path",{d:"M4 13.999L13 14C14.0538 14 14.9181 14.8155 14.9945 15.8507L15 16V17.5C14.999 21 11.284 22 8.5 22C5.77787 22 2.1647 21.044 2.00545 17.7296L2 17.5V15.999C2 14.9452 2.8164 14.0809 3.85081 14.0045L4 13.999ZM15.22 14H20C21.0538 14 21.9181 14.8164 21.9945 15.8508L22 16V17C21.999 20.062 19.142 21 17 21C16.32 21 15.569 20.904 14.86 20.678C15.196 20.292 15.467 19.851 15.662 19.351C16.205 19.476 16.715 19.5 17 19.5L17.2665 19.494C18.2518 19.4509 20.3529 19.1306 20.4927 17.205L20.5 17V16C20.5 15.7547 20.3222 15.5504 20.0896 15.5081L20 15.5H15.949C15.865 14.9986 15.6554 14.5432 15.3545 14.1598L15.22 14H20H15.22ZM4 15.499L3.89934 15.509C3.77496 15.5343 3.69 15.6018 3.646 15.645C3.6028 15.689 3.53528 15.7733 3.51 15.898L3.5 15.999V17.5C3.5 18.509 3.95 19.222 4.917 19.742C5.74315 20.1869 6.91951 20.4563 8.18258 20.4951L8.5 20.5L8.8174 20.4951C10.0803 20.4563 11.2559 20.1869 12.083 19.742C12.9886 19.2545 13.4416 18.5974 13.4947 17.6849L13.5 17.499V16C13.5 15.7547 13.3222 15.5504 13.0896 15.5081L13 15.5L4 15.499ZM8.5 3C10.985 3 13 5.015 13 7.5C13 9.985 10.985 12 8.5 12C6.015 12 4 9.985 4 7.5C4 5.015 6.015 3 8.5 3ZM17.5 5C19.433 5 21 6.567 21 8.5C21 10.433 19.433 12 17.5 12C15.567 12 14 10.433 14 8.5C14 6.567 15.567 5 17.5 5ZM8.5 4.5C6.846 4.5 5.5 5.846 5.5 7.5C5.5 9.154 6.846 10.5 8.5 10.5C10.154 10.5 11.5 9.154 11.5 7.5C11.5 5.846 10.154 4.5 8.5 4.5ZM17.5 6.5C16.397 6.5 15.5 7.397 15.5 8.5C15.5 9.603 16.397 10.5 17.5 10.5C18.603 10.5 19.5 9.603 19.5 8.5C19.5 7.397 18.603 6.5 17.5 6.5Z"})),Vv=function(t){return g.createElement(Fv,(0,p.pi)({},t,{$svg:qv}))},zv=e(65274);function Qv(){Sv=new Ft.bC((0,oi.d8)().getOCPSToken())}function Uv(t){return(Sv&&Sv.states()!==Ft.Cb.Rejected||Qv(),Sv.promise()).then(t).catch((function(n){if(n&&n.response&&401===n.response.statusCode)return(Sv&&Sv.states()===Ft.Cb.Pending||Qv(),Sv.promise()).then(t);throw n}))}var $v=function(t){function n(e){var i=t.call(this,e)||this;i.bS=g.createRef(),i.AW=!1,i.state={ReputationTier:1,AADCFeedbackEnabled:!0,OCPSFeedbackEnabled:!0,OCPSFetched:!1},i.EW=i.EW.bind(i),i.OW=i.OW.bind(i),i._W=i._W.bind(i),i.BW=i.BW.bind(i),i.HW=i.HW.bind(i),i.qW=i.qW.bind(i),i.ep=i.ep.bind(i),n.executeForHelpButton=n.executeForHelpButton.bind(i),n.executeForSignOutButton=n.executeForSignOutButton.bind(i),i.As=function(){return i.forceUpdate()},i.Gu=(0,k.f5)().Model;var r=i.props.FormMaster;return r&&!r.isFieldReady(r.Schema.Settings)&&(i.AW=!0,r.observe(i.As,[r.Schema.Settings])),i.VW=i.VW.bind(i),r&&r.observe(i.VW,[r.Schema.ReputationTier]),i}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){var t=this.props.FormMaster;t&&this.AW&&t.unobserve(this.As)},n.prototype.render=function(){var t=this.props.FormMaster,e=[];if(this.props.DisableShare||(e.push(this.zW()),e.push(this.QW())),t&&e.push(this.UW()),t&&t.isFieldReady(F.x.Schema.Settings)&&!t.Model.Settings.IsQuizMode&&(0,I.E)()&&e.push(this.jW()),e.push(this.KW()),e.push(this.QW()),(0,ht.x8)()||e.push(this.JW()),t&&e.push(n.createTermsItem()),!wa()){e.push(n.createHelpItem());var i=(0,c.k0)().userInfo.DisplayName,r=(0,c.k0)().userInfo.Email,o=(i||r)&&!dt.Rw;o&&(e.push(this.QW()),e.push(this.ZW(i,r))),(0,ti.ko)()||dt.Rw||(!o&&e.push(this.QW()),e.push(n.createLogoutItem()))}return g.createElement(Q.Th,{ButtonStyle:2,MenuItemType:0,ClassName:"designer-more-options-menu",ClassNameForContainer:"headbar-button-container",HTMLAttributes:Wv(),onMenuExpand:this.ep,ref:this.bS},e)},n.prototype.ep=function(){return(0,p.mG)(this,void 0,void 0,(function(){var t,n=this;return(0,p.Jh)(this,(function(e){switch(e.label){case 0:if((0,q.$U)("DesignPage.MoreOptionMenuClicked"),!(0,S.ro)())return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Ar()];case 2:return e.sent().isFeedbackSurveyEnabledByAADC()||(this.setState({AADCFeedbackEnabled:!1}),(0,q.$U)("FeedbackDisabledByAADC")),[2];case 3:return e.sent(),(0,q.$U)("DesignPage.GetAADCFeedbackEnabledFailure"),[2];case 4:return(0,ht.x8)()||this.state.OCPSFetched||((t=new Yn.o("OCPS.Fetch")).start(),Uv((function(t){return(0,q.$U)("OCPSSettingFetchStart"),(0,ae.lW)({headers:{Authorization:"Bearer ".concat(t.token),"x-Cid":t.CorrelationId},method:"GET",requestUri:(0,ht.yv)()?"https://clients.config.office.net/user/v1.0/web/policies":"https://sip.clients.config.office.net/user/v1.0/web/policies"})})).then((function(e){if(t.end({resultType:"Success"}),(0,q.$U)("OCPSSettingFetchSuccess"),e&&e.value&&e.value.length){var i=e.value[0].policiesPayload.filter((function(t){return"office16;L_SendFeedback"===t.settingId}));i.length&&"0"===i[0].value&&(n.setState({OCPSFeedbackEnabled:!1}),(0,q.$U)("FeedbackDisabledByOCPS"))}n.setState({OCPSFetched:!0})})).catch((function(n){throw t.end({resultType:"Failure"}),(0,q.$U)("OCPSSettingFetchFailure"),n}))),[2]}}))}))},n.prototype.KW=function(){return jv(this.EW,"PrintForm",(0,T.pm)().DesignPage_NavBar_PrintForm,(0,K.kl)(this.state.ReputationTier),Dv)},n.prototype.UW=function(){return jv(this.OW,"Settings",(0,T.pm)().MoreOptionsMenu_Setting,(0,K.kl)(this.state.ReputationTier),Lv)},n.prototype.zW=function(){var t=(0,T.pm)();return jv(this._W,"Collaboration",(0,S.ro)()?t.Page_UrlPreview_PrefixTitle_Duplicate:t.MoreOptionsMenu_CollaborateOrDuplicate,(0,K.NT)(this.state.ReputationTier),Vv)},n.prototype.QW=function(){return g.createElement(j.s,{key:(0,zv.EL)("line-breaker-")},(0,Q.Gy)())},n.prototype.jW=function(){return jv(this.BW,"MultiLingual",(0,T.pm)().MoreOptionsMenu_Multilingual,(0,K.kl)(this.state.ReputationTier),Av)},n.prototype.JW=function(){return jv(this.HW,"Feedback",(0,T.pm)().DesignPage_NavBar_Feedback,!this.state.OCPSFeedbackEnabled||!this.state.AADCFeedbackEnabled,Ov)},n.createHelpItem=function(){return jv(n.executeForHelpButton,"Help",(0,T.pm)().DesignPage_NavBar_Help,!1,Bv)},n.createTermsItem=function(){return jv(n.executeForTermsButton,"Terms",(0,T.pm)().Addin_Legal,!1,Gv)},n.prototype.ZW=function(t,n){return g.createElement(j.s,{onClick:this.qW,Active:!0,key:"userInfo"},g.createElement("div",{className:"designer-more-options-menu-item userInfo"},t?g.createElement("p",null,t):void 0,n?g.createElement("p",null,n):void 0))},n.createLogoutItem=function(){return jv(n.executeForSignOutButton,"SingOut",(0,T.pm)().MoreOptionsMenu_Sign_out)},n.prototype.EW=function(){var t=this;(0,q.$U)("DesignPage.Menu.PrintForm");if(this.props.SetPrintViewState){this.props.SetPrintViewState(!0,(function(){setTimeout((function(){var n=document.createElement("style"),e=document.createTextNode("@page{size:unset;margin:0mm 5mm;}");n.appendChild(e),$(n).appendTo("head");var i=$("#content-root"),r=$("#reactshellheader"),o=$("#print-time-content");o.appendTo("body"),i&&i.hide(),r&&r.hide(),(0,ti.B6)((function(){o.appendTo("#content-root"),r.show(),i.show(),$(n).remove(),t.props.SetPrintViewState(!1)}))}),500)}))}},n.prototype.OW=function(){this.XW("Settings")},n.prototype._W=function(){this.XW("ShareForm")},n.prototype.BW=function(){this.XW("MultiLingual")},n.prototype.HW=function(){"undefined"==typeof O365Shell?Er().multiFeedback({}):lc()},n.executeForHelpButton=function(){(0,q.$U)("DesignPage.Help.Navigate");var t=(0,$s.K)(Vs(),"MicrosoftOfficeLyncWebAppHelp","width=400,height=500,menubar=no,status=no,scrollbars=no,titlebar=no,toolbar=no,resizable=yes");t&&t.focus()},n.executeForTermsButton=function(){var t=(0,$s.K)((0,ef.bR)(),"MicrosoftOfficeLyncWebAppHelp","width=400,height=500,menubar=no,status=no,scrollbars=no,titlebar=no,toolbar=no,resizable=yes");t&&t.focus()},n.prototype.qW=function(){(0,q.$U)("DesignPage.Menu.UserInfo");var t=(0,ca.xi)();this.props.IsConsumerUserType&&(t=(0,ca._C)()),(0,dt.QR)()?(0,$s.K)(t):(0,Dn.gB)(t)},n.executeForSignOutButton=function(){(0,q.$U)("DesignPage.Menu.SignOut"),(0,se.a)().AuthContext.signOut()},n.prototype.XW=function(t){var n,e=this,i=(0,k.f5)().Model.FlexPane===t?"None":t;switch("None"!==i&&(0,kr.cz)("Flexpane-"+i,(function(){e.bS.current&&e.bS.current.focus()})),i){case"Feedback":n="DesignPage.Feedback.Navigate";break;case"Settings":n="DesignPage.Setting.Navigate";break;case"MultiLingual":n="DesignPage.MultiLingual.Navigate";break;case"ShareForm":n="DesignPage.SharePane.Navigate"}n&&(0,q.$U)(n,{isSuiteHeader:wa(),source:"DesignPage.HeadBar"}),this.Gu.FlexPane=i},n.prototype.VW=function(){var t=this,n=this.props.FormMaster;n&&n.fieldsReady([n.Schema.ReputationTier]).then((function(){var e=n&&n.Model&&n.Model.ReputationTier||0;t.setState({ReputationTier:e})}))},n}(J.r);function jv(t,n,e,i,r){void 0===i&&(i=!1);var o=!!r,s=o&&r===Av?{$width:16,$height:16,$fillColor:"#6e6e6e",style:{padding:"0 8px 0 18px"}}:{$width:20,$height:20,$fillColor:"#6e6e6e",style:{padding:"0 6px 0 16px"}},a=o&&g.createElement(r,s),u=(0,N.j)("designer-more-options-menu-item",o&&"withIcon"),c=(0,T.pm)();return"Feedback"===n&&i?function(t,n,e,i,r,o,s){return g.createElement(j.s,{onClick:t,Active:!0,key:n,Disabled:i},g.createElement("div",{className:e},s,g.createElement("span",null,r),g.createElement("div",{className:"feedback-tooltip"},(0,Dr.ax)({ButtonStyle:0,HTMLAttributes:Kv(o),children:Kv(o).children,Tooltip:o}))))}(t,n,u,i,e,(0,S.ro)()?c.AADC_Tooltip:c.OCPS_Tooltip,a):g.createElement(j.s,{onClick:t,Active:!0,key:n,Disabled:i},g.createElement("div",{className:"designer-more-options-menu-item-wrapper"},a,g.createElement("div",{className:u},g.createElement("span",null,e))))}function Wv(){var t;return t=!(0,dt.QR)()||(0,dt.Rw)()||(0,dt.AO)()?g.createElement(V.F,{FluentIcon:"More Horizontal",HTMLAttributes:{className:"forms-icon-size20x20"}}):[g.createElement("span",{className:"headbar-button-text",key:"moreButtonText"},(0,T.pm)().Designer_More_Button_Text),g.createElement(V.F,{FluentIcon:"Chevron Down",HTMLAttributes:{className:"forms-icon-size12x12"},key:"moreButtonIcon"})],{"aria-label":(0,T.pm)().Header_Bar_Menu_Tooltip,children:t,className:"headbar-button",title:(0,T.pm)().Header_Bar_Menu_Tooltip}}function Kv(t){return{"aria-label":t,children:[(0,V.M)({HTMLAttributes:{className:"forms-icon-size14x14"},IconName:"Info",key:"icon"})]}}var Jv=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.YW=function(){n.forceUpdate(),n.props.form.unobserve(n.tK)},n.tK=function(t){n.props.form.isFieldReady(F.x.Schema.Questions)&&(!!(t.OldValues.Questions||[]).length!==!!t.Master.Model.Questions.length&&n.forceUpdate())},n}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){(0,ws.b4)().observe(this.YW,[ws.TS.Schema.SendTeachingCalloutVersion]),this.props.form.observe(this.tK,[F.x.Schema.Questions])},n.prototype.componentWillUnmount=function(){(0,ws.b4)().unobserve(this.YW),this.props.form.unobserve(this.tK)},n.prototype.render=function(){if(!(0,ws.OT)((0,ws.b4)().Model.SendTeachingCalloutVersion))return null;var t=null;return this.props.form.isFieldReady(F.x.Schema.Questions)&&this.props.form.Model.Questions.length&&(t=this.IW("teachingCallout-send","teachingCallout-send-direction")),t},n.prototype.IW=function(t,n){var e=(0,T.pm)().FirstRun_Callout_ShareButton_Text,i=(0,Bs.yM)((function(){(0,ws.b4)().Model.SendTeachingCalloutVersion=ws.BT.toString()})),r=(0,Bs.Bi)((0,zi.Jn)("/Images/send-form.gif"),null,Bs.Mb);return(0,Bs.dq)(r,i,t,n,e)},n}(J.r);var Zv,Xv=function(t){function n(n){var e=t.call(this,n)||this;return e.nK=g.createRef(),e.eK=g.createRef(),e.rK=g.createRef(),e.update=function(){return e.forceUpdate()},e.uxStateModel=(0,k.f5)().Model,e.oK=e.oK.bind(e),e.uK=e.uK.bind(e),e.PE=e.PE.bind(e),e.state={UserType:0},ni().registerUsersStateChange(e.update),e}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this;(0,Fn.Ng)().then((function(n){t.setState({UserType:n})}))},n.prototype.componentWillUnmount=function(){ni().unregisterUsersStateChange(this.update)},n.prototype.render=function(){return g.createElement("div",null,this.createHeadBar())},n.prototype.createHeadBar=function(){var t,n,e,i,r=this,o=(0,c.k0)().isProPortal?(0,T.pm)().HeaderBar_FormsProAppTitle:(0,T.pm)().HeaderBar_AppTitle,s={className:"headbar-app-title",title:o,onClick:function(){return r.cK()}};if((0,dt.Rw)()){var a={className:"headbar-app-title headbar-app-title-iframe-label segoeUI"};t=(0,sr._)({HTMLAttributes:a,Label:o}),e=g.createElement("img",{className:"headbar-app-logo-iframe",src:(0,zi.Jn)("/Images/Forms.32x32x32.png")})}else if((0,dt.QR)()){a={className:"headbar-app-title headerbar-app-tile-label segoeUI"};t=(0,sr._)({HTMLAttributes:a,Label:o})}else t=(0,Fr.E)({HTMLAttributes:s,Text:o,ButtonStyle:2});return(0,dt.QR)()||(i={AppLauncherCollapseTrigger:this.props.AppLauncherCollapseTrigger},n=g.createElement(Nv,(0,p.pi)({},i))),g.createElement("div",{className:"headbar-container",style:{display:this.props.ShouldDisabled?"none":void 0}},!wa()&&g.createElement("div",{className:"headbar-left-content"},n,(0,dt.Rw)()&&e,t),this.hK())},n.prototype.cK=function(){var t=(0,k.f5)();t.bulkEdit((function(n){t.hideTopView(),n.FormId=void 0,n.FormMaster=void 0,n.CriticalError=void 0,n.Token=void 0,n.FormCollectionType="OwnedForms",n.SearchContent="",n.GroupMaster=void 0,(0,Zs.XA)()})),(0,ys.bx)(),this.forceUpdate()},n.prototype.hK=function(){var t,n,e,i,r,o=!1,s=(0,k.f5)().Model.FormMaster;if(s&&(this.uxStateModel.FormId?s.isFieldReady(F.x.Schema.Id)&&s.Model.Id===this.uxStateModel.FormId&&(o=!0):o=!0),o&&(!(0,dt.GF)()||(0,dt.Rw)())){var a=ni().getUserCount(),u=ni().getUser((0,c.k0)().userInfo.UserId);if(1===a&&u&&u.userId===(0,c.k0)().userInfo.UserId)t=void 0;else{var l=[];ni().getAllUsers().forEach((function(t){t.userId!==(0,c.k0)().userInfo.UserId&&l.push(t)})),t=this.dK(l)}n=g.createElement(Iv,{Active:!1,onClick:this.oK,ref:this.nK,Form:s});var f=this.uxStateModel.FlexPane;s.isFieldReady(F.x.Schema.Category)&&(0,C.w)(s,"DisableEditForm")||(e=g.createElement(xv,{Active:"Theme"===f,onClick:this.PE,ref:this.eK,Form:s}));var h=(r={form:s},g.createElement(Jv,(0,p.pi)({},r)));i=g.createElement(Tv,{Active:"SendForm"===f,onClick:this.uK,ref:this.rK,FirstRunCallout:h,Form:s})}var d=20&this.state.UserType,m="MoreOptionMenu";s&&s.isFieldReady(F.x.Schema.Id)&&(m=s.Model.Id);var v=g.createElement($v,{FormMaster:s,IsConsumerUserType:!!d,key:m,SetPrintViewState:this.props.SetPrintViewState}),b=g.createElement("div",{className:"saving-status-assignments-quiz"},g.createElement(na,{key:"headerFormName"}));return g.createElement(g.Fragment,null,(0,dt.Rw)()&&((0,vt.tq)()?Xs({Form:s}):b),g.createElement("div",{className:"headbar-right-content"},g.createElement("div",{className:"headbar-coauthor-list-div","aria-live":"polite"},t),n,e,!(0,dt.Rw)()&&i,v))},n.prototype.oK=function(){var t=this,n=(0,k.f5)();n.bulkEdit((function(){n.Model.Preview={PreviousTopView:"None"},n.showTopView("Preview",(function(){t.nK.current&&t.nK.current.focus()}))})),(0,q.$U)("DesignPage.PreView.Navigate",{isSuiteHeader:wa(),previewMode:"Desktop"})},n.prototype.PE=function(){var t=this;(0,kr.cz)("Flexpane-Theme",(function(){t.eK.current&&t.eK.current.focus()})),this.XW("Theme")},n.prototype.uK=function(){var t=this;(0,kr.cz)("Flexpane-SendForm",(function(){t.rK.current&&t.rK.current.focus()})),this.uxStateModel&&this.uxStateModel.FormMaster&&"None"===this.uxStateModel.FlexPane&&Uo.predictResponseTime(this.uxStateModel.FormMaster,!0),this.XW("SendForm")},n.prototype.mK=function(t){return g.createElement("div",{className:"headbar-coauthor-container",key:t.userId},(0,Qa.Y)({email:t.email,name:t.displayName,tooltip:t.displayName?(0,T.pm)().DesignPage_NavBar_CoAuthor.format(t.displayName):t.userId,displayText:(0,Ua.c)(t.displayName,t.firstName,t.lastName),isCoAuthUser:!0}))},n.prototype.dK=function(t){var n,e=this;if(t.length<=3)n=t.map((function(t){return e.mK(t)}));else{var i=t.slice(2).map((function(t){return t.displayName||t.userId})).join((0,T.pm)().Common_ItemSeperator);n=[this.mK(t[0]),this.mK(t[1]),g.createElement("div",{className:"headbar-coauthor-container",key:"moreAuthor"},(0,Qa.Y)({tooltip:(0,T.pm)().DesignPage_NavBar_CoAuthors.format(i),displayText:(t.length-2).toString()+"+",isCoAuthUser:!0}))]}return n},n.prototype.XW=function(t){var n=this.uxStateModel.FlexPane===t?"None":t;this.vK(n),this.uxStateModel.FlexPane=n},n.prototype.vK=function(t){var n;switch(t){case"Feedback":n="DesignPage.Feedback.Navigate";break;case"SendForm":n="DesignPage.Send.Navigate";break;case"Settings":n="DesignPage.Setting.Navigate";break;case"ShareForm":n="DesignPage.SharePane.Navigate";break;case"MultiLingual":n="DesignPage.MultiLingual.Navigate";break;case"Theme":n="DesignPage.Theme.Navigate";break;case"ImagePicker":n="DesignPage.ImagePicker.Navigate"}n&&(0,q.$U)(n,{isSuiteHeader:wa(),source:"DesignPage.HeadBar"})},n}(J.r),Yv=function(){function t(){}return t.prototype.createDesignContent=function(t){return g.createElement(Th,(0,p.pi)({},t))},t.prototype.createDesignPageContainer=function(){return g.createElement(bv,null)},t.prototype.createFormTitleAuthoringContianer=function(t){return So(t)},t.prototype.createInsertCardPane=function(t,n){return function(t,n){return No().getInsertCardPane(t,n)}(t,n)},t.prototype.createQuestionDesigner=function(t){return gs(t)},t.prototype.createCascadeQuestionDesigner=function(t){return function(t){return No().createCascadeQuestionDesigner(t)}(t)},t.prototype.createCVChoiceQuestionDesigner=function(t){return function(t){return No().createCVChoiceQuestionDesigner(t)}(t)},t.prototype.createQuestionRenderer=function(t){return(0,ps.n)(t)},t.prototype.createPageHeader=function(t){return function(t){return g.createElement(Xv,(0,p.pi)({},t))}(t)},t}();function tg(){return h.Pv.Resolve(6)}!function(t){t[t.None=0]="None",t[t.SimilarMathQuestionSuggestions=1]="SimilarMathQuestionSuggestions"}(Zv||(Zv={}));function ng(t,n,e){var i;switch(t.QuestionType){case"Question.Choice":i=Y.L.createDefaultDefinition();var r=void 0;r=(r=t.IncorrectAnswers.map((function(t){return{Description:t,IsGenerated:!0,IsMathOption:!0}}))).concat({Description:t.CorrectAnswer,IsAnswerKey:!0,IsGenerated:!0,IsMathOption:!0}),i.Choices=y.shuffle(r);break;case"Question.DateTime":i=M.createDefaultDefinition();break;case"Question.TextField":i=st.createDefaultDefinition();break;case"Question.Rating":i=H.createDefaultDefinition();break;default:return null}return i.Title=t.QuestionTitle,i.Subtitle=t.Formula,i.IsMathQuiz=!0,i.MathTemplateID=t.TemplateID,i.IsQuiz=!0,i.ShowSubtitle=!0,i.Point=n,i.Required=e,i}var eg={createMathQuestionByType:ng,getMathQuestionsSuggestion:function(t,n,e){var i={Context:JSON.stringify(t),Features:Zv.SimilarMathQuestionSuggestions,FormId:t.FormId,IncorrectAnswerCount:3,Origin:t.Origin,QuestionCount:n||3,QuestionId:t.QuestionId};return To.getInstance().mathQuestionGeneration(i,e).then(function(t){return function(n){var e={MatchQuery:!0,Templates:[]},i=n;if(i&&i.Results&&i.Results.length&&i.Results[0].Result&&i.Results[0].Result.Questions){var r=[];i.Results[0].Result.Questions.map((function(n){var e=ng(n,t.QuestionPoints,t.QuestionRequired);null!==e&&r.push(e)})),e.Templates.push({Questions:r,TemplateId:i.Results[0].Result.Id}),e.Templates=Uo.getFilteredTemplates(e.Templates)}return e}}(t)).catch((function(t){return t}))}},ig=function(t){function n(n){var e=t.call(this,n)||this;return e.pK=e.pK.bind(e),e.bK=e.bK.bind(e),e}return(0,p.ZT)(n,t),n.prototype.render=function(){var t,n=this.props.Question,e=this.props.Selected,i=this.props.Index,r="form-intelligence-question-row",o="forms-icon-size18x18";if(e)r=(0,N.j)(r,this.props.IsMobile&&"mobile-office-form-intelligence-theme-li",!this.props.IsMobile&&"office-form-intelligence-theme-li"),o="office-form-theme-secondary-color",t="Checkmark";else{switch(n.Type){case"Question.Choice":t="Radio Button Filled",o="forms-icon-size16x16";break;case"Question.TextField":t="Text Field",o="forms-icon-size20x20";break;case"Question.Rating":t="Star";break;case"Question.DateTime":t="Calendar LTR";break;case"Question.Ranking":t="Arrow Sort";break;case"Question.MatrixChoiceGroup":t="Likert";break;case"Question.NPS":t="Top Speed",o="forms-icon-size20x20";break;case"Question.FileUpload":t="Arrow Upload";break;default:t="Add"}o=(0,N.j)(o,"form-intelligence-icon-black")}o=(0,N.j)(o,"form-intelligence-question-row-icon");var s,a={className:r,key:"formIntelligenceRow"+i,onClick:this.pK,onKeyDown:this.bK,ref:"formIntelligenceRow"+i,tabIndex:0};if(n.IsMathQuiz){var u=(0,er.Rq)({DisableLinebreaks:!0,Formula:n.Subtitle});s=g.createElement("div",{className:"form-intelligence-question-row-math-container"},g.createElement("p",{className:"form-intelligence-question-row-math-text"},n.Title),g.createElement("div",{className:"form-intelligence-question-row-math-formula"},u))}else s=g.createElement("p",{className:"form-intelligence-question-row-text"},n.Title);var c=(0,V.M)({FluentIcon:t,HTMLAttributes:{className:o}});return g.createElement("div",{className:"form-intelligence-question-row-container",key:"formIntelligenceRowContainer"+i},g.createElement("div",(0,p.pi)({},a),s,c))},n.prototype.pK=function(){this.props.changeQuestionSuggestion(this.props.Index,this.props.Selected)},n.prototype.bK=function(t){switch(t.stopPropagation(),t.keyCode){case 32:case 13:this.props.changeQuestionSuggestion(this.props.Index,this.props.Selected),t.preventDefault()}},n}(J.r),rg=e(64876),og=function(t){function n(n){return t.call(this,n)||this}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=this.getContainerClassName();return g.createElement("div",{className:t,key:"formIntelligenceCardContainer",id:"form-intelligence-question-suggestion-card",tabIndex:-1},this.createHeader(),this.yK(),this.createQuestionGroup(),this.createGallery())},n.prototype.getContainerClassName=function(){return"form-intelligence-container office-form-theme-focus-border office-form-theme-border-top"},n.prototype.createHeader=function(){var t=(0,T.pm)().IntelligenceSuggestion_Title,n=g.createElement("div",{className:"form-intelligence-header-count-container"},g.createElement("i",{className:"ms-Icon forms-icon-size16x16 ms-Icon--LightningBolt"}),g.createElement("span",{className:"form-intelligence-ideas-title"},t));return g.createElement("div",{className:"form-intelligence-header-container"},n,g.createElement("div",{className:"form-intelligence-header-button-container"},g.createElement("div",{className:"form-intelligence-header-buttons"},this.createAddButton(),this.createCloseButton())))},n.prototype.createSubHeader=function(){return null},n.prototype.createAddButton=function(){var t={ButtonStyle:1,HTMLAttributes:{className:(0,N.j)("form-intelligence-header-add-button","office-form-theme-interactive-color"),onClick:this.props.onClickAdd},Text:this.getTextForAddButton()};return g.createElement(Fr.A,(0,p.pi)({},t))},n.prototype.createCloseButton=function(){return(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"form-intelligence-header-close-button",onClick:this.props.onClickClose},FluentIcon:"Dismiss",IconClassName:"forms-icon-size14x14"})},n.prototype.createGallery=function(){var t=this;if(this.props.Templates.length<=1)return null;var n=this.props.Templates.map((function(n,e){return g.createElement(rg.Z,{changeGalleryDot:t.props.changeGalleryDot,Index:e,key:e,Selected:e===t.props.TemplateIndex})}));return g.createElement("div",{className:"question-suggestion-card-gallery"},g.createElement("div",{className:"question-suggestion-card-gallery-dots-container"},n))},n.prototype.getTextForAddButton=function(){var t,n=this.wK(),e=this.props.SelectedIndex.reduce((function(t,n){return t.concat(n)})).length;this.props.Templates.length>1&&e>0?t=(0,T.pm)().IntelligenceSuggestion_Add_With_Count.format(e):t=e>0?(0,T.pm)().IntelligenceSuggestion_Add:1===n.length?(0,T.pm)().IntelligenceSuggestion_AddQuestion:(0,T.pm)().IntelligenceSuggestion_AddAll;return t},n.prototype.createQuestionGroup=function(){var t=this,n=this.wK().map((function(n,e){return g.createElement(ig,{changeQuestionSuggestion:t.props.changeQuestionSuggestion,Index:e,IsMobile:t.props.IsMobile,key:e,Question:n,Selected:t.props.SelectedIndex[t.props.TemplateIndex].indexOf(e)>=0})}));return g.createElement("div",{className:"form-intelligence-question-group",key:"formIntelligenceGroup",role:"group"},n)},n.prototype.yK=function(){if(!(0,c.k0)().userInfo.IsMsa)return this.createSubHeader()},n.prototype.wK=function(){return this.SK().filter((function(t){return"Question.MatrixChoice"!==t.Type}))},n.prototype.SK=function(){return this.props.Templates[this.props.TemplateIndex].Questions},n}(J.r),sg="insertCard",ag=function(t){function n(n){var e=t.call(this,n)||this;return e.rF=(0,k.uq)(),e.NK=g.createRef(),e.CK=g.createRef(),e.IK=e.IK.bind(e),e.TK=e.TK.bind(e),e.vf=e.vf.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){(0,kr.mZ)(this.CK.current),this.kK()},n.prototype.componentDidUpdate=function(){this.kK()},n.prototype.render=function(){return g.createElement("div",{className:"mobile-bottom-view"},g.createElement("div",{className:"mobile-frost-gray-backgrond"}),this.xK())},n.prototype.closeBottomView=function(t){this.props.WithAnimation?(this.CK.current.className=(0,N.j)("mobile-design-bottom-view-button-group ".concat(sg),this.props.WithAnimation&&"bottom-move-down"),this.CK.current.addEventListener("animationend",t)):t()},n.prototype.xK=function(){var t=(0,N.j)("mobile-design-bottom-view-button-group ".concat(sg),this.props.WithAnimation&&"bottom-move-up"),n=this.props.HTMLAttributes&&this.props.HTMLAttributes["aria-label"];return g.createElement("div",{"aria-label":n,className:t,onBlur:this.props.CannotBeBlurred?void 0:this.IK,onKeyUp:this.vf,tabIndex:0,ref:this.CK},this.props.ShowCloseButton&&this.hc(),g.createElement("div",{ref:this.NK},this.props.children))},n.prototype.hc=function(){var t=this,n=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"mobile-bottom-view-closeButton",onClick:function(){return t.closeBottomView(t.TK)}},FluentIcon:"Dismiss",IconClassName:"forms-icon-size22x22",Text:(0,T.pm)().Common_Close_Text});return g.createElement("div",{className:"mobile-bottom-view-closed"},n,g.createElement("div",{className:"mobile-bottom-view-closeLine"}))},n.prototype.IK=function(t){t.stopPropagation();var n=(0,Ir.y3)(t);$("div.".concat(sg)).has(n).length>0||n.className.indexOf(sg)>=0||$("div.".concat("people-picker-container")).length>0||this.closeBottomView(this.TK)},n.prototype.TK=function(){this.rF.Model.BottomView="None",this.props.onCloseView&&this.props.onCloseView()},n.prototype.kK=function(){var t=this,n=this.props.WithAnimation&&this.CK&&this.CK.current?370:0;setTimeout((function(){t.NK&&t.NK.current&&((0,kr.Vh)(t.NK.current),"BUTTON"!==document.activeElement.nodeName&&t.NK.current.focus())}),n)},n.prototype.vf=function(t){if(27===t.keyCode)t.preventDefault(),t.stopPropagation(),this.closeBottomView(this.TK)},n}(J.r),ug=function(t){function n(n){var e=t.call(this,n)||this;return e.CK=g.createRef(),e.FK=e.FK.bind(e),e.PK=e.PK.bind(e),e.DK=e.DK.bind(e),e.MK=e.MK.bind(e),e}return(0,p.ZT)(n,t),n.prototype.render=function(){var t=this.getContainerClassName();return g.createElement(ag,{onCloseView:this.DK,ref:this.CK,WithAnimation:!0},g.createElement("div",{className:t,key:"formIntelligenceCardContainer",tabIndex:-1},this.createHeader(),this.createQuestionGroup(),this.createGallery()))},n.prototype.getContainerClassName=function(){return"mobile-intelligence-container"},n.prototype.createAddButton=function(){var t={ButtonStyle:1,HTMLAttributes:{className:"form-intelligence-header-add-button",onClick:this.MK},Text:this.getTextForAddButton()};return g.createElement(Fr.A,(0,p.pi)({},t))},n.prototype.createCloseButton=function(){var t=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"form-intelligence-header-close-button",onClick:this.DK},FluentIcon:"Dismiss",IconClassName:"forms-icon-size18x18"});return g.createElement("div",{className:"mobile-intelligence-template-close-container"},t,g.createElement("div",{className:"form-intelligence-line"}))},n.prototype.createGallery=function(){return null},n.prototype.FK=function(){this.props.onClickAdd(),(0,k.uq)().Model.BottomView="None"},n.prototype.MK=function(){this.CK.current.closeBottomView(this.FK)},n.prototype.PK=function(){this.props.onClickClose(),(0,k.uq)().Model.BottomView="None"},n.prototype.DK=function(){this.CK.current.closeBottomView(this.PK)},n}(og),cg="10";function lg(t){return t&&t.Templates||[]}var fg=function(t){function n(n){var e=t.call(this,n)||this;return e.state={SelectedIndex:[],TemplateIndex:0,Templates:[]},e.closeSuggestionCard=e.closeSuggestionCard.bind(e),e.changeGalleryDot=e.changeGalleryDot.bind(e),e.changeQuestionSuggestion=e.changeQuestionSuggestion.bind(e),e.onClickAddButton=e.onClickAddButton.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentWillUpdate=function(t,n){var e=this.state;!this.props.ShowSuggestionCard&&t.ShowSuggestionCard?(this.LK(e.Templates),this.askSuggestion()):this.props.ShowSuggestionCard&&!y.isEqual(e.Templates,n.Templates)&&this.LK(n.Templates)},n.prototype.render=function(){return this.props.ShowSuggestionCard&&this.state.Templates&&0!==this.state.Templates.length?this.RK():null},n.prototype.createSuggestionCardLayout=function(){return g.createElement(og,(0,p.pi)({},this.props,{changeQuestionSuggestion:this.changeQuestionSuggestion,changeGalleryDot:this.changeGalleryDot,onClickAdd:this.onClickAddButton,onClickClose:this.closeSuggestionCard,SelectedIndex:this.state.SelectedIndex,TemplateIndex:this.state.TemplateIndex,Templates:this.state.Templates}))},n.prototype.updateSuggestion=function(t){y.isEqual(this.state.Templates,t)||this.setState({SelectedIndex:t.map((function(t){return[]})),TemplateIndex:0,Templates:t})},n.prototype.onClickAddButton=function(){this.state.SelectedIndex.forEach((function(t){return t.sort()}));var t=this.state.Templates||[],n=t[this.state.TemplateIndex],e=n.TemplateId,i=t.map((function(t){return t.Questions})).reduce((function(t,n){return t.concat(n)})),r=!1,o=!1,s=this.state.SelectedIndex.map((function(n,e){var i=t[e],s=i.Questions.filter((function(t){return"Question.MatrixChoice"!==t.Type}));return n&&n.length&&(dg(i)?r=!0:o=!0),n.map((function(t){return s[t]}))})).reduce((function(t,n){return t.concat(n)})),a=0===s.length;a&&(s=this.wK(),dg(n)?r=!0:o=!0);var u=hg(t),c=this.props.Form.Model.Settings.IsQuizMode,l=i.some((function(t){return t.IsMathQuiz})),f=l?y.map(i,(function(t){return t.MathTemplateID})):void 0;(0,q.$U)(a?"Intelligence.QuestionSuggestion.AddAll":"Intelligence.QuestionSuggestion.Add",{HasHistoryQuestion:r,HasTemplateQuestion:o,IsMathSuggestion:l,IsMobile:this.props.IsMobile,IsNPSSuggestion:e===cg,IsQuiz:c,MathTemplateIDs:f,ModelType:n.AlgorithmType,SuggestTemplate:1===this.getSuggestionType(),Type:u}),this.setState({SelectedIndex:[],Templates:[]}),e=e||"",this.AK(i,s),this.props.collapseInsertPane()},n.prototype.changeQuestionSuggestion=function(t,n){var e=this.state.SelectedIndex,i=e[this.state.TemplateIndex].indexOf(t);i>=0&&n?e[this.state.TemplateIndex].splice(i,1):e[this.state.TemplateIndex].push(t),this.setState({SelectedIndex:e})},n.prototype.closeSuggestionCard=function(){var t=this.wK(),n=this.state.Templates[this.state.TemplateIndex],e=n.TemplateId,i=n.AlgorithmType||-1;(0,q.$U)("Intelligence.QuestionSuggestion.Dismiss",{IsMathSuggestion:t.some((function(t){return t.IsMathQuiz})),IsMobile:this.props.IsMobile,IsNPSSuggestion:e===cg,ModelType:n.AlgorithmType,SuggestTemplate:1===this.getSuggestionType(),Type:i}),this.setState({SelectedIndex:[],TemplateIndex:0,Templates:[]})},n.prototype.changeGalleryDot=function(t){this.setState({TemplateIndex:t})},n.prototype.AK=function(t,n){var e,i=this.props.Form.FormElementManager,r=this.props.InsertAfter;if(r||"Title"===r){n.reverse();var o="Title"===r?null:r;e=function(t,n){return i.insertElementAfter(t,o,n)}}else e=function(t,n){return i.appendElement(t,n)};n.forEach((function(n){var i;"Question.MatrixChoiceGroup"===(n=y.clone(n)).Type&&(i=t.filter((function(t){return t.GroupId===n.Id})).map((function(t){var n=y.clone(t);return delete n.Id,n}))),delete n.Id,e(n,i)})),this.props.designElement&&this.props.designElement(null)},n.prototype.RK=function(){return this.props.IsMobile?this.EK():this.createSuggestionCardLayout()},n.prototype.EK=function(){return g.createElement("div",{className:"mobile-template-suggestion-container"},g.createElement(ug,(0,p.pi)({},this.props,{changeQuestionSuggestion:this.changeQuestionSuggestion,changeGalleryDot:this.changeGalleryDot,onClickAdd:this.onClickAddButton,onClickClose:this.closeSuggestionCard,SelectedIndex:this.state.SelectedIndex,TemplateIndex:this.state.TemplateIndex,Templates:this.state.Templates})))},n.prototype.wK=function(){return this.SK().filter((function(t){return"Question.MatrixChoice"!==t.Type}))},n.prototype.SK=function(){return this.state.Templates[this.state.TemplateIndex].Questions},n.prototype.LK=function(t){if(0!==t.length){var n=this.props.Form,e=hg(t),i=n.Model.Settings.IsQuizMode,r=t[this.state.TemplateIndex]?y.filter(t[this.state.TemplateIndex].Questions,(function(t){return t.IsMathQuiz})):[];(0,q.$U)("Intelligence.QuestionSuggestion.Show",{IsMathSuggestion:r.length>0,IsMobile:this.props.IsMobile,IsNPSSuggestion:t.some((function(t){return t.TemplateId===cg})),IsQuiz:i,MathTemplateIDs:y.map(r,(function(t){return t.MathTemplateID})),ModelTypes:t.map((function(t){return t.AlgorithmType})),SuggestionTemplate:1===this.getSuggestionType(),Type:e})}},n}(J.r);function hg(t){return y.first(t.map((function(t){return t.AlgorithmType})).filter((function(t){return t>0})))||-1}function dg(t){return t.TemplateId===Uo.HISTORYTEMPLATEID}var mg=function(t){function n(n){var e=t.call(this,n)||this;e._K=500,e.BK=e.BK.bind(e),e.askSuggestion=e.askSuggestion.bind(e),e.DW=e.DW.bind(e);var i=e.props.Question;return i.observe(e.BK,[i.Schema.Title]),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.props.Question.unobserve(this.BK)},n.prototype.askSuggestion=function(){var t=this.props.Form,n=this.props.Question;t.SettingMaster.Model.IsQuizMode&&n&&n.Model.IsMathQuiz?this.HK():!t.SettingMaster.Model.IsQuizMode&&n.Model.Title&&this.GK()},n.prototype.getSuggestionType=function(){return 0},n.prototype.GK=function(){var t=this,n=this.props.Question,e={ExistingQuestions:y.map(n.Form.Model.Questions,(function(t){return t.Title})),Locale:(0,c.k0)().cultureInfo.Name,QuestionType:n.Model.Type,TargetQuestion:n.Model.Title};Uo.getQuestionsIntelligenceResult(e).then((function(n){if(n&&n.MatchQuery){var e=lg(n);t.updateSuggestion(e)}})).catch((function(n){t.setState({SelectedIndex:[],TemplateIndex:0,Templates:[]})}))},n.prototype.HK=function(){var t=this,n=this.props.Form,e=this.props.Question,i=e.Model.Title,r=e.Model.LastMathMLFormula,o=y.filter(n.Model.Questions,(function(t){return t.IsMathQuiz}));r&&eg.getMathQuestionsSuggestion({ExistingMathQuestions:y.map(o,(function(t){return t.Subtitle})),ExistingMathQuestionTitles:y.map(o,(function(t){return t.Title})),FormId:n.Model.Id,Formula:r,Origin:"AddQuestion",QuestionId:e.Model.Id,QuestionPoints:e.Model.Point,QuestionRequired:e.Model.Required,Title:i}).then((function(n){if(n&&n.MatchQuery){var e=lg(n);t.updateSuggestion(e)}})).catch((function(n){t.setState({SelectedIndex:[],TemplateIndex:0,Templates:[]})}))},n.prototype.BK=function(){this.setState({SelectedIndex:[],TemplateIndex:0,Templates:[]},this.DW)},n.prototype.DW=function(){this.qK&&window.clearTimeout(this.qK),this.qK=window.setTimeout(this.askSuggestion,this._K)},n}(fg),vg=e(70578);var gg=0;function pg(t){return br().then((function(n){var e=n[t.TemplateId];return e&&function(t,n){var e=(r=t,new((0,k.Ed)())(eu.y.LocalForm,{InitialData:r},!1)),i={Questions:[]};var r;return i.TemplateId=n.TemplateId,i.AlgorithmType=n.ModelType,i.Questions=e.FormElementManager.QuestionMasters.map((function(t){var n=y.clone(t.getSnapshot());return delete n.Order,n})),i}(e,t)})).catch((function(){return null}))}var bg={getFormTemplateSuggestion:function(t){var n=++gg;return Uo.isDefaultTitle(t)?Promise.resolve({MatchQuery:!0,Templates:[]}):function(t,n,e){var i={MatchQuery:!0,Templates:[]};return Uo.textAnalyzeWithFeatures(e,t).then((function(t){if(t&&t.Results&&t.Results.length&&t.Results[0].Result){var e=t.Results[0].Result;y.isArray(e)||(e=[e]);var r=y.map(e,pg);return Promise.all(r).then((function(t){return t=y.filter(t,(function(t){return!!t})),i.Templates=Uo.getFilteredTemplates(t),i.MatchQuery=n===gg,i}))}return i.MatchQuery=n===gg,i}))}(t,n,131072)}},yg=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,p.ZT)(n,t),n.prototype.createHeader=function(){var t=this.props.Templates||[],n=this.props.TemplateIndex,e=(0,T.pm)().IntelligenceSuggestion_Title;if(n<t.length){var i=t[n].AlgorithmType||-1,r=t[n].FormTitle;switch(i){case 3:e=(0,T.pm)().Designer_Intelligence_History_Suggest_Frequently;break;case 2:case 1:e=(0,T.pm)().Designer_Intelligence_History_Suggest_Relevant.format(r);break;default:e=(0,T.pm)().Designer_Intelligence_Template_Suggest_Popular}}var o=g.createElement("div",{className:"form-intelligence-header-count-template-container"},g.createElement("span",{className:"form-intelligence-ideas-template-title"},e));return g.createElement("div",{className:"form-intelligence-header-template-container"},g.createElement("i",{className:"ms-Icon forms-icon-size16x16 ms-Icon--LightningBolt"}),o,g.createElement("div",{className:"form-intelligence-header-template-button-container"},g.createElement("div",{className:"form-intelligence-header-buttons"},this.createAddButton(),this.createCloseButton())))},n}(og),wg=function(t){function n(n){var e=t.call(this,n)||this;e.TW=500,e.Gu=(0,k.uq)().Model,e.zK=e.zK.bind(e),e.askSuggestion=e.askSuggestion.bind(e),e.DW=e.DW.bind(e);var i=e.props.Form;return i.observe(e.zK,[i.Schema.Title]),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.props.Form.unobserve(this.zK)},n.prototype.createSuggestionCardLayout=function(){return g.createElement(yg,(0,p.pi)({},this.props,{changeQuestionSuggestion:this.changeQuestionSuggestion,changeGalleryDot:this.changeGalleryDot,onClickAdd:this.onClickAddButton,onClickClose:this.closeSuggestionCard,SelectedIndex:this.state.SelectedIndex,TemplateIndex:this.state.TemplateIndex,Templates:this.state.Templates}))},n.prototype.askSuggestion=function(){var t,n=this,e=this.props.Form,i=e.Model.Title,r=e.Model.Settings.IsQuizMode;if((0,c.k0)().userInfo.IsMsa||this.props.IsMobile)t=Uo.getDefaultQuestionResult();else{var o="";e.isFieldReady(e.Schema.Id)&&(o=e.Model.Id),t=Uo.getHistoryFormSuggestion(i,o,r)}var s=r?Uo.getDefaultQuestionResult():bg.getFormTemplateSuggestion(i);Promise.all([s,t]).then((function(t){var e=t[0],i=t[1];if(e&&e.MatchQuery&&i&&i.MatchQuery){var r=lg(e),o=lg(i).concat(r);n.props.IsMobile&&(o.forEach((function(t){t.Questions=t.Questions.filter(vg.D8)})),o=o.filter((function(t){return t.Questions.length>0}))),o.length?n.updateSuggestion(o):(n.Gu.BottomView="None",n.forceUpdate())}})).catch((function(){n.setState({SelectedIndex:[],TemplateIndex:0,Templates:[]})}))},n.prototype.getSuggestionType=function(){return 1},n.prototype.zK=function(){this.setState({SelectedIndex:[],TemplateIndex:0,Templates:[]},this.DW)},n.prototype.DW=function(){this.QK&&window.clearTimeout(this.QK),this.QK=window.setTimeout(this.askSuggestion,this.TW)},n}(fg),Sg=kg((function(t,n,e,i){return!(0,Wa.N4)()||t.Form.SettingMaster.Model.IsQuizMode||(0,vt.tq)()?xg(t,n,"Title",e):Pg(t,e,i,"Title",n)}),(function(t,n,e){var i=Tg(t.Form,!0,n.Type),r=t.Form.FormElementManager.insertElementAfter(n,i,e);t.designElement(r)})),Ng=kg((function(t,n,e){return t.Section,null}),(function(t,n,e){var i=t.Section,r=i.Form.FormElementManager.insertElementAfter(n,i,e);t.designElement(r)})),Cg=kg((function(t,n,e,i){if(!(0,Wa.N4)()||t.Form.SettingMaster.Model.IsQuizMode||(0,vt.tq)())return Fg(t,t.Question,n,e);var r=(0,G.z)(t.Form);return(null==r?void 0:r.ShouldExpandQuestionSuggestionCard)&&!n&&(r.AddCurrentSuggestion("TitleSuggestsQuestion"),i()),Pg(t,e,i,t.Question,n)}),(function(t,n,e){var i=t.Question;!Ve.H.isDescriptiveElement(n.Type)&&Dg(i.Model,n,e),Tg(t.Form,!1,n.Type);var r=i.Form.FormElementManager.insertElementAfter(n,i,e);t.designElement(r)})),Ig=kg((function(t,n,e,i){if(!(0,Wa.N4)()||t.Form.SettingMaster.Model.IsQuizMode||(0,vt.tq)()){var r=t.Form.FormElementManager.TopElementMasters;if(!r.length)return xg(t,n,null,e);var o=r[r.length-1];return Ve.H.isDescriptiveElement(o.Model.Type)?null:Fg(t,o,n,e)}return Pg(t,e,i,null,n)}),(function(t,n,e){var i=t.Form.FormElementManager,r=i.TopElementMasters;if(!Ve.H.isDescriptiveElement(n.Type)){var o=r[r.length-1];o&&!Ve.H.isDescriptiveElement(o.Model.Type)&&Dg(o.Model,n,e)}Tg(t.Form,0===r.length,n.Type);var s=i.appendElement(n,e);t.designElement(s)}));function Tg(t,n,e){if(!(n?t.hasSection()&&!Ve.H.isSection(e):!t.hasSection()&&Ve.H.isSection(e)))return null;var i=t.FormElementManager.insertElementAfter({Title:"",Type:"Question.ColumnGroup"},null);return(0,q.$U)("DesignPage.Section.Create",{elementType:"section",isDefault:"true"}),i}function kg(t,n){return function(e){function i(t){var n=e.call(this,t)||this;return n.UK=g.createRef(),n.jK=n.jK.bind(n),n.WK=n.WK.bind(n),n}return(0,p.ZT)(i,e),i.prototype.render=function(){return tg().createInsertCardPane({createSuggestionCard:this.jK,Form:this.props.Form,insertCallback:this.WK},this.UK)},i.prototype.setFocusOnAddButton=function(){this.UK.current&&this.UK.current.setFocusOnAddButton()},i.prototype.jK=function(n,e,i){return t(this.props,n,e,i)},i.prototype.WK=function(t,e){!Ve.H.isDescriptiveElement(t.Type)&&(t.IsQuiz=this.props.Form.SettingMaster.Model.IsQuizMode),n(this.props,t,e)},i}(g.Component)}function xg(t,n,e,i){return 0!==t.Form.FormElementManager.TopQuestionMasters.length?null:g.createElement(wg,{collapseInsertPane:i,designElement:t.designElement,Form:t.Form,InsertAfter:e,ShowSuggestionCard:n})}function Fg(t,n,e,i){return g.createElement(mg,{collapseInsertPane:i,designElement:t.designElement,Form:t.Form,InsertAfter:n,Question:n,ShowSuggestionCard:e})}function Pg(t,n,e,i,r){if((0,Wa.N4)()&&!(0,tr.Oy)())return(0,wo.hC)({collapseInsertPane:n,designElement:t.designElement,expandInsertPane:e,Form:t.Form,InsertAfter:i,InsertPaneExpanded:r})}function Dg(t,n,e){n.Required=t.Required,n.ShowSubtitle=t.ShowSubtitle,e&&e.forEach((function(n){n.Required=t.Required})),n.Type===Y.L.getElementTypeName()?n.ShuffleOptions=t.ShuffleOptions:n.Type===H.getElementTypeName()&&(n.ShowRatingLabel=t.ShowRatingLabel),n.IsQuiz&&t.IsQuiz&&(n.Point=t.Point,function(t,n){!t.IsMathQuiz||n.Type!==Y.L.getElementTypeName()&&n.Type!==st.getElementTypeName()||(n.IsMathQuiz=t.IsMathQuiz,n.IsAnswerPlainText=t.IsAnswerPlainText,n.ShowSubtitle=t.ShowSubtitle,n.Choices&&y.forEach(n.Choices,(function(t){t.IsGenerated&&!t.IsMathOption&&(t.Description=""),t.IsMathOption=!0})))}(t,n))}var Mg=function(t){function n(n){var e=t.call(this,n)||this;return e.KK=g.createRef(),e.Bo=g.createRef(),e.hG=e.hG.bind(e),e.qG=e.qG.bind(e),e.qT=e.qT.bind(e),e.Do=e.Do.bind(e),e.JK=e.JK.bind(e),e}return(0,p.ZT)(n,t),n.prototype.componentDidMount=function(){var t=this.props.Form,n=F.x.Schema;t.observe(this.qT,[n.Title,n.Description]);var e=t.getImageMaster(F.x.Schema.Logo),i=t.getImageSettingsMaster(F.x.Schema.LogoInfo),r=(0,k.BF)();i.observe(this.qT,[r.Schema.NaturalWidth,r.Schema.NaturalHeight,r.Schema.Size]);var o=(0,k.Cu)().Schema;e.observe(this.JK,[o.ImageProcessingStatus,o.ErrorType,o.UploadParameters])},n.prototype.componentDidUpdate=function(){},n.prototype.componentWillUnmount=function(){var t=this.props.Form;t.unobserve(this.qT);var n=t.getImageMaster(F.x.Schema.Logo),e=t.getImageSettingsMaster(F.x.Schema.LogoInfo);n.unobserve(this.JK),e.unobserve(this.qT),""===t.Model.Title&&this.hG((0,T.pm)().Designer_DefaultFormTitle)},n.prototype.render=function(){var t,e,i=this.props.Form,r=i.getImageMaster(F.x.Schema.Logo),o=i.getImageSettingsMaster(F.x.Schema.LogoInfo),s=(0,Tr.p2)(this.props.HTMLAttributes,{className:"__title-designer__ form-designer-form-title office-form-theme-focus-border"}),a="Right",u=r.Model;if(u.ImageProcessingStatus!==ze.nv.Idle||u.ErrorType||(0,ze.UO)(u)){var c=n.calcImageInfo(o);a=c.ImageLayout,t=c.Height,e=g.createElement(Va,{addImage:this.Do,ImageHeight:t,ImageInfoMaster:r,ImageSettingMaster:o,ImageWidth:c.Width,key:"imageDesigner"})}else e=(0,z.F)({ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"form-designer-title-editor-image-picker office-form-theme-button",onClick:this.Do},FluentIcon:"Image",IconClassName:"forms-icon-size20x20",key:"imagePicker",ref:this.Bo,Text:(0,T.pm)().ImagePicker_Insert_Image_button});return g.createElement(za,{Form:this.props.Form,HTMLAttributes:s,MediaLayout:a,onHeightChange:this.props.onHeightChange,onSubTitleChange:this.qG,onValueChange:this.hG,ref:this.KK,SubTitle:(0,ir.wg)(i.Model.Description,i.Model.FormsProRTDescription),TitleContainerType:"Form",TitleHeight:t,Value:(0,ir.wg)(i.Model.Title,i.Model.FormsProRTTitle)},e)},n.calcImageInfo=function(t){if(t.Model.NaturalWidth){var n=t.calcLogoLayout(),e=n.Layout===Qe.RZ.Vertical?"Top":"Left";return{Height:n.ActualHeight,ImageLayout:e,Width:n.ActualWidth}}return{Height:(0,X.w_)(),ImageLayout:"Left",Width:(0,X.Rr)()}},n.prototype.hG=function(t){this.props.Form.bulkEdit((function(n){(0,ir.v1)(n,t,"Title","FormsProRTTitle"),document.title="".concat(n.Title," (").concat((0,T.pm)().Common_Edit_Text,") ").concat((0,T.pm)().Page_Title)}))},n.prototype.qG=function(t){this.props.Form.bulkEdit((function(n){(0,ir.v1)(n,t,"Description","FormsProRTDescription")}))},n.prototype.Do=function(){var t=this.props.Form,n=t.getImageMaster(F.x.Schema.Logo);(0,q.$U)("DesignPage.Form.Logo.AddImage",{FormId:t.isFieldReady(F.x.Schema.Id)?t.Model.Id:""}),(0,gf.L)().then((function(t){return n.addImage(t)}))},n.prototype.qT=function(){var t=this;this.forceUpdate((function(){var n=t.props.onHeightChange;n&&n()}))},n.prototype.JK=function(t){var n=t.OldValues,e=t.NewValues;if(n.ImageProcessingStatus===ze.nv.Deleting&&e.ImageProcessingStatus===ze.nv.Idle&&e.ErrorType!==ze.dL.DeleteFailError){var i=this.KK.current;i&&i.focus()}this.qT()},n}(J.r);function Lg(t){return(0,c.k0)().userInfo.IsMsa?g.createElement(Rg,t):function(t){return g.createElement(Aa,{DesignFocus:t.DesignFocus,Name:"__title",Label:t.Form.Model.Title,Title:(0,T.pm)().Designer_FormTitle_Label,scrollToDesigner:t.scrollToDesigner,IsDesignModeDisabled:(0,et.pd)((function(){return!1}),et.t1)},g.createElement(Aa.Designer,null,g.createElement(Mg,{Form:t.Form,onHeightChange:t.onHeightChange}),g.createElement(Sg,{Form:t.Form,designElement:t.designElement})),g.createElement(Aa.Renderer,null,g.createElement(ld,{Form:t.Form,onHeightChange:t.onHeightChange})))}({Form:t.Form,designElement:t.designElement,DesignFocus:t.DesignFocus,onHeightChange:t.onHeightChange,scrollToDesigner:t.scrollToDesigner})}var Rg=function(t){function n(n){var e=t.call(this,n)||this;e.gP=y.uniqueId("td"),e.ZK=e.gP+"-subtitle",e.As=function(){return e.forceUpdate((function(){e.props.onHeightChange()}))};var i=F.x.Schema;return e.props.Form.observe(e.As,[i.Title,i.Description,i.FormsProRTTitle,i.FormsProRTDescription,i.Logo,i.LogoInfo,i.HasValidBranching]),e}return(0,p.ZT)(n,t),n.prototype.componentWillUnmount=function(){this.props.Form.unobserve(this.As)},n.prototype.componentDidMount=function(){(0,vo.z)($(".form-designer-subtitle-editor textarea")),window.setTimeout(this.As,0)},n.prototype.render=function(){var t=Aa,n=this.props.Form.Model;return g.createElement(t,{DesignFocus:this.props.DesignFocus,HTMLAttributes:{"aria-describedby":this.ZK},Label:n.Title,Name:"__title",Title:(0,T.pm)().Designer_FormTitle_Label,scrollToDesigner:this.props.scrollToDesigner},g.createElement(t.Designer,null,this.XK(),this.YK()),g.createElement(t.Renderer,null,this.tJ()))},n.prototype.XK=function(){var t=this.props.Form,n=t.getImageMaster(F.x.Schema.Logo),e=n.Model,i=t.getImageSettingsMaster(F.x.Schema.LogoInfo),r=i.Model;r.Layout=i.calcLogoLayout().Layout;var o,s,a,u,c=e.ImageProcessingStatus===ze.nv.Picking,l=(0,ze.UO)(e),f=e.ErrorType!==ze.dL.NoError;c||f||l?(o=(0,yo.P)({HTMLAttributes:{className:"horizontal"},ImageMaster:n,ImageSettingsMaster:i,IsFormLogo:!0}),a=r.ContainerHeight,u=r.ContainerWidth):s=(0,z.F)({HTMLAttributes:{className:"form-designer-title-editor-image-picker office-form-theme-button",onClick:function(){(0,q.$U)("DesignPage.Form.Logo.AddImage",{FormId:t.isFieldReady(F.x.Schema.Id)?t.Model.Id:""}),(0,gf.L)().then((function(t){return n.addImage(t)}))}},Icon:"Photo2",IconClassName:"forms-icon-size20x20",ButtonStyle:1,GlyphButtonStyle:"GlyphOnly",Text:(0,T.pm)().ImagePicker_Insert_Image_button,ref:"imagePicker"});var h="form-designer-title-editor";s&&(h=(0,N.j)(h,"image"));var d=(0,ur.ZN)({AllowRichText:!0,AutoFocus:!0,Placeholder:(0,T.pm)().Designer_PlaceholderForFormTitle,Options:{HTMLPropsForInnerElement:{className:"mixer-focus-target"}},Value:(0,ir.wg)(t.Model.Title,t.Model.FormsProRTTitle),TextFieldType:o?1:2,TextFieldLocation:{Location:1,Suffix:1},MinimalHeight:o?a:40,AutoSelection:!0,HTMLAttributes:{className:h,style:o?{width:"calc(100% - {0}px)".format(u+10)}:void 0},MaxLength:ki(),onValueChange:function(n){t.bulkEdit((function(t){return(0,ir.v1)(t,n,"Title","FormsProRTTitle")}))}},this.props.Form,!1),m=(0,ur.ZN)({AllowRichText:!0,Placeholder:(0,T.pm)().Designer_PlaceholderForFormSubtitle,Options:{HTMLPropsForInnerElement:{className:"mixer-focus-target"}},Value:(0,ir.wg)(t.Model.Description,t.Model.FormsProRTDescription),TextFieldType:2,TextFieldLocation:{Location:1,Suffix:2},MinimalHeight:40,HTMLAttributes:{className:"form-designer-subtitle-editor"},MaxLength:(0,X.hT)(),onValueChange:function(n){t.bulkEdit((function(t){(0,ir.v1)(t,n,"Description","FormsProRTDescription")}))}},this.props.Form,!0),v=(0,Tr.p2)(this.props.HTMLAttributes,{className:"__title-designer__ form-designer-form-title office-form-theme-focus-border"});return g.createElement("div",v,o,d,s,m)},n.prototype.YK=function(){return g.createElement(Sg,{designElement:this.props.designElement,Form:this.props.Form})},n.prototype.tJ=function(){var t,n=this.props.Form,e=n.Model,i=n.getImageSettingsMaster(F.x.Schema.LogoInfo),r=(0,Tr.p2)(this.props.HTMLAttributes,{className:"__title-designer__ form-designer-title-view"}),o=i.calcLogoLayout().Layout===Qe.RZ.Horizontal?"left":"top",s="logo-image-container old ".concat(o);return e.Logo&&e.Logo.ResourceUrl?t=g.createElement("div",{className:s},(0,go.Yi)({Image:n.getImageMaster(F.x.Schema.Logo),ImageSettings:i,ImageType:"Logo"}),(0,go.B2)(n.getImageMaster(F.x.Schema.Logo).Model)):e.Logo.ImageProcessingStatus!==ze.nv.Uploading&&e.Logo.ImageProcessingStatus!==ze.nv.Picking&&e.Logo.ErrorType===ze.dL.NoError||(t=g.createElement("div",{className:s,style:{height:(0,X.SL)()+"px",width:(0,X.SL)()+"px"}},(0,go.B2)())),g.createElement("div",r,t,g.createElement("div",{className:"office-form-title heading-1"},g.createElement("div",null,(0,cr.q)({Text:(0,ir.wg)(e.Title,e.FormsProRTTitle,!0),RenderMode:"RichText",ContainsHtml:!0}),bo(this.props.Form.Model),this.BG())),g.createElement("div",{className:"office-form-subtitle heading-1",id:this.ZK},(0,cr.q)({Text:(0,ir.wg)(e.Description,e.FormsProRTDescription,!0),RenderMode:"RichText",ContainsHtml:!0})))},n.prototype.BG=function(){if(this.props.Form.Model.HasValidBranching)return g.createElement("div",{className:"office-form-branching-icon office-form-theme-primary-foreground"},(0,V.M)({FluentIcon:"Branch",HTMLAttributes:{className:"forms-icon-size24x24"},key:"branch-icon"}))},n}(J.r),Ag=function(){function t(){}return t.prototype.designerTitleCreate=function(t){return Lg(t)},t}();var Eg=e(60299),Og=e(932),_g=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.fg=g.createRef(),n.Uv=400,n.jv=function(){var t={chunks:n.getFormattedDataForImmersiveReader(),title:""},e={uiLang:(0,ca.Kc)()||navigator.language};(0,oi.d8)().getImmersiveReaderToken().then((function(n){n&&ImmersiveReader&&ImmersiveReader.launchAsync(n,null,t,e)}))},n}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this;this.As=function(){return t.forceUpdate()};var n=F.x.Schema;this.props.Form.observe(this.As,[n.Title,n.Description,n.LogoInfo])},n.prototype.componentDidMount=function(){(0,vo.z)($(this.fg.current))},n.prototype.componentWillUnmount=function(){this.props.Form.unobserve(this.As)},n.prototype.render=function(){var t,n,e=this.props.Form,i=e.Model;if(i.Logo&&i.Logo.ResourceUrl){var r=e.getImageMaster(F.x.Schema.Logo),o=e.getImageSettingsMaster(F.x.Schema.LogoInfo),s=o.calcLogoLayout().Layout===Qe.RZ.Horizontal?"left":"top",a="logo-image-container old ".concat(s);t=g.createElement("div",{className:a},g.createElement(go.zg,{Image:r,ImageSettings:o,ImageType:"Logo"}),(0,go.B2)(r.Model))}i.Description&&!this.props.IsSmallSize&&(n=g.createElement("div",{className:"office-form-subtitle heading-1",ref:this.fg},g.createElement(cr.D,{Text:(0,ir.wg)(i.Description,i.FormsProRTDescription),RenderMode:"RichText",ContainsHtml:!0})));var u=(0,N.j)("__title__ office-form-title-container office-form-form-title",!this.props.IsReadOnlyOnMobile&&"office-form-theme-primary-background",this.props.IsSmallSize&&"small-size"),c={ImmersiveReaderToggleProps:this.props.ImmersiveReaderToggleProps};return g.createElement("div",{className:"office-form-title-content"},g.createElement("div",{className:u},g.createElement("div",{className:"office-form-logo-title"},t,g.createElement("div",{className:"office-form-title heading-1"},g.createElement("span",{role:"heading","aria-level":1},g.createElement(cr.D,{Text:(0,ir.wg)(i.Title,i.FormsProRTTitle,!0),RenderMode:"RichText",ContainsHtml:!0})))),n),g.createElement("div",{className:"office-form-title-ir-container"},this.gg(),(0,Eg.V)(c)))},n.prototype.gg=function(){var t;return!(0,vt.w1)()&&(null===(t=this.props.ImmersiveReaderToggleProps)||void 0===t?void 0:t.ShouldShowImmersiveReaderButtons)?g.createElement(Og.$,{onClick:y.debounce(this.jv,this.Uv,!0),whiteIcon:!0,className:"office-form-theme-button"}):null},n.prototype.getFormattedDataForImmersiveReader=function(){var t=this.props.Form.Model,n=[];return n.push({content:t.Title}),n.push({content:"\n"}),n.push({content:t.Description}),n},n}(J.r),Bg=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.nJ=y.uniqueId("titleId_"),n}return(0,p.ZT)(n,t),n.prototype.componentWillMount=function(){var t=this;this.As=function(){return t.forceUpdate()};var n=F.x.Schema;this.props.Form.observe(this.As,[n.Title,n.Description]);var e=this.props.Form.getImageSettingsMaster(F.x.Schema.LogoInfo),i=(0,k.BF)().Schema;e.observe(this.As,[i.NaturalWidth,i.NaturalHeight]);var r=this.props.Form.getImageMaster(F.x.Schema.Logo),o=(0,k.Cu)().Schema;r.observe(this.As,[o.ImageProcessingStatus,o.UploadParameters])},n.prototype.componentWillUnmount=function(){this.props.Form.unobserve(this.As),this.props.Form.getImageSettingsMaster(F.x.Schema.LogoInfo).unobserve(this.As),this.props.Form.getImageMaster(F.x.Schema.Logo).unobserve(this.As)},n.prototype.render=function(){var t,n=this.props.Form,e={className:(0,N.j)("__title__ office-form-form-title",!this.props.IsReadOnlyOnMobile&&"office-form-theme-primary-background",this.props.IsSmallSize&&"small-size",this.props.IsSlimTitle&&"slim-size"),id:this.nJ},i="Left",r=n.getImageMaster(F.x.Schema.Logo),o=n.getImageSettingsMaster(F.x.Schema.LogoInfo),s=r.Model;if(!s.ErrorType&&(s.ImageProcessingStatus!==ze.nv.Idle||(0,ze.UO)(s))){var a=this.rg(o);i=a.ImageLayout,t=g.createElement(ud.z,{ImageWidth:a.Width,ImageHeight:a.Height,ImageInfoMaster:r,ImageSettingMaster:o,ImageType:"Logo"})}return g.createElement(cd.F,(0,p.pi)({HTMLAttributes:e,HTMLPropsForInnerElement:{"aria-level":1,role:"heading"},MediaLayout:i,ImmersiveReaderToggleProps:(0,p.pi)({},this.props.ImmersiveReaderToggleProps),IsMobile:this.props.IsMobile,TitleId:this.nJ},this.eJ()),t)},n.prototype.eJ=function(){var t,n,e,i,r=this,o=this.props.Form.Model,s=this.props.LocaleId,a=s?zh.k.getFormResourceMaster(s,this.props.Form):void 0;t=(null==a?void 0:a.Model.title)||o.Title,e=(null==a?void 0:a.Model.subtitle)||o.Description,n=(0,ir.gA)((null==a?void 0:a.Model.formsprortlocaletitle)||o.FormsProRTTitle),i=(0,ir.gA)((null==a?void 0:a.Model.formsprortlocalesubtitle)||o.FormsProRTDescription),(0,et.hl)((function(){(r.props.IsSlimTitle||r.props.IsSmallSize)&&(e=i="")}));var u=o.Title,c=(0,T.pm)().Common_Preview_Text,l=(0,T.pm)().Page_Title;return document.title=this.props.ProgressBarDesc?"".concat(u," (").concat(this.props.ProgressBarDesc,") (").concat(c,") ").concat(l):"".concat(u," (").concat(c,") ").concat(l),{Title:(0,nr.getIoCModifiedTextField)(t,!0),SubTitle:(0,nr.getIoCModifiedTextField)(e,!0),RichTitle:(0,nr.getIoCModifiedTextField)(n,!0),RichSubtitle:(0,nr.getIoCModifiedTextField)(i,!0)}},n.prototype.rg=function(t){if(t.Model.NaturalWidth){var n=t.calcLogoLayout({isMobile:this.props.IsMobile,isSlimSize:this.props.IsSlimTitle,isSmallSize:this.props.IsSmallSize});return{Height:n.ActualHeight,ImageLayout:n.Layout===Qe.RZ.Vertical?"Top":"Left",Width:n.ActualWidth}}return{Height:(0,X.Rr)(),ImageLayout:"Left",Width:(0,X.w_)()}},n}(J.r);var Hg=function(){function t(){}return t.prototype.titleContainerCreate=function(t){return function(t){return(0,c.k0)().userInfo.IsMsa?g.createElement(_g,(0,p.pi)({},t)):g.createElement(Bg,(0,p.pi)({},t))}(t)},t}();var Gg=e(53907),qg=e(18693);var Vg=e(2775);var zg=e(12484),Qg=e(60504),Ug=e(45862),$g=(0,bt.Rm)((function(){var t=[window.location.origin.toLowerCase()];return(0,c.k0)().isCdnEnabled&&t.push((0,_t.Lp)((0,pr._k)())),t}));function jg(t){if(!t)return!1;var n=$g(),e=t?t.toLowerCase():"";for(var i in n)if(-1!==e.indexOf(i))return!1;return!0}var Wg=e(86415),Kg=["__gCrWeb"];function Jg(t){t.existingOnServerSide().catch((function(t){return np().CriticalError=t}));var n=t.Synchronizer;n.observe((function(e){y.contains(e.FieldSchemas,n.Schema.UpdateError)&&Yg(t.Deleted?"DeleteForm":"SaveForm",n.Model.UpdateError,t.getInstanceId())}),[n.Schema.UpdateError]),t.fieldsReady([F.x.Schema.Questions]).then((function(){t.FormElementManager.AllElementMasters.forEach(Zg),_.d.getCollectionMasterFromModel(t.Model.Questions).observe((function(t){t.AddedModels.map(D.vV).forEach(Zg)}))})),t.fieldsReady([F.x.Schema.DescriptiveElements]).then((function(){t.FormElementManager.DescriptiveElementMasters.forEach(Zg),_.d.getCollectionMasterFromModel(t.Model.DescriptiveElements).observe((function(t){t.AddedModels.map(x.PQ).forEach(Zg)}))}))}function Zg(t){var n=t,e=n.Synchronizer;e.observe((function(){n.Deleted||(Yg("CreateQuestion",e.Model.CreationError,n.getInstanceId()),n.observe((function(){n.Deleted&&Yg("CreateQuestion",null,n.getInstanceId())})))}),[e.Schema.CreationError]),e.observe((function(t){y.contains(t.FieldSchemas,e.Schema.UpdateError)&&Yg(n.Deleted?"DeleteQuestion":"SaveQuestion",e.Model.UpdateError,n.getInstanceId())}),[e.Schema.UpdateError])}var Xg=[];function Yg(t,n,e){n?((0,Zs.bh)(t,n,e),Xg.forEach((function(i){i(t,n,e)}))):(0,Zs.qU)(t,e)}var tp=window.onerror;function np(){return(0,Na.a)().Model}window.onerror=function(t,n,e,i,r){try{(function(t,n,e){"string"!=typeof n&&(n="");if(-1!==n.indexOf("mathquill")||n.toLowerCase().match(/officebrowserfeedback_floodgate\.min.js$/))return!1;if(t.match("jQuery.*is not a function.*"))return!1;if(("Script error."===t||"Script error"===t)&&(n.match(/\/jsll-4\.js$/)||n.match(/\/ms.jsll-3\.min\.js$/)||!n))return!1;if(jg(n)||jg(e&&e.stack))return(0,q.$U)("Error.ErrorPage.ErrorOutOfOrigin",{message:t,fileName:n,origin:window.location.origin,stack:e&&e.stack}),!1;if(function(t){var n=(0,Ct.QJ)("IgnoredClientError_Prod");return Kg.concat(n||[]).some((function(n){return t.indexOf(n)>=0}))}(e&&e.message||t))return!1;if("SyntaxError"===t&&(0,vt.un)()&&-1===n.indexOf(".js"))return!1;return!0})(t,n,r)&&(r||((r=new Error(t)).stack="".concat(n,":").concat(e,":").concat(i)),window.setTimeout((function(){np().CriticalError||(np().CriticalError=r)})))}catch(t){}tp&&tp(t,n,e,i,r)};var ep,ip,rp,op,sp,ap=e(72420),up=function(t){function n(){var n=this,e=(0,k.f5)();(n=t.call(this,{defaultParameters:{Action:"NoAction",Analysis:!1,BranchingElementId:null,CopyFormId:null,DataIdeas:!1,FlexPane:"None",FormId:null,Grading:null,Host:null,Locale:null,MeetingInfo:null,Preview:null,Scenario:null,SectionElementId:null,SharingToken:null,Store:!1,Title:null,Token:null,TopView:"None",XlWorkbookId:null,SurveyReportId:null},keys:[e.Schema.Action,e.Schema.Analysis,e.Schema.BranchingElementId,e.Schema.CopyFormId,e.Schema.DataIdeas,e.Schema.FormId,e.Schema.FlexPane,e.Schema.Grading,e.Schema.Host,e.Schema.Locale,e.Schema.MeetingInfo,e.Schema.Preview,e.Schema.Scenario,e.Schema.SectionElementId,e.Schema.SharingToken,e.Schema.Store,e.Schema.Title,e.Schema.Token,e.Schema.TopView,e.Schema.XlWorkbookId,e.Schema.SurveyReportId],serializedFields:["Analysis","Grading","MeetingInfo","Preview"]})||this).readHashValues(),n.writeHashValues(!0);var i=n.Master.Schema;return window.addEventListener("hashchange",n.readHashValues.bind(n)),n.Master.observe((function(t){var e=y.intersection(t.FieldSchemas,[i.Action,i.Title,i.XlWorkbookId]);n.writeHashValues(e.length>0)}),n.Keys),n}return(0,p.ZT)(n,t),n}(function(){function t(t){t=t||{},this.master=t.master||(0,Na.a)();var n=this.master.Schema;this.iJ=t.defaultParameters||{Token:null},this.keys=t.keys||[n.Token],this.rJ=t.serializedFields||[]}return Object.defineProperty(t.prototype,"Master",{get:function(){return this.master},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Keys",{get:function(){return this.keys},enumerable:!1,configurable:!0}),t.prototype.readHashValues=function(){var t=this.getHashFromCurrentUrl();this.master.setData(t,this.keys)},t.prototype.writeHashValues=function(t,n){var e=this,i=this.keys.map((function(t){return _.d.getFieldSchemaInfo(t).Name})),r=y.pick(this.master.Model,i);if(!y.isEqual(r,this.getHashFromCurrentUrl())){var o=i.filter((function(t){return!y.isEqual(e.master.Model[t],e.iJ[t])})).map((function(t){var n=e.master.Model[t];return(0,ap.HD)(n)||(n=JSON.stringify(n)),"".concat(t,"=").concat(encodeURIComponent(n))})).join("&");if(t){var s="".concat(window.location.href.split("#")[0],"#").concat(o);n?window.location.replace(s):(0,Dn.mj)(s)}else window.location.hash=o}},t.prototype.getHashFromCurrentUrl=function(){var t=this,n=this.keys.map((function(t){return _.d.getFieldSchemaInfo(t).Name})),e=n.map((function(t){return t.toLowerCase()})),i=y.clone(this.iJ);return(window.location.hash||"").substring(1).split("&").forEach((function(r){var o=r.split("="),s=e.indexOf(o[0].trim().toLowerCase()),a=n[s];if(a){var u=decodeURIComponent(o[1]||"undefined").trim();y.include(t.rJ,a)&&(u=(0,tt.d)(u)),i[a]=u}})),i},t}());function cp(t){hp(t)}function lp(){Ms("authEnd",(0,rn.dg)());var t={},n=function(){var t=(0,gt.NW)();return"OfficeDotCom"===t.origin&&(t.route||t.sessionId||t.sessionid||(0,S.ro)())?{Action:t.Action||t.action||"Open",Route:t.route,SessionId:t.sessionId||t.sessionid}:void 0}();n&&(0,Vg.l7)(t,n),(0,dt.Rw)()&&(t.isAssignmentsCreateQuiz=!0),(0,I.g)()&&(t.IsFirstRelease=(0,I.$O)(),t.FirstReleaseInfo=(0,Et.y$)()),function(){var t=["sessionId","sessionid","Action"];(0,dt.uV)()||t.push("auth_pvr","auth_upn");var n=(0,gt.oW)(window.location.href,t);window.history.replaceState({},document.title,n)}(),new up;var e="0"===(0,p.pi)((0,p.pi)({},(0,gt.NW)()),(0,gt.$p)()).v2,i=(0,vt.w1)(),r=(0,dt.uV)();t.InvalidM2S1Treatment={isIE:i,forceMode:e,isInt:r},e&&history.replaceState(null,null,(0,gt.oW)(location.href,["v2"])),(0,q.t0)(t),(0,Nt.Tj)({$extraData:t}),(0,gt.NW)().t&&(0,q.$U)("DesignPage.Form.SharedFormByOwner"),(0,gt.$p)()[dt.iK]&&(0,q.$U)("DesignPage.Form.SharedOwnershipByOwner"),(0,Ni.hJ)(Jg),Wg.k.setUpdateErrorCallback((function(t,n){Yg("SaveFeedback",t,n)})),(0,St.p3)((function(){return vp().FormId})),(0,St.EA)((function(){return(0,k.f5)().Model.FormMaster}));var o,s,a,u,c,l,f=Qg.a.getFormsTenantSettings();switch(vp().Action){case"Activate":case"Close":u="Close"===vp().Action,c=vp().FormId,l=(0,Ni.ZP)({Id:c},!1),Promise.all([l.ensureFieldsReady([F.x.Schema.Settings]),(0,T.ay)()]).then((function(){var t=l.Model.Settings;if(!t.FormClosed!=!u)return t.FormClosed=!!u,l.Synchronizer.flush()})).finally((function(){window.setTimeout((function(){fp(),dh.Z.triggerReadProcess(),gp(!1)}),3e3),window.close()}));break;case"Create":f.finally((function(){return dp("Form")}));break;case"CreateByTemplate":if((0,ht.x8)())return(0,q.$U)("CreateFormsByTemplates.NotSupport"),void(0,Ug.P)({innerCode:21001,type:"ExpectedFailure"});var h=(0,gt.NW)();if(h.templateID&&h.omkt){var d=(o=h.omkt,s=h.templateID,a={headers:{"Content-Type":"application/json"},method:"GET",qosEventName:"TemplateInfo.Get",requestUri:"https://binaries.templates.cdn.office.net/support/templates/".concat(o.toLowerCase(),"/tf").concat(s.slice(2),"_wac.json")},(0,ae.lW)(a,{disableLog:!1,disableXMsHeader:!0,skipExpiredTokenCheck:!0}).then(tt.d)).then(dh.Z.createFormByDefinition);Promise.all([f,d]).then((function(t){var n=t[1],e=_.d.convertFromSourceData(n,F.x.Schema),i=Qg.a.updateOrCreateFormMaster(e);(0,k.f5)().Model.FormMaster=i,mp(i),gp(!0),(0,q.$U)("TemplateForm.Create.Success")})).catch((function(t){(0,q.$U)("TemplateForm.Create.Failed"),(0,Ug.P)({innerCode:21001,type:"ExpectedFailure"})}))}else(0,q.$U)("TemplateForm.InvalidLink"),(0,Ug.P)({innerCode:21e3,type:"ExpectedFailure"});break;case"CreateQuiz":f.finally((function(){return dp("Quiz")}));break;case"Delete":!function(){var t=vp().FormId,n=(0,Ni.ZP)({Id:t},!1),e=function(t){(0,et.c2)(),b.render((0,xh.a)({Error:{innerCode:t},ErrorType:"Information"}),document.getElementById("content-root"))};Promise.all([n.ensureFieldsReady([F.x.Schema.OwnerId]),(0,T.ay)()]).then((function(){(new dh.Z).deleteForm(n).then((function(){e(10202),window.close()}))})).catch((function(){e(1001),window.close()}))}();break;default:dh.Z.triggerReadProcess(),gp(!1)}}function fp(){var t=(0,k.f5)();t.bulkEdit((function(){var n=t.Model;n.Action="NoAction",n.Title=null,n.XlWorkbookId=void 0,n.MeetingInfo=null,n.Scenario=null}))}function hp(t){(0,et.pd)((function(){return(0,Ug.P)(t)}),et.t1),(0,q.O7)(t)}function dp(t){var n=(0,k.f5)(),i=n.Model;"ODC"===n.Model.Host&&(n.Model.ShowExcelSurveyIntroductionDialog=!0);var r,o,s=function(n,e){var r=(0,gt.$p)().CollectionId||"",o=lv(t),s=(new dh.Z).createForm((0,p.pi)((0,p.pi)({},o),{CreatedFromOneDrive:!!i.XlWorkbookId,OwnerId:n,Title:i.Title||void 0,XlWorkbookId:i.XlWorkbookId||(0,ju.jI)(e,"Quiz"===t),CollectionId:r}),e);i.FormMaster=s,mp(s)};if((o=i.XlWorkbookId)&&(o.indexOf("/teams/")>=0||o.indexOf("/sites/")>=0))(r=i.XlWorkbookId,oi.VY.getInstance().createDataProvider().getGroupId(r).then((function(t){if((0,O.Ew)(t)){var n=new Error;throw n.name="TeamSiteNoGroupError",n}return t}))).then((function(t){s(t,!0),gp(!0)})).catch(hp);else if((0,dt.Kw)())s((0,dt.av)(),!0),gp(!0);else if((0,Wa._I)()&&n.Model.MeetingInfo&&n.Model.Scenario)!function(){var t=(0,k.f5)().Model,n=function(n){var e=n[t.Scenario];e&&e.Title&&e.Title.length>90&&(e.Title=e.Title.substring(0,87)+"...");var i=y.clone(e),r=i.OtherInfo;i.OwnerId=(0,c.k0)().userInfo.UserId,i.OwnerTenantId=(0,c.k0)().userInfo.TenantId,i.Background.ResourceUrl=(0,_t.WN)((0,zi.Jn)(i.Background.ResourceUrl)),i.Logo.ResourceUrl=(0,_t.WN)((0,zi.Jn)(i.Logo.ResourceUrl)),i.MeetingId=t.MeetingInfo.Id;var o=(0,Ni.kJ)(i,"User",!1);o.Model.Background.IsPredefined=!0,o.Model.OtherInfo=r,t.FormMaster=o,mp(o)};return(i=t.MeetingInfo,new Promise((function(t,n){e.e(305).then(e.t.bind(e,90030,19)).then((function(t){return t.default})).then((function(n){n=function(t,n){var e=n;if(t&&t.Subject&&(e=e.replace(/\[organization all hands\]/g,t.Subject)),t&&t.Date){var i=(0,c.k0)().cultureInfo.Name||"en-us",r=new Date(t.Date).toLocaleDateString(i);e=e.replace(/\[dateTime\]/g,r)}return JSON.parse(e)||{}}(i,JSON.stringify(n)),t(n)})).catch(n)}))).then(n).then((function(){gp(!0)})).catch(hp);var i}();else{var a=(0,gt.$p)().GroupId;a?s(a,!0):s((0,c.k0)().userInfo.UserId,!1),gp(!0)}}function mp(t){var n=(0,k.f5)(),e=n.Model;t.existingOnServerSide().then((function(){n.bulkEdit((function(){t===e.FormMaster&&(e.FormId=t.Model.Id),n.Model.Host=void 0,fp()}))})).catch(hp)}function vp(){return(0,k.f5)().Model}function gp(t){var n=(0,k.f5)();n.observe((function(){return dh.Z.triggerReadProcess()}),[n.Schema.FormId,n.Schema.FormCollectionType]);var e=co("getForms",function(){var t,n=(0,k.f5)();return n.observe((function e(){"Loaded"===n.Model.FormListLoadState&&(t(),n.unobserve(e))}),[n.Schema.FormListLoadState]),new Promise((function(n){t=n}))}());e.then((function(){Ms("formApiFinished",(0,rn.dg)())}));var i=co("scripts",(0,Pr.m)(["combined-design"]));i.then((function(){Ms("otherJsLoaded",(0,rn.dg)())}));var r=(0,I.cr)("FormsPro");if(wa()||r){var o=co("O365ShellBootstrap",(0,Pr.y)("O365ShellBootstrap"));$("#reactshellheader").addClass("suiteheader-placeholder"),o.then((function(){(0,q.$U)("DesignPage.SuiteHeader.LoadBootstrap.Success"),fa(),va(bv.onShellFlexPaneVisibilityChanged)})).catch((function(){(0,q.$U)("DesignPage.SuiteHeader.LoadBootstrap.Fail")}))}(0,T.r4)((0,T.Re)());var s=co("strings",(0,T.ay)());s.then((function(){if(Ms("resourceStringLoaded",(0,rn.dg)()),t){var e=n.Model.FormMaster.Model,i=e.Settings.IsQuizMode;e.Title||(e.Title=i?(0,T.pm)().Designer_DefaultQuizTitle:(0,T.pm)().Designer_DefaultFormTitle)}})),(0,bs.c)().init(Fn.Ng),(0,zg.b)(Promise.all([i,s]),"GetDesignPageResources"),Promise.all([e,i,s]).then((function(){var t;t=window.NavKeyPoints,(0,q.$U)("Forms.PerformanceAnalysis",{checkPoints:ao,requests:so,requestsAll:Date.now()-oo,scriptCached:uo,scriptDownload:t&&t.PageStartTime&&oo-t.PageStartTime,version:1}),(0,se.a)().RetryingRecoverableError=!1})),(0,Fn.GO)().then((function(){var t=[i,s];Promise.all(t).then((function(){(0,et.c2)(),(0,Fn.qH)().then((function(t){t&&Ws()})),b.render(g.createElement((0,et.pd)((function(){return pv}),et.t1)),document.getElementById("content-root")),function(){if(!(0,qg.e)("nps-value")){var t=(0,ht.yv)()?(0,S.ZL)()?5:100:2;0===Math.floor(Math.random()*t)&&(0,qg.d)("nps-value","readytoshow",5184e6)}}(),(0,q.O7)()}))}))}function pp(){var t=(0,p.pi)((0,p.pi)({},(0,gt.NW)()),(0,gt.$p)()),n=(0,vt.w1)(),e="0"===t.v2,i=(0,dt.uV)(),r=t.FormId||"NoAction"!==t.Action&&!!t.Action;return!(!(0,et.Sp)()&&(0,ht.yv)()&&r&&!n&&!e&&!i)||(t.subpage="design",location.replace((0,pt.vu)("".concat(location.protocol,"//").concat(location.host,"/pages/designpagev2.aspx"),t)),!1)}(0,mt.n)(8),h.Pv.Register("IPageContext").UsingSingleton((function(){return new Kn(ep)})),h.Pv.Register("ILogger").UsingSingleton((function(){return new fn(new nn(St.x_,Fn.Ng,hn),new Nn(St.x_,Fn.Ng))})),m(),wt(),(0,se.a)().Flighting.setFlights((0,c.k0)().flights),h.Pv.Register("IMixin").UsingSingleton((function(){return new Bi})),h.Pv.Register("IFormApiMixin").UsingSingleton((function(){return new Be})),ip=new Hi,h.Pv.Register("IBootEvent").UsingSingleton((function(){return ip})),rp=Promise.resolve($),op=function(){return rp},h.Pv.Register("IThirdPartyRateIt").UsingSingleton(op),h.Pv.Register("IThirdPartyLinkify").UsingSingleton(op),h.Pv.Register("IThirdPartyDateTimePicker").UsingSingleton(op),h.Pv.Register("IFormUserContextActionSignal").UsingSingleton((function(){return new qi})),h.Pv.Register("ITemplateQuestions").UsingSingleton(Nr),h.Pv.Register("ICustomerVoiceUxFactory").UsingSingleton((function(){return new mr})),h.Pv.Register("ICVMixin").UsingSingleton((function(){return new Zn})),h.Pv.Register("ICustomerVoiceTitleDesignerFactory").UsingSingleton((function(){return new Ag})),h.Pv.Register("ICustomerVoiceTitleContainerFactory").UsingSingleton((function(){return new Hg})),h.Pv.Register("ICustomerVoiceMetricUtilities").UsingSingleton((function(){return new Cr})),sp=function(){return new Yv},h.Pv.Register(6).UsingSingleton(sp),(0,ht.x8)()?h.Pv.Register(22).UsingSingleton((function(){return{init:function(){return Promise.resolve()},log:function(){},logStartTime:function(){},logStopTime:function(){}}})):h.Pv.Register(22).UsingSingleton((function(){return{init:lo,log:fo,logStartTime:ho,logStopTime:mo}})),(0,ht.x8)()?h.Pv.Register(24).UsingSingleton((function(){return Promise.resolve})):h.Pv.Register(24).UsingSingleton((function(){return io})),h.Pv.Register("ICustomerVoiceSectionHeaderDesignerFactory").UsingSingleton((function(){return new Rr})),(0,Gg.m)(.1),function(){if(!pp())return;(0,se.a)().AuthContext.handleAuthForContentPage(!0).then((function(){pp()&&(0,et.pd)(lp,et.t1)})).catch(cp)}(),h.Pv.Register("ICustomerVoiceQuestionUxFactory").UsingSingleton((function(){return new ft}))},59312:function(t,n,e){"use strict";e.d(n,{Jh:function(){return c},ZT:function(){return r},_T:function(){return s},ev:function(){return l},gn:function(){return a},mG:function(){return u},pi:function(){return o}});var i=function(t,n){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])},i(t,n)};function r(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}i(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}var o=function(){return o=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t},o.apply(this,arguments)};function s(t,n){var e={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.indexOf(i)<0&&(e[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)n.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(e[i[r]]=t[i[r]])}return e}function a(t,n,e,i){var r,o=arguments.length,s=o<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,n,e,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(n,e,s):r(n,e))||s);return o>3&&s&&Object.defineProperty(n,e,s),s}function u(t,n,e,i){return new(e||(e=Promise))((function(r,o){function s(t){try{u(i.next(t))}catch(t){o(t)}}function a(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){var n;t.done?r(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(s,a)}u((i=i.apply(t,n||[])).next())}))}function c(t,n){var e,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=n.call(t,s)}catch(t){o=[6,t],i=0}finally{e=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}Object.create;function l(t,n,e){if(e||2===arguments.length)for(var i,r=0,o=n.length;r<o;r++)!i&&r in n||(i||(i=Array.prototype.slice.call(n,0,r)),i[r]=n[r]);return t.concat(i||Array.prototype.slice.call(n))}Object.create},87363:function(t){"use strict";t.exports=React},61533:function(t){"use strict";t.exports=ReactDOM},12611:function(t){"use strict";t.exports=_}},s={};function a(t){var n=s[t];if(void 0!==n)return n.exports;var e=s[t]={exports:{}};return o[t]||self.formsModuleResolveErrorCallback&&self.formsModuleResolveErrorCallback(t),o[t].call(e.exports,e,e.exports,a),e.exports}a.m=o,t=[],a.O=function(n,e,i,r){if(!e){var o=1/0;for(l=0;l<t.length;l++){e=t[l][0],i=t[l][1],r=t[l][2];for(var s=!0,u=0;u<e.length;u++)(!1&r||o>=r)&&Object.keys(a.O).every((function(t){return a.O[t](e[u])}))?e.splice(u--,1):(s=!1,r<o&&(o=r));if(s){t.splice(l--,1);var c=i();void 0!==c&&(n=c)}}return n}r=r||0;for(var l=t.length;l>0&&t[l-1][2]>r;l--)t[l]=t[l-1];t[l]=[e,i,r]},a.F={},a.E=function(t){Object.keys(a.F).map((function(n){a.F[n](t)}))},a.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(n,{a:n}),n},e=Object.getPrototypeOf?function(t){return Object.getPrototypeOf(t)}:function(t){return t.__proto__},a.t=function(t,i){if(1&i&&(t=this(t)),8&i)return t;if("object"==typeof t&&t){if(4&i&&t.__esModule)return t;if(16&i&&"function"==typeof t.then)return t}var r=Object.create(null);a.r(r);var o={};n=n||[null,e({}),e([]),e(e)];for(var s=2&i&&t;"object"==typeof s&&!~n.indexOf(s);s=e(s))Object.getOwnPropertyNames(s).forEach((function(n){o[n]=function(){return t[n]}}));return o.default=function(){return t},a.d(r,o),r},a.d=function(t,n){for(var e in n)a.o(n,e)&&!a.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:n[e]})},a.f={},a.e=function(t){return Promise.all(Object.keys(a.f).reduce((function(n,e){return a.f[e](t,n),n}),[]))},a.u=function(t){return"design-page.chunk."+{16:"surveyindividualviewcontainerv2",18:"officebrowserfeedback",42:"question.nps",48:"customervoiceintroduction",66:"question.rating",149:"insight",166:"ir",173:"utel_1ds",207:"specificsharing",274:"question.fileupload",305:"json_intelligence_scenario_templates",410:"json_intelligence_useractionsignals",514:"json_templates",535:"json_teams_featured_templates",600:"math",641:"1ds",647:"question.likert",653:"postsubmit",678:"shareform",708:"json_msa_templates",757:"ribbon_editor",778:"fluent",824:"utel",852:"phishing",862:"recyclebin",904:"intelligence",920:"lrp_ext",967:"question.ranking",969:"question.datetime",985:"json_themes"}[t]+"."+{16:"2f87729",18:"3401764",42:"4d80738",48:"a4d867d",66:"db2536f",149:"6a14d83",166:"299db6c",173:"bdaf923",207:"abec7c3",274:"149e876",305:"1a87d46",410:"e1adf76",514:"ade677a",535:"8607f93",600:"728afd9",641:"5fe6cdb",647:"975b45f",653:"54ff1a7",678:"90c1e23",708:"3b9c517",757:"cfb1070",778:"27048bc",824:"e8305e2",852:"78ac138",862:"3c6e51b",904:"2f1ef25",920:"37402e7",967:"ae58faf",969:"7717dbd",985:"4dcb04e"}[t]+".js"},a.miniCssF=function(t){},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),a.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},i={},a.l=function(t,n,e,r){if(i[t])i[t].push(n);else{var o,s;if(void 0!==e)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var l=u[c];if(l.getAttribute("src")==t){o=l;break}}o||(s=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,a.nc&&o.setAttribute("nonce",a.nc),o.src=a.tu(t)),i[t]=[n];var f=function(n,e){o.onerror=o.onload=null,clearTimeout(h);var r=i[t];if(delete i[t],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach((function(t){return t(e)})),n)return n(e)},h=setTimeout(f.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=f.bind(null,o.onerror),o.onload=f.bind(null,o.onload),s&&document.head.appendChild(o)}},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.tt=function(){if(void 0===r&&(r={createScriptURL:function(t){return t}},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy))try{r=trustedTypes.createPolicy("formsScriptSrc#webpack",r)}catch(t){console.warn('Could not create trusted-types policy "formsScriptSrc#webpack"')}return r},a.tu=function(t){return a.tt().createScriptURL(t)},a.p="";var u,c,l,f,h=a.u;a.u=function(t){return function(t){try{if("function"!=typeof replaceChunkSrc)throw new Error("WebpackRequireFrom: 'replaceChunkSrc' is not a function or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");var n=replaceChunkSrc(t);if(!n||"string"!=typeof n)throw new Error("WebpackRequireFrom: 'replaceChunkSrc' does not return string. See https://github.com/agoldis/webpack-require-from#troubleshooting");return n}catch(n){return t}}(h(t))},u=a.u,c=a.e,l=new Map,f=new Map,a.u=function(t){var n=u(t),e=n.indexOf("?")>-1;return n+(l.has(t)?(e?"&":"?")+l.get(t):"")},a.e=function(t){return c(t).catch((function(n){var e=f.has(t)?f.get(t):2;if(e<1){var i=u(t);throw n.message="Loading chunk "+t+" failed after 2 retries.\n("+i+")",n.request=i,n}return new Promise((function(n){setTimeout((function(){var i="cache-bust=true&retry-attempt="+(2-e+1);l.set(t,i),f.set(t,e-1),n(a.e(t))}),0)}))}))},Object.defineProperty(a,"p",{get:function(){try{if("function"!=typeof getChunkPath)throw new Error("WebpackRequireFrom: 'getChunkPath' is not a function or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");return getChunkPath()}catch(t){return""}},set:function(t){console.warn("WebpackRequireFrom: something is trying to override webpack public path. Ignoring the new value"+t+".")}}),function(){var t={350:0};a.f.j=function(n,e){var i=a.o(t,n)?t[n]:void 0;if(0!==i)if(i)e.push(i[2]);else{var r=new Promise((function(e,r){i=t[n]=[e,r]}));e.push(i[2]=r);var o=a.p+a.u(n),s=new Error;a.l(o,(function(e){if(a.o(t,n)&&(0!==(i=t[n])&&(t[n]=void 0),i)){var r=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;s.message="Loading chunk "+n+" failed.\n("+r+": "+o+")",s.name="ChunkLoadError",s.type=r,s.request=o,i[1](s)}}),"chunk-"+n,n)}},a.F.j=function(n){if(!a.o(t,n)||void 0===t[n]){t[n]=null;var e=document.createElement("link");a.nc&&e.setAttribute("nonce",a.nc),e.rel="prefetch",e.as="script",e.href=a.p+a.u(n),document.head.appendChild(e)}},a.O.j=function(n){return 0===t[n]};var n=function(n,e){var i,r,o=e[0],s=e[1],u=e[2],c=0;if(o.some((function(n){return 0!==t[n]}))){for(i in s)a.o(s,i)&&(a.m[i]=s[i]);if(u)var l=u(a)}for(n&&n(e);c<o.length;c++)r=o[c],a.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return a.O(l)},e=self.webpackChunk=self.webpackChunk||[];e.forEach(n.bind(null,0)),e.push=n.bind(null,e.push.bind(e))}(),a.O(0,[350],(function(){[18,653,16].map(a.E)}),5),a.O(void 0,[527],(function(){return a(78606)})),a.O(void 0,[527],(function(){return a(219)}));var d=a.O(void 0,[527],(function(){return a(76274)}));d=a.O(d)}();

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/design-page.min.05ba44f.js.map/68486dadd8b7f4e4c72350dd22c47e56a9e86b5f030612808b0fe612e99ca1f5/design-page.min.05ba44f.js.map